 //     (c) 2009-2012 Jeremy Ashkenas, DocumentCloud Inc.

//     Underscore is freely distributable under the MIT license.

//     (c) 2010-2012 Jeremy Ashkenas, DocumentCloud Inc.

//     Backbone may be freely distributed under the MIT license.

// Backbone.Marionette v0.9.10
//
// Copyright (C)2012 Derick Bailey, Muted Solutions, LLC
// Distributed Under MIT License
//
// Documentation and Full License Available at:
// http://github.com/derickbailey/backbone.marionette

/**
 * @license RequireJS text 2.0.3 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 * Available via the MIT or new BSD license.
 * see: http://github.com/requirejs/text for details
 */

/*! backbone.paginator - v0.1.5 - 3/30/2012
 * http://github.com/addyosmani/backbone.paginator
 * Copyright (c) 2012 Addy Osmani; Licensed MIT */

/*
 * ************************************************************************
 *
 *  ADOBE CONFIDENTIAL
 *  ___________________
 *
 *   (c) Copyright 2014 Adobe Systems, Inc.
 *   All Rights Reserved.
 *
 *  NOTICE:  All information contained herein is, and remains
 *  the property of Adobe Systems Incorporated and its suppliers,
 *  if any.  The intellectual and technical concepts contained
 *  herein are proprietary to Adobe Systems Incorporated and its
 *  suppliers and may be covered by U.S. and Foreign Patents,
 *  patents in process, and are protected by trade secret or copyright law.
 *  Dissemination of this information or reproduction of this material
 *  is strictly forbidden unless prior written permission is obtained
 *  from Adobe Systems Incorporated.
 * ************************************************************************
 */

/*
 * dv - v3.1.0 - 2014-08-22
 * Copyright (c) 2014 Adobe Systems, Inc. All Rights Reserved.
 */

/*
 * CloudViz - v3.4.0 - 2014-10-28
 * Copyright (c) 2014 Adobe Systems, Inc. All Rights Reserved.
 */

/*!
 * jQuery UI 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI
 */

/*!
 * jQuery UI Widget 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Widget
 */

/*!
 * jQuery UI Mouse 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Mouse
 *
 * Depends:
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Position 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Position
 */

/*
 * jQuery UI Draggable 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Draggables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Droppable 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Droppables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.mouse.js
 *	jquery.ui.draggable.js
 */

/*
 * jQuery UI Resizable 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Resizables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Selectable 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Selectables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Sortable 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Sortables
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Accordion 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Accordion
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Autocomplete 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Autocomplete
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *	jquery.ui.position.js
 */

/*
 * jQuery UI Button 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Button
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Dialog 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Dialog
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 *  jquery.ui.button.js
 *	jquery.ui.draggable.js
 *	jquery.ui.mouse.js
 *	jquery.ui.position.js
 *	jquery.ui.resizable.js
 */

/*
 * jQuery UI Slider 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Slider
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.mouse.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Tabs 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Tabs
 *
 * Depends:
 *	jquery.ui.core.js
 *	jquery.ui.widget.js
 */

/*
 * jQuery UI Progressbar 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Progressbar
 *
 * Depends:
 *   jquery.ui.core.js
 *   jquery.ui.widget.js
 */

/*
 * jQuery UI Effects 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/
 */

/*
 * jQuery UI Effects Blind 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Blind
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Bounce 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Bounce
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Clip 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Clip
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Drop 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Drop
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Explode 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Explode
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Fade 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fade
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Fold 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Fold
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Highlight 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Highlight
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Pulsate 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Pulsate
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Scale 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Scale
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Shake 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Shake
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Slide 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Slide
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jQuery UI Effects Transfer 1.8.16
 *
 * Copyright 2011, AUTHORS.txt (http://jqueryui.com/about)
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://jquery.org/license
 *
 * http://docs.jquery.com/UI/Effects/Transfer
 *
 * Depends:
 *	jquery.effects.core.js
 */

/*
 * jsTree 1.0-rc3
 * http://jstree.com/
 *
 * Copyright (c) 2010 Ivan Bozhanov (vakata.com)
 *
 * Licensed same as jquery - under the terms of either the MIT License or the GPL Version 2 License
 *   http://www.opensource.org/licenses/mit-license.php
 *   http://www.gnu.org/licenses/gpl.html
 *
 * $Date: 2011-02-09 01:17:14 +0200 () $
 * $Revision: 236 $
 */

/* Javascript plotting library for jQuery, v. 0.7.
 *
 * Released under the MIT license by IOLA, December 2007.
 *
 */

(function() {
    function C(e, t, n) {
        if (e === t)
            return e !== 0 || 1 / e == 1 / t;
        if (e == null || t == null)
            return e === t;
        e._chain && (e = e._wrapped), t._chain && (t = t._wrapped);
        if (e.isEqual && S.isFunction(e.isEqual))
            return e.isEqual(t);
        if (t.isEqual && S.isFunction(t.isEqual))
            return t.isEqual(e);
        var r = a.call(e);
        if (r != a.call(t))
            return !1;
        switch (r) {
            case "[object String]":
                return e == String(t);
            case "[object Number]":
                return e != +e ? t != +t : e == 0 ? 1 / e == 1 / t : e == +t;
            case "[object Date]":
            case "[object Boolean]":
                return +e == +t;
            case "[object RegExp]":
                return e.source == t.source && e.global == t.global && e.multiline == t.multiline && e.ignoreCase == t.ignoreCase
        }
        if (typeof e != "object" || typeof t != "object")
            return !1;
        var i = n.length;
        while (i--)
            if (n[i] == e)
                return !0;
        n.push(e);
        var s = 0, o = !0;
        if (r == "[object Array]") {
            s = e.length, o = s == t.length;
            if (o)
                while (s--)
                    if (!(o = s in e == s in t && C(e[s], t[s], n)))
                        break
        } else {
            if ("constructor" in e != "constructor" in t || e.constructor != t.constructor)
                return !1;
            for (var u in e)
                if (S.has(e, u)) {
                    s++;
                    if (!(o = S.has(t, u) && C(e[u], t[u], n)))
                        break
                }
            if (o) {
                for (u in t)
                    if (S.has(t, u) && !(s--))
                        break;
                o = !s
            }
        }
        return n.pop(), o
    }
    var e = this, t = e._, n = {}, r = Array.prototype, i = Object.prototype, s = Function.prototype, o = r.slice, u = r.unshift, a = i.toString, f = i.hasOwnProperty, l = r.forEach, c = r.map, h = r.reduce, p = r.reduceRight, d = r.filter, v = r.every, m = r.some, g = r.indexOf, y = r.lastIndexOf, b = Array.isArray, w = Object.keys, E = s.bind, S = function(e) {
        return new P(e)
    };
    typeof exports != "undefined" ? (typeof module != "undefined" && module.exports && (exports = module.exports = S), exports._ = S) : e._ = S, S.VERSION = "1.3.3";
    var x = S.each = S.forEach = function(e, t, r) {
        if (e == null)
            return;
        if (l && e.forEach === l)
            e.forEach(t, r);
        else if (e.length === +e.length) {
            for (var i = 0, s = e.length; i < s; i++)
                if (i in e && t.call(r, e[i], i, e) === n)
                    return
        } else
            for (var o in e)
                if (S.has(e, o) && t.call(r, e[o], o, e) === n)
                    return
    };
    S.map = S.collect = function(e, t, n) {
        var r = [];
        return e == null ? r : c && e.map === c ? e.map(t, n) : (x(e, function(e, i, s) {
            r[r.length] = t.call(n, e, i, s)
        }), e.length === +e.length && (r.length = e.length), r)
    }, S.reduce = S.foldl = S.inject = function(e, t, n, r) {
        var i = arguments.length > 2;
        e == null && (e = []);
        if (h && e.reduce === h)
            return r && (t = S.bind(t, r)), i ? e.reduce(t, n) : e.reduce(t);
        x(e, function(e, s, o) {
            i ? n = t.call(r, n, e, s, o) : (n = e, i = !0)
        });
        if (!i)
            throw new TypeError("Reduce of empty array with no initial value");
        return n
    }, S.reduceRight = S.foldr = function(e, t, n, r) {
        var i = arguments.length > 2;
        e == null && (e = []);
        if (p && e.reduceRight === p)
            return r && (t = S.bind(t, r)), i ? e.reduceRight(t, n) : e.reduceRight(t);
        var s = S.toArray(e).reverse();
        return r && !i && (t = S.bind(t, r)), i ? S.reduce(s, t, n, r) : S.reduce(s, t)
    }, S.find = S.detect = function(e, t, n) {
        var r;
        return T(e, function(e, i, s) {
            if (t.call(n, e, i, s))
                return r = e, !0
        }), r
    }, S.filter = S.select = function(e, t, n) {
        var r = [];
        return e == null ? r : d && e.filter === d ? e.filter(t, n) : (x(e, function(e, i, s) {
            t.call(n, e, i, s) && (r[r.length] = e)
        }), r)
    }, S.reject = function(e, t, n) {
        var r = [];
        return e == null ? r : (x(e, function(e, i, s) {
            t.call(n, e, i, s) || (r[r.length] = e)
        }), r)
    }, S.every = S.all = function(e, t, r) {
        var i = !0;
        return e == null ? i : v && e.every === v ? e.every(t, r) : (x(e, function(e, s, o) {
            if (!(i = i && t.call(r, e, s, o)))
                return n
        }), !!i)
    };
    var T = S.some = S.any = function(e, t, r) {
        t || (t = S.identity);
        var i = !1;
        return e == null ? i : m && e.some === m ? e.some(t, r) : (x(e, function(e, s, o) {
            if (i || (i = t.call(r, e, s, o)))
                return n
        }), !!i)
    };
    S.include = S.contains = function(e, t) {
        var n = !1;
        return e == null ? n : g && e.indexOf === g ? e.indexOf(t) != -1 : (n = T(e, function(e) {
            return e === t
        }), n)
    }, S.invoke = function(e, t) {
        var n = o.call(arguments, 2);
        return S.map(e, function(e) {
            return (S.isFunction(t) ? t || e : e[t]).apply(e, n)
        })
    }, S.pluck = function(e, t) {
        return S.map(e, function(e) {
            return e[t]
        })
    }, S.where = function(e, t, n) {
        return S.isEmpty(t) ? n ? void 0 : [] : S[n ? "find" : "filter"](e, function(e) {
            for (var n in t)
                if (t[n] !== e[n])
                    return !1;
            return !0
        })
    }, S.findWhere = function(e, t) {
        return S.where(e, t, !0)
    }, S.max = function(e, t, n) {
        if (!t && S.isArray(e) && e[0] === +e[0])
            return Math.max.apply(Math, e);
        if (!t && S.isEmpty(e))
            return -Infinity;
        var r = {computed: -Infinity};
        return x(e, function(e, i, s) {
            var o = t ? t.call(n, e, i, s) : e;
            o >= r.computed && (r = {value: e,computed: o})
        }), r.value
    }, S.min = function(e, t, n) {
        if (!t && S.isArray(e) && e[0] === +e[0])
            return Math.min.apply(Math, e);
        if (!t && S.isEmpty(e))
            return Infinity;
        var r = {computed: Infinity};
        return x(e, function(e, i, s) {
            var o = t ? t.call(n, e, i, s) : e;
            o < r.computed && (r = {value: e,computed: o})
        }), r.value
    }, S.shuffle = function(e) {
        var t = [], n;
        return x(e, function(e, r, i) {
            n = Math.floor(Math.random() * (r + 1)), t[r] = t[n], t[n] = e
        }), t
    }, S.sortBy = function(e, t, n) {
        var r = S.isFunction(t) ? t : function(e) {
            return e[t]
        };
        return S.pluck(S.map(e, function(e, t, i) {
            return {value: e,criteria: r.call(n, e, t, i)}
        }).sort(function(e, t) {
            var n = e.criteria, r = t.criteria;
            return n === void 0 ? 1 : r === void 0 ? -1 : n < r ? -1 : n > r ? 1 : 0
        }), "value")
    }, S.groupBy = function(e, t) {
        var n = {}, r = S.isFunction(t) ? t : function(e) {
            return e[t]
        };
        return x(e, function(e, t) {
            var i = r(e, t);
            (n[i] || (n[i] = [])).push(e)
        }), n
    }, S.sortedIndex = function(e, t, n) {
        n || (n = S.identity);
        var r = 0, i = e.length;
        while (r < i) {
            var s = r + i >> 1;
            n(e[s]) < n(t) ? r = s + 1 : i = s
        }
        return r
    }, S.toArray = function(e) {
        return e ? S.isArray(e) ? o.call(e) : S.isArguments(e) ? o.call(e) : e.toArray && S.isFunction(e.toArray) ? e.toArray() : S.values(e) : []
    }, S.size = function(e) {
        return S.isArray(e) ? e.length : S.keys(e).length
    }, S.first = S.head = S.take = function(e, t, n) {
        return t != null && !n ? o.call(e, 0, t) : e[0]
    }, S.initial = function(e, t, n) {
        return o.call(e, 0, e.length - (t == null || n ? 1 : t))
    }, S.last = function(e, t, n) {
        return t != null && !n ? o.call(e, Math.max(e.length - t, 0)) : e[e.length - 1]
    }, S.rest = S.tail = function(e, t, n) {
        return o.call(e, t == null || n ? 1 : t)
    }, S.compact = function(e) {
        return S.filter(e, function(e) {
            return !!e
        })
    }, S.flatten = function(e, t) {
        return S.reduce(e, function(e, n) {
            return S.isArray(n) ? e.concat(t ? n : S.flatten(n)) : (e[e.length] = n, e)
        }, [])
    }, S.without = function(e) {
        return S.difference(e, o.call(arguments, 1))
    }, S.uniq = S.unique = function(e, t, n) {
        var r = n ? S.map(e, n) : e, i = [];
        return e.length < 3 && (t = !0), S.reduce(r, function(n, r, s) {
            if (t ? S.last(n) !== r || !n.length : !S.include(n, r))
                n.push(r), i.push(e[s]);
            return n
        }, []), i
    }, S.union = function() {
        return S.uniq(S.flatten(arguments, !0))
    }, S.intersection = S.intersect = function(e) {
        var t = o.call(arguments, 1);
        return S.filter(S.uniq(e), function(e) {
            return S.every(t, function(t) {
                return S.indexOf(t, e) >= 0
            })
        })
    }, S.difference = function(e) {
        var t = S.flatten(o.call(arguments, 1), !0);
        return S.filter(e, function(e) {
            return !S.include(t, e)
        })
    }, S.zip = function() {
        var e = o.call(arguments), t = S.max(S.pluck(e, "length")), n = new Array(t);
        for (var r = 0; r < t; r++)
            n[r] = S.pluck(e, "" + r);
        return n
    }, S.indexOf = function(e, t, n) {
        if (e == null)
            return -1;
        var r, i;
        if (n)
            return r = S.sortedIndex(e, t), e[r] === t ? r : -1;
        if (g && e.indexOf === g)
            return e.indexOf(t);
        for (r = 0, i = e.length; r < i; r++)
            if (r in e && e[r] === t)
                return r;
        return -1
    }, S.lastIndexOf = function(e, t) {
        if (e == null)
            return -1;
        if (y && e.lastIndexOf === y)
            return e.lastIndexOf(t);
        var n = e.length;
        while (n--)
            if (n in e && e[n] === t)
                return n;
        return -1
    }, S.range = function(e, t, n) {
        arguments.length <= 1 && (t = e || 0, e = 0), n = arguments[2] || 1;
        var r = Math.max(Math.ceil((t - e) / n), 0), i = 0, s = new Array(r);
        while (i < r)
            s[i++] = e, e += n;
        return s
    };
    var N = function() {
    };
    S.bind = function(t, n) {
        var r, i;
        if (t.bind === E && E)
            return E.apply(t, o.call(arguments, 1));
        if (!S.isFunction(t))
            throw new TypeError;
        return i = o.call(arguments, 2), r = function() {
            if (this instanceof r) {
                N.prototype = t.prototype;
                var e = new N, s = t.apply(e, i.concat(o.call(arguments)));
                return Object(s) === s ? s : e
            }
            return t.apply(n, i.concat(o.call(arguments)))
        }
    }, S.bindAll = function(e) {
        var t = o.call(arguments, 1);
        return t.length == 0 && (t = S.functions(e)), x(t, function(t) {
            e[t] = S.bind(e[t], e)
        }), e
    }, S.memoize = function(e, t) {
        var n = {};
        return t || (t = S.identity), function() {
            var r = t.apply(this, arguments);
            return S.has(n, r) ? n[r] : n[r] = e.apply(this, arguments)
        }
    }, S.delay = function(e, t) {
        var n = o.call(arguments, 2);
        return setTimeout(function() {
            return e.apply(null, n)
        }, t)
    }, S.defer = function(e) {
        return S.delay.apply(S, [e, 1].concat(o.call(arguments, 1)))
    }, S.throttle = function(e, t) {
        var n, r, i, s, o, u, a = S.debounce(function() {
            o = s = !1
        }, t);
        return function() {
            n = this, r = arguments;
            var f = function() {
                i = null, o && e.apply(n, r), a()
            };
            return i || (i = setTimeout(f, t)), s ? o = !0 : u = e.apply(n, r), a(), s = !0, u
        }
    }, S.debounce = function(e, t, n) {
        var r;
        return function() {
            var i = this, s = arguments, o = function() {
                r = null, n || e.apply(i, s)
            };
            n && !r && e.apply(i, s), clearTimeout(r), r = setTimeout(o, t)
        }
    }, S.once = function(e) {
        var t = !1, n;
        return function() {
            return t ? n : (t = !0, n = e.apply(this, arguments))
        }
    }, S.wrap = function(e, t) {
        return function() {
            var n = [e].concat(o.call(arguments, 0));
            return t.apply(this, n)
        }
    }, S.compose = function() {
        var e = arguments;
        return function() {
            var t = arguments;
            for (var n = e.length - 1; n >= 0; n--)
                t = [e[n].apply(this, t)];
            return t[0]
        }
    }, S.after = function(e, t) {
        return e <= 0 ? t() : function() {
            if (--e < 1)
                return t.apply(this, arguments)
        }
    }, S.keys = w || function(e) {
        if (e !== Object(e))
            throw new TypeError("Invalid object");
        var t = [];
        for (var n in e)
            S.has(e, n) && (t[t.length] = n);
        return t
    }, S.values = function(e) {
        return S.map(e, S.identity)
    }, S.functions = S.methods = function(e) {
        var t = [];
        for (var n in e)
            S.isFunction(e[n]) && t.push(n);
        return t.sort()
    }, S.extend = function(e) {
        return x(o.call(arguments, 1), function(t) {
            for (var n in t)
                e[n] = t[n]
        }), e
    }, S.pick = function(e) {
        var t = {};
        return x(S.flatten(o.call(arguments, 1)), function(n) {
            n in e && (t[n] = e[n])
        }), t
    }, S.defaults = function(e) {
        return x(o.call(arguments, 1), function(t) {
            for (var n in t)
                e[n] == null && (e[n] = t[n])
        }), e
    }, S.clone = function(e) {
        return S.isObject(e) ? S.isArray(e) ? e.slice() : S.extend({}, e) : e
    }, S.tap = function(e, t) {
        return t(e), e
    }, S.isEqual = function(e, t) {
        return C(e, t, [])
    }, S.isEmpty = function(e) {
        if (e == null)
            return !0;
        if (S.isArray(e) || S.isString(e))
            return e.length === 0;
        for (var t in e)
            if (S.has(e, t))
                return !1;
        return !0
    }, S.isElement = function(e) {
        return !!e && e.nodeType == 1
    }, S.isArray = b || function(e) {
        return a.call(e) == "[object Array]"
    }, S.isObject = function(e) {
        return e === Object(e)
    }, S.isArguments = function(e) {
        return a.call(e) == "[object Arguments]"
    }, S.isArguments(arguments) || (S.isArguments = function(e) {
        return !!e && !!S.has(e, "callee")
    }), S.isFunction = function(e) {
        return a.call(e) == "[object Function]"
    }, S.isString = function(e) {
        return a.call(e) == "[object String]"
    }, S.isNumber = function(e) {
        return a.call(e) == "[object Number]"
    }, S.isFinite = function(e) {
        return S.isNumber(e) && isFinite(e)
    }, S.isNaN = function(e) {
        return e !== e
    }, S.isBoolean = function(e) {
        return e === !0 || e === !1 || a.call(e) == "[object Boolean]"
    }, S.isDate = function(e) {
        return a.call(e) == "[object Date]"
    }, S.isRegExp = function(e) {
        return a.call(e) == "[object RegExp]"
    }, S.isNull = function(e) {
        return e === null
    }, S.isUndefined = function(e) {
        return e === void 0
    }, S.has = function(e, t) {
        return f.call(e, t)
    }, S.noConflict = function() {
        return e._ = t, this
    }, S.identity = function(e) {
        return e
    }, S.times = function(e, t, n) {
        for (var r = 0; r < e; r++)
            t.call(n, r)
    }, S.escape = function(e) {
        return ("" + e).replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&#x27;").replace(/\//g, "&#x2F;")
    }, S.result = function(e, t) {
        if (e == null)
            return null;
        var n = e[t];
        return S.isFunction(n) ? n.call(e) : n
    }, S.mixin = function(e) {
        x(S.functions(e), function(t) {
            B(t, S[t] = e[t])
        })
    };
    var k = 0;
    S.uniqueId = function(e) {
        var t = k++;
        return e ? e + t : t
    }, S.templateSettings = {evaluate: /<%([\s\S]+?)%>/g,interpolate: /<%=([\s\S]+?)%>/g,escape: /<%-([\s\S]+?)%>/g};
    var L = /.^/, A = {"\\": "\\","'": "'",r: "\r",n: "\n",t: "	",u2028: "\u2028",u2029: "\u2029"};
    for (var O in A)
        A[A[O]] = O;
    var M = /\\|'|\r|\n|\t|\u2028|\u2029/g, _ = /\\(\\|'|r|n|t|u2028|u2029)/g, D = function(e) {
        return e.replace(_, function(e, t) {
            return A[t]
        })
    };
    S.template = function(e, t, n) {
        n = S.defaults(n || {}, S.templateSettings);
        var r = "__p+='" + e.replace(M, function(e) {
            return "\\" + A[e]
        }).replace(n.escape || L, function(e, t) {
            return "'+\n_.escape(" + D(t) + ")+\n'"
        }).replace(n.interpolate || L, function(e, t) {
            return "'+\n(" + D(t) + ")+\n'"
        }).replace(n.evaluate || L, function(e, t) {
            return "';\n" + D(t) + "\n;__p+='"
        }) + "';\n";
        n.variable || (r = "with(obj||{}){\n" + r + "}\n"), r = "var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n" + r + "return __p;\n";
        var i = new Function(n.variable || "obj", "_", r);
        if (t)
            return i(t, S);
        var s = function(e) {
            return i.call(this, e, S)
        };
        return s.source = "function(" + (n.variable || "obj") + "){\n" + r + "}", s
    }, S.chain = function(e) {
        return S(e).chain()
    };
    var P = function(e) {
        this._wrapped = e
    };
    S.prototype = P.prototype;
    var H = function(e, t) {
        return t ? S(e).chain() : e
    }, B = function(e, t) {
        P.prototype[e] = function() {
            var e = o.call(arguments);
            return u.call(e, this._wrapped), H(t.apply(S, e), this._chain)
        }
    };
    S.mixin(S), x(["pop", "push", "reverse", "shift", "sort", "splice", "unshift"], function(e) {
        var t = r[e];
        P.prototype[e] = function() {
            var n = this._wrapped;
            t.apply(n, arguments);
            var r = n.length;
            return (e == "shift" || e == "splice") && r === 0 && delete n[0], H(n, this._chain)
        }
    }), x(["concat", "join", "slice"], function(e) {
        var t = r[e];
        P.prototype[e] = function() {
            return H(t.apply(this._wrapped, arguments), this._chain)
        }
    }), P.prototype.chain = function() {
        return this._chain = !0, this
    }, P.prototype.value = function() {
        return this._wrapped
    }
}).call(this), define("underscore", function(e) {
    return function() {
        var t, n;
        return t || e._
    }
}(this)), function() {
    var e = this, t = e.Backbone, n = Array.prototype.slice, r = Array.prototype.splice, i;
    typeof exports != "undefined" ? i = exports : i = e.Backbone = {}, i.VERSION = "0.9.2";
    var s = e._;
    !s && typeof require != "undefined" && (s = require("underscore"));
    var o = e.jQuery || e.Zepto || e.ender;
    i.setDomLibrary = function(e) {
        o = e
    }, i.noConflict = function() {
        return e.Backbone = t, this
    }, i.emulateHTTP = !1, i.emulateJSON = !1;
    var u = /\s+/, a = i.Events = {on: function(e, t, n) {
            var r, i, s, o, a;
            if (!t)
                return this;
            e = e.split(u), r = this._callbacks || (this._callbacks = {});
            while (i = e.shift())
                a = r[i], s = a ? a.tail : {}, s.next = o = {}, s.context = n, s.callback = t, r[i] = {tail: o,next: a ? a.next : s};
            return this
        },off: function(e, t, n) {
            var r, i, o, a, f, l;
            if (!(i = this._callbacks))
                return;
            if (!(e || t || n))
                return delete this._callbacks, this;
            e = e ? e.split(u) : s.keys(i);
            while (r = e.shift()) {
                o = i[r], delete i[r];
                if (!o || !t && !n)
                    continue;
                a = o.tail;
                while ((o = o.next) !== a)
                    f = o.callback, l = o.context, (t && f !== t || n && l !== n) && this.on(r, f, l)
            }
            return this
        },trigger: function(e) {
            var t, r, i, s, o, a, f;
            if (!(i = this._callbacks))
                return this;
            a = i.all, e = e.split(u), f = n.call(arguments, 1);
            while (t = e.shift()) {
                if (r = i[t]) {
                    s = r.tail;
                    while ((r = r.next) !== s)
                        r.callback.apply(r.context || this, f)
                }
                if (r = a) {
                    s = r.tail, o = [t].concat(f);
                    while ((r = r.next) !== s)
                        r.callback.apply(r.context || this, o)
                }
            }
            return this
        }};
    a.bind = a.on, a.unbind = a.off;
    var f = i.Model = function(e, t) {
        var n;
        e || (e = {}), t && t.parse && (e = this.parse(e));
        if (n = C(this, "defaults"))
            e = s.extend({}, n, e);
        t && t.collection && (this.collection = t.collection), this.attributes = {}, this._escapedAttributes = {}, this.cid = s.uniqueId("c"), this.changed = {}, this._silent = {}, this._pending = {}, this.set(e, {silent: !0}), this.changed = {}, this._silent = {}, this._pending = {}, this._previousAttributes = s.clone(this.attributes), this.initialize.apply(this, arguments)
    };
    s.extend(f.prototype, a, {changed: null,_silent: null,_pending: null,idAttribute: "id",initialize: function() {
        },toJSON: function(e) {
            return s.clone(this.attributes)
        },get: function(e) {
            return this.attributes[e]
        },escape: function(e) {
            var t;
            if (t = this._escapedAttributes[e])
                return t;
            var n = this.get(e);
            return this._escapedAttributes[e] = s.escape(n == null ? "" : "" + n)
        },has: function(e) {
            return this.get(e) != null
        },set: function(e, t, n) {
            var r, i, o;
            s.isObject(e) || e == null ? (r = e, n = t) : (r = {}, r[e] = t), n || (n = {});
            if (!r)
                return this;
            r instanceof f && (r = r.attributes);
            if (n.unset)
                for (i in r)
                    r[i] = void 0;
            if (!this._validate(r, n))
                return !1;
            this.idAttribute in r && (this.id = r[this.idAttribute]);
            var u = n.changes = {}, a = this.attributes, l = this._escapedAttributes, c = this._previousAttributes || {};
            for (i in r) {
                o = r[i];
                if (!s.isEqual(a[i], o) || n.unset && s.has(a, i))
                    delete l[i], (n.silent ? this._silent : u)[i] = !0;
                n.unset ? delete a[i] : a[i] = o, !s.isEqual(c[i], o) || s.has(a, i) != s.has(c, i) ? (this.changed[i] = o, n.silent || (this._pending[i] = !0)) : (delete this.changed[i], delete this._pending[i])
            }
            return n.silent || this.change(n), this
        },unset: function(e, t) {
            return (t || (t = {})).unset = !0, this.set(e, null, t)
        },clear: function(e) {
            return (e || (e = {})).unset = !0, this.set(s.clone(this.attributes), e)
        },fetch: function(e) {
            e = e ? s.clone(e) : {};
            var t = this, n = e.success;
            return e.success = function(r, i, s) {
                if (!t.set(t.parse(r, s), e))
                    return !1;
                n && n(t, r)
            }, e.error = i.wrapError(e.error, t, e), (this.sync || i.sync).call(this, "read", this, e)
        },save: function(e, t, n) {
            var r, o;
            s.isObject(e) || e == null ? (r = e, n = t) : (r = {}, r[e] = t), n = n ? s.clone(n) : {};
            if (n.wait) {
                if (!this._validate(r, n))
                    return !1;
                o = s.clone(this.attributes)
            }
            var u = s.extend({}, n, {silent: !0});
            if (r && !this.set(r, n.wait ? u : n))
                return !1;
            var a = this, f = n.success;
            n.success = function(e, t, i) {
                var o = a.parse(e, i);
                n.wait && (delete n.wait, o = s.extend(r || {}, o));
                if (!a.set(o, n))
                    return !1;
                f ? f(a, e) : a.trigger("sync", a, e, n)
            }, n.error = i.wrapError(n.error, a, n);
            var l = this.isNew() ? "create" : "update", c = (this.sync || i.sync).call(this, l, this, n);
            return n.wait && this.set(o, u), c
        },destroy: function(e) {
            e = e ? s.clone(e) : {};
            var t = this, n = e.success, r = function() {
                t.trigger("destroy", t, t.collection, e)
            };
            if (this.isNew())
                return r(), !1;
            e.success = function(i) {
                e.wait && r(), n ? n(t, i) : t.trigger("sync", t, i, e)
            }, e.error = i.wrapError(e.error, t, e);
            var o = (this.sync || i.sync).call(this, "delete", this, e);
            return e.wait || r(), o
        },url: function() {
            var e = C(this, "urlRoot") || C(this.collection, "url") || k();
            return this.isNew() ? e : e + (e.charAt(e.length - 1) == "/" ? "" : "/") + encodeURIComponent(this.id)
        },parse: function(e, t) {
            return e
        },clone: function() {
            return new this.constructor(this.attributes)
        },isNew: function() {
            return this.id == null
        },change: function(e) {
            e || (e = {});
            var t = this._changing;
            this._changing = !0;
            for (var n in this._silent)
                this._pending[n] = !0;
            var r = s.extend({}, e.changes, this._silent);
            this._silent = {};
            for (var n in r)
                this.trigger("change:" + n, this, this.get(n), e);
            if (t)
                return this;
            while (!s.isEmpty(this._pending)) {
                this._pending = {}, this.trigger("change", this, e);
                for (var n in this.changed) {
                    if (this._pending[n] || this._silent[n])
                        continue;
                    delete this.changed[n]
                }
                this._previousAttributes = s.clone(this.attributes)
            }
            return this._changing = !1, this
        },hasChanged: function(e) {
            return arguments.length ? s.has(this.changed, e) : !s.isEmpty(this.changed)
        },changedAttributes: function(e) {
            if (!e)
                return this.hasChanged() ? s.clone(this.changed) : !1;
            var t, n = !1, r = this._previousAttributes;
            for (var i in e) {
                if (s.isEqual(r[i], t = e[i]))
                    continue;
                (n || (n = {}))[i] = t
            }
            return n
        },previous: function(e) {
            return !arguments.length || !this._previousAttributes ? null : this._previousAttributes[e]
        },previousAttributes: function() {
            return s.clone(this._previousAttributes)
        },isValid: function() {
            return !this.validate(this.attributes)
        },_validate: function(e, t) {
            if (t.silent || !this.validate)
                return !0;
            e = s.extend({}, this.attributes, e);
            var n = this.validate(e, t);
            return n ? (t && t.error ? t.error(this, n, t) : this.trigger("error", this, n, t), !1) : !0
        }});
    var l = i.Collection = function(e, t) {
        t || (t = {}), t.model && (this.model = t.model), t.comparator && (this.comparator = t.comparator), this._reset(), this.initialize.apply(this, arguments), e && this.reset(e, {silent: !0,parse: t.parse})
    };
    s.extend(l.prototype, a, {model: f,initialize: function() {
        },toJSON: function(e) {
            return this.map(function(t) {
                return t.toJSON(e)
            })
        },add: function(e, t) {
            var n, i, o, u, a, f, l = {}, c = {}, h = [];
            t || (t = {}), e = s.isArray(e) ? e.slice() : [e];
            for (n = 0, o = e.length; n < o; n++) {
                if (!(u = e[n] = this._prepareModel(e[n], t)))
                    throw new Error("Can't add an invalid model to a collection");
                a = u.cid, f = u.id;
                if (l[a] || this._byCid[a] || f != null && (c[f] || this._byId[f])) {
                    h.push(n);
                    continue
                }
                l[a] = c[f] = u
            }
            n = h.length;
            while (n--)
                e.splice(h[n], 1);
            for (n = 0, o = e.length; n < o; n++)
                (u = e[n]).on("all", this._onModelEvent, this), this._byCid[u.cid] = u, u.id != null && (this._byId[u.id] = u);
            this.length += o, i = t.at != null ? t.at : this.models.length, r.apply(this.models, [i, 0].concat(e)), this.comparator && this.sort({silent: !0});
            if (t.silent)
                return this;
            for (n = 0, o = this.models.length; n < o; n++) {
                if (!l[(u = this.models[n]).cid])
                    continue;
                t.index = n, u.trigger("add", u, this, t)
            }
            return this
        },remove: function(e, t) {
            var n, r, i, o;
            t || (t = {}), e = s.isArray(e) ? e.slice() : [e];
            for (n = 0, r = e.length; n < r; n++) {
                o = this.getByCid(e[n]) || this.get(e[n]);
                if (!o)
                    continue;
                delete this._byId[o.id], delete this._byCid[o.cid], i = this.indexOf(o), this.models.splice(i, 1), this.length--, t.silent || (t.index = i, o.trigger("remove", o, this, t)), this._removeReference(o)
            }
            return this
        },push: function(e, t) {
            return e = this._prepareModel(e, t), this.add(e, t), e
        },pop: function(e) {
            var t = this.at(this.length - 1);
            return this.remove(t, e), t
        },unshift: function(e, t) {
            return e = this._prepareModel(e, t), this.add(e, s.extend({at: 0}, t)), e
        },shift: function(e) {
            var t = this.at(0);
            return this.remove(t, e), t
        },get: function(e) {
            return e == null ? void 0 : this._byId[e.id != null ? e.id : e]
        },getByCid: function(e) {
            return e && this._byCid[e.cid || e]
        },at: function(e) {
            return this.models[e]
        },where: function(e) {
            return s.isEmpty(e) ? [] : this.filter(function(t) {
                for (var n in e)
                    if (e[n] !== t.get(n))
                        return !1;
                return !0
            })
        },sort: function(e) {
            e || (e = {});
            if (!this.comparator)
                throw new Error("Cannot sort a set without a comparator");
            var t = s.bind(this.comparator, this);
            return this.comparator.length == 1 ? this.models = this.sortBy(t) : this.models.sort(t), e.silent || this.trigger("reset", this, e), this
        },pluck: function(e) {
            return s.map(this.models, function(t) {
                return t.get(e)
            })
        },reset: function(e, t) {
            e || (e = []), t || (t = {});
            for (var n = 0, r = this.models.length; n < r; n++)
                this._removeReference(this.models[n]);
            return this._reset(), this.add(e, s.extend({silent: !0}, t)), t.silent || this.trigger("reset", this, t), this
        },fetch: function(e) {
            e = e ? s.clone(e) : {}, e.parse === undefined && (e.parse = !0);
            var t = this, n = e.success;
            return e.success = function(r, i, s) {
                t[e.add ? "add" : "reset"](t.parse(r, s), e), n && n(t, r)
            }, e.error = i.wrapError(e.error, t, e), (this.sync || i.sync).call(this, "read", this, e)
        },create: function(e, t) {
            var n = this;
            t = t ? s.clone(t) : {}, e = this._prepareModel(e, t);
            if (!e)
                return !1;
            t.wait || n.add(e, t);
            var r = t.success;
            return t.success = function(i, s, o) {
                t.wait && n.add(i, t), r ? r(i, s) : i.trigger("sync", e, s, t)
            }, e.save(null, t), e
        },parse: function(e, t) {
            return e
        },chain: function() {
            return s(this.models).chain()
        },_reset: function(e) {
            this.length = 0, this.models = [], this._byId = {}, this._byCid = {}
        },_prepareModel: function(e, t) {
            t || (t = {});
            if (e instanceof f)
                e.collection || (e.collection = this);
            else {
                var n = e;
                t.collection = this, e = new this.model(n, t), e._validate(e.attributes, t) || (e = !1)
            }
            return e
        },_removeReference: function(e) {
            this == e.collection && delete e.collection, e.off("all", this._onModelEvent, this)
        },_onModelEvent: function(e, t, n, r) {
            if ((e == "add" || e == "remove") && n != this)
                return;
            e == "destroy" && this.remove(t, r), t && e === "change:" + t.idAttribute && (delete this._byId[t.previous(t.idAttribute)], this._byId[t.id] = t), this.trigger.apply(this, arguments)
        }});
    var c = ["forEach", "each", "map", "reduce", "reduceRight", "find", "detect", "filter", "select", "reject", "every", "all", "some", "any", "include", "contains", "invoke", "max", "min", "sortBy", "sortedIndex", "toArray", "size", "first", "initial", "rest", "last", "without", "indexOf", "shuffle", "lastIndexOf", "isEmpty", "groupBy"];
    s.each(c, function(e) {
        l.prototype[e] = function() {
            return s[e].apply(s, [this.models].concat(s.toArray(arguments)))
        }
    });
    var h = i.Router = function(e) {
        e || (e = {}), e.routes && (this.routes = e.routes), this._bindRoutes(), this.initialize.apply(this, arguments)
    }, p = /:\w+/g, d = /\*\w+/g, v = /[-[\]{}()+?.,\\^$|#\s]/g;
    s.extend(h.prototype, a, {initialize: function() {
        },route: function(e, t, n) {
            return i.history || (i.history = new m), s.isRegExp(e) || (e = this._routeToRegExp(e)), n || (n = this[t]), i.history.route(e, s.bind(function(r) {
                var s = this._extractParameters(e, r);
                n && n.apply(this, s), this.trigger.apply(this, ["route:" + t].concat(s)), i.history.trigger("route", this, t, s)
            }, this)), this
        },navigate: function(e, t) {
            i.history.navigate(e, t)
        },_bindRoutes: function() {
            if (!this.routes)
                return;
            var e = [];
            for (var t in this.routes)
                e.unshift([t, this.routes[t]]);
            for (var n = 0, r = e.length; n < r; n++)
                this.route(e[n][0], e[n][1], this[e[n][1]])
        },_routeToRegExp: function(e) {
            return e = e.replace(v, "\\$&").replace(p, "([^/]+)").replace(d, "(.*?)"), new RegExp("^" + e + "$")
        },_extractParameters: function(e, t) {
            return e.exec(t).slice(1)
        }});
    var m = i.History = function() {
        this.handlers = [], s.bindAll(this, "checkUrl")
    }, g = /^[#\/]/, y = /msie [\w.]+/;
    m.started = !1, s.extend(m.prototype, a, {interval: 50,getHash: function(e) {
            var t = e ? e.location : window.location, n = t.href.match(/#(.*)$/);
            return n ? n[1] : ""
        },getFragment: function(e, t) {
            if (e == null)
                if (this._hasPushState || t) {
                    e = window.location.pathname;
                    var n = window.location.search;
                    n && (e += n)
                } else
                    e = this.getHash();
            return e.indexOf(this.options.root) || (e = e.substr(this.options.root.length)), e.replace(g, "")
        },start: function(e) {
            if (m.started)
                throw new Error("Backbone.history has already been started");
            m.started = !0, this.options = s.extend({}, {root: "/"}, this.options, e), this._wantsHashChange = this.options.hashChange !== !1, this._wantsPushState = !!this.options.pushState, this._hasPushState = !!(this.options.pushState && window.history && window.history.pushState);
            var t = this.getFragment(), n = document.documentMode, r = y.exec(navigator.userAgent.toLowerCase()) && (!n || n <= 7);
            r && (this.iframe = o('<iframe src="javascript:0" tabindex="-1" />').hide().appendTo("body")[0].contentWindow, this.navigate(t)), this._hasPushState ? o(window).bind("popstate", this.checkUrl) : this._wantsHashChange && "onhashchange" in window && !r ? o(window).bind("hashchange", this.checkUrl) : this._wantsHashChange && (this._checkUrlInterval = setInterval(this.checkUrl, this.interval)), this.fragment = t;
            var i = window.location, u = i.pathname == this.options.root;
            if (this._wantsHashChange && this._wantsPushState && !this._hasPushState && !u)
                return this.fragment = this.getFragment(null, !0), window.location.replace(this.options.root + "#" + this.fragment), !0;
            this._wantsPushState && this._hasPushState && u && i.hash && (this.fragment = this.getHash().replace(g, ""), window.history.replaceState({}, document.title, i.protocol + "//" + i.host + this.options.root + this.fragment));
            if (!this.options.silent)
                return this.loadUrl()
        },stop: function() {
            o(window).unbind("popstate", this.checkUrl).unbind("hashchange", this.checkUrl), clearInterval(this._checkUrlInterval), m.started = !1
        },route: function(e, t) {
            this.handlers.unshift({route: e,callback: t})
        },checkUrl: function(e) {
            var t = this.getFragment();
            t == this.fragment && this.iframe && (t = this.getFragment(this.getHash(this.iframe)));
            if (t == this.fragment)
                return !1;
            this.iframe && this.navigate(t), this.loadUrl() || this.loadUrl(this.getHash())
        },loadUrl: function(e) {
            var t = this.fragment = this.getFragment(e), n = s.any(this.handlers, function(e) {
                if (e.route.test(t))
                    return e.callback(t), !0
            });
            return n
        },navigate: function(e, t) {
            if (!m.started)
                return !1;
            if (!t || t === !0)
                t = {trigger: t};
            var n = (e || "").replace(g, "");
            if (this.fragment == n)
                return;
            this._hasPushState ? (n.indexOf(this.options.root) != 0 && (n = this.options.root + n), this.fragment = n, window.history[t.replace ? "replaceState" : "pushState"]({}, document.title, n)) : this._wantsHashChange ? (this.fragment = n, this._updateHash(window.location, n, t.replace), this.iframe && n != this.getFragment(this.getHash(this.iframe)) && (t.replace || this.iframe.document.open().close(), this._updateHash(this.iframe.location, n, t.replace))) : window.location.assign(this.options.root + e), t.trigger && this.loadUrl(e)
        },_updateHash: function(e, t, n) {
            n ? e.replace(e.toString().replace(/(javascript:|#).*$/, "") + "#" + t) : e.hash = t
        }});
    var b = i.View = function(e) {
        this.cid = s.uniqueId("view"), this._configure(e || {}), this._ensureElement(), this.initialize.apply(this, arguments), this.delegateEvents()
    }, w = /^(\S+)\s*(.*)$/, E = ["model", "collection", "el", "id", "attributes", "className", "tagName"];
    s.extend(b.prototype, a, {tagName: "div",$: function(e) {
            return this.$el.find(e)
        },initialize: function() {
        },render: function() {
            return this
        },remove: function() {
            return this.$el.remove(), this
        },make: function(e, t, n) {
            var r = document.createElement(e);
            return t && o(r).attr(t), n && o(r).html(n), r
        },setElement: function(e, t) {
            return this.$el && this.undelegateEvents(), this.$el = e instanceof o ? e : o(e), this.el = this.$el[0], t !== !1 && this.delegateEvents(), this
        },delegateEvents: function(e) {
            if (!e && !(e = C(this, "events")))
                return;
            this.undelegateEvents();
            for (var t in e) {
                var n = e[t];
                s.isFunction(n) || (n = this[e[t]]);
                if (!n)
                    throw new Error('Method "' + e[t] + '" does not exist');
                var r = t.match(w), i = r[1], o = r[2];
                n = s.bind(n, this), i += ".delegateEvents" + this.cid, o === "" ? this.$el.bind(i, n) : this.$el.delegate(o, i, n)
            }
        },undelegateEvents: function() {
            this.$el.unbind(".delegateEvents" + this.cid)
        },_configure: function(e) {
            this.options && (e = s.extend({}, this.options, e));
            for (var t = 0, n = E.length; t < n; t++) {
                var r = E[t];
                e[r] && (this[r] = e[r])
            }
            this.options = e
        },_ensureElement: function() {
            if (!this.el) {
                var e = C(this, "attributes") || {};
                this.id && (e.id = this.id), this.className && (e["class"] = this.className), this.setElement(this.make(this.tagName, e), !1)
            } else
                this.setElement(this.el, !1)
        }});
    var S = function(e, t) {
        var n = N(this, e, t);
        return n.extend = this.extend, n
    };
    f.extend = l.extend = h.extend = b.extend = S;
    var x = {create: "POST",update: "PUT","delete": "DELETE",read: "GET"};
    i.sync = function(e, t, n) {
        var r = x[e];
        n || (n = {});
        var u = {type: r,dataType: "json"};
        return n.url || (u.url = C(t, "url") || k()), !n.data && t && (e == "create" || e == "update") && (u.contentType = "application/json", u.data = JSON.stringify(t.toJSON())), i.emulateJSON && (u.contentType = "application/x-www-form-urlencoded", u.data = u.data ? {model: u.data} : {}), i.emulateHTTP && (r === "PUT" || r === "DELETE") && (i.emulateJSON && (u.data._method = r), u.type = "POST", u.beforeSend = function(e) {
            e.setRequestHeader("X-HTTP-Method-Override", r)
        }), u.type !== "GET" && !i.emulateJSON && (u.processData = !1), o.ajax(s.extend(u, n))
    }, i.wrapError = function(e, t, n) {
        return function(r, i) {
            i = r === t ? i : r, e ? e(t, i, n) : t.trigger("error", t, i, n)
        }
    };
    var T = function() {
    }, N = function(e, t, n) {
        var r;
        return t && t.hasOwnProperty("constructor") ? r = t.constructor : r = function() {
            e.apply(this, arguments)
        }, s.extend(r, e), T.prototype = e.prototype, r.prototype = new T, t && s.extend(r.prototype, t), n && s.extend(r, n), r.prototype.constructor = r, r.__super__ = e.prototype, r
    }, C = function(e, t) {
        return !e || !e[t] ? null : s.isFunction(e[t]) ? e[t]() : e[t]
    }, k = function() {
        throw new Error('A "url" property or function must be specified')
    }
}.call(this), define("backbone", ["underscore", "jquery"], function(e) {
    return function() {
        var t, n;
        return t || e.Backbone
    }
}(this)), Backbone.Marionette = function(e, t, n) {
    var r = {};
    r.EventBinder = function() {
        this._eventBindings = []
    }, t.extend(r.EventBinder.prototype, {bindTo: function(e, t, n, r) {
            r = r || this, e.on(t, n, r);
            var i = {obj: e,eventName: t,callback: n,context: r};
            return this._eventBindings.push(i), i
        },unbindFrom: function(e) {
            e.obj.off(e.eventName, e.callback, e.context), this._eventBindings = t.reject(this._eventBindings, function(t) {
                return t === e
            })
        },unbindAll: function() {
            var e = this, n = t.map(this._eventBindings, t.identity);
            t.each(n, function(t, n) {
                e.unbindFrom(t)
            })
        }}), r.EventBinder.extend = e.View.extend, r.View = e.View.extend({constructor: function() {
            var n = new r.EventBinder;
            t.extend(this, n), e.View.prototype.constructor.apply(this, arguments), this.bindTo(this, "show", this.onShowCalled, this)
        },getTemplate: function() {
            var e;
            return this.options && this.options.template ? e = this.options.template : e = this.template, e
        },serializeData: function() {
            var e;
            return this.model ? e = this.model.toJSON() : this.collection && (e = {items: this.collection.toJSON()}), e = this.mixinTemplateHelpers(e), e
        },mixinTemplateHelpers: function(e) {
            e = e || {};
            var n = this.templateHelpers;
            return t.isFunction(n) && (n = n.call(this)), t.extend(e, n)
        },configureTriggers: function() {
            if (!this.triggers)
                return;
            var e = this.triggers, n = this, r = {};
            return t.isFunction(e) && (e = e.call(this)), t.each(e, function(e, t) {
                r[t] = function(t) {
                    t && t.preventDefault && t.preventDefault(), t && t.stopPropagation && t.stopPropagation(), n.trigger(e)
                }
            }), r
        },delegateEvents: function(n) {
            n = n || this.events, t.isFunction(n) && (n = n.call(this));
            var r = {}, i = this.configureTriggers();
            t.extend(r, n, i), e.View.prototype.delegateEvents.call(this, r)
        },onShowCalled: function() {
        },close: function() {
            this.beforeClose && this.beforeClose(), this.remove(), this.onClose && this.onClose(), this.trigger("close"), this.unbindAll(), this.unbind()
        },bindUIElements: function() {
            if (!this.ui)
                return;
            var e = this;
            this.uiBindings || (this.uiBindings = this.ui), this.ui = {}, t.each(t.keys(this.uiBindings), function(t) {
                var n = e.uiBindings[t];
                e.ui[t] = e.$(n)
            })
        }}), r.ItemView = r.View.extend({constructor: function() {
            r.View.prototype.constructor.apply(this, arguments), this.initialEvents && this.initialEvents()
        },render: function() {
            this.beforeRender && this.beforeRender(), this.trigger("before:render", this), this.trigger("item:before:render", this);
            var e = this.serializeData(), t = this.getTemplate(), n = r.Renderer.render(t, e);
            return this.$el.html(n), this.bindUIElements(), this.onRender && this.onRender(), this.trigger("render", this), this.trigger("item:rendered", this), this
        },close: function() {
            this.trigger("item:before:close"), r.View.prototype.close.apply(this, arguments), this.trigger("item:closed")
        }}), r.CollectionView = r.View.extend({constructor: function() {
            r.View.prototype.constructor.apply(this, arguments), this.initChildViewStorage(), this.initialEvents(), this.onShowCallbacks = new r.Callbacks
        },initialEvents: function() {
            this.collection && (this.bindTo(this.collection, "add", this.addChildView, this), this.bindTo(this.collection, "remove", this.removeItemView, this), this.bindTo(this.collection, "reset", this.render, this))
        },addChildView: function(e, t, n) {
            this.closeEmptyView();
            var r = this.getItemView();
            return this.addItemView(e, r, n.index)
        },onShowCalled: function() {
            this.onShowCallbacks.run()
        },triggerBeforeRender: function() {
            this.beforeRender && this.beforeRender(), this.trigger("before:render", this), this.trigger("collection:before:render", this)
        },triggerRendered: function() {
            this.onRender && this.onRender(), this.trigger("render", this), this.trigger("collection:rendered", this)
        },render: function() {
            return this.triggerBeforeRender(), this.closeEmptyView(), this.closeChildren(), this.collection && this.collection.length > 0 ? this.showCollection() : this.showEmptyView(), this.triggerRendered(), this
        },showCollection: function() {
            var e = this, t = this.getItemView();
            this.collection.each(function(n, r) {
                e.addItemView(n, t, r)
            })
        },showEmptyView: function() {
            var t = this.options.emptyView || this.emptyView;
            if (t && !this._showingEmptyView) {
                this._showingEmptyView = !0;
                var n = new e.Model;
                this.addItemView(n, t, 0)
            }
        },closeEmptyView: function() {
            this._showingEmptyView && (this.closeChildren(), delete this._showingEmptyView)
        },getItemView: function() {
            var e = this.options.itemView || this.itemView;
            if (!e) {
                var t = new Error("An `itemView` must be specified");
                throw t.name = "NoItemViewError", t
            }
            return e
        },addItemView: function(e, t, n) {
            var r = this, s = this.buildItemView(e, t);
            this.storeChild(s), this.onItemAdded && this.onItemAdded(s), this.trigger("item:added", s);
            var o = this.renderItemView(s, n);
            s.onShow && this.onShowCallbacks.add(s.onShow, s);
            var u = this.bindTo(s, "all", function() {
                var e = i.call(arguments);
                e[0] = "itemview:" + e[0], e.splice(1, 0, s), r.trigger.apply(r, e)
            });
            return this.childBindings = this.childBindings || {}, this.childBindings[s.cid] = u, o
        },renderItemView: function(e, t) {
            e.render(), this.appendHtml(this, e, t)
        },buildItemView: function(e, n) {
            var r = t.result(this, "itemViewOptions"), i = t.extend({model: e}, r), s = new n(i);
            return s
        },removeItemView: function(e) {
            var t = this.children[e.cid];
            if (t) {
                var n = this.childBindings[t.cid];
                n && (this.unbindFrom(n), delete this.childBindings[t.cid]), t.close(), delete this.children[e.cid]
            }
            (!this.collection || this.collection.length === 0) && this.showEmptyView(), this.trigger("item:removed", t)
        },appendHtml: function(e, t, n) {
            e.$el.append(t.el)
        },storeChild: function(e) {
            this.children[e.model.cid] = e
        },initChildViewStorage: function() {
            this.children = {}
        },close: function() {
            this.trigger("collection:before:close"), this.closeChildren(), r.View.prototype.close.apply(this, arguments), this.trigger("collection:closed")
        },closeChildren: function() {
            var e = this;
            this.children && t.each(t.clone(this.children), function(t) {
                e.removeItemView(t.model)
            })
        }}), r.CompositeView = r.CollectionView.extend({constructor: function(e) {
            r.CollectionView.apply(this, arguments), this.itemView = this.getItemView()
        },initialEvents: function() {
            this.collection && (this.bindTo(this.collection, "add", this.addChildView, this), this.bindTo(this.collection, "remove", this.removeItemView, this), this.bindTo(this.collection, "reset", this.renderCollection, this))
        },getItemView: function() {
            return this.itemView || this.constructor
        },render: function() {
            var e = this;
            this.resetItemViewContainer();
            var t = this.renderModel();
            return this.$el.html(t), this.bindUIElements(), this.trigger("composite:model:rendered"), this.trigger("render"), this.renderCollection(), this.trigger("composite:rendered"), this
        },renderCollection: function() {
            r.CollectionView.prototype.render.apply(this, arguments), this.trigger("composite:collection:rendered")
        },renderModel: function() {
            var e = {};
            e = this.serializeData();
            var t = this.getTemplate();
            return r.Renderer.render(t, e)
        },appendHtml: function(e, t) {
            var n = this.getItemViewContainer(e);
            n.append(t.el)
        },getItemViewContainer: function(e) {
            var n;
            if ("$itemViewContainer" in e)
                n = e.$itemViewContainer;
            else {
                if (e.itemViewContainer) {
                    n = e.$(t.result(e, "itemViewContainer"));
                    if (n.length <= 0) {
                        var r = new Error("Missing `itemViewContainer`");
                        throw r.name = "ItemViewContainerMissingError", r
                    }
                } else
                    n = e.$el;
                e.$itemViewContainer = n
            }
            return n
        },resetItemViewContainer: function() {
            this.$itemViewContainer && delete this.$itemViewContainer
        }}), r.Region = function(e) {
        this.options = e || {};
        var n = new r.EventBinder;
        t.extend(this, n, e);
        if (!this.el) {
            var i = new Error("An 'el' must be specified");
            throw i.name = "NoElError", i
        }
        this.initialize && this.initialize.apply(this, arguments)
    }, t.extend(r.Region.prototype, e.Events, {show: function(e) {
            this.ensureEl(), this.close(), e.render(), this.open(e), e.onShow && e.onShow(), e.trigger("show"), this.onShow && this.onShow(e), this.trigger("view:show", e), this.currentView = e
        },ensureEl: function() {
            if (!this.$el || this.$el.length === 0)
                this.$el = this.getEl(this.el)
        },getEl: function(e) {
            return n(e)
        },open: function(e) {
            this.$el.html(e.el)
        },close: function() {
            var e = this.currentView;
            if (!e)
                return;
            e.close && e.close(), this.trigger("view:closed", e), delete this.currentView
        },attachView: function(e) {
            this.currentView = e
        },reset: function() {
            this.close(), delete this.$el
        }}), r.Region.extend = e.View.extend, r.Layout = r.ItemView.extend({regionType: r.Region,constructor: function() {
            e.Marionette.ItemView.apply(this, arguments), this.initializeRegions()
        },render: function() {
            var e = r.ItemView.prototype.render.apply(this, arguments);
            return this.render = function() {
                this.closeRegions(), this.reInitializeRegions();
                var e = r.ItemView.prototype.render.apply(this, arguments);
                return e
            }, e
        },close: function() {
            this.closeRegions(), this.destroyRegions(), e.Marionette.ItemView.prototype.close.call(this, arguments)
        },initializeRegions: function() {
            this.regionManagers || (this.regionManagers = {});
            var e = this;
            t.each(this.regions, function(t, n) {
                if (typeof t != "string" && typeof t.selector != "string")
                    throw new Exception("Region must be specified as a selector string or an object with selector property");
                selector = typeof t == "string" ? t : t.selector;
                var r = typeof t.regionType == "undefined" ? e.regionType : t.regionType, i = new r({el: selector,getEl: function(t) {
                        return e.$(t)
                    }});
                e.regionManagers[n] = i, e[n] = i
            })
        },reInitializeRegions: function() {
            this.regionManagers && t.size(this.regionManagers) === 0 ? this.initializeRegions() : t.each(this.regionManagers, function(e) {
                e.reset()
            })
        },closeRegions: function() {
            var e = this;
            t.each(this.regionManagers, function(e, t) {
                e.close()
            })
        },destroyRegions: function() {
            var e = this;
            t.each(this.regionManagers, function(t, n) {
                delete e[n]
            }), this.regionManagers = {}
        }}), r.Application = function(e) {
        this.initCallbacks = new r.Callbacks, this.vent = new r.EventAggregator, this.submodules = {};
        var n = new r.EventBinder;
        t.extend(this, n, e)
    }, t.extend(r.Application.prototype, e.Events, {addInitializer: function(e) {
            this.initCallbacks.add(e)
        },start: function(e) {
            this.trigger("initialize:before", e), this.initCallbacks.run(e, this), this.trigger("initialize:after", e), this.trigger("start", e)
        },addRegions: function(e) {
            var t, n, i;
            for (i in e)
                e.hasOwnProperty(i) && (t = e[i], typeof t == "string" ? n = new r.Region({el: t}) : n = new t, this[i] = n)
        },removeRegion: function(e) {
            this[e].close(), delete this[e]
        },module: function(e, t) {
            var n = i.call(arguments);
            return n.unshift(this), r.Module.create.apply(r.Module, n)
        }}), r.Application.extend = e.View.extend, r.AppRouter = e.Router.extend({constructor: function(t) {
            e.Router.prototype.constructor.call(this, t);
            if (this.appRoutes) {
                var n = this.controller;
                t && t.controller && (n = t.controller), this.processAppRoutes(n, this.appRoutes)
            }
        },processAppRoutes: function(e, n) {
            var r, i, s, o, u, a = [], f = this;
            for (s in n)
                n.hasOwnProperty(s) && a.unshift([s, n[s]]);
            o = a.length;
            for (u = 0; u < o; u++) {
                s = a[u][0], i = a[u][1], r = e[i];
                if (!r) {
                    var l = "Method '" + i + "' was not found on the controller", c = new Error(l);
                    throw c.name = "NoMethodError", c
                }
                r = t.bind(r, e), f.route(s, i, r)
            }
        }}), r.Module = function(e, n, i) {
        this.moduleName = e, this.submodules = {}, this._setupInitializersAndFinalizers(), this._config = {}, this._config.app = n, this._config.customArgs = i, this._config.definitions = [];
        var s = new r.EventBinder;
        t.extend(this, s)
    }, t.extend(r.Module.prototype, e.Events, {addInitializer: function(e) {
            this._initializerCallbacks.add(e)
        },addFinalizer: function(e) {
            this._finalizerCallbacks.add(e)
        },start: function(e) {
            if (this._isInitialized)
                return;
            this._runModuleDefinition(), this._initializerCallbacks.run(e, this), this._isInitialized = !0, this.submodules && t.each(this.submodules, function(t) {
                t.start(e)
            })
        },stop: function() {
            if (!this._isInitialized)
                return;
            this._isInitialized = !1, this._finalizerCallbacks.run(), this._setupInitializersAndFinalizers(), t.each(this.submodules, function(e) {
                e.stop()
            })
        },addDefinition: function(e) {
            this._config.definitions.push(e)
        },_runModuleDefinition: function() {
            if (this._config.definitions.length === 0)
                return;
            var i = t.flatten([this, this._config.app, e, r, n, t, this._config.customArgs]), s = this._config.definitions.length - 1;
            for (var o = 0; o <= s; o++) {
                var u = this._config.definitions[o];
                u.apply(this, i)
            }
        },_setupInitializersAndFinalizers: function() {
            this._initializerCallbacks = new r.Callbacks, this._finalizerCallbacks = new r.Callbacks
        }}), t.extend(r.Module, {create: function(e, n, s) {
            var o = this, u = e;
            n = n.split(".");
            var a = i.apply(arguments);
            a.splice(0, 3);
            var f = n.length;
            return t.each(n, function(t, n) {
                var i = n === f - 1, l = u[t];
                l || (l = new r.Module(t, e, a), u[t] = l, u.submodules[t] = l), i && o._createModuleDefinition(l, s, e), u = l
            }), u
        },_createModuleDefinition: function(e, t, n) {
            var r = this._getModuleDefinitionOptions(t);
            r.definition && e.addDefinition(r.definition), r.startWithApp && n.addInitializer(function(t) {
                e.start(t)
            })
        },_getModuleDefinitionOptions: function(e) {
            var n = {startWithApp: !0};
            return e ? (t.isFunction(e) ? n.definition = e : (n.definition = e.define, e.hasOwnProperty("startWithApp") && (n.startWithApp = e.startWithApp)), n) : n
        }}), r.TemplateCache = function(e) {
        this.templateId = e
    }, t.extend(r.TemplateCache, {templateCaches: {},get: function(e) {
            var t = this, n = this.templateCaches[e];
            return n || (n = new r.TemplateCache(e), this.templateCaches[e] = n), n.load()
        },clear: function() {
            var e, t = arguments.length;
            if (t > 0)
                for (e = 0; e < t; e++)
                    delete this.templateCaches[arguments[e]];
            else
                this.templateCaches = {}
        }}), t.extend(r.TemplateCache.prototype, {load: function() {
            var e = this;
            if (this.compiledTemplate)
                return this.compiledTemplate;
            var t = this.loadTemplate(this.templateId);
            return this.compiledTemplate = this.compileTemplate(t), this.compiledTemplate
        },loadTemplate: function(e) {
            var t = n(e).html();
            if (!t || t.length === 0) {
                var r = "Could not find template: '" + e + "'", i = new Error(r);
                throw i.name = "NoTemplateError", i
            }
            return t
        },compileTemplate: function(e) {
            return t.template(e)
        }}), r.Renderer = {render: function(e, t) {
            var n = typeof e == "function" ? e : r.TemplateCache.get(e), i = n(t);
            return i
        }}, r.Callbacks = function() {
        this.deferred = n.Deferred(), this.promise = this.deferred.promise()
    }, t.extend(r.Callbacks.prototype, {add: function(e, t) {
            this.promise.done(function(n, r) {
                t && (n = t), e.call(n, r)
            })
        },run: function(e, t) {
            this.deferred.resolve(t, e)
        }}), r.EventAggregator = r.EventBinder.extend({constructor: function(e) {
            r.EventBinder.apply(this, arguments), t.extend(this, e)
        },bindTo: function(e, t, n) {
            return r.EventBinder.prototype.bindTo.call(this, this, e, t, n)
        }}), t.extend(r.EventAggregator.prototype, e.Events), r.EventAggregator.extend = e.View.extend;
    var i = Array.prototype.slice;
    return r
}(Backbone, _, window.jQuery || window.Zepto || window.ender), define("backbone.marionette", function() {
}), APP = window.APP = {}, APP.collections = {helpers: {}}, APP.models = {}, APP.views = {}, APP.routers = {}, APP.state = {vars: {images: {},urls: {},globals: {}}}, APP.cache = {}, APP.dialogs = {}, APP.templates = {}, define("app", function(e) {
    return function() {
        var t, n;
        return t || e.APP
    }
}(this));
if (typeof ADOBE == "undefined")
    var ADOBE = {};
typeof ADOBE.AM == "undefined" && (ADOBE.AM = {}), ADOBE.AM.UTILS = {HANDLE_AJAX: {active: !1,status_codes: {},init: function(e) {
            e && e.status_codes && $.extend(this.status_codes, e.status_codes), this.activateAjaxHandler()
        },activateAjaxHandler: function() {
            var e = this;
            $(document).ajaxError(function(t, n, r) {
                if (!n)
                    return !1;
                if (!e.status_codes[n.status])
                    return !1;
                e.status_codes[n.status].apply(this, arguments)
            })
        }},ERRORS: {TYPES: {ValidationError: function(e, t) {
                this.param = e, this.message = t
            },ArgError: function(e, t) {
                this.param = e, this.message = t
            },FatalDisplayError: function(e, t) {
                this.param = e, this.message = t
            }},MESSAGES: {}},LOGGER: {logs: [],log: function(e, t) {
            var n = (new Date).getTime(), r = "";
            typeof t == "undefined" && (t = "LOG:"), r = n + " - " + t + ": " + e, this.logs.push(r)
        },flush: function() {
            this.logs = []
        },display: function() {
            var e = !0;
            if (e && window.console && window.console.log)
                for (var t = 0; t < this.logs.length; t++)
                    window.console.log(this.logs[t]);
            else
                e && window.alert && window.alert(this.logs.join("\n"))
        }},HELPERS: {cookieHandler: {data: {},preferences_cookie_name: "_prefs",cookie_store: document,set: function(e, t, n, r, i, s) {
                var o = new Date;
                n && (n = n * 1e3 * 60), this.cookie_store.cookie = e + "=" + encodeURIComponent(t) + (n ? ";expires=" + (new Date(o.getTime() + n)).toUTCString() : "") + (r ? ";path=" + r : "") + (i ? ";domain=" + i : "") + (s ? ";secure" : "")
            },get: function(e) {
                var t = e + "=", n = this.cookie_store.cookie.split(";"), r, i, s;
                for (r = 0, i = n.length; r < i; r++) {
                    s = n[r];
                    while (s.charAt(0) == " ")
                        s = s.substring(1, s.length);
                    if (s.indexOf(t) === 0)
                        return decodeURIComponent(s.substring(t.length, s.length))
                }
                return null
            },load: function(e) {
                var t = null;
                try {
                    typeof e != "undefined" ? t = JSON.parse(this.get(this.preferences_cookie_name))[e] : t = JSON.parse(this.get(this.preferences_cookie_name))
                } catch (n) {
                }
                return t
            },save: function() {
                var e = {}, t = Array.prototype.slice.call(arguments);
                e[t[0]] = t[1], t.shift(), t.shift(), this.set.apply(this, [this.preferences_cookie_name, JSON.stringify(e)].concat(t))
            }},isObjectEmpty: function(e) {
            return Object.keys(e).length === 0
        },isNumeric: function(e) {
            return !isNaN(parseFloat(e)) && isFinite(e)
        },isDPMTrait: function(e) {
            return e == "ON_BOARDED_TRAIT" ? !0 : !1
        },isAlgoTrait: function(e) {
            return e == "ALGO_TRAIT" ? !0 : !1
        },getTraitTypeLabel: function(e) {
            switch (e) {
                case "RULE_BASED_TRAIT":
                    return "Rule-based";
                case "ON_BOARDED_TRAIT":
                    return "Onboarded";
                case "ALGO_TRAIT":
                    return "Algorithmic";
                default:
                    return "Unknown"
            }
        },isTrait: function(e) {
            return e == "INTENT" || e == "ALGO_TRAIT" || e == "ON_BOARDED_TRAIT" || e == "RULE_BASED_TRAIT"
        },isSegment: function(e) {
            return e == "SEGMENT"
        },isEmptyString: function(e) {
            var t = !1;
            if (e === "" || e.match(/^\s+$/))
                t = !0;
            return t
        },htmlEntityDecode: function(e) {
            var t = $("<div />").html(e);
            return t instanceof $ ? t.text() : ""
        },formatNumber: function(e) {
            e += "";
            var t = e.split("."), n = t[0], r = t.length > 1 ? "." + t[1] : "", i = /(\d+)(\d{3})/;
            while (i.test(n))
                n = n.replace(i, "$1,$2");
            return n + r
        },formatDate: function(e, t) {
            var n = "", r = "", i = "", s = "", o = "";
            e instanceof Date || (e = new Date(e));
            if (isNaN(e.getTime()))
                throw new Error("Date is not valid");
            return n = e.getFullYear().toString(), r = (e.getMonth() + 1).toString(), i = e.getDate().toString(), s = e.getHours().toString(), o = e.getMinutes().toString(), t ? t(r, i, n, s, o) : s !== "0" ? {month: r,day: i,year: n,hour: s,minute: o} : {month: r,day: i,year: n}
        },isNthChildSelectorSupported: function() {
            return Modernizr["nth-child-selector"]
        },isFirstOfTypeSelectorSupported: function() {
            return Modernizr["first-of-type"]
        },isLastOfTypeSelectorSupported: function() {
            return Modernizr["last-of-type"]
        },decorateWithSpanAndSlice: function(e) {
            return function(t) {
                var n = e.call(this, t);
                return '<span title="' + t + '">' + (n !== null ? n : "") + "</span>"
            }
        }(function(e) {
            return "string" == typeof e && e.length > 30 ? e.slice(0, 30) + "..." : e
        }),bindContextHelp: function() {
            $(".context-help").off().on("click", function(e) {
                e.stopPropagation();
                var t = null, n = null, r = $(this).attr("data-id");
                return t = function(e) {
                    var t = ADOBE.AM.API.BASEURL + "/contextualhelp/pid-" + ADOBE.AM.pid + "/" + e;
                    $.getJSON(t, function(t) {
                        ADOBE.AM.contextHelpArr[e] = t, n(e)
                    })
                }, n = function(e) {
                    var t = {}, n = ADOBE.AM.contextHelpArr[e];
                    n.intro = ADOBE.AM.UTILS.HELPERS.htmlEntityDecode(n.intro);
                    var r = n.intro + "<a tabindex='-1' class='moreHelpLink' href='" + n.url + "' target='_blank'>Click here for more information</a>";
                    t.title = n.title.replace(":", ":<br />"), t.title = "<h4>" + t.title + "</h4>", t.msg = r, r = t.title + t.msg, ADOBE.AM.AlertModal({type: "help",message: r})
                }, typeof ADOBE.AM.contextHelpArr[r] == "undefined" ? t(r) : n(r), !1
            })
        },comparator: function(e, t) {
            return function(n, r) {
                return typeof n.get(e) == "string" ? (n = n.get(e).toLowerCase(), r = r.get(e).toLowerCase()) : (n = n.get(e), r = r.get(e)), n == r ? 0 : n < r ? t == "desc" ? -1 : 1 : t == "desc" ? 1 : -1
            }
        },formatFolderHierarchy: function(e) {
            var t = {attr: {id: e.folderId + "_folder",rel: "folder"},data: e.name};
            if ($.isArray(e.subFolders) && e.subFolders.length > 0) {
                var n = [];
                $.each(e.subFolders, function(e, t) {
                    var r = DEMDEX.UTILS.formatFolderHierarchy(t);
                    n.push(r)
                }), $.extend(t, {state: "closed",children: n})
            }
            return t
        },formatCategoryTaxonomy: function(e) {
            var t = arguments.callee, n = {attr: {id: e.categoryId + "_cat",rel: "category"},data: e.name};
            if (e.categoryCount > 0) {
                var r = [];
                $.each(e.categories, function(e, n) {
                    var i = t(n);
                    r.push(i)
                }), $.extend(n, {state: "closed",children: r})
            }
            return n
        },switchPage: function(e) {
            document.getElementById("mainContent").setAttribute("class", e)
        },tempFixForChrome: function() {
            var e = navigator.userAgent.toLowerCase().indexOf("safari") > -1 || navigator.userAgent.toLowerCase().indexOf("chrome") > -1;
            if (!e)
                return !1;
            var t = $(".AUI_Dialog_outerContainer"), n = t.position().top, r = t.offset().top;
            t.css({top: n}).addClass("chromeFix"), $("body").addClass("disableMainScroll"), $(window).resize(function() {
                t.removeClass("chromeFix")
            })
        },makeTemplate: function(e, t) {
            var n = null;
            if (e instanceof Array) {
                var r = this[e[0]];
                for (var i = 1; i < e.length; i++)
                    r = r[e[i]];
                n = r
            } else
                n = this[e];
            for (var s in t)
                t.hasOwnProperty(s) && (n = n.replace(s, t[s]));
            return n
        },TableFilter: function(e, t) {
            var n = this;
            t === Object(t) && t.keyup && t.keyup(function(e) {
                n.process(e.target.value)
            }), this.process = function(t) {
                if (typeof t != "string" || e !== Object(e) || !e.find)
                    return;
                var n = e.find("tbody tr");
                n.each(function() {
                    var e = !1, n = $(this).find("td");
                    n.each(function() {
                        var n = $(this);
                        n.show(), n.text().toLowerCase().indexOf(t.toLowerCase()) >= 0 && (e = !0)
                    }), e || n.hide()
                })
            }
        },dheElement: null,decodeHTMLEntities: function(e) {
            this.dheElement || (this.dheElement = document.createElement("div"));
            var t = this.dheElement;
            return e && typeof e == "string" && (t.innerHTML = e), t.innerText || t.textContent || e
        },serialize: function(e) {
            var t = [];
            for (var n in e)
                e.hasOwnProperty(n) && t.push(encodeURIComponent(n) + "=" + encodeURIComponent(e[n]));
            return t.join("&")
        },prettyPrintEnum: function(e) {
            function t(e) {
                return e.charAt(0).toUpperCase() + e.slice(1).toLowerCase()
            }
            return e.split("_").map(t).join(" ")
        },parseDataFormatForCloudViz: function(e, t) {
            var n = this, r = {x: [],y: [],series: []};
            t.forEach(function(e, t) {
                r.x[t] = [], r.y[t] = [], r.series[t] = []
            });
            try {
                if (e === Object(e) && Object.keys(e).length)
                    return Object.keys(e).forEach(function(i) {
                        var s = e[i];
                        i = n.getUTCDate(parseInt(i, 10)), t.forEach(function(e, t) {
                            r.x[t].push(i);
                            var n = Object.keys(e)[0], o = e[n];
                            r.y[t].push(s[o]), r.series[t].push(n)
                        })
                    }), r
            } catch (i) {
                return {}
            }
            return {}
        },parseMultipleTrendDataForCloudViz: function(e, t) {
            var n = this, r = {x: [],y: [],series: [],sids: []}, i = {}, s = {}, o = [], u = [];
            if (e instanceof Array && e.length) {
                e.forEach(function(e) {
                    var a = e.metrics, f = {};
                    if (a === Object(a) && Object.keys(a).length) {
                        var l = n.decodeHTMLEntities(e.name) + (typeof e.sid == "undefined" ? "" : " (" + e.sid + ")"), c = [], h = [], p = [];
                        Object.keys(a).forEach(function(e) {
                            var r = n.getUTCDate(parseInt(e, 10)), i = a[e][t];
                            c.push(r), h.push(i), p.push(l), f[e] = i, s[e] = !0
                        }), r.x.push(c), r.y.push(h), r.series.push(p), o.push(e.sid), i[e.sid + ""] = f
                    } else
                        u.push(e.sid)
                }), r.sids = o.concat(u), r.graphDataIsEmpty = !o.length;
                var a = [];
                return Object.keys(s).forEach(function(e) {
                    var t = {date: new Date(parseInt(e, 10))};
                    Object.keys(i).forEach(function(n) {
                        e in i[n] ? t[n] = i[n][e] : t[n] = ""
                    }), a.push(t)
                }), r.dataTable = a, r
            }
            return {}
        },transformDataToCloudViz: function(e) {
            try {
                var t = {}, n, r;
                if (e === Object(e) && e.y instanceof Array)
                    return n = Object.keys(e), n.forEach(function(e) {
                        t[e] = []
                    }), e.y.forEach(function(r, i) {
                        n.forEach(function(n) {
                            Array.prototype.push.apply(t[n], e[n][i])
                        })
                    }), t
            } catch (i) {
                return {}
            }
            return {}
        },formatTimestampToUTC: function(e, t) {
            if (typeof moment == "undefined")
                throw new Error("moment must be defined!");
            return typeof t == "undefined" && (t = "YYYY-MM-DD"), moment(e).utc().format(t)
        },getUTCDate: function(e) {
            var t = new Date(e);
            return new Date(t.getUTCFullYear(), t.getUTCMonth(), t.getUTCDate(), t.getUTCHours(), t.getUTCMinutes(), t.getUTCSeconds(), t.getUTCMilliseconds())
        }},pressedEnter: function(e) {
        var t;
        return window.event ? t = window.event.keyCode : e ? t = e.which : t = e.keyCode, t == 13 ? !0 : !1
    },G6: {SEGMENTS: {trait_cache: {cache: [],getBySid: function(e) {
                    for (var t = 0; t < this.cache.length; t++)
                        if (this.cache[t].sid == e)
                            return this.cache[t]
                }},getNumberOfTouchingRules: function(e) {
                var t = 1, n = null;
                for (var r = 0, i = e.length; r < i; r++) {
                    n = e[r];
                    if (!(typeof n.on != undefined && !n.on || ADOBE.AM.UTILS.HELPERS.isNumeric(n.val, 10)))
                        break;
                    t++
                }
                return t
            },treeParser: function(e, t) {
                var n = "";
                if (e.expr1 || e.expr2 || e.frequency || e.sid)
                    n = this.parseExpressionTree.apply(this, arguments);
                return n
            },flattenTree: function(e) {
                var t = e, n = null, r = [], i = {};
                while (t != null) {
                    n != null && (n.expr1 = t.expr2, t.expr2 = n);
                    if (t.expr1 != null) {
                        n = t, t = t.expr1;
                        continue
                    }
                    if (t.frequency)
                        r.push({sids: t.frequency.list,rec_op: t.expressionName,rec_value: t.value,freq_op: t.frequency.op,freq_units: t.frequency.units,freq_val: t.frequency.value});
                    else if (t.expressionName) {
                        i = {expressionName: t.expressionName}, r.push(i);
                        if (t.expr) {
                            var s = arguments.callee(t.expr);
                            r = r.concat(s)
                        }
                    } else
                        t.expr ? r.push({sid: t.expr.sid}) : t.sid && r.push({sid: t.sid});
                    t = t.expr2, n = null
                }
                return r
            },parseExpressionTree: function(e) {
                var t = ADOBE.AM.UTILS.G6.SEGMENTS, n = t.tree_helper;
                return n.init(), this.inOrderTreeTraversal(e, n.storeNode), t.formatFlattenedList(n.nodes, t.parsingFunctions.html)
            },tree_helper: {turnOnNextOr: !1,turnOnOperatorOverride: !1,openParen: !1,depth: 1,old_depth: null,operatorInfoAtDepth: {},nodes: [],init: function() {
                    this.nodes = [], this.turnOnOperatorOverride = !1, this.openParen = !1, this.depth = 1, this.old_depth = null, this.operatorInfoAtDepth = {}
                },depthCheck: function() {
                    var e = ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper;
                    return e.old_depth == e.depth
                },store: function(e) {
                    this.nodes.push(e)
                },storeNode: function(e, t, n) {
                    var r = null, i = !1, s = ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper;
                    switch (e) {
                        case "sid":
                            r = {type: "sid",value: t};
                            break;
                        case "expr":
                            i = n && typeof n.oo != "undefined" ? n.oo : 1, r = {type: "op",value: t,on: i};
                            break;
                        case "name-val":
                            r = t;
                            break;
                        case "frequency":
                            r = {type: "frequency",value: {sids: t.sids,frequency_op: t.freq_op,frequency_val: t.freq_val,units: t.units,recency_op: t.rec_op,recency_val: t.rec_val}};
                            break;
                        default:
                    }
                    return s.store(r), r
                },turnOperatorOn: function(e) {
                    return this.openParen ? e.toString().toLowerCase() == "and" ? !0 : typeof this.operatorInfoAtDepth[this.depth] != "undefined" ? !this.operatorInfoAtDepth[this.depth] : !1 : !0
                },handleExpression: function(e, t) {
                    switch (e.toString().toLowerCase()) {
                        case "or":
                            this.openParen = this.lookAroundForSpecialOperations(t);
                            break;
                        case "and":
                            this.openParen = !1;
                            break;
                        default:
                    }
                    this.incDepth(1), this.turnOnOperatorOverride = !1
                },handleFrequency: function() {
                    this.openParen = !1, this.turnOnOperatorOverride = !0, this.incDepth(-1)
                },handleSid: function() {
                    this.incDepth(-1)
                },lookAroundForSpecialOperations: function(e) {
                    return e.expr1 && e.expr1.frequency || e.expr2 && e.expr2.frequency ? !1 : e.expr1 && e.expr1.expressionName == "and" || e.expr2 && e.expr2.expressionName == "and" ? !1 : typeof this.operatorInfoAtDepth[this.depth] != "undefined" ? this.operatorInfoAtDepth[this.depth] : this.turnOnOperatorOverride ? !1 : !0
                },incDepth: function(e) {
                    var t = ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper;
                    t.old_depth = t.depth, t.depth += e
                },display: function() {
                    var e = ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper, t = e.nodes, n = "";
                    for (var r = 0; r < t.length; r++) {
                        var i = t[r + 1];
                        if (i == "or") {
                            n += " ( ", n += t[r];
                            for (var s = r + 1; s < t.length; s++) {
                                n += " " + t[s] + " ";
                                if (t[s + 1] != "or" && isNaN(parseInt(t[s + 1], 10))) {
                                    r = s;
                                    break
                                }
                            }
                            r = s, n += " ) "
                        } else
                            n += t[r] + " "
                    }
                    return n
                }},inOrderTreeTraversal: function(e, t) {
                if (typeof e == "undefined")
                    return;
                if (typeof e == "number")
                    return e;
                if (typeof e.name != "undefined")
                    return t("name-val", {name: e.name,value: e.value,expressionName: e.expressionName,type: "rule"});
                if (e.sid)
                    return ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper.handleSid(), t("sid", e.sid);
                if (e.expr)
                    return t("expr", e.expressionName) + arguments.callee(e.expr, t);
                if (e.expressionName && e.frequency)
                    return ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper.handleFrequency(), t("frequency", {freq_val: e.value,freq_op: e.expressionName,rec_val: e.frequency.value,rec_op: e.frequency.op,units: e.frequency.units,sids: e.frequency.list});
                arguments.callee(e.expr1, t), e.expressionName && ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper.handleExpression(e.expressionName, e), t("expr", e.expressionName, {oo: ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper.turnOperatorOn(e.expressionName)}), arguments.callee(e.expr2, t);
                return
            },formatFlattenedList: function(e, t) {
                var n = 0, r = !0, i = null, s = null, o = "";
                for (var u = 0; u < e.length; u++) {
                    node = e[u];
                    switch (node.type) {
                        case "op":
                            e[u + 1] && e[u + 1].type == "op" && e[u + 1].value.toLowerCase() == "not" ? (e.splice(u + 1, 1), o += t("expr", node.value + " NOT", node.on ? "on" : "off")) : o += t("expr", node.value, node.on ? "on" : "off"), r = node.on ? !0 : !1;
                            break;
                        case "sid":
                            r ? (n = this.getNumberOfTouchingRules(e.slice(u + 1)), o += t("sid", node.value, {row_span: n})) : o += t("sid", node.value), r = !1;
                            break;
                        case "frequency":
                            s = [];
                            for (var a = 0, f = node.value.sids.length; a < f; a++) {
                                sid = node.value.sids[a];
                                if (a == 0) {
                                    i = {}, node.value.frequency_op && (i.frequency_ops = node.value.frequency_op), node.value.units && (i.frequency_units = node.value.units), node.value.frequency_val && (i.frequency_val = node.value.frequency_val), node.value.recency_op && (i.recency_ops = node.value.recency_op), node.value.recency_val && (i.recency_val = node.value.recency_val), s.push(t("sid", sid, _.extend(i, {row_span: f + (f - 1)})));
                                    continue
                                }
                                s.push(t("sid", sid))
                            }
                            o += s.join(t("expr", "or", "off")), r = !0
                    }
                }
                return o
            },parsingFunctions: {code: function(e, t, n) {
                    var r = null, i = !1, s = ADOBE.AM.UTILS.G6.SEGMENTS.tree_helper;
                    switch (e) {
                        case "sid":
                            r = t;
                            break;
                        case "expr":
                            i = n && typeof n.oo != "undefined" ? n.oo : 1, r = i ? t.toUpperCase() : t.toLowerCase();
                            break;
                        case "frequency":
                            r = "(Frequency(" + t + " " + n.freq_op + " " + n.freq_val + n.units + ") " + n.rec_op + " " + n.rec_val + ")";
                            break;
                        default:
                            return "WTF!"
                    }
                    return s.store(r), r
                },html: function(e, t) {
                    var n = "", r = null, i = "", s = null, o = "", u = "off", a = "-", f = APP.templates.segment_builder_widget.elements.rule, l = null, c = "", h = APP.templates.segment_builder_widget.elements.recency_frequency;
                    if (e == "sid")
                        return s = ADOBE.AM.UTILS.G6.SEGMENTS.trait_cache.getBySid(t), o = s.name || "", a = ADOBE.AM.UTILS.HELPERS.formatNumber(s.uniques30Day) || 0, l = {sid: t,name: o,uniques: a,rowspan: !1}, arguments[2] && arguments[2].row_span && (l.rowspan = !!arguments[2].row_span || !1, r = {frequency_val: "",frequency_ops: ">=",recency_val: "",recency_ops: "<="}, arguments[2].frequency_val && (u = "on", r.frequency_val = arguments[2].frequency_val), arguments[2].frequency_ops && (u = "on", r.frequency_ops = ADOBE.AM.UTILS.HELPERS.htmlEntityDecode(arguments[2].frequency_ops)), arguments[2].recency_val && (u = "on", r.recency_val = arguments[2].recency_val), arguments[2].recency_ops && (u = "on", r.recency_ops = ADOBE.AM.UTILS.HELPERS.htmlEntityDecode(arguments[2].recency_ops)), _.extend(r, {rowspan: arguments[2].row_span,state: u}), c = _.template(APP.templates.segment_builder_widget.elements.rf_cell, r), l.rf_html = c), _.template(f, l);
                    if (e == "frequency") {
                        var p = t, d = arguments[2], v = arguments[3], m = arguments[4], g = arguments[5];
                        try {
                            i = _.template(h, {rf_class: "on",recency_ops: m,recency_val: g,frequency_ops: d,frequency_val: v})
                        } catch (y) {
                            ADOBE.AM.UTILS.LOGGER.log(y.message)
                        }
                        return p + i
                    }
                    if (e == "wrapper") {
                        try {
                            arguments[2] && arguments[2].rf == 1 ? (i = _.template(h, {rf_class: "off",frequency_val: "",frequency_ops: ">=",recency_val: "",recency_ops: "<="}), n = _.template(rw_template, {content: t + i})) : n = _.template(rw_template, {content: t})
                        } catch (y) {
                            ADOBE.AM.UTILS.LOGGER.log(y.message)
                        }
                        return t
                    }
                    if (e == "expr") {
                        var b = APP.templates.segment_builder_widget.elements.op, w = "op " + (arguments[2] || "on"), n = "";
                        t == "or" && arguments[2] == "off" && (t = "");
                        try {
                            n = _.template(b, {op_wrapper_class: w,op_class: t,selected: t.toString().toUpperCase()})
                        } catch (y) {
                            ADOBE.AM.UTILS.LOGGER.log(y.message)
                        }
                        return n
                    }
                }}}},MODELS: {validators: {validateData: function(e) {
                var t = this.validationErrors = [], n, r, i, s;
                this.attrs = e;
                if (n = e.validator)
                    this.vfn || (this.vfn = {notEmpty: function(t, n) {
                            var r = e[t];
                            return r != null && r != "" && r != "undefined" ? [!0] : [!1, n + " cannot be empty"]
                        },date: function(t, n) {
                            var r = e[t];
                            return isNaN(Date.parse(r)) ? [!1, n + " is not in a parsable date format"] : [!0]
                        },http: function(t, n) {
                            var r = e[t];
                            return /^http:\/\/[-A-Za-z0-9.]+\.[A-Za-z]{2,4}[A-Za-z0-9 \?=\.\/&amp;;_%,@:\[\]~\+#!\$,\^\*\(\)\`\|\/-]*$/.test(r) ? [!0] : [!1, n + " is not in a valid http url format"]
                        },https: function(t, n) {
                            var r = e[t];
                            return /^https:\/\/[-A-Za-z0-9.]+\.[A-Za-z]{2,4}[A-Za-z0-9 \?=\.\/&amp;;_%,@:\[\]~\+#!\$,\^\*\(\)\`\|\/-]*$/.test(r) ? [!0] : [!1, n + " is not in a valid https url format"]
                        }}), r = this.vfn, (i = n.required) && $.each(i, function(e, n) {
                        var i = r[n[0]](e, n[1]);
                        i[0] || t.push(i[1])
                    }), (s = n.optional) && $.each(s, function(n, i) {
                        if (e[n] != null && e[n] != "") {
                            var s = r[i[0]](n, i[1]);
                            s[0] || t.push(s[1])
                        }
                    }), typeof n.custom == "function" && (this.customValidation = n.custom, this.customValidation());
                if (this.validationErrors.length)
                    return this.validationErrors
            }}}}, ADOBE.AM.UTILS.GATEKEEPER = function() {
    this.permission_objects = {}, this.current_scheme = null, this.valid = !1
}, ADOBE.AM.UTILS.GATEKEEPER.prototype = {schemes: null,PermissionClass: null,defaultSchemePermissionCheck: function(e) {
        var t = !0, n = this;
        return _.each(n, function(e, r) {
            if (r.match(/Permission$/) === null)
                return;
            if (this.getPermissionObjects(r).hasPermission(n[r]) === !1)
                return t = !1, !1
        }, e), t
    },permissionCheck: function() {
        var e = this.schemes[this.current_scheme];
        return this.valid = e.permissionCheck !== void 0 ? e.permissionCheck(this) : this.defaultSchemePermissionCheck.call(e, this), this.isValid()
    },checkPermissions: function(e, t) {
        return this.setPermissionObjects(e), this.setCurrentScheme(t), this.permissionCheck() ? (this.clearAll(), !0) : (this.clearAll(), !1)
    },isValid: function() {
        return this.valid
    },clearAll: function() {
        this.permission_objects = {}, this.valid = null, this.current_scheme = null
    },setPermissionObjects: function(e) {
        function r(e) {
            return e instanceof n.PermissionClass
        }
        var t = {}, n = this;
        return n.PermissionClass === null && this._errors.handleError("ArgError", "arg", "PermissionClass on the instance must be defined"), arguments.length > 1 && this._errors.handleError("ArgError", "arg", "setPermissionObjects accepts single object or array of objects"), e instanceof Array ? (_.each(e, function(e) {
            r(e) || n._errors.handleError("ArgError", "arg", "Argument must be of type ADOBE.AM.Permission.Models.Permission"), this[e.getName()] = e
        }, t), _.extend(this.permission_objects, t), !0) : (r(e) || this._errors.handleError("ArgError", "arg", "Argument must be of type ADOBE.AM.Permission.Models.Permission"), t[e.getName()] = e, _.extend(this.permission_objects, t), !0)
    },getPermissionObjects: function(e) {
        return e ? this.permission_objects[e] : this.permission_objects
    },setCurrentScheme: function(e) {
        this.current_scheme = e, this.valid = !1
    },getCurrentScheme: function() {
        return this.current_scheme
    },setSchemes: function(e) {
        typeof e != "object" && this._errors.handleError("ArgError", "s", "argument must be of type object"), this.schemes = e
    },getSchemes: function() {
        return this.schemes
    },setPermissionClass: function(e) {
        this.PermissionClass = e
    },getPermissionClass: function() {
        return this.PermissionClass
    },setErrorTypes: function(e) {
        _.extend(this._errors.types, e), this._errors.isCustomErrorsSet = !0
    },getIsCustomErrorsSet: function() {
        return this._errors.getIsCustomErrorsSet()
    },_errors: {types: {},customErrorsSet: !1,handleError: function(e, t, n) {
            throw this.isCustomErrorsSet === !1 ? new Error(n) : e in this.types ? new this.types[e](t, n) : new Error(n)
        },getIsCustomErrorsSet: function() {
            return this.isCustomErrorsSet
        }},_strings: {}}, ADOBE.AM.API = {BASEURL: "/portal/api/v1",SOLR: {url: function(e) {
            var t = ADOBE.AM.API.BASEURL + "/segments/";
            switch (e) {
                case "estimate30DaySize":
                    e = "estimate-30-day-size";
                    break;
                case "estimate7DaySize":
                    e = "estimate-7-day-size";
                    break;
                case "estimate60DaySize":
                    e = "estimate-60-day-size";
                    break;
                default:
            }
            return t += e ? e : "estimate-size", t
        }},REGION: {regions: {url: function() {
                return ADOBE.AM.API.BASEURL + "/dcs-regions/"
            }}},MODELS: {algo_model: {url: function(e, t) {
                var n = ADOBE.AM.API.BASEURL + "/models/", r = [];
                return e != undefined && (n += e + "/"), typeof t == "object" && !ADOBE.AM.UTILS.HELPERS.isObjectEmpty(t) && (Object.keys(t).forEach(function(e, n, i) {
                    r.push(e + "=" + t[e])
                }), n += "?" + r.join("&")), n
            }},processing_history: function(e) {
            return ADOBE.AM.API.MODELS.algo_model.url(e) + "processing-history/"
        },algorithms: {url: function() {
                return ADOBE.AM.API.BASEURL + "/algorithms/"
            }},influential_traits: {url: function(e) {
                return ADOBE.AM.API.MODELS.algo_model.url(e) + "runs/latest/traits/"
            }},run_stats: {url: function(e) {
                return ADOBE.AM.API.MODELS.algo_model.url(e) + "runs/latest/stats/"
            }},bulk_delete: {url: function() {
                return ADOBE.AM.API.MODELS.algo_model.url() + "bulk-delete/"
            }},limits: {url: function() {
                return ADOBE.AM.API.BASEURL + "/models/limits"
            }}},TRAITS: {bulkDelete: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/traits/bulk-delete/";
                return e
            },method: function(e) {
                var t = e.ids, n = e.success || function() {
                }, r = e.error || function() {
                }, i = this.url();
                $.ajax({url: i,type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(t),success: n,error: r})
            }},type: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/customer-trait-types/";
                return typeof e != "undefined" && (t += e + "/"), t
            }},folders: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/folders/traits/";
                return e != undefined && (t += "%%folderid%%/", t = t.replace("%%folderid%%", e)), t
            }},folderTraits: {url: function(e, t) {
            }},trait2: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/traits/";
                return e
            }},trait: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/traits/";
                return typeof e != "undefined" && (e && e === Object(e) ? t = t + "?" + ADOBE.AM.UTILS.HELPERS.serialize(e) : t += e + "/"), t
            }},limits: {url: function() {
                return ADOBE.AM.API.BASEURL + "/traits/limits"
            }},validate: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/traits/validate/";
                return e
            }},test: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/traits/test/";
                return e
            }},trend: {url: function() {
                return ADOBE.AM.API.BASEURL + "/reports/traits-trend"
            },sid: {url: function(e, t, n, r) {
                    var i = [];
                    return t && i.push("startDate=" + t), n && i.push("endDate=" + n), r && i.push("interval=" + r), ADOBE.AM.API.BASEURL + "/reports/traits-trend/" + e + (i.length ? "?" + i.join("&") : "")
                }}},generalReport: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/reports/traits-for-date";
                return e
            }}},DESTINATION: {destination: {url: function(e) {
                var t = [], n = ADOBE.AM.API.BASEURL + "/destinations/";
                return typeof e == "undefined" && (e = {}), ADOBE.AM.UTILS.HELPERS.isObjectEmpty(e) || (Object.keys(e).forEach(function(n, r, i) {
                    t.push(n + "=" + e[n])
                }), n += "?" + t.join("&")), n
            },bulkUrl: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/destinations/%%destinationId%%/bulk-create/";
                if (!e)
                    throw new ADOBE.AM.UTILS.ERRORS.TYPES.ValidationError("destinationId", "argument is required");
                return t.replace("%%destinationId%%", e)
            },typeArr: {PUSH: "URL",S2S: "Server-to-Server",ADS: "Cookie",PULL: "Pull"},allowed_types: ["PUSH", "S2S", "ADS"],getType: function(e) {
                return this.allowed_types.indexOf(e) == -1 ? "" : this.typeArr[e]
            },mapping_divider: "<br />",getMapping: function(e, t) {
                var n, r = t;
                if (e.destinationType == "PUSH")
                    if (e.serializationEnabled)
                        n = r.traitAlias;
                    else {
                        n = "";
                        if (r.url !== "" || r.secureUrl)
                            r.url === "" ? n = r.secureUrl : (n = r.url, r.secureUrl && (n += this.mapping_divider + r.secureUrl))
                    }
                else
                    "S2S" == e.destinationType ? n = r.traitAlias : e.formatType == "SINGLE_KEY" ? n = e.singleKey + " = " + r.valueAlias : n = r.traitAlias + " " + (e.keySeparator || "=") + " " + r.valueAlias;
                return n
            }},search: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/destinations/";
                return e
            }},limits: {url: function() {
                return ADOBE.AM.API.BASEURL + "/destinations/limits"
            }},availablePlatforms: {url: function() {
                return ADOBE.AM.API.BASEURL + "/destinations/configurations/available-platforms"
            }},outboundHistory: {url: function(e, t, n) {
                return ADOBE.AM.API.DESTINATION.destination.url() + e + "/history/outbound?startDate=" + t + "&endDate=" + n
            }}},SCHEMAS: {schema: {url: function(e, t, n) {
                var r = ADOBE.AM.API.BASEURL + "/pid-%%pid%%/schema/";
                if (!e)
                    throw new ADOBE.AM.UTILS.ERRORS.TYPES.ValidationError("pid", "argument is required");
                return r = r.replace("%%pid%%", e), t && (r += t + "/"), r += "?", n && n.token && (r += "token=" + n.token + "&"), n && n.user && (r += "user=" + n.user), r
            },method: function(e) {
                var t = e.url, n = e.success || function() {
                }, r = e.error || function() {
                };
                $.ajax({url: t,type: "GET",dataType: "json",contentType: "application/json",success: n,error: r})
            }}},DATAFEED: {url: function(e) {
            var t = ADOBE.AM.API.BASEURL + "/data-feeds";
            return e && (e === Object(e) ? t = t + "?" + ADOBE.AM.UTILS.HELPERS.serialize(e) : t = [t, e, ""].join("/")), t
        },plan: {url: function(e) {
                if (e)
                    return [ADOBE.AM.API.DATAFEED.url(), e, "plans"].join("/");
                throw new Error("No feed ID is provided for plan")
            }}},DATASOURCES: {dataSources: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/datasources/";
                return typeof e != "undefined" && (e && e === Object(e) ? t = t + "?" + ADOBE.AM.UTILS.HELPERS.serialize(e) : t += e + "/"), t
            }},dataSources_modeling: {url: function() {
                return ADOBE.AM.API.DATASOURCES.dataSources.url() + "?modelingEnabled=true"
            }},dataSources_segments: {url: function() {
                return ADOBE.AM.API.DATASOURCES.dataSources.url() + "?objectType=segment&includePermissions=true"
            }},dataSources_traits: {url: function() {
                return ADOBE.AM.API.DATASOURCES.dataSources.url() + "?objectType=trait&includePermissions=true&includeThirdParty=true"
            }},marketingCloudVisitorIdVersions: {url: function() {
                return ADOBE.AM.API.DATASOURCES.dataSources.url() + "configurations/marketing-cloud-visitorid-versions"
            }},idTypes: {url: function() {
                return ADOBE.AM.API.DATASOURCES.dataSources.url() + "configurations/available-id-types"
            }},bulkDelete: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/datasources/bulk-delete/";
                return e
            },method: function(e) {
                var t = e.datasourceIds, n = e.success || function() {
                }, r = e.error || function() {
                }, i = this.url();
                return $.ajax({url: i,type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(t)})
            }},inboundHistory: {url: function(e, t, n) {
                return ADOBE.AM.API.DATASOURCES.dataSources.url(e) + "history/inbound?startDate=" + t + "&endDate=" + n
            }},inboundMailingList: {url: function(e, t) {
                return ADOBE.AM.API.DATASOURCES.dataSources.url(e) + "inbound-mailing-list/" + (t || "")
            }}},TAXONOMY: {categories: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/taxonomies/0/";
                return e && (t += e + "/"), t
            }}},FOLDERS: {folder: {url: function(e, t) {
                var n = ADOBE.AM.API.BASEURL + "/folders/" + e + "/";
                return t != undefined && (n += "%%folderid%%/", n = n.replace("%%folderid%%", t)), n
            }},folders: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/folders/";
                return t += e + "/", t
            }}},SEGMENTS: {limits: {url: function() {
                return ADOBE.AM.API.BASEURL + "/segments/limits"
            }},rule_validation: {url: function() {
                return ADOBE.AM.API.BASEURL + "/segments/validate/"
            }},segment: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/segments/";
                return typeof e != "undefined" && (e && e === Object(e) ? t = t + "?" + ADOBE.AM.UTILS.HELPERS.serialize(e) : t += e + "/"), t
            }},search: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/segments/";
                return e
            }},folders: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/folders/segments/";
                return e != undefined && (t += "%%folderid%%/", t = t.replace("%%folderid%%", e)), t
            }},folderSegments: {url: function(e, t) {
                var n = ADOBE.AM.API.SEGMENTS.folders.url.apply(this, arguments);
                return n += "segments/", n
            }},bulkDelete: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/segments/bulk-delete/";
                return e
            },method: function(e) {
                var t = e.ids, n = e.success || function() {
                }, r = e.error || function() {
                }, i = e.pid || null, s = this.url();
                $.ajax({url: s,type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(t),success: n,error: r})
            }},trend: {url: function() {
                return ADOBE.AM.API.BASEURL + "/reports/segments-trend"
            },sid: {url: function(e, t, n, r) {
                    var i = [];
                    return t && i.push("startDate=" + t), n && i.push("endDate=" + n), r && i.push("interval=" + r), ADOBE.AM.API.BASEURL + "/reports/segments-trend/" + e + (i.length ? "?" + i.join("&") : "")
                }}},generalReport: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/reports/segments-for-date";
                return e
            }}},USERS: {user: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/users/";
                return typeof e != "undefined" && (t += e + "/"), t
            }},updateGroups: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/users/update-groups/";
                return e
            },method: function(e) {
                var t = e.data, n = this.url();
                return $.ajax({url: n,type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(t)})
            }},bulkDelete: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/users/bulk-delete/";
                return e
            },method: function(e) {
                var t = e.user_ids, n = e.success || function() {
                }, r = e.error || function() {
                }, i = this.url();
                return $.ajax({url: i,type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(t)})
            }}},GROUPS: {group: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/groups/";
                return typeof e != "undefined" && (t += e + "/"), t
            }},bulkDelete: {url: function() {
                var e = ADOBE.AM.API.BASEURL + "/groups/bulk-delete/";
                return e
            },method: function(e) {
                var t = e.group_ids, n = e.success || function() {
                }, r = e.error || function() {
                }, i = this.url();
                return $.ajax({url: i,type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(t)})
            }},permissions: {url: function(e) {
                return ADOBE.AM.API.BASEURL + "/groups/" + e + "/permissions"
            }}},VISITOR_PROFILE: {url: function(e, t) {
            return ADOBE.AM.API.BASEURL + "/visitor-profile?uuid=" + e + "&region=" + t
        }},REPORTS: {largest_traits: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/reports/largest-traits";
                return e === Object(e) && (t += "?" + ADOBE.AM.UTILS.HELPERS.serialize(e)), t
            }},largest_segments: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/reports/largest-segments";
                return e === Object(e) && (t += "?" + ADOBE.AM.UTILS.HELPERS.serialize(e)), t
            }},traits_most_changed: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/reports/most-changed-traits";
                return e === Object(e) && (t += "?" + ADOBE.AM.UTILS.HELPERS.serialize(e)), t
            }},segments_most_changed: {url: function(e) {
                var t = ADOBE.AM.API.BASEURL + "/reports/most-changed-segments";
                return e === Object(e) && (t += "?" + ADOBE.AM.UTILS.HELPERS.serialize(e)), t
            }},partner_uniques: {url: function(e) {
                var t = "";
                return t = Object.keys(e).map(function(t) {
                    return t + "=" + e[t]
                }).join("&"), ADOBE.AM.API.BASEURL + "/reports/partner-uniques?" + t
            }}}}, ADOBE.AM.MESSAGES = {en_US: {generic_error: {message: "There was an error.  Please refresh and try again"},generic_unrefreshable_error: {message: "There was an error. Please contact your administrator."},generic_api_error: {message: "There was an error.  Please try again"},loading: {message: "Please wait..."},message: {message: "Message"},saved: {message: "Saved"},ok: {message: "OK"},cancel: {message: "Cancel"},success: {message: "Success"},cannot_delete_entity_mapped: {title: "Cannot delete segments",summary: "These segments are currently mapped to destinations.",message: "One or more of the segments you are attempting to delete have attached destinations. You must remove destination mappings before deleting a segment."},not_all_selected_segments_can_be_added_to_destinations: {message: "The following segments you selected were NOT mappable to destinations:<span class='insert'></span>Do you wish to continue?"},no_selected_segments_can_be_added_to_destinations: {message: "None of the segments you selected can be added to destinations."},add_dpmtrait_to_recency_frequency: {message: "You are about to add a third party trait to a rule group that has recency and frequency.  This will cause the recency and frequency to be reset for this group.  <br /><br />Do you wish to continue?"},add_algotrait_to_recency_frequency: {message: "You are about to add an algorithmic trait to a rule group that has recency and frequency.  This will cause the recency and frequency to be reset for this group.  <br /><br />Do you wish to continue?"},cannot_add_recency_frequency_on_dpmtrait: {message: "You cannot add Recency and Frequency to a trait grouping with a 3rd party trait"},cannot_add_recency_frequency_on_algotrait: {message: "You cannot add Recency and Frequency to a trait grouping with an algorithmic trait"},segment_must_be_saved: {message: "You cannot assign destinations until you save the segment."},invalid_expression: {message: "The rule you entered in the Segment Expression tag was invalid."},complex_rule: {message: "The segment expression is too complex to show in the builder view.  Please use the code view to edit this expression."},segment_rule_lack_permissions: {message: "Sorry, you do not have permissions to view all the traits in this segment."},failure: {message: "Failure"},solr_failure: {message: "There was an error contacting the Estimated Historic Segment Size service."},cannot_have_recency_wo_frequency: {message: "You cannot add recency without frequency.  Please add a frequency."},cannot_create_trait_from_model: {message: "The model must run at least 1 time successfully with data before a trait can be created using it.  You will be emailed when the model has run successfully."},cannot_create_trait_from_model_simple: {message: "Sorry, you do not have permissions to create a trait from this model."},delete_model: {message: "Are you sure you want to delete this model?"},delete_models: {message: "Are you sure you want to delete these models?"},delete_models_invalid: {message: "You must select at least 1 model to delete."},delete_model_error: {message: "Sorry, there was an error deleting the model.  Please try again"},model_has_not_run: {message: "The model has not yet run or produced no data."},model_has_no_data: {message: "No data."},model_max_reach_exceeded: {message: "All model values exceed maximum reach value, please review the configuration."},model_run_once: {message: "You have selected a model that has not run at least once."},cannot_delete_entity_with_mappings: {message: "There are traits using this model.  Please delete the traits and try again."},influential_traits_nodata: {message: "The model has not yet run or produced no data."},model_status_error: {message: "There was an error changing the status.  Please try again."},model_list_page_problem: {message: "There was a problem loading this page.  Please try again."},models_cannot_be_deleted: {message: "The following models cannot be deleted: "},models_cannot_be_deleted_no_permissions: {message: "You do not have permissions to delete any of these models"},error_in_model_bulk_delete: {message: "There was a problem trying to delete the selected models.  Please try again."},algo_trait_no_model_permissions: {message: "Sorry, you do not have permissions to clone this trait."},algotrait_no_model_selected: {message: "Please select a model"},algotrait_loading_error: {message: "There was a problem loading this trait.  Please try again."},algotrait_deleted: {message: "Algorithmic Trait deleted!"},unexpected_error: {message: "There was an unexpected error.  Please try again."},trait_created: {message: "The trait has been created"},delete_trait: {message: "Are you sure you want to delete this trait?"},delete_traits: {message: "Are you sure you want to delete these traits?"},error_in_trait_bulk_delete: {message: "There was a problem trying to delete the selected traits.  Please try again."},trait_deleted: {message: "Trait deleted!"},traits_cannot_be_deleted: {message: "The following trait cannot be deleted: "},traits_cannot_be_deleted_no_permissions: {message: "You do not have permissions to delete one or more of these traits"},no_trait_rule: {message: "No rules to display"},general_trait_problem: {message: "Sorry, this trait could not be loaded."},max_reach_audience_size: {message: "Algorithmic Traits cannot include an audience size of over %%num%% unique visitors. Please select a lower reach or higher accuracy setting.",makeMessage: function(e) {
                return this.message.replace("%%NUM%%", ADOBE.AM.UTILS.HELPERS.formatNumber(e))
            }},no_valid_model_run_values: {message: "All audience sizes from this run are greater than the current max audience size of %%NUM%%.  Please select a different model.",makeMessage: function(e) {
                return this.message.replace("%%NUM%%", ADOBE.AM.UTILS.HELPERS.formatNumber(e))
            }},access_denied_no_create_trait_permission_with_data_provider: {message: "You do not have permissions to create an algorithmic trait with this data provider."},access_denied_no_read_trait_permission_with_data_provider: {message: "You do not have permissions to view this algorithmic trait with this data provider."},access_denied_no_edit_trait_permission_with_data_provider: {message: "You do not have permissions to edit this algorithmic trait with this data provider."},access_denied_no_delete_trait_permission_with_data_provider: {message: "You do not have permissions to delete this algorithmic trait with this data provider."},access_denied_no_edit_permissions_for_segment: {message: "You do not have permissions to edit this component of the segment"},trait_error_1: {message: "The Key must start with a letter or quotation."},trait_error_2: {message: 'The Key can only contain letters, numbers, ", -, and _.'},trait_error_3: {message: 'Any quotes (") have to be escaped with a pair of quotes (""").'},trait_error_4: {message: "For rules containing > or < operators, Value must be numeric only."},trait_error_5: {message: "An Operator must be selected"},trait_error_6: {message: "The Value cannot be blank"},trait_error_7: {message: "You must add quotes around keys with spaces."},trait_error_8: {message: "You must add a quotes around the entire key."},trait_error_9: {message: "You can only have 2 quotes and they must be at the beginning and end of the key."},no_results: {message: "No results."},trait_expression_valid: {message: "Valid Expression"},trait_expression_invalid: {message: "Invalid expression"},trait_tab_expression: {message: "Expression Builder"},trait_tab_code: {message: "Code View"},trait_test_url_header_invalid_url: {message: "Invalid URL - Please use a valid URL starting with: <br /> http://"},trait_test_url_header_invalid_fields: {message: "Invalid URL/Header - Please enter a URL and/or Headers to test against"},trait_test_url_header_event_test: {message: "Event Test"},trait_test_url_header_event_test_would_exhibit: {message: "Site visitor with this event would exhibit this trait."},trait_test_url_header_event_test_would_not_exhibit: {message: "Site visitor with this event would not exhibit this trait."},no_datasources_to_create_trait: {message: "Sorry, you cannot create a trait because you do not have access to any Data Sources."},trait_get_pixel_url: {message: 'The URLs and tags for the pixel:<br /><br /><b>URL:</b><br /><input type="text" id="__trait_url" value="" size="40"/><br /><b>Secure URL:</b><br /><input type="text" id="__trait_secure_url" value="" size="40"/><br /><b>Image Tag:</b><br /><input type="text" id="__trait_img_tag" value="" size="40"/><br /><b>Image Tag Secure:</b><br /><input type="text" id="__trait_img_secure_tag" value="" size="40"/><br />'},trait_no_model_selected: {message: "Please select a single trait"},traits_no_model_selected: {message: "Please select a trait or traits"},traits_no_selected: {message: "Please select a trait or traits"},cannot_create_model_with_trait: {message: "Sorry, you do not have permissions to create models with this trait."},cannot_create_model_with_segment: {message: "Sorry, you do not have permissions to create models with this segment."},too_many_traits_selected: {message: "Please select only one trait."},too_many_segments_selected: {message: "Please select only one segment."},select_one_segment: {message: "Please select one segment."},clone_copy_of: {message: "Copy of "},trait_type_not_found: {message: "You cannot create this trait.  Please try again."},trait_edit_page_cannot_edit: {message: "You cannot edit this trait.  Please choose another trait."},trait_edit_error_loading_model: {message: "There was an error loading the model.  Please refresh and try again."},generic_404: {message: "There was an error loading a resource. Please refresh and try again."},segment_added_to_destination: {message: "The segments have been added to the destination."},segment_cannot_clone: {message: "Sorry, you do not have permissions to clone this trait."},destinations_permission_missing_view: {message: "You do not have permissions to view this section"},segments_permission_missing_view: {message: "You do not have permissions to view this section"},user_delete_confirmation: {message: "Are you sure you want to delete this user?"},user_permissions_delete_user: {message: "Delete User"},user_permissions_delete_users: {message: "Delete Users"},user_permissions_delete_user_empty: {message: "You must select at least 1 user to delete"},user_permissions_user_deleted: {message: "User Deleted"},user_permissions_user_deleted_message: {message: "The user has been deleted"},user_deleted_error: {message: "The user(s) could not be deleted"},group_delete_confirmation: {message: "Are you sure you want to delete this group?"},group_permissions_delete_group: {message: "Delete Group"},group_permissions_delete_groups: {message: "Delete Groups"},group_permissions_delete_group_empty: {message: "You must select at least 1 group to delete"},group_permissions_group_deleted: {message: "Group Deleted"},group_permissions_group_deleted_message: {message: "The group has been deleted"},group_deleted_error: {message: "The group(s) could not be deleted"},group_permissions_add_object: {message: "Add Object Permissions"},change_password: {message: "Change Password"},change_password_prompt: {message: "Do you want to reset the users password?"},change_password_problem: {message: "There was a problem resetting the password"},change_password_success: {message: "The password has been reset"},models: {message: "Models"},reports: {message: "Reports"},trait: {message: "Trait"},segment: {message: "Segment"},destination: {message: "Destination"},derived_signals: {message: "Derived Signals"},tags: {message: "Tags"},view_tags: {message: "View Tags"},view_derived_signals: {message: "View Derived Signals"},create_derived_signals: {message: "Create Derived Signals"},edit_derived_signals: {message: "Edit Derived Signals"},delete_derived_signals: {message: "Delete Derived Signals"},delete_all_traits: {message: "Delete All Traits"},create_all_traits: {message: "Create All Traits"},create_all_algo_traits: {message: "Create All Algo Traits"},edit_all_traits: {message: "Edit All Traits"},map_all_to_segments: {message: "Map All To Segments"},map_all_traits_to_models: {message: "Map All Traits To Models"},view_all_traits: {message: "View All Traits"},view_all_destinations: {message: "View All Destinations"},delete_all_destinations: {message: "Delete All Destinations"},edit_all_destinations: {message: "Edit All Destinations"},map_all_segments_to_models: {message: "Map All Segments To Models"},delete_all_segments: {message: "Delete All Segments"},edit_all_segments: {message: "Edit All Segments"},map_all_to_destinations: {message: "Map All To Destinations"},create_all_segments: {message: "Create All Segments"},view_all_segments: {message: "View All Segments"},bid_manager_destination_1_segment: {message: "You can only map 1 segment to this type of destination"},bid_manager_duplicate_userlist: {message: "This Google Bid Manager destination has already been mapped to a segment"},google_user_list_validation_error: {message: "There was a problem mapping this Google Bid Manager destination to this segment"},google_user_list_service_not_reachable: {message: "The Google Bid Manager service is not reachable"},datasource_saved: {message: "The data source was saved successfully."},datasource_delete_confirmation: {message: "Are you sure you want to delete this data source?"},datasource_permissions_delete_datasource: {message: "Delete Data Source"},datasource_permissions_delete_datasources: {message: "Delete Data Sources"},datasource_permissions_delete_datasource_empty: {message: "You must select at least 1 data source to delete"},datasource_permissions_datasource_deleted: {message: "Data Source Deleted"},datasource_permissions_datasource_deleted_message: {message: "The data source has been deleted"},datasource_deleted_error: {message: "The data source(s) could not be deleted"},resource_limit_exceeded: {message: "The resource limit was exceeded. Please check the Limits page for your resource limit."},no_dcs_event_call_data_returned: {message: "Please check if third party cookies are enabled on your browser.<br />Safari, in particular, disables third party cookies by default.<br />This functionality will also not work if you are using ad blocking software."},months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"]},getMessage: function(e, t) {
        return this[t || "en_US"][e.toLowerCase()]
    },getAPIErrorMessage: function(e, t) {
        var n = "", r = this.getMessage("generic_api_error").message, i = "<br />";
        t !== Object(t) && (t = {}), e !== Object(e) && (e = {}), typeof t.joinChildMessagesOn == "string" && (i = t.joinChildMessagesOn), typeof t.defaultErrorMessage == "string" && (r = t.defaultErrorMessage);
        if (Array.isArray(e.childMessages))
            return e.childMessages.join(i);
        var s = JSON.parse(e.responseText || "{}");
        if (Array.isArray(s.childMessages))
            return s.childMessages.join(i);
        var o = e.data;
        o !== Object(o) && (o = {});
        var u = e.code || o.code || s.code || "";
        typeof t.codePrefix == "string" && (u = t.codePrefix + u);
        var a = this.getMessage(u) || {};
        return a.message || e.message || o.message || s.message || r
    }}, ADOBE.AM.PERMS = {permissions: {traits: {map_to_segments: "MAP_TO_SEGMENTS",view: "READ"},user: {create_destinations: "CREATE_DESTINATIONS",create_all_destinations: "CREATE_ALL_DESTINATIONS",edit_destinations: "EDIT_DESTINATIONS",edit_all_destinations: "EDIT_ALL_DESTINATIONS"},destinations: {write: "WRITE"}},permission_schemes: {can_view_traits: {UserPermission: ["VIEW_TRAITS"]},can_create_trait: {UserPermission: ["CREATE_TRAITS", "CREATE_ALL_TRAITS"],DataSourcePermission: ["CREATE"],TraitPermission: ["CREATE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DataSourcePermission"), r = e.getPermissionObjects("TraitPermission");
                return !t || !t.hasPermission("CREATE_TRAITS") ? !1 : t.hasPermission("CREATE_ALL_TRAITS") || n && n.hasPermission("CREATE") || r && r.hasPermission("CREATE")
            }},can_edit_trait: {UserPermission: ["EDIT_TRAITS", "EDIT_ALL_TRAITS"],TraitPermission: ["WRITE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("TraitPermission");
                return n && n.hasPermission("WRITE")
            }},can_use_dataprovider_to_edit_trait: {UserPermission: ["EDIT_TRAITS", "EDIT_ALL_TRAITS"],DataSourcePermission: ["WRITE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DataSourcePermission");
                return t && !t.hasPermission("EDIT_TRAITS") ? !1 : t && t.hasPermission("EDIT_ALL_TRAITS") || n && n.hasPermission("WRITE") ? !0 : !1
            }},can_delete_trait: {UserPermission: ["DELETE_TRAITS", "DELETE_ALL_TRAITS"],TraitPermission: ["DELETE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("TraitPermission");
                return n && n.hasPermission("DELETE")
            }},can_show_delete_toolbar_button_in_traitbuilder: {UserPermission: ["DELETE_TRAITS"]},can_delete_this_trait_in_traitbuilder: {TraitPermission: ["DELETE"]},can_show_add_segment_toolbar_button_in_traitbuilder: {UserPermission: ["CREATE_SEGMENTS"]},can_clone_rule_based_trait_in_traitbuilder: {UserPermission: ["CREATE_TRAITS", "CREATE_ALL_TRAITS"],TraitPermission: ["CREATE"],permissionCheck: function(e) {
                var t = this.UserPermission[0], n = this.UserPermission[1], r = this.TraitPermission[0], i = e.getPermissionObjects("UserPermission"), s = e.getPermissionObjects("TraitPermission");
                return i && !i.hasPermission(t) ? !1 : i && i.hasPermission(n) || s && s.hasPermission(r) ? !0 : !1
            }},can_clone_algo_trait_in_traitbuilder: {UserPermission: ["CREATE_TRAITS", "CREATE_ALL_TRAITS"],TraitPermission: ["CREATE", "CREATE_ALGO_TRAITS"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("TraitPermission");
                return t && !t.hasPermission("CREATE_TRAITS") ? !1 : t && t.hasPermission("CREATE_ALL_TRAITS") || n && n.hasPermission("CREATE") && n && n.hasPermission("CREATE_ALGO_TRAITS") ? !0 : !1
            }},can_use_dataprovider_to_create_trait: {DataSourcePermission: ["CREATE"]},can_create_trait_in_traitbuilder: {UserPermission: ["CREATE_TRAITS", "CREATE_ALL_TRAITS"],DataSourcePermission: ["CREATE"],permissionCheck: function(e) {
                var t = this.UserPermission[0], n = this.UserPermission[1], r = this.DataSourcePermission[0], i = e.getPermissionObjects("UserPermission"), s = e.getPermissionObjects("DataSourcePermission");
                return i && !i.hasPermission(t) ? !1 : i && i.hasPermission(n) || s && s.hasPermission(r) ? !0 : !1
            }},can_create_model_with_selected: {UserPermission: ["CREATE_MODELS"],DataSourcePermission: ["MAP_TO_MODELS"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DataSourcePermission");
                return !t || !t.hasPermission("CREATE_MODELS") ? !1 : n && n.hasPermission("MAP_TO_MODELS")
            }},can_edit_derived_signals: {UserPermission: ["EDIT_DERIVED_SIGNALS"]},can_delete_derived_signals: {UserPermission: ["DELETE_DERIVED_SIGNALS"]},can_view_model: {ModelPermission: ["CREATE_ALGO_TRAITS", "READ"]},can_clone_model: {UserPermission: ["CREATE_MODELS"],ModelPermission: ["CREATE", "READ"],permissionCheck: function(e) {
                var t = this.UserPermission[0], n = this.ModelPermission[0], r = this.ModelPermission[1], i = e.getPermissionObjects("UserPermission"), s = e.getPermissionObjects("ModelPermission");
                return i && !i.hasPermission(t) ? !1 : s && s.hasPermission(n) && s.hasPermission(r) ? !0 : !1
            }},can_pause_play_model: {UserPermission: ["EDIT_MODELS"],ModelPermission: ["WRITE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("ModelPermission");
                return t && !t.hasPermission("EDIT_MODELS") ? !1 : n && n.hasPermission("WRITE") ? !0 : !1
            }},can_edit_model: {UserPermission: ["EDIT_MODELS"],ModelPermission: ["WRITE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("ModelPermission");
                return t && !t.hasPermission("EDIT_MODELS") ? !1 : n && n.hasPermission("WRITE") ? !0 : !1
            }},can_delete_single_model: {UserPermission: ["DELETE_MODELS"],ModelPermission: ["DELETE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("ModelPermission");
                return t && !t.hasPermission("DELETE_MODELS") ? !1 : n && n.hasPermission("DELETE") ? !0 : !1
            }},can_delete_model: {UserPermission: ["DELETE_MODELS"],DataSourcePermission: ["MAP_TO_MODELS"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DataSourcePermission");
                return t && !t.hasPermission("DELETE_MODELS") ? !1 : n && n.hasPermission("MAP_TO_MODELS") ? !0 : !1
            }},can_create_model: {UserPermission: ["CREATE_MODELS"],DataSourcePermission: ["MAP_TO_MODELS"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DataSourcePermission");
                return t && !t.hasPermission("CREATE_MODELS") ? !1 : n && n.hasPermission("MAP_TO_MODELS") ? !0 : !1
            }},can_create_trait_with_current_model: {ModelPermission: ["CREATE_ALGO_TRAITS"]},can_view_destinations: {UserPermission: "VIEW_DESTINATIONS"},can_edit_destination: {DestinationPermission: ["WRITE"],UserPermission: ["EDIT_DESTINATIONS", "EDIT_ALL_DESTINATIONS"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DestinationPermission");
                return t && t.hasPermission("EDIT_DESTINATIONS") && t.hasPermission("EDIT_ALL_DESTINATIONS") ? !0 : t && n && t.hasPermission("EDIT_DESTINATIONS") && n.hasPermission("WRITE") ? !0 : !1
            }},can_delete_destination: {DestinationPermission: ["DELETE"],UserPermission: ["DELETE_DESTINATIONS", "DELETE_ALL_DESTINATIONS"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DestinationPermission");
                return !t || !t.hasPermission("DELETE_DESTINATIONS") ? !1 : t && t.hasPermission("DELETE_ALL_DESTINATIONS") || n && n.hasPermission("DELETE") ? !0 : !1
            }},can_use_dataprovider_to_create_segment: {DataSourcePermission: ["CREATE"]},can_use_dataprovider_to_edit_segment: {UserPermission: ["EDIT_SEGMENTS", "EDIT_ALL_SEGMENTS"],DataSourcePermission: ["WRITE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DataSourcePermission");
                return t && !t.hasPermission("EDIT_SEGMENTS") ? !1 : t && t.hasPermission("EDIT_ALL_SEGMENTS") || n && n.hasPermission("WRITE") ? !0 : !1
            }},can_edit_segment_in_segmentbuilder: {UserPermission: ["EDIT_SEGMENTS", "EDIT_ALL_SEGMENTS"],SegmentPermission: ["WRITE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("SegmentPermission");
                return t && !t.hasPermission("EDIT_SEGMENTS") ? !1 : t && t.hasPermission("EDIT_ALL_SEGMENTS") || n && n.hasPermission("WRITE") ? !0 : !1
            }},can_create_segment_in_segmentbuilder: {UserPermission: ["CREATE_ALL_SEGMENTS", "CREATE_SEGMENTS"],DataSourcePermission: ["CREATE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("DataSourcePermission");
                return t.hasPermission("CREATE_ALL_SEGMENTS") ? !0 : t && n && t.hasPermission("CREATE_SEGMENTS") && n.hasPermission("CREATE") ? !0 : !1
            }},can_view_segments: {UserPermission: ["VIEW_SEGMENTS"]},can_clone_segment_in_segmentbuilder: {UserPermission: ["CREATE_SEGMENTS", "CREATE_ALL_SEGMENTS"],SegmentPermission: ["CREATE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("SegmentPermission");
                return t && !t.hasPermission("CREATE_SEGMENTS") ? !1 : t.hasPermission("CREATE_ALL_SEGMENTS") || n && n.hasPermission("CREATE") ? !0 : !1
            }},can_map_trait_to_segment_in_segmentbuilder: {UserPermission: ["VIEW_TRAITS", "MAP_ALL_TO_SEGMENTS"]},can_delete_segment_in_segmentbuilder: {UserPermission: ["DELETE_SEGMENTS", "DELETE_ALL_SEGMENTS"],SegmentPermission: ["DELETE"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("SegmentPermission");
                return t.hasPermission("DELETE_SEGMENTS") ? t.hasPermission("DELETE_ALL_SEGMENTS") ? !0 : n && n.hasPermission("DELETE") ? !0 : !1 : !1
            }},can_show_segment_to_destination_in_sb_toolbar_buttons: {UserPermission: ["VIEW_DESTINATIONS"]},can_map_segment_to_destination_in_segmentbuilder: {UserPermission: ["VIEW_DESTINATIONS", "VIEW_SEGMENTS", "VIEW_ALL_SEGMENTS", "MAP_ALL_TO_DESTINATIONS"],SegmentPermission: ["READ", "MAP_TO_DESTINATIONS"],permissionCheck: function(e) {
                var t = e.getPermissionObjects("UserPermission"), n = e.getPermissionObjects("SegmentPermission");
                return t.hasPermission("VIEW_DESTINATIONS") ? t.hasPermission("VIEW_SEGMENTS") ? t.hasPermission("VIEW_ALL_SEGMENTS") || n && n.hasPermission("READ") ? t.hasPermission("MAP_ALL_TO_DESTINATIONS") || n && n.hasPermission("MAP_TO_DESTINATIONS") ? !0 : !1 : !1 : !1 : !1
            }},can_create_datasources_in_toolbar: {UserPermission: ["CREATE_DATASOURCES"]},can_edit_datasources_in_toolbar: {UserPermission: ["EDIT_DATASOURCES"]},can_delete_datasources_in_toolbar: {UserPermission: ["DELETE_DATASOURCES"]}}}, function(e) {
    e.fn.serializeJSON = function() {
        var t = {};
        return jQuery.map(e(this).serializeArray(), function(e, n) {
            t[e.name] = e.value
        }), t
    }
}(jQuery), function(e) {
    e.whenAlways = function() {
        function s() {
            for (var e = 0; e < t; e++) {
                if (!n[e])
                    return !1;
                e == t - 1 && r.resolve()
            }
        }
        var t, n = [], r = e.Deferred();
        arguments.length == 1 && arguments[0].length && (arguments = arguments[0]), t = arguments.length;
        for (var i = 0; i < t; i++)
            n[i] = !1;
        for (var i = 0; i < t; i++)
            (function() {
                e.when(arguments[i]).always(function() {
                    n[i] = !0, s()
                })
            })();
        return r
    }
}(jQuery), window.getTemplate = window.getTemplate || function(e, t, n) {
    typeof window.getTemplate.cache == "undefined" && (window.getTemplate.cache = {nodeStore: {},templates: {},getFromCache: function(e, t) {
            var n, r;
            return this.nodeStore[t] ? n = this.nodeStore[t] : n = this.setSourceCache(t), this.templates[e] || (_.each(n.childNodes, function(e) {
                e.nodeName != "SCRIPT" && n.removeChild(e)
            }), r = _.filter(n.childNodes, function(t) {
                return t.id != e ? !1 : (n.removeChild(t), t)
            })[0], this.setTemplateCache(e, r.innerHTML)), this.templates[e]
        },setSourceCache: function(e) {
            var t = document.createElement("div");
            return t.innerHTML = e, this.nodeStore[e] = t, t
        },setTemplateCache: function(e, t) {
            this.templates[e] = t
        }});
    var r = getTemplate.cache.getFromCache(e, t), i = !0;
    return n ? n.compile == 1 || typeof n.compile == "undefined" ? i = !0 : n.compile == 0 && (i = !1, delete n.compile) : i = !0, i ? _.template(r, n) : r
}, define("adobe", ["jquery", "underscore"], function(e) {
    return function() {
        var t, n;
        return t || e.ADOBE
    }
}(this)), define("text", ["module"], function(e) {
    var t, n, r = ["Msxml2.XMLHTTP", "Microsoft.XMLHTTP", "Msxml2.XMLHTTP.4.0"], i = /^\s*<\?xml(\s)+version=[\'\"](\d)*.(\d)*[\'\"](\s)*\?>/im, s = /<body[^>]*>\s*([\s\S]+)\s*<\/body>/im, o = typeof location != "undefined" && location.href, u = o && location.protocol && location.protocol.replace(/\:/, ""), a = o && location.hostname, f = o && (location.port || undefined), l = [], c = e.config && e.config() || {};
    t = {version: "2.0.3",strip: function(e) {
            if (e) {
                e = e.replace(i, "");
                var t = e.match(s);
                t && (e = t[1])
            } else
                e = "";
            return e
        },jsEscape: function(e) {
            return e.replace(/(['\\])/g, "\\$1").replace(/[\f]/g, "\\f").replace(/[\b]/g, "\\b").replace(/[\n]/g, "\\n").replace(/[\t]/g, "\\t").replace(/[\r]/g, "\\r").replace(/[\u2028]/g, "\\u2028").replace(/[\u2029]/g, "\\u2029")
        },createXhr: c.createXhr || function() {
            var e, t, n;
            if (typeof XMLHttpRequest != "undefined")
                return new XMLHttpRequest;
            if (typeof ActiveXObject != "undefined")
                for (t = 0; t < 3; t += 1) {
                    n = r[t];
                    try {
                        e = new ActiveXObject(n)
                    } catch (i) {
                    }
                    if (e) {
                        r = [n];
                        break
                    }
                }
            return e
        },parseName: function(e) {
            var t = !1, n = e.indexOf("."), r = e.substring(0, n), i = e.substring(n + 1, e.length);
            return n = i.indexOf("!"), n !== -1 && (t = i.substring(n + 1, i.length), t = t === "strip", i = i.substring(0, n)), {moduleName: r,ext: i,strip: t}
        },xdRegExp: /^((\w+)\:)?\/\/([^\/\\]+)/,useXhr: function(e, n, r, i) {
            var s, o, u, a = t.xdRegExp.exec(e);
            return a ? (s = a[2], o = a[3], o = o.split(":"), u = o[1], o = o[0], (!s || s === n) && (!o || o.toLowerCase() === r.toLowerCase()) && (!u && !o || u === i)) : !0
        },finishLoad: function(e, n, r, i) {
            r = n ? t.strip(r) : r, c.isBuild && (l[e] = r), i(r)
        },load: function(e, n, r, i) {
            if (i.isBuild && !i.inlineText) {
                r();
                return
            }
            c.isBuild = i.isBuild;
            var s = t.parseName(e), l = s.moduleName + "." + s.ext, h = n.toUrl(l), p = c.useXhr || t.useXhr;
            !o || p(h, u, a, f) ? t.get(h, function(n) {
                t.finishLoad(e, s.strip, n, r)
            }, function(e) {
                r.error && r.error(e)
            }) : n([l], function(e) {
                t.finishLoad(s.moduleName + "." + s.ext, s.strip, e, r)
            })
        },write: function(e, n, r, i) {
            if (l.hasOwnProperty(n)) {
                var s = t.jsEscape(l[n]);
                r.asModule(e + "!" + n, "define(function () { return '" + s + "';});\n")
            }
        },writeFile: function(e, n, r, i, s) {
            var o = t.parseName(n), u = o.moduleName + "." + o.ext, a = r.toUrl(o.moduleName + "." + o.ext) + ".js";
            t.load(u, r, function(n) {
                var r = function(e) {
                    return i(a, e)
                };
                r.asModule = function(e, t) {
                    return i.asModule(e, a, t)
                }, t.write(e, u, r, s)
            }, s)
        }};
    if (c.env === "node" || !c.env && typeof process != "undefined" && process.versions && !!process.versions.node)
        n = require.nodeRequire("fs"), t.get = function(e, t) {
            var r = n.readFileSync(e, "utf8");
            r.indexOf("﻿") === 0 && (r = r.substring(1)), t(r)
        };
    else if (c.env === "xhr" || !c.env && t.createXhr())
        t.get = function(e, n, r) {
            var i = t.createXhr();
            i.open("GET", e, !0), c.onXhr && c.onXhr(i, e), i.onreadystatechange = function(t) {
                var s, o;
                i.readyState === 4 && (s = i.status, s > 399 && s < 600 ? (o = new Error(e + " HTTP status: " + s), o.xhr = i, r(o)) : n(i.responseText))
            }, i.send(null)
        };
    else if (c.env === "rhino" || !c.env && typeof Packages != "undefined" && typeof java != "undefined")
        t.get = function(e, t) {
            var n, r, i = "utf-8", s = new java.io.File(e), o = java.lang.System.getProperty("line.separator"), u = new java.io.BufferedReader(new java.io.InputStreamReader(new java.io.FileInputStream(s), i)), a = "";
            try {
                n = new java.lang.StringBuffer, r = u.readLine(), r && r.length() && r.charAt(0) === 65279 && (r = r.substring(1)), n.append(r);
                while ((r = u.readLine()) !== null)
                    n.append(o), n.append(r);
                a = String(n.toString())
            }finally {
                u.close()
            }
            t(a)
        };
    return t
}), define("text!adobe_am/trait_builder/templates.html", [], function() {
    return '<script type="text/template" id="view_page_segments_with_trait_table">\n    <table class="table">\n        <thead>\n            <tr>\n                <th>Segment ID</th>\n                <th>Name</th>\n                <th>Description</th>\n            </tr>\n        </thead>\n        <tbody class="segments_with_trait_body"></tbody>\n    </table>\n</script>\n\n<script type="text/template" id="view_page_segments_with_trait_row">\n    <td><@= sid @></td>\n    <td><a href="<@= displayLink(sid) @>"><@= name @></a></td>\n    <td><@= description @></td>\n</script>\n\n<script type="text/template" id="view_page_segments_with_trait_row_empty">\n    <tr class="nodata">\n        <td colspan="3">No Data</td>\n    </tr>\n</script>\n\n<script type="text/template" id="view_page_layout">\n	<div class="top_toolbar"></div>\n	<h1 class="page_title"></h1>\n	<div class="basic_info_and_graph dashboard">\n        <div class="right_panel">\n            <div class="widget last"></div>\n        </div>\n        <div class="left_panel basicInfo left">\n            <div class="widget"></div>\n        </div>\n    </div>\n	<div class="dashboard no-border">\n        <div class="bottom_left_panel widget"></div>\n    	<div class="right last segments_panel widget">\n            <h3>Segments with this Trait</h3>\n        	<div class="segments"></div>\n        </div>\n    </div>\n</script>\n\n<script type="text/template" id="view_page_algo_configuration">\n    <h3>Configuration</h3>\n    <div class="basic_info content">\n        <dl>\n            <dt>Model:</dt>\n            <dd><@= name @></dd>\n            <dt>Goal:</dt>\n            <dd><@= goal @></dd>\n            <dt>Value:</dt>\n            <dd><@= formatNumber(value) @></dd>\n        </dl>\n    </div>\n</script>\n\n<script type="text/template" id="view_page_trait_expression">\n    <h3>Trait Expression</h3>\n    <div class="content view_trait_expression"></div>\n</script>\n\n<script type="text/template" id="view_page_rule_builder">\n    <div class="tabContent" id="expBuilder">\n        <table id="exprTable" class="groupTable">\n            <tbody></tbody>\n        </table>\n    </div>\n</script>\n\n<script type="text/template" id="view_page_rule_widget_no_rule">\n    <tr>\n        <td align="center" style="height:80px; background-color:white;"><b><@= no_rules @></b></td>\n    </tr>\n</script>\n\n<script type="text/template" id="view_page_rule_widget">\n    <table id="rulesTable" class="groupTable" cellpadding="0" cellspacing="0">\n        <tbody>\n            <tr class="groupTop ruleBorder">\n                <td class="first"></td>\n                <td colspan="3"></td>\n                <td class="last"></td>\n            </tr>\n            <tr class="groupBtm ruleBorder">\n                <td class="first"></td>\n                <td colspan="3"></td>\n                <td class="last"></td>\n            </tr>\n        </tbody>\n        <tfoot>\n            <tr>\n                <td><label>Key</label></td>\n                <td><label>Operator</label></td>\n                <td><label>Value</label></td>\n            </tr>\n            <tr class="addRule">\n                <td><input id="key" type="text" size="15" /></td>\n                <td><select id="operator"><option></option><option>==</option><option>!=</option><option>&gt;</option><option>&lt;</option><option>&gt;=</option><option>&lt;=</option><option>contains</option><option>matchesregex</option><option>startswith</option><option>endswith</option></select></td>\n                <td>\n                    <input id="val" type="text" size="15" />\n                </td>\n                <td>\n                    <button type="button" class="clearRuleBtn secondary">Clear</button>\n                    <button type="button" class="addRuleBtn primary">Add Rule</button>\n                    <span class="context-help" title="Help" data-id="t_tb_create_rules.html">&nbsp;</span>\n                </td>\n            </tr>\n        </tfoot>\n    </table>\n</script>\n\n<script type="text/template" id="view_page_toolbar_buttons">\n    <ul class="toolbar">\n        <@ if (data.add) { @><li class="new_algotrait"><img class="icon" src="/css/aam/images/Add_Standard.png">Create New Trait<ul id="atMenu" class="am-aui-menu"><li class="item_rule_based_trait"><a href="#new/rule" rel="rb">Rules-based</a></li><li><a href="#new/algo">Algorithmic</a></li><li><a href="#new/onboarded">Onboarded</a></li></ul></li><@ } @>\n        <@ if (data.edit) { @><li class="edit_algotrait"><img class="icon" src="/css/aam/images/Edit_Standard.png">Edit</li><@ } @>\n        <@ if (data.clone) { @><li class="clone_algotrait"><img class="icon" src="%%IMG_CLONE_STANDARD%%">Clone</li><@ } @>\n        <@ if (data.del) { @><li class="delete_algotrait"><img class="icon" src="/css/aam/images/ClearXGrey_Buttcon.png">Delete</li><@ } @>\n    </ul>\n</script>\n\n<script type="text/template" id="list_traits_table">\n    <table class="table" id="traits_table">\n        <thead>\n        <tr>\n        <th width="1%" class="column_checkbox disabled">\n            <img src="/css/aam/images/checkbox_unchecked.png" class="AUI_Menu_icon result_checkbox_disabled">\n            <img src="/css/aam/images/checkbox_checked.png" class="AUI_Menu_icon result_checkbox_enabled">\n            <input type="checkbox" style="display:none"/>\n        </th>\n        <th width="5%" class="sortable" data-sortby="sid">Trait ID</th>\n        <th width="20%" class="sortable" data-sortby="name">Name</th>\n        <th width="27%" class="sortable" data-sortby="description">Description</th>\n        <th width="10%" class="sortable" data-sortby="traitType">Type</th>\n        <th width="8%" class="sortable" data-sortby="dataSourceName">Data Source</th>\n        <th width="10%" class="actions">Actions</th>\n        </th>\n        </thead>\n        <tbody></tbody>\n    </table>\n</script>\n\n<script type="text/template" id="list_traits_table_row">\n    <td>\n        <span class="result_checkbox"><@= displayCheckbox() @></span>\n    </td>\n    <td><@= sid @></td>\n    <td class="name"><a href="#view/<@= sid @>"><@= name @></a></td>\n    <td class="description"><@= description @></td>\n    <td><@= getTraitTypeName(traitType) @></td>\n    <td><@= getDataSourceName(dataSourceId) @></td>\n    <td class="actions">\n        <ul>\n            <li class="getPixel" title="Get Trait URL"></li>\n            <@ if (getPermission("edit")) { @><li class="editTrait listEdit" title="Edit this trait"></li><@ } @>\n            <@ if (getPermission("clone")) { @><li class="cloneTrait listClone" title="Clone this trait"></li><@ } @>\n            <@ if (getPermission("del")) { @><li class="deleteTrait listDelete" title="Delete this trait"></li><@ } @>\n        </ul>\n    </td>\n</script>\n\n<script type="text/template" id="rule_builder_top">\n    <tr class="groupTop ruleBorder" style="display: table-row;">\n        <td class="first"></td>\n        <td colspan="3"></td>\n        <td class="last"></td>\n    </tr>\n</script>\n\n<script type="text/template" id="rule_builder_bottom">\n    <tr class="groupBtm ruleBorder" style="display: table-row;">\n        <td class="first"></td>\n        <td colspan="3"></td>\n        <td class="last"></td>\n    </tr>\n</script>\n\n<script type="text/template" id="rule_builder_rule">\n    <tr id="rule<@= cnt @>" class="signalRule">\n        <td class="first"></td>\n        <td class="key"><@= key @></td>\n        <td class="op"><@= operator @></td>\n        <td class="val"><@= value @></td>\n        <td class="last">\n            <ul class="ruleActions">\n                <li class="editRuleBtn" data-id="rule<@= cnt @>" title="Edit"></li>\n                <li class="deleteRuleBtn" data-id="rule<@= cnt @>" title="Delete"></li>\n            </ul>\n        </td>\n    </tr>\n</script>\n\n<script type="text/template" id="rule_builder_op">\n    <tr class="ruleOp <@= on_off @>">\n        <td class="first"></td>\n        <td colspan="3">\n            <select class="ruleOpSelect">\n                <option></option>\n                <option <@= isSelected(\'and\') @>>AND</option>\n                <option <@= isSelected(\'and not\') @>>AND NOT</option>\n                <option <@= isSelected(\'or\') @>>OR</option>\n            </select>\n        </td>\n        <td class="last"></td>\n    </tr>\n</script>'
}), define("adobe_am/trait_builder/views/viewPageLayout", ["backbone", "backbone.marionette", "underscore", "app", "adobe", "text!adobe_am/trait_builder/templates.html"], function(e, t, n, r, i, s) {
    var r = r || APP;
    return e.Marionette.Layout.extend({id: "TraitView",populateTraitNameHeader: function() {
            this.$el.find(".page_title").html(this.model.get("name"))
        },regions: {toolbar: ".top_toolbar",basic_info: ".left_panel .widget",graph: ".right_panel .widget",lower_left_panel: ".bottom_left_panel",segments: ".segments"},onShow: function() {
            this.populateTraitNameHeader()
        },template: getTemplate("view_page_layout", s)})
}), define("adobe_am/trait_builder/routers/viewPageRouter", ["backbone", "backbone.marionette"], function(e, t) {
    return e.Marionette.AppRouter.extend({appRoutes: {"view/:sid": "showViewPage"}})
}), define("adobe_am/vent", ["backbone", "backbone.marionette"], function(e, t) {
    return new e.Marionette.EventAggregator
}), define("adobe_am/trait_builder/controllers/viewPageController", ["adobe_am/vent"], function(e) {
    return {showViewPage: function(t) {
            e.trigger("show:viewpage", t)
        }}
}), define("modules/Trait/Models/Folder", ["backbone", "adobe", "globals"], function(e, t, n) {
    var r, i;
    return arguments.length == 0 ? (r = ADOBE.AM.pid, i = ADOBE.AM.API, e = Backbone) : (r = n.pid, i = t.AM.API), e.Model.extend({initialize: function(e) {
            e && e.folderId && this.set({id: e.folderId})
        },url: function() {
            return i.TRAITS.folders.url(this.get("folderId"))
        },getFolderId: function() {
            return this.get("folderId")
        }})
}), define("modules/Trait/Models/Type", ["backbone", "adobe", "globals"], function(e, t, n) {
    var r, i;
    return arguments.length == 0 ? (r = ADOBE.AM.pid, i = ADOBE.AM.API, e = Backbone) : (r = n.pid, i = t.AM.API), e.Model.extend({initialize: function(e) {
            e && e.pixelType && this.set({id: e.pixelType})
        },url: function() {
            return i.TRAITS.type.url(this.get("pixelType"))
        }})
}), define("modules/Permission/Models/Permission", ["backbone"], function(e) {
    return e == undefined && (e = Backbone), e.Model.extend({valid_permissions: [],initialize: function(e) {
            var t = null;
            if (!e)
                throw new Error("name is required");
            if (!e.name && this.name === null)
                throw new Error("name is required");
            t = e.name || this.name;
            if (t.match(/Permission$/) === null)
                throw new Error("name must end with Permission");
            if (e.permissions === void 0 || e.permissions !== void 0 && !(e.permissions instanceof Array))
                throw new Error("permissions are required")
        },hasPermission: function(e) {
            if (e instanceof Array)
                return !_.difference(e, this.getPermissions()).length;
            if (typeof e != "string")
                throw new Error("Argument must be either a String or an Array");
            return _.indexOf(this.getPermissions(), e) > -1
        },getPermissions: function() {
            return this.get("permissions")
        },getName: function() {
            return this.get("name") !== void 0 ? this.get("name") : this.name
        }})
}), define("modules/DataSource/Models/DataSourcePermission", ["modules/Permission/Models/Permission"], function(e) {
    return e == undefined && (e = ADOBE.AM.Permission.Models.Permission), e.extend({name: "DataSourcePermission"})
}), define("modules/DataSource/Collections/MarketingCloudVisitorIDs", ["backbone", "adobe"], function(e, t) {
    var n;
    return arguments.length == 0 ? (n = ADOBE.AM.API, e = Backbone) : n = t.AM.API, e.Collection.extend({parse: function(e) {
            if (!Array.isArray(e))
                throw new Error("Response not valid!");
            return e.map(function(e) {
                return {id: e}
            })
        },getValues: function() {
            return this.pluck("id")
        },url: function() {
            return n.DATASOURCES.marketingCloudVisitorIdVersions.url()
        }})
}), define("modules/DataSource/Collections/AvailableIdTypes", ["backbone", "adobe"], function(e, t) {
    var n;
    return arguments.length == 0 ? (n = ADOBE.AM.API, e = Backbone) : n = t.AM.API, e.Collection.extend({parse: function(e) {
            if (!Array.isArray(e))
                throw new Error("Response not valid!");
            return e.map(function(e) {
                return {type: e}
            })
        },isIdTypeCrossDevice: function(e) {
            return e === "CROSS_DEVICE"
        },url: function() {
            return n.DATASOURCES.idTypes.url()
        },getValues: function() {
            return this.pluck("type")
        }})
}), define("modules/DataSource/Models/DataSource", ["underscore", "backbone", "adobe", "globals", "modules/DataSource/Models/DataSourcePermission", "modules/DataSource/Collections/MarketingCloudVisitorIDs", "modules/DataSource/Collections/AvailableIdTypes"], function(e, t, n, r, i, s, o) {
    var u, a;
    return arguments.length === 0 ? (e = window._, u = ADOBE.AM.pid, a = ADOBE.AM.API, t = Backbone, i = ADOBE.AM.DataSource.Models.DataSourcePermission, s = ADOBE.AM.DataSource.Collections.MarketingCloudVisitorIDs, o = ADOBE.AM.DataSource.Collections.AvailableIdTypes) : (u = r.pid, a = n.AM.API), t.Model.extend({defaults: {name: "",outboundS2S: !1,description: "",inboundS2S: !1,integrationCode: "",allowDataSharing: !1,useAudienceManagerVisitorID: !1,uniqueSegmentIntegrationCodes: !1,uniqueTraitIntegrationCodes: !1,masterDataSourceIdProvider: !1,marketingCloudVisitorIdVersion: 0,idType: ""},set: function(n, r) {
            return e.isObject(n) && n.hasOwnProperty("idType") && this.isIdTypeCrossDevice(n.idType) ? n.useAudienceManagerVisitorID = !1 : e.isString(n) && n === "idType" && this.isIdTypeCrossDevice(r) && (this.attributes.useAudienceManagerVisitorID = !1), t.Model.prototype.set.call(this, n, r)
        },initialize: function(e) {
            this.set({id: this.get("dataSourceId")}), this.relational = this.relational || {}, e && e.permissions && this.setDataSourcePermissions(e.permissions)
        },idAttribute: "dataSourceId",setDataSourcePermissions: function(e) {
            var t = this.relational || {};
            t.permissions = new i({permissions: e})
        },url: function() {
            return a.DATASOURCES.dataSources.url(this.get("dataSourceId"))
        },getDataProviderId: function() {
            return this.get("dataSourceId") || this.get("dataSourceId")
        },parse: function(t) {
            var n = t.permissions;
            return n && e.isArray(n) && this.setDataSourcePermissions(n), t
        },canSetUniqueTraitIntegrationCodes: function() {
            return this.isNew()
        },canSetUniqueSegmentIntegrationCodes: function() {
            return this.isNew()
        },isFirstParty: function() {
            return this.get("pid") === u
        },getIdTypes: function() {
            return this.constructor.IDTYPES
        },isIdTypeCrossDevice: function(e) {
            return this.getIdTypes().isIdTypeCrossDevice(e)
        },isAAMIdDisabled: function() {
            return this.isIdTypeCrossDevice(this.get("idType"))
        },getMarketingCloudVIDs: function() {
            return this.constructor.MARKETING_CLOUD_VIDS
        },Bootstrap: function() {
            return this.constructor.Bootstrap()
        }}, {IDTYPES: new o,MARKETING_CLOUD_VIDS: new s,Bootstrap: function() {
            var e = $.Deferred();
            return $.when(this.IDTYPES.fetch(), this.MARKETING_CLOUD_VIDS.fetch()).then(e.resolve, e.reject), e.promise()
        }})
}), define("modules/Taxonomy/Models/Category", ["backbone", "adobe", "globals"], function(e, t, n) {
    var r, i;
    return arguments.length == 0 ? (i = ADOBE.AM.API, r = ADOBE.AM.pid, e = Backbone) : (r = n.pid, i = t.AM.API), e.Model.extend({initialize: function() {
            this.set({id: this.get("categoryId")})
        },url: function() {
            return i.TAXONOMY.categories.url(this.get("categoryId"))
        },getCategoryId: function() {
            return this.get("categoryId")
        }})
}), define("modules/Trait/Models/TraitPermission", ["modules/Permission/Models/Permission"], function(e) {
    return e == undefined && (e = ADOBE.AM.Permission.Models.Permission), e.extend({name: "TraitPermission"})
}), define("modules/Trait/Models/Trait", ["backbone", "modules/Trait/Models/Folder", "modules/Trait/Models/Type", "modules/DataSource/Models/DataSource", "modules/Taxonomy/Models/Category", "adobe", "globals", "modules/Trait/Models/TraitPermission"], function(e, t, n, r, i, s, o, u) {
    var a, f, l, c;
    return arguments.length == 0 ? (a = ADOBE.AM.pid, e = Backbone, t = ADOBE.AM.Trait.Models.Folder, n = ADOBE.AM.Trait.Models.Type, r = ADOBE.AM.DataSource.Models.DataSource, i = ADOBE.AM.Taxonomy.Models.Category, c = ADOBE.AM.UTILS, l = ADOBE.AM.API, u = ADOBE.AM.Trait.Models.TraitPermission) : (a = o.pid, l = s.AM.API, c = s.AM.UTILS), e.Model.extend({idAttribute: "sid",relational: {},query_string_params: {},valid_API_properties: ["name", "description", "dataSourceId", "algoModelId", "integrationCode", "comments", "type", "folderId", "categoryId", "traitRule", "ttl", "traitType", "thresholdType", "accuracy"],getValidProperties: function() {
            var e = this.get("traitType");
            return e == this.constructor.RuleBasedTraitType || e == this.constructor.OnBoardedTraitType ? _.without(this.valid_API_properties, "algoModelId", "accuracy", "thresholdType") : e == this.constructor.AlgoTraitType ? _.without(this.valid_API_properties, "traitRule", "comments", "type") : this.valid_API_properties
        },initialize: function(e) {
            e && e.sid && this.set({id: e.sid}), this.relational = {}, this.relational.folder = new t, this.relational.type = new n, this.relational.dataSource = new r, this.relational.category = new i, e && e.permissions && this.setTraitPermissions(e.permissions), e && e.query_string_params && this.setParams(e.query_string_params)
        },isDPMTrait: function() {
            return c.HELPERS.isDPMTrait(this.get("traitType"))
        },isAlgoTrait: function() {
            return c.HELPERS.isAlgoTrait(this.get("traitType"))
        },isRuleBasedTrait: function() {
            return this.constructor.RuleBasedTraitType == this.get("traitType")
        },isOnboardedTrait: function() {
            return this.constructor.OnBoardedTraitType == this.get("traitType")
        },isDeletable: function() {
            return this.get("traitType") == this.constructor.RuleBasedTraitType || this.get("traitType") == this.constructor.AlgoTraitType || this.get("traitType") == this.constructor.OnBoardedTraitType
        },isEditable: function() {
            return this.get("traitType") == this.constructor.RuleBasedTraitType || this.get("traitType") == this.constructor.AlgoTraitType || this.get("traitType") == this.constructor.OnBoardedTraitType
        },isClonable: function() {
            return this.get("traitType") == this.constructor.RuleBasedTraitType || this.get("traitType") == this.constructor.AlgoTraitType
        },getFolder: function() {
            var e = this;
            return this.relational.folder.set({folderId: this.get("folderId")}), this.relational.folder.fetch({success: function(t, n) {
                    e.set({folderModel: t})
                }})
        },getFolder2: function() {
            return this.relational.folder
        },folderExists: function() {
            return !!this.relational.folder.getFolderId()
        },loadFolder: function() {
            var e = this.get("folderId");
            return this.relational.folder.set({folderId: e}), this.relational.folder.fetch()
        },getCategory: function() {
            var e = this;
            return this.relational.category.set({categoryId: this.get("categoryId")}), this.relational.category.fetch({success: function(t, n) {
                    e.set({categoryModel: t})
                }})
        },getCategory2: function() {
            return this.relational.category.get("categoryId") ? this.relational.category : !1
        },loadCategory: function() {
            var e = this.get("categoryId");
            return this.relational.category.set({categoryId: e}), this.relational.category.fetch()
        },categoryExists: function() {
            return !!this.relational.category.getCategoryId()
        },getDataSource: function(e) {
            var t = this;
            if (!e) {
                var n = t.get("dataSourceId");
                this.relational.dataSource.set({dataSourceId: n})
            }
            return this.relational.dataSource.fetch({success: function(e, n) {
                    t.set({dataSourceModel: e})
                }})
        },loadDataSource: function() {
            var e = this.get("dataSourceId");
            return this.relational.dataSource.set({dataSourceId: e}), this.relational.dataSource.fetch()
        },getDataSource2: function() {
            return this.relational.dataSource
        },dataSourceExists: function() {
            return !!this.relational.dataSource.getDataProviderId()
        },getType: function(e) {
            var t = this;
            return e || this.relational.type.set({pixelType: t.get("type")}), this.relational.type.fetch({success: function(e) {
                    t.set({typeModel: e})
                }})
        },getType2: function() {
            return this.relational.type
        },setTraitPermissions: function(e) {
            this.relational.permissions = new u({permissions: e})
        },setReach: function(e) {
            this.model.set("thresholdType", "REACH"), this.model.set("accuracy", e)
        },setAccuracy: function(e) {
            this.model.set("thresholdType", "ACCURACY"), this.model.set("accuracy", e)
        },setParams: function(e) {
            _.extend(this.query_string_params, e)
        },url: function() {
            var e = "";
            for (var t in this.query_string_params)
                this.query_string_params.hasOwnProperty(t) && (e += t + "=" + this.query_string_params[t] + "&");
            return e !== "" && (e = "?" + e.replace(/\&$/, "")), l.TRAITS.trait.url(this.get("sid")) + e
        },sync: function(t, n, r) {
            var i = {}, s = {};
            if (t === "update" || t === "create") {
                for (var o in this.attributes)
                    _.indexOf(this.valid_API_properties, o) >= 0 && (i[o] = this.attributes[o]);
                s.data = JSON.stringify(i), _.isObject(r.data) && !_.isEmpty(r.data) && (_.extend(s.data, r.data), delete r.data), _.extend(s, r, {dataType: "json",contentType: "application/json"})
            } else
                s = r;
            return e.sync(t, n, s)
        },parse: function(e) {
            var t = e.permissions;
            return t && _.isArray(t) && this.setTraitPermissions(t), e
        },validate: c.MODELS.validators.validateData}, {AlgoTraitType: "ALGO_TRAIT",RuleBasedTraitType: "RULE_BASED_TRAIT",OnBoardedTraitType: "ON_BOARDED_TRAIT",getTraitTypeName: function(e) {
            switch (e) {
                case "RULE_BASED_TRAIT":
                    return "Rule-based";
                case "ON_BOARDED_TRAIT":
                    return "Onboarded";
                case "ALGO_TRAIT":
                    return "Algorithmic";
                default:
                    return "Unknown"
            }
        },AlgoModelClass: null})
}), define("modules/Model/Models/ModelPermission", ["modules/Permission/Models/Permission"], function(e) {
    return e == undefined && (e = ADOBE.AM.Permission.Models.Permission), e.extend({name: "ModelPermission"})
}), define("modules/Algorithm/Models/Algorithm", ["backbone", "adobe", "globals"], function(e, t, n) {
    var r = null, i;
    return arguments.length == 0 ? (r = ADOBE.AM.pid, e = Backbone, i = ADOBE.AM.API.MODELS.algorithms.url) : (r = n.pid, i = t.AM.API.MODELS.algorithms.url), e.Model.extend({initialize: function(e) {
            e && e.algoTypeId && this.set({id: e.algoTypeId})
        },getName: function() {
            return this.get("name")
        },urlRoot: i()})
}), define("modules/Model/Models/RunStat", ["backbone"], function(e) {
    return e == undefined && (e = Backbone), e.Model.extend({getAccuracy: function() {
            return this.get("AccuracyValue")
        },getReach: function() {
            return this.get("ReachValue")
        }}, {ReachThresholdName: "REACH",AccuracyThresholdName: "ACCURACY"})
}), define("modules/Model/Collections/RunStats", ["backbone", "modules/Model/Models/RunStat", "globals", "adobe"], function(e, t, n, r) {
    var i, s;
    return arguments.length == 0 ? (t = ADOBE.AM.Model.Models.RunStat, s = ADOBE.AM.API, i = ADOBE.AM.pid, e = Backbone) : (i = n.pid, s = r.AM.API), e.Collection.extend({model: t,makeUrl: function(e) {
            this.url = s.MODELS.run_stats.url(e)
        },getMinAccuracy: function() {
            var e = this.at(0);
            if (e)
                return e.getAccuracy();
            throw new Error("No model run statistics")
        },parse: function(e) {
            function a(e) {
                return parseFloat(e).toFixed(2)
            }
            var t = {}, n = [], r = 0, i = this, s = {}, o = 1, u = .05;
            return e && e instanceof Array && e.length && (_.each(e, function(e) {
                t[e.AccuracyValue.toFixed(2)] = e.ReachValue
            }), e && e instanceof Array && e.length && _.each(e, function(e) {
                if (e.ReachValue <= i.constructor.MAX_REACH_AUDIENCE_SIZE) {
                    var t = parseFloat(e.AccuracyValue).toFixed(2);
                    n.push({AccuracyValue: t,ReachValue: e.ReachValue})
                }
            })), n
        },getReachFromAccuracy: function(e) {
            var t = null, n = this.where({AccuracyValue: e});
            return n.length && (t = n[0].getReach()), t
        },getEstimatedAccuracy: function(e) {
            var t = 5, n = -1, r = -1;
            this.each(function(t, r) {
                parseInt(t.get("ReachValue"), 10) > e && (n = r)
            }), r = n + 1;
            if (n == -1)
                return 0;
            if (n == this.length - 1)
                return 1;
            var i = this.at(n), s = this.at(r), o = i.get("ReachValue"), u = s.get("ReachValue"), a = parseInt((o - u) / t, 10), f = i.get("AccuracyValue"), l = parseInt(o - a, 10);
            while (l > e)
                f = parseFloat(f) + .01, l = parseInt(l - a, 10);
            return parseFloat(f).toFixed(2)
        }}, {MAX_REACH_AUDIENCE_SIZE: null})
}), Backbone.Paginator = function(e, t, n) {
    var r = {};
    return r.version = "0.15", r.clientPager = e.Collection.extend({sync: function(e, r, i) {
            var s = {};
            s[this.pageSizeAttribute] = this.pageSize, s[this.skipAttribute] = this.page * this.pageSize, s[this.orderAttribute] = this.sortField, s[this.customAttribute1] = this.customParam1, s[this.formatAttribute] = this.format, s[this.customAttribute2] = this.customParam2, s[this.queryAttribute] = this.query;
            var o = t.extend({type: "GET",dataType: "jsonp",jsonpCallback: "callback",data: decodeURIComponent(n.param(s)),url: this.url,processData: !1}, i);
            return n.ajax(o)
        },nextPage: function() {
            this.page = ++this.page, this.pager()
        },previousPage: function() {
            this.page = --this.page || 1, this.pager()
        },goTo: function(e) {
            e !== undefined && (this.page = parseInt(e, 10), this.pager())
        },howManyPer: function(e) {
            e !== undefined && (this.displayPerPage = parseInt(e, 10), this.pager())
        },setSort: function(e, t) {
            e !== undefined && t !== undefined && this.pager(e, t)
        },pager: function(e, t) {
            var n = this, r = this.displayPerPage, i = (n.page - 1) * r, s = i + r;
            n.origModels === undefined && (n.origModels = n.models), n.models = n.origModels, e && (n.models = n._sort(n.models, e, t)), n.reset(n.models.slice(i, s))
        },_sort: function(e, t, n) {
            return e = e.sort(function(e, r) {
                var i = e.get(t), s = r.get(t);
                if (n === "desc") {
                    if (i > s)
                        return -1;
                    if (i < s)
                        return 1
                } else {
                    if (i < s)
                        return -1;
                    if (i > s)
                        return 1
                }
                return 0
            }), e
        },info: function() {
            var e = this, t = {}, n = e.origModels ? e.origModels.length : e.length, r = Math.ceil(n / e.displayPerPage);
            return t = {totalRecords: n,page: e.page,pageSize: this.displayPerPage,totalPages: r,lastPage: r,lastPagem1: r - 1,previous: !1,next: !1,page_set: [],startRecord: (e.page - 1) * this.displayPerPage + 1,endRecord: Math.min(n, e.page * this.displayPerPage)}, e.page > 1 && (t.prev = e.page - 1), e.page < t.totalPages && (t.next = e.page + 1), t.pageSet = e.setPagination(t), e.information = t, t
        },setPagination: function(e) {
            var t = [], n = 0, r = 0, i = 3, s = i * 2, o = Math.ceil(e.totalRecords / e.pageSize), u = -1;
            if (o > 1)
                if (o < 7 + s)
                    for (n = 1, r = o; n <= r; n++)
                        t.push(n);
                else if (o > 5 + s)
                    if (e.page < 1 + s)
                        for (n = 1, r = 4 + s; n < r; n++)
                            t.push(n);
                    else if (o - s > e.page && e.page > s)
                        for (n = e.page - i; n <= e.page + i; n++)
                            t.push(n);
                    else
                        for (n = o - (2 + s); n <= o; n++)
                            t.push(n);
            return t
        }}), r.requestPager = e.Collection.extend({sync: function(e, r, i) {
            var s = {}, o = "", u;
            s[this.pageSizeAttribute] = r && r.pageSize || this.pageSize, s[this.skipAttribute] = r && r.page || this.page, s[this.orderAttribute] = r && r.sortField || this.sortField, s[this.customAttribute1] = r && typeof r.customParam1 != "undefined" ? r.customParam1 : this.customParam1, s[this.formatAttribute] = this.format, s[this.customAttribute2] = this.customParam2, s[this.queryAttribute] = r && r.query || this.query;
            if (!t.isEmpty(this.custom_query_string_params)) {
                t.isUndefined(this.custom_query_string_params.customParam1) || delete this.custom_query_string_params.customParam1;
                for (var a in s)
                    s.hasOwnProperty(a) && s[a] == null && delete s[a]
            }
            var f = {type: "GET",cache: !1,dataType: "json"};
            t.extend(i.data || {}, this.custom_query_string_params, s);
            for (var a in i.data)
                i.data.hasOwnProperty(a) && i.data[a] == null && delete i.data[a];
            return u = t.extend(f, i), n.ajax(u)
        },requestNextPage: function() {
            this.page !== undefined && (this.page += 1, this.pager())
        },requestPreviousPage: function() {
            this.page !== undefined && (this.page -= 1, this.pager())
        },updateOrder: function(e) {
            e !== undefined && (this.sortField = e, this.pager())
        },goTo: function(e) {
            e !== undefined && (this.page = parseInt(e, 10), this.pager())
        },howManyPer: function(e) {
            e !== undefined && (this.page = this.firstPage, this.pageSize = e, this.pager())
        },sort: function() {
        },info: function() {
            var e = {page: this.page,firstPage: this.firstPage,totalPages: this.totalPages,lastPage: this.totalPages,pageSize: this.pageSize};
            return this.information = e, e
        },pager: function() {
            return this.fetch()
        }}), r
}(Backbone, _, $), define("backbone.paginator", function() {
}), define("modules/Common/Collections/PaginatedItems", ["backbone", "backbone.paginator"], function(e) {
    return e == undefined && (e = Backbone), e.Paginator.requestPager.extend({custom_query_string_params: {},url: "",queryAttribute: "search",pageSizeAttribute: "pageSize",skipAttribute: "page",orderAttribute: "sortBy",customAttribute1: "descending",firstPage: 0,page: 0,pageSize: 50,sortField: "name",descending: !0,customParam1: "descending",hook_parse: null,total: null,initialize: function(e) {
            e && e.hook_parse && (this.hook_parse = e.hook_parse), e && e.custom_query_string_params && (this.custom_query_string_params = e.custom_query_string_params)
        },parse: function(e) {
            return this.totalPages = Math.ceil(e.total / this.pageSize), this.total = e.total, this.hook_parse != null && (e = this.hook_parse(e)), e.list
        },setParams: function(e) {
            typeof e.customParam1 != "undefined" && (this.customParam1 = e.customParam1, delete e.customParam1), typeof e.query != "undefined" && (this.query = e.query, delete e.query), typeof e.sortField != "undefined" && (this.sortField = e.sortField, delete e.sortField), _.extend(this.custom_query_string_params, e)
        },resetPagination: function() {
            this.totalPages = 0, this.page = 0, this.firstPage = 0, this.lastPage = 0, this.customParam1 = !1
        },goTo: function(e) {
            e !== undefined && (this.page = parseInt(e, 10), this.page > 0 && this.page--, this.pager())
        },pendingRequest: null,sync: function(t, n, r) {
            return e.Paginator.requestPager.prototype.sync.call(this, t, n, r)
        }})
}), define("modules/Trait/Collections/PaginatedTraits", ["backbone", "modules/Trait/Models/Trait", "modules/Common/Collections/PaginatedItems", "adobe", "globals"], function(e, t, n, r, i) {
    var s, o;
    return arguments.length == 0 ? (s = ADOBE.AM.pid, o = ADOBE.AM.API, e = Backbone, t = ADOBE.AM.Trait.Models.Trait, n = ADOBE.AM.Common.Collections.PaginatedItems) : (s = i.pid, o = r.AM.API), n.extend({custom_query_string_params: {},pendingRequest: {},model: t,sync: function(e, t, r) {
            var i = r.data || {};
            return _.extend(i, this.custom_query_string_params), r.data = i, r.url = this.url, this.pendingRequest && this.pendingRequest.readyState && this.pendingRequest.readyState != 4 && this.pendingRequest.abort(), this.pendingRequest = n.prototype.sync(e, t, r), this.pendingRequest
        },url: o.TRAITS.trait2.url()})
}), define("modules/Model/Models/History", ["backbone"], function(e) {
    return e == undefined && (e = Backbone), e.Model.extend({initialize: function(e) {
            this.set("timestamp", e)
        }})
}), define("modules/Model/Collections/ProcessingHistory", ["backbone", "modules/Model/Models/History", "adobe", "globals"], function(e, t, n, r) {
    var i, s;
    return arguments.length == 0 ? (i = ADOBE.AM.pid, e = Backbone, s = ADOBE.AM.API, t = ADOBE.AM.Model.Models.History) : (s = n.AM.API, i = r.pid), e.Collection.extend({model: t,makeUrl: function(e) {
            this.url = s.MODELS.processing_history(e)
        }})
}), define("modules/Segment/Models/Folder", ["backbone", "adobe", "globals"], function(e, t, n) {
    var r, i;
    return arguments.length == 0 ? (r = ADOBE.AM.pid, i = ADOBE.AM.API, e = Backbone) : (i = t.AM.API, r = n.pid), e.Model.extend({initialize: function() {
            this.set({id: this.get("folderId")})
        },url: function() {
            return i.FOLDERS.folder.url("segments", this.get("folderId"))
        }})
}), define("modules/Destination/Models/DataOrderTraits", ["backbone", "adobe"], function(e, t) {
    var n;
    return arguments.length == 0 ? (n = ADOBE.AM.API, e = Backbone) : n = t.AM.API, e.Model.extend({properties_to_filter: ["pid", "id"],intialize: function(e) {
            _.bindAll(this, "populateMapping"), this.set({id: this.destinationMappingId})
        },populateMapping: function(e) {
            var t = n.DESTINATION.destination.getMapping(e, this.toJSON());
            this.set({derivedMapping: t})
        },sync: function(t, n, r) {
            var i = {}, s = {};
            if (t === "update" || t === "create") {
                for (var o in this.attributes)
                    _.indexOf(this.properties_to_filter, o) == -1 && (i[o] = this.attributes[o]);
                s.data = JSON.stringify(i), _.isObject(r.data) && !_.isEmpty(r.data) && (_.extend(s.data, r.data), delete r.data), _.extend(s, r, {dataType: "json",contentType: "application/json"})
            } else
                s = r;
            return e.sync(t, n, s)
        }})
}), define("modules/Destination/Collections/DataOrderTraits", ["backbone", "modules/Destination/Models/DataOrderTraits"], function(e, t) {
    return e == undefined && (e = Backbone), t == undefined && (t = ADOBE.AM.Destination.Models.DataOrderTraits), e.Collection.extend({initialize: function() {
            _.bindAll(this, "populateMappings")
        },model: t,populateMappings: function(e) {
            for (var t = 0; t < this.length; t++) {
                var n = this.at(t);
                n.populateMapping(e)
            }
        }})
}), define("modules/Destination/Collections/Platforms", ["backbone", "adobe"], function(e, t) {
    return arguments.length == 0 && (t = ADOBE, e = Backbone), e.Collection.extend({url: function() {
            return t.AM.API.DESTINATION.availablePlatforms.url()
        },parse: function(e) {
            var t = [];
            if (Array.isArray(e))
                return t = e.sort(function(e, t) {
                    var n = e.toLowerCase(), r = t.toLowerCase();
                    return n > r ? 1 : n < r ? -1 : 0
                }), t.map(function(e) {
                    var t = e, n = e.charAt(0), r = n.toUpperCase();
                    return n === r && (t = r + e.slice(1).toLowerCase()), {type: e,name: t}
                });
            throw new Error("Bad data returned from API")
        }})
}), define("modules/Destination/Models/Destination", ["backbone", "modules/Destination/Collections/DataOrderTraits", "adobe", "modules/Destination/Collections/Platforms"], function(e, t, n, r) {
    return arguments.length == 0 && (n = ADOBE, e = Backbone, t = ADOBE.AM.Destination.Collections.DataOrderTraits, r = ADOBE.AM.Destination.Collections.Platforms), e.Model.extend({properties_to_filter: ["pid"],initialize: function() {
            _.bindAll(this, "populateTraits");
            var e = this.get("mappings");
            e && e.length > 0 && this.populateTraits(e)
        },populateTraits: function(e) {
            var n = new t(e);
            n.populateMappings(this.toJSON()), this.set({DataOrderTraits: n})
        },isBidManagerType: function() {
            var e = this.constructor;
            return this.get("destinationType") === e.TYPES.s2s && e.SPECIAL_TYPES.BID_MANAGER.isBidManager(parseInt(this.get("dataSourceId"), 10))
        },getPlatformName: function(e) {
            var t = this.constructor.PLATFORMS.where({type: e});
            return t.length ? t[0].get("name") : ""
        },getPlatforms: function() {
            return this.constructor.PLATFORMS
        },getDefaultAutoFillMapping: function() {
            return this.constructor.AUTOFILL_MAPPING.DEFAULT_CODE
        },isAutoFillCustomValue: function(e) {
            return e = e || this.get("mappingAutoFiller"), this.constructor.AUTOFILL_MAPPING.isCustomValue(e)
        },isAutoFillSegmentId: function(e) {
            return e = e || this.get("mappingAutoFiller"), this.constructor.AUTOFILL_MAPPING.isSegmentId(e)
        },isAutoFillIntegrationCode: function(e) {
            return e = e || this.get("mappingAutoFiller"), this.constructor.AUTOFILL_MAPPING.isIntegrationCode(e)
        },isAutoFillMappingEnabled: function(e) {
            return e = e || this.get("mappingAutoFiller"), this.constructor.AUTOFILL_MAPPING.isAutoFillMappingEnabled(e)
        },getTranslatedAutoFillMappingCodes: function() {
            return this.constructor.AUTOFILL_MAPPING.TRANSLATED
        },sync: function(t, n, r) {
            var i = {}, s = {};
            if (t === "update" || t === "create") {
                for (var o in this.attributes)
                    _.indexOf(this.properties_to_filter, o) == -1 && (i[o] = this.attributes[o]);
                s.data = JSON.stringify(i), _.isObject(r.data) && !_.isEmpty(r.data) && (_.extend(s.data, r.data), delete r.data), _.extend(s, r, {dataType: "json",contentType: "application/json"})
            } else
                s = r;
            return e.sync(t, n, s)
        }}, {SPECIAL_TYPES: {BID_MANAGER: {dpid: [771],isBidManager: function(e) {
                    return this.dpid.indexOf(parseInt(e, 10)) >= 0
                }}},TYPES: {s2s: "S2S"},AUTOFILL_MAPPING: {TRANSLATED: {IC: "Integration Code",SID: "Segment ID",NONE: "None"},CODES: {IC: "IC",NONE: "NONE",SID: "SID"},DEFAULT_CODE: "NONE",isCustomValue: function(e) {
                return e === this.CODES.NONE
            },isSegmentId: function(e) {
                return e === this.CODES.SID
            },isIntegrationCode: function(e) {
                return e === this.CODES.IC
            },isAutoFillMappingEnabled: function(e) {
                return this.isSegmentId(e) || this.isIntegrationCode(e)
            }},PLATFORMS: new r})
}), define("modules/Destination/Collections/Destinations", ["backbone", "modules/Destination/Models/Destination", "adobe", "globals"], function(e, t, n, r) {
    var i, s, o;
    return arguments.length == 0 ? (i = ADOBE.AM.pid, s = ADOBE.AM.API, e = Backbone, t = ADOBE.AM.Destination.Models.Destination, o = ADOBE.AM.UTILS) : (i = r.pid, s = n.AM.API, o = n.AM.UTILS), e.Collection.extend({model: t,url: s.DESTINATION.destination.url(),query_string_args: {},addQueryStringArgs: function(e) {
            _.extend(this.query_string_args, e)
        },hasSegment: function(e) {
            this.addQueryStringArgs({containsSegment: e})
        },sync: function(t, n, r) {
            var i = r.data || {};
            return _.extend(i, this.query_string_args), r.data = i, r.url = this.url, e.sync(t, n, r)
        }})
}), define("modules/Segment/Models/SegmentPermission", ["modules/Permission/Models/Permission"], function(e) {
    return e == undefined && (e = ADOBE.AM.Permission.Models.Permission), e.extend({name: "SegmentPermission"})
}), define("modules/Segment/Models/Segment", ["backbone", "modules/Segment/Models/Folder", "modules/DataSource/Models/DataSource", "modules/Destination/Collections/Destinations", "modules/Segment/Models/SegmentPermission", "adobe", "globals"], function(e, t, n, r, i, s, o) {
    var u, a;
    return arguments.length == 0 ? (e = Backbone, t = ADOBE.AM.Segment.Models.Folder, n = ADOBE.AM.DataSource.Models.DataSource, i = ADOBE.AM.Segment.Models.SegmentPermission, r = ADOBE.AM.Destination.Collections.Destinations, a = ADOBE.AM.API, u = ADOBE.AM.pid, adobe_am = ADOBE.AM) : (adobe_am = s.AM, u = o.pid, a = s.AM.API), e.Model.extend({valid_API_properties: ["dataSourceId", "sid", "description", "name", "startTime", "segmentRule", "folderId", "status", "integrationCode"],getActiveStatus: function() {
            return "ACTIVE"
        },getInactiveStatus: function() {
            return "INACTIVE"
        },defaults: {name: null},validate: function(e) {
            var t = [];
            (e.name == null || e.name === "") && t.push("Name cannot be empty");
            var n = parseInt(e.folderId, 10);
            return (!_.isNumber(n) || !(n >= 0)) && t.push("Folder cannot be empty"), this.errors = t, this.errors.length == 0 ? "" : t.join("\n")
        },initialize: function(e) {
            e.sid && this.set({sid: e.sid}), this.set({id: this.get("sid")}), this.relational = this.relational || {}, this.relational.folder = new t, this.relational.dataSource = new n, this.relational.destinations = new r, e && e.permissions && this.setSegmentPermissions(e.permissions)
        },canViewAllTraits: function() {
            var e = this.get("hiddenTraits");
            return typeof e == "undefined" ? !0 : e && e.length === 0
        },canMapAllTraits: function() {
            var e = this.get("mappableTraits"), t = this.get("traits");
            return typeof e == "undefined" ? !1 : e && t && e.length === t.length
        },resetModel: function() {
            this.clear({silent: !0}), this.set(this.defaults, {silent: !0})
        },url: function() {
            return a.SEGMENTS.segment.url(this.get("sid"))
        },setStatus: function(e) {
            var t = this;
            this.save({status: e}, {error: function(n, r, i) {
                    var s = {title: (e == "ACTIVE" ? "Play" : "Pause") + " Segment"};
                    t.set("status", "ACTIVE"), s.errorMsg = "Sorry, an error occured when trying to change status for segment: " + t.get("name") + ". Please try again.", s.msg = i, adobe_am.alertBox && adobe_am.alertBox(s)
                }})
        },getFolder: function(e) {
            var t = this;
            this.relational.folder.set({folderId: this.get("folderId")}), this.relational.folder.fetch({success: function(n, r) {
                    t.set({folderModel: n}), typeof e == "function" && e()
                }})
        },getDataSource: function(e) {
            var t = this;
            e || this.relational.dataSource.set({dataSourceId: t.get("dataSourceId")}), this.relational.dataSource.fetch({success: function(e, n) {
                    t.set({dataSourceModel: e})
                }})
        },getDestinations: function(t) {
            var n = this, r = this.get("destinationCollection");
            if (r instanceof e.Collection && !t)
                return r;
            var i = this.relational.destinations.fetch({data: {containsSegment: this.get("sid")}}).done(function(e) {
                n.set({destinationCollection: n.relational.destinations})
            }).fail(function() {
                n.set({destinationCollection: new e.Collection})
            });
            return i
        },getDataSourceModelProp: function(t) {
            var n = this.get("dataSourceModel");
            return !n || !n instanceof e.Model ? "" : n.get(t)
        },getFolderModelProp: function(t) {
            var n = this.get("folderModel");
            return !!n && n instanceof e.Model ? n.get(t) : !1
        },sync: function(t, n, r) {
            var i = {}, s = {};
            if (t === "update" || t === "create") {
                for (var o in this.attributes)
                    _.indexOf(this.valid_API_properties, o) >= 0 && (i[o] = this.attributes[o]);
                s.data = JSON.stringify(i), _.isObject(r.data) && !_.isEmpty(r.data) && (_.extend(s.data, r.data), delete r.data), _.extend(s, r, {dataType: "json",contentType: "application/json"})
            } else
                s = r;
            return e.sync(t, n, s)
        },parse: function(e) {
            var t = e.permissions;
            return t && _.isArray(t) && this.setSegmentPermissions(t), e
        },setSegmentPermissions: function(e) {
            var t = this.relational || {};
            t.permissions = new i({permissions: e})
        }}, {segmentTraitType: "SEGMENT",isRealizationTimeEmpty: function(e) {
            return parseInt(e, 10) === 0
        }})
}), define("modules/Model/Models/AlgoModel", ["backbone", "modules/Model/Models/ModelPermission", "modules/DataSource/Models/DataSource", "modules/Algorithm/Models/Algorithm", "modules/Model/Collections/RunStats", "modules/Trait/Collections/PaginatedTraits", "modules/Trait/Models/Trait", "modules/Model/Collections/ProcessingHistory", "modules/Segment/Models/Segment", "adobe", "globals"], function(e, t, n, r, i, s, o, u, a, f, l) {
    var c, h, p;
    return arguments.length == 0 ? (e = Backbone, n = ADOBE.AM.DataSource.Models.DataSource, r = ADOBE.AM.Algorithm.Models.Algorithm, i = ADOBE.AM.Model.Collections.RunStats, s = ADOBE.AM.Trait.Collections.PaginatedTraits, o = ADOBE.AM.Trait.Models.Trait, u = ADOBE.AM.Model.Collections.ProcessingHistory, a = ADOBE.AM.Segment.Models.Segment, t = ADOBE.AM.Model.Models.ModelPermission, h = ADOBE.AM.API, c = ADOBE.AM.pid, p = ADOBE.AM.UTILS) : (c = l.pid, h = f.AM.API, p = f.AM.UTILS), e.Model.extend({valid_API_properties: {put: ["name", "description", "status", "sid", "dataSources", "algoTypeId", "lookBackPeriod"],post: ["name", "description", "dataSources", "sid", "algoTypeId", "lookBackPeriod", "status"]},initialize: function(t) {
            t && t.algoModelId && this.set({id: t.algoModelId}), this.relational = {}, this.relational.dataSource = new n, this.relational.algorithm = new r, this.relational.run_stats = new i, this.relational.baseline = null;
            var o = s.extend({sort: function() {
                    e.Collection.prototype.sort.apply(this, arguments)
                }});
            this.relational.traits_using_model_name = new o({custom_query_string_params: {usesModel: null,page: 0,pageSize: 10,restrictType: "ALGO_TRAIT"},pendingRequest: {}});
            var a = s;
            this.relational.influential_traits = new a({custom_query_string_params: {},pendingRequest: {}}), this.relational.processing_history = new u, t && t.permissions && this.setModelPermissions(t.permissions)
        },loadRunStats: function() {
            return this.relational.run_stats.makeUrl(this.get("id")), this.relational.run_stats.fetch()
        },loadModelHistory: function() {
            return this.relational.processing_history.makeUrl(this.get("id")), this.relational.processing_history.fetch()
        },loadAlgorithm: function(e) {
            var t = this.get("algoTypeId");
            return e != undefined && (t = e), this.relational.algorithm.set({id: t}), this.relational.algorithm.fetch()
        },loadTraitsUsingModelName: function() {
            return this.relational.traits_using_model_name.setParams({usesModel: this.get("algoModelId")}), this.relational.traits_using_model_name.fetch()
        },loadInfluentialTraits: function(e) {
            return this.relational.influential_traits.url = h.MODELS.influential_traits.url(this.get("id")), this.relational.influential_traits.resetPagination(), this.relational.influential_traits.setParams(e), this.relational.influential_traits.pager()
        },loadBaseline: function(e) {
            var t = p.HELPERS.isTrait(e);
            return t ? this.relational.baseline = new o({sid: this.get("sid")}) : this.relational.baseline = new a({sid: this.get("sid")}), this.relational.baseline.fetch({data: {includeMetrics: !0}})
        },getRunStats: function() {
            return this.relational.run_stats
        },runStatsAreValid: function() {
            return this.relational.run_stats.length > 1
        },getModelHistory: function() {
            return this.relational.processing_history
        },getAlgorithm: function() {
            return this.relational.algorithm
        },getInfluentialTraits: function() {
            return this.relational.influential_traits
        },getTraitsUsingModelName: function() {
            return this.relational.traits_using_model_name
        },getRelationalData: function() {
            var e = {};
            return _.each(this.relational, function(t, n) {
                var r = {};
                r[n] = t.toJSON(), _.extend(e, r)
            }), e
        },setStatus: function(e) {
            return this.save({status: e})
        },wasLastRunSuccessfulWithData: function() {
            return !!this.get("lastSuccessfulRunTimestamp") && this.get("lastRunStatus") == this.constructor.processing_status.RUN_WITH_DATA
        },hasBeenRunSuccessfullyOnce: function() {
            return !!this.get("lastSuccessfulRunTimestamp")
        },didLastRunHaveNoData: function() {
            return this.get("lastRunStatus") == this.constructor.processing_status.RUN_WITH_NO_DATA
        },setModelPermissions: function(e) {
            var n = this.relational || {};
            n.permissions = new t({permissions: e})
        },urlRoot: h.MODELS.algo_model.url(),methodURL: {read: function() {
                var e = this.isNew() ? "" : this.get("id") + "?returnbaselinetraittype=true&includePermissions=true";
                return this.urlRoot + e
            },create: function() {
                return this.urlRoot
            },update: function() {
                return this.urlRoot + this.get("id") + "?includePermissions=true"
            },"delete": function() {
                return this.urlRoot + this.get("id")
            }},parse: function(e) {
            var t = e.permissions;
            return t && _.isArray(t) && this.setModelPermissions(t), e
        },sync: function(t, n, r) {
            var i = null, s = {}, o = {}, u = n.urlRoot;
            r = r || {}, i = n.methodURL[t.toLowerCase()], typeof i == "function" && (u = i.call(n)), r.url = u;
            if (t === "update" || t === "create") {
                for (var a in this.attributes)
                    _.indexOf(this.valid_API_properties.put, a) >= 0 && (s[a] = this.attributes[a]);
                o.data = JSON.stringify(s), _.isObject(r.data) && !_.isEmpty(r.data) && (_.extend(o.data, r.data), delete r.data), _.extend(o, r, {dataType: "json",contentType: "application/json"})
            } else
                o = r;
            return e.sync(t, n, o)
        },validate: p.MODELS.validators.validateData}, {getActiveStatus: function() {
            return "ACTIVE"
        },getInactiveStatus: function() {
            return "INACTIVE"
        },getStatusName: function(e) {
            return e == "ACTIVE" ? "Active" : "Inactive"
        },processing_status: {RUN_FAILED: 0,RUN_WITH_DATA: 1,RUN_WITH_NO_DATA: 2}})
}), define("modules/Trait/Models/AlgoTrait", ["modules/Trait/Models/Trait", "modules/Model/Models/AlgoModel"], function(e, t) {
    return arguments.length == 0 && (e = ADOBE.AM.Trait.Models.Trait, t = ADOBE.AM.Model.Models.AlgoModel), e.extend({loadAlgoModel: function() {
            if (t === null)
                throw Error("Trait model must have AlgoModelClass static variable defined");
            return this.relational.model = new t({id: this.get("algoModelId")}), this.relational.model.fetch()
        },getAlgoModel: function() {
            return this.relational.model
        }})
}), define("modules/Segment/Collections/Segments", ["backbone", "adobe", "modules/Segment/Models/Segment"], function(e, t, n) {
    var r;
    return arguments.length == 0 ? (e = Backbone, r = ADOBE.AM.API, n = ADOBE.AM.Segment.Models.Segment) : r = t.AM.API, e.Collection.extend({query_string_params: {},model: n,url: r.SEGMENTS.search.url(),sync: function(t, n, r) {
            var i = r.data || {};
            return _.extend(i, this.query_string_params), r.data = i, r.url = this.url, e.sync(t, n, r)
        }})
}), function(e, t) {
    e.templateSettings = {interpolate: /\<\@\=(.+?)\@\>/gim,evaluate: /\<\@(.+?)\@\>/gim}, t.templates.makeTemplate = function(e, t) {
        var n = null;
        if (e instanceof Array) {
            var r = this[e[0]];
            for (var i = 1; i < e.length; i++)
                r = r[e[i]];
            n = r
        } else
            n = this[e];
        for (var s in t)
            t.hasOwnProperty(s) && (n = n.replace(s, t[s]));
        return n
    }, t.templates.getLocalizedMessage = function(e) {
        return ADOBE.AM.MESSAGES.getMessage(e).message
    }, t.templates.graph_no_data = '<div class="noDataMsg"><p>' + t.templates.getLocalizedMessage("model_has_no_data") + "</p></div>", t.templates.graph_not_run = '<div class="noDataMsg"><p>' + t.templates.getLocalizedMessage("model_has_not_run") + "</p></div>", t.templates.graph_reach_exceeded = '<div class="noDataMsg"><p>' + t.templates.getLocalizedMessage("no_valid_model_run_values") + "</p></div>", t.templates.list_page_toolbar = '<ul class="toolbar">%%CREATE_BUTTON_LI%%%%ADD_TO_DESTINATION%%%%CREATE_MODEL_WITH_SELECTED_LI%%%%DELETE_BUTTON_LI%%</ul>', t.templates.list_page_toolbar_create_button = '<li data-type="newSegment"><img class="icon" src="/css/aam/images/Add_Standard.png">Create New Segment</li>', t.templates.list_page_toolbar_edit_button = '<li data-type="editSegment"><img class="icon" src="/css/aam/images/Add_Standard.png">Edit Segment</li>', t.templates.toolbar_delete_selected_button = '<li data-type="deleteSelected"><img class="icon" src="/css/aam/images/AlertDeactivate_Standard.png">Delete Selected</li>', t.templates.toolbar_delete_button = '<li data-type="deleteSegment"><img class="icon" src="/css/aam/images/ClearXGrey_Buttcon.png">Delete</li>', t.templates.toolbar_clone_button = '<li data-type="cloneSegment"><img class="icon" src="/css/aam/images/Clone_Standard.png" />Clone</li>', t.templates.toolbar_create_model_with_selected = '<li data-type="createModelWithSelected"><img class="icon" src="/css/aam/images/Add_Standard.png">Create Model with Selected</li>', t.templates.can_show_segment_to_destination_in_sb_toolbar_buttons = '<li data-type="addToDestination"><img class="icon" src="/css/aam/images/Add_Standard.png">Add Selected To Destination</li>', t.templates.view_page_toolbar = '<ul class="toolbar">%%CREATE_BUTTON_LI%%%%EDIT_BUTTON_LI%%%%CLONE_BUTTON_LI%%%%DELETE_BUTTON_LI%%</ul>', t.templates.segment_result_item = '<td><span class="result_checkbox"><@ if (typeof checked == "undefined" || checked == false) { @><img src="/css/aam/images/checkbox_unchecked.png" class="result_checkbox_disabled" /><@ } else { @><img src="/css/aam/images/checkbox_checked.png" class="result_checkbox_enabled" /><@ } @></span></td><td><@= sid @></td><td><a href="#view/<@= sid @>"><@= name @></a></td><td class="description"><span title="<@= description @>"><@= description @></span></td><td><@ if (status == "ACTIVE") { @>Active<@ } else { @><span class="gray_text">Inactive</span><@ } @></td><td><@ if (permissions.edit) { @><a href="#edit/<@= sid @>"><img class="edit btn_action" src="/css/aam/images/Edit_Standard.png" alt="Edit" title="Edit" /></a><@ if (status == "ACTIVE") { @><img class="pause btn_action" src="/css/aam/images/Pause_Standard.png" alt="Pause" title="Pause" /><@ } else { @><img class="play btn_action" src="%%IMG_PLAY_STANDARD%%" alt="Play" title="Play" /><@ } @><@ } @><@ if (permissions.clone) { @><img class="clone btn_action" src="%%IMG_CLONE_STANDARD%%" alt="Clone" title="Clone" /><@ } @><@ if (permissions._delete) { @><img class="delete btn_action" alt="Delete" title="Delete" src="/css/aam/images/ClearXGrey_Buttcon.png" /><@ } @></td>', t.templates.server_pagination = '<div class="breadcrumb"><span class="cell">View<select class="serverhowmany"><option value="10" <@ if (pageSize == 10) { @>selected<@ } @>>10</option><option value="25" <@ if (pageSize == 25) { @>selected<@ } @>>25</option><option value="50" <@ if (pageSize == 50) { @>selected<@ } @>>50</option></select>/ page&nbsp;&nbsp;</span><span class="cell"><@ if (page > firstPage) { @><a href="#" class="serverprevious"><button style="min-width:28px;width:28px;">&#9668;</button>&nbsp;&nbsp;</a><@ }else{ @><button style="min-width:28px;width:28px;" class="disabled">&#9668;</button><@ } @>&nbsp;&nbsp;<span><select name="pagination_pages" class="pagination_pages"><@ if (page == 0) { page = 1;  @><@ } else if (page > 0) { page++; } @><@ for(p = 1; p <= totalPages; p++){ @><option value="<@= p @>" class="page <@ if (page == p) { @>selected <@ } @>" <@ if (page == p) { @>selected<@ } @>><@= p @></option><@ } @></select><span class="divider">&nbsp;/&nbsp;</span><@= typeof totalPages != "undefined" ? totalPages : 0 @>&nbsp;&nbsp;</span><@ if (page < totalPages) { @><a href="#" class="servernext"><button style="min-width:28px;width:28px;">&#9658;</button></a><@ } else { @><button style="min-width:28px;width:28px;" class="disabled">&#9658;</button><@ } @></span></div>', t.templates.view_page_basic_info = '<h3>Basic Information</h3><table><tbody><tr><td class="label">Segment ID:</td><td><@= sid @></td></tr><tr><td class="label">Legacy ID:</td><td><@= legacyId @></td></tr><tr><td class="label">Name:</td><td><@= name @></td></tr><tr><td class="label">Description:</td><td><@= description @></td></tr><tr><td class="label">Integration Code:</td><td><@= integrationCode @></td></tr><tr><td class="label">Data Source:</td><td><@= dataSourceName @></td></tr><tr><td class="label">Stored In:</td><td><@= path @></td></tr><tr><td class="label">Status:</td><td><@ if (status == "ACTIVE") { @>Active<@ } else { @>Inactive<@ } @></td></tr><tr><td class="label">Real-time Segment Population:</td><td>7 Days: <@= instantUniques7Day @><br />30 Days: <@= instantUniques30Day @><br />60 Days: <@= instantUniques60Day @></td></tr><tr><td class="label">Total Segment Population:</td><td>7 Days: <@= totalUniques7Day @><br />30 Days: <@= totalUniques30Day @><br />60 Days: <@= totalUniques60Day @></td></tr></tbody></table><div class="clear"></div>', t.templates.edit_page_basic_info = '<div id="sebiBox" class="left basicInfo"><form><table class="infoTable"><tbody><tr class="sb_edit_basic_info_sid"><td class="label" data-type="basic_info_sid">Segment ID:</td><td><@= the_sid @></td></tr><tr class="sb_edit_basic_info_csegid"><td class="label" data-type="basic_info_csegid">Legacy ID:</td><td><@= the_csegid @></td></tr><tr><td class="label">Name:</td><td><input type="text" size="30" name="name" value="<@= name || "" @>" /></td></tr><tr><td class="label">Description:</td><td><input type="text" size="30" name="description" value="<@= the_description @>" /></td></tr><tr><td class="label">Integration Code:</td><td><input type="text" size="30" name="integrationCode" value="<@= integrationCode @>" /></td></tr><tr><td class="label">Data Source:</td><td class="segment_datasources"><@= dataSourceName @></td></tr><tr><td class="label">Status:</td><td><select name="status"><option value="ACTIVE" <@ if (status == "ACTIVE") { @>selected="selected"<@ } @>>Active</option><option value="INACTIVE" <@ if (status == "INACTIVE") { @>selected="selected"<@ } @>>Inactive</option></select></td></tr><tr><td></td></tr></tbody></table></form><div class="clear"></div></div>', t.templates.edit_page_datasources = '<select name="dataSourceId"><@ _.each(datasources, function(ds) { @><option value="<@= ds.get("dataSourceId") @>" <@ if (ds.get("dataSourceId") == model_dataProviderId) { @>selected="selected" <@ } @>><@= ds.get("name") @> (DPID: <@= ds.get("dataSourceId") @>)</option><@ }) @></select>', t.templates.historic_segment_size = '<div class="AUI_content_white" id="historic_segment_size">	<div class="panel_title">Estimated Historic Segment Size <span class="context-help" title="Help" data-id="r_segment_data.html">&nbsp;</span></div>	<div class="panel_content">     <div class="days_7">Last 7 Days: <span class="day_number_7">-</span></div>     <div class="days_30">Last 30 Days: <span class="day_number_30">-</span></div>     <div class="days_60">Last 60 Days: <span class="day_number_60">-</span></div>		<div class="recalculate_size"><button type="button" class="secondary">Recalculate Size</button></div>	</div></div>', t.templates.instant_segment_size = '<div class="AUI_content_white">	<div class="panel_title">Real-time Segment Population <span class="context-help" title="Help" data-id="r_segment_data.html">&nbsp;</span></div>	<div class="panel_content">     <div>Last 7 Days: <span class="7day_number"><@= instantUniques7Day @></span></div>     <div>Last 30 Days: <span class="30day_number"><@= instantUniques30Day @></span></div>     <div>Last 60 Days: <span class="60day_number"><@= instantUniques60Day @></span></div>	</div></div>', t.templates.realized_segment_size = '<div class="AUI_content_white">	<div class="panel_title">Total Segment Population <span class="context-help" title="Help" data-id="r_segment_data.html">&nbsp;</span></div>	<div class="panel_content">     <div>Last 7 Days: <span class="7day_number"><@= totalUniques7Day @></span></div>     <div>Last 30 Days: <span class="30day_number"><@= totalUniques30Day @></span></div>     <div>Last 60 Days: <span class="60day_number"><@= totalUniques60Day @></span></div>	</div></div>', t.templates.viewpage_destination_table_row = '<td><@= destination_id @></td><td><a href="' + t.state.vars.manage_destination_path + '?destinationId=<@= destination_id @>#view"><@= destination_name @></a></td><td><@= destination_type @></td><td><@= ADOBE.AM.UTILS.HELPERS.decorateWithSpanAndSlice(derivedMapping) @></td>', t.templates.destination_table_editable_row = '<td><@= destination_id @></td><td><@= destination_name @></td><td><@= destination_type @></td><td><@= ADOBE.AM.UTILS.HELPERS.decorateWithSpanAndSlice(derivedMapping) @></td><td><@= startDate ? startDate : "" @></td><td><@= endDate ? endDate : "" @></td><td class="actions"><a class="edit" rel="<@= destinationId @>,<@= destinationMappingId @>"><img class="icon" src="https://www.omniture-static.com/aui/1.0.1/images/icons/12x12/Edit_Standard.png"></a> <a class="remove" rel="<@= destinationId @>,<@= destinationMappingId @>"><img class="icon" src="/css/aam/images/ClearXGrey_Buttcon.png"></a></td>', t.templates.viewpage_destination_message = "%%MESSAGE%%", t.templates.browse_traits_modal = '<div id="browse_traits_modal"><div class="layout-2-col " style="width:1000px;height:550px;"><div class="sidebar col1 panels trait_storage"><div class="trait_search"></div><h4>Traits Storage</h4><div id="traits_folder_tree""></div></div><div class="col2"><div class="panels traits_list"><form id="form_traits"><table class="table bb-table-widget traits_table" id="traits_table" width="100%"><thead><tr><th class="column_checkbox disabled column_radio"><img src="/css/aam/images/checkbox_unchecked.png" class="AUI_Menu_icon result_checkbox_disabled" /><img src="/css/aam/images/checkbox_checked.png" class="AUI_Menu_icon result_checkbox_enabled" /></th><th class="sortable" data-sortby="sid">Trait ID</th><th class="sortable" data-sortby="name">Name</th><th class="sortable" data-sortby="traitType">Type</th><th class="sortable" data-sortby="dataSourceId">Data Source</th><th class="sortable" data-sortby="uniques7Day">7-Day Uniques</th><th class="sortable" data-sortby="uniques30Day">30-Uniques</th><th class="sortable" data-sortby="uniques60Day">60-Day Uniques</th></tr></thead><tbody id="traits_table_tbody"></tbody></table></form><div id="traits_pagination" class="pagination"></div></div></div></div></div>', t.templates.browse_segments_modal = '<div id="browse_segments_modal"><div class="layout-2-col " style="width:1000px;height:550px;"><div class="col1 panels segment_storage"><h4>Segments Storage</h4><div class="segment_search"></div><div id="segment_folder_tree""></div></div><div class="col2"><div class="panels segments_list"><form id="form_segments"><table class="table bb-table-widget" id="segments_table" width="100%"><thead><tr><th class="column_checkbox disabled"></th><th class="sortable" data-sortby="sid">Segment ID</th><th class="sortable" data-sortby="name">Name</th><th class="sortable" data-sortby="description">Description</th><th class="sortable" data-sortby="status">Status</th></tr></thead><tbody id="segments_table_tbody"></tbody></table></form><div id="segments_pagination" class="pagination"></div></div></div></div></div>', t.templates.browse_destinations_modal = '<div id="browse_destinations_modal"><div class="layout-2-col " style="width:1000px;height:550px;"><div class="col1 panels destinations_storage"><h4>Destinations Search</h4><div class="destination_search"></div></div><div class="col2" style="float: left; margin-left: 10px;"><div class="panels destinations_list" style="h overflow: auto;"><table class="table bb-table-widget browse_destinations_table" style="width: 756px;"><thead><tr><th></th><th class="sortable" data-type="destinationId">Destination ID</th><th class="sortable" data-type="name">Name</th><th class="sortable" data-type="description">Description</th><th class="sortable" data-type="destinationType">Type</th></tr></thead><tbody id="traits_table_tbody"></tbody></table></div></div><div class="clear"></div></div></div>', t.templates.browse_models_modal = '<div id="browse_models_modal"><div class="layout-2-col " style="width:1000px;height:550px;"><div class="col1 panels models_search"><h4>Models Search</h4></div><div class="col2" style="float: left; margin-left: 10px;"><div class="panels models_list" style="overflow: auto;"><form id="form_models"><table class="table bb-table-widget browse_models_table" id="models_table" style="width: 756px;"><thead><tr><th></th><th class="sortable" data-sortby="algoModelId">ID</th><th class="sortable" data-sortby="name">Name</th><th class="sortable" data-sortby="description">Description</th><th class="sortable" data-sortby="algorithm">Algorithm</th><th class="sortable" data-sortby="status">Status</th><th class="sortable" data-sortby="lookback">Look Back</th><th class="sortable" data-sortby="lastSuccessfulRunTimestamp">Last Successful Run</th></tr></thead><tbody id="models_table_tbody"></tbody></table></form></div></div><div class="clear"></div></div></div>', t.templates.model_table_row = '<td><span class="radio"><input type="radio" name="selected_model" value="<@= t.get("algoModelId") @>" /></span></td><td><@= t.get("algoModelId") @></td><td><@= t.get("name") @></td><td><@= t.get("description") @></td><td><@= displayAlgorithm(t.get("algoTypeId")) @></td><td><@= displayStatus(t.get("status")) @></td><td><@= t.get("lookBackPeriod") @></td><td><@= formatTimestamp(t.get("lastSuccessfulRunTimestamp")) @></td>', t.templates.trait_table_row = '<td><@ if (document.getElementsByTagName("body")[0].getAttribute("class").indexOf("Models") > -1) { @><span class="radio"><input type="radio" name="selected_trait" value="<@= t.get("sid") @>" /></span><@ } else { @><span class="result_checkbox"><@ if (t.get("checked") == true) { @><img src="/css/aam/images/checkbox_checked.png" class="result_checkbox_disabled" /><@ } else { @><img src="/css/aam/images/checkbox_unchecked.png" class="result_checkbox_enabled" /><@ } @></span><@ } @></td><td><@= t.get("sid") @></td><td><@= t.get("name") @></td><td><@= getTraitTypeName(t.get("traitType")) || "" @></td><td><@= (dataSourceName + "(" + t.get("dataSourceId") + ")") || "" @></td><td class="days_7"><@= ADOBE.AM.UTILS.HELPERS.formatNumber(t.get("uniques7Day")) @></td><td class="days_30"><@= ADOBE.AM.UTILS.HELPERS.formatNumber(t.get("uniques30Day")) @></td><td class="days_60"><@= ADOBE.AM.UTILS.HELPERS.formatNumber(t.get("uniques60Day")) @></td>', t.templates.segment_table_row = '<td><span class="radio"><input type="radio" name="selected_trait" value="<@= t.get("sid") @>" /></span></td><td><@= t.get("sid") @></td><td><@= t.get("name") @></td><td><@= t.get("description") @></td><td><@ if (t.get("status") == "ACTIVE") { @>Active<@ } else { @><span class="gray_text">Inactive</span><@ } @></td>', t.templates.destination_table_row = '<td><input id="order_<@= t.get("destinationId") @>" name="addDestRadio" type="radio" /></td><td><@= t.get("destinationId") @></td><td><@= t.get("name") @></td><td><@= t.get("description") || "" @></td><td><@ switch (t.get("destinationType")) { case "PUSH": @>URL<@ break; case "S2S": @>Server-to-Server<@ break; case "ADS": @>Cookie<@ break; default: @><@= t.get("destinationType") || "" @><@ break; } @></td>', t.templates.segment_builder_widget = {}, t.templates.segment_builder_widget.elements = {}, t.templates.segment_builder_widget.elements.op = '<tr class="ruleOp <@= op_wrapper_class @>"><td class="first"></td><td colspan="3" class="middle"><select class="ruleOpSelect"><option <@= selected == false ? "selected=selected" : "" @>></option><option <@= selected == "AND" ? "selected=selected" : "" @>>AND</option><option <@= selected == "OR" ? "selected=selected" : "" @>>OR</option><option <@= selected == "AND NOT" ? "selected=selected" : "" @>>AND NOT</option></select><span><@= selected @></span></td><td class="last"></td></tr>', t.templates.segment_builder_widget.elements.rule_wrapper = '<div class="rule_wrapper"><div class="rule_content" style="position:relative;float:left"><@= content @></div>' + t.templates.segment_builder_widget.elements.solr + '<br class="clear" />' + "</div>", t.templates.segment_builder_widget.elements.rule = '<tr data-sid="<@= sid @>" class="<@= sid @>_rule_sid traitRule <@ if (rowspan) { @>rf<@ } @>"><td class="first"><img style="display:block;margin: 4px 0 0 10px;" class="mover" src="https://www.omniture-static.com/aui/1.0.2/images/ui/Tables/grabber.png" /></td><td class="trait"><p class="trait_name table_cell"><a title="<@= name@>"><@= name @></a></p></td><td class="days_30"><p class="table_cell table_uniques">Last 30 Days: <span class="day_number_30"><@= uniques @></span></p></td><td class="actions"><img src="/css/aam/images/ClearXGrey_Buttcon.png" alt="Delete" class="delete_icon" /></td><td class="last" width="10"></td><@ if (rowspan) { @><@= rf_html @><@ } @></tr>', t.templates.segment_builder_widget.elements.rf_cell = '<td class="rf_cell <@ if (typeof state != "undefined") {@><@= state @><@ } else {@>off<@}@>" rowspan="<@= rowspan @>"><img class="rf_off" src="' + t.state.vars.images.rf_off + '" />' + '<img class="rf_on" src="' + t.state.vars.images.rf_on + '" />' + '<img class="rf_clicked" src="' + t.state.vars.images.rf_clicked + '" />' + '<div class="solr_wrapper"><span class="days_30">Last 30 Days:  </span><span class="solr_number">-</span></div>' + '<div style="position:relative"><div class="rf_popup">' + '<p class="rf_title">Recency and Frequency<span class="context-help" title="Help" data-id="c_recency_frequency.html">&nbsp;</span></p>' + '<select class="frequency_ops">' + '<option value="<=" <@= frequency_ops == "<=" ? "selected=selected" : "" @>><=</option>' + '<option value="==" <@= frequency_ops == "==" ? "selected=selected" : "" @>>==</option>' + '<option value=">=" <@= frequency_ops == ">=" ? "selected=selected" : "" @>>>=</option>' + "</select>" + '<span class="frequency_ops"><@= frequency_ops @></span>' + '<input type="text" size="2" value="<@= frequency_val @>" class="frequency_val" />' + '<span class="frequency_val"><@= frequency_val @></span>' + "<span> times in</span>" + '<div class="rf_design">' + '<div class="left line"></div>' + '<p class="left">/</p>' + '<div class="right line"></div>' + '<br class="clear" />' + "</div>" + '<select class="recency_ops">' + '<option value="<=" <@= recency_ops == "<=" ? "selected=selected" : "" @>><=</option>' + '<option value=">=" <@= recency_ops == ">=" ? "selected=selected" : "" @>>>=</option>' + "</select>" + '<span class="recency_ops"><@= recency_ops @></span>' + '<input type="text" size="2" value="<@= recency_val @>" class="recency_val" />' + '<span class="recency_val"><@= recency_val @></span>' + "<span> days ago</span>" + '<br class="clear" />' + '<button type="button" class="primary">Clear</button>' + "</div></div>" + "</td>", t.templates.rules_with_top_bottom = '<tr class="groupTop ruleBorder"><td class="first"></td><td colspan="3"></td><td class="last"></td></tr><@= html @><tr class="groupBtm ruleBorder"><td class="first"></td><td colspan="3"></td><td class="last"></td></tr>', t.templates.segment_builder_widget.segment_traits_tab = '<div class="st_top"><div class="ruleDisplay"><table class="groupTable"><tbody></tbody></table></div></div><div class="st_bottom"><div class="panel_title">Add a Trait</div><div class="panel_title">Search by Trait</div><div><input id="trait_autocomplete" type="text" value="" size="40" /><img class="autocomplete_loading" src="/css/aam/images/16x16/Loading_Animated.gif" />&nbsp;<button type="button" class="primary" id="trait_add">Add Trait</button><button type="button" class="primary" id="trait_browse">Browse All Traits</button></div></div>', t.templates.segment_builder_widget.segment_expression_tab = '<div class="segment_expression"><textarea id="segment_expression" cols="120" rows="10"></textarea><p style="line-height:28px"><button type="button" class="primary validate_expression">Validate Expression</button><button type="button" class="reset_and_return">Reset and Return to Basic View</button>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;<a class="see_all_traits">Click to see all traits</a></p><div class="list_traits_in_segment"></div></div>', t.templates.segment_builder_widget.trait_modal = '<div class="trait_modal"><h4>Basic Information</h4><table><tr><td class="label">Trait ID</td><td><@= t.get("sid") @></td></tr><tr><td class="label">Name</td><td><@= t.get("name") @></td></tr><td class="label">Description</td><td><@= t.get("description") @></td></tr><tr><td class="label">Type</td><td><@= type @></td></tr><td class="label">Data Source</td><td><@= datasource @></td></tr><tr><td class="label">Trait Rule</td><td><@= t.get("traitRule") || "" @></td></tr><tr><td class="label">Integration Code</td><td><@= t.get("integrationCode") || "" @></td></tr><td class="label">Stored In</td><td><@= folder @></td></tr><tr><td class="label">Data Category</td><td><@= category @></td></tr><td class="label days_7">7-Day Uniques</td><td><@ if (isNaN(t.get("uniques7Day"))) {@>&mdash;<@} else {@><@= ADOBE.AM.UTILS.HELPERS.formatNumber(t.get("uniques7Day")) @><@} @></td></tr><tr><td class="label days_30">30-Day Uniques</td><td><@ if (isNaN(t.get("uniques30Day"))) {@>&mdash;<@} else {@><@= ADOBE.AM.UTILS.HELPERS.formatNumber(t.get("uniques30Day")) @><@} @></td></tr><tr><td class="label days_60">60-Day Uniques</td><td><@ if (isNaN(t.get("uniques60Day"))) {@>&mdash;<@} else {@><@= ADOBE.AM.UTILS.HELPERS.formatNumber(t.get("uniques60Day")) @><@} @></td></tr><tr class="last-child"><td class="label">Comments</td><td><@= t.get("comments") || "" @></td></tr></table></div>', t.templates.model_builder = {}, t.templates.model_builder.page = {}, t.templates.model_builder.basic_info_accordion = '<div class="input_holder"><label for="name">Name:</label><input type="text" name="name" value="<@= name @>" /></div><div class="input_holder"><label for="description">Description:</label><input type="text" name="description" value="<@ try { @><@= description @><@ } catch(err) {} @>" /></div><div class="input_holder"><label for="status">Status:</label><select name="status"><option value="ACTIVE" <@= isSelected("ACTIVE") @>>Active</option><option value="INACTIVE" <@= isSelected("INACTIVE") @>>Inactive</option></select></div><input type="hidden" name="dataSources" value="<@ try { @><@= dataSources @><@ } catch(err) {} @>" />', t.templates.model_builder.configuration_accordion = '<div class="trait_or_segment section"></div><div class="lookback_and_algorithms section"></div><div class="layout-helper"><div class="layout-helper-sub"><div class="datasources section"></div></div></div>', t.templates.model_builder.page.create_edit = '<div class="page_title">Model Builder</div><br style="clear:both" /><div id="basic_info_accordion"></div><div id="configuration_accordion"></div><div class="action_btns"><button class="save primary">Save</button><button class="cancel">Cancel</button></div>', t.templates.model_builder.page.trait_or_segment = '<input type="hidden" value="<@ try { @><@= sid @><@ } catch(err) {} @>" name="sid" /><h1>Select a Baseline Trait or Segment</h1><div class="btns"><@ if (can_show_view_traits()) { @><button type="button" class="primary task" id="browse_all_traits">Browse All Traits</button><@ } @><@ if (can_show_view_segments()) { @><button type="button" class="primary task" id="browse_all_segments">Browse All Segments</button><@ } @></div><div id="traitsegment_wrapper"><div class="traitsegment_inner"><hr /><div class="basic_info"><h2 class="trait_basic_info">Baseline Trait Information</h2><h2 class="segment_basic_info">Baseline Segment Information</h2><dl><dt>Name:</dt><dd><@= name @></dd><dt>Description:</dt><dd><@ try { @><@= description @><@ } catch(err) {} @></dd><dt>Stored In:</dt><dd><@ try { @><@= c_folderPath @><@ } catch(err) {} @></dd><dt class="segment_status">Status:</dt><dd><@ if (status == "ACTIVE") { @>Active<@ } else { @><span class="gray_text">Inactive</span><@ } @></dd></dl></div><div class="graph"><h2 class="segment_graph">Segment Graph</h2><h2 class="trait_graph">Trait Graph</h2><div id="graph_container"><div id="cloudVizChart"></div></div></div></div></div>', t.templates.model_builder.page.lookback_algorithms_create = '<div id="lookback"><h1>Select Look Back Period</h1><p>Look back period of <select name="lookBackPeriod"><option value="30">30</option><option value="60">60</option><option value="90">90</option></select> days.</p></div><div id="algorithms"><h1>Select Algorithm</h1></div>', t.templates.model_builder.page.lookback_algorithms_readonly = '<div id="lookback"><h1>Selected Look Back Period:</h1><p>Look back period of <@= lookBackPeriod @> days.</p></div><div id="algorithms"><h1>Selected Algorithm:</h1><p> <@= getAlgorithmName(algoTypeId) @> </p></div>', t.templates.model_builder.page.algorithm_row = '<div class="radiobtn"><input type="radio" name="algoTypeId" value="<@= algoTypeId @>" /></div><div class="name"><@= name @></div>', t.templates.model_builder.page.datasources_create = '<h1>Select Available Data</h1><div id="datasources_container"><table class="table"><thead><tr><th width="4%" class="checkbox"><div><input type="checkbox" /></div></th><th width="10%" class="sortable" data-sortby="dataSourceId">DPID</th><th width="58%" class="sortable" data-sortby="name">Name</th><th width="28%" class="sortable" data-sortby="first_third">First/Third Party Data</th></tr></thead><tbody></tbody></table></div>', t.templates.model_builder.page.datasource_create_row = '<td class="checkbox"><div><input type="checkbox" value="<@= dataSourceId @>" /></div></td><td><@= dataSourceId @></td><td><@= name @></td><td><@= isFirstParty(pid) ? "First Party" : "Third Party" @></td>', t.templates.model_builder.page.datasources_readonly = '<h1>Selected Data</h1><div id="datasources_container"><table class="table"><thead><tr><th width="10%" class="sortable" data-sortby="dataSourceId">DPID</th><th width="63%" class="sortable" data-sortby="name">Name</th><th width="27%" class="sortable">First/Third Party Data</th></tr></thead><tbody></tbody></table></div>', t.templates.model_builder.page.datasource_readonly_row = '<td><@= dataSourceId @></td><td><@= name @></td><td><@= isFirstParty(pid) ? "First Party" : "Third Party" @></td>', t.templates.model_builder.page.process_freq = '<h1>Select Look Back Period</h1><p>Process model every <select name="intervalSeconds"><option value="2592000">30</option><option value="5184000">60</option><option value="7776000">90</option></select> days.', t.templates.model_builder.page.view_page = '<div id="ModelView"><div class="top_toolbar"><ul class="toolbar"><@ if (can_show_create_button()) {@><li class="new_model"><img class="icon" src="/css/aam/images/Add_Standard.png">Create New Model</li><@ } @><@ if (can_show_edit_button()) {@><li class="edit_model"><img class="icon" src="/css/aam/images/Edit_Standard.png">Edit</li><@ } @><@ if (can_show_clone_button()) {@><li class="clone_model"><img class="icon" src="%%IMG_CLONE_STANDARD%%">Clone</li><@ } @><@ if (show_delete_button()) {@><li class="delete_model"><img class="icon" src="/css/aam/images/ClearXGrey_Buttcon.png">Delete</li><@ } @><@ if (can_show_pause_play_buttons()) {@><li class="status"><@= getStatusImage() @></li><@ } @></ul></div><h1 class="page_title"><@= getModelName() @></h1><span class="context-help" title="Help" data-id="c_models_summary.html">&nbsp;</span><div class="basic_info_and_graph dashboard"><div class="reach_accuracy_view right"></div><div class="basic_info_view basicInfo left"></div></div><div class="dashboard no-border"><div class="layout_helper_model_processing"><div class="widget left model_processing_history_wrapper"><h3>Model Processing History (Last 10 Processes)</h3><div class="model_processing_history"></div></div></div><div class="layout_helper_influential_traits"><div class="widget right last influential_traits_wrapper"><h3>Influential Traits (Top 50)</h3><div class="influential_traits"></div></div></div><br class="clear" /></div><div class="dashboard bottom no-border"><div class="widget traits_using_model_name_wrapper"><h3>Traits Using <@= getModelName() @></h3><div class="traits_using_model_name"></div></div></div>', t.templates.model_builder.page.model_basic_information = '<div class="basic_info"><h3>Basic Information</h3><dl><dt>Name:</dt><dd><@= name @></dd><dt>Description:</dt><dd><@= displayValue(description) @></dd><dt>Baseline <span class="<@= getBaselineType() @>"><span class="trait">Trait</span><span class="segment">Segment</span></span>:</dt><dd><@= getBaselineName() @> (<@= sid @>)</dd><dt>Algorithm:</dt><dd><@= algorithm.name @></dd><dt>Historic Increment:</dt><dd><@= lookBackPeriod @> Days</dd><dt>Last Run:</dt><dd><@ try {@><@= formatTimestamp(lastSuccessfulRunTimestamp) @><@} catch(__err__) {@>-<@}@></dd></dl></div>', t.templates.model_builder.page.model_reach_accuracy_graph = '<div class="graph"><h3>Model Reach & Accuracy</h3><div id="model_graph_container"></div></div>', t.templates.model_builder.page.model_processing_history = '<table class="table"><thead><th>Processing Date and Time</th><th>Data Generated?</th></thead><tbody class="history_list"></tbody></table>', t.templates.model_builder.page.model_processing_history_row = "<td><@= datetime @></td><td><@= dataGenerated @></td>", t.templates.model_builder.page.model_processing_history_not_run = "<tr><td>" + t.templates.getLocalizedMessage("model_has_not_run") + "</td></tr>", t.templates.model_builder.page.model_processing_history_nodata = "<tr><td>" + t.templates.getLocalizedMessage("model_has_not_run") + "</td></tr>", t.templates.model_builder.page.influential_traits = '<div class="table_wrapper"><table class="table"><thead><th class="sortable desc" data-sortby="rank" width="5%">Rank</th><th class="sortable" data-sortby="sid" width="10%">Trait ID</th><th class="sortable" data-sortby="name" width="25%">Name</th><th width="45%">Description</th><th class="sortable" data-sortby="uniques30Day" width="15%">30-Day Uniques</th></thead><tbody class="influential_trait_list"></tbody></table></div><button type="button" class="primary">View All Influential Traits</button>', t.templates.model_builder.page.influential_traits_row = '<td><@= rank @></td><td class="sid"><a href="#" data-sid="<@= sid @>"><@= sid @></a></td><td class="name"><a href="#" data-sid="<@= sid @>"><@= name @></a></td><td><@= description @></td><td class="days_30"><@= ADOBE.AM.UTILS.HELPERS.formatNumber(uniques30Day) @></td>', t.templates.model_builder.page.influential_traits_nodata = '<tr class="influential_traits_nodata"><td colspan="5">' + t.templates.getLocalizedMessage("influential_traits_nodata") + "</td>" + "</tr>", t.templates.model_builder.page.influential_traits_not_run = '<tr class="influential_traits_nodata"><td colspan="5">' + t.templates.getLocalizedMessage("model_has_not_run") + "</td>" + "</tr>", t.templates.model_builder.page.traits_using_model_name = '<div class="table_wrapper"><table class="table"><thead><th class="sortable" data-sortby="sid" width="8%">Trait ID</th><th class="sortable" data-sortby="name" width="25%">Name</th><th width="42%">Description</th><th class="sortable" data-sortby="reach" width="10%">Reach</th><th class="sortable" data-sortby="accuracy" width="15%">Accuracy</th></thead><tbody class="traits_using_model_name"></tbody></table></div><@ if (canCreateTrait()) { @><button type="button" class="primary">Create New Trait with Model</button><@ } @>', t.templates.model_builder.page.traits_using_model_name_empty_row = '<td colspan="5">No traits found</td>', t.templates.model_builder.page.traits_using_model_name_row = '<td class="sid"><a href="#" data-sid="<@= sid @>"><@= sid @></a></td><td class="name"><a href="#" data-sid="<@= sid @>"><@= name @></a></td><td><@= description@></td><td><@= displayReach() @></td><td><@= displayAccuracy() @></td>', t.templates.model_builder.page.influential_traits_modal = '<div id="influential_traits_modal"><div class="layout-2-col " style="width:1000px;height:550px;"><div class="panels influential_traits_list"><table class="table bb-table-widget" id="influential_traits_table" width="100%"><thead><tr><th class="sortable" data-sortby="rank" width="5%">Rank</th><th class="sortable" data-sortby="sid" width="10%">Trait ID</th><th class="sortable" data-sortby="name" width="25%">Name</th><th width="45%">Description</th><th class="sortable" data-sortby="uniques30Day" width="15%">Uniques</th></tr></thead><tbody id="influential_traits_table_tbody"></tbody></table><div id="influential_traits_pagination" class="pagination"></div></div></div></div>', t.templates.model_builder.page.influential_trait_table_row = '<td><@= t.get("rank") @></td><td><@= t.get("sid") @></td><td><@= t.get("name") @></td><td><@= t.get("description") @></td><td class="days_30"><@= ADOBE.AM.UTILS.HELPERS.formatNumber(t.get("uniques30Day")) @></td>', t.templates.model_builder.page.list_page = '<div id="ModelList"><div class="top_toolbar"><ul class="toolbar"><@ if (can_show_create_button()) {@><li class="new_model"><img class="icon" src="/css/aam/images/Add_Standard.png">Create New Model</li><@ } @><li class="new_trait"><img class="icon" src="/css/aam/images/Add_Standard.png">New Trait with Selected Model</li><@ if (can_show_delete_button()) {@><li class="delete_model"><img class="icon" src="/css/aam/images/ClearXGrey_Buttcon.png">Delete</li><@ } @></ul></div><div class="layout-2-col"><div class="col1 model_storage container"><h4>Model Storage</h4></div><div class="col2 container"><div class="models_list"></div><div id="model_pagination" class="pagination"></div></div></div></div>', t.templates.model_builder.page.list_models_table = '<table class="table" id="models_table"><thead><tr><th width="1%" data-sortby="name"><input type="checkbox" /></th><th width="1%" class="sortable" data-sortby="algoModelId">ID</th><th width="20%" class="sortable" data-sortby="name">Name</th><th width="27%" class="sortable" data-sortby="description">Description</th><th width="10%" class="sortable" data-sortby="algoTypeId">Algorithm</th><th width="8%" class="sortable" data-sortby="status">Status</th><th width="12%" class="sortable" data-sortby="lookBackPeriod">Look Back</th><th width="10%" class="sortable" data-sortby="lastSuccessfulRunTimestamp">Last Successful Run</th><th width="10%" class="actions">Actions</th></th></thead><tbody></tbody></table>', t.templates.model_builder.page.list_models_table_row = '<td><span class="result_checkbox"><@= displayCheckbox() @></span></td><td><@= algoModelId @></td><td><a href="#view/<@= algoModelId @>"><@= name @></a></td><td><@= description @></td><td><@= displayAlgorithm() @></td><td><@= displayStatus(status) @></td><td><@= lookBackPeriod @></td><td><@= formatTimestamp(lastSuccessfulRunTimestamp) @></td><td class="actions"><@ if (can_show_edit_button()) {@><a href="#edit/<@= algoModelId @>"><img class="edit btn_action" src="/css/aam/images/Edit_Standard.png" alt="Edit" title="Edit" /></a><@ } @><@ if (can_show_pause_play_buttons()) {@><@= getStatusImage() @><@ } @><@ if (can_show_clone_button()) {@><a href="#clone/<@= algoModelId @>"><img class="clone btn_action" src="%%IMG_CLONE_STANDARD%%" alt="Clone" title="Clone" /></a><@ } @><@ if (show_delete_button()) { @><img class="delete btn_action" alt="Delete" title="Delete" src="/css/aam/images/ClearXGrey_Buttcon.png" /><@ } @></td>', t.templates.algo_trait = {}, t.templates.algo_trait.page = {}, t.templates.algo_trait.page.create_edit_page = '<div class="page_title">Algorithmic Trait</div><br style="clear:both" /><div id="basic_info_accordion"></div><div id="configuration_accordion"></div><input type="hidden" name="folderId" value="" /><input type="hidden" name="categoryId" value="" /><input type="hidden" name="algoModelId" value="" /><div class="action_btns"><button type="button" class="save primary">Save</button><button type="button" class="cancel">Cancel</button></div>', t.templates.algo_trait.page.basic_info_accordion = '<div id="basic_inputs"></div><div class="layout_helper"><div class="layout_helper_sub"><div id="categories"></div></div><div class="layout_helper_sub"><div id="traits_storage"></div></div></div>', t.templates.algo_trait.page.configuration_accordion = '<div class="section select_model"></div><div id="reach_accuracy_group"><div class="adjust_reach_accuracy section"></div><div class="reach_accuracy section"></div></div>', t.templates.algo_trait.page.basic_inputs = '<div class="input_row"><label for="name">Name:</label><input type="text" name="name" value="<@ try { @><@= name @><@ } catch(err) {} @>" /></div><div class="input_row"><label for="description">Description:</label><input type="text" name="description" value="<@ try { @><@= description @><@ } catch(err) {} @>" /></div><div class="input_row"><label for="datasource">Data Source:</label><select name="dataSourceId"><option value="">Select a Data Source</option><@ _.each(dataSources, function(dataSrc) { @><option value="<@= dataSrc.dataSourceId @>" <@ try { if (dataSrc.dataSourceId == dataSourceId) { @>selected="selected"<@ }} catch(err) {} @>><@= dataSrc.name @> (DPID: <@= dataSrc.dataSourceId @>)</option> <@ }); @></select></div><@ if (!isAlgoTrait()) { @><div class="input_row"><label for="pixelType">Event Type:</label><select name="type"><option value="">Select an Event Type</option><@ _.each(pixelTypes, function(pxType) { @><option value="<@= pxType.pixelType @>" <@ try { if (pxType.pixelType == type) { @>selected="selected"<@ }} catch(err) {} @>><@= pxType.name @></option><@ }); @></select></div><@ } @><div class="input_row"><label for="integrationCode">Integration Code:</label><input type="text" name="integrationCode" value="<@ try { @><@= integrationCode @><@ } catch(err) {} @>" /></div><@ if (!isAlgoTrait()) { @><div class="input_row"><label for="comments">Comments:</label><textarea name="comments"><@ try { @><@= comments @><@ } catch(err) {} @></textarea></div><@ } @>', t.templates.algo_trait.page.traits_storage = '<h3>Store In:</h3><div id="traits_folder_tree"></div>', t.templates.algo_trait.page.data_category = '<h3>Data Category: <span class="optional">(Optional)</span></h3><div id="category_folder_tree"></div>', t.templates.algo_trait.select_model = '<h3><@= isEditMode() ? "Algorithmic Trait Model: " : "Select a Model for the Algorithmic Trait: " @><@= name @></h3><@ if (!isEditMode()) { @><button type="button" id="browse_all_models" class="primary"><@= (isCreateMode() && name === "") ? "Browse All Models" : "Update" @></button><@ } @>', t.templates.algo_trait.adjust_reach_accuracy = '<h3>Adjust Reach & Accuracy</h3><div id="reach_accuracy_graph" style="height:440px;width:595px"></div><div id="reach_accuracy_slider" style="margin-left:64px"></div>', t.templates.algo_trait.reach_accuracy = '<h3>Reach & Accuracy</h3><div class="reach_accuracy_table"><table class="table"><thead><tr><th>Accuracy</th><th>Reach</th></tr></thead><tbody class="reach_accuracy_table_body"></tbody></table></div>', t.templates.algo_trait.reach_accuracy_row = "<td><@= AccuracyValue @></td><td><@= formatNumber(ReachValue) @></td>", t.templates.algo_trait.view_page_toolbar_buttons = '<ul class="toolbar"><@ if (data.add) { @><li class="new_algotrait"><img class="icon" src="/css/aam/images/Add_Standard.png">Create New Trait<ul id="atMenu" class="am-aui-menu"><li class="item_rule_based_trait"><a href="#new/rule" rel="rb">Rules-based</a></li><li><a href="#new/algo">Algorithmic</a></li><li><a href="#new/onboarded">Onboarded</a></li></ul></li><@ } @><@ if (data.edit) { @><li class="edit_algotrait"><img class="icon" src="/css/aam/images/Edit_Standard.png">Edit</li><@ } @><@ if (data.clone) { @><li class="clone_algotrait"><img class="icon" src="%%IMG_CLONE_STANDARD%%">Clone</li><@ } @><@ if (data.del) { @><li class="delete_algotrait"><img class="icon" src="/css/aam/images/ClearXGrey_Buttcon.png">Delete</li><@ } @></ul>', t.templates.algo_trait.basic_information = "<h3>Basic Information</h3>", t.templates.algo_trait.segments_with_trait = '<div><table class="table" width="100%"><thead><th width="10%">Segment ID</th><th width="40%" class="sortable" data-sortby="name">Name</th><th width="50%">Description</th></thead><tbody class="segments_with_trait"></tbody></table></div>', t.templates.trait = {}, t.templates.trait.page = {}, t.templates.trait.page.graph = '<div class="reach_accuracy_view"><h3>Trait Uniques</h3><div id="algo_trait_graph_container"></div></div>', t.templates.trait.views = {}, t.templates.trait.views.basic_info = "<dt>Trait ID:</dt><dd><@= d.sid @></dd><dt>Description:</dt><dd><@= d.description @></dd><dt>Data Source:</dt><dd><@= d._datasource @></dd><@ if (!d.isAlgoTrait()) { @><dt>Event Type:</dt><dd><@ if (d._type) { @><@= d._type @><@ } @></dd><@ } @><dt>Integration Code:</dt><dd><@= d._integrationCode @></dd><dt>Stored In:</dt><dd><@= d._folder @> </dd><dt>Data Category:</dt><dd><@= d._category @></dd><@ if (!d.isAlgoTrait()) { @><dt>Comments:</dt><dd><@= d._comments @></dd><@ } @>", t.templates.trait_builder = {}, t.templates.trait_builder.page = {}, t.templates.trait_builder.page.list_page = '<div id="TraitList"><div class="top_toolbar"></div><div class="layout-2-col"><div class="col1"><div class="sidebar trait_sidebar container"><div class="trait_search"></div><div class="trait_storage"><h4>Trait Storage</h4></div></div></div><div class="col2 container"><div class="traits_list"></div><div id="trait_pagination" class="pagination"></div></div></div></div>', t.templates.trait_builder.list_page_toolbar_buttons = '<ul class="toolbar"><@ if (data.add) { @><li class="new_algotrait"><img class="icon" src="/css/aam/images/Add_Standard.png">Create New Trait<ul id="atMenu" class="am-aui-menu"><li class="item_rule_based_trait"><a href="#new/rule" rel="rb">Rules-based</a></li><li><a href="#new/algo">Algorithmic</a></li><li><a href="#new/onboarded">Onboarded</a></li></ul></li><@ } @><@ if (data.create_model) { @><li class="createModelWithTrait"><img class="icon" src="/css/aam/images/Add_Standard.png">Create Model with Selected</li><@ } @><@ if (data.can_show_segment) { @><li class="createSegmentWithTraits"><img class="icon" src="/css/aam/images/Add_Standard.png">Create Segment with Selected</li><@ } @><@ if (data.can_show_delete) { @><li class="deleteSelected"><img class="icon" src="/css/aam/images/AlertDeactivate_Standard.png">Delete Selected</li><@ } @></ul>', t.templates.trait_builder.page.create_edit_page = '<div class="page_title"><@= type @> Trait</div><br style="clear:both" /><div id="accordion_basicinfo"></div><div id="accordion_second"></div><@ if (type == "Rule-based" || type == "Onboarded") { @><div id="accordion_traitexp"><div id="rulesDiv"></div><div id="testExp"></div></div><@ } @><input type="hidden" name="folderId" value="" /><input type="hidden" name="categoryId" value="" /><input type="hidden" name="algoModelId" value="" /><input type="hidden" name="accuracy" value="" /><div class="action_btns"><button type="button" class="save primary">Save</button><button type="button" class="cancel">Cancel</button></div>', t.templates.trait_builder.page.create_page = {}, t.templates.trait_builder.page.create_page.advanced_options = 'Expire after: <input id="ttl" value="<@ try { @><@= ttl @><@ } catch(err) {@>0<@} @>" name="ttl" type="text" size="3" /> days.', t.templates.trait_builder.page.create_page.exp_panel_content = '<div id="codeView" class="tabContent" style=""><textarea name="traitRule" id="traitRule" rows="10" cols="141"><@ try {@><@=traitRule@><@} catch(__err__){}@></textarea><div class="button_wrap"><button type="button" id="validateBtn" class="primary">Validate Expression</button><button type="button" id="resetExp" class="secondary">Reset and Return to Expression Builder</button></div></div>', t.templates.trait_builder.page.create_page.test_section = '<label for="testUrl">Test Event URL</label><input id="testUrl" type="text" name="testUrl"><label for="testHeader">Test HTTP Header</label><textarea id="testHeader" cols="50" rows="5" name="testHeader"></textarea><div class="button_wrap"><button type="button" class="primary" id="testUrlBtn">Test</button></div>', t.templates.trait_builder.page.view_page = {}, t.templates.trait_builder.page.view_page.graph_wrapper = '<h3>Trait Graph</h3><div class="graph_container"></div>'
}(_, APP), define("adobe.templates", ["app", "adobe"], function(e) {
    return function() {
        var t, n;
        return t || e.APP.templates
    }
}(this)), define("adobe_am/trait_builder/views/viewPageToolbar", ["backbone", "backbone.marionette", "underscore", "adobe", "adobe.templates", "adobe_am/vent", "globals"], function(e, t, n, r, i, s, o) {
    var u = r.AM, a = u.UTILS, f = null, l = null, c = e.Marionette.ItemView.extend({template: n.template(i.makeTemplate(["algo_trait", "view_page_toolbar_buttons"], {"%%IMG_CLONE_STANDARD%%": o.clone_standard})),events: {"click ul li.delete_algotrait": "deleteTrait","click ul li.clone_algotrait": "cloneTrait","click ul li.edit_algotrait": "editTrait"},id: "toolbarDiv",editTrait: function() {
            s.trigger("show:edit")
        },cloneTrait: function() {
            s.trigger("show:clone")
        },createTrait: function(e) {
            return s.trigger("show:new", e), !1
        },ruleBasedTrait: function() {
            return s.trigger("show:new", "rulebased"), !1
        },deleteTrait: function() {
            return s.trigger("delete:trait"), !1
        },render: function() {
            var e = f, t = {};
            e.setPermissionObjects([this.model.relational.permissions, l.permissions]), e.setCurrentScheme("can_edit_trait"), e.permissionCheck() && (t.edit = !0), e.setCurrentScheme("can_delete_trait"), e.permissionCheck() && (t.del = !0), l.checked_perms.can_create_trait && (t.add = !0);
            try {
                this.model.isClonable() && (this.model.isAlgoTrait() ? (e.clearAll(), e.setPermissionObjects([this.model.relational.permissions, l.permissions, this.model.getAlgoModel().relational.permissions]), e.setCurrentScheme("can_clone_algo_trait_in_traitbuilder"), e.permissionCheck() && (t.clone = !0)) : this.model.isRuleBasedTrait() && (e.setCurrentScheme("can_clone_rule_based_trait_in_traitbuilder"), e.permissionCheck() && (t.clone = !0)))
            } catch (n) {
                t.clone = !1
            }
            e.clearAll(), this.$el.html(this.template({data: t}))
        },onShow: function() {
            var e = this;
            this.$el.find(".am-aui-menu a").click(function(t) {
                var n = $(this).attr("href");
                if (n === undefined)
                    return;
                var r = n.match(/\/([^\/]*)$/);
                if (r === null || r.length === undefined)
                    return;
                var i = r[1];
                i && (t.preventDefault(), e.createTrait(i))
            })
        }});
    return function(e) {
        var t = null;
        return e && e.model && (t = e.model), e && e.user && (l = e.user), e && e.permission_checker && (f = e.permission_checker), new c({model: t})
    }
}), define("modules/Trait/Views/BasicInfo", ["backbone", "backbone.marionette", "app", "adobe.templates", "adobe"], function(e, t, n, r, i) {
    if (arguments.length == 0)
        return;
    return e.Marionette.ItemView.extend({tagName: "dl",template: _.template(r.trait.views.basic_info),templateHelpers: {formatTimestamp: function(e) {
                var t = "-";
                if (typeof e != undefined)
                    try {
                        t = i.AM.UTILS.HELPERS.formatDate(e, function(e, t, n) {
                            return (e[1] ? e : "0" + e[0]) + "/" + (t[1] ? t : "0" + t[0]) + "/" + n
                        })
                    } catch (n) {
                        i.AM.UTILS.LOGGER.log("BasicInfo:templateHelpers:formatTimestamp: " + n.message)
                    }
                return t
            },isAlgoTrait: function() {
                return this.traitType === "ALGO_TRAIT"
            }},render: function() {
            var e = {_datasource: "",_folder: "",_category: ""}, t = null, n = null, r = null, i = null, s = null, o = this, u = {d: {}};
            u.d = this.model.toJSON(), this.model.dataSourceExists() && (e._datasource = this.model.getDataSource2().get("name")), this.model.folderExists() && (e._folder = this.model.getFolder2().get("name")), r = this.model.getCategory2(), this.model.categoryExists() && (e._category = this.model.getCategory2().get("name"));
            var a = {_comments: o.model.get("comments") || "",_integrationCode: o.model.get("integrationCode") || "",_expires: o.model.get("ttl") || ""}, f = function() {
                _.extend(u.d, e, a, o.templateHelpers), o.$el.html(o.template(u))
            }, l = this.model.getType();
            return l.done(function(t) {
                e._type = t.name
            }).always(f), !0
        }})
}), define("adobe_am/trait_builder/views/viewPageBasicInfo", ["backbone", "backbone.marionette", "adobe", "modules/Trait/Views/BasicInfo"], function(e, t, n, r) {
    var i = null, s = e.Marionette.ItemView.extend({tagName: "div",className: "basic_info",initialize: function(e) {
            e && _.extend(this, e)
        },render: function() {
            var e = "";
            return this.$el.html("<h3>Basic Information</h3>"), this.$el.append(this._subview), !0
        }});
    return function(e) {
        return e && e.model && (i = new r({model: e.model}), i.render()), new s({_subview: i.el})
    }
});
if (typeof DEMDEX == "undefined")
    var DEMDEX = {constants: {},TIM: {constants: {}}};
DEMDEX.UTILS = {statusArray: {UNDEFINED: "Undefined",ACTIVE: "Active",INACTIVE: "Inactive",DELETED: "Deleted"},currentTime: function() {
        return (new Date).getTime()
    },dirtyMonitor: {_configs: {cleanup: !0,cleaned: !1},_dirtyBit: !1,_onDirty: function() {
        },_onClean: function() {
        },_elements: [],_errors: [],_defaults: {actions: {INPUT: "keydown",SELECT: "change",TEXTAREA: "keydown"}},_cleanup: function() {
            var e = this;
            this._configs.cleaned || $.each(this._elements, function(t, n) {
                e._monitorElement(n, !1)
            })
        },_dirtyIt: function() {
            this._dirtyBit = 1, this._onDirty(), this._configs.cleanup && this._cleanup()
        },_monitorElement: function(e, t) {
            var n = e.element, r = e.action || this._defaults.actions[n[0].nodeName.toUpperCase()];
            r += ".dirtyUtil";
            if (t) {
                var i = $.proxy(this._dirtyIt, this);
                e.delegate ? n.delegate(e.delegate, r, i) : n.bind(r, i)
            } else
                n.unbind(r)
        },_validate: function() {
        },isDirty: function() {
            return this._dirtyBit
        },clean: function() {
            this._dirtyBit = !1, this._cleanup(), this._onClean()
        },monitor: function(e) {
            var t = this;
            e.cleanup && (this._configs.cleanup = e.cleanup), e.onDirty && typeof e.onDirty == "function" && (this._onDirty = e.onDirty), e.onClean && typeof e.onClean == "function" && (this._onClean = e.onClean), this._elements = e.elements, $.each(e.elements, function(e, n) {
                t._monitorElement(n, !0)
            })
        }},pressedEnter: function(e) {
        var t;
        return window.event ? t = window.event.keyCode : e ? t = e.which : t = e.keyCode, t == 13 ? !0 : !1
    },addTimeStamp: function(e) {
        var t = e;
        return "&" == e.charAt(e.length - 1) ? t += "ignoreThisTimeStamp=" + this.currentTime() + "&" : t += "&ignoreThisTimeStamp=" + this.currentTime() + "&", t
    },formatPercent: function(e) {
        return e != null && e != "" && (e *= 100, e = e.toFixed(2), e += "%"), e
    },formatNumber: function(e, t) {
        var n = 0;
        parseInt(e) < 0 && (n = 1);
        if (e != null && e != "") {
            e = e.toString(), t == null && (t = e.length - 1);
            if (parseInt(e.substring(n, t + 1)) < 1e3)
                return e;
            var r = e.substr(0, t - 2) + "," + e.substr(t - 2);
            return this.formatNumber(r, t - 3)
        }
        return e
    },parseTime: function(e) {
        var t = 0;
        pattern1 = /\d+\/\d+\/\d+/;
        if (pattern1.test(e)) {
            var n = e.split("/"), r = n[0] - 1, i = n[1], s = n[2];
            t = new Date(s, r, i)
        }
        return t.getTime()
    },convertToShortDate: function(e) {
        var t = new Date(parseInt(e)), n = t.getMonth() + 1, r = t.getDate(), i = t.getFullYear();
        return n + "/" + r + "/" + i
    },encodeDate: function(e) {
        if (e == null)
            return "";
        var t = e.split("/");
        return t.length != 3 ? "" : t[2] + "-" + t[0] + "-" + t[1]
    },decodeDate: function(e) {
        if (e == null)
            return "";
        var t = e.split("-");
        return t.length != 3 ? "" : t[1] + "/" + t[2] + "/" + t[0]
    },unescape: function(e) {
        return e.replace(/&amp;/g, "&").replace(/&quot;/g, '"').replace(/&gt;/g, ">").replace(/&lt;/g, "<").replace(/&rsquo;/, "'")
    },truncLongStr: function(e, t) {
        return strLength = e.length, strLength > t ? e.substr(0, t - 3) + "..." : e
    },loadingMsg: '<div class="loadingMsg"><p><span class="icon-largeLoader">Loading</span></p></div>',noDataMsg: '<div class="noDataMsg"><p>No results returned from search.</p></div>',formatFolderHierarchy: function(e) {
        var t = {attr: {id: e.folderId + "_folder",rel: "folder"},data: e.name};
        if ($.isArray(e.subFolders) && e.subFolders.length > 0) {
            var n = [];
            $.each(e.subFolders, function(e, t) {
                var r = DEMDEX.UTILS.formatFolderHierarchy(t);
                n.push(r)
            }), $.extend(t, {state: "closed",children: n})
        }
        return t
    }}, define("demdex_utils", function(e) {
    return function() {
        var t, n;
        return t || e.DEMDEX.UTILS
    }
}(this)), !function() {
    function p(e, t) {
        return e < t ? -1 : e > t ? 1 : e >= t ? 0 : NaN
    }
    function d(e) {
        return e != null && !isNaN(e)
    }
    function v(e) {
        return {left: function(t, n, r, i) {
                arguments.length < 3 && (r = 0), arguments.length < 4 && (i = t.length);
                while (r < i) {
                    var s = r + i >>> 1;
                    e(t[s], n) < 0 ? r = s + 1 : i = s
                }
                return r
            },right: function(t, n, r, i) {
                arguments.length < 3 && (r = 0), arguments.length < 4 && (i = t.length);
                while (r < i) {
                    var s = r + i >>> 1;
                    e(t[s], n) > 0 ? i = s : r = s + 1
                }
                return r
            }}
    }
    function g(e) {
        return e.length
    }
    function b(e) {
        var t = 1;
        while (e * t % 1)
            t *= 10;
        return t
    }
    function w(e, t) {
        try {
            for (var n in t)
                Object.defineProperty(e.prototype, n, {value: t[n],enumerable: !1})
        } catch (r) {
            e.prototype = t
        }
    }
    function E() {
    }
    function T(e) {
        return S + e in this
    }
    function N(e) {
        return e = S + e, e in this && delete this[e]
    }
    function C() {
        var e = [];
        return this.forEach(function(t) {
            e.push(t)
        }), e
    }
    function k() {
        var e = 0;
        for (var t in this)
            t.charCodeAt(0) === x && ++e;
        return e
    }
    function L() {
        for (var e in this)
            if (e.charCodeAt(0) === x)
                return !1;
        return !0
    }
    function A() {
    }
    function O(e, t, n) {
        return function() {
            var r = n.apply(t, arguments);
            return r === t ? e : r
        }
    }
    function M(e, t) {
        if (t in e)
            return t;
        t = t.charAt(0).toUpperCase() + t.substring(1);
        for (var n = 0, r = _.length; n < r; ++n) {
            var i = _[n] + t;
            if (i in e)
                return i
        }
    }
    function D() {
    }
    function P() {
    }
    function H(e) {
        function r() {
            var n = t, r = -1, i = n.length, s;
            while (++r < i)
                (s = n[r].on) && s.apply(this, arguments);
            return e
        }
        var t = [], n = new E;
        return r.on = function(r, i) {
            var s = n.get(r), o;
            return arguments.length < 2 ? s && s.on : (s && (s.on = null, t = t.slice(0, o = t.indexOf(s)).concat(t.slice(o + 1)), n.remove(r)), i && t.push(n.set(r, {on: i})), e)
        }, r
    }
    function B() {
        e.event.preventDefault()
    }
    function j() {
        var t = e.event, n;
        while (n = t.sourceEvent)
            t = n;
        return t
    }
    function F(t) {
        var n = new P, r = 0, i = arguments.length;
        while (++r < i)
            n[arguments[r]] = H(n);
        return n.of = function(r, i) {
            return function(s) {
                try {
                    var o = s.sourceEvent = e.event;
                    s.target = t, e.event = s, n[s.type].apply(r, i)
                }finally {
                    e.event = o
                }
            }
        }, n
    }
    function R(e) {
        return q(e, V), e
    }
    function $(e) {
        return typeof e == "function" ? e : function() {
            return U(e, this)
        }
    }
    function J(e) {
        return typeof e == "function" ? e : function() {
            return z(e, this)
        }
    }
    function Q(t, n) {
        function r() {
            this.removeAttribute(t)
        }
        function i() {
            this.removeAttributeNS(t.space, t.local)
        }
        function s() {
            this.setAttribute(t, n)
        }
        function o() {
            this.setAttributeNS(t.space, t.local, n)
        }
        function u() {
            var e = n.apply(this, arguments);
            e == null ? this.removeAttribute(t) : this.setAttribute(t, e)
        }
        function a() {
            var e = n.apply(this, arguments);
            e == null ? this.removeAttributeNS(t.space, t.local) : this.setAttributeNS(t.space, t.local, e)
        }
        return t = e.ns.qualify(t), n == null ? t.local ? i : r : typeof n == "function" ? t.local ? a : u : t.local ? o : s
    }
    function G(e) {
        return e.trim().replace(/\s+/g, " ")
    }
    function Y(t) {
        return new RegExp("(?:^|\\s+)" + e.requote(t) + "(?:\\s+|$)", "g")
    }
    function Z(e) {
        return (e + "").trim().split(/^|\s+/)
    }
    function et(e, t) {
        function r() {
            var r = -1;
            while (++r < n)
                e[r](this, t)
        }
        function i() {
            var r = -1, i = t.apply(this, arguments);
            while (++r < n)
                e[r](this, i)
        }
        e = Z(e).map(tt);
        var n = e.length;
        return typeof t == "function" ? i : r
    }
    function tt(e) {
        var t = Y(e);
        return function(n, r) {
            if (i = n.classList)
                return r ? i.add(e) : i.remove(e);
            var i = n.getAttribute("class") || "";
            r ? (t.lastIndex = 0, t.test(i) || n.setAttribute("class", G(i + " " + e))) : n.setAttribute("class", G(i.replace(t, " ")))
        }
    }
    function nt(e, t, n) {
        function r() {
            this.style.removeProperty(e)
        }
        function i() {
            this.style.setProperty(e, t, n)
        }
        function s() {
            var r = t.apply(this, arguments);
            r == null ? this.style.removeProperty(e) : this.style.setProperty(e, r, n)
        }
        return t == null ? r : typeof t == "function" ? s : i
    }
    function rt(e, t) {
        function n() {
            delete this[e]
        }
        function r() {
            this[e] = t
        }
        function i() {
            var n = t.apply(this, arguments);
            n == null ? delete this[e] : this[e] = n
        }
        return t == null ? n : typeof t == "function" ? i : r
    }
    function it(t) {
        return typeof t == "function" ? t : (t = e.ns.qualify(t)).local ? function() {
            return this.ownerDocument.createElementNS(t.space, t.local)
        } : function() {
            return this.ownerDocument.createElementNS(this.namespaceURI, t)
        }
    }
    function st(e) {
        return {__data__: e}
    }
    function ot(e) {
        return function() {
            return X(this, e)
        }
    }
    function ut(e) {
        return arguments.length || (e = p), function(t, n) {
            return t && n ? e(t.__data__, n.__data__) : !t - !n
        }
    }
    function at(e, t) {
        for (var n = 0, r = e.length; n < r; n++)
            for (var i = e[n], s = 0, o = i.length, u; s < o; s++)
                (u = i[s]) && t(u, s, n);
        return e
    }
    function ft(e) {
        return q(e, lt), e
    }
    function ct(e) {
        var t, n;
        return function(r, i, s) {
            var o = e[s].update, u = o.length, a;
            s != n && (n = s, t = 0), i >= t && (t = i + 1);
            while (!(a = o[t]) && ++t < u)
                ;
            return a
        }
    }
    function ht() {
        var e = this.__transition__;
        e && ++e.active
    }
    function dt(t, r, i) {
        function f() {
            var e = this[s];
            e && (this.removeEventListener(t, e, e.$), delete this[s])
        }
        function l() {
            var e = u(r, n(arguments));
            f.call(this), this.addEventListener(t, this[s] = e, e.$ = i), e._ = r
        }
        function c() {
            var n = new RegExp("^__on([^.]+)" + e.requote(t) + "$"), r;
            for (var i in this)
                if (r = i.match(n)) {
                    var s = this[i];
                    this.removeEventListener(r[1], s, s.$), delete this[i]
                }
        }
        var s = "__on" + t, o = t.indexOf("."), u = mt;
        o > 0 && (t = t.substring(0, o));
        var a = vt.get(t);
        return a && (t = a, u = gt), o ? r ? l : f : r ? D : c
    }
    function mt(t, n) {
        return function(r) {
            var i = e.event;
            e.event = r, n[0] = this.__data__;
            try {
                t.apply(this, n)
            }finally {
                e.event = i
            }
        }
    }
    function gt(e, t) {
        var n = mt(e, t);
        return function(e) {
            var t = this, r = e.relatedTarget;
            (!r || r !== t && !(r.compareDocumentPosition(t) & 8)) && n.call(t, e)
        }
    }
    function wt() {
        var t = ".dragsuppress-" + ++bt, n = "click" + t, r = e.select(s).on("touchmove" + t, B).on("dragstart" + t, B).on("selectstart" + t, B);
        if (yt) {
            var o = i.style, u = o[yt];
            o[yt] = "none"
        }
        return function(e) {
            r.on(t, null), yt && (o[yt] = u);
            if (e) {
                function i() {
                    r.on(n, null)
                }
                r.on(n, function() {
                    B(), i()
                }, !0), setTimeout(i, 0)
            }
        }
    }
    function St(t, n) {
        n.changedTouches && (n = n.changedTouches[0]);
        var r = t.ownerSVGElement || t;
        if (r.createSVGPoint) {
            var i = r.createSVGPoint();
            if (Et < 0 && (s.scrollX || s.scrollY)) {
                r = e.select("body").append("svg").style({position: "absolute",top: 0,left: 0,margin: 0,padding: 0,border: "none"}, "important");
                var o = r[0][0].getScreenCTM();
                Et = !o.f && !o.e, r.remove()
            }
            return Et ? (i.x = n.pageX, i.y = n.pageY) : (i.x = n.clientX, i.y = n.clientY), i = i.matrixTransform(t.getScreenCTM().inverse()), [i.x, i.y]
        }
        var u = t.getBoundingClientRect();
        return [n.clientX - u.left - t.clientLeft, n.clientY - u.top - t.clientTop]
    }
    function xt() {
        return e.event.changedTouches[0].identifier
    }
    function Tt() {
        return e.event.target
    }
    function Nt() {
        return s
    }
    function Dt(e) {
        return e > 0 ? 1 : e < 0 ? -1 : 0
    }
    function Pt(e, t, n) {
        return (t[0] - e[0]) * (n[1] - e[1]) - (t[1] - e[1]) * (n[0] - e[0])
    }
    function Ht(e) {
        return e > 1 ? 0 : e < -1 ? Ct : Math.acos(e)
    }
    function Bt(e) {
        return e > 1 ? Lt : e < -1 ? -Lt : Math.asin(e)
    }
    function jt(e) {
        return ((e = Math.exp(e)) - 1 / e) / 2
    }
    function Ft(e) {
        return ((e = Math.exp(e)) + 1 / e) / 2
    }
    function It(e) {
        return ((e = Math.exp(2 * e)) - 1) / (e + 1)
    }
    function qt(e) {
        return (e = Math.sin(e / 2)) * e
    }
    function $t() {
    }
    function Jt(e, t, n) {
        return this instanceof Jt ? void (this.h = +e, this.s = +t, this.l = +n) : arguments.length < 2 ? e instanceof Jt ? new Jt(e.h, e.s, e.l) : gn("" + e, yn, Jt) : new Jt(e, t, n)
    }
    function Qt(e, t, n) {
        function s(e) {
            return e > 360 ? e -= 360 : e < 0 && (e += 360), e < 60 ? r + (i - r) * e / 60 : e < 180 ? i : e < 240 ? r + (i - r) * (240 - e) / 60 : r
        }
        function o(e) {
            return Math.round(s(e) * 255)
        }
        var r, i;
        return e = isNaN(e) ? 0 : (e %= 360) < 0 ? e + 360 : e, t = isNaN(t) ? 0 : t < 0 ? 0 : t > 1 ? 1 : t, n = n < 0 ? 0 : n > 1 ? 1 : n, i = n <= .5 ? n * (1 + t) : n + t - n * t, r = 2 * n - i, new hn(o(e + 120), o(e), o(e - 120))
    }
    function Gt(t, n, r) {
        return this instanceof Gt ? void (this.h = +t, this.c = +n, this.l = +r) : arguments.length < 2 ? t instanceof Gt ? new Gt(t.h, t.c, t.l) : t instanceof en ? an(t.l, t.a, t.b) : an((t = bn((t = e.rgb(t)).r, t.g, t.b)).l, t.a, t.b) : new Gt(t, n, r)
    }
    function Zt(e, t, n) {
        return isNaN(e) && (e = 0), isNaN(t) && (t = 0), new en(n, Math.cos(e *= Mt) * t, Math.sin(e) * t)
    }
    function en(e, t, n) {
        return this instanceof en ? void (this.l = +e, this.a = +t, this.b = +n) : arguments.length < 2 ? e instanceof en ? new en(e.l, e.a, e.b) : e instanceof Gt ? Zt(e.l, e.c, e.h) : bn((e = hn(e)).r, e.g, e.b) : new en(e, t, n)
    }
    function un(e, t, n) {
        var r = (e + 16) / 116, i = r + t / 500, s = r - n / 200;
        return i = fn(i) * nn, r = fn(r) * rn, s = fn(s) * sn, new hn(cn(3.2404542 * i - 1.5371385 * r - .4985314 * s), cn(-0.969266 * i + 1.8760108 * r + .041556 * s), cn(.0556434 * i - .2040259 * r + 1.0572252 * s))
    }
    function an(e, t, n) {
        return e > 0 ? new Gt(Math.atan2(n, t) * _t, Math.sqrt(t * t + n * n), e) : new Gt(NaN, NaN, e)
    }
    function fn(e) {
        return e > .206893034 ? e * e * e : (e - 4 / 29) / 7.787037
    }
    function ln(e) {
        return e > .008856 ? Math.pow(e, 1 / 3) : 7.787037 * e + 4 / 29
    }
    function cn(e) {
        return Math.round(255 * (e <= .00304 ? 12.92 * e : 1.055 * Math.pow(e, 1 / 2.4) - .055))
    }
    function hn(e, t, n) {
        return this instanceof hn ? void (this.r = ~~e, this.g = ~~t, this.b = ~~n) : arguments.length < 2 ? e instanceof hn ? new hn(e.r, e.g, e.b) : gn("" + e, hn, Qt) : new hn(e, t, n)
    }
    function pn(e) {
        return new hn(e >> 16, e >> 8 & 255, e & 255)
    }
    function dn(e) {
        return pn(e) + ""
    }
    function mn(e) {
        return e < 16 ? "0" + Math.max(0, e).toString(16) : Math.min(255, e).toString(16)
    }
    function gn(e, t, n) {
        var r = 0, i = 0, s = 0, o, u, a;
        o = /([a-z]+)\((.*)\)/i.exec(e);
        if (o) {
            u = o[2].split(",");
            switch (o[1]) {
                case "hsl":
                    return n(parseFloat(u[0]), parseFloat(u[1]) / 100, parseFloat(u[2]) / 100);
                case "rgb":
                    return t(En(u[0]), En(u[1]), En(u[2]))
            }
        }
        return (a = Sn.get(e)) ? t(a.r, a.g, a.b) : (e != null && e.charAt(0) === "#" && !isNaN(a = parseInt(e.substring(1), 16)) && (e.length === 4 ? (r = (a & 3840) >> 4, r = r >> 4 | r, i = a & 240, i = i >> 4 | i, s = a & 15, s = s << 4 | s) : e.length === 7 && (r = (a & 16711680) >> 16, i = (a & 65280) >> 8, s = a & 255)), t(r, i, s))
    }
    function yn(e, t, n) {
        var r = Math.min(e /= 255, t /= 255, n /= 255), i = Math.max(e, t, n), s = i - r, o, u, a = (i + r) / 2;
        return s ? (u = a < .5 ? s / (i + r) : s / (2 - i - r), e == i ? o = (t - n) / s + (t < n ? 6 : 0) : t == i ? o = (n - e) / s + 2 : o = (e - t) / s + 4, o *= 60) : (o = NaN, u = a > 0 && a < 1 ? 0 : o), new Jt(o, u, a)
    }
    function bn(e, t, n) {
        e = wn(e), t = wn(t), n = wn(n);
        var r = ln((.4124564 * e + .3575761 * t + .1804375 * n) / nn), i = ln((.2126729 * e + .7151522 * t + .072175 * n) / rn), s = ln((.0193339 * e + .119192 * t + .9503041 * n) / sn);
        return en(116 * i - 16, 500 * (r - i), 200 * (i - s))
    }
    function wn(e) {
        return (e /= 255) <= .04045 ? e / 12.92 : Math.pow((e + .055) / 1.055, 2.4)
    }
    function En(e) {
        var t = parseFloat(e);
        return e.charAt(e.length - 1) === "%" ? Math.round(t * 2.55) : t
    }
    function xn(e) {
        return typeof e == "function" ? e : function() {
            return e
        }
    }
    function Tn(e) {
        return e
    }
    function Nn(e) {
        return function(t, n, r) {
            return arguments.length === 2 && typeof n == "function" && (r = n, n = null), Cn(t, n, e, r)
        }
    }
    function Cn(t, r, i, o) {
        function h() {
            var e = l.status, t;
            if (!e && l.responseText || e >= 200 && e < 300 || e === 304) {
                try {
                    t = i.call(u, l)
                } catch (n) {
                    a.error.call(u, n);
                    return
                }
                a.load.call(u, t)
            } else
                a.error.call(u, l)
        }
        var u = {}, a = e.dispatch("beforesend", "progress", "load", "error"), f = {}, l = new XMLHttpRequest, c = null;
        return s.XDomainRequest && !("withCredentials" in l) && /^(http(s)?:)?\/\//.test(t) && (l = new XDomainRequest), "onload" in l ? l.onload = l.onerror = h : l.onreadystatechange = function() {
            l.readyState > 3 && h()
        }, l.onprogress = function(t) {
            var n = e.event;
            e.event = t;
            try {
                a.progress.call(u, l)
            }finally {
                e.event = n
            }
        }, u.header = function(e, t) {
            return e = (e + "").toLowerCase(), arguments.length < 2 ? f[e] : (t == null ? delete f[e] : f[e] = t + "", u)
        }, u.mimeType = function(e) {
            return arguments.length ? (r = e == null ? null : e + "", u) : r
        }, u.responseType = function(e) {
            return arguments.length ? (c = e, u) : c
        }, u.response = function(e) {
            return i = e, u
        }, ["get", "post"].forEach(function(e) {
            u[e] = function() {
                return u.send.apply(u, [e].concat(n(arguments)))
            }
        }), u.send = function(e, n, i) {
            arguments.length === 2 && typeof n == "function" && (i = n, n = null), l.open(e, t, !0), r != null && !("accept" in f) && (f.accept = r + ",*/*");
            if (l.setRequestHeader)
                for (var s in f)
                    l.setRequestHeader(s, f[s]);
            return r != null && l.overrideMimeType && l.overrideMimeType(r), c != null && (l.responseType = c), i != null && u.on("error", i).on("load", function(e) {
                i(null, e)
            }), a.beforesend.call(u, l), l.send(n == null ? null : n), u
        }, u.abort = function() {
            return l.abort(), u
        }, e.rebind(u, a, "on"), o == null ? u : u.get(kn(o))
    }
    function kn(e) {
        return e.length === 1 ? function(t, n) {
            e(t == null ? n : null)
        } : e
    }
    function Pn() {
        var e = Hn(), t = Bn() - e;
        t > 24 ? (isFinite(t) && (clearTimeout(Mn), Mn = setTimeout(Pn, t)), On = 0) : (On = 1, Dn(Pn))
    }
    function Hn() {
        var e = Date.now();
        _n = Ln;
        while (_n)
            e >= _n.t && (_n.f = _n.c(e - _n.t)), _n = _n.n;
        return e
    }
    function Bn() {
        var e, t = Ln, n = Infinity;
        while (t)
            t.f ? t = e ? e.n = t.n : Ln = t.n : (t.t < n && (n = t.t), t = (e = t).n);
        return An = e, n
    }
    function jn(e, t) {
        return t - (e ? Math.ceil(Math.log(e) / Math.LN10) : 1)
    }
    function In(e, t) {
        var n = Math.pow(10, y(8 - t) * 3);
        return {scale: t > 8 ? function(e) {
                return e / n
            } : function(e) {
                return e * n
            },symbol: e}
    }
    function qn(t) {
        var n = t.decimal, r = t.thousands, i = t.grouping, s = t.currency, o = i ? function(e) {
            var t = e.length, n = [], s = 0, o = i[0];
            while (t > 0 && o > 0)
                n.push(e.substring(t -= o, t + o)), o = i[s = (s + 1) % i.length];
            return n.reverse().join(r)
        } : Tn;
        return function(t) {
            var r = Rn.exec(t), i = r[1] || " ", u = r[2] || ">", a = r[3] || "", f = r[4] || "", l = r[5], c = +r[6], h = r[7], p = r[8], d = r[9], v = 1, m = "", g = "", y = !1;
            p && (p = +p.substring(1));
            if (l || i === "0" && u === "=")
                l = i = "0", u = "=", h && (c -= Math.floor((c - 1) / 4));
            switch (d) {
                case "n":
                    h = !0, d = "g";
                    break;
                case "%":
                    v = 100, g = "%", d = "f";
                    break;
                case "p":
                    v = 100, g = "%", d = "r";
                    break;
                case "b":
                case "o":
                case "x":
                case "X":
                    f === "#" && (m = "0" + d.toLowerCase());
                case "c":
                case "d":
                    y = !0, p = 0;
                    break;
                case "s":
                    v = -1, d = "r"
            }
            f === "$" && (m = s[0], g = s[1]), d == "r" && !p && (d = "g");
            if (p != null)
                if (d == "g")
                    p = Math.max(1, Math.min(21, p));
                else if (d == "e" || d == "f")
                    p = Math.max(0, Math.min(20, p));
            d = Un.get(d) || zn;
            var b = l && h;
            return function(t) {
                var r = g;
                if (y && t % 1)
                    return "";
                var s = t < 0 || t === 0 && 1 / t < 0 ? (t = -t, "-") : a;
                if (v < 0) {
                    var f = e.formatPrefix(t, p);
                    t = f.scale(t), r = f.symbol + g
                } else
                    t *= v;
                t = d(t, p);
                var w = t.lastIndexOf("."), E = w < 0 ? t : t.substring(0, w), S = w < 0 ? "" : n + t.substring(w + 1);
                !l && h && (E = o(E));
                var x = m.length + E.length + S.length + (b ? 0 : s.length), T = x < c ? (new Array(x = c - x + 1)).join(i) : "";
                return b && (E = o(T + E)), s += m, t = E + S, (u === "<" ? s + t + T : u === ">" ? T + s + t : u === "^" ? T.substring(0, x >>= 1) + s + t + T.substring(x) : s + (b ? t : T + t)) + r
            }
        }
    }
    function zn(e) {
        return e + ""
    }
    function Vn() {
        this._ = new Date(arguments.length > 1 ? Date.UTC.apply(this, arguments) : arguments[0])
    }
    function Jn(e, t, n) {
        function r(t) {
            var n = e(t), r = s(n, 1);
            return t - n < r - t ? n : r
        }
        function i(n) {
            return t(n = e(new Xn(n - 1)), 1), n
        }
        function s(e, n) {
            return t(e = new Xn(+e), n), e
        }
        function o(e, r, s) {
            var o = i(e), u = [];
            if (s > 1)
                while (o < r)
                    n(o) % s || u.push(new Date(+o)), t(o, 1);
            else
                while (o < r)
                    u.push(new Date(+o)), t(o, 1);
            return u
        }
        function u(e, t, n) {
            try {
                Xn = Vn;
                var r = new Vn;
                return r._ = e, o(r, t, n)
            }finally {
                Xn = Date
            }
        }
        e.floor = e, e.round = r, e.ceil = i, e.offset = s, e.range = o;
        var a = e.utc = Kn(e);
        return a.floor = a, a.round = Kn(r), a.ceil = Kn(i), a.offset = Kn(s), a.range = u, e
    }
    function Kn(e) {
        return function(t, n) {
            try {
                Xn = Vn;
                var r = new Vn;
                return r._ = t, e(r, n)._
            }finally {
                Xn = Date
            }
        }
    }
    function Qn(t) {
        function l(e) {
            function n(n) {
                var r = [], i = -1, s = 0, o, u, a;
                while (++i < t)
                    if (e.charCodeAt(i) === 37) {
                        r.push(e.substring(s, i)), (u = Gn[o = e.charAt(++i)]) != null && (o = e.charAt(++i));
                        if (a = E[o])
                            o = a(n, u == null ? o === "e" ? " " : "0" : u);
                        r.push(o), s = i + 1
                    }
                return r.push(e.substring(s, i)), r.join("")
            }
            var t = e.length;
            return n.parse = function(t) {
                var n = {y: 1900,m: 0,d: 1,H: 0,M: 0,S: 0,L: 0,Z: null}, r = c(n, e, t, 0);
                if (r != t.length)
                    return null;
                "p" in n && (n.H = n.H % 12 + n.p * 12);
                var i = n.Z != null && Xn !== Vn, s = new (i ? Vn : Xn);
                return "j" in n ? s.setFullYear(n.y, 0, n.j) : "w" in n && ("W" in n || "U" in n) ? (s.setFullYear(n.y, 0, 1), s.setFullYear(n.y, 0, "W" in n ? (n.w + 6) % 7 + n.W * 7 - (s.getDay() + 5) % 7 : n.w + n.U * 7 - (s.getDay() + 6) % 7)) : s.setFullYear(n.y, n.m, n.d), s.setHours(n.H + Math.floor(n.Z / 100), n.M + n.Z % 100, n.S, n.L), i ? s._ : s
            }, n.toString = function() {
                return e
            }, n
        }
        function c(e, t, n, r) {
            var i, s, o, u = 0, a = t.length, f = n.length;
            while (u < a) {
                if (r >= f)
                    return -1;
                i = t.charCodeAt(u++);
                if (i === 37) {
                    o = t.charAt(u++), s = S[o in Gn ? t.charAt(u++) : o];
                    if (!s || (r = s(e, n, r)) < 0)
                        return -1
                } else if (i != n.charCodeAt(r++))
                    return -1
            }
            return r
        }
        function x(e, t, n) {
            v.lastIndex = 0;
            var r = v.exec(t.substring(n));
            return r ? (e.w = m.get(r[0].toLowerCase()), n + r[0].length) : -1
        }
        function T(e, t, n) {
            p.lastIndex = 0;
            var r = p.exec(t.substring(n));
            return r ? (e.w = d.get(r[0].toLowerCase()), n + r[0].length) : -1
        }
        function N(e, t, n) {
            b.lastIndex = 0;
            var r = b.exec(t.substring(n));
            return r ? (e.m = w.get(r[0].toLowerCase()), n + r[0].length) : -1
        }
        function C(e, t, n) {
            g.lastIndex = 0;
            var r = g.exec(t.substring(n));
            return r ? (e.m = y.get(r[0].toLowerCase()), n + r[0].length) : -1
        }
        function k(e, t, n) {
            return c(e, E.c.toString(), t, n)
        }
        function L(e, t, n) {
            return c(e, E.x.toString(), t, n)
        }
        function A(e, t, n) {
            return c(e, E.X.toString(), t, n)
        }
        function O(e, t, n) {
            var r = h.get(t.substring(n, n += 2).toLowerCase());
            return r == null ? -1 : (e.p = r, n)
        }
        var n = t.dateTime, r = t.date, i = t.time, s = t.periods, o = t.days, u = t.shortDays, a = t.months, f = t.shortMonths;
        l.utc = function(e) {
            function n(e) {
                try {
                    Xn = Vn;
                    var n = new Xn;
                    return n._ = e, t(n)
                }finally {
                    Xn = Date
                }
            }
            var t = l(e);
            return n.parse = function(e) {
                try {
                    Xn = Vn;
                    var n = t.parse(e);
                    return n && n._
                }finally {
                    Xn = Date
                }
            }, n.toString = t.toString, n
        }, l.multi = l.utc.multi = br;
        var h = e.map(), p = tr(o), d = nr(o), v = tr(u), m = nr(u), g = tr(a), y = nr(a), b = tr(f), w = nr(f);
        s.forEach(function(e, t) {
            h.set(e.toLowerCase(), t)
        });
        var E = {a: function(e) {
                return u[e.getDay()]
            },A: function(e) {
                return o[e.getDay()]
            },b: function(e) {
                return f[e.getMonth()]
            },B: function(e) {
                return a[e.getMonth()]
            },c: l(n),d: function(e, t) {
                return er(e.getDate(), t, 2)
            },e: function(e, t) {
                return er(e.getDate(), t, 2)
            },H: function(e, t) {
                return er(e.getHours(), t, 2)
            },I: function(e, t) {
                return er(e.getHours() % 12 || 12, t, 2)
            },j: function(e, t) {
                return er(1 + Wn.dayOfYear(e), t, 3)
            },L: function(e, t) {
                return er(e.getMilliseconds(), t, 3)
            },m: function(e, t) {
                return er(e.getMonth() + 1, t, 2)
            },M: function(e, t) {
                return er(e.getMinutes(), t, 2)
            },p: function(e) {
                return s[+(e.getHours() >= 12)]
            },S: function(e, t) {
                return er(e.getSeconds(), t, 2)
            },U: function(e, t) {
                return er(Wn.sundayOfYear(e), t, 2)
            },w: function(e) {
                return e.getDay()
            },W: function(e, t) {
                return er(Wn.mondayOfYear(e), t, 2)
            },x: l(r),X: l(i),y: function(e, t) {
                return er(e.getFullYear() % 100, t, 2)
            },Y: function(e, t) {
                return er(e.getFullYear() % 1e4, t, 4)
            },Z: gr,"%": function() {
                return "%"
            }}, S = {a: x,A: T,b: N,B: C,c: k,d: cr,e: cr,H: pr,I: pr,j: hr,L: mr,m: lr,M: dr,p: O,S: vr,U: ir,w: rr,W: sr,x: L,X: A,y: ur,Y: or,Z: ar,"%": yr};
        return l
    }
    function er(e, t, n) {
        var r = e < 0 ? "-" : "", i = (r ? -e : e) + "", s = i.length;
        return r + (s < n ? (new Array(n - s + 1)).join(t) + i : i)
    }
    function tr(t) {
        return new RegExp("^(?:" + t.map(e.requote).join("|") + ")", "i")
    }
    function nr(e) {
        var t = new E, n = -1, r = e.length;
        while (++n < r)
            t.set(e[n].toLowerCase(), n);
        return t
    }
    function rr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 1));
        return r ? (e.w = +r[0], n + r[0].length) : -1
    }
    function ir(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n));
        return r ? (e.U = +r[0], n + r[0].length) : -1
    }
    function sr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n));
        return r ? (e.W = +r[0], n + r[0].length) : -1
    }
    function or(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 4));
        return r ? (e.y = +r[0], n + r[0].length) : -1
    }
    function ur(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 2));
        return r ? (e.y = fr(+r[0]), n + r[0].length) : -1
    }
    function ar(e, t, n) {
        return /^[+-]\d{4}$/.test(t = t.substring(n, n + 5)) ? (e.Z = -t, n + 5) : -1
    }
    function fr(e) {
        return e + (e > 68 ? 1900 : 2e3)
    }
    function lr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 2));
        return r ? (e.m = r[0] - 1, n + r[0].length) : -1
    }
    function cr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 2));
        return r ? (e.d = +r[0], n + r[0].length) : -1
    }
    function hr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 3));
        return r ? (e.j = +r[0], n + r[0].length) : -1
    }
    function pr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 2));
        return r ? (e.H = +r[0], n + r[0].length) : -1
    }
    function dr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 2));
        return r ? (e.M = +r[0], n + r[0].length) : -1
    }
    function vr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 2));
        return r ? (e.S = +r[0], n + r[0].length) : -1
    }
    function mr(e, t, n) {
        Yn.lastIndex = 0;
        var r = Yn.exec(t.substring(n, n + 3));
        return r ? (e.L = +r[0], n + r[0].length) : -1
    }
    function gr(e) {
        var t = e.getTimezoneOffset(), n = t > 0 ? "-" : "+", r = ~~(y(t) / 60), i = y(t) % 60;
        return n + er(r, "0", 2) + er(i, "0", 2)
    }
    function yr(e, t, n) {
        Zn.lastIndex = 0;
        var r = Zn.exec(t.substring(n, n + 1));
        return r ? n + r[0].length : -1
    }
    function br(e) {
        var t = e.length, n = -1;
        while (++n < t)
            e[n][0] = this(e[n][0]);
        return function(t) {
            var n = 0, r = e[n];
            while (!r[1](t))
                r = e[++n];
            return r[0](t)
        }
    }
    function Er() {
    }
    function xr(e, t, n) {
        var r = n.s = e + t, i = r - e, s = r - i;
        n.t = e - s + (t - i)
    }
    function Tr(e, t) {
        e && Cr.hasOwnProperty(e.type) && Cr[e.type](e, t)
    }
    function kr(e, t, n) {
        var r = -1, i = e.length - n, s;
        t.lineStart();
        while (++r < i)
            s = e[r], t.point(s[0], s[1], s[2]);
        t.lineEnd()
    }
    function Lr(e, t) {
        var n = -1, r = e.length;
        t.polygonStart();
        while (++n < r)
            kr(e[n], t, 1);
        t.polygonEnd()
    }
    function _r() {
        function s(e, t) {
            e *= Mt, t = t * Mt / 2 + Ct / 4;
            var s = e - n, o = s >= 0 ? 1 : -1, u = o * s, a = Math.cos(t), f = Math.sin(t), l = i * f, c = r * a + l * Math.cos(u), h = l * o * Math.sin(u);
            Or.add(Math.atan2(h, c)), n = e, r = a, i = f
        }
        var e, t, n, r, i;
        Mr.point = function(o, u) {
            Mr.point = s, n = (e = o) * Mt, r = Math.cos(u = (t = u) * Mt / 2 + Ct / 4), i = Math.sin(u)
        }, Mr.lineEnd = function() {
            s(e, t)
        }
    }
    function Dr(e) {
        var t = e[0], n = e[1], r = Math.cos(n);
        return [r * Math.cos(t), r * Math.sin(t), Math.sin(n)]
    }
    function Pr(e, t) {
        return e[0] * t[0] + e[1] * t[1] + e[2] * t[2]
    }
    function Hr(e, t) {
        return [e[1] * t[2] - e[2] * t[1], e[2] * t[0] - e[0] * t[2], e[0] * t[1] - e[1] * t[0]]
    }
    function Br(e, t) {
        e[0] += t[0], e[1] += t[1], e[2] += t[2]
    }
    function jr(e, t) {
        return [e[0] * t, e[1] * t, e[2] * t]
    }
    function Fr(e) {
        var t = Math.sqrt(e[0] * e[0] + e[1] * e[1] + e[2] * e[2]);
        e[0] /= t, e[1] /= t, e[2] /= t
    }
    function Ir(e) {
        return [Math.atan2(e[1], e[0]), Bt(e[2])]
    }
    function qr(e, t) {
        return y(e[0] - t[0]) < At && y(e[1] - t[1]) < At
    }
    function Zr(e, t) {
        e *= Mt;
        var n = Math.cos(t *= Mt);
        ei(n * Math.cos(e), n * Math.sin(e), Math.sin(t))
    }
    function ei(e, t, n) {
        ++Rr, zr += (e - zr) / Rr, Wr += (t - Wr) / Rr, Xr += (n - Xr) / Rr
    }
    function ti() {
        function r(r, i) {
            r *= Mt;
            var s = Math.cos(i *= Mt), o = s * Math.cos(r), u = s * Math.sin(r), a = Math.sin(i), f = Math.atan2(Math.sqrt((f = t * a - n * u) * f + (f = n * o - e * a) * f + (f = e * u - t * o) * f), e * o + t * u + n * a);
            Ur += f, Vr += f * (e + (e = o)), $r += f * (t + (t = u)), Jr += f * (n + (n = a)), ei(e, t, n)
        }
        var e, t, n;
        Yr.point = function(i, s) {
            i *= Mt;
            var o = Math.cos(s *= Mt);
            e = o * Math.cos(i), t = o * Math.sin(i), n = Math.sin(s), Yr.point = r, ei(e, t, n)
        }
    }
    function ni() {
        Yr.point = Zr
    }
    function ri() {
        function s(e, t) {
            e *= Mt;
            var s = Math.cos(t *= Mt), o = s * Math.cos(e), u = s * Math.sin(e), a = Math.sin(t), f = r * a - i * u, l = i * o - n * a, c = n * u - r * o, h = Math.sqrt(f * f + l * l + c * c), p = n * o + r * u + i * a, d = h && -Ht(p) / h, v = Math.atan2(h, p);
            Kr += d * f, Qr += d * l, Gr += d * c, Ur += v, Vr += v * (n + (n = o)), $r += v * (r + (r = u)), Jr += v * (i + (i = a)), ei(n, r, i)
        }
        var e, t, n, r, i;
        Yr.point = function(o, u) {
            e = o, t = u, Yr.point = s, o *= Mt;
            var a = Math.cos(u *= Mt);
            n = a * Math.cos(o), r = a * Math.sin(o), i = Math.sin(u), ei(n, r, i)
        }, Yr.lineEnd = function() {
            s(e, t), Yr.lineEnd = ni, Yr.point = Zr
        }
    }
    function ii() {
        return !0
    }
    function si(e, t, n, r, i) {
        var s = [], o = [];
        e.forEach(function(e) {
            if ((t = e.length - 1) <= 0)
                return;
            var t, n = e[0], r = e[t];
            if (qr(n, r)) {
                i.lineStart();
                for (var u = 0; u < t; ++u)
                    i.point((n = e[u])[0], n[1]);
                i.lineEnd();
                return
            }
            var a = new ui(n, e, null, !0), f = new ui(n, null, a, !1);
            a.o = f, s.push(a), o.push(f), a = new ui(r, e, null, !1), f = new ui(r, null, a, !0), a.o = f, s.push(a), o.push(f)
        }), o.sort(t), oi(s), oi(o);
        if (!s.length)
            return;
        for (var u = 0, a = n, f = o.length; u < f; ++u)
            o[u].e = a = !a;
        var l = s[0], c, h;
        for (; ; ) {
            var p = l, d = !0;
            while (p.v)
                if ((p = p.n) === l)
                    return;
            c = p.z, i.lineStart();
            do {
                p.v = p.o.v = !0;
                if (p.e) {
                    if (d)
                        for (var u = 0, f = c.length; u < f; ++u)
                            i.point((h = c[u])[0], h[1]);
                    else
                        r(p.x, p.n.x, 1, i);
                    p = p.n
                } else {
                    if (d) {
                        c = p.p.z;
                        for (var u = c.length - 1; u >= 0; --u)
                            i.point((h = c[u])[0], h[1])
                    } else
                        r(p.x, p.p.x, -1, i);
                    p = p.p
                }
                p = p.o, c = p.z, d = !d
            } while (!p.v);
            i.lineEnd()
        }
    }
    function oi(e) {
        if (!(t = e.length))
            return;
        var t, n = 0, r = e[0], i;
        while (++n < t)
            r.n = i = e[n], i.p = r, r = i;
        r.n = i = e[0], i.p = r
    }
    function ui(e, t, n, r) {
        this.x = e, this.z = t, this.o = n, this.e = r, this.v = !1, this.n = this.p = null
    }
    function ai(t, n, r, i) {
        return function(s, o) {
            function l(e, n) {
                var r = s(e, n);
                t(e = r[0], n = r[1]) && o.point(e, n)
            }
            function c(e, t) {
                var n = s(e, t);
                u.point(n[0], n[1])
            }
            function h() {
                f.point = c, u.lineStart()
            }
            function p() {
                f.point = l, u.lineEnd()
            }
            function w(e, t) {
                b.push([e, t]);
                var n = s(e, t);
                m.point(n[0], n[1])
            }
            function E() {
                m.lineStart(), b = []
            }
            function S() {
                w(b[0][0], b[0][1]), m.lineEnd();
                var e = m.clean(), t = v.buffer(), n, r = t.length;
                b.pop(), y.push(b), b = null;
                if (!r)
                    return;
                if (e & 1) {
                    n = t[0];
                    var r = n.length - 1, i = -1, s;
                    if (r > 0) {
                        g || (o.polygonStart(), g = !0), o.lineStart();
                        while (++i < r)
                            o.point((s = n[i])[0], s[1]);
                        o.lineEnd()
                    }
                    return
                }
                r > 1 && e & 2 && t.push(t.pop().concat(t.shift())), d.push(t.filter(fi))
            }
            var u = n(o), a = s.invert(i[0], i[1]), f = {point: l,lineStart: h,lineEnd: p,polygonStart: function() {
                    f.point = w, f.lineStart = E, f.lineEnd = S, d = [], y = []
                },polygonEnd: function() {
                    f.point = l, f.lineStart = h, f.lineEnd = p, d = e.merge(d);
                    var t = hi(a, y);
                    d.length ? (g || (o.polygonStart(), g = !0), si(d, ci, t, r, o)) : t && (g || (o.polygonStart(), g = !0), o.lineStart(), r(null, null, 1, o), o.lineEnd()), g && (o.polygonEnd(), g = !1), d = y = null
                },sphere: function() {
                    o.polygonStart(), o.lineStart(), r(null, null, 1, o), o.lineEnd(), o.polygonEnd()
                }}, d, v = li(), m = n(v), g = !1, y, b;
            return f
        }
    }
    function fi(e) {
        return e.length > 1
    }
    function li() {
        var e = [], t;
        return {lineStart: function() {
                e.push(t = [])
            },point: function(e, n) {
                t.push([e, n])
            },lineEnd: D,buffer: function() {
                var n = e;
                return e = [], t = null, n
            },rejoin: function() {
                e.length > 1 && e.push(e.pop().concat(e.shift()))
            }}
    }
    function ci(e, t) {
        return ((e = e.x)[0] < 0 ? e[1] - Lt - At : Lt - e[1]) - ((t = t.x)[0] < 0 ? t[1] - Lt - At : Lt - t[1])
    }
    function hi(e, t) {
        var n = e[0], r = e[1], i = [Math.sin(n), -Math.cos(n), 0], s = 0, o = 0;
        Or.reset();
        for (var u = 0, a = t.length; u < a; ++u) {
            var f = t[u], l = f.length;
            if (!l)
                continue;
            var c = f[0], h = c[0], p = c[1] / 2 + Ct / 4, d = Math.sin(p), v = Math.cos(p), m = 1;
            for (; ; ) {
                m === l && (m = 0), e = f[m];
                var g = e[0], y = e[1] / 2 + Ct / 4, b = Math.sin(y), w = Math.cos(y), E = g - h, S = E >= 0 ? 1 : -1, x = S * E, T = x > Ct, N = d * b;
                Or.add(Math.atan2(N * S * Math.sin(x), v * w + N * Math.cos(x))), s += T ? E + S * kt : E;
                if (T ^ h >= n ^ g >= n) {
                    var C = Hr(Dr(c), Dr(e));
                    Fr(C);
                    var k = Hr(i, C);
                    Fr(k);
                    var L = (T ^ E >= 0 ? -1 : 1) * Bt(k[2]);
                    if (r > L || r === L && (C[0] || C[1]))
                        o += T ^ E >= 0 ? 1 : -1
                }
                if (!(m++))
                    break;
                h = g, d = b, v = w, c = e
            }
        }
        return (s < -At || s < At && Or < 0) ^ o & 1
    }
    function di(e) {
        var t = NaN, n = NaN, r = NaN, i;
        return {lineStart: function() {
                e.lineStart(), i = 1
            },point: function(s, o) {
                var u = s > 0 ? Ct : -Ct, a = y(s - t);
                y(a - Ct) < At ? (e.point(t, n = (n + o) / 2 > 0 ? Lt : -Lt), e.point(r, n), e.lineEnd(), e.lineStart(), e.point(u, n), e.point(s, n), i = 0) : r !== u && a >= Ct && (y(t - r) < At && (t -= r * At), y(s - u) < At && (s -= u * At), n = vi(t, n, s, o), e.point(r, n), e.lineEnd(), e.lineStart(), e.point(u, n), i = 0), e.point(t = s, n = o), r = u
            },lineEnd: function() {
                e.lineEnd(), t = n = NaN
            },clean: function() {
                return 2 - i
            }}
    }
    function vi(e, t, n, r) {
        var i, s, o = Math.sin(e - n);
        return y(o) > At ? Math.atan((Math.sin(t) * (s = Math.cos(r)) * Math.sin(n) - Math.sin(r) * (i = Math.cos(t)) * Math.sin(e)) / (i * s * o)) : (t + r) / 2
    }
    function mi(e, t, n, r) {
        var i;
        if (e == null)
            i = n * Lt, r.point(-Ct, i), r.point(0, i), r.point(Ct, i), r.point(Ct, 0), r.point(Ct, -i), r.point(0, -i), r.point(-Ct, -i), r.point(-Ct, 0), r.point(-Ct, i);
        else if (y(e[0] - t[0]) > At) {
            var s = e[0] < t[0] ? Ct : -Ct;
            i = n * s / 2, r.point(-s, i), r.point(0, i), r.point(s, i)
        } else
            r.point(t[0], t[1])
    }
    function gi(e) {
        function s(e, n) {
            return Math.cos(e) * Math.cos(n) > t
        }
        function o(e) {
            var t, i, o, f, l;
            return {lineStart: function() {
                    f = o = !1, l = 1
                },point: function(c, h) {
                    var p = [c, h], d, v = s(c, h), m = n ? v ? 0 : a(c, h) : v ? a(c + (c < 0 ? Ct : -Ct), h) : 0;
                    !t && (f = o = v) && e.lineStart();
                    if (v !== o) {
                        d = u(t, p);
                        if (qr(t, d) || qr(p, d))
                            p[0] += At, p[1] += At, v = s(p[0], p[1])
                    }
                    if (v !== o)
                        l = 0, v ? (e.lineStart(), d = u(p, t), e.point(d[0], d[1])) : (d = u(t, p), e.point(d[0], d[1]), e.lineEnd()), t = d;
                    else if (r && t && n ^ v) {
                        var g;
                        !(m & i) && (g = u(p, t, !0)) && (l = 0, n ? (e.lineStart(), e.point(g[0][0], g[0][1]), e.point(g[1][0], g[1][1]), e.lineEnd()) : (e.point(g[1][0], g[1][1]), e.lineEnd(), e.lineStart(), e.point(g[0][0], g[0][1])))
                    }
                    v && (!t || !qr(t, p)) && e.point(p[0], p[1]), t = p, o = v, i = m
                },lineEnd: function() {
                    o && e.lineEnd(), t = null
                },clean: function() {
                    return l | (f && o) << 1
                }}
        }
        function u(e, n, r) {
            var i = Dr(e), s = Dr(n), o = [1, 0, 0], u = Hr(i, s), a = Pr(u, u), f = u[0], l = a - f * f;
            if (!l)
                return !r && e;
            var c = t * a / l, h = -t * f / l, p = Hr(o, u), d = jr(o, c), v = jr(u, h);
            Br(d, v);
            var m = p, g = Pr(d, m), b = Pr(m, m), w = g * g - b * (Pr(d, d) - 1);
            if (w < 0)
                return;
            var E = Math.sqrt(w), S = jr(m, (-g - E) / b);
            Br(S, d), S = Ir(S);
            if (!r)
                return S;
            var x = e[0], T = n[0], N = e[1], C = n[1], k;
            T < x && (k = x, x = T, T = k);
            var L = T - x, A = y(L - Ct) < At, O = A || L < At;
            !A && C < N && (k = N, N = C, C = k);
            if (O ? A ? N + C > 0 ^ S[1] < (y(S[0] - x) < At ? N : C) : N <= S[1] && S[1] <= C : L > Ct ^ (x <= S[0] && S[0] <= T)) {
                var M = jr(m, (-g + E) / b);
                return Br(M, d), [S, Ir(M)]
            }
        }
        function a(t, r) {
            var i = n ? e : Ct - e, s = 0;
            return t < -i ? s |= 1 : t > i && (s |= 2), r < -i ? s |= 4 : r > i && (s |= 8), s
        }
        var t = Math.cos(e), n = t > 0, r = y(t) > At, i = ts(e, 6 * Mt);
        return ai(s, o, i, n ? [0, -e] : [-Ct, e - Ct])
    }
    function yi(e, t, n, r) {
        return function(i) {
            var s = i.a, o = i.b, u = s.x, a = s.y, f = o.x, l = o.y, c = 0, h = 1, p = f - u, d = l - a, v;
            v = e - u;
            if (!p && v > 0)
                return;
            v /= p;
            if (p < 0) {
                if (v < c)
                    return;
                v < h && (h = v)
            } else if (p > 0) {
                if (v > h)
                    return;
                v > c && (c = v)
            }
            v = n - u;
            if (!p && v < 0)
                return;
            v /= p;
            if (p < 0) {
                if (v > h)
                    return;
                v > c && (c = v)
            } else if (p > 0) {
                if (v < c)
                    return;
                v < h && (h = v)
            }
            v = t - a;
            if (!d && v > 0)
                return;
            v /= d;
            if (d < 0) {
                if (v < c)
                    return;
                v < h && (h = v)
            } else if (d > 0) {
                if (v > h)
                    return;
                v > c && (c = v)
            }
            v = r - a;
            if (!d && v < 0)
                return;
            v /= d;
            if (d < 0) {
                if (v > h)
                    return;
                v > c && (c = v)
            } else if (d > 0) {
                if (v < c)
                    return;
                v < h && (h = v)
            }
            return c > 0 && (i.a = {x: u + c * p,y: a + c * d}), h < 1 && (i.b = {x: u + h * p,y: a + h * d}), i
        }
    }
    function wi(t, n, r, i) {
        function s(e, i) {
            return y(e[0] - t) < At ? i > 0 ? 0 : 3 : y(e[0] - r) < At ? i > 0 ? 2 : 1 : y(e[1] - n) < At ? i > 0 ? 1 : 0 : i > 0 ? 3 : 2
        }
        function o(e, t) {
            return u(e.x, t.x)
        }
        function u(e, t) {
            var n = s(e, 1), r = s(t, 1);
            return n !== r ? n - r : n === 0 ? t[1] - e[1] : n === 1 ? e[0] - t[0] : n === 2 ? e[1] - t[1] : t[0] - e[0]
        }
        return function(a) {
            function m(e) {
                var t = 0, n = p.length, r = e[1];
                for (var i = 0; i < n; ++i)
                    for (var s = 1, o = p[i], u = o.length, a = o[0], f; s < u; ++s)
                        f = o[s], a[1] <= r ? f[1] > r && Pt(a, f, e) > 0 && ++t : f[1] <= r && Pt(a, f, e) < 0 && --t, a = f;
                return t !== 0
            }
            function g(e, o, a, f) {
                var l = 0, c = 0;
                if (e == null || (l = s(e, a)) !== (c = s(o, a)) || u(e, o) < 0 ^ a > 0) {
                    do
                        f.point(l === 0 || l === 3 ? t : r, l > 1 ? i : n);
                    while ((l = (l + a + 4) % 4) !== c)
                } else
                    f.point(o[0], o[1])
            }
            function y(e, s) {
                return t <= e && e <= r && n <= s && s <= i
            }
            function b(e, t) {
                y(e, t) && a.point(e, t)
            }
            function L() {
                v.point = O, p && p.push(d = []), C = !0, N = !1, x = T = NaN
            }
            function A() {
                h && (O(w, E), S && N && l.rejoin(), h.push(l.buffer())), v.point = b, N && a.lineEnd()
            }
            function O(e, t) {
                e = Math.max(-bi, Math.min(bi, e)), t = Math.max(-bi, Math.min(bi, t));
                var n = y(e, t);
                p && d.push([e, t]);
                if (C)
                    w = e, E = t, S = n, C = !1, n && (a.lineStart(), a.point(e, t));
                else if (n && N)
                    a.point(e, t);
                else {
                    var r = {a: {x: x,y: T},b: {x: e,y: t}};
                    c(r) ? (N || (a.lineStart(), a.point(r.a.x, r.a.y)), a.point(r.b.x, r.b.y), n || a.lineEnd(), k = !1) : n && (a.lineStart(), a.point(e, t), k = !1)
                }
                x = e, T = t, N = n
            }
            var f = a, l = li(), c = yi(t, n, r, i), h, p, d, v = {point: b,lineStart: L,lineEnd: A,polygonStart: function() {
                    a = l, h = [], p = [], k = !0
                },polygonEnd: function() {
                    a = f, h = e.merge(h);
                    var n = m([t, i]), r = k && n, s = h.length;
                    if (r || s)
                        a.polygonStart(), r && (a.lineStart(), g(null, null, 1, a), a.lineEnd()), s && si(h, o, n, g, a), a.polygonEnd();
                    h = p = d = null
                }}, w, E, S, x, T, N, C, k;
            return v
        }
    }
    function Ei(e, t) {
        function n(n, r) {
            return n = e(n, r), t(n[0], n[1])
        }
        return e.invert && t.invert && (n.invert = function(n, r) {
            return n = t.invert(n, r), n && e.invert(n[0], n[1])
        }), n
    }
    function Si(e) {
        var t = 0, n = Ct / 3, r = $i(e), i = r(t, n);
        return i.parallels = function(e) {
            return arguments.length ? r(t = e[0] * Ct / 180, n = e[1] * Ct / 180) : [t / Ct * 180, n / Ct * 180]
        }, i
    }
    function xi(e, t) {
        function o(e, t) {
            var n = Math.sqrt(i - 2 * r * Math.sin(t)) / r;
            return [n * Math.sin(e *= r), s - n * Math.cos(e)]
        }
        var n = Math.sin(e), r = (n + Math.sin(t)) / 2, i = 1 + n * (2 * r - n), s = Math.sqrt(i) / r;
        return o.invert = function(e, t) {
            var n = s - t;
            return [Math.atan2(e, n) / r, Bt((i - (e * e + n * n) * r * r) / (2 * r))]
        }, o
    }
    function ki() {
        function i(e, t) {
            Ni += r * e - n * t, n = e, r = t
        }
        var e, t, n, r;
        Ci.point = function(s, o) {
            Ci.point = i, e = n = s, t = r = o
        }, Ci.lineEnd = function() {
            i(e, t)
        }
    }
    function Di(e, t) {
        e < Li && (Li = e), e > Oi && (Oi = e), t < Ai && (Ai = t), t > Mi && (Mi = t)
    }
    function Pi() {
        function r(n, r) {
            t.push("M", n, ",", r, e)
        }
        function i(e, r) {
            t.push("M", e, ",", r), n.point = s
        }
        function s(e, n) {
            t.push("L", e, ",", n)
        }
        function o() {
            n.point = r
        }
        function u() {
            t.push("Z")
        }
        var e = Hi(4.5), t = [], n = {point: r,lineStart: function() {
                n.point = i
            },lineEnd: o,polygonStart: function() {
                n.lineEnd = u
            },polygonEnd: function() {
                n.lineEnd = o, n.point = r
            },pointRadius: function(t) {
                return e = Hi(t), n
            },result: function() {
                if (t.length) {
                    var e = t.join("");
                    return t = [], e
                }
            }};
        return n
    }
    function Hi(e) {
        return "m0," + e + "a" + e + "," + e + " 0 1,1 0," + -2 * e + "a" + e + "," + e + " 0 1,1 0," + 2 * e + "z"
    }
    function ji(e, t) {
        zr += e, Wr += t, ++Xr
    }
    function Fi() {
        function n(n, r) {
            var i = n - e, s = r - t, o = Math.sqrt(i * i + s * s);
            Vr += o * (e + n) / 2, $r += o * (t + r) / 2, Jr += o, ji(e = n, t = r)
        }
        var e, t;
        Bi.point = function(r, i) {
            Bi.point = n, ji(e = r, t = i)
        }
    }
    function Ii() {
        Bi.point = ji
    }
    function qi() {
        function i(e, t) {
            var i = e - n, s = t - r, o = Math.sqrt(i * i + s * s);
            Vr += o * (n + e) / 2, $r += o * (r + t) / 2, Jr += o, o = r * e - n * t, Kr += o * (n + e), Qr += o * (r + t), Gr += o * 3, ji(n = e, r = t)
        }
        var e, t, n, r;
        Bi.point = function(s, o) {
            Bi.point = i, ji(e = n = s, t = r = o)
        }, Bi.lineEnd = function() {
            i(e, t)
        }
    }
    function Ri(e) {
        function r(n, r) {
            e.moveTo(n, r), e.arc(n, r, t, 0, kt)
        }
        function i(t, r) {
            e.moveTo(t, r), n.point = s
        }
        function s(t, n) {
            e.lineTo(t, n)
        }
        function o() {
            n.point = r
        }
        function u() {
            e.closePath()
        }
        var t = 4.5, n = {point: r,lineStart: function() {
                n.point = i
            },lineEnd: o,polygonStart: function() {
                n.lineEnd = u
            },polygonEnd: function() {
                n.lineEnd = o, n.point = r
            },pointRadius: function(e) {
                return t = e, n
            },result: D};
        return n
    }
    function Ui(e) {
        function i(e) {
            return (r ? o : s)(e)
        }
        function s(t) {
            return Xi(t, function(n, r) {
                n = e(n, r), t.point(n[0], n[1])
            })
        }
        function o(t) {
            function y(n, r) {
                n = e(n, r), t.point(n[0], n[1])
            }
            function b() {
                h = NaN, g.point = w, t.lineStart()
            }
            function w(n, i) {
                var s = Dr([n, i]), o = e(n, i);
                u(h, p, c, d, v, m, h = o[0], p = o[1], c = n, d = s[0], v = s[1], m = s[2], r, t), t.point(h, p)
            }
            function E() {
                g.point = y, t.lineEnd()
            }
            function S() {
                b(), g.point = x, g.lineEnd = T
            }
            function x(e, t) {
                w(n = e, i = t), s = h, o = p, a = d, f = v, l = m, g.point = w
            }
            function T() {
                u(h, p, c, d, v, m, s, o, n, a, f, l, r, t), g.lineEnd = E, E()
            }
            var n, i, s, o, a, f, l, c, h, p, d, v, m, g = {point: y,lineStart: b,lineEnd: E,polygonStart: function() {
                    t.polygonStart(), g.lineStart = S
                },polygonEnd: function() {
                    t.polygonEnd(), g.lineStart = b
                }};
            return g
        }
        function u(r, i, s, o, a, f, l, c, h, p, d, v, m, g) {
            var b = l - r, w = c - i, E = b * b + w * w;
            if (E > 4 * t && m--) {
                var S = o + p, x = a + d, T = f + v, N = Math.sqrt(S * S + x * x + T * T), C = Math.asin(T /= N), k = y(y(T) - 1) < At || y(s - h) < At ? (s + h) / 2 : Math.atan2(x, S), L = e(k, C), A = L[0], O = L[1], M = A - r, _ = O - i, D = w * M - b * _;
                if (D * D / E > t || y((b * M + w * _) / E - .5) > .3 || o * p + a * d + f * v < n)
                    u(r, i, s, o, a, f, A, O, k, S /= N, x /= N, T, m, g), g.point(A, O), u(A, O, k, S, x, T, l, c, h, p, d, v, m, g)
            }
        }
        var t = .5, n = Math.cos(30 * Mt), r = 16;
        return i.precision = function(e) {
            return arguments.length ? (r = (t = e * e) > 0 && 16, i) : Math.sqrt(t)
        }, i
    }
    function zi(e) {
        var t = Ui(function(t, n) {
            return e([t * _t, n * _t])
        });
        return function(e) {
            return Ji(t(e))
        }
    }
    function Wi(e) {
        this.stream = e
    }
    function Xi(e, t) {
        return {point: t,sphere: function() {
                e.sphere()
            },lineStart: function() {
                e.lineStart()
            },lineEnd: function() {
                e.lineEnd()
            },polygonStart: function() {
                e.polygonStart()
            },polygonEnd: function() {
                e.polygonEnd()
            }}
    }
    function Vi(e) {
        return $i(function() {
            return e
        })()
    }
    function $i(t) {
        function E(e) {
            return e = i(e[0] * Mt, e[1] * Mt), [e[0] * o + d, v - e[1] * o]
        }
        function S(e) {
            return e = i.invert((e[0] - d) / o, (v - e[1]) / o), e && [e[0] * _t, e[1] * _t]
        }
        function x() {
            i = Ei(r = Gi(c, h, p), n);
            var e = n(f, l);
            return d = u - e[0] * o, v = a + e[1] * o, T()
        }
        function T() {
            return w && (w.valid = !1, w = null), E
        }
        var n, r, i, s = Ui(function(e, t) {
            return e = n(e, t), [e[0] * o + d, v - e[1] * o]
        }), o = 150, u = 480, a = 250, f = 0, l = 0, c = 0, h = 0, p = 0, d, v, m = pi, g = Tn, y = null, b = null, w;
        return E.stream = function(e) {
            return w && (w.valid = !1), w = Ji(m(r, s(g(e)))), w.valid = !0, w
        }, E.clipAngle = function(e) {
            return arguments.length ? (m = e == null ? (y = e, pi) : gi((y = +e) * Mt), T()) : y
        }, E.clipExtent = function(e) {
            return arguments.length ? (b = e, g = e ? wi(e[0][0], e[0][1], e[1][0], e[1][1]) : Tn, T()) : b
        }, E.scale = function(e) {
            return arguments.length ? (o = +e, x()) : o
        }, E.translate = function(e) {
            return arguments.length ? (u = +e[0], a = +e[1], x()) : [u, a]
        }, E.center = function(e) {
            return arguments.length ? (f = e[0] % 360 * Mt, l = e[1] % 360 * Mt, x()) : [f * _t, l * _t]
        }, E.rotate = function(e) {
            return arguments.length ? (c = e[0] % 360 * Mt, h = e[1] % 360 * Mt, p = e.length > 2 ? e[2] % 360 * Mt : 0, x()) : [c * _t, h * _t, p * _t]
        }, e.rebind(E, s, "precision"), function() {
            return n = t.apply(this, arguments), E.invert = n.invert && S, x()
        }
    }
    function Ji(e) {
        return Xi(e, function(t, n) {
            e.point(t * Mt, n * Mt)
        })
    }
    function Ki(e, t) {
        return [e, t]
    }
    function Qi(e, t) {
        return [e > Ct ? e - kt : e < -Ct ? e + kt : e, t]
    }
    function Gi(e, t, n) {
        return e ? t || n ? Ei(Zi(e), es(t, n)) : Zi(e) : t || n ? es(t, n) : Qi
    }
    function Yi(e) {
        return function(t, n) {
            return t += e, [t > Ct ? t - kt : t < -Ct ? t + kt : t, n]
        }
    }
    function Zi(e) {
        var t = Yi(e);
        return t.invert = Yi(-e), t
    }
    function es(e, t) {
        function o(e, t) {
            var o = Math.cos(t), u = Math.cos(e) * o, a = Math.sin(e) * o, f = Math.sin(t), l = f * n + u * r;
            return [Math.atan2(a * i - l * s, u * n - f * r), Bt(l * i + a * s)]
        }
        var n = Math.cos(e), r = Math.sin(e), i = Math.cos(t), s = Math.sin(t);
        return o.invert = function(e, t) {
            var o = Math.cos(t), u = Math.cos(e) * o, a = Math.sin(e) * o, f = Math.sin(t), l = f * i - a * s;
            return [Math.atan2(a * i + f * s, u * n + l * r), Bt(l * n - u * r)]
        }, o
    }
    function ts(e, t) {
        var n = Math.cos(e), r = Math.sin(e);
        return function(i, s, o, u) {
            var a = o * t;
            if (i != null) {
                i = ns(n, i), s = ns(n, s);
                if (o > 0 ? i < s : i > s)
                    i += o * kt
            } else
                i = e + o * kt, s = e - .5 * a;
            for (var f, l = i; o > 0 ? l > s : l < s; l -= a)
                u.point((f = Ir([n, -r * Math.cos(l), -r * Math.sin(l)]))[0], f[1])
        }
    }
    function ns(e, t) {
        var n = Dr(t);
        n[0] -= e, Fr(n);
        var r = Ht(-n[1]);
        return ((-n[2] < 0 ? -r : r) + 2 * Math.PI - At) % (2 * Math.PI)
    }
    function rs(t, n, r) {
        var i = e.range(t, n - At, r).concat(n);
        return function(e) {
            return i.map(function(t) {
                return [e, t]
            })
        }
    }
    function is(t, n, r) {
        var i = e.range(t, n - At, r).concat(n);
        return function(e) {
            return i.map(function(t) {
                return [t, e]
            })
        }
    }
    function ss(e) {
        return e.source
    }
    function os(e) {
        return e.target
    }
    function us(e, t, n, r) {
        var i = Math.cos(t), s = Math.sin(t), o = Math.cos(r), u = Math.sin(r), a = i * Math.cos(e), f = i * Math.sin(e), l = o * Math.cos(n), c = o * Math.sin(n), h = 2 * Math.asin(Math.sqrt(qt(r - t) + i * o * qt(n - e))), p = 1 / Math.sin(h), d = h ? function(e) {
            var t = Math.sin(e *= h) * p, n = Math.sin(h - e) * p, r = n * a + t * l, i = n * f + t * c, o = n * s + t * u;
            return [Math.atan2(i, r) * _t, Math.atan2(o, Math.sqrt(r * r + i * i)) * _t]
        } : function() {
            return [e * _t, t * _t]
        };
        return d.distance = h, d
    }
    function ls() {
        function r(r, i) {
            var s = Math.sin(i *= Mt), o = Math.cos(i), u = y((r *= Mt) - e), a = Math.cos(u);
            as += Math.atan2(Math.sqrt((u = o * Math.sin(u)) * u + (u = n * s - t * o * a) * u), t * s + n * o * a), e = r, t = s, n = o
        }
        var e, t, n;
        fs.point = function(i, s) {
            e = i * Mt, t = Math.sin(s *= Mt), n = Math.cos(s), fs.point = r
        }, fs.lineEnd = function() {
            fs.point = fs.lineEnd = D
        }
    }
    function cs(e, t) {
        function n(t, n) {
            var r = Math.cos(t), i = Math.cos(n), s = e(r * i);
            return [s * i * Math.sin(t), s * Math.sin(n)]
        }
        return n.invert = function(e, n) {
            var r = Math.sqrt(e * e + n * n), i = t(r), s = Math.sin(i), o = Math.cos(i);
            return [Math.atan2(e * s, r * o), Math.asin(r && n * s / r)]
        }, n
    }
    function ds(e, t) {
        function o(e, t) {
            s > 0 ? t < -Lt + At && (t = -Lt + At) : t > Lt - At && (t = Lt - At);
            var n = s / Math.pow(r(t), i);
            return [n * Math.sin(i * e), s - n * Math.cos(i * e)]
        }
        var n = Math.cos(e), r = function(e) {
            return Math.tan(Ct / 4 + e / 2)
        }, i = e === t ? Math.sin(e) : Math.log(n / Math.cos(t)) / Math.log(r(t) / r(e)), s = n * Math.pow(r(e), i) / i;
        return i ? (o.invert = function(e, t) {
            var n = s - t, r = Dt(i) * Math.sqrt(e * e + n * n);
            return [Math.atan2(e, n) / i, 2 * Math.atan(Math.pow(s / r, 1 / i)) - Lt]
        }, o) : gs
    }
    function vs(e, t) {
        function s(e, t) {
            var n = i - t;
            return [n * Math.sin(r * e), i - n * Math.cos(r * e)]
        }
        var n = Math.cos(e), r = e === t ? Math.sin(e) : (n - Math.cos(t)) / (t - e), i = n / r + e;
        return y(r) < At ? Ki : (s.invert = function(e, t) {
            var n = i - t;
            return [Math.atan2(e, n) / r, i - Dt(r) * Math.sqrt(e * e + n * n)]
        }, s)
    }
    function gs(e, t) {
        return [e, Math.log(Math.tan(Ct / 4 + t / 2))]
    }
    function ys(e) {
        var t = Vi(e), n = t.scale, r = t.translate, i = t.clipExtent, s;
        return t.scale = function() {
            var e = n.apply(t, arguments);
            return e === t ? s ? t.clipExtent(null) : t : e
        }, t.translate = function() {
            var e = r.apply(t, arguments);
            return e === t ? s ? t.clipExtent(null) : t : e
        }, t.clipExtent = function(e) {
            var o = i.apply(t, arguments);
            if (o === t) {
                if (s = e == null) {
                    var u = Ct * n(), a = r();
                    i([[a[0] - u, a[1] - u], [a[0] + u, a[1] + u]])
                }
            } else
                s && (o = null);
            return o
        }, t.clipExtent(null)
    }
    function Es(e, t) {
        return [Math.log(Math.tan(Ct / 4 + t / 2)), -e]
    }
    function Ss(e) {
        return e[0]
    }
    function xs(e) {
        return e[1]
    }
    function Ts(e) {
        var t = e.length, n = [0, 1], r = 2;
        for (var i = 2; i < t; i++) {
            while (r > 1 && Pt(e[n[r - 2]], e[n[r - 1]], e[i]) <= 0)
                --r;
            n[r++] = i
        }
        return n.slice(0, r)
    }
    function Ns(e, t) {
        return e[0] - t[0] || e[1] - t[1]
    }
    function ks(e, t, n) {
        return (n[0] - t[0]) * (e[1] - t[1]) < (n[1] - t[1]) * (e[0] - t[0])
    }
    function Ls(e, t, n, r) {
        var i = e[0], s = n[0], o = t[0] - i, u = r[0] - s, a = e[1], f = n[1], l = t[1] - a, c = r[1] - f, h = (u * (a - f) - c * (i - s)) / (c * o - u * l);
        return [i + h * o, a + h * l]
    }
    function As(e) {
        var t = e[0], n = e[e.length - 1];
        return !(t[0] - n[0] || t[1] - n[1])
    }
    function js() {
        io(this), this.edge = this.site = this.circle = null
    }
    function Fs(e) {
        var t = Ds.pop() || new js;
        return t.site = e, t
    }
    function Is(e) {
        Ks(e), _s.remove(e), Ds.push(e), io(e)
    }
    function qs(e) {
        var t = e.circle, n = t.x, r = t.cy, i = {x: n,y: r}, s = e.P, o = e.N, u = [e];
        Is(e);
        var a = s;
        while (a.circle && y(n - a.circle.x) < At && y(r - a.circle.cy) < At)
            s = a.P, u.unshift(a), Is(a), a = s;
        u.unshift(a), Ks(a);
        var f = o;
        while (f.circle && y(n - f.circle.x) < At && y(r - f.circle.cy) < At)
            o = f.N, u.push(f), Is(f), f = o;
        u.push(f), Ks(f);
        var l = u.length, c;
        for (c = 1; c < l; ++c)
            f = u[c], a = u[c - 1], to(f.edge, a.site, f.site, i);
        a = u[0], f = u[l - 1], f.edge = Zs(a.site, f.site, null, i), Js(a), Js(f)
    }
    function Rs(e) {
        var t = e.x, n = e.y, r, i, s, o, u = _s._;
        while (u) {
            s = Us(u, n) - t;
            if (s > At)
                u = u.L;
            else {
                o = t - zs(u, n);
                if (!(o > At)) {
                    s > -At ? (r = u.P, i = u) : o > -At ? (r = u, i = u.N) : r = i = u;
                    break
                }
                if (!u.R) {
                    r = u;
                    break
                }
                u = u.R
            }
        }
        var a = Fs(e);
        _s.insert(r, a);
        if (!r && !i)
            return;
        if (r === i) {
            Ks(r), i = Fs(r.site), _s.insert(a, i), a.edge = i.edge = Zs(r.site, a.site), Js(r), Js(i);
            return
        }
        if (!i) {
            a.edge = Zs(r.site, a.site);
            return
        }
        Ks(r), Ks(i);
        var f = r.site, l = f.x, c = f.y, h = e.x - l, p = e.y - c, d = i.site, v = d.x - l, m = d.y - c, g = 2 * (h * m - p * v), y = h * h + p * p, b = v * v + m * m, w = {x: (m * y - p * b) / g + l,y: (h * b - v * y) / g + c};
        to(i.edge, f, d, w), a.edge = Zs(f, e, null, w), i.edge = Zs(e, d, null, w), Js(r), Js(i)
    }
    function Us(e, t) {
        var n = e.site, r = n.x, i = n.y, s = i - t;
        if (!s)
            return r;
        var o = e.P;
        if (!o)
            return -Infinity;
        n = o.site;
        var u = n.x, a = n.y, f = a - t;
        if (!f)
            return u;
        var l = u - r, c = 1 / s - 1 / f, h = l / f;
        return c ? (-h + Math.sqrt(h * h - 2 * c * (l * l / (-2 * f) - a + f / 2 + i - s / 2))) / c + r : (r + u) / 2
    }
    function zs(e, t) {
        var n = e.N;
        if (n)
            return Us(n, t);
        var r = e.site;
        return r.y === t ? r.x : Infinity
    }
    function Ws(e) {
        this.site = e, this.edges = []
    }
    function Xs(e) {
        var t = e[0][0], n = e[1][0], r = e[0][1], i = e[1][1], s, o, u, a, f = Ms, l = f.length, c, h, p, d, v, m;
        while (l--) {
            c = f[l];
            if (!c || !c.prepare())
                continue;
            p = c.edges, d = p.length, h = 0;
            while (h < d) {
                m = p[h].end(), u = m.x, a = m.y, v = p[++h % d].start(), s = v.x, o = v.y;
                if (y(u - s) > At || y(a - o) > At)
                    p.splice(h, 0, new no(eo(c.site, m, y(u - t) < At && i - a > At ? {x: t,y: y(s - t) < At ? o : i} : y(a - i) < At && n - u > At ? {x: y(o - i) < At ? s : n,y: i} : y(u - n) < At && a - r > At ? {x: n,y: y(s - n) < At ? o : r} : y(a - r) < At && u - t > At ? {x: y(o - r) < At ? s : t,y: r} : null), c.site, null)), ++d
            }
        }
    }
    function Vs(e, t) {
        return t.angle - e.angle
    }
    function $s() {
        io(this), this.x = this.y = this.arc = this.site = this.cy = null
    }
    function Js(e) {
        var t = e.P, n = e.N;
        if (!t || !n)
            return;
        var r = t.site, i = e.site, s = n.site;
        if (r === s)
            return;
        var o = i.x, u = i.y, a = r.x - o, f = r.y - u, l = s.x - o, c = s.y - u, h = 2 * (a * c - f * l);
        if (h >= -Ot)
            return;
        var p = a * a + f * f, d = l * l + c * c, v = (c * p - f * d) / h, m = (a * d - l * p) / h, c = m + u, g = Bs.pop() || new $s;
        g.arc = e, g.site = i, g.x = v + o, g.y = c + Math.sqrt(v * v + m * m), g.cy = c, e.circle = g;
        var y = null, b = Hs._;
        while (b)
            if (g.y < b.y || g.y === b.y && g.x <= b.x) {
                if (!b.L) {
                    y = b.P;
                    break
                }
                b = b.L
            } else {
                if (!b.R) {
                    y = b;
                    break
                }
                b = b.R
            }
        Hs.insert(y, g), y || (Ps = g)
    }
    function Ks(e) {
        var t = e.circle;
        t && (t.P || (Ps = t.N), Hs.remove(t), Bs.push(t), io(t), e.circle = null)
    }
    function Qs(e) {
        var t = Os, n = yi(e[0][0], e[0][1], e[1][0], e[1][1]), r = t.length, i;
        while (r--) {
            i = t[r];
            if (!Gs(i, e) || !n(i) || y(i.a.x - i.b.x) < At && y(i.a.y - i.b.y) < At)
                i.a = i.b = null, t.splice(r, 1)
        }
    }
    function Gs(e, t) {
        var n = e.b;
        if (n)
            return !0;
        var r = e.a, i = t[0][0], s = t[1][0], o = t[0][1], u = t[1][1], a = e.l, f = e.r, l = a.x, c = a.y, h = f.x, p = f.y, d = (l + h) / 2, v = (c + p) / 2, m, g;
        if (p === c) {
            if (d < i || d >= s)
                return;
            if (l > h) {
                if (!r)
                    r = {x: d,y: o};
                else if (r.y >= u)
                    return;
                n = {x: d,y: u}
            } else {
                if (!r)
                    r = {x: d,y: u};
                else if (r.y < o)
                    return;
                n = {x: d,y: o}
            }
        } else {
            m = (l - h) / (p - c), g = v - m * d;
            if (m < -1 || m > 1)
                if (l > h) {
                    if (!r)
                        r = {x: (o - g) / m,y: o};
                    else if (r.y >= u)
                        return;
                    n = {x: (u - g) / m,y: u}
                } else {
                    if (!r)
                        r = {x: (u - g) / m,y: u};
                    else if (r.y < o)
                        return;
                    n = {x: (o - g) / m,y: o}
                }
            else if (c < p) {
                if (!r)
                    r = {x: i,y: m * i + g};
                else if (r.x >= s)
                    return;
                n = {x: s,y: m * s + g}
            } else {
                if (!r)
                    r = {x: s,y: m * s + g};
                else if (r.x < i)
                    return;
                n = {x: i,y: m * i + g}
            }
        }
        return e.a = r, e.b = n, !0
    }
    function Ys(e, t) {
        this.l = e, this.r = t, this.a = this.b = null
    }
    function Zs(e, t, n, r) {
        var i = new Ys(e, t);
        return Os.push(i), n && to(i, e, t, n), r && to(i, t, e, r), Ms[e.i].edges.push(new no(i, e, t)), Ms[t.i].edges.push(new no(i, t, e)), i
    }
    function eo(e, t, n) {
        var r = new Ys(e, null);
        return r.a = t, r.b = n, Os.push(r), r
    }
    function to(e, t, n, r) {
        !e.a && !e.b ? (e.a = r, e.l = t, e.r = n) : e.l === n ? e.b = r : e.a = r
    }
    function no(e, t, n) {
        var r = e.a, i = e.b;
        this.edge = e, this.site = t, this.angle = n ? Math.atan2(n.y - t.y, n.x - t.x) : e.l === t ? Math.atan2(i.x - r.x, r.y - i.y) : Math.atan2(r.x - i.x, i.y - r.y)
    }
    function ro() {
        this._ = null
    }
    function io(e) {
        e.U = e.C = e.L = e.R = e.P = e.N = null
    }
    function so(e, t) {
        var n = t, r = t.R, i = n.U;
        i ? i.L === n ? i.L = r : i.R = r : e._ = r, r.U = i, n.U = r, n.R = r.L, n.R && (n.R.U = n), r.L = n
    }
    function oo(e, t) {
        var n = t, r = t.L, i = n.U;
        i ? i.L === n ? i.L = r : i.R = r : e._ = r, r.U = i, n.U = r, n.L = r.R, n.L && (n.L.U = n), r.R = n
    }
    function uo(e) {
        while (e.L)
            e = e.L;
        return e
    }
    function ao(e, t) {
        var n = e.sort(fo).pop(), r, i, s;
        Os = [], Ms = new Array(e.length), _s = new ro, Hs = new ro;
        for (; ; ) {
            s = Ps;
            if (n && (!s || n.y < s.y || n.y === s.y && n.x < s.x)) {
                if (n.x !== r || n.y !== i)
                    Ms[n.i] = new Ws(n), Rs(n), r = n.x, i = n.y;
                n = e.pop()
            } else {
                if (!s)
                    break;
                qs(s.arc)
            }
        }
        t && (Qs(t), Xs(t));
        var o = {cells: Ms,edges: Os};
        return _s = Hs = Os = Ms = null, o
    }
    function fo(e, t) {
        return t.y - e.y || t.x - e.x
    }
    function co(e, t, n) {
        return (e.x - n.x) * (t.y - e.y) - (e.x - t.x) * (n.y - e.y)
    }
    function ho(e) {
        return e.x
    }
    function po(e) {
        return e.y
    }
    function vo() {
        return {leaf: !0,nodes: [],point: null,x: null,y: null}
    }
    function mo(e, t, n, r, i, s) {
        if (!e(t, n, r, i, s)) {
            var o = (n + i) * .5, u = (r + s) * .5, a = t.nodes;
            a[0] && mo(e, a[0], n, r, o, u), a[1] && mo(e, a[1], o, r, i, u), a[2] && mo(e, a[2], n, u, o, s), a[3] && mo(e, a[3], o, u, i, s)
        }
    }
    function go(t, n) {
        t = e.rgb(t), n = e.rgb(n);
        var r = t.r, i = t.g, s = t.b, o = n.r - r, u = n.g - i, a = n.b - s;
        return function(e) {
            return "#" + mn(Math.round(r + o * e)) + mn(Math.round(i + u * e)) + mn(Math.round(s + a * e))
        }
    }
    function yo(e, t) {
        var n = {}, r = {}, i;
        for (i in e)
            i in t ? n[i] = xo(e[i], t[i]) : r[i] = e[i];
        for (i in t)
            i in e || (r[i] = t[i]);
        return function(e) {
            for (i in n)
                r[i] = n[i](e);
            return r
        }
    }
    function bo(e, t) {
        return t -= e = +e, function(n) {
            return e + t * n
        }
    }
    function wo(e, t) {
        var n = Eo.lastIndex = So.lastIndex = 0, r, i, s, o = -1, u = [], a = [];
        e += "", t += "";
        while ((r = Eo.exec(e)) && (i = So.exec(t)))
            (s = i.index) > n && (s = t.substring(n, s), u[o] ? u[o] += s : u[++o] = s), (r = r[0]) === (i = i[0]) ? u[o] ? u[o] += i : u[++o] = i : (u[++o] = null, a.push({i: o,x: bo(r, i)})), n = So.lastIndex;
        return n < t.length && (s = t.substring(n), u[o] ? u[o] += s : u[++o] = s), u.length < 2 ? a[0] ? (t = a[0].x, function(e) {
            return t(e) + ""
        }) : function() {
            return t
        } : (t = a.length, function(e) {
            for (var n = 0, r; n < t; ++n)
                u[(r = a[n]).i] = r.x(e);
            return u.join("")
        })
    }
    function xo(t, n) {
        var r = e.interpolators.length, i;
        while (--r >= 0 && !(i = e.interpolators[r](t, n)))
            ;
        return i
    }
    function To(e, t) {
        var n = [], r = [], i = e.length, s = t.length, o = Math.min(e.length, t.length), u;
        for (u = 0; u < o; ++u)
            n.push(xo(e[u], t[u]));
        for (; u < i; ++u)
            r[u] = e[u];
        for (; u < s; ++u)
            r[u] = t[u];
        return function(e) {
            for (u = 0; u < o; ++u)
                r[u] = n[u](e);
            return r
        }
    }
    function Lo(e) {
        return function(t) {
            return t <= 0 ? 0 : t >= 1 ? 1 : e(t)
        }
    }
    function Ao(e) {
        return function(t) {
            return 1 - e(1 - t)
        }
    }
    function Oo(e) {
        return function(t) {
            return .5 * (t < .5 ? e(2 * t) : 2 - e(2 - 2 * t))
        }
    }
    function Mo(e) {
        return e * e
    }
    function _o(e) {
        return e * e * e
    }
    function Do(e) {
        if (e <= 0)
            return 0;
        if (e >= 1)
            return 1;
        var t = e * e, n = t * e;
        return 4 * (e < .5 ? n : 3 * (e - t) + n - .75)
    }
    function Po(e) {
        return function(t) {
            return Math.pow(t, e)
        }
    }
    function Ho(e) {
        return 1 - Math.cos(e * Lt)
    }
    function Bo(e) {
        return Math.pow(2, 10 * (e - 1))
    }
    function jo(e) {
        return 1 - Math.sqrt(1 - e * e)
    }
    function Fo(e, t) {
        var n;
        return arguments.length < 2 && (t = .45), arguments.length ? n = t / kt * Math.asin(1 / e) : (e = 1, n = t / 4), function(r) {
            return 1 + e * Math.pow(2, -10 * r) * Math.sin((r - n) * kt / t)
        }
    }
    function Io(e) {
        return e || (e = 1.70158), function(t) {
            return t * t * ((e + 1) * t - e)
        }
    }
    function qo(e) {
        return e < 1 / 2.75 ? 7.5625 * e * e : e < 2 / 2.75 ? 7.5625 * (e -= 1.5 / 2.75) * e + .75 : e < 2.5 / 2.75 ? 7.5625 * (e -= 2.25 / 2.75) * e + .9375 : 7.5625 * (e -= 2.625 / 2.75) * e + .984375
    }
    function Ro(t, n) {
        t = e.hcl(t), n = e.hcl(n);
        var r = t.h, i = t.c, s = t.l, o = n.h - r, u = n.c - i, a = n.l - s;
        return isNaN(u) && (u = 0, i = isNaN(i) ? n.c : i), isNaN(o) ? (o = 0, r = isNaN(r) ? n.h : r) : o > 180 ? o -= 360 : o < -180 && (o += 360), function(e) {
            return Zt(r + o * e, i + u * e, s + a * e) + ""
        }
    }
    function Uo(t, n) {
        t = e.hsl(t), n = e.hsl(n);
        var r = t.h, i = t.s, s = t.l, o = n.h - r, u = n.s - i, a = n.l - s;
        return isNaN(u) && (u = 0, i = isNaN(i) ? n.s : i), isNaN(o) ? (o = 0, r = isNaN(r) ? n.h : r) : o > 180 ? o -= 360 : o < -180 && (o += 360), function(e) {
            return Qt(r + o * e, i + u * e, s + a * e) + ""
        }
    }
    function zo(t, n) {
        t = e.lab(t), n = e.lab(n);
        var r = t.l, i = t.a, s = t.b, o = n.l - r, u = n.a - i, a = n.b - s;
        return function(e) {
            return un(r + o * e, i + u * e, s + a * e) + ""
        }
    }
    function Wo(e, t) {
        return t -= e, function(n) {
            return Math.round(e + t * n)
        }
    }
    function Xo(e) {
        var t = [e.a, e.b], n = [e.c, e.d], r = $o(t), i = Vo(t, n), s = $o(Jo(n, t, -i)) || 0;
        t[0] * n[1] < n[0] * t[1] && (t[0] *= -1, t[1] *= -1, r *= -1, i *= -1), this.rotate = (r ? Math.atan2(t[1], t[0]) : Math.atan2(-n[0], n[1])) * _t, this.translate = [e.e, e.f], this.scale = [r, s], this.skew = s ? Math.atan2(i, s) * _t : 0
    }
    function Vo(e, t) {
        return e[0] * t[0] + e[1] * t[1]
    }
    function $o(e) {
        var t = Math.sqrt(Vo(e, e));
        return t && (e[0] /= t, e[1] /= t), t
    }
    function Jo(e, t, n) {
        return e[0] += n * t[0], e[1] += n * t[1], e
    }
    function Qo(t, n) {
        var r = [], i = [], s, o = e.transform(t), u = e.transform(n), a = o.translate, f = u.translate, l = o.rotate, c = u.rotate, h = o.skew, p = u.skew, d = o.scale, v = u.scale;
        return a[0] != f[0] || a[1] != f[1] ? (r.push("translate(", null, ",", null, ")"), i.push({i: 1,x: bo(a[0], f[0])}, {i: 3,x: bo(a[1], f[1])})) : f[0] || f[1] ? r.push("translate(" + f + ")") : r.push(""), l != c ? (l - c > 180 ? c += 360 : c - l > 180 && (l += 360), i.push({i: r.push(r.pop() + "rotate(", null, ")") - 2,x: bo(l, c)})) : c && r.push(r.pop() + "rotate(" + c + ")"), h != p ? i.push({i: r.push(r.pop() + "skewX(", null, ")") - 2,x: bo(h, p)}) : p && r.push(r.pop() + "skewX(" + p + ")"), d[0] != v[0] || d[1] != v[1] ? (s = r.push(r.pop() + "scale(", null, ",", null, ")"), i.push({i: s - 4,x: bo(d[0], v[0])}, {i: s - 2,x: bo(d[1], v[1])})) : (v[0] != 1 || v[1] != 1) && r.push(r.pop() + "scale(" + v + ")"), s = i.length, function(e) {
            var t = -1, n;
            while (++t < s)
                r[(n = i[t]).i] = n.x(e);
            return r.join("")
        }
    }
    function Go(e, t) {
        return t = t - (e = +e) ? 1 / (t - e) : 0, function(n) {
            return (n - e) * t
        }
    }
    function Yo(e, t) {
        return t = t - (e = +e) ? 1 / (t - e) : 0, function(n) {
            return Math.max(0, Math.min(1, (n - e) * t))
        }
    }
    function Zo(e) {
        var t = e.source, n = e.target, r = tu(t, n), i = [t];
        while (t !== r)
            t = t.parent, i.push(t);
        var s = i.length;
        while (n !== r)
            i.splice(s, 0, n), n = n.parent;
        return i
    }
    function eu(e) {
        var t = [], n = e.parent;
        while (n != null)
            t.push(e), e = n, n = n.parent;
        return t.push(e), t
    }
    function tu(e, t) {
        if (e === t)
            return e;
        var n = eu(e), r = eu(t), i = n.pop(), s = r.pop(), o = null;
        while (i === s)
            o = i, i = n.pop(), s = r.pop();
        return o
    }
    function nu(e) {
        e.fixed |= 2
    }
    function ru(e) {
        e.fixed &= -7
    }
    function iu(e) {
        e.fixed |= 4, e.px = e.x, e.py = e.y
    }
    function su(e) {
        e.fixed &= -5
    }
    function ou(e, t, n) {
        var r = 0, i = 0;
        e.charge = 0;
        if (!e.leaf) {
            var s = e.nodes, o = s.length, u = -1, a;
            while (++u < o) {
                a = s[u];
                if (a == null)
                    continue;
                ou(a, t, n), e.charge += a.charge, r += a.charge * a.cx, i += a.charge * a.cy
            }
        }
        if (e.point) {
            e.leaf || (e.point.x += Math.random() - .5, e.point.y += Math.random() - .5);
            var f = t * n[e.point.index];
            e.charge += e.pointCharge = f, r += f * e.point.x, i += f * e.point.y
        }
        e.cx = r / e.charge, e.cy = i / e.charge
    }
    function lu(t, n) {
        return e.rebind(t, n, "sort", "children", "value"), t.nodes = t, t.links = mu, t
    }
    function cu(e, t) {
        var n = [e];
        while ((e = n.pop()) != null) {
            t(e);
            if ((i = e.children) && (r = i.length)) {
                var r, i;
                while (--r >= 0)
                    n.push(i[r])
            }
        }
    }
    function hu(e, t) {
        var n = [e], r = [];
        while ((e = n.pop()) != null) {
            r.push(e);
            if ((o = e.children) && (s = o.length)) {
                var i = -1, s, o;
                while (++i < s)
                    n.push(o[i])
            }
        }
        while ((e = r.pop()) != null)
            t(e)
    }
    function pu(e) {
        return e.children
    }
    function du(e) {
        return e.value
    }
    function vu(e, t) {
        return t.value - e.value
    }
    function mu(t) {
        return e.merge(t.map(function(e) {
            return (e.children || []).map(function(t) {
                return {source: e,target: t}
            })
        }))
    }
    function yu(e) {
        return e.x
    }
    function bu(e) {
        return e.y
    }
    function wu(e, t, n) {
        e.y0 = t, e.y = n
    }
    function xu(t) {
        return e.range(t.length)
    }
    function Tu(e) {
        var t = -1, n = e[0].length, r = [];
        while (++t < n)
            r[t] = 0;
        return r
    }
    function Nu(e) {
        var t = 1, n = 0, r = e[0][1], i, s = e.length;
        for (; t < s; ++t)
            (i = e[t][1]) > r && (n = t, r = i);
        return n
    }
    function Cu(e) {
        return e.reduce(ku, 0)
    }
    function ku(e, t) {
        return e + t[1]
    }
    function Lu(e, t) {
        return Au(e, Math.ceil(Math.log(t.length) / Math.LN2 + 1))
    }
    function Au(e, t) {
        var n = -1, r = +e[0], i = (e[1] - r) / t, s = [];
        while (++n <= t)
            s[n] = i * n + r;
        return s
    }
    function Ou(t) {
        return [e.min(t), e.max(t)]
    }
    function Mu(e, t) {
        return e.value - t.value
    }
    function _u(e, t) {
        var n = e._pack_next;
        e._pack_next = t, t._pack_prev = e, t._pack_next = n, n._pack_prev = t
    }
    function Du(e, t) {
        e._pack_next = t, t._pack_prev = e
    }
    function Pu(e, t) {
        var n = t.x - e.x, r = t.y - e.y, i = e.r + t.r;
        return .999 * i * i > n * n + r * r
    }
    function Hu(e) {
        function p(e) {
            n = Math.min(e.x - e.r, n), r = Math.max(e.x + e.r, r), i = Math.min(e.y - e.r, i), s = Math.max(e.y + e.r, s)
        }
        if (!(t = e.children) || !(h = t.length))
            return;
        var t, n = Infinity, r = -Infinity, i = Infinity, s = -Infinity, o, u, a, f, l, c, h;
        t.forEach(Bu), o = t[0], o.x = -o.r, o.y = 0, p(o);
        if (h > 1) {
            u = t[1], u.x = u.r, u.y = 0, p(u);
            if (h > 2) {
                a = t[2], Iu(o, u, a), p(a), _u(o, a), o._pack_prev = a, _u(a, u), u = o._pack_next;
                for (f = 3; f < h; f++) {
                    Iu(o, u, a = t[f]);
                    var d = 0, v = 1, m = 1;
                    for (l = u._pack_next; l !== u; l = l._pack_next, v++)
                        if (Pu(l, a)) {
                            d = 1;
                            break
                        }
                    if (d == 1)
                        for (c = o._pack_prev; c !== l._pack_prev; c = c._pack_prev, m++)
                            if (Pu(c, a))
                                break;
                    d ? (v < m || v == m && u.r < o.r ? Du(o, u = l) : Du(o = c, u), f--) : (_u(o, a), u = a, p(a))
                }
            }
        }
        var g = (n + r) / 2, y = (i + s) / 2, b = 0;
        for (f = 0; f < h; f++)
            a = t[f], a.x -= g, a.y -= y, b = Math.max(b, a.r + Math.sqrt(a.x * a.x + a.y * a.y));
        e.r = b, t.forEach(ju)
    }
    function Bu(e) {
        e._pack_next = e._pack_prev = e
    }
    function ju(e) {
        delete e._pack_next, delete e._pack_prev
    }
    function Fu(e, t, n, r) {
        var i = e.children;
        e.x = t += r * e.x, e.y = n += r * e.y, e.r *= r;
        if (i) {
            var s = -1, o = i.length;
            while (++s < o)
                Fu(i[s], t, n, r)
        }
    }
    function Iu(e, t, n) {
        var r = e.r + n.r, i = t.x - e.x, s = t.y - e.y;
        if (r && (i || s)) {
            var o = t.r + n.r, u = i * i + s * s;
            o *= o, r *= r;
            var a = .5 + (r - o) / (2 * u), f = Math.sqrt(Math.max(0, 2 * o * (r + u) - (r -= u) * r - o * o)) / (2 * u);
            n.x = e.x + a * i + f * s, n.y = e.y + a * s - f * i
        } else
            n.x = e.x + r, n.y = e.y
    }
    function qu(e, t) {
        return e.parent == t.parent ? 1 : 2
    }
    function Ru(e) {
        var t = e.children;
        return t.length ? t[0] : e.t
    }
    function Uu(e) {
        var t = e.children, n;
        return (n = t.length) ? t[n - 1] : e.t
    }
    function zu(e, t, n) {
        var r = n / (t.i - e.i);
        t.c -= r, t.s += n, e.c += r, t.z += n, t.m += n
    }
    function Wu(e) {
        var t = 0, n = 0, r = e.children, i = r.length, s;
        while (--i >= 0)
            s = r[i], s.z += t, s.m += t, t += s.s + (n += s.c)
    }
    function Xu(e, t, n) {
        return e.a.parent === t.parent ? e.a : n
    }
    function Vu(t) {
        return 1 + e.max(t, function(e) {
            return e.y
        })
    }
    function $u(e) {
        return e.reduce(function(e, t) {
            return e + t.x
        }, 0) / e.length
    }
    function Ju(e) {
        var t = e.children;
        return t && t.length ? Ju(t[0]) : e
    }
    function Ku(e) {
        var t = e.children, n;
        return t && (n = t.length) ? Ku(t[n - 1]) : e
    }
    function Qu(e) {
        return {x: e.x,y: e.y,dx: e.dx,dy: e.dy}
    }
    function Gu(e, t) {
        var n = e.x + t[3], r = e.y + t[0], i = e.dx - t[1] - t[3], s = e.dy - t[0] - t[2];
        return i < 0 && (n += i / 2, i = 0), s < 0 && (r += s / 2, s = 0), {x: n,y: r,dx: i,dy: s}
    }
    function Yu(e) {
        var t = e[0], n = e[e.length - 1];
        return t < n ? [t, n] : [n, t]
    }
    function Zu(e) {
        return e.rangeExtent ? e.rangeExtent() : Yu(e.range())
    }
    function ea(e, t, n, r) {
        var i = n(e[0], e[1]), s = r(t[0], t[1]);
        return function(e) {
            return s(i(e))
        }
    }
    function ta(e, t) {
        var n = 0, r = e.length - 1, i = e[n], s = e[r], o;
        return s < i && (o = n, n = r, r = o, o = i, i = s, s = o), e[n] = t.floor(i), e[r] = t.ceil(s), e
    }
    function na(e) {
        return e ? {floor: function(t) {
                return Math.floor(t / e) * e
            },ceil: function(t) {
                return Math.ceil(t / e) * e
            }} : ra
    }
    function ia(t, n, r, i) {
        var s = [], o = [], u = 0, a = Math.min(t.length, n.length) - 1;
        t[a] < t[0] && (t = t.slice().reverse(), n = n.slice().reverse());
        while (++u <= a)
            s.push(r(t[u - 1], t[u])), o.push(i(n[u - 1], n[u]));
        return function(n) {
            var r = e.bisect(t, n, 1, a) - 1;
            return o[r](s[r](n))
        }
    }
    function sa(e, t, n, r) {
        function o() {
            var o = Math.min(e.length, t.length) > 2 ? ia : ea, a = r ? Yo : Go;
            return i = o(e, t, a, n), s = o(t, e, a, xo), u
        }
        function u(e) {
            return i(e)
        }
        var i, s;
        return u.invert = function(e) {
            return s(e)
        }, u.domain = function(t) {
            return arguments.length ? (e = t.map(Number), o()) : e
        }, u.range = function(e) {
            return arguments.length ? (t = e, o()) : t
        }, u.rangeRound = function(e) {
            return u.range(e).interpolate(Wo)
        }, u.clamp = function(e) {
            return arguments.length ? (r = e, o()) : r
        }, u.interpolate = function(e) {
            return arguments.length ? (n = e, o()) : n
        }, u.ticks = function(t) {
            return fa(e, t)
        }, u.tickFormat = function(t, n) {
            return la(e, t, n)
        }, u.nice = function(t) {
            return ua(e, t), o()
        }, u.copy = function() {
            return sa(e, t, n, r)
        }, o()
    }
    function oa(t, n) {
        return e.rebind(t, n, "range", "rangeRound", "interpolate", "clamp")
    }
    function ua(e, t) {
        return ta(e, na(aa(e, t)[2]))
    }
    function aa(e, t) {
        t == null && (t = 10);
        var n = Yu(e), r = n[1] - n[0], i = Math.pow(10, Math.floor(Math.log(r / t) / Math.LN10)), s = t / r * i;
        return s <= .15 ? i *= 10 : s <= .35 ? i *= 5 : s <= .75 && (i *= 2), n[0] = Math.ceil(n[0] / i) * i, n[1] = Math.floor(n[1] / i) * i + i * .5, n[2] = i, n
    }
    function fa(t, n) {
        return e.range.apply(e, aa(t, n))
    }
    function la(t, n, r) {
        var i = aa(t, n);
        if (r) {
            var s = Rn.exec(r);
            s.shift();
            if (s[8] === "s") {
                var o = e.formatPrefix(Math.max(y(i[0]), y(i[1])));
                return s[7] || (s[7] = "." + ha(o.scale(i[2]))), s[8] = "f", r = e.format(s.join("")), function(e) {
                    return r(o.scale(e)) + o.symbol
                }
            }
            s[7] || (s[7] = "." + pa(s[8], i)), r = s.join("")
        } else
            r = ",." + ha(i[2]) + "f";
        return e.format(r)
    }
    function ha(e) {
        return -Math.floor(Math.log(e) / Math.LN10 + .01)
    }
    function pa(e, t) {
        var n = ha(t[2]);
        return e in ca ? Math.abs(n - ha(Math.max(y(t[0]), y(t[1])))) + +(e !== "e") : n - (e === "%") * 2
    }
    function da(t, n, r, i) {
        function s(e) {
            return (r ? Math.log(e < 0 ? 0 : e) : -Math.log(e > 0 ? 0 : -e)) / Math.log(n)
        }
        function o(e) {
            return r ? Math.pow(n, e) : -Math.pow(n, -e)
        }
        function u(e) {
            return t(s(e))
        }
        return u.invert = function(e) {
            return o(t.invert(e))
        }, u.domain = function(e) {
            return arguments.length ? (r = e[0] >= 0, t.domain((i = e.map(Number)).map(s)), u) : i
        }, u.base = function(e) {
            return arguments.length ? (n = +e, t.domain(i.map(s)), u) : n
        }, u.nice = function() {
            var e = ta(i.map(s), r ? Math : ma);
            return t.domain(e), i = e.map(o), u
        }, u.ticks = function() {
            var e = Yu(i), t = [], u = e[0], a = e[1], f = Math.floor(s(u)), l = Math.ceil(s(a)), c = n % 1 ? 2 : n;
            if (isFinite(l - f)) {
                if (r) {
                    for (; f < l; f++)
                        for (var h = 1; h < c; h++)
                            t.push(o(f) * h);
                    t.push(o(f))
                } else {
                    t.push(o(f));
                    for (; f++ < l; )
                        for (var h = c - 1; h > 0; h--)
                            t.push(o(f) * h)
                }
                for (f = 0; t[f] < u; f++)
                    ;
                for (l = t.length; t[l - 1] > a; l--)
                    ;
                t = t.slice(f, l)
            }
            return t
        }, u.tickFormat = function(t, n) {
            if (!arguments.length)
                return va;
            arguments.length < 2 ? n = va : typeof n != "function" && (n = e.format(n));
            var i = Math.max(.1, t / u.ticks().length), a = r ? (f = 1e-12, Math.ceil) : (f = -1e-12, Math.floor), f;
            return function(e) {
                return e / o(a(s(e) + f)) <= i ? n(e) : ""
            }
        }, u.copy = function() {
            return da(t.copy(), n, r, i)
        }, oa(u, t)
    }
    function ga(e, t, n) {
        function s(t) {
            return e(r(t))
        }
        var r = ya(t), i = ya(1 / t);
        return s.invert = function(t) {
            return i(e.invert(t))
        }, s.domain = function(t) {
            return arguments.length ? (e.domain((n = t.map(Number)).map(r)), s) : n
        }, s.ticks = function(e) {
            return fa(n, e)
        }, s.tickFormat = function(e, t) {
            return la(n, e, t)
        }, s.nice = function(e) {
            return s.domain(ua(n, e))
        }, s.exponent = function(o) {
            return arguments.length ? (r = ya(t = o), i = ya(1 / t), e.domain(n.map(r)), s) : t
        }, s.copy = function() {
            return ga(e.copy(), t, n)
        }, oa(s, e)
    }
    function ya(e) {
        return function(t) {
            return t < 0 ? -Math.pow(-t, e) : Math.pow(t, e)
        }
    }
    function ba(t, n) {
        function o(e) {
            return i[((r.get(e) || (n.t === "range" ? r.set(e, t.push(e)) : NaN)) - 1) % i.length]
        }
        function u(n, r) {
            return e.range(t.length).map(function(e) {
                return n + r * e
            })
        }
        var r, i, s;
        return o.domain = function(e) {
            if (!arguments.length)
                return t;
            t = [], r = new E;
            var i = -1, s = e.length, u;
            while (++i < s)
                r.has(u = e[i]) || r.set(u, t.push(u));
            return o[n.t].apply(o, n.a)
        }, o.range = function(e) {
            return arguments.length ? (i = e, s = 0, n = {t: "range",a: arguments}, o) : i
        }, o.rangePoints = function(e, r) {
            arguments.length < 2 && (r = 0);
            var a = e[0], f = e[1], l = (f - a) / (Math.max(1, t.length - 1) + r);
            return i = u(t.length < 2 ? (a + f) / 2 : a + l * r / 2, l), s = 0, n = {t: "rangePoints",a: arguments}, o
        }, o.rangeBands = function(e, r, a) {
            arguments.length < 2 && (r = 0), arguments.length < 3 && (a = r);
            var f = e[1] < e[0], l = e[f - 0], c = e[1 - f], h = (c - l) / (t.length - r + 2 * a);
            return i = u(l + h * a, h), f && i.reverse(), s = h * (1 - r), n = {t: "rangeBands",a: arguments}, o
        }, o.rangeRoundBands = function(e, r, a) {
            arguments.length < 2 && (r = 0), arguments.length < 3 && (a = r);
            var f = e[1] < e[0], l = e[f - 0], c = e[1 - f], h = Math.floor((c - l) / (t.length - r + 2 * a)), p = c - l - (t.length - r) * h;
            return i = u(l + Math.round(p / 2), h), f && i.reverse(), s = Math.round(h * (1 - r)), n = {t: "rangeRoundBands",a: arguments}, o
        }, o.rangeBand = function() {
            return s
        }, o.rangeExtent = function() {
            return Yu(n.a[0])
        }, o.copy = function() {
            return ba(t, n)
        }, o.domain(t)
    }
    function Ta(t, n) {
        function i() {
            var i = 0, o = n.length;
            r = [];
            while (++i < o)
                r[i - 1] = e.quantile(t, i / o);
            return s
        }
        function s(t) {
            if (!isNaN(t = +t))
                return n[e.bisect(r, t)]
        }
        var r;
        return s.domain = function(e) {
            return arguments.length ? (t = e.filter(d).sort(p), i()) : t
        }, s.range = function(e) {
            return arguments.length ? (n = e, i()) : n
        }, s.quantiles = function() {
            return r
        }, s.invertExtent = function(e) {
            return e = n.indexOf(e), e < 0 ? [NaN, NaN] : [e > 0 ? r[e - 1] : t[0], e < r.length ? r[e] : t[t.length - 1]]
        }, s.copy = function() {
            return Ta(t, n)
        }, i()
    }
    function Na(e, t, n) {
        function s(t) {
            return n[Math.max(0, Math.min(i, Math.floor(r * (t - e))))]
        }
        function o() {
            return r = n.length / (t - e), i = n.length - 1, s
        }
        var r, i;
        return s.domain = function(n) {
            return arguments.length ? (e = +n[0], t = +n[n.length - 1], o()) : [e, t]
        }, s.range = function(e) {
            return arguments.length ? (n = e, o()) : n
        }, s.invertExtent = function(t) {
            return t = n.indexOf(t), t = t < 0 ? NaN : t / r + e, [t, t + 1 / r]
        }, s.copy = function() {
            return Na(e, t, n)
        }, o()
    }
    function Ca(t, n) {
        function r(r) {
            if (r <= r)
                return n[e.bisect(t, r)]
        }
        return r.domain = function(e) {
            return arguments.length ? (t = e, r) : t
        }, r.range = function(e) {
            return arguments.length ? (n = e, r) : n
        }, r.invertExtent = function(e) {
            return e = n.indexOf(e), [t[e - 1], t[e]]
        }, r.copy = function() {
            return Ca(t, n)
        }, r
    }
    function ka(e) {
        function t(e) {
            return +e
        }
        return t.invert = t, t.domain = t.range = function(n) {
            return arguments.length ? (e = n.map(t), t) : e
        }, t.ticks = function(t) {
            return fa(e, t)
        }, t.tickFormat = function(t, n) {
            return la(e, t, n)
        }, t.copy = function() {
            return ka(e)
        }, t
    }
    function Oa(e) {
        return e.innerRadius
    }
    function Ma(e) {
        return e.outerRadius
    }
    function _a(e) {
        return e.startAngle
    }
    function Da(e) {
        return e.endAngle
    }
    function Pa(e) {
        function u(s) {
            function d() {
                u.push("M", i(e(a), o))
            }
            var u = [], a = [], f = -1, l = s.length, c, h = xn(t), p = xn(n);
            while (++f < l)
                r.call(this, c = s[f], f) ? a.push([+h.call(this, c, f), +p.call(this, c, f)]) : a.length && (d(), a = []);
            return a.length && d(), u.length ? u.join("") : null
        }
        var t = Ss, n = xs, r = ii, i = Ba, s = i.key, o = .7;
        return u.x = function(e) {
            return arguments.length ? (t = e, u) : t
        }, u.y = function(e) {
            return arguments.length ? (n = e, u) : n
        }, u.defined = function(e) {
            return arguments.length ? (r = e, u) : r
        }, u.interpolate = function(e) {
            return arguments.length ? (typeof e == "function" ? s = i = e : s = (i = Ha.get(e) || Ba).key, u) : s
        }, u.tension = function(e) {
            return arguments.length ? (o = e, u) : o
        }, u
    }
    function Ba(e) {
        return e.join("L")
    }
    function ja(e) {
        return Ba(e) + "Z"
    }
    function Fa(e) {
        var t = 0, n = e.length, r = e[0], i = [r[0], ",", r[1]];
        while (++t < n)
            i.push("H", (r[0] + (r = e[t])[0]) / 2, "V", r[1]);
        return n > 1 && i.push("H", r[0]), i.join("")
    }
    function Ia(e) {
        var t = 0, n = e.length, r = e[0], i = [r[0], ",", r[1]];
        while (++t < n)
            i.push("V", (r = e[t])[1], "H", r[0]);
        return i.join("")
    }
    function qa(e) {
        var t = 0, n = e.length, r = e[0], i = [r[0], ",", r[1]];
        while (++t < n)
            i.push("H", (r = e[t])[0], "V", r[1]);
        return i.join("")
    }
    function Ra(e, t) {
        return e.length < 4 ? Ba(e) : e[1] + Wa(e.slice(1, e.length - 1), Xa(e, t))
    }
    function Ua(e, t) {
        return e.length < 3 ? Ba(e) : e[0] + Wa((e.push(e[0]), e), Xa([e[e.length - 2]].concat(e, [e[1]]), t))
    }
    function za(e, t) {
        return e.length < 3 ? Ba(e) : e[0] + Wa(e, Xa(e, t))
    }
    function Wa(e, t) {
        if (t.length < 1 || e.length != t.length && e.length != t.length + 2)
            return Ba(e);
        var n = e.length != t.length, r = "", i = e[0], s = e[1], o = t[0], u = o, a = 1;
        n && (r += "Q" + (s[0] - o[0] * 2 / 3) + "," + (s[1] - o[1] * 2 / 3) + "," + s[0] + "," + s[1], i = e[1], a = 2);
        if (t.length > 1) {
            u = t[1], s = e[a], a++, r += "C" + (i[0] + o[0]) + "," + (i[1] + o[1]) + "," + (s[0] - u[0]) + "," + (s[1] - u[1]) + "," + s[0] + "," + s[1];
            for (var f = 2; f < t.length; f++, a++)
                s = e[a], u = t[f], r += "S" + (s[0] - u[0]) + "," + (s[1] - u[1]) + "," + s[0] + "," + s[1]
        }
        if (n) {
            var l = e[a];
            r += "Q" + (s[0] + u[0] * 2 / 3) + "," + (s[1] + u[1] * 2 / 3) + "," + l[0] + "," + l[1]
        }
        return r
    }
    function Xa(e, t) {
        var n = [], r = (1 - t) / 2, i, s = e[0], o = e[1], u = 1, a = e.length;
        while (++u < a)
            i = s, s = o, o = e[u], n.push([r * (o[0] - i[0]), r * (o[1] - i[1])]);
        return n
    }
    function Va(e) {
        if (e.length < 3)
            return Ba(e);
        var t = 1, n = e.length, r = e[0], i = r[0], s = r[1], o = [i, i, i, (r = e[1])[0]], u = [s, s, s, r[1]], a = [i, ",", s, "L", Qa(Za, o), ",", Qa(Za, u)];
        e.push(e[n - 1]);
        while (++t <= n)
            r = e[t], o.shift(), o.push(r[0]), u.shift(), u.push(r[1]), ef(a, o, u);
        return e.pop(), a.push("L", r), a.join("")
    }
    function $a(e) {
        if (e.length < 4)
            return Ba(e);
        var t = [], n = -1, r = e.length, i, s = [0], o = [0];
        while (++n < 3)
            i = e[n], s.push(i[0]), o.push(i[1]);
        t.push(Qa(Za, s) + "," + Qa(Za, o)), --n;
        while (++n < r)
            i = e[n], s.shift(), s.push(i[0]), o.shift(), o.push(i[1]), ef(t, s, o);
        return t.join("")
    }
    function Ja(e) {
        var t, n = -1, r = e.length, i = r + 4, s, o = [], u = [];
        while (++n < 4)
            s = e[n % r], o.push(s[0]), u.push(s[1]);
        t = [Qa(Za, o), ",", Qa(Za, u)], --n;
        while (++n < i)
            s = e[n % r], o.shift(), o.push(s[0]), u.shift(), u.push(s[1]), ef(t, o, u);
        return t.join("")
    }
    function Ka(e, t) {
        var n = e.length - 1;
        if (n) {
            var r = e[0][0], i = e[0][1], s = e[n][0] - r, o = e[n][1] - i, u = -1, a, f;
            while (++u <= n)
                a = e[u], f = u / n, a[0] = t * a[0] + (1 - t) * (r + f * s), a[1] = t * a[1] + (1 - t) * (i + f * o)
        }
        return Va(e)
    }
    function Qa(e, t) {
        return e[0] * t[0] + e[1] * t[1] + e[2] * t[2] + e[3] * t[3]
    }
    function ef(e, t, n) {
        e.push("C", Qa(Ga, t), ",", Qa(Ga, n), ",", Qa(Ya, t), ",", Qa(Ya, n), ",", Qa(Za, t), ",", Qa(Za, n))
    }
    function tf(e, t) {
        return (t[1] - e[1]) / (t[0] - e[0])
    }
    function nf(e) {
        var t = 0, n = e.length - 1, r = [], i = e[0], s = e[1], o = r[0] = tf(i, s);
        while (++t < n)
            r[t] = (o + (o = tf(i = s, s = e[t + 1]))) / 2;
        return r[t] = o, r
    }
    function rf(e) {
        var t = [], n, r, i, s, o = nf(e), u = -1, a = e.length - 1;
        while (++u < a)
            n = tf(e[u], e[u + 1]), y(n) < At ? o[u] = o[u + 1] = 0 : (r = o[u] / n, i = o[u + 1] / n, s = r * r + i * i, s > 9 && (s = n * 3 / Math.sqrt(s), o[u] = s * r, o[u + 1] = s * i));
        u = -1;
        while (++u <= a)
            s = (e[Math.min(a, u + 1)][0] - e[Math.max(0, u - 1)][0]) / (6 * (1 + o[u] * o[u])), t.push([s || 0, o[u] * s || 0]);
        return t
    }
    function sf(e) {
        return e.length < 3 ? Ba(e) : e[0] + Wa(e, rf(e))
    }
    function of(e) {
        var t, n = -1, r = e.length, i, s;
        while (++n < r)
            t = e[n], i = t[0], s = t[1] + La, t[0] = i * Math.cos(s), t[1] = i * Math.sin(s);
        return e
    }
    function uf(e) {
        function c(u) {
            function x() {
                c.push("M", o(e(p), l), f, a(e(h.reverse()), l), "Z")
            }
            var c = [], h = [], p = [], d = -1, v = u.length, m, g = xn(t), y = xn(r), b = t === n ? function() {
                return E
            } : xn(n), w = r === i ? function() {
                return S
            } : xn(i), E, S;
            while (++d < v)
                s.call(this, m = u[d], d) ? (h.push([E = +g.call(this, m, d), S = +y.call(this, m, d)]), p.push([+b.call(this, m, d), +w.call(this, m, d)])) : h.length && (x(), h = [], p = []);
            return h.length && x(), c.length ? c.join("") : null
        }
        var t = Ss, n = Ss, r = 0, i = xs, s = ii, o = Ba, u = o.key, a = o, f = "L", l = .7;
        return c.x = function(e) {
            return arguments.length ? (t = n = e, c) : n
        }, c.x0 = function(e) {
            return arguments.length ? (t = e, c) : t
        }, c.x1 = function(e) {
            return arguments.length ? (n = e, c) : n
        }, c.y = function(e) {
            return arguments.length ? (r = i = e, c) : i
        }, c.y0 = function(e) {
            return arguments.length ? (r = e, c) : r
        }, c.y1 = function(e) {
            return arguments.length ? (i = e, c) : i
        }, c.defined = function(e) {
            return arguments.length ? (s = e, c) : s
        }, c.interpolate = function(e) {
            return arguments.length ? (typeof e == "function" ? u = o = e : u = (o = Ha.get(e) || Ba).key, a = o.reverse || o, f = o.closed ? "M" : "L", c) : u
        }, c.tension = function(e) {
            return arguments.length ? (l = e, c) : l
        }, c
    }
    function af(e) {
        return e.radius
    }
    function ff(e) {
        return [e.x, e.y]
    }
    function lf(e) {
        return function() {
            var t = e.apply(this, arguments), n = t[0], r = t[1] + La;
            return [n * Math.cos(r), n * Math.sin(r)]
        }
    }
    function cf() {
        return 64
    }
    function hf() {
        return "circle"
    }
    function pf(e) {
        var t = Math.sqrt(e / Ct);
        return "M0," + t + "A" + t + "," + t + " 0 1,1 0," + -t + "A" + t + "," + t + " 0 1,1 0," + t + "Z"
    }
    function gf(e, t) {
        return q(e, yf), e.id = t, e
    }
    function Sf(e, t, n, r) {
        var i = e.id;
        return at(e, typeof n == "function" ? function(e, s, o) {
            e.__transition__[i].tween.set(t, r(n.call(e, e.__data__, s, o)))
        } : (n = r(n), function(e) {
            e.__transition__[i].tween.set(t, n)
        }))
    }
    function xf(e) {
        return e == null && (e = ""), function() {
            this.textContent = e
        }
    }
    function Tf(t, n, r, i) {
        var s = t.__transition__ || (t.__transition__ = {active: 0,count: 0}), o = s[r];
        if (!o) {
            var u = i.time;
            o = s[r] = {tween: new E,time: u,ease: i.ease,delay: i.delay,duration: i.duration}, ++s.count, e.timer(function(i) {
                function d(i) {
                    if (s.active > r)
                        return m();
                    s.active = r, o.event && o.event.start.call(t, a, n), o.tween.forEach(function(e, r) {
                        (r = r.call(t, a, n)) && p.push(r)
                    }), e.timer(function() {
                        return h.c = v(i || 1) ? ii : v, 1
                    }, 0, u)
                }
                function v(e) {
                    if (s.active !== r)
                        return m();
                    var i = e / c, u = f(i), l = p.length;
                    while (l > 0)
                        p[--l].call(t, u);
                    if (i >= 1)
                        return o.event && o.event.end.call(t, a, n), m()
                }
                function m() {
                    return --s.count ? delete s[r] : delete t.__transition__, 1
                }
                var a = t.__data__, f = o.ease, l = o.delay, c = o.duration, h = _n, p = [];
                h.t = l + u;
                if (l <= i)
                    return d(i - l);
                h.c = d
            }, 0, u)
        }
    }
    function kf(e, t) {
        e.attr("transform", function(e) {
            return "translate(" + t(e) + ",0)"
        })
    }
    function Lf(e, t) {
        e.attr("transform", function(e) {
            return "translate(0," + t(e) + ")"
        })
    }
    function Pf(e) {
        return e.toISOString()
    }
    function Hf(t, n, r) {
        function i(e) {
            return t(e)
        }
        function s(t, r) {
            var i = t[1] - t[0], s = i / r, o = e.bisect(jf, s);
            return o == jf.length ? [n.year, aa(t.map(function(e) {
                    return e / 31536e6
                }), r)[2]] : o ? n[s / jf[o - 1] < jf[o] / s ? o - 1 : o] : [qf, aa(t, r)[2]]
        }
        return i.invert = function(e) {
            return Bf(t.invert(e))
        }, i.domain = function(e) {
            return arguments.length ? (t.domain(e), i) : t.domain().map(Bf)
        }, i.nice = function(e, t) {
            function u(n) {
                return !isNaN(n) && !e.range(n, Bf(+n + 1), t).length
            }
            var n = i.domain(), r = Yu(n), o = e == null ? s(r, 10) : typeof e == "number" && s(r, e);
            return o && (e = o[0], t = o[1]), i.domain(ta(n, t > 1 ? {floor: function(t) {
                    while (u(t = e.floor(t)))
                        t = Bf(t - 1);
                    return t
                },ceil: function(t) {
                    while (u(t = e.ceil(t)))
                        t = Bf(+t + 1);
                    return t
                }} : e))
        }, i.ticks = function(e, t) {
            var n = Yu(i.domain()), r = e == null ? s(n, 10) : typeof e == "number" ? s(n, e) : !e.range && [{range: e}, t];
            return r && (e = r[0], t = r[1]), e.range(n[0], Bf(+n[1] + 1), t < 1 ? 1 : t)
        }, i.tickFormat = function() {
            return r
        }, i.copy = function() {
            return Hf(t.copy(), n, r)
        }, oa(i, t)
    }
    function Bf(e) {
        return new Date(e)
    }
    function zf(e) {
        return JSON.parse(e.responseText)
    }
    function Wf(e) {
        var t = r.createRange();
        return t.selectNode(r.body), t.createContextualFragment(e.responseText)
    }
    var e = {version: "3.4.11"};
    Date.now || (Date.now = function() {
        return +(new Date)
    });
    var t = [].slice, n = function(e) {
        return t.call(e)
    }, r = document, i = r.documentElement, s = window;
    try {
        n(i.childNodes)[0].nodeType
    } catch (o) {
        n = function(e) {
            var t = e.length, n = new Array(t);
            while (t--)
                n[t] = e[t];
            return n
        }
    }
    try {
        r.createElement("div").style.setProperty("opacity", 0, "")
    } catch (u) {
        var a = s.Element.prototype, f = a.setAttribute, l = a.setAttributeNS, c = s.CSSStyleDeclaration.prototype, h = c.setProperty;
        a.setAttribute = function(e, t) {
            f.call(this, e, t + "")
        }, a.setAttributeNS = function(e, t, n) {
            l.call(this, e, t, n + "")
        }, c.setProperty = function(e, t, n) {
            h.call(this, e, t + "", n)
        }
    }
    e.ascending = p, e.descending = function(e, t) {
        return t < e ? -1 : t > e ? 1 : t >= e ? 0 : NaN
    }, e.min = function(e, t) {
        var n = -1, r = e.length, i, s;
        if (arguments.length === 1) {
            while (++n < r && !((i = e[n]) != null && i <= i))
                i = undefined;
            while (++n < r)
                (s = e[n]) != null && i > s && (i = s)
        } else {
            while (++n < r && !((i = t.call(e, e[n], n)) != null && i <= i))
                i = undefined;
            while (++n < r)
                (s = t.call(e, e[n], n)) != null && i > s && (i = s)
        }
        return i
    }, e.max = function(e, t) {
        var n = -1, r = e.length, i, s;
        if (arguments.length === 1) {
            while (++n < r && !((i = e[n]) != null && i <= i))
                i = undefined;
            while (++n < r)
                (s = e[n]) != null && s > i && (i = s)
        } else {
            while (++n < r && !((i = t.call(e, e[n], n)) != null && i <= i))
                i = undefined;
            while (++n < r)
                (s = t.call(e, e[n], n)) != null && s > i && (i = s)
        }
        return i
    }, e.extent = function(e, t) {
        var n = -1, r = e.length, i, s, o;
        if (arguments.length === 1) {
            while (++n < r && !((i = o = e[n]) != null && i <= i))
                i = o = undefined;
            while (++n < r)
                (s = e[n]) != null && (i > s && (i = s), o < s && (o = s))
        } else {
            while (++n < r && !((i = o = t.call(e, e[n], n)) != null && i <= i))
                i = undefined;
            while (++n < r)
                (s = t.call(e, e[n], n)) != null && (i > s && (i = s), o < s && (o = s))
        }
        return [i, o]
    }, e.sum = function(e, t) {
        var n = 0, r = e.length, i, s = -1;
        if (arguments.length === 1)
            while (++s < r)
                isNaN(i = +e[s]) || (n += i);
        else
            while (++s < r)
                isNaN(i = +t.call(e, e[s], s)) || (n += i);
        return n
    }, e.mean = function(e, t) {
        var n = 0, r = e.length, i, s = -1, o = r;
        if (arguments.length === 1)
            while (++s < r)
                d(i = e[s]) ? n += i : --o;
        else
            while (++s < r)
                d(i = t.call(e, e[s], s)) ? n += i : --o;
        return o ? n / o : undefined
    }, e.quantile = function(e, t) {
        var n = (e.length - 1) * t + 1, r = Math.floor(n), i = +e[r - 1], s = n - r;
        return s ? i + s * (e[r] - i) : i
    }, e.median = function(t, n) {
        return arguments.length > 1 && (t = t.map(n)), t = t.filter(d), t.length ? e.quantile(t.sort(p), .5) : undefined
    };
    var m = v(p);
    e.bisectLeft = m.left, e.bisect = e.bisectRight = m.right, e.bisector = function(e) {
        return v(e.length === 1 ? function(t, n) {
            return p(e(t), n)
        } : e)
    }, e.shuffle = function(e) {
        var t = e.length, n, r;
        while (t)
            r = Math.random() * t-- | 0, n = e[t], e[t] = e[r], e[r] = n;
        return e
    }, e.permute = function(e, t) {
        var n = t.length, r = new Array(n);
        while (n--)
            r[n] = e[t[n]];
        return r
    }, e.pairs = function(e) {
        var t = 0, n = e.length - 1, r, i = e[0], s = new Array(n < 0 ? 0 : n);
        while (t < n)
            s[t] = [r = i, i = e[++t]];
        return s
    }, e.zip = function() {
        if (!(s = arguments.length))
            return [];
        for (var t = -1, n = e.min(arguments, g), r = new Array(n); ++t < n; )
            for (var i = -1, s, o = r[t] = new Array(s); ++i < s; )
                o[i] = arguments[i][t];
        return r
    }, e.transpose = function(t) {
        return e.zip.apply(e, t)
    }, e.keys = function(e) {
        var t = [];
        for (var n in e)
            t.push(n);
        return t
    }, e.values = function(e) {
        var t = [];
        for (var n in e)
            t.push(e[n]);
        return t
    }, e.entries = function(e) {
        var t = [];
        for (var n in e)
            t.push({key: n,value: e[n]});
        return t
    }, e.merge = function(e) {
        var t = e.length, n, r = -1, i = 0, s, o;
        while (++r < t)
            i += e[r].length;
        s = new Array(i);
        while (--t >= 0) {
            o = e[t], n = o.length;
            while (--n >= 0)
                s[--i] = o[n]
        }
        return s
    };
    var y = Math.abs;
    e.range = function(e, t, n) {
        arguments.length < 3 && (n = 1, arguments.length < 2 && (t = e, e = 0));
        if ((t - e) / n === Infinity)
            throw new Error("infinite range");
        var r = [], i = b(y(n)), s = -1, o;
        e *= i, t *= i, n *= i;
        if (n < 0)
            while ((o = e + n * ++s) > t)
                r.push(o / i);
        else
            while ((o = e + n * ++s) < t)
                r.push(o / i);
        return r
    }, e.map = function(e) {
        var t = new E;
        if (e instanceof E)
            e.forEach(function(e, n) {
                t.set(e, n)
            });
        else
            for (var n in e)
                t.set(n, e[n]);
        return t
    }, w(E, {has: T,get: function(e) {
            return this[S + e]
        },set: function(e, t) {
            return this[S + e] = t
        },remove: N,keys: C,values: function() {
            var e = [];
            return this.forEach(function(t, n) {
                e.push(n)
            }), e
        },entries: function() {
            var e = [];
            return this.forEach(function(t, n) {
                e.push({key: t,value: n})
            }), e
        },size: k,empty: L,forEach: function(e) {
            for (var t in this)
                t.charCodeAt(0) === x && e.call(this, t.substring(1), this[t])
        }});
    var S = "\0", x = S.charCodeAt(0);
    e.nest = function() {
        function o(e, r, u) {
            if (u >= n.length)
                return s ? s.call(t, r) : i ? r.sort(i) : r;
            var a = -1, f = r.length, l = n[u++], c, h, p, d = new E, v;
            while (++a < f)
                (v = d.get(c = l(h = r[a]))) ? v.push(h) : d.set(c, [h]);
            return e ? (h = e(), p = function(t, n) {
                h.set(t, o(e, n, u))
            }) : (h = {}, p = function(t, n) {
                h[t] = o(e, n, u)
            }), d.forEach(p), h
        }
        function u(e, t) {
            if (t >= n.length)
                return e;
            var i = [], s = r[t++];
            return e.forEach(function(e, n) {
                i.push({key: e,values: u(n, t)})
            }), s ? i.sort(function(e, t) {
                return s(e.key, t.key)
            }) : i
        }
        var t = {}, n = [], r = [], i, s;
        return t.map = function(e, t) {
            return o(t, e, 0)
        }, t.entries = function(t) {
            return u(o(e.map, t, 0), 0)
        }, t.key = function(e) {
            return n.push(e), t
        }, t.sortKeys = function(e) {
            return r[n.length - 1] = e, t
        }, t.sortValues = function(e) {
            return i = e, t
        }, t.rollup = function(e) {
            return s = e, t
        }, t
    }, e.set = function(e) {
        var t = new A;
        if (e)
            for (var n = 0, r = e.length; n < r; ++n)
                t.add(e[n]);
        return t
    }, w(A, {has: T,add: function(e) {
            return this[S + e] = !0, e
        },remove: function(e) {
            return e = S + e, e in this && delete this[e]
        },values: C,size: k,empty: L,forEach: function(e) {
            for (var t in this)
                t.charCodeAt(0) === x && e.call(this, t.substring(1))
        }}), e.behavior = {}, e.rebind = function(e, t) {
        var n = 1, r = arguments.length, i;
        while (++n < r)
            e[i = arguments[n]] = O(e, t, t[i]);
        return e
    };
    var _ = ["webkit", "ms", "moz", "Moz", "o", "O"];
    e.dispatch = function() {
        var e = new P, t = -1, n = arguments.length;
        while (++t < n)
            e[arguments[t]] = H(e);
        return e
    }, P.prototype.on = function(e, t) {
        var n = e.indexOf("."), r = "";
        n >= 0 && (r = e.substring(n + 1), e = e.substring(0, n));
        if (e)
            return arguments.length < 2 ? this[e].on(r) : this[e].on(r, t);
        if (arguments.length === 2) {
            if (t == null)
                for (e in this)
                    this.hasOwnProperty(e) && this[e].on(r, null);
            return this
        }
    }, e.event = null, e.requote = function(e) {
        return e.replace(I, "\\$&")
    };
    var I = /[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g, q = {}.__proto__ ? function(e, t) {
        e.__proto__ = t
    } : function(e, t) {
        for (var n in t)
            e[n] = t[n]
    }, U = function(e, t) {
        return t.querySelector(e)
    }, z = function(e, t) {
        return t.querySelectorAll(e)
    }, W = i.matches || i[M(i, "matchesSelector")], X = function(e, t) {
        return W.call(e, t)
    };
    typeof Sizzle == "function" && (U = function(e, t) {
        return Sizzle(e, t)[0] || null
    }, z = Sizzle, X = Sizzle.matchesSelector), e.selection = function() {
        return pt
    };
    var V = e.selection.prototype = [];
    V.select = function(e) {
        var t = [], n, r, i, s;
        e = $(e);
        for (var o = -1, u = this.length; ++o < u; ) {
            t.push(n = []), n.parentNode = (i = this[o]).parentNode;
            for (var a = -1, f = i.length; ++a < f; )
                (s = i[a]) ? (n.push(r = e.call(s, s.__data__, a, o)), r && "__data__" in s && (r.__data__ = s.__data__)) : n.push(null)
        }
        return R(t)
    }, V.selectAll = function(e) {
        var t = [], r, i;
        e = J(e);
        for (var s = -1, o = this.length; ++s < o; )
            for (var u = this[s], a = -1, f = u.length; ++a < f; )
                if (i = u[a])
                    t.push(r = n(e.call(i, i.__data__, a, s))), r.parentNode = i;
        return R(t)
    };
    var K = {svg: "http://www.w3.org/2000/svg",xhtml: "http://www.w3.org/1999/xhtml",xlink: "http://www.w3.org/1999/xlink",xml: "http://www.w3.org/XML/1998/namespace",xmlns: "http://www.w3.org/2000/xmlns/"};
    e.ns = {prefix: K,qualify: function(e) {
            var t = e.indexOf(":"), n = e;
            return t >= 0 && (n = e.substring(0, t), e = e.substring(t + 1)), K.hasOwnProperty(n) ? {space: K[n],local: e} : e
        }}, V.attr = function(t, n) {
        if (arguments.length < 2) {
            if (typeof t == "string") {
                var r = this.node();
                return t = e.ns.qualify(t), t.local ? r.getAttributeNS(t.space, t.local) : r.getAttribute(t)
            }
            for (n in t)
                this.each(Q(n, t[n]));
            return this
        }
        return this.each(Q(t, n))
    }, V.classed = function(e, t) {
        if (arguments.length < 2) {
            if (typeof e == "string") {
                var n = this.node(), r = (e = Z(e)).length, i = -1;
                if (t = n.classList) {
                    while (++i < r)
                        if (!t.contains(e[i]))
                            return !1
                } else {
                    t = n.getAttribute("class");
                    while (++i < r)
                        if (!Y(e[i]).test(t))
                            return !1
                }
                return !0
            }
            for (t in e)
                this.each(et(t, e[t]));
            return this
        }
        return this.each(et(e, t))
    }, V.style = function(e, t, n) {
        var r = arguments.length;
        if (r < 3) {
            if (typeof e != "string") {
                r < 2 && (t = "");
                for (n in e)
                    this.each(nt(n, e[n], t));
                return this
            }
            if (r < 2)
                return s.getComputedStyle(this.node(), null).getPropertyValue(e);
            n = ""
        }
        return this.each(nt(e, t, n))
    }, V.property = function(e, t) {
        if (arguments.length < 2) {
            if (typeof e == "string")
                return this.node()[e];
            for (t in e)
                this.each(rt(t, e[t]));
            return this
        }
        return this.each(rt(e, t))
    }, V.text = function(e) {
        return arguments.length ? this.each(typeof e == "function" ? function() {
            var t = e.apply(this, arguments);
            this.textContent = t == null ? "" : t
        } : e == null ? function() {
            this.textContent = ""
        } : function() {
            this.textContent = e
        }) : this.node().textContent
    }, V.html = function(e) {
        return arguments.length ? this.each(typeof e == "function" ? function() {
            var t = e.apply(this, arguments);
            this.innerHTML = t == null ? "" : t
        } : e == null ? function() {
            this.innerHTML = ""
        } : function() {
            this.innerHTML = e
        }) : this.node().innerHTML
    }, V.append = function(e) {
        return e = it(e), this.select(function() {
            return this.appendChild(e.apply(this, arguments))
        })
    }, V.insert = function(e, t) {
        return e = it(e), t = $(t), this.select(function() {
            return this.insertBefore(e.apply(this, arguments), t.apply(this, arguments) || null)
        })
    }, V.remove = function() {
        return this.each(function() {
            var e = this.parentNode;
            e && e.removeChild(this)
        })
    }, V.data = function(e, t) {
        function o(e, n) {
            var r, i = e.length, s = n.length, o = Math.min(i, s), l = new Array(s), c = new Array(s), h = new Array(i), p, d;
            if (t) {
                var v = new E, m = new E, g = [], y;
                for (r = -1; ++r < i; )
                    y = t.call(p = e[r], p.__data__, r), v.has(y) ? h[r] = p : v.set(y, p), g.push(y);
                for (r = -1; ++r < s; )
                    y = t.call(n, d = n[r], r), (p = v.get(y)) ? (l[r] = p, p.__data__ = d) : m.has(y) || (c[r] = st(d)), m.set(y, d), v.remove(y);
                for (r = -1; ++r < i; )
                    v.has(g[r]) && (h[r] = e[r])
            } else {
                for (r = -1; ++r < o; )
                    p = e[r], d = n[r], p ? (p.__data__ = d, l[r] = p) : c[r] = st(d);
                for (; r < s; ++r)
                    c[r] = st(n[r]);
                for (; r < i; ++r)
                    h[r] = e[r]
            }
            c.update = l, c.parentNode = l.parentNode = h.parentNode = e.parentNode, u.push(c), a.push(l), f.push(h)
        }
        var n = -1, r = this.length, i, s;
        if (!arguments.length) {
            e = new Array(r = (i = this[0]).length);
            while (++n < r)
                if (s = i[n])
                    e[n] = s.__data__;
            return e
        }
        var u = ft([]), a = R([]), f = R([]);
        if (typeof e == "function")
            while (++n < r)
                o(i = this[n], e.call(i, i.parentNode.__data__, n));
        else
            while (++n < r)
                o(i = this[n], e);
        return a.enter = function() {
            return u
        }, a.exit = function() {
            return f
        }, a
    }, V.datum = function(e) {
        return arguments.length ? this.property("__data__", e) : this.property("__data__")
    }, V.filter = function(e) {
        var t = [], n, r, i;
        typeof e != "function" && (e = ot(e));
        for (var s = 0, o = this.length; s < o; s++) {
            t.push(n = []), n.parentNode = (r = this[s]).parentNode;
            for (var u = 0, a = r.length; u < a; u++)
                (i = r[u]) && e.call(i, i.__data__, u, s) && n.push(i)
        }
        return R(t)
    }, V.order = function() {
        for (var e = -1, t = this.length; ++e < t; )
            for (var n = this[e], r = n.length - 1, i = n[r], s; --r >= 0; )
                if (s = n[r])
                    i && i !== s.nextSibling && i.parentNode.insertBefore(s, i), i = s;
        return this
    }, V.sort = function(e) {
        e = ut.apply(this, arguments);
        for (var t = -1, n = this.length; ++t < n; )
            this[t].sort(e);
        return this.order()
    }, V.each = function(e) {
        return at(this, function(t, n, r) {
            e.call(t, t.__data__, n, r)
        })
    }, V.call = function(e) {
        var t = n(arguments);
        return e.apply(t[0] = this, t), this
    }, V.empty = function() {
        return !this.node()
    }, V.node = function() {
        for (var e = 0, t = this.length; e < t; e++)
            for (var n = this[e], r = 0, i = n.length; r < i; r++) {
                var s = n[r];
                if (s)
                    return s
            }
        return null
    }, V.size = function() {
        var e = 0;
        return this.each(function() {
            ++e
        }), e
    };
    var lt = [];
    e.selection.enter = ft, e.selection.enter.prototype = lt, lt.append = V.append, lt.empty = V.empty, lt.node = V.node, lt.call = V.call, lt.size = V.size, lt.select = function(e) {
        var t = [], n, r, i, s, o;
        for (var u = -1, a = this.length; ++u < a; ) {
            i = (s = this[u]).update, t.push(n = []), n.parentNode = s.parentNode;
            for (var f = -1, l = s.length; ++f < l; )
                (o = s[f]) ? (n.push(i[f] = r = e.call(s.parentNode, o.__data__, f, u)), r.__data__ = o.__data__) : n.push(null)
        }
        return R(t)
    }, lt.insert = function(e, t) {
        return arguments.length < 2 && (t = ct(this)), V.insert.call(this, e, t)
    }, V.transition = function() {
        var e = wf || ++bf, t = [], n, r, i = Ef || {time: Date.now(),ease: Do,delay: 0,duration: 250};
        for (var s = -1, o = this.length; ++s < o; ) {
            t.push(n = []);
            for (var u = this[s], a = -1, f = u.length; ++a < f; )
                (r = u[a]) && Tf(r, a, e, i), n.push(r)
        }
        return gf(t, e)
    }, V.interrupt = function() {
        return this.each(ht)
    }, e.select = function(e) {
        var t = [typeof e == "string" ? U(e, r) : e];
        return t.parentNode = i, R([t])
    }, e.selectAll = function(e) {
        var t = n(typeof e == "string" ? z(e, r) : e);
        return t.parentNode = i, R([t])
    };
    var pt = e.select(i);
    V.on = function(e, t, n) {
        var r = arguments.length;
        if (r < 3) {
            if (typeof e != "string") {
                r < 2 && (t = !1);
                for (n in e)
                    this.each(dt(n, e[n], t));
                return this
            }
            if (r < 2)
                return (r = this.node()["__on" + e]) && r._;
            n = !1
        }
        return this.each(dt(e, t, n))
    };
    var vt = e.map({mouseenter: "mouseover",mouseleave: "mouseout"});
    vt.forEach(function(e) {
        "on" + e in r && vt.remove(e)
    });
    var yt = "onselectstart" in r ? null : M(i.style, "userSelect"), bt = 0;
    e.mouse = function(e) {
        return St(e, j())
    };
    var Et = /WebKit/.test(s.navigator.userAgent) ? -1 : 0;
    e.touches = function(e, t) {
        return arguments.length < 2 && (t = j().touches), t ? n(t).map(function(t) {
            var n = St(e, t);
            return n.identifier = t.identifier, n
        }) : []
    }, e.behavior.drag = function() {
        function s() {
            this.on("mousedown.drag", r).on("touchstart.drag", i)
        }
        function o(r, i, s, o, u) {
            return function() {
                function b() {
                    var e = i(l, p), t, n;
                    if (!e)
                        return;
                    t = e[0] - y[0], n = e[1] - y[1], h |= t | n, y = e, c({type: "drag",x: e[0] + v[0],y: e[1] + v[1],dx: t,dy: n})
                }
                function w() {
                    if (!i(l, p))
                        return;
                    m.on(o + d, null).on(u + d, null), g(h && e.event.target === f), c({type: "dragend"})
                }
                var a = this, f = e.event.target, l = a.parentNode, c = t.of(a, arguments), h = 0, p = r(), d = ".drag" + (p == null ? "" : "-" + p), v, m = e.select(s()).on(o + d, b).on(u + d, w), g = wt(), y = i(l, p);
                n ? (v = n.apply(a, arguments), v = [v.x - y[0], v.y - y[1]]) : v = [0, 0], c({type: "dragstart"})
            }
        }
        var t = F(s, "drag", "dragstart", "dragend"), n = null, r = o(D, e.mouse, Nt, "mousemove", "mouseup"), i = o(xt, e.touch, Tt, "touchmove", "touchend");
        return s.origin = function(e) {
            return arguments.length ? (n = e, s) : n
        }, e.rebind(s, t, "on")
    };
    var Ct = Math.PI, kt = 2 * Ct, Lt = Ct / 2, At = 1e-6, Ot = At * At, Mt = Ct / 180, _t = 180 / Ct, Rt = Math.SQRT2, Ut = 2, zt = 4;
    e.interpolateZoom = function(e, t) {
        function y(e) {
            var t = e * g;
            if (m) {
                var s = Ft(d), o = i / (Ut * c) * (s * It(Rt * t + d) - jt(d));
                return [n + o * a, r + o * f, i * s / Ft(Rt * t + d)]
            }
            return [n + e * a, r + e * f, i * Math.exp(Rt * t)]
        }
        var n = e[0], r = e[1], i = e[2], s = t[0], o = t[1], u = t[2], a = s - n, f = o - r, l = a * a + f * f, c = Math.sqrt(l), h = (u * u - i * i + zt * l) / (2 * i * Ut * c), p = (u * u - i * i - zt * l) / (2 * u * Ut * c), d = Math.log(Math.sqrt(h * h + 1) - h), v = Math.log(Math.sqrt(p * p + 1) - p), m = v - d, g = (m || Math.log(u / i)) / Rt;
        return y.duration = g * 1e3, y
    }, e.behavior.zoom = function() {
        function b(e) {
            e.on(a, L).on(Vt + ".zoom", O).on("dblclick.zoom", M).on(h, A)
        }
        function w(e) {
            return [(e[0] - t.x) / t.k, (e[1] - t.y) / t.k]
        }
        function E(e) {
            return [e[0] * t.k + t.x, e[1] * t.k + t.y]
        }
        function S(e) {
            t.k = Math.max(u[0], Math.min(u[1], e))
        }
        function x(e, n) {
            n = E(n), t.x += e[0] - n[0], t.y += e[1] - n[1]
        }
        function T() {
            m && m.domain(v.range().map(function(e) {
                return (e - t.x) / t.k
            }).map(v.invert)), y && y.domain(g.range().map(function(e) {
                return (e - t.y) / t.k
            }).map(g.invert))
        }
        function N(e) {
            e({type: "zoomstart"})
        }
        function C(e) {
            T(), e({type: "zoom",scale: t.k,translate: [t.x, t.y]})
        }
        function k(e) {
            e({type: "zoomend"})
        }
        function L() {
            function c() {
                i = 1, x(e.mouse(t), u), C(r)
            }
            function h() {
                o.on(f, null).on(l, null), a(i && e.event.target === n), k(r)
            }
            var t = this, n = e.event.target, r = d.of(t, arguments), i = 0, o = e.select(s).on(f, c).on(l, h), u = w(e.mouse(t)), a = wt();
            ht.call(t), N(r)
        }
        function A() {
            function g() {
                var r = e.touches(n);
                return o = t.k, r.forEach(function(e) {
                    e.identifier in i && (i[e.identifier] = w(e))
                }), r
            }
            function y() {
                var n = e.event.target;
                e.select(n).on(f, b).on(l, E), c.push(n);
                var o = e.event.changedTouches;
                for (var u = 0, a = o.length; u < a; ++u)
                    i[o[u].identifier] = null;
                var h = g(), d = Date.now();
                if (h.length === 1) {
                    if (d - p < 500) {
                        var v = h[0], m = i[v.identifier];
                        S(t.k * 2), x(v, m), B(), C(r)
                    }
                    p = d
                } else if (h.length > 1) {
                    var v = h[0], y = h[1], w = v[0] - y[0], T = v[1] - y[1];
                    s = w * w + T * T
                }
            }
            function b() {
                var t = e.touches(n), u, a, f, l;
                for (var c = 0, h = t.length; c < h; ++c, l = null) {
                    f = t[c];
                    if (l = i[f.identifier]) {
                        if (a)
                            break;
                        u = f, a = l
                    }
                }
                if (l) {
                    var d = (d = f[0] - u[0]) * d + (d = f[1] - u[1]) * d, v = s && Math.sqrt(d / s);
                    u = [(u[0] + f[0]) / 2, (u[1] + f[1]) / 2], a = [(a[0] + l[0]) / 2, (a[1] + l[1]) / 2], S(v * o)
                }
                p = null, x(u, a), C(r)
            }
            function E() {
                if (e.event.touches.length) {
                    var t = e.event.changedTouches;
                    for (var n = 0, s = t.length; n < s; ++n)
                        delete i[t[n].identifier];
                    for (var o in i)
                        return void g()
                }
                e.selectAll(c).on(u, null), v.on(a, L).on(h, A), m(), k(r)
            }
            var n = this, r = d.of(n, arguments), i = {}, s = 0, o, u = ".zoom-" + e.event.changedTouches[0].identifier, f = "touchmove" + u, l = "touchend" + u, c = [], v = e.select(n).on(a, null).on(h, y), m = wt();
            ht.call(n), y(), N(r)
        }
        function O() {
            var s = d.of(this, arguments);
            c ? clearTimeout(c) : (n = w(r = i || e.mouse(this)), ht.call(this), N(s)), c = setTimeout(function() {
                c = null, k(s)
            }, 50), B(), S(Math.pow(2, Xt() * .002) * t.k), x(r, n), C(s)
        }
        function M() {
            var n = d.of(this, arguments), r = e.mouse(this), i = w(r), s = Math.log(t.k) / Math.LN2;
            N(n), S(Math.pow(2, e.event.shiftKey ? Math.ceil(s) - 1 : Math.floor(s) + 1)), x(r, i), C(n), k(n)
        }
        var t = {x: 0,y: 0,k: 1}, n, r, i, o = [960, 500], u = Wt, a = "mousedown.zoom", f = "mousemove.zoom", l = "mouseup.zoom", c, h = "touchstart.zoom", p, d = F(b, "zoomstart", "zoom", "zoomend"), v, m, g, y;
        return b.event = function(n) {
            n.each(function() {
                var n = d.of(this, arguments), r = t;
                wf ? e.select(this).transition().each("start.zoom", function() {
                    t = this.__chart__ || {x: 0,y: 0,k: 1}, N(n)
                }).tween("zoom:zoom", function() {
                    var i = o[0], s = o[1], u = i / 2, a = s / 2, f = e.interpolateZoom([(u - t.x) / t.k, (a - t.y) / t.k, i / t.k], [(u - r.x) / r.k, (a - r.y) / r.k, i / r.k]);
                    return function(e) {
                        var r = f(e), s = i / r[2];
                        this.__chart__ = t = {x: u - r[0] * s,y: a - r[1] * s,k: s}, C(n)
                    }
                }).each("end.zoom", function() {
                    k(n)
                }) : (this.__chart__ = t, N(n), C(n), k(n))
            })
        }, b.translate = function(e) {
            return arguments.length ? (t = {x: +e[0],y: +e[1],k: t.k}, T(), b) : [t.x, t.y]
        }, b.scale = function(e) {
            return arguments.length ? (t = {x: t.x,y: t.y,k: +e}, T(), b) : t.k
        }, b.scaleExtent = function(e) {
            return arguments.length ? (u = e == null ? Wt : [+e[0], +e[1]], b) : u
        }, b.center = function(e) {
            return arguments.length ? (i = e && [+e[0], +e[1]], b) : i
        }, b.size = function(e) {
            return arguments.length ? (o = e && [+e[0], +e[1]], b) : o
        }, b.x = function(e) {
            return arguments.length ? (m = e, v = e.copy(), t = {x: 0,y: 0,k: 1}, b) : m
        }, b.y = function(e) {
            return arguments.length ? (y = e, g = e.copy(), t = {x: 0,y: 0,k: 1}, b) : y
        }, e.rebind(b, d, "on")
    };
    var Wt = [0, Infinity], Xt, Vt = "onwheel" in r ? (Xt = function() {
        return -e.event.deltaY * (e.event.deltaMode ? 120 : 1)
    }, "wheel") : "onmousewheel" in r ? (Xt = function() {
        return e.event.wheelDelta
    }, "mousewheel") : (Xt = function() {
        return -e.event.detail
    }, "MozMousePixelScroll");
    e.color = $t, $t.prototype.toString = function() {
        return this.rgb() + ""
    }, e.hsl = Jt;
    var Kt = Jt.prototype = new $t;
    Kt.brighter = function(e) {
        return e = Math.pow(.7, arguments.length ? e : 1), new Jt(this.h, this.s, this.l / e)
    }, Kt.darker = function(e) {
        return e = Math.pow(.7, arguments.length ? e : 1), new Jt(this.h, this.s, e * this.l)
    }, Kt.rgb = function() {
        return Qt(this.h, this.s, this.l)
    }, e.hcl = Gt;
    var Yt = Gt.prototype = new $t;
    Yt.brighter = function(e) {
        return new Gt(this.h, this.c, Math.min(100, this.l + tn * (arguments.length ? e : 1)))
    }, Yt.darker = function(e) {
        return new Gt(this.h, this.c, Math.max(0, this.l - tn * (arguments.length ? e : 1)))
    }, Yt.rgb = function() {
        return Zt(this.h, this.c, this.l).rgb()
    }, e.lab = en;
    var tn = 18, nn = .95047, rn = 1, sn = 1.08883, on = en.prototype = new $t;
    on.brighter = function(e) {
        return new en(Math.min(100, this.l + tn * (arguments.length ? e : 1)), this.a, this.b)
    }, on.darker = function(e) {
        return new en(Math.max(0, this.l - tn * (arguments.length ? e : 1)), this.a, this.b)
    }, on.rgb = function() {
        return un(this.l, this.a, this.b)
    }, e.rgb = hn;
    var vn = hn.prototype = new $t;
    vn.brighter = function(e) {
        e = Math.pow(.7, arguments.length ? e : 1);
        var t = this.r, n = this.g, r = this.b, i = 30;
        return !t && !n && !r ? new hn(i, i, i) : (t && t < i && (t = i), n && n < i && (n = i), r && r < i && (r = i), new hn(Math.min(255, t / e), Math.min(255, n / e), Math.min(255, r / e)))
    }, vn.darker = function(e) {
        return e = Math.pow(.7, arguments.length ? e : 1), new hn(e * this.r, e * this.g, e * this.b)
    }, vn.hsl = function() {
        return yn(this.r, this.g, this.b)
    }, vn.toString = function() {
        return "#" + mn(this.r) + mn(this.g) + mn(this.b)
    };
    var Sn = e.map({aliceblue: 15792383,antiquewhite: 16444375,aqua: 65535,aquamarine: 8388564,azure: 15794175,beige: 16119260,bisque: 16770244,black: 0,blanchedalmond: 16772045,blue: 255,blueviolet: 9055202,brown: 10824234,burlywood: 14596231,cadetblue: 6266528,chartreuse: 8388352,chocolate: 13789470,coral: 16744272,cornflowerblue: 6591981,cornsilk: 16775388,crimson: 14423100,cyan: 65535,darkblue: 139,darkcyan: 35723,darkgoldenrod: 12092939,darkgray: 11119017,darkgreen: 25600,darkgrey: 11119017,darkkhaki: 12433259,darkmagenta: 9109643,darkolivegreen: 5597999,darkorange: 16747520,darkorchid: 10040012,darkred: 9109504,darksalmon: 15308410,darkseagreen: 9419919,darkslateblue: 4734347,darkslategray: 3100495,darkslategrey: 3100495,darkturquoise: 52945,darkviolet: 9699539,deeppink: 16716947,deepskyblue: 49151,dimgray: 6908265,dimgrey: 6908265,dodgerblue: 2003199,firebrick: 11674146,floralwhite: 16775920,forestgreen: 2263842,fuchsia: 16711935,gainsboro: 14474460,ghostwhite: 16316671,gold: 16766720,goldenrod: 14329120,gray: 8421504,green: 32768,greenyellow: 11403055,grey: 8421504,honeydew: 15794160,hotpink: 16738740,indianred: 13458524,indigo: 4915330,ivory: 16777200,khaki: 15787660,lavender: 15132410,lavenderblush: 16773365,lawngreen: 8190976,lemonchiffon: 16775885,lightblue: 11393254,lightcoral: 15761536,lightcyan: 14745599,lightgoldenrodyellow: 16448210,lightgray: 13882323,lightgreen: 9498256,lightgrey: 13882323,lightpink: 16758465,lightsalmon: 16752762,lightseagreen: 2142890,lightskyblue: 8900346,lightslategray: 7833753,lightslategrey: 7833753,lightsteelblue: 11584734,lightyellow: 16777184,lime: 65280,limegreen: 3329330,linen: 16445670,magenta: 16711935,maroon: 8388608,mediumaquamarine: 6737322,mediumblue: 205,mediumorchid: 12211667,mediumpurple: 9662683,mediumseagreen: 3978097,mediumslateblue: 8087790,mediumspringgreen: 64154,mediumturquoise: 4772300,mediumvioletred: 13047173,midnightblue: 1644912,mintcream: 16121850,mistyrose: 16770273,moccasin: 16770229,navajowhite: 16768685,navy: 128,oldlace: 16643558,olive: 8421376,olivedrab: 7048739,orange: 16753920,orangered: 16729344,orchid: 14315734,palegoldenrod: 15657130,palegreen: 10025880,paleturquoise: 11529966,palevioletred: 14381203,papayawhip: 16773077,peachpuff: 16767673,peru: 13468991,pink: 16761035,plum: 14524637,powderblue: 11591910,purple: 8388736,red: 16711680,rosybrown: 12357519,royalblue: 4286945,saddlebrown: 9127187,salmon: 16416882,sandybrown: 16032864,seagreen: 3050327,seashell: 16774638,sienna: 10506797,silver: 12632256,skyblue: 8900331,slateblue: 6970061,slategray: 7372944,slategrey: 7372944,snow: 16775930,springgreen: 65407,steelblue: 4620980,tan: 13808780,teal: 32896,thistle: 14204888,tomato: 16737095,turquoise: 4251856,violet: 15631086,wheat: 16113331,white: 16777215,whitesmoke: 16119285,yellow: 16776960,yellowgreen: 10145074});
    Sn.forEach(function(e, t) {
        Sn.set(e, pn(t))
    }), e.functor = xn, e.xhr = Nn(Tn), e.dsv = function(e, t) {
        function i(e, n, r) {
            arguments.length < 3 && (r = n, n = null);
            var i = Cn(e, t, n == null ? s : o(n), r);
            return i.row = function(e) {
                return arguments.length ? i.response((n = e) == null ? s : o(e)) : n
            }, i
        }
        function s(e) {
            return i.parse(e.responseText)
        }
        function o(e) {
            return function(t) {
                return i.parse(t.responseText, e)
            }
        }
        function u(t) {
            return t.map(a).join(e)
        }
        function a(e) {
            return n.test(e) ? '"' + e.replace(/\"/g, '""') + '"' : e
        }
        var n = new RegExp('["' + e + "\n]"), r = e.charCodeAt(0);
        return i.parse = function(e, t) {
            var n;
            return i.parseRows(e, function(e, r) {
                if (n)
                    return n(e, r - 1);
                var i = new Function("d", "return {" + e.map(function(e, t) {
                    return JSON.stringify(e) + ": d[" + t + "]"
                }).join(",") + "}");
                n = t ? function(e, n) {
                    return t(i(e), n)
                } : i
            })
        }, i.parseRows = function(e, t) {
            function c() {
                if (u >= o)
                    return i;
                if (l)
                    return l = !1, n;
                var t = u;
                if (e.charCodeAt(t) === 34) {
                    var s = t;
                    while (s++ < o)
                        if (e.charCodeAt(s) === 34) {
                            if (e.charCodeAt(s + 1) !== 34)
                                break;
                            ++s
                        }
                    u = s + 2;
                    var a = e.charCodeAt(s + 1);
                    return a === 13 ? (l = !0, e.charCodeAt(s + 2) === 10 && ++u) : a === 10 && (l = !0), e.substring(t + 1, s).replace(/""/g, '"')
                }
                while (u < o) {
                    var a = e.charCodeAt(u++), f = 1;
                    if (a === 10)
                        l = !0;
                    else if (a === 13)
                        l = !0, e.charCodeAt(u) === 10 && (++u, ++f);
                    else if (a !== r)
                        continue;
                    return e.substring(t, u - f)
                }
                return e.substring(t)
            }
            var n = {}, i = {}, s = [], o = e.length, u = 0, a = 0, f, l;
            while ((f = c()) !== i) {
                var h = [];
                while (f !== n && f !== i)
                    h.push(f), f = c();
                if (t && !(h = t(h, a++)))
                    continue;
                s.push(h)
            }
            return s
        }, i.format = function(t) {
            if (Array.isArray(t[0]))
                return i.formatRows(t);
            var n = new A, r = [];
            return t.forEach(function(e) {
                for (var t in e)
                    n.has(t) || r.push(n.add(t))
            }), [r.map(a).join(e)].concat(t.map(function(t) {
                return r.map(function(e) {
                    return a(t[e])
                }).join(e)
            })).join("\n")
        }, i.formatRows = function(e) {
            return e.map(u).join("\n")
        }, i
    }, e.csv = e.dsv(",", "text/csv"), e.tsv = e.dsv("	", "text/tab-separated-values"), e.touch = function(e, t, n) {
        arguments.length < 3 && (n = t, t = j().changedTouches);
        if (t)
            for (var r = 0, i = t.length, s; r < i; ++r)
                if ((s = t[r]).identifier === n)
                    return St(e, s)
    };
    var Ln, An, On, Mn, _n, Dn = s[M(s, "requestAnimationFrame")] || function(e) {
        setTimeout(e, 17)
    };
    e.timer = function(e, t, n) {
        var r = arguments.length;
        r < 2 && (t = 0), r < 3 && (n = Date.now());
        var i = n + t, s = {c: e,t: i,f: !1,n: null};
        An ? An.n = s : Ln = s, An = s, On || (Mn = clearTimeout(Mn), On = 1, Dn(Pn))
    }, e.timer.flush = function() {
        Hn(), Bn()
    }, e.round = function(e, t) {
        return t ? Math.round(e * (t = Math.pow(10, t))) / t : Math.round(e)
    };
    var Fn = ["y", "z", "a", "f", "p", "n", "µ", "m", "", "k", "M", "G", "T", "P", "E", "Z", "Y"].map(In);
    e.formatPrefix = function(t, n) {
        var r = 0;
        return t && (t < 0 && (t *= -1), n && (t = e.round(t, jn(t, n))), r = 1 + Math.floor(1e-12 + Math.log(t) / Math.LN10), r = Math.max(-24, Math.min(24, Math.floor((r - 1) / 3) * 3))), Fn[8 + r / 3]
    };
    var Rn = /(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i, Un = e.map({b: function(e) {
            return e.toString(2)
        },c: function(e) {
            return String.fromCharCode(e)
        },o: function(e) {
            return e.toString(8)
        },x: function(e) {
            return e.toString(16)
        },X: function(e) {
            return e.toString(16).toUpperCase()
        },g: function(e, t) {
            return e.toPrecision(t)
        },e: function(e, t) {
            return e.toExponential(t)
        },f: function(e, t) {
            return e.toFixed(t)
        },r: function(t, n) {
            return (t = e.round(t, jn(t, n))).toFixed(Math.max(0, Math.min(20, jn(t * (1 + 1e-15), n))))
        }}), Wn = e.time = {}, Xn = Date;
    Vn.prototype = {getDate: function() {
            return this._.getUTCDate()
        },getDay: function() {
            return this._.getUTCDay()
        },getFullYear: function() {
            return this._.getUTCFullYear()
        },getHours: function() {
            return this._.getUTCHours()
        },getMilliseconds: function() {
            return this._.getUTCMilliseconds()
        },getMinutes: function() {
            return this._.getUTCMinutes()
        },getMonth: function() {
            return this._.getUTCMonth()
        },getSeconds: function() {
            return this._.getUTCSeconds()
        },getTime: function() {
            return this._.getTime()
        },getTimezoneOffset: function() {
            return 0
        },valueOf: function() {
            return this._.valueOf()
        },setDate: function() {
            $n.setUTCDate.apply(this._, arguments)
        },setDay: function() {
            $n.setUTCDay.apply(this._, arguments)
        },setFullYear: function() {
            $n.setUTCFullYear.apply(this._, arguments)
        },setHours: function() {
            $n.setUTCHours.apply(this._, arguments)
        },setMilliseconds: function() {
            $n.setUTCMilliseconds.apply(this._, arguments)
        },setMinutes: function() {
            $n.setUTCMinutes.apply(this._, arguments)
        },setMonth: function() {
            $n.setUTCMonth.apply(this._, arguments)
        },setSeconds: function() {
            $n.setUTCSeconds.apply(this._, arguments)
        },setTime: function() {
            $n.setTime.apply(this._, arguments)
        }};
    var $n = Date.prototype;
    Wn.year = Jn(function(e) {
        return e = Wn.day(e), e.setMonth(0, 1), e
    }, function(e, t) {
        e.setFullYear(e.getFullYear() + t)
    }, function(e) {
        return e.getFullYear()
    }), Wn.years = Wn.year.range, Wn.years.utc = Wn.year.utc.range, Wn.day = Jn(function(e) {
        var t = new Xn(2e3, 0);
        return t.setFullYear(e.getFullYear(), e.getMonth(), e.getDate()), t
    }, function(e, t) {
        e.setDate(e.getDate() + t)
    }, function(e) {
        return e.getDate() - 1
    }), Wn.days = Wn.day.range, Wn.days.utc = Wn.day.utc.range, Wn.dayOfYear = function(e) {
        var t = Wn.year(e);
        return Math.floor((e - t - (e.getTimezoneOffset() - t.getTimezoneOffset()) * 6e4) / 864e5)
    }, ["sunday", "monday", "tuesday", "wednesday", "thursday", "friday", "saturday"].forEach(function(e, t) {
        t = 7 - t;
        var n = Wn[e] = Jn(function(e) {
            return (e = Wn.day(e)).setDate(e.getDate() - (e.getDay() + t) % 7), e
        }, function(e, t) {
            e.setDate(e.getDate() + Math.floor(t) * 7)
        }, function(e) {
            var n = Wn.year(e).getDay();
            return Math.floor((Wn.dayOfYear(e) + (n + t) % 7) / 7) - (n !== t)
        });
        Wn[e + "s"] = n.range, Wn[e + "s"].utc = n.utc.range, Wn[e + "OfYear"] = function(e) {
            var n = Wn.year(e).getDay();
            return Math.floor((Wn.dayOfYear(e) + (n + t) % 7) / 7)
        }
    }), Wn.week = Wn.sunday, Wn.weeks = Wn.sunday.range, Wn.weeks.utc = Wn.sunday.utc.range, Wn.weekOfYear = Wn.sundayOfYear;
    var Gn = {"-": "",_: " ",0: "0"}, Yn = /^\s*\d+/, Zn = /^%/;
    e.locale = function(e) {
        return {numberFormat: qn(e),timeFormat: Qn(e)}
    };
    var wr = e.locale({decimal: ".",thousands: ",",grouping: [3],currency: ["$", ""],dateTime: "%a %b %e %X %Y",date: "%m/%d/%Y",time: "%H:%M:%S",periods: ["AM", "PM"],days: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],shortDays: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],shortMonths: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]});
    e.format = wr.numberFormat, e.geo = {}, Er.prototype = {s: 0,t: 0,add: function(e) {
            xr(e, this.t, Sr), xr(Sr.s, this.s, this), this.s ? this.t += Sr.t : this.s = Sr.t
        },reset: function() {
            this.s = this.t = 0
        },valueOf: function() {
            return this.s
        }};
    var Sr = new Er;
    e.geo.stream = function(e, t) {
        e && Nr.hasOwnProperty(e.type) ? Nr[e.type](e, t) : Tr(e, t)
    };
    var Nr = {Feature: function(e, t) {
            Tr(e.geometry, t)
        },FeatureCollection: function(e, t) {
            var n = e.features, r = -1, i = n.length;
            while (++r < i)
                Tr(n[r].geometry, t)
        }}, Cr = {Sphere: function(e, t) {
            t.sphere()
        },Point: function(e, t) {
            e = e.coordinates, t.point(e[0], e[1], e[2])
        },MultiPoint: function(e, t) {
            var n = e.coordinates, r = -1, i = n.length;
            while (++r < i)
                e = n[r], t.point(e[0], e[1], e[2])
        },LineString: function(e, t) {
            kr(e.coordinates, t, 0)
        },MultiLineString: function(e, t) {
            var n = e.coordinates, r = -1, i = n.length;
            while (++r < i)
                kr(n[r], t, 0)
        },Polygon: function(e, t) {
            Lr(e.coordinates, t)
        },MultiPolygon: function(e, t) {
            var n = e.coordinates, r = -1, i = n.length;
            while (++r < i)
                Lr(n[r], t)
        },GeometryCollection: function(e, t) {
            var n = e.geometries, r = -1, i = n.length;
            while (++r < i)
                Tr(n[r], t)
        }};
    e.geo.area = function(t) {
        return Ar = 0, e.geo.stream(t, Mr), Ar
    };
    var Ar, Or = new Er, Mr = {sphere: function() {
            Ar += 4 * Ct
        },point: D,lineStart: D,lineEnd: D,polygonStart: function() {
            Or.reset(), Mr.lineStart = _r
        },polygonEnd: function() {
            var e = 2 * Or;
            Ar += e < 0 ? 4 * Ct + e : e, Mr.lineStart = Mr.lineEnd = Mr.point = D
        }};
    e.geo.bounds = function() {
        function p(e, s) {
            l.push(c = [t = e, r = e]), s < n && (n = s), s > i && (i = s)
        }
        function d(e, o) {
            var u = Dr([e * Mt, o * Mt]);
            if (a) {
                var f = Hr(a, u), l = [f[1], -f[0], 0], c = Hr(l, f);
                Fr(c), c = Ir(c);
                var h = e - s, d = h > 0 ? 1 : -1, v = c[0] * _t * d, m = y(h) > 180;
                if (m ^ (d * s < v && v < d * e)) {
                    var g = c[1] * _t;
                    g > i && (i = g)
                } else if (v = (v + 360) % 360 - 180, m ^ (d * s < v && v < d * e)) {
                    var g = -c[1] * _t;
                    g < n && (n = g)
                } else
                    o < n && (n = o), o > i && (i = o);
                m ? e < s ? E(t, e) > E(t, r) && (r = e) : E(e, r) > E(t, r) && (t = e) : r >= t ? (e < t && (t = e), e > r && (r = e)) : e > s ? E(t, e) > E(t, r) && (r = e) : E(e, r) > E(t, r) && (t = e)
            } else
                p(e, o);
            a = u, s = e
        }
        function v() {
            h.point = d
        }
        function m() {
            c[0] = t, c[1] = r, h.point = p, a = null
        }
        function g(e, t) {
            if (a) {
                var n = e - s;
                f += y(n) > 180 ? n + (n > 0 ? 360 : -360) : n
            } else
                o = e, u = t;
            Mr.point(e, t), d(e, t)
        }
        function b() {
            Mr.lineStart()
        }
        function w() {
            g(o, u), Mr.lineEnd(), y(f) > At && (t = -(r = 180)), c[0] = t, c[1] = r, a = null
        }
        function E(e, t) {
            return (t -= e) < 0 ? t + 360 : t
        }
        function S(e, t) {
            return e[0] - t[0]
        }
        function x(e, t) {
            return t[0] <= t[1] ? t[0] <= e && e <= t[1] : e < t[0] || t[1] < e
        }
        var t, n, r, i, s, o, u, a, f, l, c, h = {point: p,lineStart: v,lineEnd: m,polygonStart: function() {
                h.point = g, h.lineStart = b, h.lineEnd = w, f = 0, Mr.polygonStart()
            },polygonEnd: function() {
                Mr.polygonEnd(), h.point = p, h.lineStart = v, h.lineEnd = m, Or < 0 ? (t = -(r = 180), n = -(i = 90)) : f > At ? i = 90 : f < -At && (n = -90), c[0] = t, c[1] = r
            }};
        return function(s) {
            i = r = -(t = n = Infinity), l = [], e.geo.stream(s, h);
            var o = l.length;
            if (o) {
                l.sort(S);
                for (var u = 1, a = l[0], f, p = [a]; u < o; ++u)
                    f = l[u], x(f[0], a) || x(f[1], a) ? (E(a[0], f[1]) > E(a[0], a[1]) && (a[1] = f[1]), E(f[0], a[1]) > E(a[0], a[1]) && (a[0] = f[0])) : p.push(a = f);
                var d = -Infinity, v;
                for (var o = p.length - 1, u = 0, a = p[o], f; u <= o; a = f, ++u)
                    f = p[u], (v = E(a[1], f[0])) > d && (d = v, t = f[0], r = a[1])
            }
            return l = c = null, t === Infinity || n === Infinity ? [[NaN, NaN], [NaN, NaN]] : [[t, n], [r, i]]
        }
    }(), e.geo.centroid = function(t) {
        Rr = Ur = zr = Wr = Xr = Vr = $r = Jr = Kr = Qr = Gr = 0, e.geo.stream(t, Yr);
        var n = Kr, r = Qr, i = Gr, s = n * n + r * r + i * i;
        if (s < Ot) {
            n = Vr, r = $r, i = Jr, Ur < At && (n = zr, r = Wr, i = Xr), s = n * n + r * r + i * i;
            if (s < Ot)
                return [NaN, NaN]
        }
        return [Math.atan2(r, n) * _t, Bt(i / Math.sqrt(s)) * _t]
    };
    var Rr, Ur, zr, Wr, Xr, Vr, $r, Jr, Kr, Qr, Gr, Yr = {sphere: D,point: Zr,lineStart: ti,lineEnd: ni,polygonStart: function() {
            Yr.lineStart = ri
        },polygonEnd: function() {
            Yr.lineStart = ti
        }}, pi = ai(ii, di, mi, [-Ct, -Ct / 2]), bi = 1e9;
    e.geo.clipExtent = function() {
        var e, t, n, r, i, s, o = {stream: function(e) {
                return i && (i.valid = !1), i = s(e), i.valid = !0, i
            },extent: function(u) {
                return arguments.length ? (s = wi(e = +u[0][0], t = +u[0][1], n = +u[1][0], r = +u[1][1]), i && (i.valid = !1, i = null), o) : [[e, t], [n, r]]
            }};
        return o.extent([[0, 0], [960, 500]])
    }, (e.geo.conicEqualArea = function() {
        return Si(xi)
    }).raw = xi, e.geo.albers = function() {
        return e.geo.conicEqualArea().rotate([96, 0]).center([-0.6, 38.7]).parallels([29.5, 45.5]).scale(1070)
    }, e.geo.albersUsa = function() {
        function f(e) {
            var t = e[0], n = e[1];
            return i = null, (o(t, n), i) || (u(t, n), i) || a(t, n), i
        }
        var t = e.geo.albers(), n = e.geo.conicEqualArea().rotate([154, 0]).center([-2, 58.5]).parallels([55, 65]), r = e.geo.conicEqualArea().rotate([157, 0]).center([-3, 19.9]).parallels([8, 18]), i, s = {point: function(e, t) {
                i = [e, t]
            }}, o, u, a;
        return f.invert = function(e) {
            var i = t.scale(), s = t.translate(), o = (e[0] - s[0]) / i, u = (e[1] - s[1]) / i;
            return (u >= .12 && u < .234 && o >= -0.425 && o < -0.214 ? n : u >= .166 && u < .234 && o >= -0.214 && o < -0.115 ? r : t).invert(e)
        }, f.stream = function(e) {
            var i = t.stream(e), s = n.stream(e), o = r.stream(e);
            return {point: function(e, t) {
                    i.point(e, t), s.point(e, t), o.point(e, t)
                },sphere: function() {
                    i.sphere(), s.sphere(), o.sphere()
                },lineStart: function() {
                    i.lineStart(), s.lineStart(), o.lineStart()
                },lineEnd: function() {
                    i.lineEnd(), s.lineEnd(), o.lineEnd()
                },polygonStart: function() {
                    i.polygonStart(), s.polygonStart(), o.polygonStart()
                },polygonEnd: function() {
                    i.polygonEnd(), s.polygonEnd(), o.polygonEnd()
                }}
        }, f.precision = function(e) {
            return arguments.length ? (t.precision(e), n.precision(e), r.precision(e), f) : t.precision()
        }, f.scale = function(e) {
            return arguments.length ? (t.scale(e), n.scale(e * .35), r.scale(e), f.translate(t.translate())) : t.scale()
        }, f.translate = function(e) {
            if (!arguments.length)
                return t.translate();
            var i = t.scale(), l = +e[0], c = +e[1];
            return o = t.translate(e).clipExtent([[l - .455 * i, c - .238 * i], [l + .455 * i, c + .238 * i]]).stream(s).point, u = n.translate([l - .307 * i, c + .201 * i]).clipExtent([[l - .425 * i + At, c + .12 * i + At], [l - .214 * i - At, c + .234 * i - At]]).stream(s).point, a = r.translate([l - .205 * i, c + .212 * i]).clipExtent([[l - .214 * i + At, c + .166 * i + At], [l - .115 * i - At, c + .234 * i - At]]).stream(s).point, f
        }, f.scale(1070)
    };
    var Ti, Ni, Ci = {point: D,lineStart: D,lineEnd: D,polygonStart: function() {
            Ni = 0, Ci.lineStart = ki
        },polygonEnd: function() {
            Ci.lineStart = Ci.lineEnd = Ci.point = D, Ti += y(Ni / 2)
        }}, Li, Ai, Oi, Mi, _i = {point: Di,lineStart: D,lineEnd: D,polygonStart: D,polygonEnd: D}, Bi = {point: ji,lineStart: Fi,lineEnd: Ii,polygonStart: function() {
            Bi.lineStart = qi
        },polygonEnd: function() {
            Bi.point = ji, Bi.lineStart = Fi, Bi.lineEnd = Ii
        }};
    e.geo.path = function() {
        function u(n) {
            if (n) {
                typeof t == "function" && s.pointRadius(+t.apply(this, arguments));
                if (!o || !o.valid)
                    o = i(s);
                e.geo.stream(n, o)
            }
            return s.result()
        }
        function a() {
            return o = null, u
        }
        var t = 4.5, n, r, i, s, o;
        return u.area = function(t) {
            return Ti = 0, e.geo.stream(t, i(Ci)), Ti
        }, u.centroid = function(t) {
            return zr = Wr = Xr = Vr = $r = Jr = Kr = Qr = Gr = 0, e.geo.stream(t, i(Bi)), Gr ? [Kr / Gr, Qr / Gr] : Jr ? [Vr / Jr, $r / Jr] : Xr ? [zr / Xr, Wr / Xr] : [NaN, NaN]
        }, u.bounds = function(t) {
            return Oi = Mi = -(Li = Ai = Infinity), e.geo.stream(t, i(_i)), [[Li, Ai], [Oi, Mi]]
        }, u.projection = function(e) {
            return arguments.length ? (i = (n = e) ? e.stream || zi(e) : Tn, a()) : n
        }, u.context = function(e) {
            return arguments.length ? (s = (r = e) == null ? new Pi : new Ri(e), typeof t != "function" && s.pointRadius(t), a()) : r
        }, u.pointRadius = function(e) {
            return arguments.length ? (t = typeof e == "function" ? e : (s.pointRadius(+e), +e), u) : t
        }, u.projection(e.geo.albersUsa()).context(null)
    }, e.geo.transform = function(e) {
        return {stream: function(t) {
                var n = new Wi(t);
                for (var r in e)
                    n[r] = e[r];
                return n
            }}
    }, Wi.prototype = {point: function(e, t) {
            this.stream.point(e, t)
        },sphere: function() {
            this.stream.sphere()
        },lineStart: function() {
            this.stream.lineStart()
        },lineEnd: function() {
            this.stream.lineEnd()
        },polygonStart: function() {
            this.stream.polygonStart()
        },polygonEnd: function() {
            this.stream.polygonEnd()
        }}, e.geo.projection = Vi, e.geo.projectionMutator = $i, (e.geo.equirectangular = function() {
        return Vi(Ki)
    }).raw = Ki.invert = Ki, e.geo.rotation = function(e) {
        function t(t) {
            return t = e(t[0] * Mt, t[1] * Mt), t[0] *= _t, t[1] *= _t, t
        }
        return e = Gi(e[0] % 360 * Mt, e[1] * Mt, e.length > 2 ? e[2] * Mt : 0), t.invert = function(t) {
            return t = e.invert(t[0] * Mt, t[1] * Mt), t[0] *= _t, t[1] *= _t, t
        }, t
    }, Qi.invert = Ki, e.geo.circle = function() {
        function i() {
            var t = typeof e == "function" ? e.apply(this, arguments) : e, n = Gi(-t[0] * Mt, -t[1] * Mt, 0).invert, i = [];
            return r(null, null, 1, {point: function(e, t) {
                    i.push(e = n(e, t)), e[0] *= _t, e[1] *= _t
                }}), {type: "Polygon",coordinates: [i]}
        }
        var e = [0, 0], t, n = 6, r;
        return i.origin = function(t) {
            return arguments.length ? (e = t, i) : e
        }, i.angle = function(e) {
            return arguments.length ? (r = ts((t = +e) * Mt, n * Mt), i) : t
        }, i.precision = function(e) {
            return arguments.length ? (r = ts(t * Mt, (n = +e) * Mt), i) : n
        }, i.angle(90)
    }, e.geo.distance = function(e, t) {
        var n = (t[0] - e[0]) * Mt, r = e[1] * Mt, i = t[1] * Mt, s = Math.sin(n), o = Math.cos(n), u = Math.sin(r), a = Math.cos(r), f = Math.sin(i), l = Math.cos(i), c;
        return Math.atan2(Math.sqrt((c = l * s) * c + (c = a * f - u * l * o) * c), u * f + a * l * o)
    }, e.geo.graticule = function() {
        function b() {
            return {type: "MultiLineString",coordinates: w()}
        }
        function w() {
            return e.range(Math.ceil(i / c) * c, r, c).map(v).concat(e.range(Math.ceil(a / h) * h, u, h).map(m)).concat(e.range(Math.ceil(n / f) * f, t, f).filter(function(e) {
                return y(e % c) > At
            }).map(p)).concat(e.range(Math.ceil(o / l) * l, s, l).filter(function(e) {
                return y(e % h) > At
            }).map(d))
        }
        var t, n, r, i, s, o, u, a, f = 10, l = f, c = 90, h = 360, p, d, v, m, g = 2.5;
        return b.lines = function() {
            return w().map(function(e) {
                return {type: "LineString",coordinates: e}
            })
        }, b.outline = function() {
            return {type: "Polygon",coordinates: [v(i).concat(m(u).slice(1), v(r).reverse().slice(1), m(a).reverse().slice(1))]}
        }, b.extent = function(e) {
            return arguments.length ? b.majorExtent(e).minorExtent(e) : b.minorExtent()
        }, b.majorExtent = function(e) {
            return arguments.length ? (i = +e[0][0], r = +e[1][0], a = +e[0][1], u = +e[1][1], i > r && (e = i, i = r, r = e), a > u && (e = a, a = u, u = e), b.precision(g)) : [[i, a], [r, u]]
        }, b.minorExtent = function(e) {
            return arguments.length ? (n = +e[0][0], t = +e[1][0], o = +e[0][1], s = +e[1][1], n > t && (e = n, n = t, t = e), o > s && (e = o, o = s, s = e), b.precision(g)) : [[n, o], [t, s]]
        }, b.step = function(e) {
            return arguments.length ? b.majorStep(e).minorStep(e) : b.minorStep()
        }, b.majorStep = function(e) {
            return arguments.length ? (c = +e[0], h = +e[1], b) : [c, h]
        }, b.minorStep = function(e) {
            return arguments.length ? (f = +e[0], l = +e[1], b) : [f, l]
        }, b.precision = function(e) {
            return arguments.length ? (g = +e, p = rs(o, s, 90), d = is(n, t, g), v = rs(a, u, 90), m = is(i, r, g), b) : g
        }, b.majorExtent([[-180, -90 + At], [180, 90 - At]]).minorExtent([[-180, -80 - At], [180, 80 + At]])
    }, e.geo.greatArc = function() {
        function s() {
            return {type: "LineString",coordinates: [n || t.apply(this, arguments), i || r.apply(this, arguments)]}
        }
        var t = ss, n, r = os, i;
        return s.distance = function() {
            return e.geo.distance(n || t.apply(this, arguments), i || r.apply(this, arguments))
        }, s.source = function(e) {
            return arguments.length ? (t = e, n = typeof e == "function" ? null : e, s) : t
        }, s.target = function(e) {
            return arguments.length ? (r = e, i = typeof e == "function" ? null : e, s) : r
        }, s.precision = function() {
            return arguments.length ? s : 0
        }, s
    }, e.geo.interpolate = function(e, t) {
        return us(e[0] * Mt, e[1] * Mt, t[0] * Mt, t[1] * Mt)
    }, e.geo.length = function(t) {
        return as = 0, e.geo.stream(t, fs), as
    };
    var as, fs = {sphere: D,point: D,lineStart: ls,lineEnd: D,polygonStart: D,polygonEnd: D}, hs = cs(function(e) {
        return Math.sqrt(2 / (1 + e))
    }, function(e) {
        return 2 * Math.asin(e / 2)
    });
    (e.geo.azimuthalEqualArea = function() {
        return Vi(hs)
    }).raw = hs;
    var ps = cs(function(e) {
        var t = Math.acos(e);
        return t && t / Math.sin(t)
    }, Tn);
    (e.geo.azimuthalEquidistant = function() {
        return Vi(ps)
    }).raw = ps, (e.geo.conicConformal = function() {
        return Si(ds)
    }).raw = ds, (e.geo.conicEquidistant = function() {
        return Si(vs)
    }).raw = vs;
    var ms = cs(function(e) {
        return 1 / e
    }, Math.atan);
    (e.geo.gnomonic = function() {
        return Vi(ms)
    }).raw = ms, gs.invert = function(e, t) {
        return [e, 2 * Math.atan(Math.exp(t)) - Lt]
    }, (e.geo.mercator = function() {
        return ys(gs)
    }).raw = gs;
    var bs = cs(function() {
        return 1
    }, Math.asin);
    (e.geo.orthographic = function() {
        return Vi(bs)
    }).raw = bs;
    var ws = cs(function(e) {
        return 1 / (1 + e)
    }, function(e) {
        return 2 * Math.atan(e)
    });
    (e.geo.stereographic = function() {
        return Vi(ws)
    }).raw = ws, Es.invert = function(e, t) {
        return [-t, 2 * Math.atan(Math.exp(e)) - Lt]
    }, (e.geo.transverseMercator = function() {
        var e = ys(Es), t = e.center, n = e.rotate;
        return e.center = function(e) {
            return e ? t([-e[1], e[0]]) : (e = t(), [e[1], -e[0]])
        }, e.rotate = function(e) {
            return e ? n([e[0], e[1], e.length > 2 ? e[2] + 90 : 90]) : (e = n(), [e[0], e[1], e[2] - 90])
        }, n([0, 0, 90])
    }).raw = Es, e.geom = {}, e.geom.hull = function(e) {
        function r(e) {
            if (e.length < 3)
                return [];
            var r = xn(t), i = xn(n), s, o = e.length, u = [], a = [];
            for (s = 0; s < o; s++)
                u.push([+r.call(this, e[s], s), +i.call(this, e[s], s), s]);
            u.sort(Ns);
            for (s = 0; s < o; s++)
                a.push([u[s][0], -u[s][1]]);
            var f = Ts(u), l = Ts(a), c = l[0] === f[0], h = l[l.length - 1] === f[f.length - 1], p = [];
            for (s = f.length - 1; s >= 0; --s)
                p.push(e[u[f[s]][2]]);
            for (s = +c; s < l.length - h; ++s)
                p.push(e[u[l[s]][2]]);
            return p
        }
        var t = Ss, n = xs;
        return arguments.length ? r(e) : (r.x = function(e) {
            return arguments.length ? (t = e, r) : t
        }, r.y = function(e) {
            return arguments.length ? (n = e, r) : n
        }, r)
    }, e.geom.polygon = function(e) {
        return q(e, Cs), e
    };
    var Cs = e.geom.polygon.prototype = [];
    Cs.area = function() {
        var e = -1, t = this.length, n, r = this[t - 1], i = 0;
        while (++e < t)
            n = r, r = this[e], i += n[1] * r[0] - n[0] * r[1];
        return i * .5
    }, Cs.centroid = function(e) {
        var t = -1, n = this.length, r = 0, i = 0, s, o = this[n - 1], u;
        arguments.length || (e = -1 / (6 * this.area()));
        while (++t < n)
            s = o, o = this[t], u = s[0] * o[1] - o[0] * s[1], r += (s[0] + o[0]) * u, i += (s[1] + o[1]) * u;
        return [r * e, i * e]
    }, Cs.clip = function(e) {
        var t, n = As(e), r = -1, i = this.length - As(this), s, o, u = this[i - 1], a, f, l;
        while (++r < i) {
            t = e.slice(), e.length = 0, a = this[r], f = t[(o = t.length - n) - 1], s = -1;
            while (++s < o)
                l = t[s], ks(l, u, a) ? (ks(f, u, a) || e.push(Ls(f, l, u, a)), e.push(l)) : ks(f, u, a) && e.push(Ls(f, l, u, a)), f = l;
            n && e.push(e[0]), u = a
        }
        return e
    };
    var Os, Ms, _s, Ds = [], Ps, Hs, Bs = [];
    Ws.prototype.prepare = function() {
        var e = this.edges, t = e.length, n;
        while (t--)
            n = e[t].edge, (!n.b || !n.a) && e.splice(t, 1);
        return e.sort(Vs), e.length
    }, no.prototype = {start: function() {
            return this.edge.l === this.site ? this.edge.a : this.edge.b
        },end: function() {
            return this.edge.l === this.site ? this.edge.b : this.edge.a
        }}, ro.prototype = {insert: function(e, t) {
            var n, r, i;
            if (e) {
                t.P = e, t.N = e.N, e.N && (e.N.P = t), e.N = t;
                if (e.R) {
                    e = e.R;
                    while (e.L)
                        e = e.L;
                    e.L = t
                } else
                    e.R = t;
                n = e
            } else
                this._ ? (e = uo(this._), t.P = null, t.N = e, e.P = e.L = t, n = e) : (t.P = t.N = null, this._ = t, n = null);
            t.L = t.R = null, t.U = n, t.C = !0, e = t;
            while (n && n.C)
                r = n.U, n === r.L ? (i = r.R, i && i.C ? (n.C = i.C = !1, r.C = !0, e = r) : (e === n.R && (so(this, n), e = n, n = e.U), n.C = !1, r.C = !0, oo(this, r))) : (i = r.L, i && i.C ? (n.C = i.C = !1, r.C = !0, e = r) : (e === n.L && (oo(this, n), e = n, n = e.U), n.C = !1, r.C = !0, so(this, r))), n = e.U;
            this._.C = !1
        },remove: function(e) {
            e.N && (e.N.P = e.P), e.P && (e.P.N = e.N), e.N = e.P = null;
            var t = e.U, n, r = e.L, i = e.R, s, o;
            r ? i ? s = uo(i) : s = r : s = i, t ? t.L === e ? t.L = s : t.R = s : this._ = s, r && i ? (o = s.C, s.C = e.C, s.L = r, r.U = s, s !== i ? (t = s.U, s.U = e.U, e = s.R, t.L = e, s.R = i, i.U = s) : (s.U = t, t = s, e = s.R)) : (o = e.C, e = s), e && (e.U = t);
            if (o)
                return;
            if (e && e.C) {
                e.C = !1;
                return
            }
            do {
                if (e === this._)
                    break;
                if (e === t.L) {
                    n = t.R, n.C && (n.C = !1, t.C = !0, so(this, t), n = t.R);
                    if (n.L && n.L.C || n.R && n.R.C) {
                        if (!n.R || !n.R.C)
                            n.L.C = !1, n.C = !0, oo(this, n), n = t.R;
                        n.C = t.C, t.C = n.R.C = !1, so(this, t), e = this._;
                        break
                    }
                } else {
                    n = t.L, n.C && (n.C = !1, t.C = !0, oo(this, t), n = t.L);
                    if (n.L && n.L.C || n.R && n.R.C) {
                        if (!n.L || !n.L.C)
                            n.R.C = !1, n.C = !0, so(this, n), n = t.L;
                        n.C = t.C, t.C = n.L.C = !1, oo(this, t), e = this._;
                        break
                    }
                }
                n.C = !0, e = t, t = t.U
            } while (!e.C);
            e && (e.C = !1)
        }}, e.geom.voronoi = function(e) {
        function o(e) {
            var t = new Array(e.length), n = s[0][0], r = s[0][1], i = s[1][0], o = s[1][1];
            return ao(u(e), s).cells.forEach(function(s, u) {
                var a = s.edges, f = s.site, l = t[u] = a.length ? a.map(function(e) {
                    var t = e.start();
                    return [t.x, t.y]
                }) : f.x >= n && f.x <= i && f.y >= r && f.y <= o ? [[n, o], [i, o], [i, r], [n, r]] : [];
                l.point = e[u]
            }), t
        }
        function u(e) {
            return e.map(function(e, t) {
                return {x: Math.round(r(e, t) / At) * At,y: Math.round(i(e, t) / At) * At,i: t}
            })
        }
        var t = Ss, n = xs, r = t, i = n, s = lo;
        return e ? o(e) : (o.links = function(e) {
            return ao(u(e)).edges.filter(function(e) {
                return e.l && e.r
            }).map(function(t) {
                return {source: e[t.l.i],target: e[t.r.i]}
            })
        }, o.triangles = function(e) {
            var t = [];
            return ao(u(e)).cells.forEach(function(n, r) {
                var i = n.site, s = n.edges.sort(Vs), o = -1, u = s.length, a, f, l = s[u - 1].edge, c = l.l === i ? l.r : l.l;
                while (++o < u)
                    a = l, f = c, l = s[o].edge, c = l.l === i ? l.r : l.l, r < f.i && r < c.i && co(i, f, c) < 0 && t.push([e[r], e[f.i], e[c.i]])
            }), t
        }, o.x = function(e) {
            return arguments.length ? (r = xn(t = e), o) : t
        }, o.y = function(e) {
            return arguments.length ? (i = xn(n = e), o) : n
        }, o.clipExtent = function(e) {
            return arguments.length ? (s = e == null ? lo : e, o) : s === lo ? null : s
        }, o.size = function(e) {
            return arguments.length ? o.clipExtent(e && [[0, 0], e]) : s === lo ? null : s && s[1]
        }, o)
    };
    var lo = [[-1e6, -1e6], [1e6, 1e6]];
    e.geom.delaunay = function(t) {
        return e.geom.voronoi().triangles(t)
    }, e.geom.quadtree = function(e, t, n, r, i) {
        function a(e) {
            function T(e, t, n, r, i, s, o, u) {
                if (isNaN(n) || isNaN(r))
                    return;
                if (e.leaf) {
                    var a = e.x, f = e.y;
                    if (a != null)
                        if (y(a - n) + y(f - r) < .01)
                            N(e, t, n, r, i, s, o, u);
                        else {
                            var l = e.point;
                            e.x = e.y = e.point = null, N(e, l, a, f, i, s, o, u), N(e, t, n, r, i, s, o, u)
                        }
                    else
                        e.x = n, e.y = r, e.point = t
                } else
                    N(e, t, n, r, i, s, o, u)
            }
            function N(e, t, n, r, i, s, o, u) {
                var a = (i + o) * .5, f = (s + u) * .5, l = n >= a, c = r >= f, h = (c << 1) + l;
                e.leaf = !1, e = e.nodes[h] || (e.nodes[h] = vo()), l ? i = a : o = a, c ? s = f : u = f, T(e, t, n, r, i, s, o, u)
            }
            var a, f = xn(s), l = xn(o), c, h, p, d, v, m, g, b;
            if (t != null)
                v = t, m = n, g = r, b = i;
            else {
                g = b = -(v = m = Infinity), c = [], h = [], d = e.length;
                if (u)
                    for (p = 0; p < d; ++p)
                        a = e[p], a.x < v && (v = a.x), a.y < m && (m = a.y), a.x > g && (g = a.x), a.y > b && (b = a.y), c.push(a.x), h.push(a.y);
                else
                    for (p = 0; p < d; ++p) {
                        var w = +f(a = e[p], p), E = +l(a, p);
                        w < v && (v = w), E < m && (m = E), w > g && (g = w), E > b && (b = E), c.push(w), h.push(E)
                    }
            }
            var S = g - v, x = b - m;
            S > x ? b = m + S : g = v + x;
            var C = vo();
            C.add = function(e) {
                T(C, e, +f(e, ++p), +l(e, p), v, m, g, b)
            }, C.visit = function(e) {
                mo(e, C, v, m, g, b)
            }, p = -1;
            if (t == null) {
                while (++p < d)
                    T(C, e[p], c[p], h[p], v, m, g, b);
                --p
            } else
                e.forEach(C.add);
            return c = h = e = a = null, C
        }
        var s = Ss, o = xs, u;
        return (u = arguments.length) ? (s = ho, o = po, u === 3 && (i = n, r = t, n = t = 0), a(e)) : (a.x = function(e) {
            return arguments.length ? (s = e, a) : s
        }, a.y = function(e) {
            return arguments.length ? (o = e, a) : o
        }, a.extent = function(e) {
            return arguments.length ? (e == null ? t = n = r = i = null : (t = +e[0][0], n = +e[0][1], r = +e[1][0], i = +e[1][1]), a) : t == null ? null : [[t, n], [r, i]]
        }, a.size = function(e) {
            return arguments.length ? (e == null ? t = n = r = i = null : (t = n = 0, r = +e[0], i = +e[1]), a) : t == null ? null : [r - t, i - n]
        }, a)
    }, e.interpolateRgb = go, e.interpolateObject = yo, e.interpolateNumber = bo, e.interpolateString = wo;
    var Eo = /[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g, So = new RegExp(Eo.source, "g");
    e.interpolate = xo, e.interpolators = [function(e, t) {
            var n = typeof t;
            return (n === "string" ? Sn.has(t) || /^(#|rgb\(|hsl\()/.test(t) ? go : wo : t instanceof $t ? go : Array.isArray(t) ? To : n === "object" && isNaN(t) ? yo : bo)(e, t)
        }], e.interpolateArray = To;
    var No = function() {
        return Tn
    }, Co = e.map({linear: No,poly: Po,quad: function() {
            return Mo
        },cubic: function() {
            return _o
        },sin: function() {
            return Ho
        },exp: function() {
            return Bo
        },circle: function() {
            return jo
        },elastic: Fo,back: Io,bounce: function() {
            return qo
        }}), ko = e.map({"in": Tn,out: Ao,"in-out": Oo,"out-in": function(e) {
            return Oo(Ao(e))
        }});
    e.ease = function(e) {
        var n = e.indexOf("-"), r = n >= 0 ? e.substring(0, n) : e, i = n >= 0 ? e.substring(n + 1) : "in";
        return r = Co.get(r) || No, i = ko.get(i) || Tn, Lo(i(r.apply(null, t.call(arguments, 1))))
    }, e.interpolateHcl = Ro, e.interpolateHsl = Uo, e.interpolateLab = zo, e.interpolateRound = Wo, e.transform = function(t) {
        var n = r.createElementNS(e.ns.prefix.svg, "g");
        return (e.transform = function(e) {
            if (e != null) {
                n.setAttribute("transform", e);
                var t = n.transform.baseVal.consolidate()
            }
            return new Xo(t ? t.matrix : Ko)
        })(t)
    }, Xo.prototype.toString = function() {
        return "translate(" + this.translate + ")rotate(" + this.rotate + ")skewX(" + this.skew + ")scale(" + this.scale + ")"
    };
    var Ko = {a: 1,b: 0,c: 0,d: 1,e: 0,f: 0};
    e.interpolateTransform = Qo, e.layout = {}, e.layout.bundle = function() {
        return function(e) {
            var t = [], n = -1, r = e.length;
            while (++n < r)
                t.push(Zo(e[n]));
            return t
        }
    }, e.layout.chord = function() {
        function l() {
            var t = {}, l = [], h = e.range(s), p = [], d, v, m, g, y;
            n = [], r = [], d = 0, g = -1;
            while (++g < s) {
                v = 0, y = -1;
                while (++y < s)
                    v += i[g][y];
                l.push(v), p.push(e.range(s)), d += v
            }
            u && h.sort(function(e, t) {
                return u(l[e], l[t])
            }), a && p.forEach(function(e, t) {
                e.sort(function(e, n) {
                    return a(i[t][e], i[t][n])
                })
            }), d = (kt - o * s) / d, v = 0, g = -1;
            while (++g < s) {
                m = v, y = -1;
                while (++y < s) {
                    var b = h[g], w = p[b][y], E = i[b][w], S = v, x = v += E * d;
                    t[b + "-" + w] = {index: b,subindex: w,startAngle: S,endAngle: x,value: E}
                }
                r[b] = {index: b,startAngle: m,endAngle: v,value: (v - m) / d}, v += o
            }
            g = -1;
            while (++g < s) {
                y = g - 1;
                while (++y < s) {
                    var T = t[g + "-" + y], N = t[y + "-" + g];
                    (T.value || N.value) && n.push(T.value < N.value ? {source: N,target: T} : {source: T,target: N})
                }
            }
            f && c()
        }
        function c() {
            n.sort(function(e, t) {
                return f((e.source.value + e.target.value) / 2, (t.source.value + t.target.value) / 2)
            })
        }
        var t = {}, n, r, i, s, o = 0, u, a, f;
        return t.matrix = function(e) {
            return arguments.length ? (s = (i = e) && i.length, n = r = null, t) : i
        }, t.padding = function(e) {
            return arguments.length ? (o = e, n = r = null, t) : o
        }, t.sortGroups = function(e) {
            return arguments.length ? (u = e, n = r = null, t) : u
        }, t.sortSubgroups = function(e) {
            return arguments.length ? (a = e, n = null, t) : a
        }, t.sortChords = function(e) {
            return arguments.length ? (f = e, n && c(), t) : f
        }, t.chords = function() {
            return n || l(), n
        }, t.groups = function() {
            return r || l(), r
        }, t
    }, e.layout.force = function() {
        function y(e) {
            return function(t, n, r, i) {
                if (t.point !== e) {
                    var s = t.cx - e.x, o = t.cy - e.y, u = i - n, a = s * s + o * o;
                    if (u * u / h < a) {
                        if (a < l) {
                            var f = t.charge / a;
                            e.px -= s * f, e.py -= o * f
                        }
                        return !0
                    }
                    if (t.point && a && a < l) {
                        var f = t.pointCharge / a;
                        e.px -= s * f, e.py -= o * f
                    }
                }
                return !t.charge
            }
        }
        function b(n) {
            n.px = e.event.x, n.py = e.event.y, t.resume()
        }
        var t = {}, n = e.dispatch("start", "tick", "end"), r = [1, 1], i, s, o = .9, u = uu, a = au, f = -30, l = fu, c = .1, h = .64, p = [], d = [], v, m, g;
        return t.tick = function() {
            if ((s *= .99) < .005)
                return n.end({type: "end",alpha: s = 0}), !0;
            var t = p.length, i = d.length, u, a, l, h, b, w, E, S, x;
            for (a = 0; a < i; ++a) {
                l = d[a], h = l.source, b = l.target, S = b.x - h.x, x = b.y - h.y;
                if (w = S * S + x * x)
                    w = s * m[a] * ((w = Math.sqrt(w)) - v[a]) / w, S *= w, x *= w, b.x -= S * (E = h.weight / (b.weight + h.weight)), b.y -= x * E, h.x += S * (E = 1 - E), h.y += x * E
            }
            if (E = s * c) {
                S = r[0] / 2, x = r[1] / 2, a = -1;
                if (E)
                    while (++a < t)
                        l = p[a], l.x += (S - l.x) * E, l.y += (x - l.y) * E
            }
            if (f) {
                ou(u = e.geom.quadtree(p), s, g), a = -1;
                while (++a < t)
                    (l = p[a]).fixed || u.visit(y(l))
            }
            a = -1;
            while (++a < t)
                l = p[a], l.fixed ? (l.x = l.px, l.y = l.py) : (l.x -= (l.px - (l.px = l.x)) * o, l.y -= (l.py - (l.py = l.y)) * o);
            n.tick({type: "tick",alpha: s})
        }, t.nodes = function(e) {
            return arguments.length ? (p = e, t) : p
        }, t.links = function(e) {
            return arguments.length ? (d = e, t) : d
        }, t.size = function(e) {
            return arguments.length ? (r = e, t) : r
        }, t.linkDistance = function(e) {
            return arguments.length ? (u = typeof e == "function" ? e : +e, t) : u
        }, t.distance = t.linkDistance, t.linkStrength = function(e) {
            return arguments.length ? (a = typeof e == "function" ? e : +e, t) : a
        }, t.friction = function(e) {
            return arguments.length ? (o = +e, t) : o
        }, t.charge = function(e) {
            return arguments.length ? (f = typeof e == "function" ? e : +e, t) : f
        }, t.chargeDistance = function(e) {
            return arguments.length ? (l = e * e, t) : Math.sqrt(l)
        }, t.gravity = function(e) {
            return arguments.length ? (c = +e, t) : c
        }, t.theta = function(e) {
            return arguments.length ? (h = e * e, t) : Math.sqrt(h)
        }, t.alpha = function(r) {
            return arguments.length ? (r = +r, s ? r > 0 ? s = r : s = 0 : r > 0 && (n.start({type: "start",alpha: s = r}), e.timer(t.tick)), t) : s
        }, t.start = function() {
            function h(t, r) {
                if (!l) {
                    l = new Array(n);
                    for (o = 0; o < n; ++o)
                        l[o] = [];
                    for (o = 0; o < u; ++o) {
                        var i = d[o];
                        l[i.source.index].push(i.target), l[i.target.index].push(i.source)
                    }
                }
                var s = l[e], o = -1, u = s.length, a;
                while (++o < u)
                    if (!isNaN(a = s[o][t]))
                        return a;
                return Math.random() * r
            }
            var e, n = p.length, i = d.length, s = r[0], o = r[1], l, c;
            for (e = 0; e < n; ++e)
                (c = p[e]).index = e, c.weight = 0;
            for (e = 0; e < i; ++e)
                c = d[e], typeof c.source == "number" && (c.source = p[c.source]), typeof c.target == "number" && (c.target = p[c.target]), ++c.source.weight, ++c.target.weight;
            for (e = 0; e < n; ++e)
                c = p[e], isNaN(c.x) && (c.x = h("x", s)), isNaN(c.y) && (c.y = h("y", o)), isNaN(c.px) && (c.px = c.x), isNaN(c.py) && (c.py = c.y);
            v = [];
            if (typeof u == "function")
                for (e = 0; e < i; ++e)
                    v[e] = +u.call(this, d[e], e);
            else
                for (e = 0; e < i; ++e)
                    v[e] = u;
            m = [];
            if (typeof a == "function")
                for (e = 0; e < i; ++e)
                    m[e] = +a.call(this, d[e], e);
            else
                for (e = 0; e < i; ++e)
                    m[e] = a;
            g = [];
            if (typeof f == "function")
                for (e = 0; e < n; ++e)
                    g[e] = +f.call(this, p[e], e);
            else
                for (e = 0; e < n; ++e)
                    g[e] = f;
            return t.resume()
        }, t.resume = function() {
            return t.alpha(.1)
        }, t.stop = function() {
            return t.alpha(0)
        }, t.drag = function() {
            i || (i = e.behavior.drag().origin(Tn).on("dragstart.force", nu).on("drag.force", b).on("dragend.force", ru));
            if (!arguments.length)
                return i;
            this.on("mouseover.force", iu).on("mouseout.force", su).call(i)
        }, e.rebind(t, n, "on")
    };
    var uu = 20, au = 1, fu = Infinity;
    e.layout.hierarchy = function() {
        function r(i) {
            var s = [i], o = [], u;
            i.depth = 0;
            while ((u = s.pop()) != null) {
                o.push(u);
                if ((f = t.call(r, u, u.depth)) && (a = f.length)) {
                    var a, f, l;
                    while (--a >= 0)
                        s.push(l = f[a]), l.parent = u, l.depth = u.depth + 1;
                    n && (u.value = 0), u.children = f
                } else
                    n && (u.value = +n.call(r, u, u.depth) || 0), delete u.children
            }
            return hu(i, function(t) {
                var r, i;
                e && (r = t.children) && r.sort(e), n && (i = t.parent) && (i.value += t.value)
            }), o
        }
        var e = vu, t = pu, n = du;
        return r.sort = function(t) {
            return arguments.length ? (e = t, r) : e
        }, r.children = function(e) {
            return arguments.length ? (t = e, r) : t
        }, r.value = function(e) {
            return arguments.length ? (n = e, r) : n
        }, r.revalue = function(e) {
            return n && (cu(e, function(e) {
                e.children && (e.value = 0)
            }), hu(e, function(e) {
                var t;
                e.children || (e.value = +n.call(r, e, e.depth) || 0);
                if (t = e.parent)
                    t.value += e.value
            })), e
        }, r
    }, e.layout.partition = function() {
        function r(e, t, n, i) {
            var s = e.children;
            e.x = t, e.y = e.depth * i, e.dx = n, e.dy = i;
            if (s && (u = s.length)) {
                var o = -1, u, a, f;
                n = e.value ? n / e.value : 0;
                while (++o < u)
                    r(a = s[o], t, f = a.value * n, i), t += f
            }
        }
        function i(e) {
            var t = e.children, n = 0;
            if (t && (s = t.length)) {
                var r = -1, s;
                while (++r < s)
                    n = Math.max(n, i(t[r]))
            }
            return 1 + n
        }
        function s(e, s) {
            var o = t.call(this, e, s);
            return r(o[0], 0, n[0], n[1] / i(o[0])), o
        }
        var t = e.layout.hierarchy(), n = [1, 1];
        return s.size = function(e) {
            return arguments.length ? (n = e, s) : n
        }, lu(s, t)
    }, e.layout.pie = function() {
        function s(o) {
            var u = o.map(function(e, n) {
                return +t.call(s, e, n)
            }), a = +(typeof r == "function" ? r.apply(this, arguments) : r), f = ((typeof i == "function" ? i.apply(this, arguments) : i) - a) / e.sum(u), l = e.range(o.length);
            n != null && l.sort(n === gu ? function(e, t) {
                return u[t] - u[e]
            } : function(e, t) {
                return n(o[e], o[t])
            });
            var c = [];
            return l.forEach(function(e) {
                var t;
                c[e] = {data: o[e],value: t = u[e],startAngle: a,endAngle: a += t * f}
            }), c
        }
        var t = Number, n = gu, r = 0, i = kt;
        return s.value = function(e) {
            return arguments.length ? (t = e, s) : t
        }, s.sort = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.startAngle = function(e) {
            return arguments.length ? (r = e, s) : r
        }, s.endAngle = function(e) {
            return arguments.length ? (i = e, s) : i
        }, s
    };
    var gu = {};
    e.layout.stack = function() {
        function u(a, f) {
            var l = a.map(function(e, n) {
                return t.call(u, e, n)
            }), c = l.map(function(e) {
                return e.map(function(e, t) {
                    return [s.call(u, e, t), o.call(u, e, t)]
                })
            }), h = n.call(u, c, f);
            l = e.permute(l, h), c = e.permute(c, h);
            var p = r.call(u, c, f), d = l.length, v = l[0].length, m, g, y;
            for (g = 0; g < v; ++g) {
                i.call(u, l[0][g], y = p[g], c[0][g][1]);
                for (m = 1; m < d; ++m)
                    i.call(u, l[m][g], y += c[m - 1][g][1], c[m][g][1])
            }
            return a
        }
        var t = Tn, n = xu, r = Tu, i = wu, s = yu, o = bu;
        return u.values = function(e) {
            return arguments.length ? (t = e, u) : t
        }, u.order = function(e) {
            return arguments.length ? (n = typeof e == "function" ? e : Eu.get(e) || xu, u) : n
        }, u.offset = function(e) {
            return arguments.length ? (r = typeof e == "function" ? e : Su.get(e) || Tu, u) : r
        }, u.x = function(e) {
            return arguments.length ? (s = e, u) : s
        }, u.y = function(e) {
            return arguments.length ? (o = e, u) : o
        }, u.out = function(e) {
            return arguments.length ? (i = e, u) : i
        }, u
    };
    var Eu = e.map({"inside-out": function(t) {
            var n = t.length, r, i, s = t.map(Nu), o = t.map(Cu), u = e.range(n).sort(function(e, t) {
                return s[e] - s[t]
            }), a = 0, f = 0, l = [], c = [];
            for (r = 0; r < n; ++r)
                i = u[r], a < f ? (a += o[i], l.push(i)) : (f += o[i], c.push(i));
            return c.reverse().concat(l)
        },reverse: function(t) {
            return e.range(t.length).reverse()
        },"default": xu}), Su = e.map({silhouette: function(e) {
            var t = e.length, n = e[0].length, r = [], i = 0, s, o, u, a = [];
            for (o = 0; o < n; ++o) {
                for (s = 0, u = 0; s < t; s++)
                    u += e[s][o][1];
                u > i && (i = u), r.push(u)
            }
            for (o = 0; o < n; ++o)
                a[o] = (i - r[o]) / 2;
            return a
        },wiggle: function(e) {
            var t = e.length, n = e[0], r = n.length, i, s, o, u, a, f, l, c, h, p = [];
            p[0] = c = h = 0;
            for (s = 1; s < r; ++s) {
                for (i = 0, u = 0; i < t; ++i)
                    u += e[i][s][1];
                for (i = 0, a = 0, l = n[s][0] - n[s - 1][0]; i < t; ++i) {
                    for (o = 0, f = (e[i][s][1] - e[i][s - 1][1]) / (2 * l); o < i; ++o)
                        f += (e[o][s][1] - e[o][s - 1][1]) / l;
                    a += f * e[i][s][1]
                }
                p[s] = c -= u ? a / u * l : 0, c < h && (h = c)
            }
            for (s = 0; s < r; ++s)
                p[s] -= h;
            return p
        },expand: function(e) {
            var t = e.length, n = e[0].length, r = 1 / t, i, s, o, u = [];
            for (s = 0; s < n; ++s) {
                for (i = 0, o = 0; i < t; i++)
                    o += e[i][s][1];
                if (o)
                    for (i = 0; i < t; i++)
                        e[i][s][1] /= o;
                else
                    for (i = 0; i < t; i++)
                        e[i][s][1] = r
            }
            for (s = 0; s < n; ++s)
                u[s] = 0;
            return u
        },zero: Tu});
    e.layout.histogram = function() {
        function s(s, o) {
            var u = [], a = s.map(n, this), f = r.call(this, a, o), l = i.call(this, f, a, o), c, o = -1, h = a.length, p = l.length - 1, d = t ? 1 : 1 / h, v;
            while (++o < p)
                c = u[o] = [], c.dx = l[o + 1] - (c.x = l[o]), c.y = 0;
            if (p > 0) {
                o = -1;
                while (++o < h)
                    v = a[o], v >= f[0] && v <= f[1] && (c = u[e.bisect(l, v, 1, p) - 1], c.y += d, c.push(s[o]))
            }
            return u
        }
        var t = !0, n = Number, r = Ou, i = Lu;
        return s.value = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.range = function(e) {
            return arguments.length ? (r = xn(e), s) : r
        }, s.bins = function(e) {
            return arguments.length ? (i = typeof e == "number" ? function(t) {
                return Au(t, e)
            } : xn(e), s) : i
        }, s.frequency = function(e) {
            return arguments.length ? (t = !!e, s) : t
        }, s
    }, e.layout.pack = function() {
        function s(e, s) {
            var o = t.call(this, e, s), u = o[0], a = r[0], f = r[1], l = i == null ? Math.sqrt : typeof i == "function" ? i : function() {
                return i
            };
            u.x = u.y = 0, hu(u, function(e) {
                e.r = +l(e.value)
            }), hu(u, Hu);
            if (n) {
                var c = n * (i ? 1 : Math.max(2 * u.r / a, 2 * u.r / f)) / 2;
                hu(u, function(e) {
                    e.r += c
                }), hu(u, Hu), hu(u, function(e) {
                    e.r -= c
                })
            }
            return Fu(u, a / 2, f / 2, i ? 1 : 1 / Math.max(2 * u.r / a, 2 * u.r / f)), o
        }
        var t = e.layout.hierarchy().sort(Mu), n = 0, r = [1, 1], i;
        return s.size = function(e) {
            return arguments.length ? (r = e, s) : r
        }, s.radius = function(e) {
            return arguments.length ? (i = e == null || typeof e == "function" ? e : +e, s) : i
        }, s.padding = function(e) {
            return arguments.length ? (n = +e, s) : n
        }, lu(s, t)
    }, e.layout.tree = function() {
        function s(e, s) {
            var f = t.call(this, e, s), c = f[0], h = o(c);
            hu(h, u), h.parent.m = -h.z, cu(h, a);
            if (i)
                cu(c, l);
            else {
                var p = c, d = c, v = c;
                cu(c, function(e) {
                    e.x < p.x && (p = e), e.x > d.x && (d = e), e.depth > v.depth && (v = e)
                });
                var m = n(p, d) / 2 - p.x, g = r[0] / (d.x + n(d, p) / 2 + m), y = r[1] / (v.depth || 1);
                cu(c, function(e) {
                    e.x = (e.x + m) * g, e.y = e.depth * y
                })
            }
            return f
        }
        function o(e) {
            var t = {A: null,children: [e]}, n = [t], r;
            while ((r = n.pop()) != null)
                for (var i = r.children, s, o = 0, u = i.length; o < u; ++o)
                    n.push((i[o] = s = {_: i[o],parent: r,children: (s = i[o].children) && s.slice() || [],A: null,a: null,z: 0,m: 0,c: 0,s: 0,t: null,i: o}).a = s);
            return t.children[0]
        }
        function u(e) {
            var t = e.children, r = e.parent.children, i = e.i ? r[e.i - 1] : null;
            if (t.length) {
                Wu(e);
                var s = (t[0].z + t[t.length - 1].z) / 2;
                i ? (e.z = i.z + n(e._, i._), e.m = e.z - s) : e.z = s
            } else
                i && (e.z = i.z + n(e._, i._));
            e.parent.A = f(e, i, e.parent.A || r[0])
        }
        function a(e) {
            e._.x = e.z + e.parent.m, e.m += e.parent.m
        }
        function f(e, t, r) {
            if (t) {
                var i = e, s = e, o = t, u = i.parent.children[0], a = i.m, f = s.m, l = o.m, c = u.m, h;
                while (o = Uu(o), i = Ru(i), o && i)
                    u = Ru(u), s = Uu(s), s.a = e, h = o.z + l - i.z - a + n(o._, i._), h > 0 && (zu(Xu(o, e, r), e, h), a += h, f += h), l += o.m, a += i.m, c += u.m, f += s.m;
                o && !Uu(s) && (s.t = o, s.m += l - f), i && !Ru(u) && (u.t = i, u.m += a - c, r = e)
            }
            return r
        }
        function l(e) {
            e.x *= r[0], e.y = e.depth * r[1]
        }
        var t = e.layout.hierarchy().sort(null).value(null), n = qu, r = [1, 1], i = null;
        return s.separation = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.size = function(e) {
            return arguments.length ? (i = (r = e) == null ? l : null, s) : i ? null : r
        }, s.nodeSize = function(e) {
            return arguments.length ? (i = (r = e) == null ? null : l, s) : i ? r : null
        }, lu(s, t)
    }, e.layout.cluster = function() {
        function s(e, s) {
            var o = t.call(this, e, s), u = o[0], a, f = 0;
            hu(u, function(e) {
                var t = e.children;
                t && t.length ? (e.x = $u(t), e.y = Vu(t)) : (e.x = a ? f += n(e, a) : 0, e.y = 0, a = e)
            });
            var l = Ju(u), c = Ku(u), h = l.x - n(l, c) / 2, p = c.x + n(c, l) / 2;
            return hu(u, i ? function(e) {
                e.x = (e.x - u.x) * r[0], e.y = (u.y - e.y) * r[1]
            } : function(e) {
                e.x = (e.x - h) / (p - h) * r[0], e.y = (1 - (u.y ? e.y / u.y : 1)) * r[1]
            }), o
        }
        var t = e.layout.hierarchy().sort(null).value(null), n = qu, r = [1, 1], i = !1;
        return s.separation = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.size = function(e) {
            return arguments.length ? (i = (r = e) == null, s) : i ? null : r
        }, s.nodeSize = function(e) {
            return arguments.length ? (i = (r = e) != null, s) : i ? r : null
        }, lu(s, t)
    }, e.layout.treemap = function() {
        function l(e, t) {
            var n = -1, r = e.length, i, s;
            while (++n < r)
                s = (i = e[n]).value * (t < 0 ? 0 : t), i.area = isNaN(s) || s <= 0 ? 0 : s
        }
        function c(e) {
            var t = e.children;
            if (t && t.length) {
                var n = s(e), r = [], i = t.slice(), o, u = Infinity, f, h = a === "slice" ? n.dx : a === "dice" ? n.dy : a === "slice-dice" ? e.depth & 1 ? n.dy : n.dx : Math.min(n.dx, n.dy), v;
                l(i, n.dx * n.dy / e.value), r.area = 0;
                while ((v = i.length) > 0)
                    r.push(o = i[v - 1]), r.area += o.area, a !== "squarify" || (f = p(r, h)) <= u ? (i.pop(), u = f) : (r.area -= r.pop().area, d(r, h, n, !1), h = Math.min(n.dx, n.dy), r.length = r.area = 0, u = Infinity);
                r.length && (d(r, h, n, !0), r.length = r.area = 0), t.forEach(c)
            }
        }
        function h(e) {
            var t = e.children;
            if (t && t.length) {
                var n = s(e), r = t.slice(), i, o = [];
                l(r, n.dx * n.dy / e.value), o.area = 0;
                while (i = r.pop())
                    o.push(i), o.area += i.area, i.z != null && (d(o, i.z ? n.dx : n.dy, n, !r.length), o.length = o.area = 0);
                t.forEach(h)
            }
        }
        function p(e, t) {
            var n = e.area, r, i = 0, s = Infinity, o = -1, u = e.length;
            while (++o < u) {
                if (!(r = e[o].area))
                    continue;
                r < s && (s = r), r > i && (i = r)
            }
            return n *= n, t *= t, n ? Math.max(t * i * f / n, n / (t * s * f)) : Infinity
        }
        function d(e, t, r, i) {
            var s = -1, o = e.length, u = r.x, a = r.y, f = t ? n(e.area / t) : 0, l;
            if (t == r.dx) {
                if (i || f > r.dy)
                    f = r.dy;
                while (++s < o)
                    l = e[s], l.x = u, l.y = a, l.dy = f, u += l.dx = Math.min(r.x + r.dx - u, f ? n(l.area / f) : 0);
                l.z = !0, l.dx += r.x + r.dx - u, r.y += f, r.dy -= f
            } else {
                if (i || f > r.dx)
                    f = r.dx;
                while (++s < o)
                    l = e[s], l.x = u, l.y = a, l.dx = f, a += l.dy = Math.min(r.y + r.dy - a, f ? n(l.area / f) : 0);
                l.z = !1, l.dy += r.y + r.dy - a, r.x += f, r.dx -= f
            }
        }
        function v(e) {
            var n = u || t(e), i = n[0];
            return i.x = 0, i.y = 0, i.dx = r[0], i.dy = r[1], u && t.revalue(i), l([i], i.dx * i.dy / i.value), (u ? h : c)(i), o && (u = n), n
        }
        var t = e.layout.hierarchy(), n = Math.round, r = [1, 1], i = null, s = Qu, o = !1, u, a = "squarify", f = .5 * (1 + Math.sqrt(5));
        return v.size = function(e) {
            return arguments.length ? (r = e, v) : r
        }, v.padding = function(e) {
            function t(t) {
                var n = e.call(v, t, t.depth);
                return n == null ? Qu(t) : Gu(t, typeof n == "number" ? [n, n, n, n] : n)
            }
            function n(t) {
                return Gu(t, e)
            }
            if (!arguments.length)
                return i;
            var r;
            return s = (i = e) == null ? Qu : (r = typeof e) === "function" ? t : r === "number" ? (e = [e, e, e, e], n) : n, v
        }, v.round = function(e) {
            return arguments.length ? (n = e ? Math.round : Number, v) : n != Number
        }, v.sticky = function(e) {
            return arguments.length ? (o = e, u = null, v) : o
        }, v.ratio = function(e) {
            return arguments.length ? (f = e, v) : f
        }, v.mode = function(e) {
            return arguments.length ? (a = e + "", v) : a
        }, lu(v, t)
    }, e.random = {normal: function(e, t) {
            var n = arguments.length;
            return n < 2 && (t = 1), n < 1 && (e = 0), function() {
                var n, r, i;
                do
                    n = Math.random() * 2 - 1, r = Math.random() * 2 - 1, i = n * n + r * r;
                while (!i || i > 1);
                return e + t * n * Math.sqrt(-2 * Math.log(i) / i)
            }
        },logNormal: function() {
            var t = e.random.normal.apply(e, arguments);
            return function() {
                return Math.exp(t())
            }
        },bates: function(t) {
            var n = e.random.irwinHall(t);
            return function() {
                return n() / t
            }
        },irwinHall: function(e) {
            return function() {
                for (var t = 0, n = 0; n < e; n++)
                    t += Math.random();
                return t
            }
        }}, e.scale = {};
    var ra = {floor: Tn,ceil: Tn};
    e.scale.linear = function() {
        return sa([0, 1], [0, 1], xo, !1)
    };
    var ca = {s: 1,g: 1,p: 1,r: 1,e: 1};
    e.scale.log = function() {
        return da(e.scale.linear().domain([0, 1]), 10, !0, [1, 10])
    };
    var va = e.format(".0e"), ma = {floor: function(e) {
            return -Math.ceil(-e)
        },ceil: function(e) {
            return -Math.floor(-e)
        }};
    e.scale.pow = function() {
        return ga(e.scale.linear(), 1, [0, 1])
    }, e.scale.sqrt = function() {
        return e.scale.pow().exponent(.5)
    }, e.scale.ordinal = function() {
        return ba([], {t: "range",a: [[]]})
    }, e.scale.category10 = function() {
        return e.scale.ordinal().range(wa)
    }, e.scale.category20 = function() {
        return e.scale.ordinal().range(Ea)
    }, e.scale.category20b = function() {
        return e.scale.ordinal().range(Sa)
    }, e.scale.category20c = function() {
        return e.scale.ordinal().range(xa)
    };
    var wa = [2062260, 16744206, 2924588, 14034728, 9725885, 9197131, 14907330, 8355711, 12369186, 1556175].map(dn), Ea = [2062260, 11454440, 16744206, 16759672, 2924588, 10018698, 14034728, 16750742, 9725885, 12955861, 9197131, 12885140, 14907330, 16234194, 8355711, 13092807, 12369186, 14408589, 1556175, 10410725].map(dn), Sa = [3750777, 5395619, 7040719, 10264286, 6519097, 9216594, 11915115, 13556636, 9202993, 12426809, 15186514, 15190932, 8666169, 11356490, 14049643, 15177372, 8077683, 10834324, 13528509, 14589654].map(dn), xa = [3244733, 7057110, 10406625, 13032431, 15095053, 16616764, 16625259, 16634018, 3253076, 7652470, 10607003, 13101504, 7695281, 10394312, 12369372, 14342891, 6513507, 9868950, 12434877, 14277081].map(dn);
    e.scale.quantile = function() {
        return Ta([], [])
    }, e.scale.quantize = function() {
        return Na(0, 1, [0, 1])
    }, e.scale.threshold = function() {
        return Ca([.5], [0, 1])
    }, e.scale.identity = function() {
        return ka([0, 1])
    }, e.svg = {}, e.svg.arc = function() {
        function i() {
            var i = e.apply(this, arguments), s = t.apply(this, arguments), o = n.apply(this, arguments) + La, u = r.apply(this, arguments) + La, a = (u < o && (a = o, o = u, u = a), u - o), f = a < Ct ? "0" : "1", l = Math.cos(o), c = Math.sin(o), h = Math.cos(u), p = Math.sin(u);
            return a >= Aa ? i ? "M0," + s + "A" + s + "," + s + " 0 1,1 0," + -s + "A" + s + "," + s + " 0 1,1 0," + s + "M0," + i + "A" + i + "," + i + " 0 1,0 0," + -i + "A" + i + "," + i + " 0 1,0 0," + i + "Z" : "M0," + s + "A" + s + "," + s + " 0 1,1 0," + -s + "A" + s + "," + s + " 0 1,1 0," + s + "Z" : i ? "M" + s * l + "," + s * c + "A" + s + "," + s + " 0 " + f + ",1 " + s * h + "," + s * p + "L" + i * h + "," + i * p + "A" + i + "," + i + " 0 " + f + ",0 " + i * l + "," + i * c + "Z" : "M" + s * l + "," + s * c + "A" + s + "," + s + " 0 " + f + ",1 " + s * h + "," + s * p + "L0,0" + "Z"
        }
        var e = Oa, t = Ma, n = _a, r = Da;
        return i.innerRadius = function(t) {
            return arguments.length ? (e = xn(t), i) : e
        }, i.outerRadius = function(e) {
            return arguments.length ? (t = xn(e), i) : t
        }, i.startAngle = function(e) {
            return arguments.length ? (n = xn(e), i) : n
        }, i.endAngle = function(e) {
            return arguments.length ? (r = xn(e), i) : r
        }, i.centroid = function() {
            var i = (e.apply(this, arguments) + t.apply(this, arguments)) / 2, s = (n.apply(this, arguments) + r.apply(this, arguments)) / 2 + La;
            return [Math.cos(s) * i, Math.sin(s) * i]
        }, i
    };
    var La = -Lt, Aa = kt - At;
    e.svg.line = function() {
        return Pa(Tn)
    };
    var Ha = e.map({linear: Ba,"linear-closed": ja,step: Fa,"step-before": Ia,"step-after": qa,basis: Va,"basis-open": $a,"basis-closed": Ja,bundle: Ka,cardinal: za,"cardinal-open": Ra,"cardinal-closed": Ua,monotone: sf});
    Ha.forEach(function(e, t) {
        t.key = e, t.closed = /-closed$/.test(e)
    });
    var Ga = [0, 2 / 3, 1 / 3, 0], Ya = [0, 1 / 3, 2 / 3, 0], Za = [0, 1 / 6, 2 / 3, 1 / 6];
    e.svg.line.radial = function() {
        var e = Pa(of);
        return e.radius = e.x, delete e.x, e.angle = e.y, delete e.y, e
    }, Ia.reverse = qa, qa.reverse = Ia, e.svg.area = function() {
        return uf(Tn)
    }, e.svg.area.radial = function() {
        var e = uf(of);
        return e.radius = e.x, delete e.x, e.innerRadius = e.x0, delete e.x0, e.outerRadius = e.x1, delete e.x1, e.angle = e.y, delete e.y, e.startAngle = e.y0, delete e.y0, e.endAngle = e.y1, delete e.y1, e
    }, e.svg.chord = function() {
        function s(n, r) {
            var i = o(this, e, n, r), s = o(this, t, n, r);
            return "M" + i.p0 + a(i.r, i.p1, i.a1 - i.a0) + (u(i, s) ? f(i.r, i.p1, i.r, i.p0) : f(i.r, i.p1, s.r, s.p0) + a(s.r, s.p1, s.a1 - s.a0) + f(s.r, s.p1, i.r, i.p0)) + "Z"
        }
        function o(e, t, s, o) {
            var u = t.call(e, s, o), a = n.call(e, u, o), f = r.call(e, u, o) + La, l = i.call(e, u, o) + La;
            return {r: a,a0: f,a1: l,p0: [a * Math.cos(f), a * Math.sin(f)],p1: [a * Math.cos(l), a * Math.sin(l)]}
        }
        function u(e, t) {
            return e.a0 == t.a0 && e.a1 == t.a1
        }
        function a(e, t, n) {
            return "A" + e + "," + e + " 0 " + +(n > Ct) + ",1 " + t
        }
        function f(e, t, n, r) {
            return "Q 0,0 " + r
        }
        var e = ss, t = os, n = af, r = _a, i = Da;
        return s.radius = function(e) {
            return arguments.length ? (n = xn(e), s) : n
        }, s.source = function(t) {
            return arguments.length ? (e = xn(t), s) : e
        }, s.target = function(e) {
            return arguments.length ? (t = xn(e), s) : t
        }, s.startAngle = function(e) {
            return arguments.length ? (r = xn(e), s) : r
        }, s.endAngle = function(e) {
            return arguments.length ? (i = xn(e), s) : i
        }, s
    }, e.svg.diagonal = function() {
        function r(r, i) {
            var s = e.call(this, r, i), o = t.call(this, r, i), u = (s.y + o.y) / 2, a = [s, {x: s.x,y: u}, {x: o.x,y: u}, o];
            return a = a.map(n), "M" + a[0] + "C" + a[1] + " " + a[2] + " " + a[3]
        }
        var e = ss, t = os, n = ff;
        return r.source = function(t) {
            return arguments.length ? (e = xn(t), r) : e
        }, r.target = function(e) {
            return arguments.length ? (t = xn(e), r) : t
        }, r.projection = function(e) {
            return arguments.length ? (n = e, r) : n
        }, r
    }, e.svg.diagonal.radial = function() {
        var t = e.svg.diagonal(), n = ff, r = t.projection;
        return t.projection = function(e) {
            return arguments.length ? r(lf(n = e)) : n
        }, t
    }, e.svg.symbol = function() {
        function n(n, r) {
            return (df.get(e.call(this, n, r)) || pf)(t.call(this, n, r))
        }
        var e = hf, t = cf;
        return n.type = function(t) {
            return arguments.length ? (e = xn(t), n) : e
        }, n.size = function(e) {
            return arguments.length ? (t = xn(e), n) : t
        }, n
    };
    var df = e.map({circle: pf,cross: function(e) {
            var t = Math.sqrt(e / 5) / 2;
            return "M" + -3 * t + "," + -t + "H" + -t + "V" + -3 * t + "H" + t + "V" + -t + "H" + 3 * t + "V" + t + "H" + t + "V" + 3 * t + "H" + -t + "V" + t + "H" + -3 * t + "Z"
        },diamond: function(e) {
            var t = Math.sqrt(e / (2 * mf)), n = t * mf;
            return "M0," + -t + "L" + n + ",0" + " 0," + t + " " + -n + ",0" + "Z"
        },square: function(e) {
            var t = Math.sqrt(e) / 2;
            return "M" + -t + "," + -t + "L" + t + "," + -t + " " + t + "," + t + " " + -t + "," + t + "Z"
        },"triangle-down": function(e) {
            var t = Math.sqrt(e / vf), n = t * vf / 2;
            return "M0," + n + "L" + t + "," + -n + " " + -t + "," + -n + "Z"
        },"triangle-up": function(e) {
            var t = Math.sqrt(e / vf), n = t * vf / 2;
            return "M0," + -n + "L" + t + "," + n + " " + -t + "," + n + "Z"
        }});
    e.svg.symbolTypes = df.keys();
    var vf = Math.sqrt(3), mf = Math.tan(30 * Mt), yf = [], bf = 0, wf, Ef;
    yf.call = V.call, yf.empty = V.empty, yf.node = V.node, yf.size = V.size, e.transition = function(e) {
        return arguments.length ? wf ? e.transition() : e : pt.transition()
    }, e.transition.prototype = yf, yf.select = function(e) {
        var t = this.id, n = [], r, i, s;
        e = $(e);
        for (var o = -1, u = this.length; ++o < u; ) {
            n.push(r = []);
            for (var a = this[o], f = -1, l = a.length; ++f < l; )
                (s = a[f]) && (i = e.call(s, s.__data__, f, o)) ? ("__data__" in s && (i.__data__ = s.__data__), Tf(i, f, t, s.__transition__[t]), r.push(i)) : r.push(null)
        }
        return gf(n, t)
    }, yf.selectAll = function(e) {
        var t = this.id, n = [], r, i, s, o, u;
        e = J(e);
        for (var a = -1, f = this.length; ++a < f; )
            for (var l = this[a], c = -1, h = l.length; ++c < h; )
                if (s = l[c]) {
                    u = s.__transition__[t], i = e.call(s, s.__data__, c, a), n.push(r = []);
                    for (var p = -1, d = i.length; ++p < d; )
                        (o = i[p]) && Tf(o, p, t, u), r.push(o)
                }
        return gf(n, t)
    }, yf.filter = function(e) {
        var t = [], n, r, i;
        typeof e != "function" && (e = ot(e));
        for (var s = 0, o = this.length; s < o; s++) {
            t.push(n = []);
            for (var r = this[s], u = 0, a = r.length; u < a; u++)
                (i = r[u]) && e.call(i, i.__data__, u, s) && n.push(i)
        }
        return gf(t, this.id)
    }, yf.tween = function(e, t) {
        var n = this.id;
        return arguments.length < 2 ? this.node().__transition__[n].tween.get(e) : at(this, t == null ? function(t) {
            t.__transition__[n].tween.remove(e)
        } : function(r) {
            r.__transition__[n].tween.set(e, t)
        })
    }, yf.attr = function(t, n) {
        function s() {
            this.removeAttribute(i)
        }
        function o() {
            this.removeAttributeNS(i.space, i.local)
        }
        function u(e) {
            return e == null ? s : (e += "", function() {
                var t = this.getAttribute(i), n;
                return t !== e && (n = r(t, e), function(e) {
                    this.setAttribute(i, n(e))
                })
            })
        }
        function a(e) {
            return e == null ? o : (e += "", function() {
                var t = this.getAttributeNS(i.space, i.local), n;
                return t !== e && (n = r(t, e), function(e) {
                    this.setAttributeNS(i.space, i.local, n(e))
                })
            })
        }
        if (arguments.length < 2) {
            for (n in t)
                this.attr(n, t[n]);
            return this
        }
        var r = t == "transform" ? Qo : xo, i = e.ns.qualify(t);
        return Sf(this, "attr." + t, n, i.local ? a : u)
    }, yf.attrTween = function(t, n) {
        function i(e, t) {
            var i = n.call(this, e, t, this.getAttribute(r));
            return i && function(e) {
                this.setAttribute(r, i(e))
            }
        }
        function s(e, t) {
            var i = n.call(this, e, t, this.getAttributeNS(r.space, r.local));
            return i && function(e) {
                this.setAttributeNS(r.space, r.local, i(e))
            }
        }
        var r = e.ns.qualify(t);
        return this.tween("attr." + t, r.local ? s : i)
    }, yf.style = function(e, t, n) {
        function i() {
            this.style.removeProperty(e)
        }
        function o(t) {
            return t == null ? i : (t += "", function() {
                var r = s.getComputedStyle(this, null).getPropertyValue(e), i;
                return r !== t && (i = xo(r, t), function(t) {
                    this.style.setProperty(e, i(t), n)
                })
            })
        }
        var r = arguments.length;
        if (r < 3) {
            if (typeof e != "string") {
                r < 2 && (t = "");
                for (n in e)
                    this.style(n, e[n], t);
                return this
            }
            n = ""
        }
        return Sf(this, "style." + e, t, o)
    }, yf.styleTween = function(e, t, n) {
        function r(r, i) {
            var o = t.call(this, r, i, s.getComputedStyle(this, null).getPropertyValue(e));
            return o && function(t) {
                this.style.setProperty(e, o(t), n)
            }
        }
        return arguments.length < 3 && (n = ""), this.tween("style." + e, r)
    }, yf.text = function(e) {
        return Sf(this, "text", e, xf)
    }, yf.remove = function() {
        return this.each("end.transition", function() {
            var e;
            this.__transition__.count < 2 && (e = this.parentNode) && e.removeChild(this)
        })
    }, yf.ease = function(t) {
        var n = this.id;
        return arguments.length < 1 ? this.node().__transition__[n].ease : (typeof t != "function" && (t = e.ease.apply(e, arguments)), at(this, function(e) {
            e.__transition__[n].ease = t
        }))
    }, yf.delay = function(e) {
        var t = this.id;
        return arguments.length < 1 ? this.node().__transition__[t].delay : at(this, typeof e == "function" ? function(n, r, i) {
            n.__transition__[t].delay = +e.call(n, n.__data__, r, i)
        } : (e = +e, function(n) {
            n.__transition__[t].delay = e
        }))
    }, yf.duration = function(e) {
        var t = this.id;
        return arguments.length < 1 ? this.node().__transition__[t].duration : at(this, typeof e == "function" ? function(n, r, i) {
            n.__transition__[t].duration = Math.max(1, e.call(n, n.__data__, r, i))
        } : (e = Math.max(1, e), function(n) {
            n.__transition__[t].duration = e
        }))
    }, yf.each = function(t, n) {
        var r = this.id;
        if (arguments.length < 2) {
            var i = Ef, s = wf;
            wf = r, at(this, function(e, n, i) {
                Ef = e.__transition__[r], t.call(e, e.__data__, n, i)
            }), Ef = i, wf = s
        } else
            at(this, function(i) {
                var s = i.__transition__[r];
                (s.event || (s.event = e.dispatch("start", "end"))).on(t, n)
            });
        return this
    }, yf.transition = function() {
        var e = this.id, t = ++bf, n = [], r, i, s, o;
        for (var u = 0, a = this.length; u < a; u++) {
            n.push(r = []);
            for (var i = this[u], f = 0, l = i.length; f < l; f++) {
                if (s = i[f])
                    o = Object.create(s.__transition__[e]), o.delay += o.duration, Tf(s, f, t, o);
                r.push(s)
            }
        }
        return gf(n, t)
    }, e.svg.axis = function() {
        function f(f) {
            f.each(function() {
                var f = e.select(this), l = this.__chart__ || t, c = this.__chart__ = t.copy(), h = u == null ? c.ticks ? c.ticks.apply(c, o) : c.domain() : u, p = a == null ? c.tickFormat ? c.tickFormat.apply(c, o) : Tn : a, d = f.selectAll(".tick").data(h, c), v = d.enter().insert("g", ".domain").attr("class", "tick").style("opacity", At), m = e.transition(d.exit()).style("opacity", At).remove(), g = e.transition(d.order()).style("opacity", 1), y, b = Zu(c), w = f.selectAll(".domain").data([0]), E = (w.enter().append("path").attr("class", "domain"), e.transition(w));
                v.append("line"), v.append("text");
                var S = v.select("line"), x = g.select("line"), T = d.select("text").text(p), N = v.select("text"), C = g.select("text");
                switch (n) {
                    case "bottom":
                        y = kf, S.attr("y2", r), N.attr("y", Math.max(r, 0) + s), x.attr("x2", 0).attr("y2", r), C.attr("x", 0).attr("y", Math.max(r, 0) + s), T.attr("dy", ".71em").style("text-anchor", "middle"), E.attr("d", "M" + b[0] + "," + i + "V0H" + b[1] + "V" + i);
                        break;
                    case "top":
                        y = kf, S.attr("y2", -r), N.attr("y", -(Math.max(r, 0) + s)), x.attr("x2", 0).attr("y2", -r), C.attr("x", 0).attr("y", -(Math.max(r, 0) + s)), T.attr("dy", "0em").style("text-anchor", "middle"), E.attr("d", "M" + b[0] + "," + -i + "V0H" + b[1] + "V" + -i);
                        break;
                    case "left":
                        y = Lf, S.attr("x2", -r), N.attr("x", -(Math.max(r, 0) + s)), x.attr("x2", -r).attr("y2", 0), C.attr("x", -(Math.max(r, 0) + s)).attr("y", 0), T.attr("dy", ".32em").style("text-anchor", "end"), E.attr("d", "M" + -i + "," + b[0] + "H0V" + b[1] + "H" + -i);
                        break;
                    case "right":
                        y = Lf, S.attr("x2", r), N.attr("x", Math.max(r, 0) + s), x.attr("x2", r).attr("y2", 0), C.attr("x", Math.max(r, 0) + s).attr("y", 0), T.attr("dy", ".32em").style("text-anchor", "start"), E.attr("d", "M" + i + "," + b[0] + "H0V" + b[1] + "H" + i)
                }
                if (c.rangeBand) {
                    var k = c, L = k.rangeBand() / 2;
                    l = c = function(e) {
                        return k(e) + L
                    }
                } else
                    l.rangeBand ? l = c : m.call(y, c);
                v.call(y, l), g.call(y, c)
            })
        }
        var t = e.scale.linear(), n = Nf, r = 6, i = 6, s = 3, o = [10], u = null, a;
        return f.scale = function(e) {
            return arguments.length ? (t = e, f) : t
        }, f.orient = function(e) {
            return arguments.length ? (n = e in Cf ? e + "" : Nf, f) : n
        }, f.ticks = function() {
            return arguments.length ? (o = arguments, f) : o
        }, f.tickValues = function(e) {
            return arguments.length ? (u = e, f) : u
        }, f.tickFormat = function(e) {
            return arguments.length ? (a = e, f) : a
        }, f.tickSize = function(e) {
            var t = arguments.length;
            return t ? (r = +e, i = +arguments[t - 1], f) : r
        }, f.innerTickSize = function(e) {
            return arguments.length ? (r = +e, f) : r
        }, f.outerTickSize = function(e) {
            return arguments.length ? (i = +e, f) : i
        }, f.tickPadding = function(e) {
            return arguments.length ? (s = +e, f) : s
        }, f.tickSubdivide = function() {
            return arguments.length && f
        }, f
    };
    var Nf = "bottom", Cf = {top: 1,right: 1,bottom: 1,left: 1};
    e.svg.brush = function() {
        function h(t) {
            t.each(function() {
                var t = e.select(this).style("pointer-events", "all").style("-webkit-tap-highlight-color", "rgba(0,0,0,0)").on("mousedown.brush", m).on("touchstart.brush", m), i = t.selectAll(".background").data([0]);
                i.enter().append("rect").attr("class", "background").style("visibility", "hidden").style("cursor", "crosshair"), t.selectAll(".extent").data([0]).enter().append("rect").attr("class", "extent").style("cursor", "move");
                var s = t.selectAll(".resize").data(c, Tn);
                s.exit().remove(), s.enter().append("g").attr("class", function(e) {
                    return "resize " + e
                }).style("cursor", function(e) {
                    return Af[e]
                }).append("rect").attr("x", function(e) {
                    return /[ew]$/.test(e) ? -3 : null
                }).attr("y", function(e) {
                    return /^[ns]/.test(e) ? -3 : null
                }).attr("width", 6).attr("height", 6).style("visibility", "hidden"), s.style("display", h.empty() ? "none" : null);
                var o = e.transition(t), u = e.transition(i), a;
                n && (a = Zu(n), u.attr("x", a[0]).attr("width", a[1] - a[0]), d(o)), r && (a = Zu(r), u.attr("y", a[0]).attr("height", a[1] - a[0]), v(o)), p(o)
            })
        }
        function p(e) {
            e.selectAll(".resize").attr("transform", function(e) {
                return "translate(" + i[+/e$/.test(e)] + "," + o[+/^s/.test(e)] + ")"
            })
        }
        function d(e) {
            e.select(".extent").attr("x", i[0]), e.selectAll(".extent,.n>rect,.s>rect").attr("width", i[1] - i[0])
        }
        function v(e) {
            e.select(".extent").attr("y", o[0]), e.selectAll(".extent,.e>rect,.w>rect").attr("height", o[1] - o[0])
        }
        function m() {
            function O() {
                e.event.keyCode == 32 && (S || (T = null, N[0] -= i[1], N[1] -= o[1], S = 2), B())
            }
            function M() {
                e.event.keyCode == 32 && S == 2 && (N[0] += i[1], N[1] += o[1], S = 0, B())
            }
            function _() {
                var t = e.mouse(c), s = !1;
                C && (t[0] += C[0], t[1] += C[1]), S || (e.event.altKey ? (T || (T = [(i[0] + i[1]) / 2, (o[0] + o[1]) / 2]), N[0] = i[+(t[0] < T[0])], N[1] = o[+(t[1] < T[1])]) : T = null), w && D(t, n, 0) && (d(y), s = !0), E && D(t, r, 1) && (v(y), s = !0), s && (p(y), g({type: "brush",mode: S ? "move" : "resize"}))
            }
            function D(e, t, n) {
                var r = Zu(t), s = r[0], c = r[1], h = N[n], p = n ? o : i, d = p[1] - p[0], v, m;
                S && (s -= h, c -= d + h), v = (n ? l : f) ? Math.max(s, Math.min(c, e[n])) : e[n], S ? m = (v += h) + d : (T && (h = Math.max(s, Math.min(c, 2 * T[n] - v))), h < v ? (m = v, v = h) : m = h);
                if (p[0] != v || p[1] != m)
                    return n ? a = null : u = null, p[0] = v, p[1] = m, !0
            }
            function P() {
                _(), y.style("pointer-events", "all").selectAll(".resize").style("display", h.empty() ? "none" : null), e.select("body").style("cursor", null), k.on("mousemove.brush", null).on("mouseup.brush", null).on("touchmove.brush", null).on("touchend.brush", null).on("keydown.brush", null).on("keyup.brush", null), x(), g({type: "brushend"})
            }
            var c = this, m = e.select(e.event.target), g = t.of(c, arguments), y = e.select(c), b = m.datum(), w = !/^(n|s)$/.test(b) && n, E = !/^(e|w)$/.test(b) && r, S = m.classed("extent"), x = wt(), T, N = e.mouse(c), C, k = e.select(s).on("keydown.brush", O).on("keyup.brush", M);
            e.event.changedTouches ? k.on("touchmove.brush", _).on("touchend.brush", P) : k.on("mousemove.brush", _).on("mouseup.brush", P), y.interrupt().selectAll("*").interrupt();
            if (S)
                N[0] = i[0] - N[0], N[1] = o[0] - N[1];
            else if (b) {
                var L = +/w$/.test(b), A = +/^n/.test(b);
                C = [i[1 - L] - N[0], o[1 - A] - N[1]], N[0] = i[L], N[1] = o[A]
            } else
                e.event.altKey && (T = N.slice());
            y.style("pointer-events", "none").selectAll(".resize").style("display", null), e.select("body").style("cursor", m.style("cursor")), g({type: "brushstart"}), _()
        }
        var t = F(h, "brushstart", "brush", "brushend"), n = null, r = null, i = [0, 0], o = [0, 0], u, a, f = !0, l = !0, c = Of[0];
        return h.event = function(n) {
            n.each(function() {
                var n = t.of(this, arguments), r = {x: i,y: o,i: u,j: a}, s = this.__chart__ || r;
                this.__chart__ = r, wf ? e.select(this).transition().each("start.brush", function() {
                    u = s.i, a = s.j, i = s.x, o = s.y, n({type: "brushstart"})
                }).tween("brush:brush", function() {
                    var e = To(i, r.x), t = To(o, r.y);
                    return u = a = null, function(s) {
                        i = r.x = e(s), o = r.y = t(s), n({type: "brush",mode: "resize"})
                    }
                }).each("end.brush", function() {
                    u = r.i, a = r.j, n({type: "brush",mode: "resize"}), n({type: "brushend"})
                }) : (n({type: "brushstart"}), n({type: "brush",mode: "resize"}), n({type: "brushend"}))
            })
        }, h.x = function(e) {
            return arguments.length ? (n = e, c = Of[!n << 1 | !r], h) : n
        }, h.y = function(e) {
            return arguments.length ? (r = e, c = Of[!n << 1 | !r], h) : r
        }, h.clamp = function(e) {
            return arguments.length ? (n && r ? (f = !!e[0], l = !!e[1]) : n ? f = !!e : r && (l = !!e), h) : n && r ? [f, l] : n ? f : r ? l : null
        }, h.extent = function(e) {
            var t, s, f, l, c;
            if (!arguments.length)
                return n && (u ? (t = u[0], s = u[1]) : (t = i[0], s = i[1], n.invert && (t = n.invert(t), s = n.invert(s)), s < t && (c = t, t = s, s = c))), r && (a ? (f = a[0], l = a[1]) : (f = o[0], l = o[1], r.invert && (f = r.invert(f), l = r.invert(l)), l < f && (c = f, f = l, l = c))), n && r ? [[t, f], [s, l]] : n ? [t, s] : r && [f, l];
            if (n) {
                t = e[0], s = e[1], r && (t = t[0], s = s[0]), u = [t, s], n.invert && (t = n(t), s = n(s)), s < t && (c = t, t = s, s = c);
                if (t != i[0] || s != i[1])
                    i = [t, s]
            }
            if (r) {
                f = e[0], l = e[1], n && (f = f[1], l = l[1]), a = [f, l], r.invert && (f = r(f), l = r(l)), l < f && (c = f, f = l, l = c);
                if (f != o[0] || l != o[1])
                    o = [f, l]
            }
            return h
        }, h.clear = function() {
            return h.empty() || (i = [0, 0], o = [0, 0], u = a = null), h
        }, h.empty = function() {
            return !!n && i[0] == i[1] || !!r && o[0] == o[1]
        }, e.rebind(h, t, "on")
    };
    var Af = {n: "ns-resize",e: "ew-resize",s: "ns-resize",w: "ew-resize",nw: "nwse-resize",ne: "nesw-resize",se: "nwse-resize",sw: "nesw-resize"}, Of = [["n", "e", "s", "w", "nw", "ne", "se", "sw"], ["e", "w"], ["n", "s"], []], Mf = Wn.format = wr.timeFormat, _f = Mf.utc, Df = _f("%Y-%m-%dT%H:%M:%S.%LZ");
    Mf.iso = Date.prototype.toISOString && +(new Date("2000-01-01T00:00:00.000Z")) ? Pf : Df, Pf.parse = function(e) {
        var t = new Date(e);
        return isNaN(t) ? null : t
    }, Pf.toString = Df.toString, Wn.second = Jn(function(e) {
        return new Xn(Math.floor(e / 1e3) * 1e3)
    }, function(e, t) {
        e.setTime(e.getTime() + Math.floor(t) * 1e3)
    }, function(e) {
        return e.getSeconds()
    }), Wn.seconds = Wn.second.range, Wn.seconds.utc = Wn.second.utc.range, Wn.minute = Jn(function(e) {
        return new Xn(Math.floor(e / 6e4) * 6e4)
    }, function(e, t) {
        e.setTime(e.getTime() + Math.floor(t) * 6e4)
    }, function(e) {
        return e.getMinutes()
    }), Wn.minutes = Wn.minute.range, Wn.minutes.utc = Wn.minute.utc.range, Wn.hour = Jn(function(e) {
        var t = e.getTimezoneOffset() / 60;
        return new Xn((Math.floor(e / 36e5 - t) + t) * 36e5)
    }, function(e, t) {
        e.setTime(e.getTime() + Math.floor(t) * 36e5)
    }, function(e) {
        return e.getHours()
    }), Wn.hours = Wn.hour.range, Wn.hours.utc = Wn.hour.utc.range, Wn.month = Jn(function(e) {
        return e = Wn.day(e), e.setDate(1), e
    }, function(e, t) {
        e.setMonth(e.getMonth() + t)
    }, function(e) {
        return e.getMonth()
    }), Wn.months = Wn.month.range, Wn.months.utc = Wn.month.utc.range;
    var jf = [1e3, 5e3, 15e3, 3e4, 6e4, 3e5, 9e5, 18e5, 36e5, 108e5, 216e5, 432e5, 864e5, 1728e5, 6048e5, 2592e6, 7776e6, 31536e6], Ff = [[Wn.second, 1], [Wn.second, 5], [Wn.second, 15], [Wn.second, 30], [Wn.minute, 1], [Wn.minute, 5], [Wn.minute, 15], [Wn.minute, 30], [Wn.hour, 1], [Wn.hour, 3], [Wn.hour, 6], [Wn.hour, 12], [Wn.day, 1], [Wn.day, 2], [Wn.week, 1], [Wn.month, 1], [Wn.month, 3], [Wn.year, 1]], If = Mf.multi([[".%L", function(e) {
                return e.getMilliseconds()
            }], [":%S", function(e) {
                return e.getSeconds()
            }], ["%I:%M", function(e) {
                return e.getMinutes()
            }], ["%I %p", function(e) {
                return e.getHours()
            }], ["%a %d", function(e) {
                return e.getDay() && e.getDate() != 1
            }], ["%b %d", function(e) {
                return e.getDate() != 1
            }], ["%B", function(e) {
                return e.getMonth()
            }], ["%Y", ii]]), qf = {range: function(t, n, r) {
            return e.range(Math.ceil(t / r) * r, +n, r).map(Bf)
        },floor: Tn,ceil: Tn};
    Ff.year = Wn.year, Wn.scale = function() {
        return Hf(e.scale.linear(), Ff, If)
    };
    var Rf = Ff.map(function(e) {
        return [e[0].utc, e[1]]
    }), Uf = _f.multi([[".%L", function(e) {
                return e.getUTCMilliseconds()
            }], [":%S", function(e) {
                return e.getUTCSeconds()
            }], ["%I:%M", function(e) {
                return e.getUTCMinutes()
            }], ["%I %p", function(e) {
                return e.getUTCHours()
            }], ["%a %d", function(e) {
                return e.getUTCDay() && e.getUTCDate() != 1
            }], ["%b %d", function(e) {
                return e.getUTCDate() != 1
            }], ["%B", function(e) {
                return e.getUTCMonth()
            }], ["%Y", ii]]);
    Rf.year = Wn.year.utc, Wn.scale.utc = function() {
        return Hf(e.scale.linear(), Rf, Uf)
    }, e.text = Nn(function(e) {
        return e.responseText
    }), e.json = function(e, t) {
        return Cn(e, "application/json", zf, t)
    }, e.html = function(e, t) {
        return Cn(e, "text/html", Wf, t)
    }, e.xml = Nn(function(e) {
        return e.responseXML
    }), typeof define == "function" && define.amd ? define("d3", e) : typeof module == "object" && module.exports && (module.exports = e), this.d3 = e
}(), function() {
    function f(e) {
        return function() {
            if (d3.event.type === "touchstart") {
                r = l(d3.event), u = s = r.pageX, a = o = r.pageY, i = !0;
                var t = d3.event;
                setTimeout(function() {
                    u === s && !i && a === o && (d3.event = t, e.apply(this, arguments))
                }, 200)
            }
            d3.event.type === "touchend" && i && (i = !1), d3.event.type === "touchmove" && i && (r = l(d3.event), s = r.pageX, o = r.pageY)
        }
    }
    function l(e) {
        return e.touches ? e.touches[0] : e
    }
    function p(e) {
        return e[0]
    }
    function d(e) {
        return e[1]
    }
    function v(e) {
        return e[2]
    }
    function m() {
        return !0
    }
    function g() {
        return 0
    }
    function b(e) {
        return e[0]
    }
    function w(e) {
        return e[1]
    }
    function E(e) {
        return e[2]
    }
    function S(e) {
        return e[3]
    }
    function T() {
        return !0
    }
    function N(e, t, n, r) {
        return "M" + e + "," + n + "L" + t + "," + n + "L" + t + "," + r + "L" + e + "," + r + "Z"
    }
    function k() {
        return 64
    }
    function L() {
        return "circle"
    }
    function A(e) {
        return e[0]
    }
    function O(e) {
        return e[1]
    }
    function M(e) {
        return !0
    }
    function _(e) {
        return e[0]
    }
    function D(e) {
        return e[1]
    }
    function P(e) {
        return e[2]
    }
    function H(e) {
        return e[3]
    }
    function B() {
        return !1
    }
    function j() {
        return !0
    }
    function F(e, t, n, r, i) {
        var s;
        return i ? (s = n + (r - n) / 2, "M" + e + "," + n + "L" + e + "," + r + "M" + e + "," + s + "L" + t + "," + s + "M" + t + "," + n + "L" + t + "," + r) : (s = e + (t - e) / 2, "M" + e + "," + n + "L" + t + "," + n + "M" + s + "," + n + "L" + s + "," + r + "M" + e + "," + r + "L" + t + "," + r)
    }
    function U(e) {
        return !0
    }
    function z(e) {
        return e[0]
    }
    function W(e) {
        return e[1]
    }
    function X(e, t) {
        var n = d3.max([e.length, t.length]), r = "M";
        for (var i = 0; i < n; i++)
            i > 0 && (r += "L"), r += i < e.length ? e[i] : "0", r += ",", r += i < t.length ? t[i] : "0";
        return r += "Z", r
    }
    function K() {
    }
    function Q(e) {
        function t() {
            var t = n, r = -1, i = t.length, s;
            while (++r < i)
                (s = t[r].on) && s.apply(this, arguments);
            return e
        }
        var n = [], r = new d3.map;
        return t.on = function(t, i) {
            var s = r.get(t), o;
            return arguments.length < 2 ? s && s.on : (s && (s.on = null, n = n.slice(0, o = n.indexOf(s)).concat(n.slice(o + 1)), r.remove(t)), i && n.push(r.set(t, {on: i})), e)
        }, t
    }
    function G(e) {
        var t = new K, n = 0, r = arguments.length;
        while (++n < r)
            t[arguments[n]] = Q(t);
        return t.of = function(n, r) {
            return function(i) {
                var s;
                try {
                    s = i.sourceEvent = d3.event, i.target = e, d3.event = i, t[i.type].apply(n, r)
                }finally {
                    d3.event = s
                }
            }
        }, t
    }
    function Y() {
        d3.event.stopPropagation(), d3.event.preventDefault()
    }
    var e = d3.selection.prototype, t = e.on, n = {tap: [["touchstart", "touchend", "touchmove"], f]}, r = null, i = !1, s = 0, o = 0, u = 0, a = 0;
    e.on = function(e, r, i) {
        var s = e.split("."), o = s.shift(), u = n[o];
        if (u) {
            var a = u[0], f = this;
            return r = u[1].call(null, r), a.forEach(function(e, n) {
                var o = [e, s].join(".");
                t.call(f, o, r, i)
            }), t
        }
        return t.apply(this, arguments)
    }, dv = function() {
    }, dv.version = "3.1.0", dv.ANIMATION = !0;
    var c = !1, h = /xyz/.test(function() {
        xyz
    }) ? /\b_super\b/ : /.*/;
    dv.extend = function(e) {
        function i() {
            if (!c) {
                c = !0;
                var e = new arguments.callee;
                return c = !1, e.init.apply(e, arguments), e
            }
        }
        var t = this.prototype;
        c = !0;
        var n = new this;
        e = e(), e.init = e, c = !1;
        for (var r in e)
            n[r] = typeof e[r] == "function" && typeof t[r] == "function" && h.test(e[r]) ? function(e, n) {
                return function() {
                    var r = this._super;
                    this._super = t[e];
                    var i = n.apply(this, arguments);
                    return this._super = r, i
                }
            }(r, e[r]) : e[r];
        return i.prototype = n, i.mixin = function(e, t) {
            dv.util.isObject(e) ? dv.util.each(e, function(e, r) {
                n[r] = t
            }) : n[e] = t
        }, i.extend = arguments.callee, i
    }, dv.DEFAULT_COLORS = ["#1f77b4", "#ff7f0e", "#2ca02c", "#d62728", "#9467bd", "#8c564b", "#e377c2", "#7f7f7f", "#bcbd22", "#17becf"], dv.DEFAULT_CATEGORICAL_AES = ["color", "fill", "stroke", "shape", "size", "linetype"], dv.absoluteCoordinates = function(e, t, n) {
        if (e.coord() instanceof dv.coord.polar) {
            var r = e.coord().flip() ? n.yOuterScale() : n.xOuterScale(), i = e.coord().flip() ? n.xOuterScale() : n.yOuterScale(), s = dv.util.scaleRangeNoReverse(r), o = dv.util.scaleRangeNoReverse(i);
            t[0] += (s[0] + s[1]) / 2, t[1] += (o[0] + o[1]) / 2
        }
        return t
    }, dv.showTooltip = function(e, t, n, r, i, s) {
        var o = s.selectAll(".dv-tooltip").data([e]);
        e.cx = e.cx || e.x + e.width / 2, e.cy = e.cy || e.y + e.height / 2, e.dx = e.dx || e.x + e.width, e.dy = e.dy || e.y + e.height, t.dx = t.dy || t.x + t.width, t.dy = t.dy || t.y + t.height;
        var u = o.enter().append("div").classed("dv-tooltip", !0).style("top", 0).style("left", 0);
        u.append("div").classed("content", !0), u.append("b").classed("notch", !0), o.select(".content").html(n);
        var a = o.select(".notch"), f = o.node(), l = f.offsetWidth, c = f.offsetHeight, h = 0, p = 0, d = function(e, t, n) {
            return Math.min(Math.max(t, e), n)
        };
        switch (r) {
            case "left":
                p = e.x - l - i, h = e.cy - c / 2, p < t.x && (p = e.dx + i, r = "right"), h < t.y && (h = t.y), h + c > t.dy && (h = t.dy - c), a.style("top", d(e.cy - h - 5, 3, c - 13) + "px");
                break;
            case "right":
                p = e.x + e.width + i, h = e.cy - c / 2, p + l > t.dx && (p = e.x - l - i, r = "left"), h < t.y && (h = t.y), h + c > t.dy && (h = t.dy - c), a.style("top", d(e.cy - h - 5, 3, c - 13) + "px");
                break;
            case "top":
                p = e.cx - l / 2, h = e.y - c - i, h < t.y && (h = e.dy + i, r = "bottom"), p < t.x && (p = t.x), p + l > t.dx && (p = t.dx - l), a.style("left", d(e.cx - p - 5, 3, l - 13) + "px");
                break;
            case "bottom":
                p = e.cx - l / 2, h = e.dy + i, h + c > t.dy && (h = e.y - c - i, r = "top"), p < t.x && (p = t.x), p + l > t.dx && (p = t.dx - l), a.style("left", d(e.cx - p - 5, 3, l - 13) + "px");
                break;
            default:
                r = null
        }
        h = Math.round(h), p = Math.round(p), o.classed("top right left bottom hide", !1).classed(r, !0), u.style("top", h + "px").style("left", p + "px"), o.style("top", h + "px").style("left", p + "px")
    }, dv.removeTooltip = function(e) {
        e.selectAll(".dv-tooltip").classed("hide", !0)
    }, dv.cancelEvent = function(e) {
        e.stopPropagation(), e.preventDefault()
    }, dv.windowDimensions = function() {
        var e = {width: 640,height: 480};
        return document.body && document.body.offsetWidth && (e.width = document.body.offsetWidth, e.height = document.body.offsetHeight), document.compatMode == "CSS1Compat" && document.documentElement && document.documentElement.offsetWidth && (e.width = document.documentElement.offsetWidth, e.height = document.documentElement.offsetHeight), window.innerWidth && window.innerHeight && (e.width = window.innerWidth, e.height = window.innerHeight), e
    }, dv.addWindowResizeHandler = function(e) {
        window.addEventListener("resize", e)
    }, dv.removeWindowResizeHandler = function(e) {
        window.removeEventListener("resize", e)
    }, dv.scale = dv.extend(function() {
        function e(e) {
            this._d3Scale = e, this._reverse = !1, this._parse = dv.util.identity, this._includeInDomain = function() {
                return !0
            }
        }
        return e._mapToD3Scale = function(e) {
            return this._d3Scale(e)
        }, e.trainingProperties = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isUndefined", "isArray"]) || dv.log.error({msg: "The supplied properties is not an array",data: {range: e}}), this._trainingProperties = e, this) : this._trainingProperties ? this._trainingProperties : this._property ? [this._property] : undefined
        }, e.trainDomain = function(e, t) {
            var n = this.calculateDomain(e, t);
            return this.domain(n), n
        }, e.parse = function(e) {
            return arguments.length ? (this._parse = e, this) : this._parse
        }, e.applyRangePadding = function() {
        }, e.validateDomain = function() {
        }, e.mapToProp = function(e) {
            var t = e[this.property()], n = this;
            return dv.util.isArray(t) ? dv.util.map(t, function(e) {
                return n._mapToD3Scale.call(n, e)
            }) : this._mapToD3Scale.call(this, t)
        }, e.mapPropToPercent = function(e) {
            return this.mapValueToPercent(this.mapToProp(e))
        }, e.mapValueToPercent = function(e) {
            var t = dv.util.scaleRange(this), n = t[1] - t[0];
            return dv.util.isArray(e) ? dv.util.map(e, function(e) {
                return n ? (e - t[0]) / n : 0
            }) : n ? (e - t[0]) / n : 0
        }, e.mapValue = function(e) {
            if (dv.util.isArray(e)) {
                var t = this;
                return dv.util.map(e, function(e) {
                    return t._mapToD3Scale.call(t, e)
                })
            }
            return this._mapToD3Scale.call(this, e)
        }, e.invertValue = function(e) {
            return this._d3Scale.invert(e)
        }, e.rangeBand = function(e) {
            return 0
        }, e.reverse = function(e) {
            if (!arguments.length)
                return this._reverse;
            if (this._reverse != e) {
                this._reverse = e;
                var t = this._d3Scale.domain() || [];
                this._d3Scale.domain(t.reverse())
            }
            return this
        }, e.property = function(e) {
            return arguments.length ? (this._property = e, this) : this._property
        }, e.mapping = function(e) {
            return arguments.length ? (this._mapping = e, this) : this._mapping
        }, e.domain = function(e) {
            return arguments.length ? this._d3Scale ? (e = this._reverse ? e.reverse() : e, this._d3Scale.domain(e), this) : this : this._d3Scale.domain()
        }, e.hasSameDomain = function(e) {
            var t = !0, n = this.domain();
            if (n.length != e.length)
                t = !1;
            else
                for (var r = 0; r < e.length; r++)
                    if (e[r] != n[r]) {
                        t = !1;
                        break
                    }
            return t
        }, e.range = function(e) {
            return arguments.length ? this._d3Scale ? (dv.util.isValidValue(e, ["isArray"]) || dv.log.error({msg: "The supplied range is not an array",data: {range: e}}), this._d3Scale.range(e), this) : this : this._d3Scale.range()
        }, e.expand = function(e) {
            return arguments.length ? (this._expand = e, this) : this._expand
        }, e.limits = function(e) {
            return arguments.length ? (this._limits = e, this) : this._limits
        }, e.breaks = function(e) {
            return arguments.length ? (this._breaks = e, this) : this._breaks
        }, e.orientation = function(e) {
            return arguments.length ? (this._orientation = e, this) : this._orientation
        }, e.includeInDomain = function(e) {
            return arguments.length ? (this._includeInDomain = e, this) : this._includeInDomain
        }, e.scaleIndex = function(e) {
            return arguments.length ? (this._scaleIndex = e, this) : this._scaleIndex
        }, e._copy = function() {
            dv.log.error({msg: "A copy function was not specified for the scale subclass."})
        }, e.copy = e._copy, e.isDefault = function(e) {
            return arguments.length ? (this._isDefault = e, this) : this._isDefault
        }, e
    }), dv.scale.constant = dv.scale.extend(function() {
        function e() {
            this._super(null)
        }
        return e.trainDomain = function(e) {
            return
        }, e.map = function(e) {
            return this._value
        }, e.mapToProp = function(e) {
            return this._value
        }, e.value = function(e) {
            return arguments.length ? (this._value = e, this) : this._value
        }, e._copy = function(e) {
            var t = this.trainingProperties();
            return dv.util.isUndefined(t) || (t = t.slice(0)), dv.scale.constant().isDefault(this.isDefault()).value(this.value()).property(this.property()).trainingProperties(t).scaleIndex(this._scaleIndex)
        }, e.copy = e._copy, e
    }), dv.scale.continuous = dv.scale.extend(function() {
        function e(e) {
            this._super(e ? e : d3.scale.linear()), this.to = this.range, this._parse = function(e) {
                return e == null ? undefined : parseFloat(e)
            }
        }
        return e.calculateDomain = function(e, t) {
            var n = [], r = this, i, s;
            this.trainingProperties() || this.trainingProperties([this.property()]);
            var o = this.trainingProperties();
            t || (t = {}), e || (e = []);
            for (var u = 0; u < o.length; u++) {
                var a = o[u];
                for (var f = 0; f < e.length; f++)
                    if (!t.filter || !t.filter.call(this, e[f].key)) {
                        var l = e[f].values;
                        for (var c = 0; c < l.length; c++) {
                            var h = l[c];
                            if (!this._includeInDomain(h, c))
                                continue;
                            this.scaleIndex() !== 0 && (h[this.property() + "-index"] = this.scaleIndex());
                            var p = t.stack ? h.y0 : h[a];
                            dv.util.isArray(p) || (p = this._parse.call(this, p));
                            var d = dv.util.isArray(p) ? d3.min(p) : p;
                            i = dv.util.isUndefined(i) || d < i ? d : i;
                            if (t.stack) {
                                var v = h[a];
                                p += dv.util.isArray(v) ? d3.max(v) : r._parse.call(this, v)
                            }
                            var m = dv.util.isArray(p) ? d3.max(p) : p;
                            s = dv.util.isUndefined(s) || m > s ? m : s
                        }
                    }
            }
            return isNaN(i) && isNaN(s) ? (n = [], this._naturalDomain = []) : (n = [i, s], this._naturalDomain = [i, s]), t.fill && (n = [0, 100]), !dv.util.isUndefined(this._upperLimit) && !dv.util.isFunction(this._upperLimit) && !dv.util.isUndefined(this._lowerLimit) && !dv.util.isFunction(this._lowerLimit) ? n = this.limits() : this._reconcileLimits(n), n
        }, e.unionDomain = function(e, t) {
            (!e || !(e instanceof dv.scale.continuous)) && dv.log.error({msg: "The supplied scale is not continuous.",data: {scale: e,isReversed: t}});
            var n = e.domain(), r = e.naturalDomain(), i = this.domain() ? d3.extent(this.domain().concat(n)) : d3.extent(n), s = this._naturalDomain ? d3.extent(this._naturalDomain.concat(r)) : d3.extent(r);
            return isNaN(i[0]) && isNaN(i[1]) && (i = []), isNaN(s[0] && isNaN(s[1])) && (s = []), this.reverse(t || this._reverse), this.domain(i), this._naturalDomain = s, this
        }, e.validateDomain = function() {
            var e = this.domain();
            (!e || !e.length) && this.domain([0, 1])
        }, e.unionRange = function(e) {
            return dv.util.isValidValue(e, ["isArray"]) || dv.log.error({msg: "The supplied range is not an array",data: {range: e}}), this.range(this.range() ? d3.extent(this.range().concat(e)) : e), this
        }, e.applyRangePadding = function() {
            var e = this.domain(), t = this.range();
            if (this._lowerRangePadding) {
                var n = t[0] - t[1], r = Math.min(Math.abs(n) - 1, this._lowerRangePadding);
                e[0] = this.invertValue(n / (Math.abs(n) - r) * r + t[0])
            }
            if (this._upperRangePadding) {
                var i = t[1] - t[0], s = Math.min(Math.abs(i) - 1, this._upperRangePadding);
                e[1] = this.invertValue(i / (Math.abs(i) - s) * s + t[1])
            }
            return this.domain(e), this
        }, e.upperLimit = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isUndefined", "isFinite", "isDate", "isFunction"]) ? this._upperLimit = e : dv.log.error({msg: "Invalid value, cannot set upperLimit with: " + e}), this) : this._upperLimit
        }, e.lowerLimit = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isUndefined", "isFinite", "isDate", "isFunction"]) ? this._lowerLimit = e : dv.log.error({msg: "Invalid value, cannot set lowerLimit with: " + e}), this) : this._lowerLimit
        }, e.limits = function(e) {
            return arguments.length ? ((!e || e.length != 2) && dv.log.error({msg: "Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}), this.lowerLimit(e[0]), this.upperLimit(e[1]), this) : [this._lowerLimit, this._upperLimit]
        }, e.naturalDomain = function() {
            return this._naturalDomain
        }, e.upperRangePadding = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isUndefined", "isFinite", "isDate", "isFunction"]) ? this._upperRangePadding = e : dv.log.error({msg: "Invalid value, cannot set upperRangePadding with: " + e}), this) : this._upperRangePadding
        }, e.lowerRangePadding = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isUndefined", "isFinite", "isDate", "isFunction"]) ? this._lowerRangePadding = e : dv.log.error({msg: "Invalid value, cannot set lowerRangePadding with: " + e}), this) : this._lowerRangePadding
        }, e.rangePadding = function(e) {
            return arguments.length ? ((!e || e.length != 2) && dv.log.error({msg: "Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}), this.lowerRangePadding(e[0]), this.upperRangePadding(e[1]), this) : [this._lowerRangePadding, this._upperRangePadding]
        }, e.softLowerLimit = function(e) {
            return arguments.length ? (this._softLowerLimit = e, this) : this._softLowerLimit
        }, e._reconcileLimits = function(e) {
            if (!e.length)
                return;
            dv.util.isUndefined(this._softLowerLimit) || (e[0] = Math.min(e[0], this._softLowerLimit), e[1] = Math.max(e[1], this._softLowerLimit)), dv.util.isUndefined(this._lowerLimit) || (e[0] = dv.util.isFunction(this._lowerLimit) ? this._lowerLimit(e[0], e[1]) : this._lowerLimit), dv.util.isUndefined(this._upperLimit) || (e[1] = dv.util.isFunction(this._upperLimit) ? this._upperLimit(e[0], e[1]) : this._upperLimit)
        }, e.labels = function(e) {
            return arguments.length ? (this._labels = e, this) : this._labels
        }, e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.continuous().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).reverse(this.reverse()).domain(e).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).trainingProperties(t).scaleIndex(this._scaleIndex);
            return n._naturalDomain = this._naturalDomain, n
        }, e.invert = function(e) {
            return this._d3Scale.invert(e[this.mapping()])
        }, e.invertFromProp = function(e) {
            return this._d3Scale.invert(e[this.property()])
        }, e.copy = e._copy, e
    }), dv.scale.linear = dv.scale.continuous.extend(function() {
        function e() {
            this._super(d3.scale.linear())
        }
        return e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.linear().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(t).scaleIndex(this._scaleIndex);
            return n._naturalDomain = this._naturalDomain, n
        }, e.copy = e._copy, e
    }), dv.scale.gradient = dv.scale.continuous.extend(function() {
        function e() {
            this._super(d3.scale.linear()), this._innerScale = d3.scale.linear().range([0, 1]), this.colors = this.range, this._controlPoints = ["0%", "50%", "100%"], this.colors(["#FA5A50", "#E1E1E1", "#5FAF69"])
        }
        return e._adjustOuterDomain = function() {
            var e = this;
            this._d3Scale.domain(dv.util.map(this._controlPoints, function(t, n) {
                return dv.util.isPercentString(t) ? e._innerScale.invert(parseInt(t, 10) / 100) : t
            }))
        }, e.controlPoints = function(e) {
            return arguments.length ? (this._controlPoints = e, this._adjustOuterDomain(), this) : this._controlPoints
        }, e.domain = function(e) {
            return arguments.length ? this._innerScale ? (e = this._reverse ? e.reverse() : e, this._innerScale.domain(e), this._adjustOuterDomain(), this) : this : this._innerScale.domain()
        }, e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.gradient().property(this.property()).mapping(this.mapping()).domain(e).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).includeInDomain(this.includeInDomain()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).controlPoints(this.controlPoints()).reverse(this.reverse()).trainingProperties(t).scaleIndex(this._scaleIndex);
            return n._naturalDomain = this._naturalDomain, n
        }, e.copy = e._copy, e
    }), dv.scale.time = dv.scale.continuous.extend(function() {
        function e() {
            this._super(d3.time.scale()), this._parse = function(e) {
                return e instanceof Date ? e : new Date(Date.parse(e))
            }
        }
        return e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.time().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(t).scaleIndex(this._scaleIndex);
            return n._naturalDomain = this._naturalDomain, n
        }, e.copy = e._copy, e._reconcileLimits = function(e, t, n) {
            dv.util.isUndefined(this._softLowerLimit) || (e[0] = Math.min(e[0], this._softLowerLimit), e[1] = Math.max(e[1], this._softLowerLimit)), dv.util.isUndefined(this._lowerLimit) || (e[0] = dv.util.isFunction(this._lowerLimit) ? this._parse(this._lowerLimit(new Date(t), new Date(n))) : this._lowerLimit), dv.util.isUndefined(this._upperLimit) || (e[1] = dv.util.isFunction(this._upperLimit) ? this._parse(this._upperLimit(new Date(t), new Date(n))) : this._upperLimit)
        }, e
    }), dv.scale.time.utc = dv.scale.continuous.extend(function() {
        function e() {
            this._super(d3.time.scale.utc()), this._parse = function(e) {
                return e instanceof Date ? e : new Date(Date.parse(e))
            }
        }
        return e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.time.utc().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(t).scaleIndex(this._scaleIndex);
            return n._naturalDomain = this._naturalDomain, n
        }, e.copy = e._copy, e._reconcileLimits = function(e, t, n) {
            dv.util.isUndefined(this._softLowerLimit) || (e[0] = Math.min(e[0], this._softLowerLimit), e[1] = Math.max(e[1], this._softLowerLimit)), dv.util.isUndefined(this._lowerLimit) || (e[0] = dv.util.isFunction(this._lowerLimit) ? this._parse(this._lowerLimit(new Date(t), new Date(n))) : this._lowerLimit), dv.util.isUndefined(this._upperLimit) || (e[1] = dv.util.isFunction(this._upperLimit) ? this._parse(this._upperLimit(new Date(t), new Date(n))) : this._upperLimit)
        }, e
    }), dv.scale.ordinal = dv.scale.extend(function() {
        function e() {
            this._super(d3.scale.ordinal()), this._defaultPadding = .1, this._defaultOuterPadding = 0, this._rangeExtent = [], this._rangeBandsSet = !1
        }
        return e._mapToD3Scale = function(e) {
            var t = this.domain(), n = -1, r = t.length, i = -1;
            while (++n < r) {
                var s = t[n];
                if (s === e || dv.util.isDate(s) && s.getTime() === e.getTime()) {
                    i = n;
                    break
                }
            }
            return i < 0 ? undefined : this._d3Scale(e)
        }, e.calculateDomain = function(e, t) {
            var n = {}, r = [], i = this.trainingProperties();
            t = t || {};
            for (var s = 0; s < i.length; s++) {
                var o = i[s];
                for (var u = 0; u < e.length; u++) {
                    var a = e[u].values;
                    if (!t.filter || !t.filter.call(this, e[u].key))
                        for (var f = 0; f < a.length; f++) {
                            var l = a[f];
                            if (!this._includeInDomain(l, f))
                                continue;
                            this.scaleIndex() !== 0 && (l[this.property() + "-index"] = this.scaleIndex());
                            var c = this._parse.call(this, l[o]);
                            !dv.util.isUndefined(c) && !n.hasOwnProperty(c) && (n[c] = c, r.push(c))
                        }
                }
            }
            return r.length ? r : []
        }, e.unionDomain = function(e, t) {
            (!e || !(e instanceof dv.scale.ordinal)) && dv.log.error({msg: "The supplied scale is not ordinal.",data: {scale: e,isReversed: t}});
            var n = e.domain();
            if (n && !dv.util.isArray(n))
                throw new Error("The supplied domain is not an array");
            return n && (this.reverse(t || this._reverse), this.domain(this.domain() ? dv.util.union(this.domain(), n) : n)), this
        }, e.unionRange = function(e) {
            if (e && !dv.util.isArray(e))
                throw new Error("The supplied range is not an array");
            return e && this.range(this.range() ? dv.util.union(this.range(), e) : e), this
        }, e.invertValue = function(e) {
            var t = this.range().indexOf(e), n = this.domain();
            if (t < 0)
                throw new Error("The supplied value does not exist in the specified range.");
            return n[t % n.length]
        }, e.reverse = function(e) {
            if (!arguments.length)
                return this._reverse;
            if (this._reverse != e) {
                this._reverse = e;
                var t = this._d3Scale.domain() || [];
                this._d3Scale.domain(t.reverse())
            }
            return this
        }, e.padding = function(e) {
            return arguments.length ? (this._padding = e, this._rangeBandsSet && this._d3Scale.rangeBands(this.rangeExtent(), this._padding, this.outerPadding()), this) : dv.util.isUndefined(this._padding) ? this._defaultPadding : this._padding
        }, e.outerPadding = function(e) {
            return arguments.length ? (this._outerPadding = e, this._rangeBandsSet && this._d3Scale.rangeBands(this.rangeExtent(), this.padding(), this._outerPadding), this) : dv.util.isUndefined(this._outerPadding) ? dv.util.isUndefined(this._padding) ? this._defaultOuterPadding : this.padding() : this._outerPadding
        }, e.rangeBands = function(e) {
            return arguments.length ? (this._rangeBandsSet = !0, this._d3Scale.rangeBands(e, this.padding(), this.outerPadding()), this.rangeExtent(e), this) : this._d3Scale.range()
        }, e.rangeBand = function() {
            return this._d3Scale.rangeBand()
        }, e.range = function(e) {
            return arguments.length ? this._d3Scale ? (dv.util.isValidValue(e, ["isArray"]) || dv.log.error({msg: "The supplied range is not an array",data: {range: e}}), this._d3Scale.range(e), this.rangeExtent([e[0], e[e.length - 1]]), this) : this : this._d3Scale.range()
        }, e.rangeExtent = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isArray"]) || dv.log.error({msg: "The supplied range extent is not an array",data: {range: e}}), this._rangeExtent = e, this) : this._rangeExtent
        }, e.values = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isArray"]) || dv.log.error({msg: "The supplied values is not an array",data: {range: e}}), this.range(e)) : this._d3Scale.range()
        }, e.drop = function(e) {
            return arguments.length ? (this._drop = e, this) : this._drop
        }, e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(t).scaleIndex(this._scaleIndex);
            return this._rangeBandsSet && n.rangeBands(this.rangeExtent().slice(0)), n
        }, e.copy = e._copy, e
    }), dv.scale.color = dv.scale.ordinal.extend(function() {
        function t() {
            this._super(), this.range(e)
        }
        var e = ["#8CC350", "#5A6EAA", "#D755A5", "#1EBED7", "#F0A01E", "#9B8CE6", "#3CB5A0", "#3287D2", "#F0557D", "#C3D250", "#EB782D", "#78B4F5", "#5FAF69", "#AA5FA5", "#FA5A50", "#F5C841"];
        return t._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).range(this.range()).rangeExtent(this.rangeExtent()).includeInDomain(this.includeInDomain()).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(t).scaleIndex(this._scaleIndex);
            return this._rangeBandsSet && n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding), n
        }, t.copy = t._copy, t
    }), dv.scale.shape = dv.scale.ordinal.extend(function() {
        function t() {
            this._super(), this.range(e)
        }
        var e = ["circle", "cross", "diamond", "square", "triangle-down", "triangle-up"];
        return t._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(t).scaleIndex(this._scaleIndex);
            return this._rangeBandsSet && n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding), n
        }, t.copy = t._copy, t
    }), dv.scale.linetype = dv.scale.ordinal.extend(function() {
        function t() {
            this._super(), this.range(e)
        }
        var e = ["solid", "dashed", "dotted", "dotdash", "longdash", "twodash"];
        return t._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(t).scaleIndex(this._scaleIndex);
            return this._rangeBandsSet && n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding), n
        }, t.copy = t._copy, t
    }), dv.scale.size = dv.scale.continuous.extend(function() {
        function e() {
            this._super(), this.to([2, 10])
        }
        return e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0));
            var n = dv.scale.size().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(t).scaleIndex(this._scaleIndex);
            return n._naturalDomain = this._naturalDomain, n
        }, e.copy = e._copy, e
    }), dv.scale.identity = dv.scale.ordinal.extend(function() {
        function e(e) {
            this._super(d3.scale.ordinal())
        }
        return e.mapToProp = function(e) {
            return e[this.property()]
        }, e.domain = function(e) {
            return arguments.length ? this._d3Scale ? (e = this._reverse ? e.reverse() : e, this._d3Scale.domain(e), this._d3Scale.range(e), this) : this : this._d3Scale.domain()
        }, e.range = function() {
            return arguments.length ? this : this._d3Scale.range()
        }, e.labels = function(e) {
            return arguments.length ? (this._labels = e, this) : this._labels
        }, e._copy = function() {
            var e = this.domain().slice(0), t = this.trainingProperties();
            return this.reverse() && e.reverse(), dv.util.isUndefined(t) || (t = t.slice(0)), dv.scale.identity().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(e).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(t).scaleIndex(this._scaleIndex)
        }, e.copy = e._copy, e
    }), dv.svg = dv.svg || {}, dv.svg.text = function() {
        function s(i) {
            return i.select(function(e, t) {
                return r.call(this, e, t) ? this : null
            }).attr("x", function(t, n) {
                return e.call(this, t, n)
            }).attr("y", function(e, n) {
                return t.call(this, e, n)
            }).text(function(e, t) {
                return n.call(this, e, t)
            })
        }
        var e = p, t = d, n = v, r = m, i = g;
        return s.x = function(t) {
            return arguments.length ? (e = t, s) : e
        }, s.y = function(e) {
            return arguments.length ? (t = e, s) : t
        }, s.label = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.defined = function(e) {
            return arguments.length ? (r = e, s) : r
        }, s.duration = function(e) {
            return arguments.length ? (i = e, s) : i
        }, s
    }, dv.svg.text.radial = function() {
        function s(i) {
            var s = function(t, n) {
                return e.call(this, t, n) + R
            }, o = function(e, n) {
                return t.call(this, e, n)
            };
            return i.select(function(e, t) {
                return r.call(this, e, t) ? this : null
            }).attr("x", function(e, t) {
                return o(e, t) * Math.cos(s(e, t))
            }).attr("y", function(e, t) {
                return o(e, t) * Math.sin(s(e, t))
            }).text(function(e, t) {
                return n.call(this, e, t)
            })
        }
        var e = p, t = d, n = v, r = m, i = g;
        return s.angle = function(t) {
            return arguments.length ? (e = t, s) : e
        }, s.radius = function(e) {
            return arguments.length ? (t = e, s) : t
        }, s.label = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.defined = function(e) {
            return arguments.length ? (r = e, s) : r
        }, s.duration = function(e) {
            return arguments.length ? (i = e, s) : i
        }, s
    }, dv.svg.rect = function() {
        function s(s, o) {
            return i.call(this, s, o) ? N(e.call(this, s, o), t.call(this, s, o), n.call(this, s, o), r.call(this, s, o)) : null
        }
        var e = b, t = w, n = E, r = S, i = T;
        return s.x0 = function(t) {
            return arguments.length ? (e = t, s) : e
        }, s.x1 = function(e) {
            return arguments.length ? (t = e, s) : t
        }, s.y0 = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.y1 = function(e) {
            return arguments.length ? (r = e, s) : r
        }, s.defined = function(e) {
            return arguments.length ? (i = e, s) : i
        }, s
    }, dv.svg.symbol = function() {
        function s(s, o) {
            return i.call(this, s, o) ? (C[e.call(this, s, o)] || C.circle)(t.call(this, s, o), n.call(this, s, o), r.call(this, s, o)) : null
        }
        var e = L, t = k, n = A, r = O, i = M;
        return s.x = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.y = function(e) {
            return arguments.length ? (r = e, s) : r
        }, s.type = function(t) {
            return arguments.length ? (e = d3.functor(t), s) : e
        }, s.size = function(e) {
            return arguments.length ? (t = d3.functor(e), s) : t
        }, s.defined = function(e) {
            return arguments.length ? (i = e, s) : i
        }, s
    }, dv.svg.symbol.radial = function() {
        function s(s, o) {
            if (i.call(this, s, o)) {
                var u = n.call(this, s, o) + R, a = r.call(this, s, o), f = a * Math.cos(u), l = a * Math.sin(u);
                return (C[e.call(this, s, o)] || C.circle)(t.call(this, s, o), f, l)
            }
            return null
        }
        var e = L, t = k, n = A, r = O, i = M;
        return s.angle = function(e) {
            return arguments.length ? (n = e, s) : n
        }, s.radius = function(e) {
            return arguments.length ? (r = e, s) : r
        }, s.type = function(t) {
            return arguments.length ? (e = d3.functor(t), s) : e
        }, s.size = function(e) {
            return arguments.length ? (t = d3.functor(e), s) : t
        }, s.defined = function(e) {
            return arguments.length ? (i = e, s) : i
        }, s
    }, d3.svg.symbolTypes = d3.keys(C);
    var C = {circle: function(e, t, n) {
            var r = Math.sqrt(e / Math.PI);
            return "M" + t + "," + (n + r) + "A" + r + "," + r + " 0 1,1 " + t + "," + (n - r) + "A" + r + "," + r + " 0 1,1 " + t + "," + (n + r) + "Z"
        },cross: function(e, t, n) {
            var r = Math.sqrt(e / 5) / 2;
            return "M" + (t + -3 * r) + "," + (n - r) + "H" + (t - r) + "V" + (n + -3 * r) + "H" + (t + r) + "V" + (n - r) + "H" + (t + 3 * r) + "V" + (n + r) + "H" + (t + r) + "V" + (n + 3 * r) + "H" + (t - r) + "V" + (n + r) + "H" + (t - 3 * r) + "Z"
        },diamond: function(e, t, n) {
            var r = Math.sqrt(e / (2 * q)), i = r * q;
            return "M" + t + "," + (n - r) + "L" + (t + i) + "," + n + " " + t + "," + (n + r) + " " + (t - i) + "," + n + "Z"
        },square: function(e, t, n) {
            var r = Math.sqrt(e) / 2;
            return "M" + (t - r) + "," + (n - r) + "L" + (t + r) + "," + (n - r) + " " + (t + r) + "," + (n + r) + " " + (t - r) + "," + (n + r) + "Z"
        },"triangle-down": function(e, t, n) {
            var r = Math.sqrt(e / I), i = r * I / 2;
            return "M" + t + "," + (n + i) + "L" + (t + r) + "," + (n - i) + " " + (t - r) + "," + (n - i) + "Z"
        },"triangle-up": function(e, t, n) {
            var r = Math.sqrt(e / I), i = r * I / 2;
            return "M" + t + "," + (n - i) + "L" + (t + r) + "," + (n + i) + " " + (t - r) + "," + (n + i) + "Z"
        }};
    dv.svg.errorBar = function() {
        function o(o, u) {
            return s.call(this, o, u) ? F(e.call(this, o, u), t.call(this, o, u), n.call(this, o, u), r.call(this, o, u), i.call(this, o, u)) : null
        }
        var e = _, t = D, n = P, r = H, i = B, s = j;
        return o.x0 = function(t) {
            return arguments.length ? (e = t, o) : e
        }, o.x1 = function(e) {
            return arguments.length ? (t = e, o) : t
        }, o.y0 = function(e) {
            return arguments.length ? (n = e, o) : n
        }, o.y1 = function(e) {
            return arguments.length ? (r = e, o) : r
        }, o.flip = function(e) {
            return arguments.length ? (i = e, o) : i
        }, o.defined = function(e) {
            return arguments.length ? (s = e, o) : s
        }, o
    };
    var I = Math.sqrt(3), q = Math.tan(30 * Math.PI / 180), R = -Math.PI / 2;
    dv.svg.poly = function() {
        function r(r, i) {
            return e.call(this, r, i) ? X(t.call(this, r, i), n.call(this, r, i)) : null
        }
        var e = U, t = z, n = W;
        return r.xs = function(e) {
            return arguments.length ? (t = e, r) : t
        }, r.ys = function(e) {
            return arguments.length ? (n = e, r) : n
        }, r.defined = function(t) {
            return arguments.length ? (e = t, e) : e
        }, r
    }, dv.svg.poly.radial = function() {
        function r(r, i) {
            if (e.call(this, r, i)) {
                var s = t.call(this, r, i), o = n.call(this, r, i), u = d3.max([s.length, o.length]), a = "M";
                for (var f = 0; f < u; f++) {
                    f > 0 && (a += "L");
                    var l = s[f] + R, c = o[f], h = c * Math.cos(l), p = c * Math.sin(l);
                    a += f < s.length ? h : "0", a += ",", a += f < o.length ? p : "0"
                }
                return a += "Z", a
            }
            return null
        }
        var e = U, t = z, n = W;
        return r.angles = function(e) {
            return arguments.length ? (t = e, r) : t
        }, r.radii = function(e) {
            return arguments.length ? (n = e, r) : n
        }, r.defined = function(t) {
            return arguments.length ? (e = t, e) : e
        }, r
    }, dv.util = {}, dv.util.filterAndZip = function(e, t, n) {
        var r = [], i = [];
        if (!t)
            for (var s in e) {
                r = e[s];
                break
            }
        else
            r = e[t];
        var o = -1, u = r.length;
        while (++o < u) {
            var a = r[o];
            if (!n || a == n) {
                var f = {};
                for (var l in e)
                    if (l === "data") {
                        f[l] = {};
                        for (var c in e[l])
                            f[l][c] = e[l][c][o]
                    } else
                        f[l] = e[l][o];
                i.push(f)
            }
        }
        return i
    }, dv.util.binaryCompare = function(e, t, n, r, i) {
        var s = r;
        arguments.length < 4 && (s = 0), arguments.length < 5 && (i = e.length);
        while (s < i) {
            var o = s + i >> 1;
            t < n(e[o]) ? i = o : s = o + 1
        }
        return s == r || Math.abs(n(e[s]) - t) < Math.abs(n(e[s - 1]) - t) ? s : s - 1
    }, dv.util.uniqueValues = function(e, t) {
        var n = [];
        return dv.util.each(e, function(r, i) {
            var s = -1, o = n.length, u = !1;
            while (++s < o) {
                var a = n[s];
                if (t(r, a)) {
                    u = !0;
                    break
                }
            }
            u || n.push(e[s])
        }), n
    }, dv.util.scaleRange = function(e, t) {
        return arguments.length === 1 ? e.rangeExtent ? e.rangeExtent() : e.range() : (e.rangeExtent ? e.rangeBands(t) : e.range(t), e)
    }, dv.util.minRangeDistance = function(e, t) {
        var n = Number.MAX_VALUE, r, i;
        return dv.util.each(t, function(t) {
            dv.util.each(t.values, function(t) {
                r = t.panel.xScale(t).mapValue(t[e]), dv.util.isUndefined(i) || (n = Math.min(n, Math.abs(r - i))), i = r
            })
        }), n
    }, dv.util.scaleRangeNoReverse = function(e) {
        return e.rangeExtent ? e.rangeExtent() : dv.util.scaleExtent(e.range())
    }, dv.util.scaleExtent = function(e) {
        var t = e[0], n = e[e.length - 1];
        return t < n ? [t, n] : [n, t]
    }, dv.util.merge = function(e, t) {
        var n = {}, r;
        for (r in e)
            n[r] = e[r];
        for (r in t)
            n[r] = t[r];
        return n
    }, dv.util.getPercentValue = function(e, t) {
        return dv.util.isPercentString(e) ? t * parseInt(e, 10) / 100 : e
    }, dv.util.isPercentString = function(e) {
        return typeof e == "string" && /^(-?[0-9]+)%$/.test(e)
    }, dv.util.isValidValue = function(e, t) {
        for (var n = 0; n < t.length; n++)
            if (dv.util[t[n]](e))
                return !0;
        return !1
    }, dv.util.identity = function(e) {
        return e
    }, dv.util.clamp = function(e, t, n) {
        return Math.min(Math.max(e, t), n)
    }, dv.util.clone = function(e) {
        return dv.util.isObject(e) ? dv.util.isArray(e) ? e.slice() : dv.util.extend({}, e) : e
    }, dv.util.isArray = function(e) {
        return Array.isArray ? Array.isArray(e) : Object.prototype.toString.call(e) == "[object Array]"
    }, dv.util.isObject = function(e) {
        return e === Object(e)
    }, dv.util.isFunction = function(e) {
        return Object.prototype.toString.call(e) == "[object Function]"
    }, dv.util.isUndefined = function(e) {
        return e === void 0
    }, dv.util.isFinite = function(e) {
        return isFinite(e) && !isNaN(parseFloat(e))
    }, dv.util.isDate = function(e) {
        return e instanceof Date
    }, dv.util.isEmpty = function(e) {
        return Object.keys(e).length === 0
    }, dv.util.extend = function(e) {
        return dv.util.each(Array.prototype.slice.call(arguments, 1), function(t) {
            for (var n in t)
                e[n] = t[n]
        }), e
    }, dv.util.each = function(e, t, n) {
        if (e == null)
            return;
        if (Array.prototype.forEach && e.forEach === Array.prototype.forEach)
            e.forEach(t, n);
        else if (e.length === +e.length) {
            for (var r = 0, i = e.length; r < i; r++)
                if (t.call(n, e[r], r, e) === {})
                    return
        } else
            for (var s in e)
                if (dv.util.has(e, s) && t.call(n, e[s], s, e) === {})
                    return
    }, dv.util.has = function(e, t) {
        return Object.prototype.hasOwnProperty.call(e, t)
    }, dv.util.uniq = function(e, t, n, r) {
        dv.util.isFunction(t) && (r = n, n = t, t = !1);
        var i = n ? dv.util.map(e, n, r) : e, s = [], o = [];
        return dv.util.each(i, function(n, r) {
            if (t ? !r || o[o.length - 1] !== n : !dv.util.contains(o, n))
                o.push(n), s.push(e[r])
        }), s
    }, dv.util.union = function() {
        return dv.util.uniq(Array.prototype.concat.apply(Array.prototype, arguments))
    }, dv.util.contains = function(e, t) {
        return e == null ? !1 : Array.prototype.indexOf && e.indexOf === Array.prototype.indexOf ? e.indexOf(t) != -1 : dv.util.any(e, function(e) {
            return e === t
        })
    }, dv.util.any = function(e, t, n) {
        t || (t = dv.util.identity);
        var r = !1;
        if (e == null)
            return r;
        if (Array.prototype.some && e.some === Array.prototype.some)
            return e.some(t, n);
        dv.util.each(e, function(e, i, s) {
            if (r || (r = t.call(n, e, i, s)))
                return {}
        })
    }, dv.util.sortBy = function(e, t, n) {
        var r = function(e) {
            return dv.util.isFunction(e) ? e : function(t) {
                return t[e]
            }
        }, i = r(t);
        return dv.util.pluck(dv.util.map(e, function(e, t, r) {
            return {value: e,index: t,criteria: i.call(n, e, t, r)}
        }).sort(function(e, t) {
            var n = e.criteria, r = t.criteria;
            if (n !== r) {
                if (n > r || n === void 0)
                    return 1;
                if (n < r || r === void 0)
                    return -1
            }
            return e.index < t.index ? -1 : 1
        }), "value")
    }, dv.util.pluck = function(e, t) {
        return dv.util.map(e, function(e) {
            return e[t]
        })
    }, dv.util.map = function(e, t, n) {
        var r = [];
        return e === null ? r : Array.prototype.map && e.map === Array.prototype.map ? e.map(t, n) : (dv.util.each(e, function(e, i, s) {
            r[r.length] = t.call(n, e, i, s)
        }), r)
    }, dv.util.reduce = function(e, t, n, r) {
        var i = arguments.length > 2;
        e === null && (e = []);
        if (Array.prototype.reduce && e.reduce === Array.prototype.reduce)
            return r && (t = dv.util.bind(t, r)), i ? e.reduce(t, n) : e.reduce(t);
        dv.util.each(e, function(e, s, o) {
            i ? n = t.call(r, n, e, s, o) : (n = e, i = !0)
        });
        if (!i)
            throw new TypeError("Reduce of empty array with no initial value");
        return n
    }, dv.util.bind = function(e, t) {
        if (e.bind === Function.prototype.bind && Function.prototype.bind)
            return Function.prototype.bind.apply(e, Array.prototype.slice.call(arguments, 1));
        var n = Array.prototype.slice.call(arguments, 2);
        return function() {
            return e.apply(t, n.concat(Array.prototype.slice.call(arguments)))
        }
    }, dv.util.noop = function() {
    }, dv.util.each(["Arguments", "String", "Number", "RegExp"], function(e) {
        dv.util["is" + e] = function(t) {
            return toString.call(t) == "[object " + e + "]"
        }
    }), dv.util.validateParam = function(e, t, n, r) {
        if (t === "isString")
            return dv.util.isString(e) && dv.util.isArray(n) && n.indexOf(e.toLowerCase()) !== -1 ? e.toLowerCase() : r;
        if (t === "isNumber")
            return dv.util.isNumber(e) && dv.util.isArray(n) && e <= n[1] && e >= n[0] ? e : r;
        if (t === "isFunction")
            return dv.util.isFunction(e) ? e : r;
        if (t === "isDimension")
            return e === "x" || e === "X" ? "x" : e === "y" || e === "Y" ? "y" : e === ["x", "y"] || e === ["X", "y"] || e === ["x", "Y"] || e === ["X", "Y"] ? ["x", "y"] : r;
        if (t === "isRange") {
            var i = n[0], s = n[1];
            return dv.util.isArray(e) && e.length === 2 ? (dv.util.isNumber(e[0]) && dv.util.isNumber(e[1]) && (i = Math.max(Math.min(e[0], e[1]), n[0]), s = Math.min(Math.max(e[0], e[1]), n[1])), [i, s]) : r
        }
    }, dv.util = dv.util || {}, dv.util.svg = {}, dv.util.svg.getDasharray = function(e) {
        if (e.indexOf(",") != -1 || e.indexOf(" ") != -1)
            return e;
        if (V.hasOwnProperty(e))
            return V[e];
        throw new Error("The dashed line format is invalid")
    };
    var V = {solid: "",dashed: "7,4",dotted: "2,3",dotdash: "2,3,7,4",longdash: "11,4",twodash: "5,2,11,2"};
    dv.container = dv.extend(function() {
        function t() {
            this._aes = {}
        }
        var e = {x: dv.scale.linear,y: dv.scale.linear,yMin: dv.scale.linear,yMax: dv.scale.linear,xMin: dv.scale.linear,xMax: dv.scale.linear,color: dv.scale.color,fill: dv.scale.color,stroke: dv.scale.color,alpha: dv.scale.linear,shape: dv.scale.shape,size: dv.scale.size,radius: dv.scale.linear,group: dv.scale.ordinal,linetype: dv.scale.linetype,label: dv.scale.identity};
        return t.render = function() {
            throw new Error("render() must be implemented in a subclass")
        }, t._calculateStats = function() {
            throw new Error("_calculateStats() must be implemented in a subclass")
        }, t._handlePositions = function() {
            throw new Error("_handlePositions() must be implemented in a subclass")
        }, t.getTrainedScale = function(e) {
            throw new Error("getTrainedScale() must be implemented in a subclass")
        }, t.getExplicitScalesMap = function() {
            return this._aes
        }, t._normalizeData = function(e) {
            if (e.hasOwnProperty("data") && !dv.util.isArray(e.data))
                return e;
            var t = {}, n = this.getExplicitScalesMap(), r, i = this;
            return dv.util.each(n, function(n, i) {
                for (var s in n) {
                    r = n[s];
                    if (!(r instanceof dv.scale.constant)) {
                        var o = e[r.mapping()];
                        if (dv.util.isArray(o)) {
                            var u = o.map(function(e) {
                                return dv.util.isArray(e) ? e.map(function(e) {
                                    return r._parse(e)
                                }) : r._parse(e)
                            });
                            t[r.property()] = u
                        }
                    }
                }
            }), t.data = e, t
        }, t.map = function(t, n, r, i) {
            r || (r = e[t]().copy().isDefault(!0));
            if (!r)
                throw new Error("There is no default scale associated with this property. Either the property isn't valid or the scale default doesn't exist.");
            return arguments.length < 4 && (i = 0), this._aes[t] || (this._aes[t] = {}), this._aes[t][i] = r.property(t).mapping(n).scaleIndex(i), this
        }, t.set = function(e, t) {
            this._aes[e] || (this._aes[e] = {});
            var n = this._aes[e][0] = dv.scale.constant();
            return dv.util.isFunction(t) ? n.map = n.mapToProp = t : n.value(t), this
        }, t.on = function(e, t, n) {
            arguments.length < 3 && (n = !1);
            var r = t && dv.util.isFunction(t);
            return r ? (this.eventMap = this.eventMap || {}, this.eventMap[e] = {callback: t,capture: n}) : (this.eventMap && delete this.eventMap[e], this.unregisterEventMap = this.unregisterEventMap || {}, this.unregisterEventMap[e] = n), this._removeRegisteredEvents(), this._addRegisteredEvents(), this
        }, t.position = function(e) {
            return arguments.length ? (this._position = e, this) : this._chart && !this._position ? this._chart.position() : this._position
        }, t.delay = function(e) {
            return arguments.length ? (this._delay = d3.functor(e), this) : this._chart && dv.util.isUndefined(this._delay) ? this._chart.delay() : this._delay
        }, t.duration = function(e) {
            return arguments.length ? (this._duration = d3.functor(e), this) : this._chart && dv.util.isUndefined(this._duration) ? this._chart.duration() : this._duration
        }, t.ease = function(e) {
            return arguments.length ? (this._ease = e, this) : this._chart && dv.util.isUndefined(this._ease) ? this._chart.ease() : this._ease
        }, t
    }), dv.coord = dv.extend(function() {
        function e() {
            this._flip = !1
        }
        return e.flip = function(e) {
            return arguments.length ? (this._flip = e, this) : this._flip
        }, e.startX = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isFinite", "isPercentString"]) || dv.log.error({msg: "Invalid value type, startX/startAngle must be a number or percent string",data: {val: e}}), this._startX = e, this) : this._startX
        }, e.endX = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isFinite", "isPercentString"]) || dv.log.error({msg: "Invalid value type, endX/endAngle must be a number or percent string",data: {val: e}}), this._endX = e, this) : this._endX
        }, e.startY = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isFinite", "isPercentString"]) || dv.log.error({msg: "Invalid value type, startY/innerRadius must be a number or percent string",data: {val: e}}), this._startY = e, this) : this._startY
        }, e.endY = function(e) {
            return arguments.length ? (dv.util.isValidValue(e, ["isFinite", "isPercentString"]) || dv.log.error({msg: "Invalid value type, endY/outerRadius must be a number or percent string",data: {val: e}}), this._endY = e, this) : this._endY
        }, e
    }), dv.coord.cartesian = dv.coord.extend(function() {
        function e() {
            this._super(), this.startX(0), this.endX(0), this.startY(0), this.endY(0), this._type = "cartesian"
        }
        return e._translatePercentToX = function(e, t) {
            var n = dv.util.scaleRange(e), r = this._translatePercent(t, n, this.startX(), this.endX()), i = Math.abs(n[1] - n[0]) * 3;
            return dv.util.clamp(r, n[0] - i, n[1] + i)
        }, e._translatePercentToY = function(e, t) {
            var n = dv.util.scaleRange(e), r = this._translatePercent(t, n, this.startY(), this.endY()), i = Math.abs(n[1] - n[0]) * 3;
            return dv.util.clamp(r, n[1] - i, n[0] + i)
        }, e._translatePercent = function(e, t, n, r) {
            return (t[1] - t[0] - r - n) * e + n + t[0]
        }, e._translatePercentArrToY = function(e, t) {
            var n = this;
            return dv.util.map(t, function(t) {
                return n._translatePercentToY(e, t)
            })
        }, e._translatePercentArrToX = function(e, t) {
            var n = this;
            return dv.util.map(t, function(t) {
                return n._translatePercentToX(e, t)
            })
        }, e._text = function() {
            function t() {
                var n = dv.svg.text();
                return e._flip ? n.x(function(n, r) {
                    return e._translatePercentToY(n.panel.yOuterScale(), t.y()(n, r))
                }).y(function(n, r) {
                    return e._translatePercentToX(n.panel.xOuterScale(), t.x()(n, r))
                }) : n.x(function(n, r) {
                    return e._translatePercentToX(n.panel.xOuterScale(), t.x()(n, r))
                }).y(function(n, r) {
                    return e._translatePercentToY(n.panel.yOuterScale(), t.y()(n, r))
                })
            }
            var e = this;
            return t.x = function(e) {
                return arguments.length ? (this._x = e, this) : this._x
            }, t.y = function(e) {
                return arguments.length ? (this._y = e, this) : this._y
            }, t
        }, e._point = function() {
            var e = this, t = {};
            return t.renderer = dv.svg.symbol().x(function(e, t) {
                return e.bounds.x
            }).y(function(e, t) {
                return e.bounds.y
            }), t.getBounds = function(n, r) {
                return n.hasOwnProperty("y") || (n.y = 0), n.hasOwnProperty("x") || (n.x = 0), t._defined(n, r) ? (e._flip ? n.bounds = {x: e._translatePercentToY(n.panel.yOuterScale(), t.y()(n, r)),y: e._translatePercentToX(n.panel.xOuterScale(), t.x()(n, r))} : n.bounds = {x: e._translatePercentToX(n.panel.xOuterScale(), t.x()(n, r)),y: e._translatePercentToY(n.panel.yOuterScale(), t.y()(n, r))}, n) : null
            }, t.getPath = function(e) {
                return e === null || e.bounds === undefined ? null : t.renderer(e)
            }, t.x = function(e) {
                return arguments.length ? (this._x = e, t) : this._x
            }, t.y = function(e) {
                return arguments.length ? (this._y = e, t) : this._y
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e._line = function() {
            var e = this, t = {};
            return t.renderer = d3.svg.line().x(function(e, t) {
                return e.bounds.x
            }).y(function(e, t) {
                return e.bounds.y
            }), t.getBounds = function(n, r) {
                var i = [];
                return dv.util.each(n, function(r, s) {
                    r.hasOwnProperty("y") || (r.y = 0), r.hasOwnProperty("x") || (r.x = 0), t._defined(r, s) && (e._flip ? r.bounds = {x: e._translatePercentToY(r.panel.yOuterScale(), t.y()(r, s)),y: e._translatePercentToX(r.panel.xOuterScale(), t.x()(r, s))} : r.bounds = {x: e._translatePercentToX(r.panel.xOuterScale(), t.x()(r, s)),y: e._translatePercentToY(r.panel.yOuterScale(), t.y()(r, s))}, i.push(n[s]))
                }), i
            }, t.getPath = function(e) {
                return e === null ? null : t.renderer(e)
            }, t.x = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.x must be a function",data: {val: e}}), this._x = e, this) : this._x
            }, t.y = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.y must be a function",data: {val: e}}), this._y = e, this) : this._y
            }, t.defined = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.defined must be a function",data: {val: e}}), this._defined = e, this) : this._defined
            }, t
        }, e._area = function() {
            var e = this, t = {};
            return t.renderer = d3.svg.area(), t.getBounds = function(n, r) {
                var i = [];
                return t.setupRenderer(), dv.util.each(n, function(n, r) {
                    n.hasOwnProperty("y") || (n.y = 0), n.hasOwnProperty("x") || (n.x = 0);
                    if (t._defined(n, r)) {
                        var s = dv.util.clone(n);
                        s.bounds = {x: e._translatePercentToX(n.panel.xOuterScale(), t.x()(n, r)),y0: e._translatePercentToY(n.panel.yOuterScale(), t.y0()(n, r)),y1: e._translatePercentToY(n.panel.yOuterScale(), t.y1()(n, r))}, i.push(s)
                    }
                }), i
            }, t.getPath = function(e) {
                return t.setupRenderer(), e === null ? null : t.renderer(e)
            }, t.setupRenderer = function() {
                e._flip ? t.renderer.x(null).y0(null).y1(null).y(function(e, t) {
                    return e.bounds.x
                }).x0(function(e, t) {
                    return e.bounds.y0
                }).x1(function(e, t) {
                    return e.bounds.y1
                }) : t.renderer.y(null).x0(null).x1(null).x(function(e, t) {
                    return e.bounds.x
                }).y0(function(e, t) {
                    return e.bounds.y0
                }).y1(function(e, t) {
                    return e.bounds.y1
                })
            }, t.x = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, area.x must be a function",data: {val: e}}), this._x = e, this) : this._x
            }, t.y0 = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, area.y0 must be a function",data: {val: e}}), this._y0 = e, this) : this._y0
            }, t.y1 = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, area.y1 must be a function",data: {val: e}}), this._y1 = e, this) : this._y1
            }, t.defined = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, area.defined must be a function",data: {val: e}}), this._defined = e, this) : this._defined
            }, t
        }, e._rect = function() {
            var e = this, t = {};
            return t.renderer = dv.svg.rect().x0(function(e, t) {
                return e.bounds.x0
            }).x1(function(e, t) {
                return e.bounds.x1
            }).y0(function(e, t) {
                return e.bounds.y0
            }).y1(function(e, t) {
                return e.bounds.y1
            }), t.getBounds = function(n, r) {
                var i = dv.util.clone(n), s = i[n.panel.xScale(n).property()];
                dv.util.isArray(s) && (i.x0 = s[0], i.x1 = s[1]);
                var o = i[n.panel.yScale(n).property()];
                return dv.util.isArray(o) && (i.y0 = o[0], i.y1 = o[1]), t._defined(i, r) ? (e._flip ? i.bounds = {x0: e._translatePercentToY(n.panel.yOuterScale(), t.y0()(i, r)),x1: e._translatePercentToY(n.panel.yOuterScale(), t.y1()(i, r)),y0: e._translatePercentToX(n.panel.xOuterScale(), t.x0()(i, r)),y1: e._translatePercentToX(n.panel.xOuterScale(), t.x1()(i, r))} : i.bounds = {x0: e._translatePercentToX(n.panel.xOuterScale(), t.x0()(i, r)),x1: e._translatePercentToX(n.panel.xOuterScale(), t.x1()(i, r)),y0: e._translatePercentToY(n.panel.yOuterScale(), t.y0()(i, r)),y1: e._translatePercentToY(n.panel.yOuterScale(), t.y1()(i, r))}, i) : null
            }, t.getPath = function(e) {
                return e === null ? null : t.renderer(e)
            }, t.x0 = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.x0 must be a function",data: {val: e}}), this._x0 = e, this) : this._x0
            }, t.x1 = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.x1 must be a function",data: {val: e}}), this._x1 = e, this) : this._x1
            }, t.y0 = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.y0 must be a function",data: {val: e}}), this._y0 = e, this) : this._y0
            }, t.y1 = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.y1 must be a function",data: {val: e}}), this._y1 = e, this) : this._y1
            }, t.defined = function(e) {
                return arguments.length ? (dv.util.isValidValue(e, ["isFunction"]) || dv.log.error({msg: "Invalid value, line.defined must be a function",data: {val: e}}), this._defined = e, this) : this._defined
            }, t
        }, e._errorBar = function() {
            var e = this, t = {};
            return t.renderer = dv.svg.errorBar().x0(function(e, t) {
                return e.bounds.x0
            }).x1(function(e, t) {
                return e.bounds.x1
            }).y0(function(e, t) {
                return e.bounds.y0
            }).y1(function(e, t) {
                return e.bounds.y1
            }).flip(function() {
                return e._flip
            }), t.getBounds = function(n, r) {
                var i = dv.util.clone(n);
                return t._defined(i, r) ? (e._flip ? i.bounds = {x0: e._translatePercentToY(n.panel.yOuterScale(), t.y0()(i, r)),x1: e._translatePercentToY(n.panel.yOuterScale(), t.y1()(i, r)),y0: e._translatePercentToX(n.panel.xOuterScale(), t.x0()(i, r)),y1: e._translatePercentToX(n.panel.xOuterScale(), t.x1()(i, r))} : i.bounds = {x0: e._translatePercentToX(n.panel.xOuterScale(), t.x0()(i, r)),x1: e._translatePercentToX(n.panel.xOuterScale(), t.x1()(i, r)),y0: e._translatePercentToY(n.panel.yOuterScale(), t.y0()(i, r)),y1: e._translatePercentToY(n.panel.yOuterScale(), t.y1()(i, r))}, i) : null
            }, t.getPath = function(e) {
                return e === null ? null : t.renderer(e)
            }, t.x0 = function(e) {
                return arguments.length ? (this._x0 = e, this) : this._x0
            }, t.x1 = function(e) {
                return arguments.length ? (this._x1 = e, this) : this._x1
            }, t.y0 = function(e) {
                return arguments.length ? (this._y0 = e, this) : this._y0
            }, t.y1 = function(e) {
                return arguments.length ? (this._y1 = e, this) : this._y1
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e._poly = function() {
            var e = this, t = {};
            return t.renderer = dv.svg.poly().xs(function(e, t) {
                return e.bounds.x
            }).ys(function(e, t) {
                return e.bounds.y
            }), t.getBounds = function(n, r) {
                var i = dv.util.clone(n);
                return t._defined(n, r) && (e._flip ? i.bounds = {x: e._translatePercentArrToY(n.panel.yOuterScale(), t.ys()(n, r)),y: e._translatePercentArrToX(n.panel.xOuterScale(), t.xs()(n, r))} : i.bounds = {x: e._translatePercentArrToX(n.panel.xOuterScale(), t.xs()(n, r)),y: e._translatePercentArrToY(n.panel.yOuterScale(), t.ys()(n, r))}), i
            }, t.getPath = function(e) {
                return e === null ? null : t.renderer(e)
            }, t.xs = function(e) {
                return arguments.length ? (this._xs = e, this) : this._xs
            }, t.ys = function(e) {
                return arguments.length ? (this._ys = e, this) : this._ys
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e
    }), dv.coord.polar = dv.coord.extend(function() {
        function e() {
            this._super(), this.innerRadius = this.startY, this.outerRadius = this.endY, this.startAngle = this.startX, this.endAngle = this.endX, this.innerRadius(0), this.outerRadius(0), this.startAngle(0), this.endAngle(360), this._type = "polar"
        }
        return e._transformAngleRadiusToXY = function(e, t) {
            return e += -1.570796327, [t * Math.cos(e), t * Math.sin(e)]
        }, e._translatePercentToRadius = function(e, t) {
            var n = Math.abs(e[1] - e[0]) / 2, r = dv.util.getPercentValue(this.innerRadius(), n), i = dv.util.getPercentValue(this.outerRadius(), n);
            return (n - i - r) * t + r
        }, e._translatePercentToTheta = function(e, t) {
            var n = 360, r = dv.util.getPercentValue(this.startAngle(), n), i = dv.util.getPercentValue(this.endAngle(), n), s = (i - r) * t + r;
            return s * .017453293
        }, e._translatePercentArrToRadius = function(e, t) {
            var n = this;
            return dv.util.map(t, function(t) {
                return n._translatePercentToRadius(e, t)
            })
        }, e._translatePercentArrToTheta = function(e, t) {
            var n = this;
            return dv.util.map(t, function(t) {
                return n._translatePercentToTheta(e, t)
            })
        }, e._getRadiusRange = function(e, t) {
            var n = dv.util.scaleRange(e), r = dv.util.scaleRange(t);
            return [0, Math.min(Math.abs(n[1] - n[0]), Math.abs(r[1] - r[0]))]
        }, e._text = function() {
            function t() {
                var n = dv.svg.text.radial();
                return e._flip ? n.angle(function(n, r) {
                    return e._translatePercentToTheta(n.panel.yOuterScale(), t.y()(n, r))
                }).radius(function(n, r) {
                    return e._translatePercentToRadius(e._getRadiusRange(n.panel.xOuterScale(), n.panel.yOuterScale()), t.x()(n, r))
                }) : n.angle(function(n, r) {
                    return e._translatePercentToTheta(n.panel.xOuterScale(), t.x()(n, r))
                }).radius(function(n, r) {
                    return e._translatePercentToRadius(e._getRadiusRange(n.panel.xOuterScale(), n.panel.yOuterScale()), t.y()(n, r))
                })
            }
            var e = this;
            return t.x = function(e) {
                return arguments.length ? (this._x = e, this) : this._x
            }, t.y = function(e) {
                return arguments.length ? (this._y = e, this) : this._y
            }, t
        }, e._point = function() {
            var e = this, t = {};
            return t.renderer = dv.svg.symbol.radial().angle(function(e, t) {
                return e.bounds.x
            }).radius(function(e, t) {
                return e.bounds.y
            }), t.getBounds = function(n, r) {
                n.hasOwnProperty("y") || (n.y = 0), n.hasOwnProperty("x") || (n.x = 0);
                if (t._defined(n, r)) {
                    var i = e._getRadiusRange(n.panel.xOuterScale(), n.panel.yOuterScale());
                    e._flip ? n.bounds = {x: e._translatePercentToTheta(n.panel.xOuterScale(), t.y()(n, r)),y: e._translatePercentToRadius(i, t.x()(n, r))} : n.bounds = {x: e._translatePercentToTheta(n.panel.xOuterScale(), t.x()(n, r)),y: e._translatePercentToRadius(i, t.y()(n, r))}
                }
                return n
            }, t.getPath = function(e) {
                return e === null || dv.util.isUndefined(e.bounds) ? null : t.renderer(e)
            }, t.x = function(e) {
                return arguments.length ? (this._x = e, this) : this._x
            }, t.y = function(e) {
                return arguments.length ? (this._y = e, this) : this._y
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e._line = function() {
            var e = this, t = {};
            return t.renderer = d3.svg.line.radial().angle(function(e, t) {
                return e.bounds.x
            }).radius(function(e, t) {
                return e.bounds.y
            }), t.getBounds = function(n, r) {
                var i = [];
                return dv.util.each(n, function(r, s) {
                    var o = e._getRadiusRange(r.panel.xOuterScale(), r.panel.yOuterScale());
                    r.hasOwnProperty("y") || (r.y = 0), r.hasOwnProperty("x") || (r.x = 0), t._defined(r, s) && (e._flip ? r.bounds = {x: e._translatePercentToTheta(r.panel.xOuterScale(), t.y()(r, s)),y: e._translatePercentToRadius(o, t.x()(r, s))} : r.bounds = {x: e._translatePercentToTheta(r.panel.xOuterScale(), t.x()(r, s)),y: e._translatePercentToRadius(o, t.y()(r, s))}, i.push(n[s]))
                }), i
            }, t.getPath = function(e) {
                return e === null ? null : t.renderer(e)
            }, t.x = function(e) {
                return arguments.length ? (this._x = e, this) : this._x
            }, t.y = function(e) {
                return arguments.length ? (this._y = e, this) : this._y
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e._area = function() {
            var e = this, t = {};
            return t.renderer = d3.svg.area.radial(), t.getBounds = function(n, r) {
                var i = [];
                return t.setupRenderer(), dv.util.each(n, function(n, r) {
                    var s = e._getRadiusRange(n.panel.xOuterScale(), n.panel.yOuterScale());
                    n.hasOwnProperty("y") || (n.y = 0), n.hasOwnProperty("x") || (n.x = 0);
                    if (t._defined(n, r)) {
                        var o = dv.util.clone(n);
                        e._flip ? o.bounds = {x: e._translatePercentToRadius(s, t.x()(n, r)),y0: e._translatePercentToTheta(n.panel.xOuterScale(), t.y0()(n, r)),y1: e._translatePercentToTheta(n.panel.xOuterScale(), t.y1()(n, r))} : o.bounds = {x: e._translatePercentToTheta(n.panel.xOuterScale(), t.x()(n, r)),y0: e._translatePercentToRadius(s, t.y0()(n, r)),y1: e._translatePercentToRadius(s, t.y1()(n, r))}, i.push(o)
                    }
                }), i
            }, t.getPath = function(e) {
                return t.setupRenderer(), e === null ? null : t.renderer(e)
            }, t.setupRenderer = function() {
                e._flip ? t.renderer.angle(null).innerRadius(null).outerRadius(null).radius(function(e, t) {
                    return e.bounds.x
                }).startAngle(function(e, t) {
                    return e.bounds.y0
                }).endAngle(function(e, t) {
                    return e.bounds.y1
                }) : t.renderer.radius(null).startAngle(null).endAngle(null).angle(function(e, t) {
                    return e.bounds.x
                }).innerRadius(function(e, t) {
                    return e.bounds.y0
                }).outerRadius(function(e, t) {
                    return e.bounds.y1
                })
            }, t.x = function(e) {
                return arguments.length ? (this._x = e, this) : this._x
            }, t.y0 = function(e) {
                return arguments.length ? (this._y0 = e, this) : this._y0
            }, t.y1 = function(e) {
                return arguments.length ? (this._y1 = e, this) : this._y1
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e._rect = function() {
            var e = this, t = {};
            return t.renderer = d3.svg.arc().startAngle(function(e, t) {
                return e.bounds.x0
            }).endAngle(function(e, t) {
                return e.bounds.x1
            }).innerRadius(function(e, t) {
                return e.bounds.y0
            }).outerRadius(function(e, t) {
                return e.bounds.y1
            }), t.getBounds = function(n, r) {
                var i = dv.util.clone(n);
                if (!t._defined(i, r))
                    return null;
                var s = e._getRadiusRange(n.panel.xOuterScale(), n.panel.yOuterScale());
                return e._flip ? i.bounds = {x0: e._translatePercentToTheta(n.panel.yOuterScale(), t.y0()(i, r)),x1: e._translatePercentToTheta(n.panel.yOuterScale(), t.y1()(i, r)),y0: e._translatePercentToRadius(s, t.x0()(i, r)),y1: e._translatePercentToRadius(s, t.x1()(i, r))} : i.bounds = {x0: e._translatePercentToTheta(n.panel.xOuterScale(), t.x0()(i, r)),x1: e._translatePercentToTheta(n.panel.xOuterScale(), t.x1()(i, r)),y0: e._translatePercentToRadius(s, t.y0()(i, r)),y1: e._translatePercentToRadius(s, t.y1()(i, r))}, i
            }, t.getPath = function(e) {
                return e === null ? null : t.renderer(e)
            }, t.x0 = function(e) {
                return arguments.length ? (this._x0 = e, this) : this._x0
            }, t.x1 = function(e) {
                return arguments.length ? (this._x1 = e, this) : this._x1
            }, t.y0 = function(e) {
                return arguments.length ? (this._y0 = e, this) : this._y0
            }, t.y1 = function(e) {
                return arguments.length ? (this._y1 = e, this) : this._y1
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e._poly = function() {
            var e = this, t = {};
            return t.renderer = dv.svg.poly.radial().angles(function(e, t) {
                return e.bounds.x
            }).radii(function(e, t) {
                return e.bounds.y
            }), t.getBounds = function(n, r) {
                var i = dv.util.clone(n);
                if (t._defined(n, r)) {
                    var s = e._getRadiusRange(n.panel.xOuterScale(), n.panel.yOuterScale());
                    e._flip ? i.bounds = {x: e._translatePercentArrToTheta(n.panel.xOuterScale(), t.ys()(n, r)),y: e._translatePercentArrToRadius(s, t.xs()(n, r))} : i.bounds = {x: e._translatePercentArrToTheta(n.panel.xOuterScale(), t.xs()(n, r)),y: e._translatePercentArrToRadius(s, t.ys()(n, r))}
                }
                return i
            }, t.getPath = function(e) {
                return e === null ? null : t.renderer(e)
            }, t.xs = function(e) {
                return arguments.length ? (this._xs = e, this) : this._xs
            }, t.ys = function(e) {
                return arguments.length ? (this._ys = e, this) : this._ys
            }, t.defined = function(e) {
                return arguments.length ? (this._defined = e, this) : this._defined
            }, t
        }, e
    }), dv.guide = dv.extend(function() {
        function e() {
            this._renderer = null
        }
        return e._render = function() {
            dv.log.warn({msg: "dv.guide._render should not be called directly, try using dv.guide.legend.render or dv.guide.axis.render"})
        }, e._scale = function(e) {
            return arguments.length ? (this.__scale = e, this) : this.__scale
        }, e.orientation = function(e) {
            return arguments.length ? (this._orientation = e, this) : this._orientation
        }, e._parent = function(e) {
            return arguments.length ? (this.__parent = e, this) : this.__parent
        }, e.scaleIndex = function(e) {
            return arguments.length ? (this._scaleIndex = e, this) : this._scaleIndex
        }, e.title = function(e) {
            return arguments.length ? (this._title = e, this) : this._title
        }, e
    }), dv.guide.axes = dv.extend(function() {
        function e() {
            this._axes = {}, this._emptyTickFormat = function() {
                return ""
            }
        }
        return e._initializeAxisRenderers = function() {
            this._eachAxis(function(e, t, n) {
                !n.hasOwnProperty("_orientation") && e === "x" && (n._orientation = "bottom"), !n.hasOwnProperty("_orientation") && e === "y" && (n._orientation = "left");
                if (this._chart._coord.flip())
                    switch (n._orientation) {
                        case "top":
                            n._orientation = "right";
                            break;
                        case "right":
                            n._orientation = "top";
                            break;
                        case "bottom":
                            n._orientation = "left";
                            break;
                        case "left":
                            n._orientation = "bottom"
                    }
            })
        }, e._measure = function(e) {
            var t = this._chart._g.select(".panels"), n = this._chart._axisLabelContainer;
            return this._eachAxis(function(r, i, s) {
                var o = this._changeScaleRangeToLocal(e.getOuterScale(r));
                !(this._chart._coord instanceof dv.coord.polar) && s !== "none" && (s._chart(this._chart)._scale(o[i])._parent(t)._labelParent(n), e.margins(s._measure(e.margins(), e.bounds(), e)))
            }), this
        }, e._getAllOrientations = function() {
            var e = {};
            return this._eachAxis(function(t, n, r) {
                e[r._orientation] = t
            }), e
        }, e._render = function(e, t, n) {
            return this._eachAxis(function(r, i, s) {
                var o = this._changeScaleRangeToLocal(n.getOuterScale(r));
                this._chart._coord instanceof dv.coord.polar || s === "none" ? (e.selectAll(".axis-" + r + ".axis-index-" + i).transition().duration(this._chart._duration).style("opacity", 0).remove(), this._chart._chartContainer.select(".axes-labels .axis-" + r + ".axis-index-" + i).transition().duration(this._chart._duration).style("opacity", 0).remove()) : s._chart(this._chart)._parent(e)._scale(o[i])._labelParent(t)._render(e, n, n.bounds())
            }), this
        }, e._measureTitles = function(e) {
            var t = this._chart._axisLabelContainer;
            return this._eachAxis(function(n, r, i) {
                if (i !== "none") {
                    var s = i._chart(this._chart)._measureAxisTitle(t, n, r, e);
                    e.left += s.left, e.top += s.top, e.right -= s.right, e.bottom -= s.bottom
                }
            }), e
        }, e._renderTitles = function(e, t) {
            var n = this._chart._axisLabelContainer;
            this._eachAxis(function(r, i, s) {
                s === "none" || !s.title() ? n.selectAll(".axis-title-" + r + ".axis-title-index-" + i).transition().duration(this._chart._duration).style("opacity", 0).remove() : s._chart(this._chart)._renderAxisTitle(n, t, r, i, e)
            })
        }, e._changeScaleRangeToLocal = function(e) {
            var t = e.range(), n = e.innerScaleGroup();
            for (var r in n)
                dv.util.scaleRange(n[r], [t[0], t[1]]);
            return n
        }, e._eachAxis = function(e) {
            for (var t in this._axes) {
                var n = this._axes[t];
                for (var r in n)
                    e.call(this, t, +r, n[r])
            }
        }, e._add = function(e, t, n) {
            n = n === undefined ? 0 : n;
            var r = this._axes[e];
            return r || (this._axes[e] = r = {}), r[n] = t, this
        }, e._axes = function(e) {
            return arguments.length ? (this._axes = e, this) : this._axes
        }, e._get = function(e) {
            return this._axes[e]
        }, e._empty = function() {
            for (var e in this._axes)
                delete this._axes[e];
            return this._axes = {}, this
        }, e._chart = function(e) {
            return arguments.length ? (this._chart = e, this) : this._chart
        }, e
    }), dv.guide.axis = dv.guide.extend(function() {
        function e() {
            this._ticks = d3.functor(5), this._tickInterval = undefined, this._labelGroup = null, this._htmlLabels = !1
        }
        function t(e, t) {
            return e + "%"
        }
        return e._measure = function(e, t, n) {
            var r = this._getAxisOffset(t), i = dv.util.scaleRange(this._scale()), s = this._ticks.call(this, Math.abs(i[1] - i[0])), o, u = this, a = this._parent().append("g").classed("temp-axis", !0);
            this._shouldDrawAxisLabels(n) && (o = this._constructLabelGroup(this.__labelParent, r, !0));
            var f = this._constructD3Axis(o, t, s, n), l = this._measureAxis(a, r, f), c = {left: l.x + r[0],top: l.y + r[1],right: l.x + l.width + r[0],bottom: l.y + l.height + r[1]};
            o && o.selectAll("span").each(function() {
                var e = this, t = d3.select(this), n = u._htmlLabels ? t.html() : t.text();
                if (n) {
                    var r = u._orientation === "right" ? e.offsetWidth / 2 : 0, i = u._orientation === "bottom" ? e.offsetHeight / 2 : 0, s = [e.parentNode.parentNode.offsetLeft + e.parentNode.offsetLeft + r, e.parentNode.parentNode.offsetTop + e.parentNode.offsetTop + i];
                    c.left = Math.min(s[0], c.left), c.top = Math.min(s[1], c.top), c.right = Math.max(s[0] + r, c.right), c.bottom = Math.max(s[1] + i, c.bottom)
                }
            }), a.remove(), o && o.remove();
            var h = {};
            return h.left = Math.abs(Math.min(c.left - t.left, 0)), h.top = Math.abs(Math.min(c.top - t.top, 0)), h.right = Math.max(c.right - t.right, 0), h.bottom = Math.max(c.bottom - t.bottom, 0), this._unionAxisPadding(h, e)
        }, e._render = function(e, t, n) {
            if (!this._scale())
                throw new Error("The axis does not have a scale associated with it.");
            var r = dv.util.scaleRange(this._scale()), i = this._ticks.call(this, Math.abs(r[1] - r[0])), s, o = this._getAxisOffset(n);
            this._shouldDrawAxisLabels(t) ? s = this._constructLabelGroup(this.__labelParent, o) : this.__labelParent.selectAll(".axis-" + this._scale().property() + ".axis-index-" + this._scale().scaleIndex()).remove();
            var u = this._constructD3Axis(s, n, i, t);
            return this._renderAxis(this._parent(), t.bounds(), o, u, s), this
        }, e._shouldDrawAxisLabels = function(e) {
            var t = e.facet(), n = this._scale().property(), r = this.orientation();
            return t._isFree(n) && t._showAllPanelLabelsIfFree() || e.visibleAxisLabelOrientations()[r]
        }, e._unionAxisPadding = function(e, t) {
            return t.left = Math.max(t.left, e.left), t.top = Math.max(t.top, e.top), t.right = Math.max(t.right, e.right), t.bottom = Math.max(t.bottom, e.bottom), t
        }, e._constructLabelGroup = function(e, t, n) {
            var r = ".axis-" + this._scale().property() + ".axis-index-" + this._scale().scaleIndex() + (n ? " .temp-axis" : ""), i = e.selectAll(r).data([0]);
            return i.enter().append("div").classed("axis-" + this._scale().property() + " axis-index-" + this._scale().scaleIndex(), !0).classed("temp-axis", n).style("left", t[0] + "px").style("top", t[1] + "px"), dv.ANIMATION ? i.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease()).style("left", t[0] + "px").style("top", t[1] + "px") : i.style("left", t[0] + "px").style("top", t[1] + "px"), i
        }, e._getAxisOffset = function(e) {
            switch (this._orientation) {
                case "bottom":
                    return [0, e.bottom];
                case "left":
                    return [e.left, 0];
                case "top":
                    return [0, e.top];
                case "right":
                    return [e.right, 0]
            }
        }, e._constructD3Axis = function(e, n, r, i) {
            var s = dv.util.isUndefined(this._tickSize) ? this._getDefaultTickSize(n) : this._tickSize, o = dv.util.isUndefined(this._minorTickSize) ? this._getDefaultTickSize(n) : this._minorTickSize, u;
            this._orientation === "left" && (u = "right"), this._orientation === "right" && (u = "left"), this._orientation === "top" && (u = "bottom"), this._orientation === "bottom" && (u = "top");
            if (this._scale().property() === "x") {
                var a = dv.util.scaleRange(this._scale());
                a[0] += this._chart().coord().startX(), a[1] -= this._chart().coord().endX(), this._scale() instanceof dv.scale.ordinal ? this._scale().rangeBands(a) : this._scale().range(a)
            }
            return dv.svg.axis()._orient(u)._labelParent(e)._panel(i)._ticks(dv.util.isUndefined(r) ? 5 : r, this._tickInterval)._tickSize(s, o, s)._tickDx(dv.util.isUndefined(this._tickDx) ? this._getDefaultTickDx() : this._tickDx)._tickDy(dv.util.isUndefined(this._tickDy) ? this._getDefaultTickDy() : this._tickDy)._tickAnchor(dv.util.isUndefined(this._tickAnchor) ? this._getDefaultTickAnchor() : this._tickAnchor)._tickFormat(dv.util.isUndefined(this._tickFormat) && this._chart().position() === "fill" && this._scale().property() === "y" ? t : this._tickFormat)._tickValues(this._tickValues)._htmlLabels(this._htmlLabels)._tickSubdivide(this._tickSubdivide)._scale(this._scale()._d3Scale)
        }, e._renderAxis = function(e, t, n, r, i) {
            var s = e.selectAll(".axis-" + this._scale().property() + ".axis-index-" + this._scale().scaleIndex()).data([0]);
            r._labelParent(i), s.enter().append("g").classed("axis axis-" + this._scale().property() + " axis-index-" + this._scale().scaleIndex(), !0).attr("transform", "translate(" + n[0] + "," + n[1] + ")"), dv.ANIMATION && (s = s.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease())), s.attr("transform", "translate(" + n[0] + "," + n[1] + ")").call(r)
        }, e._measureAxis = function(e, t, n) {
            return e.attr("transform", "translate(" + t[0] + "," + t[1] + ")").call(n), e.node().getBBox()
        }, e._measureAxisTitle = function(e, t, n, r) {
            var i = {left: 0,top: 0,right: 0,bottom: 0};
            if (this._title) {
                var s = e.append("div").classed("temp-axis-title", !0), o = this._titleOrientation || this._orientation, u = this._createAndSizeAxisTitle(s, o, t, n, r), a = u.node().getBoundingClientRect();
                o === "top" || o === "bottom" ? i[o] += a.height : i[o] += a.width, s.remove()
            }
            return i
        }, e._renderAxisTitle = function(e, t, n, r, i) {
            var s, o = 6, u = 0, a = this._titleOrientation || this._orientation, f;
            if (!this._title)
                return;
            var l = e.selectAll(".axis-title-" + n + ".axis-title-index-" + r).empty(), c = this._createAndSizeAxisTitle(e, a, n, r, i);
            dv.ANIMATION && (f = c.transition().duration(this._chart().duration()).delay(this._chart().delay()).ease(this._chart().ease())), this._positionAxisTitle(l || !dv.ANIMATION ? c : f, t[a], a), f ? f.style("opacity", 1) : c.style("opacity", 1)
        }, e._createAndSizeAxisTitle = function(t, n, r, i, s) {
            var o = n === "top" || n === "bottom" ? s.right - s.left : s.bottom - s.top, u = t.selectAll(".axis-title-" + r + ".axis-title-index-" + i).data([e]);
            return u.enter().append("div").classed("axis-title axis-title-" + r + " axis-title-index-" + i, !0).style("opacity", dv.ANIMATION ? 0 : 1), u.text(this._title).style("width", o - 10 + "px").classed({top: n === "top",bottom: n === "bottom",left: n === "left",right: n === "right"})
        }, e._positionAxisTitle = function(e, t, n) {
            e.style("left", function() {
                var e = 0;
                return t[0] + e + "px"
            }).style("top", function() {
                var e = 0;
                return n === "top" && (e = -this.offsetHeight), t[1] + e + "px"
            })
        }, e._getDefaultTickSize = function(e) {
            return this._orientation === "bottom" ? d3.functor(e.bottom - e.top) : this._orientation === "left" ? d3.functor(e.right - e.left) : this._orientation === "top" ? d3.functor(e.bottom - e.top) : d3.functor(e.right - e.left)
        }, e._getDefaultTickDx = function() {
            return this._orientation === "bottom" || this._orientation === "top" ? d3.functor(0) : d3.functor(-12)
        }, e._getDefaultTickDy = function() {
            return this._orientation === "bottom" || this._orientation === "top" ? d3.functor(-12) : d3.functor(0)
        }, e._getDefaultTickAnchor = function() {
            return this._orientation === "left" ? d3.functor("end") : this._orientation === "right" ? d3.functor("start") : d3.functor("middle")
        }, e._labelParent = function(e) {
            return arguments.length ? (this.__labelParent = e, this) : this.__labelParent
        }, e.ticks = function(e, t) {
            return arguments.length ? (arguments.length > 1 ? (this._ticks = function() {
                return e
            }, this._tickInterval = t) : (this._ticks = d3.functor(e), this._tickInterval = undefined), this) : dv.util.isFinite(this._tickInterval) ? [this._ticks, this._tickInterval] : this._ticks
        }, e.tickSubdivide = function(e) {
            return arguments.length ? (this._tickSubdivide = e, this) : this._tickSubdivide
        }, e.tickSize = function(e) {
            return arguments.length ? (this._tickSize = d3.functor(e), this) : this._tickSize
        }, e.minorTickSize = function(e) {
            return arguments.length ? (this._minorTickSize = d3.functor(e), this) : this._minorTickSize
        }, e.tickDx = function(e) {
            return arguments.length ? (this._tickDx = d3.functor(e), this) : this._tickDx
        }, e.htmlLabels = function(e) {
            return arguments.length ? (this._htmlLabels = e, this) : this._htmlLabels
        }, e.tickDy = function(e) {
            return arguments.length ? (this._tickDy = d3.functor(e), this) : this._tickDy
        }, e.tickAnchor = function(e) {
            return arguments.length ? (this._tickAnchor = d3.functor(e), this) : this._tickAnchor
        }, e.tickFormat = function(e) {
            if (!arguments.length) {
                var t = this._scale()._d3Scale;
                return this._tickFormat ? this._tickFormat : t.tickFormat ? t.tickFormat(t) : function(e) {
                    return e
                }
            }
            return this._tickFormat = e, this
        }, e.tickValues = function(e) {
            return arguments.length ? (this._tickValues = e, this) : this._tickValues
        }, e.titleOrientation = function(e) {
            return arguments.length ? (this._titleOrientation = e, this) : this._titleOrientation
        }, e._chart = function(e) {
            return arguments.length ? (this.__chart = e, this) : this.__chart
        }, e
    }), dv.svg.axis = function() {
        function d(e, t) {
            e.attr("transform", function(e) {
                return "translate(" + t(e) + ",0)"
            })
        }
        function v(e, t) {
            e.attr("transform", function(e) {
                return "translate(0," + t(e) + ")"
            })
        }
        function m(e, t, n) {
            var r = d3.select(e).select("span").node().offsetWidth, i = n === "end" ? -r : n === "middle" ? -r / 2 : 0;
            return t + i
        }
        function g(e, t, n) {
            var r = d3.select(e).select("span").node().offsetHeight, i = n === "top" ? 0 : n === "middle" ? -r / 2 : -r;
            return t + i
        }
        function y(e, t, n) {
            var r = [];
            if (n && t.length > 1) {
                var i = dv.util.scaleExtent(e.domain()), s = -1, o = t.length, u = (t[1] - t[0]) / ++n, a, f;
                while (++s < o)
                    for (a = n; --a > 0; )
                        (f = +t[s] - a * u) >= i[0] && r.push(f);
                for (--s, a = 0; ++a < n && (f = +t[s] + a * u) < i[1]; )
                    r.push(f)
            }
            return r
        }
        function b(b) {
            var w = function(e, t, n, r, i) {
                var a = {};
                switch (i) {
                    case "top":
                        a.top = g(e, -o.call(e, t, n), "top"), a.left = r(t) + m(e, s.call(e, t, n), u.call(e, t, n));
                        break;
                    case "bottom":
                        a.top = g(e, o.call(e, t, n), "bottom"), a.left = r(t) + m(e, s.call(e, t, n), u.call(e, t, n));
                        break;
                    case "right":
                        a.top = r(t) + g(e, o.call(e, t, n), "middle"), a.left = m(e, s.call(e, t, n), u.call(e, t, n));
                        break;
                    case "left":
                        a.top = r(t) + g(e, o.call(e, t, n), "middle"), a.left = m(e, -s.call(e, t, n), u.call(e, t, n))
                }
                a.top = (isNaN(a.top) ? 0 : a.top) + "px", a.left = (isNaN(a.left) ? 0 : a.left) + "px";
                var f = u.call(e, t, n);
                return d3.select(e).classed({start: f === "start",middle: f === "middle",end: f === "end"}), a
            }, E = function(e, t) {
                ["top", "left"].forEach(function(n) {
                    e.style(n, function(e, r) {
                        return t[r][n]
                    })
                })
            }, S = function(n, r, i) {
                if (!p)
                    return;
                var s = c == null ? e.tickFormat ? e.tickFormat.apply(e, a) : String : c, o, u, f, h;
                p.style("position", "absolute"), o = p.selectAll(".axis-label").data(n, String), u = o.enter().append("div").classed("axis-label", !0).style("opacity", 1e-6).style("position", "absolute"), f = d3.transition(o.exit()).style("opacity", 1e-6).remove(), h = d3.transition(o).style("opacity", 1), u.append("span");
                var d = o.selectAll("span"), v = function(e, t, n) {
                    return s.call(this, e, n)
                };
                l ? d.html(v) : d.text(v);
                var m = [], g = [], y = [], b = [], S;
                if (!e.ticks) {
                    var x = e.rangeBand() / 2;
                    S = function(e) {
                        return i(e) + x
                    }
                }
                u.each(function(e, n) {
                    m[n] = w(this, e, n, S || r, t)
                }), h.each(function(e, n) {
                    g[n] = w(this, e, n, S || r, t), y[n] = w(this, e, n, S || i, t)
                }), e.ticks && f.each(function(e, n) {
                    b[n] = w(this, e, n, i, t)
                }), E(u, m), E(o, g), E(h, y), e.ticks && E(f, b)
            };
            b.each(function() {
                var s = d3.select(this), o = f == null ? e.ticks ? e.ticks.apply(e, a) : e.domain() : f, u = y(e, o, h), l = s.selectAll(".minor").data(u, String), c = l.enter().insert("line", "g").attr("class", "tick minor").style("opacity", 1e-6), p = d3.transition(l.exit()).style("opacity", 1e-6).remove(), m = d3.transition(l).style("opacity", 1), g = s.selectAll(".axis-tick").data(o, String), b = g.enter().insert("g", "path").classed("axis-tick", !0).style("opacity", 1e-6), w = d3.transition(g.exit()).style("opacity", 1e-6).remove(), E = d3.transition(g).style("opacity", 1), x, T = dv.util.scaleRangeNoReverse(e);
                path = s.selectAll(".domain").data([0]), pathEnter = path.enter().append("path").attr("class", "domain"), pathUpdate = d3.transition(path);
                var N = e.copy(), C = this.__chart__ || N;
                this.__chart__ = N, b.append("line").attr("class", "tick");
                var k = b.select("line"), L = E.select("line");
                switch (t) {
                    case "bottom":
                        x = d, c.attr("y2", function(e, t) {
                            return r.call(this, e, t, panel)
                        }), m.attr("x2", 0).attr("y2", function(e, t) {
                            return r.call(this, e, t, panel)
                        }), k.attr("y2", function(e, t) {
                            return n.call(this, e, t, panel)
                        }), L.attr("x2", 0).attr("y2", function(e, t) {
                            return n.call(this, e, t, panel)
                        }), pathUpdate.attr("d", function(e, t) {
                            return "M" + T[0] + "," + i.call(this, e, t, panel) + "V0H" + T[1] + "V" + i.call(this, e, t, panel)
                        });
                        break;
                    case "top":
                        x = d, c.attr("y2", function(e, t) {
                            return -r.call(this, e, t, panel)
                        }), m.attr("x2", 0).attr("y2", function(e, t) {
                            return -r.call(this, e, t, panel)
                        }), k.attr("y2", function(e, t) {
                            return -n.call(this, e, t, panel)
                        }), L.attr("x2", 0).attr("y2", function(e, t) {
                            return -n.call(this, e, t, panel)
                        }), pathUpdate.attr("d", function(e, t) {
                            return "M" + T[0] + "," + -i.call(this, e, t, panel) + "V0H" + T[1] + "V" + -i.call(this, e, t, panel)
                        });
                        break;
                    case "left":
                        x = v, c.attr("x2", function(e, t) {
                            return -r.call(this, e, t, panel)
                        }), m.attr("x2", function(e, t) {
                            return -r.call(this, e, t, panel)
                        }).attr("y2", 0), k.attr("x2", function(e, t) {
                            return -n.call(this, e, t, panel)
                        }), L.attr("x2", function(e, t) {
                            return -n.call(this, e, t, panel)
                        }).attr("y2", 0), pathUpdate.attr("d", function(e, t) {
                            return "M" + -i.call(this, e, t, panel) + "," + T[0] + "H0V" + T[1] + "H" + -i.call(this, e, t, panel)
                        });
                        break;
                    case "right":
                        x = v, c.attr("x2", function(e, t) {
                            return r.call(this, e, t, panel)
                        }), m.attr("x2", function(e, t) {
                            return r.call(this, e, t, panel)
                        }).attr("y2", 0), k.attr("x2", function(e, t) {
                            return n.call(this, e, t, panel)
                        }), L.attr("x2", function(e, t) {
                            return n.call(this, e, t, panel)
                        }).attr("y2", 0), pathUpdate.attr("d", function(e, t) {
                            return "M" + i.call(this, e, t, panel) + "," + T[0] + "H0V" + T[1] + "H" + i.call(this, e, t, panel)
                        })
                }
                if (e.ticks)
                    b.call(x, C), E.call(x, N), w.call(x, N), c.call(x, C), m.call(x, N), p.call(x, N);
                else {
                    var A = N.rangeBand() / 2, O = function(e) {
                        return N(e) + A
                    };
                    b.call(x, O), E.call(x, O)
                }
                S(o, C, N)
            })
        }
        var e = d3.scale.linear(), t = "bottom", n = d3.functor(6), r = d3.functor(6), i = d3.functor(6), s = d3.functor(0), o = d3.functor(0), u = d3.functor("start"), a = [10], f = null, l = !1, c, h = 0, p;
        return b._scale = function(t) {
            return arguments.length ? (e = t, b) : e
        }, b._orient = function(e) {
            return arguments.length ? (t = e, b) : t
        }, b._ticks = function() {
            return arguments.length ? (a = arguments, b) : a
        }, b._tickValues = function(e) {
            return arguments.length ? (f = e, b) : f
        }, b._tickFormat = function(e) {
            return arguments.length ? (c = e, b) : c
        }, b._htmlLabels = function(e) {
            return arguments.length ? (l = e, b) : l
        }, b._tickSize = function(e, t, s) {
            if (!arguments.length)
                return n;
            var o = arguments.length - 1;
            return n = d3.functor(e), r = o > 1 ? d3.functor(t) : n, i = o > 0 ? d3.functor(arguments[o]) : n, b
        }, b._tickDx = function(e) {
            return arguments.length ? (s = e, b) : s
        }, b._tickDy = function(e) {
            return arguments.length ? (o = e, b) : o
        }, b._tickAnchor = function(e) {
            return arguments.length ? (u = e, b) : u
        }, b._tickSubdivide = function(e) {
            return arguments.length ? (h = +e, b) : h
        }, b._panel = function(e) {
            return arguments.length ? (panel = e, b) : panel
        }, b._labelParent = function(e) {
            return arguments.length ? (p = e, b) : p
        }, b
    }, dv.guide.legends = dv.extend(function() {
        function e() {
            this._legArr = [], this.__hide = !1, this._ad = {left: 0,right: 0,width: 0,height: 0}
        }
        return e._render = function(e) {
            this._w = 0, this._h = 0;
            if (!this.__hide) {
                var t = e.el.select(".legends"), n = this, r = t.selectAll(".legend").data(this._legArr);
                r.exit().transition().duration(e.duration).style("opacity", 0).remove();
                var i = r.enter().append("g").classed("legend", !0);
                dv.ANIMATION && i.style("opacity", 0), r.each(function(t, r) {
                    var i = {}, s = t.props[0], o = n._getScale(e, t.props[0]), u = o.domain();
                    for (var a = 0; a < t.props.length; a++) {
                        var f = t.props[a], l = n._getScale(e, t.props[a]);
                        if (!l.hasSameDomain(u))
                            throw new Error("Can't render single legend from multiple domains");
                        i[f] = e.scales[f]
                    }
                    t.guide._render(d3.select(this), i, {dims: n._ad,renderOpts: e}), n._w += t.guide._getUsedWidth(), n._h += t.guide._getUsedHeight(), n._ad = t.guide._getAdjustedDimensions(n._ad)
                })
            }
            return this
        }, e._getScale = function(e, t) {
            var n = e.scales[t], r;
            if (t === undefined || n === undefined || n[0] === undefined)
                throw new Error("A '" + t + "'' legend has been called for, but '" + t + " hasn't been mapped to data.");
            return n[0]
        }, e._add = function(e) {
            return this._legArr.push(e), this
        }, e._remove = function(e) {
            for (var t in e) {
                var n = e[t];
                for (var r = 0; r < this._legArr.length; r++) {
                    var i = this._legArr[r].props, s = !0;
                    for (var o = 0; o < i.length; o++)
                        i[o] === n && (i.splice(o, 1), o--), i.length === 0 && (s = !1);
                    s || (this._legArr.splice(r, 1), r--)
                }
            }
        }, e._legends = function(e) {
            return arguments.length ? (this._legArr = e, this) : this._legArr
        }, e._allowedDimensions = function(e) {
            return arguments.length ? (this._ad = e, this) : this._ad
        }, e._getWidth = function() {
            return this._w
        }, e._getHeight = function() {
            return this._h
        }, e._hide = function(e) {
            return arguments.length ? (this.__hide = e, this) : this.__hide
        }, e._empty = function() {
            for (var e = 0; e < this._legArr.length; e++)
                delete this._legArr[e];
            return this._legArr = [], this
        }, e
    }), dv.guide.legend = dv.guide.extend(function() {
        function e() {
            this._overlay = !1, this._orientation = "top", this._vGap = 5, this._hGap = 15, this._defaultPadding = this._padding = {top: 10,left: 10,right: 10,bottom: 10}, this._swatchWidth = 15, this._swatchHeight = 10, this._innerPadding = 5, this._spanPercent = .75, this._lineHeight = 0, this._entriesWidth = []
        }
        function t(e) {
            var t = this;
            return e.each(function(e, n) {
                t._entryWidths[n] = Math.min(t._entryWidths[n], t._width), t._lineHeight = Math.max(t._lineHeight, this.getBBox().height)
            }), t._entryWidths
        }
        function n(e) {
            var t = 0, i = 0, s, o = 0, u = !1, a = 0, f = 0, l = [];
            for (var c = 0; c < this._legendWidths.length; c++) {
                t += (i === 0 ? 0 : this._hGap) + this._legendWidths[c];
                if (i < e.data.length && t <= this._width) {
                    if (this._legendWidths[c] <= e.data[i] + o)
                        f += i === 0 ? 0 : this._hGap, l.push({x: f,y: a}), f += e.data[i] + o, o = 0;
                    else {
                        if ((s = this._legendWidths[c] - e.data[i]) <= e.padding)
                            return e.padding -= s, e.data[i] = this._legendWidths[c], n.call(this, e);
                        if (!(i + 1 < e.data.length && this._legendWidths[c] >= e.data[i] + e.data[i + 1] * this._spanPercent + o))
                            return e = r.call(this, e.data.length - 1), n.call(this, e);
                        i + 1 <= e.data.length ? (o += (i === 0 ? 0 : this._hGap) + e.data[i], t -= (i === 0 ? 0 : this._hGap) + this._legendWidths[c], c--) : (t = t - this._legendWidths[c] + o + e.data[i], o = 0, f += i === 0 ? 0 : this._hGap, l.push({x: f,y: a}), f += e.data[i] + o, i++)
                    }
                    i++
                } else {
                    if (i + 1 === e.data.length && e.data.length > 1)
                        return e = r.call(this, e.data.length - 1), n.call(this, e);
                    i === e.data.length && (u = !0), a += this._lineHeight + this._vGap, t = f = 0, i = 0, o = 0, c--
                }
            }
            return i === e.data.length && (u = !0), u ? {offsets: l,cols: e} : (e = r.call(this, e.data.length - 1), n.call(this, e))
        }
        function r(e) {
            var t = {data: [],padding: this._width}, n = 0, i = 0;
            this._isVAligned() && (e = Math.ceil(this._legendWidths.length / Math.floor(this._height / (this._lineHeight + this._vGap))));
            for (i = 0; i < e; i++)
                n += this._legendWidths[i] + this._hGap;
            return n -= this._hGap, n > this._width && e > 1 ? r.call(this, e - 1) : (t.data = this._legendWidths.slice(0, e), t.padding -= n, t.padding < 0 && (t.padding = 0), t)
        }
        function i(e, t, n, r) {
            return "M" + e + "," + t + "L" + (e + n) + "," + t + "L" + (e + n) + "," + (t + r) + "L" + e + "," + (t + r) + "Z"
        }
        function s(e, t, n, r) {
            var i = t + r >> 1;
            return "M" + e + "," + i + "L" + n + "," + i
        }
        function o(e, t) {
            return this._scales.hasOwnProperty("fill") ? i.call(this, 0, 0, this._swatchWidth, this._swatchHeight) : s.call(this, 0, 0, this._swatchWidth, this._swatchHeight)
        }
        return e._render = function(e, i, s) {
            var o = e, u = s.dims, a = this;
            this._renderingOptions = s.renderOpts, this._scales = i, this._transformData = [], this._width = u.width - this._padding.left - this._padding.right, this._height = u.height - this._padding.top - this._padding.bottom;
            var f = this._drawEntries(e);
            this._legendWidths = t.call(this, f);
            var l = r.call(this, Math.min(this._legendWidths.length, Math.floor(this._width / this._swatchWidth))), c = n.call(this, l), h = c.offsets;
            l = c.cols, this._width = this._width - l.padding + this._hGap * (l.data.length - 1), this._height = this._lineHeight + h[h.length - 1].y, f.each(function(e, t) {
                var n = d3.select(this);
                dv.ANIMATION && (n = n.transition().duration(a._renderingOptions.duration).delay(a._renderingOptions.delay).ease(a._renderingOptions.ease)), n.attr("transform", "translate(" + h[t].x + ", " + h[t].y + ")")
            }), this._renderingOptions.firstRender || (o = e.transition().duration(this._renderingOptions.duration).style("opacity", 1));
            var p = this._orientation === "right" ? u.left + u.width - this._width - this._padding.right : u.left + this._padding.left, d = this._orientation === "bottom" ? u.top + u.height - this._height - this._padding.bottom : u.top + this._padding.top;
            o.attr("transform", "translate(" + p + "," + d + ")"), this._renderingOptions.firstRender && o.transition().duration(this._renderingOptions.duration).style("opacity", 1)
        }, e._drawEntries = function(e) {
            var t = this, n = [];
            this._entryWidths = [];
            for (var r in this._scales) {
                n = this._scales[r][0].domain();
                break
            }
            var i = e.selectAll(".legend-entry").data(n);
            i.exit().transition().duration(this._renderingOptions.duration).style("opacity", 0).remove();
            var s = i.enter().append("g").classed("legend-entry", !0);
            return s.append("path"), s.append("text").classed("legend-entry-label", !0), s.append("text").classed("legend-entry-value", !0), i.select("path").attr("d", function(e, n) {
                return o.call(t, e, n)
            }).call(function(e) {
                e.attr("style", ""), t._scales.hasOwnProperty("fill") && e.style("fill", function(e, n) {
                    return t._scales.fill[0].mapValue(e)
                }), t._scales.hasOwnProperty("stroke") && e.style("stroke", function(e, n) {
                    return t._scales.stroke[0].mapValue(e)
                }).style("stroke-width", 2), t._scales.hasOwnProperty("linetype") && (e.style("stroke-dasharray", function(e, n) {
                    return dv.util.svg.getDasharray(t._scales.linetype[0].mapValue(e))
                }), t._scales.hasOwnProperty("stroke") || e.style("stroke", "#000"), e.style("stroke-width", 2)), t._scales.hasOwnProperty("size") && e.style("stroke-width", function(e, n) {
                    return t._scales.size[0].mapValue(e)
                })
            }).each(function(e, n) {
                t._entryWidths[n] = this.getBBox().width
            }), i.select("text.legend-entry-label").attr("x", this._swatchWidth + this._innerPadding).attr("y", 10).text(function(e, n) {
                return dv.util.isUndefined(t._labels) ? e : t._labels[n % t._labels.length]
            }).each(function(e, n) {
                t._entryWidths[n] += t._innerPadding + this.getBBox().width
            }), i.select("text.legend-entry-value").attr("y", 10).attr("x", function(e, n) {
                return t._entryWidths[n] + t._innerPadding
            }).text(function(e, n) {
                return dv.util.isUndefined(t._values) ? "" : t._values[n]
            }).style("fill", function(e, n) {
                if (!dv.util.isUndefined(t._scales.stroke))
                    return t._scales.stroke[0].mapValue(e);
                if (!dv.util.isUndefined(t._scales.fill))
                    return t._scales.fill[0].mapValue(e);
                return
            }).each(function(e, n) {
                var r = this.getBBox().width;
                t._entryWidths[n] += r + (r > 0 ? t._innerPadding : 0)
            }), i
        }, e._getAdjustedDimensions = function(e) {
            if (this._overlay)
                return e;
            var t = this._padding.left + this._width + this._padding.right, n = this._padding.top + this._height + this._padding.bottom;
            return this._orientation === "left" ? (e.left += t, e.width -= t) : this._orientation === "top" ? (e.top += n, e.height -= n) : this._orientation === "right" ? e.width -= t : this._orientation === "bottom" && (e.height -= n), e
        }, e._getUsedWidth = function() {
            return this._overlay ? 0 : this._isVAligned() ? this._width + this._padding.left + this._padding.right : 0
        }, e._getUsedHeight = function() {
            return this._overlay ? 0 : this._isVAligned() ? 0 : this._height + this._padding.top + this._padding.bottom
        }, e._isVAligned = function() {
            return this._orientation === "left" || this._orientation === "right"
        }, e.vGap = function(e) {
            return arguments.length ? (this._vGap = e, this) : this._vGap
        }, e.hGap = function(e) {
            return arguments.length ? (this._hGap = e, this) : this._hGap
        }, e.padding = function(e) {
            return arguments.length ? (this._padding = dv.util.merge(this._defaultPadding, e), this) : this._padding
        }, e.align = function(e) {
            return arguments.length ? (this._align = e, this) : this._align
        }, e.labels = function(e) {
            return arguments.length ? (this._labels = e, this) : this._labels
        }, e.values = function(e) {
            return arguments.length ? (this._values = e, this) : this._values
        }, e.overlay = function(e) {
            return arguments.length ? (this._overlay = e, this) : this._overlay
        }, e
    }), dv.guide.custom = dv.guide.extend(function() {
        function e(e) {
            this._render = function() {
                return dv.log.warn({msg: "empty render function on custom guide"}), this
            }, this._getAdjustedDimensions = function(e) {
                return e
            }, this._getUsedWidth = function() {
                return 0
            }, this._getUsedHeight = function() {
                return 0
            }
        }
        return e.setFunc = function(e, t) {
            return this[e] = t, this
        }, e
    }), dv.geom = dv.container.extend(function() {
        function e() {
            this._super(), this._defaultAes = {}, this._behaviorsLayer = null, this._dodgePadding = 0, this._initializeDefaultAes()
        }
        return e._initializeDefaultAes = function() {
            this._defaultAes.x = 1, this._defaultAes.y = 1, this._defaultAes.shape = "circle", this._defaultAes.linetype = "solid"
        }, e._prerender = function(e) {
            this._trainedScales = {}, this._chart = e, this.normalizedData(this._normalizeData(this.data())), this._calculateStats(), this._inheritChartAesthetics(e)
        }, e._inheritChartAesthetics = function(e) {
            for (var t in e._aes) {
                var n = e._aes[t];
                this._aes[t] || (this._aes[t] = {});
                for (var r in n)
                    this._aes[t][r] || (this._aes[t][r] = n[r])
            }
        }, e._trainScales = function() {
        }, e._createDefaultScales = function() {
            for (var e in this._defaultAes)
                this._aes.hasOwnProperty(e) || (this._aes[e] = {}, this._aes[e][0] = dv.scale.constant().value(this._defaultAes[e]).property(e)), delete this._defaultAes[e]
        }, e._render = function(e) {
            var t = this;
            this._geomGroup = d3.select(e);
            var n = this._geomGroup.selectAll(".series").data(this._nestData);
            n.exit().call(t.exitSeriesGroup, t), n.enter().append("g").classed("series", !0), n.call(t.updateGroups, t.enterPen, t.pen, t.enterPen, t).call(t.updateDataPoints, t.enterPen, t.pen, t.enterPen, t), t._renderBehaviors(t._geomGroup), t.unregisterEventMap = null
        }, e._renderBehaviors = function(e) {
            var t = this;
            this._behaviors && this._behaviors.length && (this._behaviorsLayer = e.select(".behavior-layer"), this._behaviorsLayer.empty() ? this._behaviorsLayer = e.append("g").classed("behavior-layer", !0) : this._behaviorsLayer.node().parentNode.appendChild(this._behaviorsLayer.node()), dv.util.each(this._behaviors, function(e) {
                e._geom(t)._render(t._behaviorsLayer)
            }))
        }, e.updateGroups = function(e, t, n, r, i) {
            e.each(function(e, t) {
                var n = 0, r = 0, s = d3.select(this), o = s.attr("transform");
                if (i._chart._coord instanceof dv.coord.polar) {
                    var u = e.values[0], a = dv.util.scaleRange(u.panel.xOuterScale()), f = dv.util.scaleRange(u.panel.yOuterScale()), l = (a[0] + a[1]) / 2, c = (f[0] + f[1]) / 2, h = i._chart._coord.flip();
                    n = h ? c : l, r = h ? l : c
                }
                o && dv.ANIMATION && (s = s.transition().duration(function(e, t) {
                    return i.duration().call(this, e, t)
                })), s.attr("transform", "translate(" + n + "," + r + ")")
            })
        }, e.updateDataPoints = function(e, t, n, r, i) {
            var s = t.call(i), o = n.call(i), u = r.call(i), a = e.selectAll("." + i._dataPointStyleClass).data(function(e) {
                return i.getValues(e)
            });
            a.exit().transition().delay(function(e, t, n) {
                return i.delay().call(this, e, t, n)
            }).duration(function(e, t, n) {
                return i.duration().call(this, e, t, n)
            }).ease(i.ease()).each(function() {
                this.__exiting__ = !0
            }).attrTween("d", u.pathTween).remove(), a.enter().append("path").each(function(e, t, n) {
                i.setPreviousState.call(this, s, u, e, t, n)
            }).attr("class", function(e, t, n) {
                return "datum-" + t + " series-" + n
            }).call(i.attributes, i).attr("d", s.path);
            var f = a.call(i.attributes, i).call(i._removeRegisteredEvents, i).call(i._addRegisteredEvents, i).each(function() {
                this.__exiting__ = !1
            });
            dv.ANIMATION ? f = f.transition().delay(function(e, t, n) {
                return i.delay().call(this, e, t, n)
            }).duration(function(e, t, n) {
                return i.duration().call(this, e, t, n)
            }).ease(i.ease()).attrTween("d", o.pathTween) : f.each(function(e, t, n) {
                var r = o.bounds(e, t, n);
                r && (e.bounds = r.bounds)
            }).attr("d", o.path), f.call(i.addEachFunction, i)
        }, e.addEachFunction = function(e, t) {
            t._each && (dv.util.isUndefined(t._each.start) || (dv.ANIMATION ? e.each("start", function(e, n, r) {
                t._each.start.call(this, e, n, r)
            }) : e.each(function(e, n, r) {
                t._each.start.call(this, e, n, r)
            })), dv.util.isUndefined(t._each.end) || (dv.ANIMATION ? e.each("end", function(e, n, r) {
                t._each.end.call(this, e, n, r)
            }) : e.each(function(e, n, r) {
                t._each.end.call(this, e, n, r)
            })))
        }, e.exitSeriesGroup = function(e, t) {
            t.exitSeries(e, t.enterPen, t)
        }, e.setPreviousState = function(e, t, n, r) {
            var i = e.bounds(n, r);
            this.__previousBounds__ = i, this.__exitTransition__ = t
        }, e.pathTween = function(e, t, n, r, i) {
            var s, o = d3.select(t);
            return t.__exiting__ ? (s = t.__exitTransition__.path(n, r), t.__exiting__ = !1) : s = e.getPath(e.getBounds(n, r)), s === null ? (o.remove(), null) : d3.interpolate(o.attr("d"), s)
        }, e._calculateStats = function() {
        }, e._handlePositions = function() {
            if (this.position() !== "stack" && this.position() !== "fill" && this.position() !== "dodge")
                return;
            var e = this.position(), t = this._addGroupLayerToNestedData(), n = this._chart.coord().flip(), r = function(e) {
                var t = i.getExplicitScales(e)[e], n = !1;
                return function(r, i) {
                    for (var s in t) {
                        n = t[s]._includeInDomain(r, i);
                        if (n)
                            break
                    }
                    return n ? r[e] : 0
                }
            }, i = this;
            dv.util.each(t, function(t) {
                var n = r("x"), i = r("y");
                if (e === "stack")
                    d3.layout.stack().x(n).y(i).values(function(e) {
                        return e.values
                    })(t.values);
                else if (e === "fill")
                    d3.layout.stack().x(n).y(i).offset(function(e) {
                        var t = e.length, n = e[0].length, r = 1 / t, i, s, o, u = [];
                        for (s = 0; s < n; ++s) {
                            for (i = 0, o = 0; i < t; i++)
                                o += e[i][s][1];
                            if (o)
                                for (i = 0; i < t; i++)
                                    e[i][s][1] /= o;
                            else
                                for (i = 0; i < t; i++)
                                    e[i][s][1] = 0
                        }
                        for (s = 0; s < n; ++s)
                            u[s] = 0;
                        return u
                    }).values(function(e) {
                        return e.values
                    })(t.values);
                else if (e === "dodge") {
                    var s = t.values.length;
                    dv.util.each(t.values, function(e, t) {
                        dv.util.each(e.values, function(e) {
                            e.dodge = {groupIndex: t,numGroups: s}
                        })
                    })
                }
            })
        }, e._addGroupLayerToNestedData = function() {
            var e = [], t = {}, n = {};
            return dv.util.each(this._nestData, function(r, i) {
                var s = /(.*) ~ .*/g.exec(r.key)[1], o = /.* ~ (.*)/g.exec(r.key)[1], u, a;
                t.hasOwnProperty(s) || (e.push({key: s,values: []}), t[s] = e.length - 1), u = e[t[s]], n.hasOwnProperty(r.key) || (u.values.push({key: o,values: []}), n[r.key] = u.values.length - 1), a = u.values[n[r.key]], a.values = a.values.concat(r.values)
            }), e
        }, e.exit = function(e) {
            d3.select(e).selectAll(".series").call(this.exitSeriesGroup, this)
        }, e.exitSeries = function(e, t, n) {
            e.selectAll("." + n._dataPointStyleClass).transition().delay(function(e, t, r) {
                return n.delay().call(this, e, t, r)
            }).duration(function(e, t, r) {
                return n.duration().call(this, e, t, r)
            }).ease(n.ease()).each(function() {
                this.__exiting__ = !0
            }).attrTween("d", t.call(n).pathTween).remove().each("end", function(e, t) {
                var n = this.parentNode;
                if (n && n.childNodes && !n.childNodes.length) {
                    var r = n.parentNode;
                    r && r.childNodes && r.childNodes.length <= 1 ? d3.select(r).remove() : d3.select(n).remove()
                }
            })
        }, e.coord = function() {
            return this.chart().coord()
        }, e._addRegisteredEvents = function(e, t) {
            t || (t = this);
            if (!t._geomGroup)
                return;
            e = e ? e : t._geomGroup.selectAll(".series").selectAll("." + this._dataPointStyleClass), t = t || this, dv.util.each(t.eventMap, function(n, r) {
                e.on(r, function(e, n, i) {
                    t.eventMap[r].callback.call(this, e, n, i, d3.event)
                }, n.capture)
            }), dv.util.each(t._chart.eventMap, function(n, r) {
                e.on(r + ".dvchart", function(e, n) {
                    var i = d3.event, s = t._chart._interactionGroup.select(".interaction-canvas").node();
                    t._shouldDispatchChartEvent(i, s) && t._chart.eventMap[r].callback.call(s, i)
                }, n.capture)
            }), dv.util.each(t._behaviors, function(e) {
                e._addRegisteredEvents && e._addRegisteredEvents()
            })
        }, e._removeRegisteredEvents = function(e, t) {
            t || (t = this);
            if (!t._geomGroup)
                return;
            e = e || t._geomGroup.selectAll("." + this._dataPointStyleClass), t = t || this, dv.util.each(t.unregisterEventMap, function(t, n) {
                e.on(n, null, t)
            }), dv.util.each(t._chart.unregisterEventMap, function(t, n) {
                e.on(n + ".dvchart", null, t)
            }), dv.util.each(t._behaviors, function(e) {
                e._removeRegisteredEvents && e._removeRegisteredEvents()
            })
        }, e._shouldDispatchChartEvent = function(e, t) {
            var n = !0;
            if (e.type === "mouseout" || e.type === "mouseover") {
                var r = e.relatedTarget;
                r || (r = e.type === "mouseout" ? e.toElement : e.fromElement);
                var i = d3.select(r);
                if (i && !i.empty()) {
                    var s = i.attr("class");
                    n = !(i.node() === t || s && s.indexOf("-geom") >= 0)
                }
            }
            return n
        }, e.getExplicitScalesMap = function() {
            var e = dv.util.clone(this._chart.getExplicitScalesMap());
            for (var t in this._aes) {
                var n = this._aes[t], r = e[t] || {}, i = dv.util.extend({}, r, n);
                e[t] = i
            }
            return e
        }, e.getExplicitScale = function(e, t) {
            if (e === "group")
                return this._getGroup();
            var n = this._aes[e], r = this.chart()._aes[e];
            return t !== undefined && n && n[t] ? n[t] : t !== undefined && r && r[t] ? r[t] : n && n[0] !== undefined ? n[0] : r && r[0] !== undefined ? r[0] : null
        }, e.getExplicitScales = function(e) {
            dv.util.isArray(e) || (e = [e]);
            var t = {}, n = -1, r = e.length;
            while (++n < r) {
                var i = e[n], s = this._aes[i], o = this.chart()._aes[i] || {};
                t[i] = dv.util.extend({}, o, s)
            }
            return t
        }, e.getTrainedScale = function(e, t) {
            return this.chart().getTrainedScale(e, t)
        }, e.getScale = function(e, t) {
            return this.getExplicitScale(e, t)
        }, e.getScales = function(e) {
            return this.getExplicitScales(e)
        }, e.hasScale = function(e, t) {
            return this.getExplicitScale(e, t) ? !0 : !1
        }, e._dodgeAdjust = function(e) {
            var t = e.dodge.groupIndex, n = e.dodge.numGroups, r = e.panel.xScale(e).rangeBand(), i = n > 1 ? r / (n - 1) * this._dodgePadding : 0, s = (r - i * (n - 1)) / n;
            return (s + i) * t + s / 2
        }, e.applyAttributeValue = function(e, t, n, r) {
            var i = t.getScale(r, 0);
            e.style(n, function(e, t, n) {
                return i ? i.mapToProp(dv.util.isArray(e) ? e[0] : e, t, n) : null
            })
        }, e._getGroup = function() {
            if (this._aes.hasOwnProperty("group"))
                return this._aes.group[0];
            var e = this.chart()._getGroup();
            if (e && e.property() === "group")
                return e;
            var t = -1, n = dv.DEFAULT_CATEGORICAL_AES.length - 1;
            while (t++ < n) {
                var r = this._aes[dv.DEFAULT_CATEGORICAL_AES[t]];
                if (r && r[0] && r[0] instanceof dv.scale.ordinal && !dv.util.isUndefined(r[0].mapping()))
                    return r[0]
            }
            return e
        }, e.each = function(e, t) {
            var n, r;
            return arguments.length ? (this._each = this._each || {}, arguments.length < 2 ? (r = e, n = "end") : (r = t, n = e), this._each[n] = r, this) : this._each
        }, e.dodgePadding = function(e) {
            return arguments ? (this._dodgePadding = e, this) : this._dodgePadding
        }, e.behaviors = function(e) {
            return arguments.length ? (this._behaviors = e, this) : this._behaviors
        }, e.stat = function(e) {
            return arguments.length ? (this._stat = e, this) : this._stat
        }, e.chart = function(e) {
            return arguments.length ? (this._chart = e, this) : this._chart
        }, e.normalizedData = function(e) {
            return arguments.length ? (this._normalizedData = e, this) : this._normalizedData
        }, e.data = function(e) {
            return arguments.length ? (this._data = e, this) : this._data ? this._data : this.chart().data()
        }, e
    }), dv.geom.point = dv.geom.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.point
        }
        return e._dataPointStyleClass = "point-geom", e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.shape = "circle", this._defaultAes.size = 7
        }, e.getValues = function(e) {
            return e.values
        }, e.exitSeriesGroup = function(e, t) {
            t.exitSeries(e, t.enterPen, t)
        }, e.attributes = function(e, t) {
            e.attr("style", "").classed(t._dataPointStyleClass, !0).call(t.applyAttributeValue, t, "opacity", "alpha").call(t.applyAttributeValue, t, "stroke", "stroke").call(t.applyAttributeValue, t, "fill", "fill")
        }, e.getHighlightColor = function(e, t) {
            var n = this.getScale("fill"), r = this.getScale("stroke");
            return !r || r instanceof dv.scale.constant ? !n || n instanceof dv.scale.constant ? r ? r.mapToProp(e, t) : "#8CC350" : n.mapToProp(e, t) : r.mapToProp(e, t)
        }, e.enterPen = function() {
            var e = this, t, n = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            };
            return this.position() === "dodge" ? t = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._dodgeAdjust(t), n)
            } : t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, this._decoratePen(t, n)
        }, e.pen = function() {
            var e = this, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, n;
            switch (this.position()) {
                case "identity":
                    n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
                    };
                    break;
                case "stack":
                    n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(e.y0 + e.y), t)
                    };
                    break;
                case "dodge":
                    t = function(t, n) {
                        var r = t.panel.xScale(t);
                        return r.mapValueToPercent(r.mapToProp(t, n) + e._dodgeAdjust(t), n)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
                    };
                    break;
                case "fill":
                    n = function(e, t) {
                        return e.y + e.y0
                    }
            }
            return this._decoratePen(t, n)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.xScale(e).mapToProp(e, t)) && dv.util.isFinite(e.panel.yScale(e).mapToProp(e, t))
        }, e._decoratePen = function(e, t) {
            var n = this.getScale("shape"), r = this.getScale("size"), i = this, s = this.coord()._point().x(e).y(t).defined(this._defined);
            return s.renderer.type(function(e, t) {
                return n.mapToProp(e, t)
            }).size(function(e, t) {
                return Math.pow(r.mapToProp(e, t), 2)
            }), {bounds: function(e, t) {
                    return s.getBounds(e, t)
                },pathTween: function(e, t) {
                    return i.pathTween(s, this, e, t)
                },path: function(e, t) {
                    return s.getPath(s.getBounds(e, t))
                }}
        }, e
    }), dv.geom.text = dv.geom.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.text, this._dx = d3.functor(0), this._dy = d3.functor(0), this._textFormat = function(e) {
                return e
            }, this._textAnchor = "start"
        }
        return e._dataPointStyleClass = "text-geom", e.dx = function(e) {
            return arguments.length ? (this._dx = d3.functor(e), this) : this._dx
        }, e.dy = function(e) {
            return arguments.length ? (this._dy = d3.functor(e), this) : this._dy
        }, e.textAnchor = function(e) {
            return arguments.length ? (this._textAnchor = e, this) : this._textAnchor
        }, e.textFormat = function(e) {
            return arguments.length ? (this._textFormat = d3.functor(e), this) : this._textFormat
        }, e.getValues = function(e) {
            return e.values
        }, e.updateDataPoints = function(e, t, n, r, i) {
            var s = i.getScale("alpha"), o = t.call(i), u = n.call(i), a = r.call(i), f = e.selectAll("." + i._dataPointStyleClass).data(function(e) {
                return i.getValues(e)
            });
            f.exit().transition().delay(function(e, t, n) {
                return i.delay().call(this, e, t, n)
            }).duration(function(e, t, n) {
                return i.duration().call(this, e, t, n)
            }).ease(i.ease()).call(a).each("end.transition", function(e, t) {
                var n = this.parentNode;
                n && n.removeChild(this)
            }), f.enter().append("text").attr("class", function(e, t, n) {
                return "datum-" + t + " series-" + n
            }).call(i.attributes, i).call(o);
            var l = f.call(i.attributes, i).call(i._removeRegisteredEvents, i).call(i._addRegisteredEvents, i);
            dv.ANIMATION && (l = l.transition().delay(function(e, t, n) {
                return i.delay().call(this, e, t, n)
            }).duration(function(e, t, n) {
                return i.duration().call(this, e, t, n)
            }).ease(i.ease())), l.call(u).call(i.addEachFunction, i)
        }, e.exitSeriesGroup = function(e, t) {
            t.exitSeries(e, t.enterPen, t)
        }, e.exitSeries = function(e, t, n) {
            e.selectAll("." + n._dataPointStyleClass).transition().delay(function(e, t, r) {
                return n.delay().call(this, e, t, r)
            }).duration(function(e, t, r) {
                return n.duration().call(this, e, t, r)
            }).ease(n.ease()).call(t.call(n)).remove().each("end.transition", function(e, t) {
                var n = this.parentNode;
                n.parentNode && n.removeChild(this), n && n.childNodes && !n.childNodes.length && d3.select(n).remove()
            })
        }, e.attributes = function(e, t) {
            e.attr("style", "").classed(t._dataPointStyleClass, !0).call(t.applyAttributeValue, t, "stroke", "stroke").call(t.applyAttributeValue, t, "fill", "fill").call(t.applyAttributeValue, t, "opacity", "alpha").call(t.applyAttributeValue, t, "font-size", "size").attr("text-anchor", t._textAnchor)
        }, e.enterPen = function() {
            var e = this, t = this._dx, n = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            }, r;
            return this.position() === "dodge" ? r = function(n, r, i) {
                var s = n.panel.xScale(n);
                return s.mapValueToPercent(s.mapToProp(n, r) + e._dodgeAdjust(n) + t(n, r, i), r)
            } : r = function(e, n, r) {
                var i = e.panel.xScale(e);
                return i.mapValueToPercent(i.mapToProp(e, n) + i.rangeBand() / 2 + t(e, n, r), n)
            }, this._decoratePen(r, n)
        }, e.pen = function() {
            var e = this, t = this._dx, n = this._dy, r = function(e, n, r) {
                var i = e.panel.xScale(e);
                return i.mapValueToPercent(i.mapToProp(e, n) + i.rangeBand() / 2 + t(e, n, r), n)
            }, i;
            switch (this.position()) {
                case "identity":
                    i = function(e, t, r) {
                        var i = e.panel.yScale(e);
                        return i.mapValueToPercent(i.mapToProp(e, t) + n(e, t, r) + i.rangeBand() / 2, t)
                    };
                    break;
                case "stack":
                    i = function(e, t, r) {
                        var i = e.panel.yScale(e);
                        return i.mapValueToPercent(i.mapValue(e.y0 + e.y, t) + n(e, t, r), t)
                    };
                    break;
                case "dodge":
                    r = function(n, r, i) {
                        var s = n.panel.xScale(n);
                        return s.mapValueToPercent(s.mapToProp(n, r) + e._dodgeAdjust(n) + t(n, r, i), r)
                    }, i = function(e, t, r) {
                        var i = e.panel.yScale(e);
                        return i.mapValueToPercent(i.mapToProp(e, t) + n(e, t, r) + i.rangeBand() / 2, t)
                    };
                    break;
                case "fill":
                    i = function(e, t, r) {
                        var i = e.panel.yScale(e);
                        return e.y + e.y0 + i.mapValueToPercent(n(e, t, r) + dv.util.scaleRange(i)[0], t)
                    }
            }
            return this._decoratePen(r, i)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.xScale(e).mapToProp(e, t)) && dv.util.isFinite(e.panel.yScale(e).mapToProp(e, t))
        }, e._decoratePen = function(e, t) {
            var n = this.getScale("label"), r = this, i = this.coord()._text().x(e).y(t);
            return i().label(function(e, t, i) {
                return r._textFormat.call(this, n.mapToProp(e, t), t, i)
            }).defined(this._defined)
        }, e
    }), dv.geom.line = dv.geom.extend(function() {
        function e() {
            this._super(), this._tension = .7, this._interpolate = "linear", this._rendererClass = dv.geom.line
        }
        return e._dataPointStyleClass = "line-geom", e.tension = function(e) {
            return arguments.length ? (this._tension = e, this) : this._tension
        }, e.interpolate = function(e) {
            return arguments.length ? (this._interpolate = e, this) : this._interpolate
        }, e._render = function(e) {
            this._super(e);
            var t = this.getScale("size");
            t && t.to && !t.to() && t.to([2, 8])
        }, e.getValues = function(e) {
            return [e.values]
        }, e.exitSeriesGroup = function(e, t) {
            t.exitSeries(e, t.enterPen, t)
        }, e.attributes = function(e, t) {
            var n = t.getScale("linetype", 0);
            e.attr("style", "").classed(t._dataPointStyleClass, !0).call(t.applyAttributeValue, t, "stroke", "stroke").call(t.applyAttributeValue, t, "opacity", "alpha").call(t.applyAttributeValue, t, "stroke-width", "size").style("stroke-dasharray", function(e, t, r) {
                return n ? dv.util.svg.getDasharray(n.mapToProp(e[0], t, r)) : null
            }).style("fill", "none")
        }, e.getHighlightColor = function(e, t) {
            var n = this.getScale("stroke", 0);
            return n ? n.mapToProp(e, t) : "#8CC350"
        }, e.enterPen = function() {
            var e = this, t, n = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            };
            return this.position() === "dodge" ? t = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._dodgeAdjust(t), n)
            } : t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, this._decoratePen(t, n)
        }, e.pen = function() {
            var e = this, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, n;
            switch (this.position()) {
                case "identity":
                    n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
                    };
                    break;
                case "stack":
                    n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(e.y0 + e.y), t)
                    };
                    break;
                case "dodge":
                    t = function(t, n) {
                        var r = t.panel.xScale(t);
                        return r.mapValueToPercent(r.mapToProp(t, n) + e._dodgeAdjust(t), n)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
                    };
                    break;
                case "fill":
                    n = function(e, t) {
                        return e.y + e.y0
                    }
            }
            return this._decoratePen(t, n)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.xScale(e).mapToProp(e, t)) && dv.util.isFinite(e.panel.yScale(e).mapToProp(e, t))
        }, e._decoratePen = function(e, t) {
            var n = this, r = this.coord()._line().x(e).y(t).defined(this._defined);
            return r.renderer.tension(this.tension()).interpolate(this.interpolate()), {bounds: function(e, t) {
                    return r.getBounds(e, t)
                },pathTween: function(e, t) {
                    return n.pathTween(r, this, e, t)
                },path: function(e, t) {
                    return r.getPath(r.getBounds(e, t))
                }}
        }, e
    }), dv.geom.area = dv.geom.extend(function() {
        function e() {
            this._super(), this._tension = .7, this._interpolate = "linear", this._rendererClass = dv.geom.area, this._baseline = 0
        }
        return e._dataPointStyleClass = "area-geom", e._initializeDefaultAes = function() {
            this._super()
        }, e._trainScales = function() {
            if (this._baseline !== undefined) {
                var e = this.getExplicitScales("y").y;
                for (var t in e) {
                    var n = e[t];
                    n instanceof dv.scale.continuous && n.softLowerLimit(this._baseline)
                }
            }
            this._super()
        }, e.tension = function(e) {
            return arguments.length ? (this._tension = e, this) : this._tension
        }, e.interpolate = function(e) {
            return arguments.length ? (this._interpolate = e, this) : this._interpolate
        }, e.getValues = function(e) {
            return [e.values]
        }, e.pathTween = function(e, t, n, r, i) {
            var s = n, o, u = t.__previousBounds__, a = [], f, l = this.enterPen.call(this, i), c, h, p = this.getScale("x").domain(), d = -1;
            o = e.getBounds(n, r), o.coord = this.coord();
            if (u && u.coord && o.coord._type !== u.coord._type || o.coord.flip() != u.coord.flip())
                u = this.enterPen.call(this, i).bounds(n, r);
            f = Math.max(o.length, u.length);
            while (++d < f)
                c = d < o.length ? o[d] : null, h = d < u.length ? u[d] : null, h ? c || (c = l.bounds([h], r)[0]) : (c.x = p[p.length - 1], h = l.bounds([c], r)[0]), a.push(d3.interpolateObject(h.bounds, c.bounds));
            return t.__previousBounds__ = o, function(t) {
                t === 1 && (a = a.splice(0, o.length));
                var n = [];
                return dv.util.each(a, function(e, r) {
                    var i = {};
                    i.bounds = e(t), n.push(i)
                }), e.getPath(n)
            }
        }, e.exitSeriesGroup = function(e, t) {
            t.exitSeries(e, t.enterPen, t)
        }, e.attributes = function(e, t) {
            e.attr("style", "").classed(t._dataPointStyleClass, !0).call(t.applyAttributeValue, t, "opacity", "alpha").call(t.applyAttributeValue, t, "fill", "fill")
        }, e.getHighlightColor = function(e, t) {
            var n = this.getScale("fill");
            return n ? n.mapToProp(e, t) : "#8CC350"
        }, e.getBaseline = function(e) {
            var t = e.domain()[0];
            return self._baseline !== undefined ? self._baseline : t < 0 ? 0 : t
        }, e.enterPen = function() {
            var e = this, t, n = function(t, n) {
                var r = t.panel.yScale(t);
                return r.mapValueToPercent(r.mapValue(e.getBaseline(r)), n)
            };
            return this.position() === "dodge" ? t = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._dodgeAdjust(t), n)
            } : t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, this._decoratePen(t, n, n)
        }, e.pen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, t, n, r = this;
            switch (this.position()) {
                case "identity":
                    t = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(r.getBaseline(n)), t)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapPropToPercent(e, t)
                    };
                    break;
                case "stack":
                    t = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(e.y0), t)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(e.y0 + e.y), t)
                    };
                    break;
                case "dodge":
                    e = function(e, t) {
                        var n = e.panel.xScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + r._dodgeAdjust(e), t)
                    }, t = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(r.getBaseline(n)), t)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapPropToPercent(e, t)
                    };
                    break;
                case "fill":
                    t = function(e, t) {
                        return e.y0
                    }, n = function(e, t) {
                        return e.y + e.y0
                    }
            }
            return this._decoratePen(e, t, n)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.xScale(e).mapToProp(e, t)) && dv.util.isFinite(e.panel.yScale(e).mapToProp(e))
        }, e._decoratePen = function(e, t, n) {
            var r = this, i = this.coord()._area().x(e).y0(t).y1(n).defined(this._defined);
            return i.renderer.tension(this.tension()).interpolate(this.interpolate()), {bounds: function(e, t) {
                    var n = i.getBounds(e, t);
                    return n && (n.coord = r.coord()), n
                },pathTween: function(e, t) {
                    return r.pathTween(i, this, e, t)
                },path: function(e, t) {
                    return i.getPath(i.getBounds(e, t))
                }}
        }, e.baseline = function(e) {
            return arguments.length ? (this._baseline = e, this) : this._baseline
        }, e
    }), dv.geom.rect = dv.geom.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.rect
        }
        return e._dataPointStyleClass = "bar-geom", e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.yMin = 1, this._defaultAes.yMax = 1, this._defaultAes.xMin = 1, this._defaultAes.xMax = 1, delete this._defaultAes.x, delete this._defaultAes.y
        }, e._trainScales = function() {
            var e = this.getExplicitScales(["yMin", "xMin"]), t = e.yMin, n = e.xMin, r;
            for (r in t) {
                var i = this._aes.y;
                i || (this._aes.y = i = {}), i[r] || (i[r] = t[r].copy().property("y").mapping("y")), i[r].trainingProperties(["yMin", "yMax"])
            }
            for (r in n) {
                var s = this._aes.x;
                s || (this._aes.x = s = {}), s[r] || (s[r] = n[r].copy().property("x").mapping("x")), s[r].trainingProperties(["xMin", "xMax"])
            }
        }, e.getValues = function(e) {
            return e.values
        }, e._render = function(e) {
            var t = this.getExplicitScales(["yMin", "yMax", "y", "xMin", "xMax", "x"]), n;
            for (n in t.yMin) {
                var r = t.yMin[n], i = t.yMax[n], s = t.y[n];
                s && (i.range(s.range()).domain(s.domain()), r.range(s.range()).domain(s.domain()))
            }
            for (n in t.xMin) {
                var o = t.xMin[n], u = t.xMax[n], a = t.x[n];
                a && (u.range(a.range()).domain(a.domain()), o.range(a.range()).domain(a.domain()))
            }
            this._super(e)
        }, e.pathTween = function(e, t, n, r, i) {
            var s = n, o, u = t.__previousBounds__, a = this.coord()._type;
            t.__exiting__ ? o = t.__exitTransition__.bounds(n, r) : o = e.getBounds(n, r), u && u.coord && a !== u.coord && (u = t.__exitTransition__.bounds(n, r));
            if (!o || !u)
                return null;
            o.coord = a;
            var f = d3.interpolateObject(u.bounds, o.bounds);
            return t.__previousBounds__ = o, function(t) {
                return s.bounds = f(t), e.getPath(s)
            }
        }, e.attributes = function(e, t) {
            e.attr("style", "").classed(t._dataPointStyleClass, !0).call(t.applyAttributeValue, t, "fill", "fill").call(t.applyAttributeValue, t, "stroke", "stroke").call(t.applyAttributeValue, t, "opacity", "alpha")
        }, e.enterPen = function() {
            var e = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            }, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapValue(dv.util.isArray(e.x) ? e.x[0] : e.xMin, t))
            }, n = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapValue(dv.util.isArray(e.x) ? e.x[1] : e.xMax, t))
            };
            return this._decoratePen(t, n, e, e)
        }, e.pen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapValue(dv.util.isArray(e.x) ? e.x[0] : e.xMin, t))
            }, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapValue(dv.util.isArray(e.x) ? e.x[1] : e.xMax, t))
            }, n = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(dv.util.isArray(e.y) ? e.y[0] : e.yMin, t))
            }, r = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(dv.util.isArray(e.y) ? e.y[1] : e.yMax, t))
            };
            return this._decoratePen(e, t, n, r)
        }, e._defined = function(e, t) {
            var n = e.panel.xScale(e), r = e.panel.yScale(e);
            return dv.util.isFinite(n.mapValue(dv.util.isArray(e.x) ? e.x[0] : e.xMin, t)) && dv.util.isFinite(n.mapValue(dv.util.isArray(e.x) ? e.x[1] : e.xMax, t)) && dv.util.isFinite(r.mapValue(dv.util.isArray(e.y) ? e.y[0] : e.yMin, t)) && dv.util.isFinite(r.mapValue(dv.util.isArray(e.y) ? e.y[1] : e.yMax, t))
        }, e._decoratePen = function(e, t, n, r) {
            var i = this, s = this.coord()._rect().x0(e).x1(t).y0(n).y1(r).defined(this._defined);
            return {bounds: function(e, t) {
                    var n = s.getBounds(e, t);
                    return n && (n.bounds.coord = i.coord()._type), n
                },pathTween: function(e, t, n) {
                    return i.pathTween(s, this, e, t, n)
                },path: function(e, t) {
                    return s.getPath(s.getBounds(e, t))
                }}
        }, e
    }), dv.geom.tile = dv.geom.rect.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.tile
        }
        return e._dataPointStyleClass = "tile-geom", e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.y = 1, this._defaultAes.x = 1
        }, e.getValues = function(e) {
            return e.values
        }, e.enterPen = function() {
            var e = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            }, t = function(e, t) {
                return e.panel.xScale(e).mapPropToPercent(e, t)
            }, n = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
            };
            return this._decoratePen(t, n, e, e)
        }, e.pen = function() {
            var e = function(e, t) {
                return e.panel.xScale(e).mapPropToPercent(e, t)
            }, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
            }, n = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapPropToPercent(e, t)
            }, r = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
            };
            return this._decoratePen(e, t, n, r)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.xScale(e).mapToProp(e, t)) && dv.util.isFinite(e.panel.yScale(e).mapToProp(e, t))
        }, e._decoratePen = function(e, t, n, r) {
            var i = this, s = this.coord()._rect().x0(e).x1(t).y0(n).y1(r).defined(this._defined);
            return {bounds: function(e, t) {
                    var n = s.getBounds(e, t);
                    return n && (n.bounds.coord = i.coord()._type), n
                },pathTween: function(e, t, n) {
                    return i.pathTween(s, this, e, t, n)
                },path: function(e, t) {
                    return s.getPath(s.getBounds(e, t))
                }}
        }, e
    }), dv.geom.bar = dv.geom.rect.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.bar, this._baseline = 0
        }
        return e._dataPointStyleClass = "bar-geom", e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.y = 1, this._defaultAes.x = 1
        }, e._trainScales = function() {
            if (this._baseline !== undefined) {
                var e = this.getExplicitScales("y").y;
                for (var t in e) {
                    var n = e[t];
                    n instanceof dv.scale.continuous && n.softLowerLimit(this._baseline)
                }
            }
        }, e.getValues = function(e) {
            return e.values
        }, e.getBaseline = function(e) {
            var t = e.domain()[0];
            return self._baseline !== undefined ? self._baseline : t < 0 ? 0 : t
        }, e.enterPen = function() {
            var e = this, t = function(t, n) {
                var r = t.panel.yScale(t);
                return r.mapValueToPercent(r.mapValue(e.getBaseline(r)), n)
            }, n, r;
            return this.position() === "dodge" ? (n = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._dodgeAdjust(t), n)
            }, r = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._dodgeAdjust(t, !0), n)
            }) : (n = function(e, t) {
                return e.panel.xScale(e).mapPropToPercent(e, t)
            }, r = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
            }), this._decoratePen(n, r, t, t)
        }, e.pen = function() {
            var e, t, n, r, i = this;
            switch (this.position()) {
                case "identity":
                    e = function(e, t) {
                        return e.panel.xScale(e).mapPropToPercent(e, t)
                    }, t = function(e, t) {
                        var n = e.panel.xScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(i.getBaseline(n)), t)
                    }, r = function(e, t) {
                        return e.panel.yScale(e).mapPropToPercent(e, t)
                    };
                    break;
                case "stack":
                    e = function(e, t) {
                        return e.panel.xScale(e).mapPropToPercent(e, t)
                    }, t = function(e, t) {
                        var n = e.panel.xScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(e.y0), t)
                    }, r = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(e.y0 + e.y), t)
                    };
                    break;
                case "dodge":
                    e = function(e, t) {
                        var n = e.panel.xScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + i._dodgeAdjust(e), t)
                    }, t = function(e, t) {
                        var n = e.panel.xScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + i._dodgeAdjust(e, !0), t)
                    }, n = function(e, t) {
                        var n = e.panel.yScale(e);
                        return n.mapValueToPercent(n.mapValue(i.getBaseline(n)), t)
                    }, r = function(e, t) {
                        return e.panel.yScale(e).mapPropToPercent(e, t)
                    };
                    break;
                case "fill":
                    e = function(e, t) {
                        return e.panel.xScale(e).mapPropToPercent(e, t)
                    }, t = function(e, t) {
                        var n = e.panel.xScale(e);
                        return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
                    }, n = function(e, t) {
                        return e.y0
                    }, r = function(e, t) {
                        return e.y + e.y0
                    }
            }
            return this._decoratePen(e, t, n, r)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.xScale(e).mapToProp(e, t)) && dv.util.isFinite(e.panel.yScale(e).mapToProp(e, t))
        }, e._decoratePen = function(e, t, n, r) {
            var i = this, s = this.coord()._rect().x0(e).x1(t).y0(n).y1(r).defined(this._defined);
            return {bounds: function(e, t) {
                    var n = s.getBounds(e, t);
                    return n && (n.bounds.coord = i.coord()._type), n
                },pathTween: function(e, t, n) {
                    return i.pathTween(s, this, e, t, n)
                },path: function(e, t) {
                    return s.getPath(s.getBounds(e, t))
                }}
        }, e._dodgeAdjust = function(e, t) {
            var n = e.dodge.groupIndex, r = e.dodge.numGroups, i = e.panel.xScale(e).rangeBand(), s = r > 1 ? i / (r - 1) * this._dodgePadding : 0, o = (i - s * (r - 1)) / r;
            return (o + s) * n + (t ? o : 0)
        }, e.baseline = function(e) {
            return arguments.length ? (this._baseline = e, this) : this._baseline
        }, e
    }), dv.geom.barrange = dv.geom.bar.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.barrange
        }
        return e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.yMin = 1, this._defaultAes.yMax = 1, delete this._defaultAes.y
        }, e._trainScales = function() {
            var e = this.getExplicitScales("yMin").yMin, t, n;
            for (var r in e)
                this._aes.y || (this._aes.y = {}), t = this._aes.y, n = t[r], n || (t[r] = n = e[r].copy().property("y").mapping("y")), n.trainingProperties(["yMin", "yMax"])
        }, e._render = function(e) {
            var t = this.getExplicitScales(["yMin", "yMax", "y"]), n = t.yMin;
            for (var r in n) {
                var i = n[r], s = t.yMax[r], o = t.y[r];
                s.range(o.range()).domain(o.domain()), i.range(o.range()).domain(o.domain())
            }
            this._super(e)
        }, e.enterPen = function() {
            var e = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            }, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapPropToPercent(e, t)
            }, n = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
            };
            return this._decoratePen(t, n, e, e)
        }, e.pen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapPropToPercent(e, t)
            }, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand(), t)
            }, n = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(e.yMin, t), t)
            }, r = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(e.yMax, t), t)
            };
            return this._decoratePen(e, t, n, r)
        }, e._defined = function(e, t) {
            var n = e.panel.xScale(e), r = e.panel.yScale(e);
            return dv.util.isFinite(n.mapToProp(e, t)) && dv.util.isFinite(r.mapValue(e.yMin, t)) && dv.util.isFinite(r.mapValue(e.yMax, t))
        }, e._decoratePen = function(e, t, n, r) {
            var i = this, s = this.coord()._rect().x0(e).x1(t).y0(n).y1(r).defined(this._defined);
            return {bounds: function(e, t) {
                    var n = s.getBounds(e, t);
                    return n && (n.bounds.coord = i.coord()._type), n
                },pathTween: function(e, t, n) {
                    return i.pathTween(s, this, e, t, n)
                },path: function(e, t) {
                    return s.getPath(s.getBounds(e, t))
                }}
        }, e
    }), dv.geom.segment = dv.geom.line.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.segment
        }
        return e.getValues = function(e) {
            return e.values
        }, e.enterPen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, t = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            };
            return this._decoratePen(e, t)
        }, e.pen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, t = function(e, t) {
                return e.panel.yScale(e).mapPropToPercent(e, t)
            };
            return this._decoratePen(e, t)
        }, e
    }), dv.geom.vline = dv.geom.segment.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.vline
        }
        return e._dataPointStyleClass = "vline-geom", e._render = function(e) {
            var t = this;
            dv.util.each(this._nestData, function(e, n) {
                var r = [];
                dv.util.each(e.values, function(e, t) {
                    var n = e.panel.xScale(e), i = e.panel.yScale(e), s = i.domain(), o = e[n.property()];
                    if (dv.util.isArray(e))
                        e[0].x = o, e[1].x = o;
                    else {
                        var u = [];
                        e.x = o, u.push(e), u.push(dv.util.clone(e)), r.push(u)
                    }
                }), t._nestData[n].values = r
            }), this._super(e)
        }, e.enterPen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, t = function(e, t) {
                return 0
            };
            return this._decoratePen(e, t)
        }, e.pen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, t = function(e, t) {
                return t === 0 ? 0 : 1
            };
            return this._decoratePen(e, t)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.xScale(e).mapToProp(e, t))
        }, e
    }), dv.geom.hline = dv.geom.segment.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.hline
        }
        return e._dataPointStyleClass = "hline-geom", e._render = function(e) {
            var t = this;
            dv.util.each(this._nestData, function(e, n) {
                var r = [];
                dv.util.each(e.values, function(e, t) {
                    var n = e.panel.xScale(e), i = e.panel.yScale(e), s = n.domain(), o = e[i.property()];
                    if (dv.util.isArray(e))
                        e[0].y = o, e[1].y = o;
                    else {
                        var u = [];
                        e.y = o, u.push(e), u.push(dv.util.clone(e)), r.push(u)
                    }
                }), t._nestData[n].values = r
            }), this._super(e)
        }, e.enterPen = function() {
            var e = function(e, t) {
                return t === 0 ? 0 : 1
            }, t = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            };
            return this._decoratePen(e, t)
        }, e.pen = function() {
            var e = function(e, t) {
                return t === 0 ? 0 : 1
            }, t = function(e, t) {
                return e.panel.yScale(e).mapPropToPercent(e, t)
            };
            return this._decoratePen(e, t)
        }, e._defined = function(e, t) {
            return dv.util.isFinite(e.panel.yScale(e).mapToProp(e, t))
        }, e
    }), dv.geom.ribbon = dv.geom.area.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.ribbon
        }
        return e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.yMin = 1, this._defaultAes.yMax = 1, delete this._defaultAes.y
        }, e._trainScales = function() {
            var e = this.getExplicitScales("yMin").yMin, t, n;
            for (var r in e)
                this._aes.y || (this._aes.y = {}), t = this._aes.y, n = t[r], n || (t[r] = n = e[r].copy().property("y").mapping("y")), n.trainingProperties(["yMin", "yMax"])
        }, e._render = function(e) {
            var t = this.getExplicitScales(["yMin", "yMax", "y"]), n = t.yMin;
            for (var r in n) {
                var i = n[r], s = t.yMax[r], o = t.y[r];
                s.range(o.range()).domain(o.domain()), i.range(o.range()).domain(o.domain())
            }
            this._super(e)
        }, e.enterPen = function() {
            var e = this, t = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, n = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            };
            return this._decoratePen(t, n, n)
        }, e.pen = function() {
            var e = function(e, t) {
                var n = e.panel.xScale(e);
                return n.mapValueToPercent(n.mapToProp(e, t) + n.rangeBand() / 2, t)
            }, t = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(e.yMin, t))
            }, n = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(e.yMax, t))
            };
            return this._decoratePen(e, t, n)
        }, e._defined = function(e, t) {
            var n = e.panel.xScale(e), r = e.panel.yScale(e);
            return dv.util.isFinite(n.mapToProp(e, t)) && dv.util.isFinite(r.mapValue(e.yMin, t)) && dv.util.isFinite(r.mapValue(e.yMax, t))
        }, e._decoratePen = function(e, t, n) {
            var r = this, i = this.coord()._area().x(e).y0(t).y1(n).defined(this._defined);
            return i.renderer.tension(this.tension()).interpolate(this.interpolate()), {bounds: function(e, t) {
                    var n = i.getBounds(e, t);
                    return n && (n.coord = r.coord()), n
                },pathTween: function(e, t) {
                    return r.pathTween(i, this, e, t)
                },path: function(e, t) {
                    return i.getPath(i.getBounds(e, t))
                }}
        }, e
    }), dv.geom.errorbar = dv.geom.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.errorbar, this._width = 1
        }
        return e._dataPointStyleClass = "errorbar-geom", e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.yMin = 1, this._defaultAes.yMax = 1, delete this._defaultAes.y
        }, e._trainScales = function() {
            var e = this.getExplicitScales("yMin").yMin, t;
            for (var n in e)
                this._aes.y || (this._aes.y = {}), yScales = this._aes.y, t = yScales[n], t || (yScales[n] = t = e[n].copy().property("y").mapping("y")), t.trainingProperties(["yMin", "yMax"])
        }, e.getValues = function(e) {
            return e.values
        }, e.width = function(e) {
            return arguments.length ? (this._width = e, this) : this._width
        }, e.attributes = function(e, t) {
            var n = t.getScale("linetype");
            e.attr("style", "").classed(t._dataPointStyleClass, !0).call(t.applyAttributeValue, t, "stroke", "stroke").call(t.applyAttributeValue, t, "opacity", "alpha").call(t.applyAttributeValue, t, "stroke-width", "size").style("stroke-dasharray", function(e, t, r) {
                return n ? dv.util.svg.getDasharray(n.mapToProp(e[0], t, r)) : null
            }).style("fill", "none")
        }, e._render = function(e) {
            var t = this.getScale("x");
            if (!(t instanceof dv.scale.ordinal)) {
                var n = Number.MAX_VALUE, r, i;
                dv.util.each(this._nestData, function(e) {
                    dv.util.each(e.values, function(e) {
                        r = e.panel.xScale(e).mapValue(e.x), dv.util.isUndefined(i) || (n = Math.min(n, Math.abs(r - i))), i = r
                    })
                }), this._maxWidthPixels = n
            }
            var s = this.getExplicitScales(["yMin", "yMax", "y"]), o = s.yMin;
            for (var u in o) {
                var a = o[u], f = s.yMax[u];
                yScale = s.y[u], f.range(yScale.range()).domain(yScale.domain()), a.range(yScale.range()).domain(yScale.domain())
            }
            this._super(e)
        }, e.enterPen = function() {
            var e = this, t = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._offsetX(t), n)
            }, n = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._offsetX(t, !0), n)
            }, r = function(e, t) {
                return e.panel.yScale(e).reverse() ? 1 : 0
            };
            return this._decoratePen(t, n, r, r)
        }, e.pen = function() {
            var e = this, t = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._offsetX(t), n)
            }, n = function(t, n) {
                var r = t.panel.xScale(t);
                return r.mapValueToPercent(r.mapToProp(t, n) + e._offsetX(t, !0), n)
            }, r = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(e.yMin, t))
            }, i = function(e, t) {
                var n = e.panel.yScale(e);
                return n.mapValueToPercent(n.mapValue(e.yMax, t))
            };
            return this._decoratePen(t, n, r, i)
        }, e._isOrdinal = function(e) {
            return e.panel.xScale(e) instanceof dv.scale.ordinal
        }, e._offsetX = function(e, t) {
            var n = e.panel.xScale(e), r;
            return n instanceof dv.scale.ordinal ? r = n.rangeBand() / 2 + n.rangeBand() / 2 * (t ? this._width : -this._width) : r = this._maxWidthPixels * (t ? this._width / 2 : -this._width / 2), r
        }, e._defined = function(e, t) {
            var n = e.panel.xScale(e), r = e.panel.yScale(e);
            return dv.util.isFinite(n.mapToProp(e, t)) && dv.util.isFinite(r.mapValue(e.yMin, t)) && dv.util.isFinite(r.mapValue(e.yMax, t))
        }, e._decoratePen = function(e, t, n, r) {
            var i = this, s = this.coord()._errorBar().x0(e).x1(t).y0(n).y1(r).defined(this._defined);
            return {bounds: function(e, t) {
                    return s.getBounds(e, t)
                },pathTween: function(e, t) {
                    return i.pathTween(s, this, e, t)
                },path: function(e, t) {
                    return s.getPath(s.getBounds(e, t))
                }}
        }, e
    }), dv.geom.poly = dv.geom.extend(function() {
        function e() {
            this._super(), this._rendererClass = dv.geom.poly
        }
        return e._dataPointStyleClass = "poly-geom", e._initializeDefaultAes = function() {
            this._super(), this._defaultAes.size = 1, delete this._defaultAes.shape, delete this._defaultAes.x, delete this._defaultAes.y
        }, e._trainScales = function() {
            var e = this.getExplicitScales(["yMin", "xMin"]), t;
            for (t in e.yMin) {
                var n = this._aes.y;
                n || (this._aes.y = n = {}), n[t] || (n[t] = yMinScale.copy().property("y").mapping("y")), n[t].trainingProperties(["yMin", "yMax"])
            }
            for (t in e.xMin) {
                var r = this._aes.x;
                r || (this._aes.x = r = {}), r[t] || (r[t] = xMinScale.copy().property("x").mapping("x")), r[t].trainingProperties(["xMin", "xMax"])
            }
        }, e.getValues = function(e) {
            return e.values
        }, e.attributes = function(e, t) {
            var n = t.getScale("fill"), r = t.getScale("stroke"), i = t.getScale("alpha");
            e.attr("style", "").classed(t._dataPointStyleClass, !0).call(t.applyAttributeValue, t, "stroke", "stroke").call(t.applyAttributeValue, t, "fill", "fill").call(t.applyAttributeValue, t, "opacity", "alpha")
        }, e.exitSeriesGroup = function(e, t) {
            t.exitSeries(e, t.enterPen, t)
        }, e.getHighlightColor = function(e, t) {
            var n = this.getScale("fill"), r = this.getScale("stroke");
            return r instanceof dv.scale.constant ? n instanceof dv.scale.constant ? r.mapToProp(e, t) : n.mapToProp(e, t) : r.mapToProp(e, t)
        }, e.enterPen = function() {
            var e = function(e, t) {
                return e.panel.xScale(e).mapPropToPercent(e, t)
            }, t = function(e, t) {
                var n = e.panel.yScale(e);
                return dv.util.map(e[n.property()], function() {
                    return n.reverse() ? 1 : 0
                })
            };
            return this._decoratePen(e, t)
        }, e.pen = function() {
            var e = function(e, t) {
                return e.panel.xScale(e).mapPropToPercent(e, t)
            }, t = function(e, t) {
                return e.panel.yScale(e).mapPropToPercent(e, t)
            };
            return this._decoratePen(e, t)
        }, e._defined = function(e, t) {
            var n = e.panel.xScale(e).mapToProp(e, t), r = e.panel.yScale(e).mapToProp(e, t), i = d3.max([n.length, r.length]), s = !0;
            for (var o = 0; o < i && s; o++)
                s = dv.util.isFinite(n[o]) && dv.util.isFinite(r[o]);
            return s
        }, e._decoratePen = function(e, t) {
            var n = this, r = this.coord()._poly().xs(e).ys(t).defined(this._defined);
            return {bounds: function(e, t) {
                    return r.getBounds(e, t)
                },pathTween: function(e, t, i) {
                    return n.pathTween(r, this, e, t, i)
                },path: function(e, t) {
                    return r.getPath(r.getBounds(e, t))
                }}
        }, e
    }), dv.behavior = dv.extend(function() {
        function e() {
        }
        var t;
        return e._testAndroidChromeBug141840 = function() {
            if (t === undefined) {
                var e = navigator.userAgent;
                t = /Android .* Chrome\/18+/.exec(e) !== null || /Silk\/2./.exec(e) !== null
            }
            return t
        }, e
    }), dv.behavior.inspector = dv.behavior.extend(function() {
        function e() {
            this._size = undefined, this._lastX = NaN, this._visible = !1, this._inspector = null, this._thickness = 3, this._orientation = "bottom", this._currentValue = null, this._gutterPadding = -7, this._calloutPadding = {left: 8,top: 7,right: 8,bottom: 7}, this._label = this._defaultLabel(), this._underGeoms = !1, this._dragInspect = !0, this._pressTimer = null
        }
        function t() {
            var e = [], t = this._chart.getTrainedScale("x"), n, r = !1, i = function(e, n) {
                return e = t._parse(e), n = t._parse(n), r && e && n ? e.getTime() === n.getTime() : e === n
            }, s = function(e) {
                return t.mapValue(e)
            }, o = this._chart.data(), u = -1, a = this._chart._layers.length;
            o.length && e.concat(o[t.property()]);
            while (++u < a) {
                var f = this._chart._layers[u], l = f.getTrainedScale("x"), c = f.data()[l.property()];
                c && c !== o && (e = e.concat(c)), r = r || l instanceof dv.scale.time || l instanceof dv.scale.time.utc
            }
            return e.length ? dv.util.sortBy(dv.util.uniqueValues(e, i), s) : e
        }
        function n() {
            this._chart.on("mousemove.inspector", dv.util.bind(o, this)), this._chart.on("mouseout.inspector", dv.util.bind(u, this)), this._chart.on("touchstart.inspector", dv.util.bind(i, this)), this._chart.on("touchmove.inspector", dv.util.bind(o, this)), this._chart.on("touchend.inspector", dv.util.bind(s, this))
        }
        function r(e, t, n) {
            var r = 0, i = 0;
            if (this._lastX === n)
                return;
            this._inspector.attr("opacity", 1), this._inspector.select(".inspector-tip-label").text(t).each(function() {
                var e = this.getBBox();
                r = Math.max(e.width, r), i = Math.max(e.height, i)
            });
            var s = this._chart.facet().getPanel(0).bounds(), o;
            r += this._calloutPadding.left + this._calloutPadding.right, i += this._calloutPadding.top + this._calloutPadding.bottom, o = n - r / 2, o < s.left + this._gutterPadding && (o = s.left + this._gutterPadding), o + r > s.right - this._gutterPadding && (o = s.right - this._gutterPadding - r), this._inspector.select(".inspector-marker").attr("transform", "translate(" + o + ",0)"), this._inspector.select(".inspector-tip-background").attr("width", r).attr("height", i);
            var u = n - o;
            this._inspector.select(".inspector-line-container").attr("transform", "translate(" + u + ",0)")
        }
        function i(e) {
            if (!e)
                return;
            var t = this;
            return this._dragInspect = !1, clearTimeout(this._pressTimer), this._pressTimer = setTimeout(function() {
                t._dragInspect = !0, o.call(t, e)
            }, 500), !1
        }
        function s(e) {
            clearTimeout(this._pressTimer), this._dragInspect && (this._dragInspect = !1), u.call(this, e)
        }
        function o(e) {
            if (!e)
                return;
            if (!this._dragInspect) {
                clearTimeout(this._pressTimer);
                return
            }
            var t = e.touches ? e.touches[0] : e, n = this._chart.getTrainedScale("x"), i = this._testAndroidChromeBug141840() ? t.screenX : t.clientX, s = i - t.target.getBoundingClientRect().left + t.target.getBBox().x, o = dv.util.binaryCompare(this._domain, s, function(e) {
                return n.mapValue(e)
            }), u = Math.min(Math.max(o || 0, 0), this._domain.length - 1), a = this._domain[u], f = this._label.call(this, a, u), l = n.mapValue(a);
            this._currentValue != a && (this._inspectorMove && this._inspectorMove.call(this, f, u, l, a), r.call(this, a, f, l)), this._currentValue = a, dv.cancelEvent(e)
        }
        function u(e) {
            this._inspector.attr("opacity", 1e-6), this._inspectorOut && this._inspectorOut.call(this), this._currentValue = null, dv.cancelEvent(e)
        }
        return e._render = function(e) {
            this._domain = t.call(this);
            var n = 0, r = this._chart.facet().getPanel(0)._bounds;
            this._size === undefined && (this._size = r.bottom - r.top), this._xGuide = dv.util.clone(this._chart._axes._get("x")[0]), this._selection = e, this._inspector = e.selectAll(".inspector").data([0]), this._inspector.call(this._createInspector, this._orientation, r, this._calloutPadding, this._thickness)
        }, e._createInspector = function(e, t, n, r, i) {
            var s = e, o = e.enter();
            o = o.append("g").classed("inspector", !0), s.style("pointer-events", "none").attr("opacity", 1e-6).attr("transform", "translate(0," + n.top + ")");
            var u = o.append("g").classed("inspector-marker", !0), a = u.append("g").classed("inspector-line-container", !0);
            a.append("path").classed("inspector-callout", !0), s.select(".inspector-callout").attr("d", function() {
                var e = -3, r = e + 5;
                return t === "bottom" && (e = n.bottom - n.top + 2, r = e - 5), "M-5," + e + "L5," + e + "L0," + r + "Z"
            }), a.append("line").classed("inspector-line", !0), s.select(".inspector-line").attr("y1", t === "bottom" ? 0 : 4).attr("y2", t === "bottom" ? n.bottom - n.top - 6 : n.bottom - n.top).style("stroke-width", i);
            var f = u.append("g").classed("inspector-tip", !0);
            s.select(".inspector-tip").attr("transform", "translate(0," + (t === "bottom" ? n.bottom - n.top + 2 : -30) + ")"), f.append("rect").classed("inspector-tip-background", !0), f.append("text").classed("inspector-tip-label", !0), s.select(".inspector-tip-label").attr("x", r.left).attr("y", "1em").attr("dy", r.top)
        }, e.moveToIndex = function(e) {
            var t = this._chart.getTrainedScale("x"), n = this._domain[e], i = this._label.call(this, n, e), s = t.mapValue(n);
            r.call(this, n, i, s)
        }, e.hide = function() {
            return this._inspector.attr("opacity", 1e-6), this._visible = !1, this
        }, e.show = function() {
            return this._inspector.attr("opacity", 1), this._visible = !0, this
        }, e._removeEvents = function() {
            this._chart.on("mousemove.inspector", null), this._chart.on("mouseout.inspector", null), this._chart.on("touchstart.inspector", null), this._chart.on("touchmove.inspector", null), this._chart.on("touchend.inspector", null)
        }, e.inspectorMove = function(e) {
            return arguments.length ? (this._inspectorMove = e, this) : this._inspectorMove
        }, e.inspectorOut = function(e) {
            return arguments.length ? (this._inspectorOut = e, this) : this._inspectorOut
        }, e.label = function(e) {
            return arguments.length ? (this._label = d3.functor(e), this) : this._label
        }, e.thickness = function(e) {
            return arguments.length ? (this._thickness = e, this) : this._thickness
        }, e.size = function(e) {
            return arguments.length ? (this._size = e, this) : this._size
        }, e.chart = function(e) {
            return arguments.length ? (this._chart && this._removeEvents(), this._chart = e, this._chart && n.call(this), this) : this._chart
        }, e.orientation = function(e) {
            return arguments.length ? (this._orientation = e, this) : this._orientation
        }, e._defaultLabel = function() {
            var e = this;
            return function(t) {
                var n = e._xGuide.tickFormat ? e._xGuide.tickFormat() : function(e) {
                    return e
                };
                return n(t)
            }
        }, e.label = function(e) {
            return arguments.length ? (this._label = d3.functor(e), this) : this._label
        }, e.underGeoms = function(e) {
            return arguments.length ? (this._underGeoms = e, this) : this._underGeoms
        }, e.gutterPadding = function(e) {
            return arguments.length ? (this._gutterPadding = e, this) : this._gutterPadding
        }, e
    }), dv.behavior.brush = dv.behavior.extend(function() {
        function e(e) {
            arguments.length && !dv.util.isArray(e) && (this._dimensions = [this._dimensions]), this._fluidDimensions = e || ["x", "y"], this._snap = !1, this._resizing = !1
        }
        return e.initializeBrush = function(e) {
            var t = this;
            this._brush = dv.brush(e).on("brushstart.brush", function() {
                t._onBrushStart.call(t), t._brushStart && t._brushStart.call(this, "start", t._brush.extent(), t)
            }).on("brush.brush", function(e) {
                t._onBrushMove.call(t), t._brushMove && t._brushMove.call(this, "move", t._brush.extent(), t)
            }).on("brushend.brush", function() {
                t._onBrushEnd.call(t), t._brushEnd && t._brushEnd.call(this, "end", t._brush.extent(), t)
            })
        }, e._removeEvents = function() {
            this._brush.on("brushstart.brush", null).on("brush.brush", null).on("brushend.brush", null)
        }, e._onBrushStart = function() {
            if (!this.snap() || this._fluidDimensions.length > 1)
                return;
            this._startPos = d3.mouse(this._brushContainer.node()), this._moving = d3.select(d3.event.sourceEvent.target).classed("extent")
        }, e._onBrushMove = function() {
            if (!this.snap() || this._fluidDimensions.length > 1)
                return;
            var e = d3.mouse(this._brushContainer.node());
            (this._startPos[0] !== e[0] || this._startPos[1] !== e[1]) && this._snapToDataPoints()
        }, e._onBrushEnd = function() {
            if (!this.snap() || this._fluidDimensions.length > 1)
                return;
            var e = d3.mouse(this._brushContainer.node());
            !this._moving && this._startPos[0] === e[0] && this._startPos[1] === e[1] ? this.clear() : this._brushContainer.selectAll(".resize").style("display", null)
        }, e._snapToDataPoints = function() {
            var e = this._brush.extent(), t = [], n = this._chart.getTrainedScale(this._fluidDimensions[0]), r = [this._snapToNearestPoint(n, e[0], 0), this._snapToNearestPoint(n, e[1], 1)];
            this._brush.extent([r[0].value, r[1].value]);
            var i = this._chart.plotBounds();
            this._fluidDimensions === "x" ? (t[0] = [r[0].rangeValue, 0], t[1] = [r[1].rangeValue, i.bottom - i.top]) : (t[0] = [0, r[0].rangeValue], t[1] = [i.right - i.left, r[1].rangeValue]), this._adjustBounds(this._brushContainer, t)
        }, e._snapToNearestPoint = function(e, t, n) {
            var r = {}, i;
            if (e instanceof dv.scale.ordinal || e instanceof dv.scale.identity) {
                var s = dv.util.scaleRangeNoReverse(e), o = s[1] - s[0];
                domain = e.domain(), i = Math.round(e.invertValue(t) / o - 1)
            } else
                domain = dv.util.uniq(this._chart.data()[e.mapping()]), index = dv.util.binaryCompare(domain, t, function(e) {
                    return e
                }), i = Math.min(Math.max(index || 0, 0), domain.length - 1);
            var u = domain[i];
            r.value = u;
            if (n === 0)
                if (i === 0)
                    r.rangeValue = e.mapValue(u);
                else {
                    var a = domain[i - 1], f = e.mapValue(a);
                    valueRange = e.mapValue(u), r.rangeValue = valueRange - (valueRange - f) / 2
                }
            else if (i === domain.length - 1)
                r.rangeValue = e.mapValue(u);
            else {
                var l = domain[i + 1], c = e.mapValue(l);
                valueRange = e.mapValue(u), r.rangeValue = valueRange + (c - valueRange) / 2
            }
            return r
        }, e._adjustBounds = function(e, t) {
            this._fluidDimensions === "x" && this._adjustBoundsX(e, t), this._fluidDimensions === "y" && this._adjustBoundsY(e, t), e.selectAll(".resize").attr("transform", function(e) {
                return "translate(" + t[+/e$/.test(e)][0] + "," + t[+/^s/.test(e)][1] + ")"
            })
        }, e._adjustBoundsX = function(e, t) {
            e.select(".extent").attr("x", t[0][0]), e.selectAll(".extent,.n>rect,.s>rect").attr("width", t[1][0] - t[0][0])
        }, e._adjustBoundsY = function(e, t) {
            e.select(".extent").attr("y", t[0][1]), e.selectAll(".extent,.e>rect,.w>rect").attr("height", t[1][1] - t[0][1])
        }, e._setScales = function() {
            if (this._fluidDimensions.indexOf("x") >= 0) {
                var e = this._chart.getTrainedScale("x");
                this._brush.x(e._d3Scale)
            }
            if (this._fluidDimensions.indexOf("y") >= 0) {
                var t = this._chart.getTrainedScale("y");
                this._brush.y(t._d3Scale)
            }
        }, e._render = function() {
            this._brushContainer = this._chart._parent.select(".interaction-group"), this._brush.empty() && this._brushContainer.classed("brush", !0).call(this._brush);
            var e = this._chart.plotBounds();
            if (!this._brush.y()) {
                var t = e.bottom - e.top;
                this._brushContainer.selectAll(".extent").attr("height", t).attr("y", 0), this._brushContainer.selectAll(".resize rect").attr("height", t).attr("y", 0)
            }
            if (!this._brush.x()) {
                var n = e.right - e.left;
                this._brushContainer.selectAll(".extent").attr("width", n).attr("x", 0), this._brushContainer.selectAll(".resize rect").attr("width", n).attr("x", 0)
            }
        }, e.empty = function() {
            return this._brush.empty()
        }, e.clear = function() {
            this._brushContainer.call(this._brush.clear())
        }, e.extent = function(e) {
            return arguments.length ? (this._brushContainer.call(this._brush.extent(e)), this) : this._brush ? this._brush.extent() : null
        }, e.snap = function(e) {
            return arguments.length ? (this._snap = this._fluidDimensions.length > 1 ? !1 : e, this) : this._snap
        }, e.brushStart = function(e) {
            return arguments.length ? (this._brushStart = e, this) : this._brushStart
        }, e.brushMove = function(e) {
            return arguments.length ? (this._brushMove = e, this) : this._brushMove
        }, e.brushEnd = function(e) {
            return arguments.length ? (this._brushEnd = e, this) : this._brushEnd
        }, e.chart = function(e) {
            return arguments.length ? (this._chart = e, this.initializeBrush(this._chart), this._chart && this._setScales(), this) : this._chart
        }, e
    }), dv.brush = function(e) {
        function u(t) {
            t.each(function() {
                var t = d3.select(this), s = t.selectAll(".background").data([0]), o = t.selectAll(".extent").data([0]), h = t.selectAll(".resize").data(i, String), p;
                e.on("mousedown.brush", c).on("touchstart.brush", c)._g.style("cursor", "crosshair"), t.style("pointer-events", "all"), o.enter().append("rect").attr("class", "extent").style("cursor", "move"), h.enter().append("g").attr("class", function(e) {
                    return "resize " + e
                }).style("cursor", function(e) {
                    return $[e]
                }).append("rect").attr("x", function(e) {
                    return /[e]$/.test(e) ? -10 : /[w]$/.test(e) ? 2 : null
                }).attr("y", function(e) {
                    return /^[ns]/.test(e) ? -3 : null
                }).attr("width", 10).attr("height", 6).style("visibility", "hidden"), h.style("display", u.empty() ? "none" : null), h.exit().remove(), n && (p = dv.util.scaleRangeNoReverse(n), s.attr("x", p[0]).attr("width", p[1] - p[0]), f(t)), r && (p = dv.util.scaleRangeNoReverse(r), s.attr("y", p[0]).attr("height", p[1] - p[0]), l(t)), a(t)
            })
        }
        function a(e) {
            e.selectAll(".resize").attr("transform", function(e) {
                return "translate(" + s[+/e$/.test(e)][0] + "," + s[+/^s/.test(e)][1] + ")"
            })
        }
        function f(e) {
            e.select(".extent").attr("x", s[0][0]), e.selectAll(".extent,.n>rect,.s>rect").attr("width", s[1][0] - s[0][0])
        }
        function l(e) {
            e.select(".extent").attr("y", s[0][1]), e.selectAll(".extent,.e>rect,.w>rect").attr("height", s[1][1] - s[0][1])
        }
        function c() {
            function N() {
                var t = d3.event.changedTouches;
                return t ? d3.touches(e, t)[0] : d3.mouse(e)
            }
            function C() {
                d3.event.keyCode == 32 && (m || (g = null, b[0] -= s[1][0], b[1] -= s[1][1], m = 2), Y())
            }
            function k() {
                d3.event.keyCode == 32 && m == 2 && (b[0] += s[1][0], b[1] += s[1][1], m = 0, Y())
            }
            function L() {
                var e = N(), t = !1;
                w && (e[0] += w[0], e[1] += w[1]), m || (d3.event.altKey ? (g || (g = [(s[0][0] + s[1][0]) / 2, (s[0][1] + s[1][1]) / 2]), b[0] = s[+(e[0] < g[0])][0], b[1] = s[+(e[1] < g[1])][1]) : g = null), d && A(e, n, 0) && (f(h), t = !0), v && A(e, r, 1) && (l(h), t = !0), t && (a(h), c({type: "brush",mode: m ? "move" : "resize"}))
            }
            function A(e, t, n) {
                var r = dv.util.scaleRangeNoReverse(t), i = r[0], u = r[1], a = b[n], f = s[1][n] - s[0][n], l, c;
                m && (i -= a, u -= f + a), l = Math.max(i, Math.min(u, e[n])), m ? c = (l += a) + f : (g && (a = Math.max(i, Math.min(u, 2 * g[n] - l))), a < l ? (c = l, l = a) : c = a);
                if (s[0][n] !== l || s[1][n] !== c)
                    return o = null, s[0][n] = l, s[1][n] = c, !0
            }
            function O() {
                L(), h.style("pointer-events", "all").selectAll(".resize").style("display", u.empty() ? "none" : null), d3.select("body").style("cursor", null), E.on("mousemove.brush", null).on("mouseup.brush", null).on("touchmove.brush", null).on("touchend.brush", null).on("keydown.brush", null).on("keyup.brush", null), c({type: "brushend"}), Y()
            }
            var e = this, i = d3.select(d3.event.target), c = t.of(e, arguments), h = d3.select(e), p = i.datum(), d = !/^(n|s)$/.test(p) && n, v = !/^(e|w)$/.test(p) && r, m = i.classed("extent"), g, b = N(), w, E = d3.select(window).on("mousemove.brush", L).on("mouseup.brush", O).on("touchmove.brush", L).on("touchend.brush", O).on("keydown.brush", C).on("keyup.brush", k);
            if (m)
                b[0] = s[0][0] - b[0], b[1] = s[0][1] - b[1];
            else if (!p || p !== "e" && p !== "w" && p !== "s" && p !== "n" && p !== "nw" && p !== "ne" && p !== "sw" && p !== "se")
                d3.event.altKey && (g = b.slice());
            else {
                var S = +/w$/.test(p), T = +/^n/.test(p);
                w = [s[1 - S][0] - b[0], s[1 - T][1] - b[1]], b[0] = s[S][0], b[1] = s[T][1]
            }
            h.style("pointer-events", "none").selectAll(".resize").style("display", null), d3.select("body").style("cursor", i.style("cursor")), c({type: "brushstart"}), L(), Y()
        }
        var t = G(u, "brushstart", "brush", "brushend"), n = null, r = null, i = J[0], s = [[0, 0], [0, 0]], o;
        return u.x = function(e) {
            return arguments.length ? (n = e, i = J[!n << 1 | !r], u) : n
        }, u.y = function(e) {
            return arguments.length ? (r = e, i = J[!n << 1 | !r], u) : r
        }, u.extent = function(e) {
            var t, i, a, f, l;
            return arguments.length ? (o = [[0, 0], [0, 0]], n && (t = e[0], i = e[1], r && (t = t[0], i = i[0]), o[0][0] = t, o[1][0] = i, n.invert && (t = n(t), i = n(i)), i < t && (l = t, t = i, i = l), s[0][0] = t | 0, s[1][0] = i | 0), r && (a = e[0], f = e[1], n && (a = a[1], f = f[1]), o[0][1] = a, o[1][1] = f, r.invert && (a = r(a), f = r(f)), f < a && (l = a, a = f, f = l), s[0][1] = a | 0, s[1][1] = f | 0), u) : (e = o || s, n && (t = e[0][0], i = e[1][0], o || (t = s[0][0], i = s[1][0], n.invert && (t = n.invert(t), i = n.invert(i)), i < t && (l = t, t = i, i = l))), r && (a = e[0][1], f = e[1][1], o || (a = s[0][1], f = s[1][1], r.invert && (a = r.invert(a), f = r.invert(f)), f < a && (l = a, a = f, f = l))), n && r ? [[t, a], [i, f]] : n ? [t, i] : r && [a, f])
        }, u.clear = function() {
            return o = null, s[0][0] = s[0][1] = s[1][0] = s[1][1] = 0, u
        }, u.empty = function() {
            return n && s[0][0] === s[1][0] || r && s[0][1] === s[1][1]
        }, d3.rebind(u, t, "on")
    };
    var $ = {n: "ns-resize",e: "ew-resize",s: "ns-resize",w: "ew-resize",nw: "nwse-resize",ne: "nesw-resize",se: "nwse-resize",sw: "nesw-resize"}, J = [["n", "e", "s", "w", "nw", "ne", "se", "sw"], ["e", "w"], ["n", "s"], []];
    K.prototype.on = function(e, t) {
        var n = e.indexOf("."), r = "";
        return n > 0 && (r = e.substring(n + 1), e = e.substring(0, n)), arguments.length < 2 ? this[e].on(r) : this[e].on(r, t)
    }, dv.behavior.zoom = dv.behavior.extend(function() {
        function e(e) {
            arguments.length && !dv.util.isArray(e) && (this._dimensions = [this._dimensions]), this._fluidDimensions = e || ["x", "y"], this._zoom = d3.behavior.zoom(), this.scaleExtent([0, Infinity]), this._underGeoms = !1
        }
        return e.initializeZoom = function(e) {
            var t = this;
            this._cacheAxes(), this._zoom.on("zoomstart.zoom", function() {
                t._zoomStart && t._zoomStart.call(this, "start", d3.event.scale, d3.event.translate, t)
            }).on("zoom.zoom", function() {
                t._zoomMove && t._zoomMove.call(this, "move", d3.event.scale, d3.event.translate, t), t._refresh(d3.event.scale, d3.event.translate)
            }).on("zoomend.zoom", function() {
                t._zoomEnd && t._zoomEnd.call(this, "end", d3.event.scale, d3.event.translate, t)
            })
        }, e.underGeoms = function(e) {
            return arguments.length ? (this._underGeoms = e, this) : this._underGeoms
        }, e._cacheAxes = function() {
            this._axisCache = {};
            for (var e in this._chart._axes._axes)
                this._axisCache[e] = this._chart._axes._axes[e]
        }, e._removeEvents = function() {
            this._zoom.on("zoomstart.zoom", null).on("zoom.zoom", null).on("zoomend.zoom", null)
        }, e._refresh = function(e, t) {
            var n = this, r = [0, this._bounds.width - this._bounds.width * e], i = [0, this._bounds.height - this._bounds.height * e];
            e >= 1 ? (t[0] = Math.min(r[0], Math.max(t[0], r[1])), t[1] = Math.min(i[0], Math.max(t[1], i[1]))) : (t[0] = t[0] < r[0] ? r[0] : t[0] > r[1] ? r[1] : t[0], t[1] = t[1] < i[0] ? i[0] : t[1] > i[1] ? i[1] : t[1]), this._zoom.translate(t), setTimeout(function() {
                n._chart._axes._axes = n._axisCache, n._chart.duration(0), n._chart._finalizePlotBounds(), n._chart._facet._render()
            }, 0)
        }, e._setScales = function() {
            if (this._fluidDimensions.indexOf("x") >= 0) {
                var e = this._chart.getTrainedScale("x");
                this._zoom.x(e._d3Scale)
            }
            if (this._fluidDimensions.indexOf("y") >= 0) {
                var t = this._chart.getTrainedScale("y");
                this._zoom.y(t._d3Scale)
            }
        }, e._render = function(e) {
            this._zoomContainer = e.selectAll(".zoom-container").data([0]), this._zoomContainer.enter().append("g").classed("zoom-container");
            var t = this._zoomContainer.selectAll(".zoom-pane").data([0]);
            t.enter().append("rect").classed("zoom-pane", !0);
            var n = this._chart.facet().getPanel(0), r = n.bounds();
            t.attr("x", r.left).attr("y", r.top).attr("width", r.width).attr("height", r.height).call(this._zoom), this._bounds = r
        }, e.scale = function(e) {
            return arguments.length ? (this._zoom.scale(e), this._refresh(e, this._zoom.translate()), this) : this._zoom.scale()
        }, e.scaleExtent = function(e) {
            return arguments.length ? (this._zoom.scaleExtent(e), this) : this._zoom.scaleExtent()
        }, e.translate = function(e) {
            return arguments.length ? (this._zoom.translate(e), this._refresh(this._zoom.scale(), e), this) : this._zoom.translate()
        }, e.zoomStart = function(e) {
            return arguments.length ? (this._zoomStart = e, this) : this._zoomStart
        }, e.zoomMove = function(e) {
            return arguments.length ? (this._zoomMove = e, this) : this._zoomMove
        }, e.zoomEnd = function(e) {
            return arguments.length ? (this._zoomEnd = e, this) : this._zoomEnd
        }, e.chart = function(e) {
            return arguments.length ? (this._chart = e, this.initializeZoom(this._chart), this._chart && (this._setScales(), this._chart.clipPlot(!0)), this) : this._chart
        }, e
    }), dv.behavior.rollover = dv.behavior.extend(function() {
        function e() {
            this._selection = null, this._showTooltip = this._defaultShowTooltip, this._hideTooltip = this._defaultHideTooltip, this._orientation = "right", this._tooltipPadding = 10, this._content = this._defaultContent, this._lastSelectedTarget = null, this._timer = null, this._pressTimer = null, this._dragInspect = !0
        }
        return e._render = function(e) {
            this._xGuides = this.__geom._chart._axes._get("x"), this._yGuides = this.__geom._chart._axes._get("y"), this._isPolar = this.__geom.coord() instanceof dv.coord.polar, this._selection = e, this._addEvents()
        }, e._addEvents = function() {
            var e = this;
            this.__geom.on("mouseover.rollover", function(t, n, r) {
                return e._onMouseOver.call(this, t, n, r, e)
            }).on("mouseout.rollover", function(t, n, r) {
                return e._onMouseOut.call(this, t, n, r, e)
            }), this.__geom._chart.on("tap.rollover", function() {
                return e._onTap.call(e, d3.event)
            }).on("touchstart.rollover", function() {
                return e._onTouchStart.call(e, d3.event)
            }).on("touchmove.rollover", function() {
                return e._onTouchMove.call(e, d3.event)
            }).on("touchend.rollover", function() {
                return e._onTouchEnd.call(e, d3.event)
            })
        }, e._removeEvents = function() {
            this.__geom.on("mouseover.rollover", null).on("mouseout.rollover", null), this.__geom._chart.on("tap.rollover", null).on("touchstart.rollover", null).on("touchmove.rollover", null).on("touchend.rollover", null)
        }, e._getElementMetadata = function(e, t) {
            var n = {d: t.datum(),i: 0,j: 0};
            return e._geomGroup.selectAll(".series ." + e._dataPointStyleClass).each(function(e, t, r) {
                n.d === e && (n.i = t, n.j = r)
            }), n
        }, e._defaultShowTooltip = function(e, t, n, r, i) {
            i._darkenGeom.call(this, e, i), i._showTip.call(this, e, t, n, i)
        }, e._defaultHideTooltip = function(e, t, n, r, i) {
            i._brightenGeom.call(this, e, i), i._removeTip.call(this, e, t, n, i)
        }, e._darkenGeom = function(e, t) {
            var n = d3.select(this), r, i, s = function(e, n, r) {
                if (n[e]) {
                    var i = t.__geom.getScale(e).mapValue(n[e]);
                    r.style(e, d3.rgb(i).darker(1).toString())
                }
            };
            s("fill", e, n), s("stroke", e, n)
        }, e._brightenGeom = function(e, t) {
            var n = d3.select(this), r, i, s = function(e, n, r) {
                if (n[e]) {
                    var i = t.__geom.getScale(e).mapValue(n[e]);
                    r.style(e, i)
                }
            };
            s("fill", e, n), s("stroke", e, n)
        }, e._showTip = function(e, t, n, r) {
            var i = r.__geom.chart()._chartContainer, s = this.getBBox(), o = dv.absoluteCoordinates(r.__geom.chart(), [s.x, s.y], e.panel), u = {height: s.height,width: s.width,x: o[0],y: o[1]};
            dv.showTooltip(u, i.select(".plot").node().getBBox(), r.content().call(r, e, t, n), r._orientation, r._tooltipPadding, i)
        }, e._removeTip = function(e, t, n, r) {
            dv.removeTooltip(r.__geom.chart()._chartContainer)
        }, e._defaultContent = function(e, t, n) {
            var r = this.__geom.getExplicitScale("group"), i = e[0] ? e[0] : e, s = i.panel.xScale(i), o = i.panel.yScale(i), u = this._xGuides[s.scaleIndex()], a = this._yGuides[o.scaleIndex()], f = u.__scale && u.tickFormat() ? u.tickFormat() : String, l = a.__scale && a.tickFormat() ? a.tickFormat() : String, c = '<span class="metric-value">' + l(i.data[o.mapping()]) + '</span><span class="metric-name">' + o.mapping() + "</span>" + '<span class="metric-value">' + f(i.data[s.mapping()]) + '</span><span class="metric-name">' + s.mapping() + "</span>";
            return r && r.mapping() && (c = '<span class="series-name">' + i.data[r.mapping()] + "</span>" + c), c
        }, e._onMouseOver = function(e, t, n, r) {
            r._showTooltip.call(this, e, t, n, d3.event, r), this._mouseOver && this._mouseOver.call(this, e, t, n, d3.event)
        }, e._onMouseOut = function(e, t, n, r) {
            r._hideTooltip.call(this, e, t, n, d3.event, r), r._mouseOut && r._mouseOut.call(this, e, t, n, d3.event)
        }, e._onTap = function(e) {
            this._dragInspect = !0, this._onTouchMove.call(this, e), this._onTouchEnd.call(this, e)
        }, e._onTouchStart = function(e) {
            var t = this;
            return this._lastSelectedTarget && (clearTimeout(t._timer), this._onTouchEnd.call(this, e, 0)), this._dragInspect = !1, clearTimeout(this._pressTimer), this._pressTimer = setTimeout(function() {
                t._dragInspect = !0, t._onTouchMove.call(t, e)
            }, 500), !1
        }, e._onTouchMove = function(e) {
            if (!this._dragInspect) {
                clearTimeout(this._pressTimer);
                return
            }
            var t = e.touches ? e.touches[0] : e, n = d3.select(this._elementFromPoint(t)), r = this._lastSelectedTarget && this._lastSelectedTarget.node() === n.node();
            if (!n.empty() && n.classed(this.__geom._dataPointStyleClass)) {
                if (this._lastSelectedTarget && !r) {
                    var i = this._lastSelectedTarget.datum();
                    this._brightenGeom.call(this._lastSelectedTarget.node(), i, this)
                }
                if (!r) {
                    var s = this._getElementMetadata(this.__geom, n);
                    this._showTooltip.call(n.node(), s.d, s.i, s.j, e, this), this._mouseOver && this._mouseOver.call(n.node(), s.d, s.i, s.j, e), this._lastSelectedTarget = n
                }
            }
            dv.cancelEvent(e)
        }, e._onTouchEnd = function(e, t) {
            var n = this;
            clearTimeout(this._pressTimer), this._dragInspect = !1;
            var r = e.touches ? e.touches[0] : e;
            arguments.length < 2 && (t = 500);
            if (this._lastSelectedTarget) {
                var i = function() {
                    if (!n._lastSelectedTarget)
                        return;
                    var t = n._getElementMetadata(n.__geom, n._lastSelectedTarget);
                    n._hideTooltip.call(n._lastSelectedTarget.node(), t.d, t.i, t.j, e, n), n._mouseOut && n._mouseOut.call(n._lastSelectedTarget.node(), t.d, t.i, t.j, e), n._lastSelectedTarget = null
                };
                t ? timer = setTimeout(i, t) : i.call(this)
            }
            dv.cancelEvent(e)
        }, e._elementFromPoint = function(e) {
            var t = [e.clientX, e.clientY];
            return this._testAndroidChromeBug141840() && (t = [e.screenX, e.screenY]), document.elementFromPoint(t[0], t[1])
        }, e.content = function(e) {
            return arguments.length ? (this._content = d3.functor(e), this) : this._content
        }, e.tooltipPadding = function(e) {
            return arguments.length ? (this._tooltipPadding = e, this) : this._tooltipPadding
        }, e.orientation = function(e) {
            return arguments.length ? (this._orientation = e, this) : this._orientation
        }, e.mouseOver = function(e) {
            return arguments.length ? (this._mouseOver = e, this) : this._mouseOver
        }, e.mouseOut = function(e) {
            return arguments.length ? (this._mouseOut = e, this) : this._mouseOut
        }, e.showTooltip = function(e) {
            return arguments.length ? (this._showTooltip = e, this) : this._showTooltip
        }, e.hideTooltip = function(e) {
            return arguments.length ? (this._hideTooltip = e, this) : this._hideTooltip
        }, e._geom = function(e) {
            return arguments.length ? (this.__geom && this.__geom !== e && this._removeEvents(), this.__geom = e, this) : this.__geom
        }, e
    }), dv.behavior.voronoiRollover = dv.behavior.rollover.extend(function() {
        function e() {
            this._super(), this._voronoiContainer = null, this._points = null, this._pointDetectionRadius = 20, this._numHitAreaVertices = 12, this._isPolar = !1
        }
        return e._render = function(e) {
            this._xGuides = this.__geom._chart._axes._get("x"), this._yGuides = this.__geom._chart._axes._get("y"), this._isPolar = this.__geom.coord() instanceof dv.coord.polar, this._selection = e, this._createTooltipContainer(), this._renderPolygons(this._getPolygonData(), e), this._addEvents()
        }, e._addEvents = function() {
            var e = this;
            this.__geom._chart.on("tap.rollover", function() {
                return e._onTap.call(e, d3.event)
            }).on("touchstart.rollover", function() {
                return e._onTouchStart.call(e, d3.event)
            }).on("touchmove.rollover", function() {
                return e._onTouchMove.call(e, d3.event)
            }).on("touchend.rollover", function() {
                return e._onTouchEnd.call(e, d3.event)
            })
        }, e._removeEvents = function() {
            this.__geom._chart.on("tap.rollover", null).on("touchstart.rollover", null).on("touchmove.rollover", null).on("touchend.rollover", null)
        }, e._createTooltipContainer = function() {
            this._voronoiContainer = this._selection.selectAll(".voronoiSelection-container").data([this]), this._voronoiContainer.enter().append("g").classed("voronoiSelection-container", !0)
        }, e._getPolygonData = function() {
            var e = [], t = this.__geom._nestData, n = this;
            this._points = [];
            var r = n.__geom.coord()._point().x(function(e, t) {
                return e.x
            }).y(function(e, t) {
                return e.y
            }).defined(function(e, t) {
                return !0
            });
            return dv.util.each(this.__geom._nestData, function(t, i) {
                dv.util.each(t.values, function(t, s) {
                    var o = {}, u = t[0] ? t[0] : t, a = u.panel.xScale(u), f = u.panel.yScale(u);
                    o.x = a.mapValueToPercent(a.mapToProp(u, s) + a.rangeBand() / 2, s) || 0, o.y = f.mapValueToPercent(f.mapValue(u.hasOwnProperty("y0") ? u.y + u.y0 : u.y), s) || 0, o.panel = u.panel;
                    var l = r.getBounds(o, s);
                    if (n._isPolar) {
                        var c = n.__geom.coord()._transformAngleRadiusToXY(l.bounds.x, l.bounds.y);
                        range.bounds.x = c[0], range.bounds.y = c[1]
                    }
                    n._points.push({data: l,rawData: u,seriesIndex: i,index: s}), e.push([l.bounds.x, l.bounds.y])
                })
            }), d3.geom.voronoi(e)
        }, e._renderPolygons = function(e, t) {
            var n = this, r = this.__geom._nestData.length, i = this.__geom._nestData[0].values.length, s = d3.select(t.node().parentNode), o = 0, u = 0, a;
            if (this._isPolar) {
                var f = this.__geom._nestData[0].values[0].panel, l = dv.util.scaleRangeNoReverse(f.xOuterScale()), c = dv.util.scaleRangeNoReverse(f.yOuterScale());
                o = (l[0] + l[1]) / 2, u = (c[0] + c[1]) / 2
            }
            this._voronoiContainer.attr("transform", "translate(" + o + "," + u + ")");
            var h = this._voronoiContainer.selectAll("path").data(e);
            h.exit().remove(), h.enter().append("path").attr("id", function(e, t) {
                return "path-" + t
            }).classed("voronoi-overlay", !0), h.attr("d", function(e, t) {
                return n._getPolygonPath(e, t, n)
            }).on("mouseover.rollover", function(e, t, r) {
                return n._onMouseOver.call(this, e.data, t, r, n)
            }).on("mouseout.rollover", function(e, t, r) {
                return n._onMouseOut.call(this, e.data, t, r, n)
            }).call(this._removeRegisteredEvents, this).call(this._addRegisteredEvents, this), h.exit().on("mouseover.rollover", null).on("mouseout.rollover", null).remove()
        }, e._addRegisteredEvents = function(e, t) {
            t || (t = this);
            if (!t.__geom)
                return;
            e = e || t._voronoiContainer.selectAll(".voronoi-overlay"), dv.util.each(t.__geom.eventMap, function(n, r) {
                e.on(r, function(e, n) {
                    t.__geom.eventMap[r].callback.call(this, e, n, d3.event)
                }, n.capture)
            }), dv.util.each(t.__geom._chart.eventMap, function(n, r) {
                e.on(r + ".dvchart", function(e, n) {
                    var i = d3.event, s = t.__geom._chart._interactionGroup.node();
                    t._shouldDispatchChartEvent(i, s) && t.__geom._chart.eventMap[r].callback.call(s, i)
                }, n.capture)
            })
        }, e._removeRegisteredEvents = function(e, t) {
            t || (t = this);
            if (!t.__geom)
                return;
            e = e || t._voronoiContainer.selectAll(".voronoi-overlay"), dv.util.each(t.unregisterEventMap, function(t, n) {
                e.on(n, null, t)
            }), dv.util.each(t.__geom._chart.unregisterEventMap, function(t, n) {
                e.on(n + ".dvchart", null, t)
            })
        }, e._shouldDispatchChartEvent = function(e, t) {
            var n = !0;
            if (e.type === "mouseout" || e.type === "mouseover") {
                var r = e.relatedTarget;
                r || (r = e.type === "mouseout" ? e.toElement : e.fromElement);
                var i = d3.select(r);
                if (i && !i.empty()) {
                    var s = i.attr("class");
                    n = i.node() !== t && !i.classed("voronoi-overlay")
                }
            }
            return n
        }, e._getPolygonPath = function(e, t, n) {
            if (!e)
                return null;
            e.data = n._points[t];
            var r = dv.util.clone(e), i = n._points[t], s = d3.geom.polygon(n._getPolygonPoints(i.data.bounds.x, i.data.bounds.y)), o = s.clip(e);
            return o.length ? "M" + o.join("L") + "Z" : null
        }, e._getPolygonPoints = function(e, t) {
            var n = [];
            for (var r = 360; r > 0; r -= 360 / this._numHitAreaVertices) {
                var i = r * Math.PI / 180, s = Math.cos(i) * this._pointDetectionRadius + e, o = Math.sin(i) * this._pointDetectionRadius + t;
                n.push([s, o])
            }
            return n
        }, e._defaultShowTooltip = function(e, t, n, r, i) {
            i._showPoint.call(this, e, t, n, i), i._showTip.call(this, e, t, n, i)
        }, e._defaultHideTooltip = function(e, t, n, r, i) {
            i._removePoint.call(this, e, t, n, i), i._removeTip.call(this, e, t, n, i)
        }, e._showPoint = function(e, t, n, r) {
            var i = 10, s = e.rawData, o = r.getGeomFromVoronoiIndex.call(r, s, t, n);
            if (!o.empty()) {
                var u = o.node().getBoundingClientRect(), a = {height: u.height,width: u.width,x: u.x,y: u.y};
                i = Math.max(a.height, a.width) / 2 + 2.5
            }
            r._voronoiContainer.append("circle").classed("hover-point", !0).attr("id", "point-" + n + "-" + t).attr("cx", e.data.bounds.x).attr("cy", e.data.bounds.y).attr("r", 0).style("stroke", function() {
                return r.__geom.getHighlightColor(e.rawData, t)
            }).style("pointer-events", "none").transition().duration(350).attr("r", i)
        }, e._removePoint = function(e, t, n, r) {
            r._voronoiContainer.selectAll("#point-" + n + "-" + t).transition().duration(350).attr("r", 0).remove()
        }, e._showTip = function(e, t, n, r) {
            var i = r.__geom.chart()._chartContainer, s, o = e.data, u = e.rawData, a = r.getGeomFromVoronoiIndex.call(r, u, t, n);
            if (a.empty()) {
                var f = dv.absoluteCoordinates(r.__geom.chart(), [o.bounds.x, o.bounds.y], u.panel), l = 10, c = 10;
                s = {height: l,width: c,y: f[1] - l / 2,x: f[0] - c / 2}
            } else {
                var h = a.node().getBBox();
                s = {height: h.height,width: h.width,x: h.x,y: h.y}
            }
            dv.showTooltip(s, i.select(".panels").node().getBBox(), r.content().call(r, u, t, n), r._orientation, r._tooltipPadding, i)
        }, e.getGeomFromVoronoiIndex = function(e, t, n) {
            return this.__geom.chart()._g.selectAll(".datum-" + t + ".series-" + n).filter(function(t) {
                return e === t
            })
        }, e._onMouseOver = function(e, t, n, r) {
            r._showTooltip.call(this, e, e.index, e.seriesIndex, d3.event, r), r._mouseOver && r._mouseOver.call(this, e.rawData, e.index, e.seriesIndex, d3.event)
        }, e._onMouseOut = function(e, t, n, r) {
            r._hideTooltip.call(this, e, e.index, e.seriesIndex, d3.event, r), r._mouseOut && r._mouseOut.call(this, e.rawData, e.index, e.seriesIndex, d3.event)
        }, e._onTouchMove = function(e) {
            if (!this._dragInspect) {
                clearTimeout(this._pressTimer);
                return
            }
            var t = e.touches ? e.touches[0] : e, n = d3.select(this._elementFromPoint(t)), r = this._lastSelectedTarget && this._lastSelectedTarget.node() === n.node();
            if (!n.empty() && n.classed("voronoi-overlay")) {
                if (this._lastSelectedTarget && !r) {
                    var i = this._lastSelectedTarget.datum().data;
                    this._removePoint.call(n.node(), i.rawData, i.index, i.seriesIndex, this)
                }
                if (!r) {
                    var s = n.datum().data;
                    this._showTooltip.call(n.node(), s, s.index, s.seriesIndex, e, this), this._mouseOver && this._mouseOver.call(n.node(), s.rawData, s.index, s.seriesIndex, e), this._lastSelectedTarget = n
                }
            }
            dv.cancelEvent(e)
        }, e._onTouchEnd = function(e, t) {
            var n = this;
            clearTimeout(this._pressTimer), this._dragInspect && (this._dragInspect = !1), arguments.length < 2 && (t = 500);
            if (this._lastSelectedTarget) {
                var r = function() {
                    if (!n._lastSelectedTarget)
                        return;
                    var t = n._lastSelectedTarget.datum().data;
                    n._hideTooltip.call(n._lastSelectedTarget.node(), t, t.index, t.seriesIndex, e, n), n._mouseOut && n._mouseOut.call(n._lastSelectedTarget.node(), t.rawData, t.index, t.seriesIndex, e), n._lastSelectedTarget = null
                };
                t ? timer = setTimeout(r, t) : r.call(this)
            }
            dv.cancelEvent(e)
        }, e.pointDetectionRadius = function(e) {
            return arguments.length ? (this._pointDetectionRadius = e, this) : this._pointDetectionRadius
        }, e.numHitAreaVertices = function(e) {
            return arguments.length ? (this._numHitAreaVertices = e, this) : this._numHitAreaVertices
        }, e
    }), dv.log = dv.log || {}, dv.log.NOCONSOLE = !1, dv.log.LVL_ERROR = 0, dv.log.ERROR = "error", dv.log.LVL_WARN = 1, dv.log.WARN = "warn", dv.log.LVL_DEBUG = 2, dv.log.DEBUG = "debug", dv.log.LOGLEVEL = dv.log.LVL_DEBUG, dv.log.error = function(e) {
        return dv.log._message(dv.log.ERROR, e)
    }, dv.log.warn = function(e) {
        return dv.log._message(dv.log.WARN, e)
    }, dv.log.debug = function(e) {
        return dv.log._message(dv.log.DEBUG, e)
    }, dv.log.noConsole = function(e) {
        dv.log.NOCONSOLE = e || !1, dv.log.console = window.console || dv.util.noop;
        if (!dv.log.console.log || dv.log.NOCONSOLE)
            dv.log.console.log = dv.util.noop;
        if (!dv.log.console.error || dv.log.NOCONSOLE)
            dv.log.console.error = dv.log.console.log;
        if (!dv.log.console.warn || dv.log.NOCONSOLE)
            dv.log.console.warn = dv.log.console.log;
        if (!dv.log.console.debug || dv.log.NOCONSOLE)
            dv.log.console.debug = dv.log.console.log
    }, dv.log._message = function(e, t) {
        if (dv.log._isValidType(e)) {
            dv.log.LOGLEVEL >= dv.log["LVL_" + e.toUpperCase()] && dv.log.console[e](t.msg, t.data);
            if (e === dv.log.ERROR)
                throw t.msg + " Context Data: " + JSON.stringify(t.data)
        } else
            dv.log.console.log("Logging message with invalid type: " + e)
    }, dv.log._isValidType = function(e) {
        return e === dv.log.ERROR || e === dv.log.WARN || e === dv.log.DEBUG
    }, dv.log.noConsole(!1), dv.panel = dv.extend(function() {
        function e() {
            this._margins = {left: 0,top: 0,right: 0,bottom: 0}, this._trainedScales = {}
        }
        return e.getTrainedScale = function(e) {
            return e === "x" ? this.xScale() : e === "y" ? this.yScale() : this._trainedScales[e]
        }, e.getOuterScale = function(e) {
            return e === "x" ? this._xScale : e === "y" ? this._yScale : null
        }, e._updateRanges = function(e) {
            var t = [e.left, e.right], n = [e.bottom, e.top];
            this._facet._chart.coord().flip() ? (this._xScale.range(n), this._yScale.range(t)) : (this._xScale.range(t), this._yScale.range(n))
        }, e.bounds = function(e) {
            return arguments.length ? (this._bounds = e, this._updateRanges(this._bounds), this) : this._bounds
        }, e.margins = function(e) {
            return arguments.length ? (this._margins = e, this) : this._margins
        }, e.visibleAxisLabelOrientations = function(e) {
            return arguments.length ? (this._visibleAxisLabelOrientations = e, this) : this._visibleAxisLabelOrientations
        }, e.columnIndex = function(e) {
            return arguments.length ? (this._columnIndex = e, this) : this._columnIndex
        }, e.rowIndex = function(e) {
            return arguments.length ? (this._rowIndex = e, this) : this._rowIndex
        }, e.facetIndex = function(e) {
            return arguments.length ? (this._facetIndex = e, this) : this._facetIndex
        }, e.facetKey = function(e) {
            return arguments.length ? (this._facetKey = e, this) : this._facetKey
        }, e.xFacetTitle = function(e) {
            return arguments.length ? (this._xFacetTitle = e, this) : this._xFacetTitle
        }, e.yFacetTitle = function(e) {
            return arguments.length ? (this._yFacetTitle = e, this) : this._yFacetTitle
        }, e.xOuterScale = function(e) {
            return arguments.length ? (this._xScale = e, this) : this._xScale
        }, e.yOuterScale = function(e) {
            return arguments.length ? (this._yScale = e, this) : this._yScale
        }, e.xScale = function(e) {
            var t = 0;
            return e && e.hasOwnProperty("x-index") && (t = e["x-index"]), this._xScale.innerScaleGroup()[t]
        }, e.yScale = function(e) {
            var t = 0;
            return e && e.hasOwnProperty("y-index") && (t = e["y-index"]), this._yScale.innerScaleGroup()[t]
        }, e.facet = function(e) {
            return arguments.length ? (this._facet = e, this._trainedScales = {}, this) : this._facet
        }, e
    }), dv.facet = dv.extend(function() {
        function e() {
            this._numColumns = 0, this._numRows = 0, this._hGap = 10, this._vGap = 10
        }
        return e._prerender = function() {
            var e = this;
            this._trainedScales = {}, this._panels = [], this._rows = [], this._columns = [], this._panelsWithAxisLabels = [], dv.util.each(e._chart._layers, function(t) {
                t._prerender(e._chart), e._trainFacetGroups(t)
            }), this._configureFacets(), dv.util.each(e._chart._layers, function(t) {
                t._nestData = e._nestFacet(t), t._handlePositions(), t._trainScales(), t._createDefaultScales()
            }), this._trainScales()
        }, e._trainScales = function() {
            var e = this, t, n, r, i, s = function(t) {
                return function(n) {
                    return e._getFacetFromFacetKey(n) !== t.facetKey()
                }
            }, o = function(e) {
                return function(e, t, n) {
                    return arguments.length < 2 && (t = 0), arguments.length < 3 ? this._globalScales[e] === undefined ? null : this._globalScales[e][t] : (this._globalScales[e] || (this._globalScales[e] = {}), this._globalScales[e][t] = n, n)
                }
            };
            this._globalScales = {}, this._positionScales = {}, dv.util.each(this._panels, function(n, r) {
                dv.util.each(e._chart._layers, function(r) {
                    for (var i in r._aes) {
                        var u = r._aes[i];
                        for (var a in u) {
                            var f = r.getScale(i, a);
                            f instanceof dv.scale.constant || (e._isFree.call(e, i) ? t = e._trainFreeScale(r, n, i, a, s(n)) : t = e._trainScale(r, o(r), i, a), n._trainedScales[i] || (n._trainedScales[i] = {}), n._trainedScales[i][a] = t, u[a].unionDomain(t, t.reverse()), u[a].range(t.range()))
                        }
                    }
                })
            }), dv.util.each(this._globalScales, function(e, t) {
                dv.util.each(e, function(e, t) {
                    e.validateDomain()
                })
            })
        }, e._isFree = function(e) {
            var t = e === "x" || e === "xMin" || e === "xMax", n = e === "y" || e === "yMin" || e === "yMax";
            return t && (this._scales === "free" || this._scales === "free_x") || n && (this._scales === "free" || this._scales === "free_y")
        }, e._trainScale = function(e, t, n, r, i) {
            var s = t.call(this, n, r), o = {stack: e.position() === "stack" && n === "y",fill: e.position() === "fill" && n === "y",filter: i}, u;
            return s ? (u = e._aes[n][r], u.domain(u.calculateDomain(e._nestData, o)), s.unionDomain(u, s.reverse()), s.unionRange(u.range())) : (e._aes[n][r].trainDomain(e._nestData, o), s = e._aes[n][r].copy(), t.call(this, n, r, s)), s
        }, e._render = function() {
            this._axes = this._chart._axes;
            var e = this._ensureColumnsAndRows();
            this._adjustPlotBounds(e[0], e[1]), this._configurePanels(e[0], e[1]), this._axes._initializeAxisRenderers(), this._axes._measureTitles(this._chart._plotBounds);
            var t = this._measureMargins(e[0], e[1]);
            this._layoutPanels(e[0], e[1], t), this._renderAxisTitles(), this._renderPanels()
        }, e._setVisibleAxisLabelOrientations = function(e, t, n, r) {
            var i = e.rowIndex(), s = e.columnIndex(), o = {left: s === 0,top: i === 0,right: s === n || e.facetIndex() === r - 1,bottom: i === t || s > n && i === t - 1};
            e.visibleAxisLabelOrientations(o)
        }, e._changeScaleRangeToLocal = function(e) {
            var t = e.range(), n = e.innerScaleGroup();
            for (var r in n)
                dv.util.scaleRange(n[r], [t[0], t[1]]).applyRangePadding();
            return n
        }, e._measureMargins = function(e, t) {
            var n = this._panels.length, r = ~~((n - 1) / e), i = (n - 1) % e, s = this._axes._getAllOrientations(), o = {rows: [],cols: []}, u = this._isFree("x"), a = this._isFree("y"), f = this, l = this._panels[0];
            l && (this._changeScaleRangeToLocal(l.getOuterScale("x")), this._changeScaleRangeToLocal(l.getOuterScale("y")));
            var c = -1;
            while (++c < n) {
                var h = this._panels[c], p = h.columnIndex(), d = h.rowIndex();
                this._setVisibleAxisLabelOrientations(h, r, i, n), h.margins({left: 0,top: 0,right: 0,bottom: 0}), d >= o.rows.length && (o.rows[d] = {left: 0,top: 0,right: 0,bottom: 0}), p >= o.cols.length && (o.cols[p] = {left: 0,top: 0,right: 0,bottom: 0}), this._panelsWithAxisLabels.push(h), this._axes._measure(h);
                var v = h.margins();
                s.right !== undefined && !a && c === n - 1 && p < e - 1 && (v.right = 0), s.bottom !== undefined && !u && p >= i && d === r - 1 && (v.bottom = 0);
                for (var m in o) {
                    var g = m === "rows" ? d : p, y = o[m][g];
                    y.left = Math.max(v.left, y.left), y.top = Math.max(v.top, y.top), y.right = Math.max(v.right, y.right), y.bottom = Math.max(v.bottom, y.bottom)
                }
            }
            return o
        }, e._layoutPanels = function(e, t, n) {
            var r = this._chart._plotBounds, i = r.right - r.left - (e - 1) * this._hGap, s = r.bottom - r.top - (t - 1) * this._vGap, o, u, a = {x: 0,y: 0}, f = this, l, c;
            l = -1, c = n.cols.length;
            while (++l < c)
                i -= n.cols[l].left + n.cols[l].right;
            l = -1, c = n.rows.length;
            while (++l < c)
                s -= n.rows[l].bottom + n.rows[l].top;
            o = Math.max(i / e, 0), u = Math.max(s / t, 0);
            var h = this._chart._chartContainer.select(".axes-labels"), p = h.selectAll(".panel-labels").data(this._panelsWithAxisLabels);
            p.enter().append("div"), p.exit().remove(), p.attr("class", function(e, t) {
                return "panel-labels panel-" + e.facetIndex()
            });
            var d = this._chart._panelContainer.selectAll(".panel").data(this._panels);
            d.enter().append("g").classed("panel", !0), d.exit().remove(), d.each(function(i, s) {
                f._drawPanel.call(this, f, i, s, r, n, o, u, e, t, a), f._axes._render.call(f._axes, d3.select(this), h.select(".panel-labels.panel-" + i.facetIndex()), i)
            })
        }, e._renderAxisTitles = function() {
            var e = this.getColumn(0)[0].bounds(), t = this.getRow(0)[0].bounds(), n = this.getColumn(this._columns.length - 1)[0].bounds(), r = this.getRow(this._rows.length - 1)[0].bounds(), i = (r.bottom - t.top) / 2 + t.top, s = (n.right - e.left) / 2 + e.left, o = this._chart.plotBounds();
            this._axes._renderTitles(o, {left: [o.left, i],right: [o.right, i],top: [s, o.top],bottom: [s, o.bottom]})
        }, e._renderPanels = function() {
            var e = this._chart, t = e._plotBounds, n = e._g.select(".plot"), r = e._plotBounds, i = function(e) {
                e.attr("transform", "translate(0,0)").each(function(e) {
                    this.__previousData__ && this.__previousData__._dataPointStyleClass != e._dataPointStyleClass && this.__previousData__.exit(this), e._render(this), this.__previousData__ = e
                })
            }, s = function(e) {
                e.each(function(t) {
                    t.exit(this, function() {
                        e.remove()
                    })
                })
            }, o = n.selectAll(".geom").data(e._layers);
            o.exit().call(s), o.enter().append("g").classed("geom", !0), o.call(i)
        }, e._updatePanelTitle = function(e, t, n, r, i, s, o) {
            var u = {left: 0,top: 0,width: 0,height: 0}, a = d3.select(this);
            if (dv.util.isUndefined(t))
                return e._removePanelTitle.call(this, n), u;
            var f = a.selectAll(".panel-title." + n).data([0]), l = f.enter().append("g").classed("panel-title " + n, !0).attr("transform", "translate(" + r + "," + i + ")"), c = l.append("rect").classed("panel-title-bg", !0), h = l.append("text").classed("panel-title-label", !0).attr("text-anchor", "middle");
            dv.ANIMATION ? f.transition().duration(e._chart._duration).attr("transform", "translate(" + r + "," + i + ")") : f.attr("transform", "translate(" + r + "," + i + ")");
            var p = f.selectAll(".panel-title-label").text(t), d = f.selectAll(".panel-title-bg"), v = p.node().getBBox(), m = 0;
            dv.ANIMATION && (p = p.transition().duration(e._chart._duration), d = d.transition().duration(e._chart._duration));
            switch (n) {
                case "top":
                    x = s / 2, y = v.height, u.left = 0, u.top = 0, u.width = s, u.height = v.height + 6;
                    break;
                case "right":
                    x = o / 2, y = -s + v.height, u.left = s - (v.height + 6), u.top = 0, u.width = v.height + 6, u.height = o, m = 90;
                    break;
                case "bottom":
                    x = s / 2, y = o - 6, u.left = 0, u.top = o - (v.height + 6), u.width = s, u.height = v.height + 6;
                    break;
                case "left":
                    x = -o / 2, y = 0 + v.height, u.left = 0, u.top = 0, u.width = v.height + 6, u.height = o, m = 270
            }
            return c.attr("x", u.left).attr("y", u.top).attr("width", u.width).attr("height", u.height), h.attr("transform", "rotate(" + m + " 0,0)").attr("x", x).attr("y", y), p.attr("transform", "rotate(" + m + " 0,0)").attr("x", x).attr("y", y), d.attr("x", u.left).attr("y", u.top).attr("width", u.width).attr("height", u.height), u
        }, e._removePanelTitle = function(e) {
            d3.select(this).selectAll(".panel-title." + e).remove()
        }, e._updatePanelBackground = function(e, t, n, r, i) {
            var s = d3.select(this).selectAll(".plot-bg").data([0]);
            s.enter().append("rect").classed("plot-bg", !0).style("opacity", 1e-6).attr("x", t).attr("y", n).attr("width", r).attr("height", i), dv.ANIMATION && (s = s.transition().duration(e._chart._duration)), s.attr("x", t).attr("width", r).attr("height", i).style("opacity", 1)
        }, e._addToCollection = function(e, t, n) {
            e[t] || (e[t] = []), e[t].push(n)
        }, e.getPanel = function(e) {
            return this._panels && e < this._panels.length ? this._panels[e] : null
        }, e.getRow = function(e) {
            return this._rows[e]
        }, e.getColumn = function(e) {
            return this._columns[e]
        }, e.getTrainedScale = function(e) {
            return this._panels.length > 0 ? this.getPanel(0).getTrainedScale(e) : this._trainedScales[e]
        }, e.scales = function(e) {
            return arguments.length ? (this._scales = e, this) : this._scales
        }, e.space = function(e) {
            return arguments.length ? (this._space = e, this) : this._space
        }, e.titleFormat = function(e) {
            return arguments.length ? (this._titleFormat = d3.functor(e), this) : this._titleFormat
        }, e.hGap = function(e) {
            return arguments.length ? (this._hGap = e, this) : this._hGap
        }, e.vGap = function(e) {
            return arguments.length ? (this._vGap = e, this) : this._vGap
        }, e.chart = function(e) {
            return arguments.length ? (this._chart = e, this) : this._chart
        }, e
    }), dv.facet.scale = dv.extend(function() {
        function e() {
        }
        return e.domain = function() {
            return this._innerScale.domain()
        }, e.range = function(e) {
            return arguments.length ? (this._range = e, this) : this._range
        }, e._applyPercentage = function(e, t) {
            return this._range[0] + (this._range[1] - this._range[0]) * e.apply(this._innerScale, t)
        }, e.mapPropToPercent = function(e, t) {
            return this._innerScale.mapPropToPercent(e)
        }, e.mapValueToPercent = function(e, t) {
            return this._innerScale.mapValueToPercent(e)
        }, e.mapToProp = function(e, t) {
            return this._applyPercentage(this._innerScale.mapPropToPercent, [e, t])
        }, e.mapValue = function(e, t) {
            return this._applyPercentage(this._innerScale.mapValueToPercent, [e, t])
        }, e.rangeBand = function() {
            return this._applyPercentage(this._innerScale.rangeBand)
        }, e.innerScaleGroup = function(e) {
            return arguments.length ? (this._innerScaleGroup = e, this) : this._innerScaleGroup
        }, e
    }), dv.facet.wrap = dv.facet.extend(function() {
        function e() {
            this._super(), this._facetScale = null, this._preferredAspectRatio = 1, this._titleOrientation = "top"
        }
        return e._prerender = function() {
            this._facetScale = dv.scale.ordinal().mapping(this._group).domain([]), this._super()
        }, e._trainFacetGroups = function(e) {
            var t = e.data()[this._facetScale.mapping()];
            t && this._facetScale.domain(this._facetScale.domain().concat(t))
        }, e._trainFreeScale = function(e, t, n, r, i) {
            var s = function(e, n, r) {
                return arguments.length < 2 && (n = 0), arguments.length < 3 ? t._trainedScales[e] ? t._trainedScales[e][n] : undefined : (t._trainedScales[e] || (t._trainedScales[e] = {}), t._trainedScales[e][n] = r, r)
            };
            return this._trainScale(e, s, n, r, i)
        }, e._showAllPanelLabelsIfFree = function() {
            return !0
        }, e._configureFacets = function() {
            this._facetKeys = this._facetScale.domain(), this._facetMap = {}
        }, e._nestFacet = function(e) {
            var t = this, n = e.normalizedData(), r = dv.util.filterAndZip(n), i = e.getScale("group"), s = this._group, o = this._facetScale.domain(), u, a;
            i && (u = i.property(), a = u ? n[u] : null);
            var f = -1, l = r.length;
            while (++f < l) {
                var c = 0, h, p = r[f];
                p.data.hasOwnProperty(s) && (c = o.indexOf(p.data[s]), c >= 0 && (h = o[c] + ""));
                var d = this._facetMap[c];
                d || (d = dv.panel().facetIndex(c).facetKey(h).xFacetTitle(h).facet(this), this._facetMap[c] = d, this._panels.push(d)), p.panel = d
            }
            return d3.nest().key(function(e) {
                var t = "";
                return t += (e.data.hasOwnProperty(s) ? e.data[s] : ".") + " ~ ", t += e.hasOwnProperty(u) ? e[u] : ".", t
            }).sortKeys(function(e, n) {
                var r = t._getGroupFromFacetKey(e), i = t._getGroupFromFacetKey(n), s = -1, o = -1;
                return r !== "." && (s = a.indexOf(r), s < 0 && (s = a.indexOf(Number(r)))), i !== "." && (o = a.indexOf(i), o < 0 && (o = a.indexOf(Number(i)))), o < s ? 1 : -1
            }).entries(r)
        }, e._getGroupFromFacetKey = function(e) {
            return /.* ~ (.*)/g.exec(e)[1]
        }, e._getFacetFromFacetKey = function(e) {
            return /(.*) ~ .*/g.exec(e)[1]
        }, e._ensureColumnsAndRows = function() {
            var e = this._panels.length, t = Math.min(this._numColumns, e), n = Math.min(this._numRows, e);
            if (t < 1 && n < 1) {
                var r = this._chart._plotBounds, i = r.right - r.left, s = r.bottom - r.top, o = Math.min(e, Math.ceil(Math.sqrt(e * 1 * i / (s * this._preferredAspectRatio))));
                return o = isNaN(o) ? 1 : o, [o, Math.ceil(e / o)]
            }
            return t < 1 && n >= 1 && (t = Math.ceil(e / n)), t >= 1 && n < 1 && (n = Math.ceil(e / t)), [t, n]
        }, e._adjustPlotBounds = function(e, t) {
            return
        }, e._configurePanels = function(e, t) {
            var n = this._chart._plotBounds, r = n.right - n.left, i = n.bottom - n.top, s = (r - (e - 1) * this._hGap) / e, o = (i - (t - 1) * this._vGap) / t, u = -1, a = this._panels.length;
            while (++u < a) {
                var f = this._panels[u], l = dv.facet.scale().innerScaleGroup(f._trainedScales.x), c = dv.facet.scale().innerScaleGroup(f._trainedScales.y), h = u % e, p = ~~(u / e), d = {left: 0,top: 0,right: s,bottom: o,width: s,height: o};
                this._panels[u].xOuterScale(l).yOuterScale(c).columnIndex(h).rowIndex(p).bounds(d), this._addToCollection(this._rows, p, f), this._addToCollection(this._columns, h, f)
            }
        }, e._drawPanel = function(e, t, n, r, i, s, o, u, a, f) {
            var l = t.columnIndex(), c = t.rowIndex(), h = i.rows[c], p = i.cols[l], d = e._titleOrientation;
            l === 0 && (f.x += r.left, c === 0 && (f.y += r.top));
            var v = f.y + h.top, m = f.x + p.left, g = e._titleFormat ? e._titleFormat.call(this, t.xFacetTitle(), n) : t.xFacetTitle(), y = e._updatePanelTitle.call(this, e, g, d, m, v, s, o);
            t.bounds({width: s,height: o,top: v + (d === "top" ? y.height : 0),left: m + (d === "left" ? y.width : 0),right: m + s + (d === "right" ? -y.width : 0),bottom: v + o + (d === "bottom" ? -y.height : 0)}), e._updatePanelBackground.call(this, e, m, v, s, o), l === u - 1 ? (f.x = 0, f.y += h.top + o + h.bottom + e._vGap) : f.x += p.left + s + p.right + e._hGap
        }, e.group = function(e) {
            return arguments.length ? (this._group = e, this) : this._group
        }, e.numColumns = function(e) {
            return arguments.length ? (this._numColumns = e, this) : this._numColumns
        }, e.numRows = function(e) {
            return arguments.length ? (this._numRows = e, this) : this._numRows
        }, e.preferredAspectRatio = function(e) {
            return arguments.length ? (this._preferredAspectRatio = e, this) : this._preferredAspectRatio
        }, e
    }), dv.facet.grid = dv.facet.extend(function() {
        function e() {
            this._super(), this._xFacetScale = null, this._yFacetScale = null
        }
        return e._prerender = function() {
            this._xFacetScale = dv.scale.ordinal().mapping(this._xGroup).domain([]), this._yFacetScale = dv.scale.ordinal().mapping(this._yGroup).domain([]), this._super()
        }, e._trainFacetGroups = function(e) {
            var t = e.data()[this._xFacetScale.mapping()];
            t && this._xFacetScale.domain(this._xFacetScale.domain().concat(t));
            var n = e.data()[this._yFacetScale.mapping()];
            n && this._yFacetScale.domain(this._yFacetScale.domain().concat(n))
        }, e._trainFreeScale = function(e, t, n, r, i) {
            var s = this, o = function(e, n, r) {
                arguments.length < 2 && (n = 0), s._positionScales[e] || (s._positionScales[e] = {});
                var i = s._positionScales[e];
                i[n] || (i[n] = []);
                var o = i[n], u = e.indexOf("x") >= 0 ? t.columnIndex() : t.rowIndex();
                return arguments.length < 3 ? o[u][n] : (o[u][n] = r, r)
            };
            return this._trainScale(e, o, n, i)
        }, e._showAllPanelLabelsIfFree = function() {
            return !1
        }, e._configureFacets = function() {
            var e, t, n = this._xFacetScale.domain(), r = this._yFacetScale.domain(), i;
            this._numColumns = Math.max(this._xFacetScale.domain().length, 1), this._numRows = Math.max(this._yFacetScale.domain().length, 1);
            var s = -1, o = this._numRows, u = 0;
            while (++s < o) {
                yFacetIndex = s, r && r.length > s && (t = r[s]);
                var a = -1, f = this._numColumns;
                while (++a < f) {
                    xFacetIndex = a, n && n.length > a && (e = n[a]), i = (r.length ? t : ".") + " ~ " + (n.length ? e : ".");
                    var l = dv.panel().facetIndex(u++).facetKey(i).columnIndex(xFacetIndex).rowIndex(yFacetIndex).xFacetTitle(e).yFacetTitle(t).facet(this);
                    this._panels.push(l), this._addToCollection(this._rows, yFacetIndex, l), this._addToCollection(this._columns, xFacetIndex, l)
                }
            }
        }, e._nestFacet = function(e) {
            var t = this, n = e.normalizedData(), r = dv.util.filterAndZip(n), i = e.getScale("group"), s = this._xFacetScale.domain(), o = this._yFacetScale.domain(), u, a;
            i && (u = i.property(), a = u ? n[u] : null);
            var f = -1, l = r.length;
            while (++f < l) {
                var c = r[f], h = 0, p = 0;
                c.data.hasOwnProperty(this._xGroup) && (p = s.indexOf(c.data[this._xGroup]), p < 0 && (p = 0)), c.data.hasOwnProperty(this._yGroup) && (h = o.indexOf(c.data[this._yGroup]), h < 0 && (h = 0)), panelIndex = h * this._numColumns + p;
                var d = this._panels[panelIndex];
                c.panel = d
            }
            return d3.nest().key(function(e) {
                var n = "";
                return n += (e.data.hasOwnProperty(t._yGroup) ? e.data[t._yGroup] : ".") + " ~ ", n += (e.data.hasOwnProperty(t._xGroup) ? e.data[t._xGroup] : ".") + " ~ ", n += e.hasOwnProperty(u) ? e[u] : ".", n
            }).sortKeys(function(e, n) {
                var r = t._getGroupFromFacetKey(e), i = t._getGroupFromFacetKey(n), s = -1, o = -1;
                return r !== "." && (s = a.indexOf(r), s < 0 && (s = a.indexOf(Number(r)))), i !== "." && (o = a.indexOf(i), o < 0 && (o = a.indexOf(Number(i)))), o < s ? 1 : -1
            }).entries(r)
        }, e._getGroupFromFacetKey = function(e) {
            return /.* ~ .* ~ (.*)/g.exec(e)[1]
        }, e._getFacetFromFacetKey = function(e) {
            return /(.* ~ .*) ~ .*/g.exec(e)[1]
        }, e._ensureColumnsAndRows = function() {
            return [this._numColumns, this._numRows]
        }, e._adjustPlotBounds = function(e, t) {
            var n = this._measureTitles(this._xFacetScale.domain(), "temp-column-titles", this._chart._g) + 3, r = this._measureTitles(this._yFacetScale.domain(), "temp-row-titles", this._chart._g) + 3, i = this._chart._plotBounds;
            this._xTitleHeight = n, this._yTitleWidth = r, this._chart._plotBounds.top += n, this._chart._plotBounds.right -= r
        }, e._measureTitles = function(e, t, n) {
            var r = this._createTitlesContainer(t, this._chart._g), i = r.selectAll(".panel-title").data(e);
            i.enter().append("text").text(function(e, t) {
                return e
            });
            var s = r.node().getBBox();
            return r.remove(), s.height
        }, e._createTitlesContainer = function(e, t) {
            var n = t.selectAll("." + e).data([0]);
            return n.enter().append("g").classed(e, !0), n.exit().remove(), n
        }, e._configurePanels = function(e, t) {
            var n = this._chart._plotBounds, r = n.right - n.left, i = n.bottom - n.top, s = (r - (e - 1) * this._hGap) / e, o = (i - (t - 1) * this._vGap) / t, u = 0, a = 0, f = 0, l = -1, c = this._panels.length;
            while (++l < c) {
                var h = this._panels[l], p = dv.facet.scale().innerScaleGroup(h._trainedScales.x), d = dv.facet.scale().innerScaleGroup(h._trainedScales.y), v = {left: 0,top: 0,right: 0 + s,bottom: 0 + o,width: s,height: o};
                this._panels[l].xOuterScale(p).yOuterScale(d).bounds(v), u += s + this._hGap, f++, f >= e && (u = 0, a += o + this._vGap, f = 0)
            }
        }, e._drawPanel = function(e, t, n, r, i, s, o, u, a, f) {
            var l = t.columnIndex(), c = t.rowIndex(), h = i.rows[c], p = i.cols[l];
            f.x += p.left, l === 0 && (f.x += r.left);
            if (c === 0) {
                var d = e._titleFormat ? e._titleFormat.call(this, t.xFacetTitle(), n) : t.xFacetTitle();
                f.y = h.top + r.top, e._updatePanelTitle.call(this, e, d, "top", f.x, f.y - e._xTitleHeight, s, o)
            } else
                e._removePanelTitle.call(this, "top");
            if (l === e._numColumns - 1) {
                var v = e._titleFormat ? e._titleFormat.call(this, t.yFacetTitle(), n) : t.yFacetTitle();
                e._updatePanelTitle.call(this, e, v, "right", f.x + e._yTitleWidth, f.y, s, o)
            } else
                e._removePanelTitle.call(this, "right");
            t.bounds({width: s,height: o,top: f.y,left: f.x,right: f.x + s,bottom: f.y + o}), e._updatePanelBackground.call(this, e, f.x, f.y, s, o), f.x += s + p.right + e._hGap, l === e._numColumns - 1 && (f.x = 0, f.y += h.top + o + h.bottom + e._vGap)
        }, e.xGroup = function(e) {
            return arguments.length ? (this._xGroup = e, this) : this._xGroup
        }, e.yGroup = function(e) {
            return arguments.length ? (this._yGroup = e, this) : this._yGroup
        }, e.aggregate = function(e) {
            return arguments.length ? (this._aggregate = e, this) : this._aggregate
        }, e
    }), dv.chart = dv.container.extend(function() {
        function e() {
            this._super(), this._firstRender = !1, this._data = {}, this._coord = dv.coord.cartesian(), this._facet = dv.facet.wrap().chart(this), this._layers = [], this._behaviors = [], this._legends = dv.guide.legends(), this._axes = dv.guide.axes()._chart(this), this._delay = d3.functor(0), this._duration = d3.functor(1e3), this._ease = "cubic-in-out", this._parent = null, this._chartContainer = null, this._svgContainer = null, this._g = null, this._axisLabelContainer = null, this._panelContainer = null, this._interactionGroup = null, this._prerenderFunc = null, this._postrenderFunc = null, this._clipPlot = !1, this._width = NaN, this._height = NaN, this._plotWidth = NaN, this._plotHeight = NaN, this._calcWidth = NaN, this._calcHeight = NaN, this._calcPlotWidth = NaN, this._calcPlotHeight = NaN, this._defaultPadding = this._padding = this._plotBounds = this._guidesBounds = {top: 0,left: 0,right: 0,bottom: 0}, this._position = "identity"
        }
        return e.render = function() {
            if (dv.util.isUndefined(this._data) || dv.util.isEmpty(this._data))
                for (var e = 0; e < this._layers.length; e++)
                    (dv.util.isUndefined(this._layers[e]._data) || dv.util.isEmpty(this._layers[e]._data)) && dv.log.error({msg: "Cannot render a chart with no data provided.",data: {chartData: this._data,geom: this._layers[e]}});
            return this._resolvePercentDimensions(), this._createChartContainer(), this._prerender(), this._renderLegends(), this._prerenderFunc && this._prerenderFunc.call(this), this._facet._render(), this._postrenderFunc && this._postrenderFunc.call(this), this._renderBehaviors(), this._clipGeoms(), this._cleanupGuides(), this.unregisterEventMap = null, this
        }, e._resolvePercentDimensions = function() {
            this._calcWidth = dv.util.getPercentValue(this._width, this._parent.node().offsetWidth), this._calcHeight = dv.util.getPercentValue(this._height, this._parent.node().offsetHeight), dv.util.isFinite(this._calcWidth) ? this._calcPlotWidth = dv.util.getPercentValue(this._plotWidth, this._calcWidth) : (this._calcPlotWidth = dv.util.getPercentValue(this._plotWidth, this._parent.node().offsetWidth), dv.util.isFinite(this._calcPlotWidth) || (this._calcWidth = this._parent.node().offsetWidth)), dv.util.isFinite(this._calcHeight) ? this._calcPlotHeight = dv.util.getPercentValue(this._plotHeight, this._calcHeight) : (this._calcPlotHeight = dv.util.getPercentValue(this._plotHeight, this._parent.node().offsetHeight), dv.util.isFinite(this._calcPlotHeight) || (this._calcHeight = this._parent.node().offsetHeight))
        }, e._finalizePlotBounds = function() {
            var e = this._legends._allowedDimensions(), t = this._legends._getWidth(), n = this._legends._getHeight(), r = {left: Math.max(e.left, this._padding.left),top: Math.max(e.top, this._padding.top)};
            dv.util.isFinite(this._calcWidth) ? dv.util.isFinite(this._calcPlotWidth) || (this._calcPlotWidth = this._calcWidth - this._padding.left - this._padding.right - t) : this._calcWidth = this._calcPlotWidth + t + this._padding.left + this._padding.right, dv.util.isFinite(this._calcHeight) ? dv.util.isFinite(this._calcPlotHeight) || (this._calcPlotHeight = this._calcHeight - this._padding.top - this._padding.bottom - n) : this._calcHeight = this._calcPlotHeight + n + this._padding.top + this._padding.bottom, this._calcPlotWidth = Math.min(this._calcPlotWidth, this._calcWidth - this._padding.left - this._padding.right - t), this._calcPlotHeight = Math.min(this._calcPlotHeight, this._calcHeight - this._padding.top - this._padding.bottom - n), r.right = r.left + this._calcPlotWidth, r.bottom = r.top + this._calcPlotHeight, this.plotBounds(r), this._coord instanceof dv.coord.cartesian && (this._plotBounds.right -= this._coord.endX(), this._plotBounds.left += this._coord.startX()), this._chartContainer.style("width", this._calcWidth + "px").style("height", this._calcHeight + "px")
        }, e._prerender = function() {
            this._trainedScales = {}, this._calculateStats(), this._facet._prerender();
            var e = this._normalizeData(this.data());
            this.data(e), this._axes._get("x") || this._axes._add("x", dv.guide.axis()), this._axes._get("y") || this._axes._add("y", dv.guide.axis())
        }, e._createChartContainer = function() {
            this._chartContainer = this._parent.selectAll(".dv-chart-container").data([0]), this._chartContainer.enter().append("div").classed("dv-chart-container", !0), this._svgContainer = this._chartContainer.selectAll("svg").data([0]), this._svgContainer.enter().append("svg").style("height", "100%").style("width", "100%"), this._g = this._svgContainer.select(".group"), this._g.empty() && (this._firstRender = !0, this._g = this._svgContainer.append("g").classed("group", !0), this._panelContainer = this._g.append("g").classed("panels", !0), this._interactionGroup = this._g.append("g").classed("interaction-group", !0), this._g.append("g").classed("behavior-under-geom", !0), this._g.append("g").classed("plot", !0), this._g.append("g").classed("behavior", !0), this._g.append("g").classed("legends", !0), this._interactionGroup.append("rect").classed("interaction-canvas", !0).classed("background", !0)), this._panelContainer || (this._panelContainer = this._g.select(".panels")), this._interactionGroup || (this._interactionGroup = this._g.select(".interaction-group")), this._axisLabelContainer = this._chartContainer.selectAll(".axes-labels").data([0]), this._axisLabelContainer.enter().append("div").classed("axes-labels", !0)
        }, e._addRegisteredEvents = function() {
            var e = this;
            dv.util.each(e.eventMap, function(t, n) {
                e._interactionGroup.on(n, function() {
                    var t = d3.event, r = e._interactionGroup.node();
                    e._shouldDispatchChartEvent(t, r) && e.eventMap[n].callback.call(e._interactionGroup.node(), d3.event)
                }, t.capture)
            }), dv.util.each(e._layers, function(e) {
                e._addRegisteredEvents()
            })
        }, e._removeRegisteredEvents = function() {
            var e = this;
            dv.util.each(e.unregisterEventMap, function(t, n) {
                e._interactionGroup && e._interactionGroup.on(n, null, t)
            }), dv.util.each(e._layers, function(e) {
                e._removeRegisteredEvents()
            })
        }, e._shouldDispatchChartEvent = function(e, t) {
            var n = !0;
            if (e.type === "mouseout" || e.type === "mouseover") {
                var r = d3.select(e.relatedTarget);
                if (r && !r.empty()) {
                    var i = r.attr("class");
                    n = !(i && i.indexOf("-geom") >= 0)
                }
            }
            return n
        }, e._calculateStats = function() {
        }, e._renderLegends = function() {
            var e = dv.util.isFinite(this._calcWidth) ? this._calcWidth - this._padding.left - this._padding.right : this._calcPlotWidth, t = dv.util.isFinite(this._calcHeight) ? this._calcHeight - this._padding.top - this._padding.bottom : this._calcPlotHeight, n = {left: this._padding.left,top: this._padding.top,width: e,height: t}, r = {el: this._g,scales: this._facet._globalScales,firstRender: this._firstRender,duration: this._duration,delay: this._delay,ease: this._ease};
            this._legends._allowedDimensions(n)._render(r), this._finalizePlotBounds()
        }, e._cleanupGuides = function() {
            this._legends._empty(), this._axes._empty()
        }, e._setRanges = function() {
            var e = this.plotBounds(), t = this.getTrainedScale("y"), n = this.getTrainedScale("x"), r = this.coord().flip() ? [e.bottom - e.top, 0] : [0, e.right - e.left], i = this.coord().flip() ? [0, e.right - e.left] : [e.bottom - e.top, 0];
            dv.util.scaleRange(n, r), dv.util.scaleRange(t, i)
        }, e.plotBounds = function(e) {
            return arguments.length ? (this._plotBounds = e, this) : this._plotBounds
        }, e._renderBehaviors = function() {
            var e = this._facet.getPanel(0), t = e._bounds, n = this._g.select(".behavior").attr("transform", "translate(0,0)"), r = this._g.select(".behavior-under-geom").attr("transform", "translate(0, 0)");
            this._interactionGroup.attr("transform", "translate(0,0)").select(".interaction-canvas").attr("visibility", "hidden").attr("width", t.right - t.left).attr("height", t.bottom - t.top).attr("x", t.left).attr("y", t.top);
            var i = this;
            dv.util.each(this._behaviors, function(e) {
                e.underGeoms && e.underGeoms() ? e.chart(i)._render(r) : e.chart(i)._render(n)
            })
        }, e.guide = function(e, t, n) {
            if (!e || e === "")
                throw new Error("Property argument cannot be null or empty");
            if (e === "all") {
                if (t !== "none")
                    throw new Error("'all' can only be used to set all guides to 'none' (e.g. turn off all guides)");
                this._legends._hide(!0), this._axes._add("x", "none", 0), this._axes._add("y", "none", 0)
            }
            e = dv.util.isArray(e) ? e : [e], n = dv.util.isUndefined(n) ? 0 : n;
            var r = dv.guide.legend(), i = "";
            for (var s = 0; s < e.length; s++) {
                var o = t, u = this._isPositionProperty(e[s]);
                if (!i)
                    i = u ? "axis" : "legend";
                else if (u && i != "axis")
                    throw new Error("Cannot mix positional and non-positional guide types");
                o ? !this._isValidGuideType(e[s], o) && dv.util.isObject(o) && (o = this._buildCustomGuide(o)) : o = u ? dv.guide.axis() : r;
                if (this._isValidGuideType(e[s], o)) {
                    o !== "none" && o.scaleIndex(n);
                    if (u)
                        this._axes._add(e[s], o, n);
                    else {
                        if (o !== "none") {
                            this._legends._add({props: e,guide: o});
                            break
                        }
                        this._legends._remove(e)
                    }
                }
            }
            return this
        }, e._isPositionProperty = function(e) {
            return e === "x" || e === "y"
        }, e._isValidGuideType = function(e, t) {
            var n = this._isPositionProperty(e);
            return t && (t === "none" || t instanceof dv.guide.custom) || n && t instanceof dv.guide.axis || !n && t instanceof dv.guide.legend
        }, e._buildCustomGuide = function(e) {
            var t = dv.guide.custom();
            for (var n in e)
                t.setFunc(n, e[n]);
            return t
        }, e.getScale = function(e, t) {
            arguments.length < 2 && (t = 0);
            if (e === "group")
                return this._getGroup();
            if (this._aes.hasOwnProperty(e))
                return this._aes[e][t]
        }, e._getGroup = function() {
            if (this._aes.hasOwnProperty("group"))
                return this._aes.group[0];
            var e = -1, t = dv.DEFAULT_CATEGORICAL_AES.length - 1;
            while (e++ < t) {
                var n = this._aes[dv.DEFAULT_CATEGORICAL_AES[e]];
                if (n && n[0] && n[0] instanceof dv.scale.ordinal && !dv.util.isUndefined(n[0].mapping()))
                    return n[0]
            }
            return null
        }, e._clipGeoms = function() {
            var e = this, t = this._parent.selectAll(".panel").selectAll("defs").data(function(t) {
                return e._clipPlot ? [t] : []
            });
            t.enter().append("defs"), t.exit().remove();
            var n = t.selectAll("clipPath").data(function(e) {
                return [e]
            });
            n.enter().append("clipPath").classed("dv-clip", !0), n.exit().remove(), n.attr("id", function(e) {
                return "dv-clip" + e._facetIndex
            });
            var r = n.selectAll("rect").data(function(e) {
                return [e]
            });
            r.enter().append("rect"), r.exit().remove(), r.attr("x", function(e) {
                return e._bounds.left
            }).attr("y", function(e) {
                return e._bounds.top
            }).attr("width", function(e) {
                return e._bounds.width
            }).attr("height", function(e) {
                return e._bounds.height
            });
            if (e._clipPlot) {
                var i = this._parent.selectAll(".series");
                i.attr("clip-path", function(e) {
                    var t = e.values[0], n = dv.util.isArray(t) ? t[0].panel : t.panel;
                    return "url(#dv-clip" + n._facetIndex + ")"
                })
            }
        }, e.getTrainedScale = function(e) {
            return this._facet.getTrainedScale(e)
        }, e.getExplicitScale = function(e, t) {
            return t === undefined && (t = 0), this._aes[e][t]
        }, e.parent = function(e) {
            if (!arguments.length)
                return this._parent ? this._parent.node() : null;
            this._parent = d3.select(e);
            if (this._parent.empty())
                throw new Error("The DV parent element was not found.");
            return this
        }, e.layers = function(e) {
            return arguments.length ? (this._layers = e, this) : this._layers
        }, e.behaviors = function(e) {
            return arguments.length ? (this._behaviors = e, this) : this._behaviors
        }, e.data = function(e) {
            return arguments.length ? (this._data = e, this) : this._data
        }, e.coord = function(e) {
            return arguments.length ? (this._coord = e, this) : this._coord
        }, e.facet = function(e) {
            return arguments.length ? (this._facet = e, this._facet.chart(this), this) : this._facet
        }, e.getPlotBounds = function(e) {
            return this._plotBounds
        }, e.plotWidth = function(e) {
            return arguments.length ? (this._plotWidth = e, this) : this._plotWidth
        }, e.plotHeight = function(e) {
            return arguments.length ? (this._plotHeight = e, this) : this._plotHeight
        }, e.width = function(e) {
            return arguments.length ? (this._width = e, this) : this._width
        }, e.height = function(e) {
            return arguments.length ? (this._height = e, this) : this._height
        }, e.padding = function(e) {
            return arguments.length ? (this._padding = dv.util.merge(this._defaultPadding, e), this) : this._padding
        }, e.prerender = function(e) {
            return arguments.length ? (this._prerenderFunc = e, this) : this._prerenderFunc
        }, e.postrender = function(e) {
            return arguments.length ? (this._postrenderFunc = e, this) : this._postrenderFunc
        }, e.clipPlot = function(e) {
            return arguments.length ? (this._clipPlot = e, this) : this._clipPlot
        }, e
    })
}(), define("dv", function() {
}), function(e) {
    var t = {}, n = e.dv || {}, r = e.d3 || {}, i = {};
    i._options = null, i._eventMap = {}, i._changedOptions = null, i.init = function(e) {
        return this._initDefaultOptions(), this.setOptions(e), this
    }, i._initDefaultOptions = function(e) {
        var t = {dataAdapter: "standard",data: null,height: null,parent: null,width: null,autoResize: !1,locale: "en-US",l10n: {}};
        e && this._mergeOptions(t, e), this._options = t, this._changedOptions = {};
        for (var n in t)
            this._changedOptions[n] = t[n];
        return this._options
    }, i._mergeOption = function(e, t, n) {
        switch (t) {
            case "mappings":
            case "formats":
                e[t] = e[t] || {}, this._mergeOptions(e[t], n);
                break;
            default:
                e[t] = n
        }
        return e
    }, i._mergeOptions = function(e, t) {
        for (var n in t)
            this._mergeOption(e, n, t[n]);
        return e
    }, i._truncateLabel = function(e, t) {
        var n = t || this.X_AXIS_LABEL_MAXLENGTH;
        return e.length > n ? e.substring(0, n) + "..." : e
    }, i._formatNumber = function(e, t, n) {
        var i = "", s, o, u = this._dataAdapter.l10n.numberFormat, a, f, l;
        e == "currency" || e == "percent" ? (i = u[e].symbol, t >= 0 ? a = u[e].positivePattern : a = u[e].negativePattern) : t >= 0 ? a = "{number}" : a = u.negativePattern, e == "percent" && (t *= 100), t = Math.abs(t), t >= 100 ? l = 3 : t >= 10 ? l = t % 1 ? 3 : 2 : t >= 1 ? l = t % 1 ? 3 : 1 : l = t % 1 ? 2 : 1;
        if (n != null) {
            var c = r.formatPrefix(t);
            f = c.scale(t).toFixed(n) + c.symbol
        } else
            t >= 1e3 && t < 1e4 ? f = r.format(",.0f")(t) : f = r.format("." + l + "s")(t);
        return n && t < Math.pow(10, -n) && t > 0 ? (o = !0, f = Math.pow(10, -n) + "") : n == null && t < .01 && t > 0 && (o = !0, f = "0.01"), s = a.replace(/\{number\}/i, f).replace(/\{symbol\}/i, i).replace(/,/g, u.groupSeparator).replace(/\./, u.decimalSeparator), o && (s = "<" + s), s
    }, i._getPropMapping = function(e) {
        return this._dataAdapter.mappings()[e]
    }, i.setOption = function(e, t) {
        return e in this._options ? ("dataAdapter" === e && "rs2dv" === t && (t = "rs"), "clickHandler" === e && this.on("click", t), this._mergeOption(this._options, e, t), this._changedOptions || (this._changedOptions = {}), this._changedOptions[e] = t, !0) : !1
    }, i.getOption = function(e) {
        var t = this._options;
        return e in t ? t[e] : null
    }, i.setOptions = function(e) {
        for (var t in e)
            this.setOption(t, e[t])
    }, i._preRender = function() {
        this._clearErrorMessage(), "autoResize" in this._changedOptions && this._updateWindowResize();
        if ("dataAdapter" in this._changedOptions) {
            var e = this._changedOptions.dataAdapter;
            if (!this._dataAdapter || this._options.dataAdapter !== e) {
                var n = t.dataAdapter[e];
                if (!n)
                    throw new Error("No data adapters were found for data adapter type " + e);
                var r = n[this._type] || n.base || t.dataAdapter.standard.base;
                this._dataAdapter = r()
            }
        }
        this._dataAdapter.process(this._options, this._changedOptions)
    }, i._render = function() {
    }, i._postRender = function() {
        this._changedOptions = {}
    }, i.render = function() {
        return this.reset(), this._preRender(), this._render(), this._postRender(), this
    }, i.reset = function() {
    }, i._updateWindowResize = function() {
        this._options.autoResize ? (this._autoResizeHandler = this._autoResizeHandler || n.util.bind(this._onAutoResize, this), t.windowResize.addHandler(this._autoResizeHandler)) : t.windowResize.removeHandler(this._autoResizeHandler)
    }, i._onAutoResize = function() {
    }, i.RESPONSIVE_WIDTH_THRESHOLD = 400, i._isSmallChart = function(e) {
        return e < i.RESPONSIVE_WIDTH_THRESHOLD
    }, i.handleError = function(e) {
        var t = this._dataAdapter.l10n, n = t.labels.core.erroronrender;
        return "invaliddata" === e.code && (n = t.labels.core.nodata), this._setErrorMessage(n), this
    }, i._setErrorMessage = function(e) {
        e && e.length ? r.select(this._options.parent).html('<div class="cv-error">' + e + "</div>") : this._clearErrorMessage()
    }, i._clearErrorMessage = function() {
        r.select(this._options.parent).select(".cv-error").remove()
    }, i.destroy = function() {
        this.reset(), t.windowResize.removeHandler(this._autoResizeHandler)
    }, i.on = function(e, t) {
        var r = t && n.util.isFunction(t);
        return r ? (this._eventMap = this._eventMap || {}, this._eventMap[e] = t) : this._eventMap && delete this._eventMap[e], this
    }, e.cloudViz = t, t.d3 = r, t.dv = n, t.rs2dv = e.rs2dv || {}, t.core = i, t.localeDefinition = function(e, n, r) {
        var i, s, o, u;
        e = e.toLowerCase(), t._localeDefinitions = i = t._localeDefinitions || {};
        if (!(arguments.length > 1)) {
            u = i[e];
            if (!u)
                throw new Error("Locale definition for " + e + " not found.");
            return u
        }
        s = e.split("-");
        if (s.length <= 1)
            throw new Error("A registered CloudViz locale must be a hyphenated language culture code (e.g. en-US).");
        o = [e, s[0], s.join("_")], o.forEach(function(t) {
            r == null ? i[t] = n : (i[t] = i[e] || {}, i[t][r] = n)
        })
    }, "function" == typeof define && define.amd ? define("cloudViz", [], function() {
        return t
    }) : "undefined" == typeof exports ? e.cloudViz = t : "object" != typeof module || !module.exports ? exports.cloudViz = t : module.exports = t
}(this), function(e) {
    e.cloudViz.seriesState = function() {
        var e = {}, t = [], n = {};
        return e.isSeriesEnabled = function(e, n) {
            if (!t)
                return !0;
            var r, i = t.length, s;
            for (r = 0; r < i; r++) {
                s = t[r];
                if (s.id === e && s.type === n)
                    return s.enabled
            }
            return !1
        }, e.doesSeriesStateExist = function(e, n) {
            if (!t)
                return !1;
            var r, i = t.length, s;
            for (r = 0; r < i; r++) {
                s = t[r];
                if (s.id === e && s.type === n)
                    return !0
            }
            return !1
        }, e._createStateObject = function(e, t, n, r) {
            var i;
            if (arguments.length < 3)
                throw new Error("A state object requires a label and stateType.");
            return arguments.length < 4 && (r = !0), i = {name: e,id: t,type: n,enabled: r}, this.dispatch("create", i), i
        }, e.insertState = function(e, n, r, i) {
            t.unshift(this._createStateObject.apply(this, arguments))
        }, e.appendState = function(e, n, r, i) {
            t.push(this._createStateObject.apply(this, arguments))
        }, e.enableStateByIndex = function(e, n) {
            if (e < t.length) {
                var r = t[e];
                r.enabled !== n && (r.enabled = n, this.dispatch("enableChange", r))
            }
        }, e.enableStateByTypeAndId = function(e, n, r) {
            var i, s = t.length, o;
            for (i = 0; i < s; i++)
                o = t[i], o.id === n && o.type === e && this.enableStateByIndex(i, r)
        }, e.removeStatesByType = function(e) {
            var n = this;
            t && t.length && (t = t.filter(function(t) {
                return t.type === e ? (n.dispatch("remove", t), !1) : !0
            }))
        }, e.on = function(e, t) {
            if (arguments.length < 1)
                throw new Error("series state listeners require an eventType to be specified.");
            var r = e.indexOf("."), i = "", s;
            r > 0 && (i = e.substring(r + 1), e = e.substring(0, r)), s = n[e] || {}, t ? (s[i] = t, n[e] = s) : delete s[i]
        }, e.dispatch = function(e, t) {
            var r = n[e];
            if (r)
                for (var i in r)
                    r[i].call(this, e, t)
        }, e.getStateObjects = function() {
            return t
        }, e.areSomeSeriesDisabled = function() {
            return t ? Math.min.apply(null, t.map(function(e) {
                return +e.enabled
            })) === 0 : !1
        }, e.areAllSeriesDisabled = function() {
            return t ? Math.max.apply(null, t.map(function(e) {
                return +e.enabled
            })) === 0 : !1
        }, e
    }
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.util = t.util || {};
    n.deepExtend = function(e) {
        var t = Array.prototype.slice.call(arguments, 1), r = -1, i = t.length;
        while (++r < i) {
            var s = t[r];
            if (s)
                for (var o in s)
                    s[o] && s[o].constructor && s[o].constructor === Object ? (e[o] = e[o] || {}, n.deepExtend(e[o], s[o])) : e[o] = s[o]
        }
        return e
    }, n.createConstructor = function(e) {
        function t() {
            var t = Object.create(e);
            return "function" == typeof t.init && t.init.apply(t, arguments), t
        }
        return t.prototype = e, t
    }, n.namespace = function(t, n) {
        var r = t.split("."), i = n || e;
        return r.forEach(function(e) {
            var t = i[e];
            t || (t = i[e] = {}), i = t
        }), i
    }
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.X_AXIS_LABEL_MAXLENGTH = 25, s.LEGEND_ORIENTATIONS = ["top", "right", "left"], s._chart = null, s.clipIdCounter = {count: 0}, s._legend = null, s._seriesState = null, s.init = function(e) {
        return Object.getPrototypeOf(s).init.apply(this, arguments), this._seriesState = t.seriesState(), this
    }, s._initDefaultOptions = function(e) {
        var t = {aspectRatio: null,colors: ["#8cc350", "#5a6eaa", "#d755a5", "#1ebed7", "#f0a01e", "#9b8ce6", "#3cb5a0", "#3287d2", "#f0557d", "#c3d250", "#eb782d", "#78b4f5", "#5faf69", "#aa5fa5", "#fa5a50", "#f5c841"],dateGranularity: undefined,flip: !1,interactive: !1,legendOrientation: null,legendVerticalWidth: 110,legendVisible: !0,targetValues: null,targetLabel: undefined,mappings: {x: "x",y: "y",series: "series",seriesLabel: "series"},plotHeight: null,plotWidth: null,preRender: null,xAxisTitle: "",yAxisTitle: "",precision: null};
        return e && this._mergeOptions(t, e), Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s.getChart = function() {
        return this._chart
    }, s.enableSeriesByIndex = function(e, t) {
        this._seriesState.enableStateByIndex(e, t)
    }, s._highlight = function(e, t) {
        e.classed("cv-highlight", t)
    }, s._getYTitleFromLabels = function(e) {
        var t = r.util.uniq(e);
        return t && t.length === 1 ? t[0] : null
    }, s._preRender = function() {
        Object.getPrototypeOf(s)._preRender.call(this);
        try {
            this._createSeriesStates()
        } catch (e) {
            var t = new Error("The chart data is invalid");
            t.code = "invaliddata", this.handleError(t)
        }
    }, s._postRender = function() {
        Object.getPrototypeOf(s)._postRender.call(this);
        var e = this._options, t = i.select(e.parent);
        this._updateYAxisHitBox(t), this._colorDualYAxes(e, t)
    }, s._removeYAxisHitBox = function(e) {
        e.selectAll(".axis-y .cv-axis-hitbox").remove()
    }, s._colorDualYAxes = function(e, t) {
        e.dualYAxis && (!this._isNormalized || !this._isNormalized()) && (this._options.position === "identity" || this._options.position === "dodge") && (t.selectAll(".axis-y.axis-index-0 span").style("color", e.colors[0]), t.selectAll(".axis-y.axis-index-1 span").style("color", e.colors[1]), t.selectAll(".axis-title-y.axis-title-index-0").style("color", e.colors[0]), t.selectAll(".axis-title-y.axis-title-index-1").style("color", e.colors[1]))
    }, s._createSeriesStates = function() {
        var e = this._options;
        if ("data" in this._changedOptions && this._changedOptions.data) {
            this._seriesState.removeStatesByType("standard");
            var t = this._dataAdapter.data()[this._getPropMapping("series")], n = this._dataAdapter.data()[this._getPropMapping("seriesLabel")];
            if (t) {
                var r = t.reduce(function(e, t, r) {
                    return e.ids.indexOf(t) < 0 && (e.ids.push(t), e.names.push(n ? n[r] : t)), e
                }, {names: [],ids: []}), i = r.ids.length;
                while (i--) {
                    var s = r.names[i], o = r.ids[i];
                    this._seriesState.insertState(s || o, o, "standard")
                }
            }
        }
        "targetValues" in this._changedOptions && e.targetValues && (this._seriesState.removeStatesByType("target"), this._seriesState.appendState(e.targetLabel || this._dataAdapter.l10n.labels.dvcore.target, "target", "target"))
    }, s._createTargetHLines = function() {
        var e = this._options, t = this._chart, n = this;
        if (e.targetValues && e.targetValues.length) {
            var s = t.layers(), o = r.geom.hline(), u = n._seriesState.isSeriesEnabled("target", "target"), a = {y: [],name: []}, f, l = e.targetValues.length, c = [0, this._isSmallChart() ? 24 : 6];
            for (f = 0; f < l; f++)
                a.y.push(e.targetValues[f]);
            o.data(a).position("identity").map("y", "y", r.scale.linear().includeInDomain(function() {
                return n._valuesAreFilterable() ? u : !0
            }).rangePadding(c)).each("start", function(e, t) {
                i.select(this).attr("legend-type", "target")
            }), this._type === "line" ? s.unshift(o) : s.push(o), t.layers(s)
        }
    }, s._updateYAxisHitBox = function(e) {
        var t = this, n = this._options, r = this._chart.facet().getPanel(0);
        if (r) {
            var i = this._isSmallChart(), s = this._isNormalized && this._isNormalized(), o = this._chart.getTrainedScale("y"), u = o && o.naturalDomain()[0] <= 0, a = r.bounds().left, f = o.range()[1], l = o.range()[0], c = e.selectAll(".axes-labels .axis-y.axis-index-0"), h = c.selectAll(".cv-axis-hitbox").data([0]);
            n.interactive && !i && !s && !u && n.position === "identity" ? (h.enter().append("div").classed("cv-axis-hitbox", !0), h.on("click", function() {
                n.interactive && !i && (t._dataAdapter._forceZero = !t._dataAdapter._forceZero, t._render(!0), t._postRender())
            }), this._legend !== "none" && this._legend.isVertical() && (a -= this._legend._getUsedWidth()), h.style("width", a + "px").style("height", l - f + "px").style("top", f + "px").style("left", -a + "px"), h.exit().on("click", null)) : this._removeYAxisHitBox(e)
        } else
            this._removeYAxisHitBox(e)
    }, s._render = function(e) {
        Object.getPrototypeOf(s)._render.apply(this, arguments);
        var t = this._options, n;
        try {
            if (!this._dataAdapter.isDataValid())
                throw n = new Error("The chart data is invalid"), n.code = "invaliddata", n;
            if (!t.parent)
                throw new Error("The chart options did not contain a parent");
            return this._draw(e)
        } catch (r) {
            this.handleError(r)
        }
    }, s.reset = function() {
        Object.getPrototypeOf(s).reset.apply(this, arguments)
    }, s.destroy = function() {
        return Object.getPrototypeOf(s).destroy.apply(this, arguments), this._options && this._options.parent && i.select(this._options.parent).select(".cv-wrapper").remove(), this
    }, s._isMappedAndExistsInData = function(e) {
        var t = this._getPropMapping(e);
        return t && this._options.data[t]
    }, s._setChartCoreOptions = function() {
        var e = this._options, t = this._chart, n = this, r = e.aspectRatio, s = e.width, o = e.height, u = i.select(e.parent);
        t.data(this._dataAdapter.data()).width(r !== null && o !== null ? o * r : s).height(r !== null && s !== null ? s / r : o);
        if (!this._isSmallChart()) {
            var a = {left: 10};
            e.dualYAxis && (a.right = 10), t.padding(a)
        }
        var f = u.selectAll(".cv-wrapper").data([0]);
        f.enter().insert("div", ":first-child").classed("cv-wrapper", !0), f.classed({interactive: e.interactive,"right-overflow": this._adjustClipWidth,"cv-small-chart": this._isSmallChart()}), t.parent(f.node()), this._legend = this._buildLegend(), this._seriesState.on("enableChange.paths", function(e, t) {
            n._preRender(), n._render(!0), n._postRender(), setTimeout(function() {
                n._updatePathStates()
            }, 10)
        })
    }, s._draw = function(e) {
        var t = this._chart, n = this._options, r = e === undefined ? !1 : e;
        if (!t)
            throw new Error("DV Chart was not created");
        return this._setChartCoreOptions(), this._setChartTypeOptions(), this._createTargetHLines(), this._isSmallChart() ? this._drawSmall() : this._drawLarge(), r ? t.duration(1e3) : t.duration(0), this._renderChart(), this
    }, s._drawBackground = function() {
        var e = this._options;
        if (e.interactive) {
            var t = i.select(e.parent).select(".cv-wrapper"), n = t.selectAll(".cv-bg").data([0]);
            n.enter().insert("div", ":first-child").classed("cv-bg", !0);
            var r = this._chart, s = i.select(e.parent).select(".cv-legend"), o = this._legend !== "none" && this._legend.isVertical() || !s[0][0] ? 0 : 1, u = 1, a = r.padding(), f = r.facet().getPanel(r.facet()._panels.length - 1).bounds(), l = r.plotBounds(), c = this._chart._legends && this._chart._legends.hasOwnProperty("_w") ? this._chart._legends._w : 0, h = l.top - o - a.top, p = r._calcWidth - c, d = f.top + f.height - l.top + o + a.top;
            n.style("top", h + "px").style("left", c + "px").style("height", d + u + "px").style("width", p + "px");
            if (this._legend !== "none" && this._legend.isVertical()) {
                var v = 1, m = i.select(e.parent).selectAll(".cv-legend"), g = s[0][0] && m.node().offsetHeight || 0, y = g >= d - v;
                m.style("height", y ? d - v + "px" : null).classed("clipped", y)
            }
        }
    }, s._drawClipping = function() {
        var e = this._chart, t = this._options, n = i.select(e._svgContainer[0][0]), r = n.selectAll("defs").data([0]);
        r.enter().insert("defs", ":first-child");
        var s = "cv-clip" + this.clipIdCounter.count++, o = r.selectAll(".cv-clip").data([0]);
        o.enter().append("clipPath").classed("cv-clip", !0).append("rect"), o.attr("id", s);
        var u = o.selectAll("rect"), a = e.padding(), f = e.facet().getPanel(e.facet()._panels.length - 1).bounds(), l = e.plotBounds(), c = l.left - a.left, h = l.top, p = l.right - c + a.right, d = f.top + f.height - l.top;
        t.interactive && (p -= 1, d -= 1), this._adjustClipHeight && (d += this._adjustClipHeight), this._adjustClipWidth && (p += this._adjustClipWidth), u.attr("x", c).attr("y", h).attr("width", Math.max(p, 0)).attr("height", Math.max(d, 0)), n.selectAll(".geom").attr("clip-path", null), n.selectAll(".geom:not(.no-clip)").attr("clip-path", "url(#" + s + ")")
    }, s._renderChart = function() {
        var e = this, t = this._options;
        "function" == typeof t.preRender && t.preRender(this.getChart()), this._chart.render(), this._drawBackground(), this._drawClipping(), setTimeout(function() {
            e._updatePathStates()
        }, 10)
    }, s._onAutoResize = function() {
        this._draw(!1)
    }, s._setChartTypeOptions = function() {
    }, s._drawSmall = function(e) {
    }, s._drawLarge = function(e) {
    }, s._isSmallChart = function() {
        return Object.getPrototypeOf(s)._isSmallChart.apply(this, [this._getChartWidth()])
    }, s._getChartWidth = function() {
        var e = this._options;
        if (e.plotWidth !== null && !r.util.isPercentString(e.plotWidth))
            return e.plotWidth;
        if (e.width !== null && !r.util.isPercentString(e.width))
            return e.width;
        var t = i.select(e.parent).node().offsetWidth, n = i.select(e.parent).node().offsetHeight;
        return e.plotWidth !== null ? parseInt(e.plotWidth, 10) / 100 * t : e.width !== null ? parseInt(e.width, 10) / 100 * t : e.aspectRatio !== null && n !== null ? n * e.aspectRatio : t
    }, s._getChartHeight = function() {
        var e = this._options;
        if (e.plotHeight !== null && !r.util.isPercentString(e.plotHeight))
            return e.plotWidth;
        if (e.height !== null && !r.util.isPercentString(e.height))
            return e.height;
        var t = i.select(e.parent).node().offsetWidth, n = i.select(e.parent).node().offsetHeight;
        return e.plotHeight !== null ? parseInt(e.plotHeight, 10) / 100 * n : e.height !== null ? parseInt(e.height, 10) / 100 * n : e.aspectRatio !== null && t !== null ? t / e.aspectRatio : n
    }, s._constructScale = function(e, t) {
        var n = t || r.scale.linear(), i = this._options;
        return i.interactive && (n = this._adjustLimits(n)), e === "y" && this._dataAdapter._forceZero && this._applyForceZero(n), n
    }, s._applyForceZero = function(e) {
        return e.lowerLimit(function(e, t) {
            return e < 0 ? e : 0
        }), e.upperLimit(function(e, t) {
            return t > 0 ? t : 0
        }), e
    }, s._adjustLimits = function(e) {
        var t = this, n = this._options;
        return e.includeInDomain(function(e, n) {
            return t._valuesAreFilterable() ? t._seriesState.isSeriesEnabled(e.data[t._legend.mapping()], "standard") : !0
        }), e
    }, s._valuesAreFilterable = function() {
        return this._options.interactive && this._seriesState.areSomeSeriesDisabled() && !this._seriesState.areAllSeriesDisabled()
    }, s._getEnabledValues = function(e) {
        var t = this, n = this._options, r = this._dataAdapter.data()[this._getPropMapping(e)];
        if (!this._valuesAreFilterable())
            return r;
        var i = this._dataAdapter.data()[this._legend.mapping()];
        return r = r.filter(function(e, n) {
            return i[n] && t._seriesState.isSeriesEnabled(i[n], "standard")
        }), r
    }, s._updatePathStates = function() {
        var e = this, t = this._options, n = i.select(t.parent);
        n.selectAll(".series [legend-group]").classed("path-inactive", function() {
            if (!t.interactive)
                return !1;
            var n = i.select(this), r = n.attr("legend-group");
            return e._seriesState.doesSeriesStateExist(r, "standard") ? !e._seriesState.isSeriesEnabled(r, "standard") : n.classed("path-inactive")
        }), t.targetValues && n.selectAll(".series [legend-type]").classed("path-inactive", function() {
            if (!t.interactive)
                return !1;
            var n = i.select(this), r = n.attr("legend-type");
            return e._seriesState.doesSeriesStateExist("target", r) ? !e._seriesState.isSeriesEnabled("target", r) : n.classed("path-inactive")
        })
    }, s._buildLegend = function(e, t) {
        var n = null, r = this._options, s = i.select(r.parent).select(".cv-wrapper"), o = this._getPropMapping(e || "series"), u = this._getPropMapping(t || "seriesLabel");
        if (o && u && o !== u) {
            var a = this._dataAdapter.data(), f = a[o], l = a[u] || f;
            n = [], f.forEach(function(e, t, r) {
                r.indexOf(e) === t && n.push(l[t])
            })
        }
        return r.legendVisible ? r.interactive ? this._buildInteractiveLegend(n) : this._buildStandardLegend(n) : (s.selectAll(".cv-legend").remove(), s.selectAll(".cv-bg").remove(), "none")
    }, s._buildStandardLegend = function(e) {
        var t = this._options, n = i.select(t.parent).select(".cv-wrapper");
        this._legend = null, n.selectAll(".cv-legend").remove(), n.selectAll(".cv-bg").remove();
        var s, o = this.LEGEND_ORIENTATIONS.indexOf(t.legendOrientation) > -1 ? t.legendOrientation : "top";
        switch (this._calculatedLegendOrientation) {
            case "top":
            case "bottom":
                s = {top: 5,bottom: 5,left: 0,right: 0};
                break;
            case "left":
            case "right":
                s = {top: 0,bottom: 0,left: 5,right: 5}
        }
        var u = r.guide.legend().orientation(o).padding(s);
        return e && u.labels(e), this._isSmallChart() && u.hGap(10).vGap(2), u
    }, s._buildInteractiveLegend = function(e) {
        var n = this._options, r = this, s = i.select(n.parent).select(".cv-wrapper");
        this._legend || (this._legend = t.interactiveLegend());
        var o = this._dataAdapter.data()[this._getPropMapping("series")], u = o.some(function(e, t, n) {
            return e !== n[t - 1]
        });
        return u ? (this._legend.parent(s.node()).orientation(n.legendOrientation).chartWidth(this._getChartWidth()).chartHeight(this._getChartHeight()).chartPadding(this._chart.padding()).validOrientations(this.LEGEND_ORIENTATIONS).legendVerticalWidth(n.legendVerticalWidth).type(this._type).seriesState(this._seriesState), e && this._getCategoryTotal && this._legend.totals(e.map(function(e) {
            return this._getCategoryTotal(e)
        })), this._legend) : (this._legend.remove(), s.selectAll(".path-inactive").classed("path-inactive", !1), "none")
    }, s._numXTicks = function() {
        return function(e) {
            return Math.max(e / 120, 2)
        }
    }, s._yTitleFormat = function(e, t) {
        var n = this._dataAdapter, i = n.yAxisTitle(), s = n.l10n, o = this._getYFormatType(e), u, a;
        return "time" === o && (t || (t = this._getEnabledValues("y")), u = this._yTimeGranularity(t, r.guide.axis().ticks()()), u = s.time.plural[u.gran], a = i ? s.labels.dvcore.yAxisTimeWithTitle : s.labels.dvcore.yAxisTimeNoTitle, i = a.replace(/\{time\}/i, u).replace(/\{title\}/i, i)), i
    }, s._formatYValue = function(e, t, n, r) {
        return n && n.divisor > 0 && (e /= n.divisor), this._formatNumber(t, e, r)
    }, s._getYFormatType = function(e) {
        var t = this._dataAdapter.formats().y;
        return t ? r.util.isArray(t) ? t[e] ? t[e] : "decimal" : t : "decimal"
    }, s._yLabelFormat = function(e) {
        var t = this._getYFormatType(e), n = this._dataAdapter, r = this._options, i = this;
        return function(e, s) {
            var o, u, a = n.l10n.time;
            return "time" === t && (u = n.getTimeGranularity(e, !0), a = 1 !== +e ? a.plural : a.singular), o = i._formatYValue(e, t, u, r.precision), u && u.gran && (o += " " + a[u.gran]), o
        }
    }, s._yTickFormat = function(e, t) {
        var n = this, i = this._getYFormatType(e), s = this._options, o;
        return "time" === i && (t || (t = this._getEnabledValues("y")), o = n._yTimeGranularity(t, r.guide.axis().ticks()())), function(e, t) {
            return e ? n._formatYValue(e, i, o, s.precision) : ""
        }
    }, s._yTimeGranularity = function(e, t) {
        e = e && e.filter(function(e) {
            return isFinite(e)
        }) || [], t = t || 1;
        if (!e.length)
            return null;
        var n = Math.max.apply(null, e), r = Math.min.apply(null, e), s = i.scale.linear().domain([r, n]).ticks(t), o = s.length ? s.length > 1 ? s[1] - s[0] : n - s[0] : n, u = s.length ? o / s.length : o;
        return this._dataAdapter.getTimeGranularity(u)
    }, s._xTickAnchor = function(e) {
        return function(t, n, i) {
            var s = e.getTrainedScale("x"), o = r.util.scaleRange(s), u = 20, a = s.mapValue(t) + s.rangeBand() / 2;
            return a - o[0] < u ? "start" : o[1] - a < u ? "end" : "middle"
        }
    }, s._checkNormalized = function() {
        var e = this._chart, t = this._dataAdapter.l10n;
        this._isNormalized && this._isNormalized() && (e.guide("y", "none", 1), e.guide("y", r.guide.axis().ticks(0).tickFormat(function(e, t) {
            return ""
        }).title(t.labels.core.normalized)), e.padding({}))
    }, s._formatTime = function(e, t, n) {
        var r = this._dataAdapter.l10n.calendar, s = {a: function(e) {
                return r.weekdayAbbreviations[e.getDay()]
            },A: function(e) {
                return r.weekdays[e.getDay()]
            },b: function(e) {
                return r.monthAbbreviations[e.getMonth()]
            },B: function(e) {
                return r.months[e.getMonth()]
            },p: function(e) {
                return r.ampm[Math.floor(e.getHours() / 12)]
            }}, o = "", u = -1, a = 0, f = t.length, l = function() {
            var n = t.substring(a, u);
            n.length && (o += i.time.format(n)(e))
        };
        while (++u < f)
            if (t.charCodeAt(u) == 37) {
                var c = t.charAt(u + 1), h = s[c];
                h && (l(), o += h(e), u++, a = u + 1)
            }
        return l(), "hour" === n && 0 === o.indexOf("0") && (o = o.slice(1)), o
    }, s._timeGranTemplate = function(e, t) {
        var n;
        switch (e) {
            case "hour":
                n = t.hour;
                break;
            case "day":
                n = t.day;
                break;
            case "week":
                n = t.week;
                break;
            case "month":
                n = t.month;
                break;
            case "quarter":
                n = t.quarter;
                break;
            case "year":
                n = t.year;
                break;
            default:
                n = t.fallback
        }
        return n
    }, s._timeSmallXFormat = function() {
        var e = this, t = e._dataAdapter, n = t.l10n.dateFormat.fullFormat;
        return function(t, r) {
            return e._formatTime(t, n.condensed)
        }
    }, s._timeXTickFormat = function(e) {
        var t = this, n = t._options, r = this._chart, i = t._dataAdapter, s = new Date(0), o = "", u = "", a = i.l10n.dateFormat, f = a.mediumFormat, l = i ? i.dateGranularity() : "*", c = this._timeGranTemplate(l, a.shortFormat);
        return function(n, r) {
            var i, a, h, p;
            return 0 === r && (s = new Date(0), o = null, u = null), e && !e.call(this, n, r) ? "" : ("hour" === l && s.getDate() !== n.getDate() && (i = f.day), ("day" === l || "week" === l) && s.getMonth() !== n.getMonth() && (i = f.month), ("month" === l || "quarter" === l) && s.getYear() !== n.getYear() && (i = f.year), s = n, a = t._formatTime(n, c, l), i ? h = "<br/>" + t._formatTime(n, i) : h = "<br/>&nbsp;", a !== o || h !== u && !!i ? p = h ? a + h : a : p = "", o = a, u = h, p)
        }
    }, e.cloudViz.dvcore = s
}(this), function(e) {
    var t, n = [], r = function(e, t) {
        var n = -1;
        return function() {
            n > -1 && window.clearTimeout(n), n = window.setTimeout(e, t)
        }
    }, i = r(function() {
        n.forEach(function(e) {
            e()
        })
    }, 30), s = function(e) {
        n.indexOf(e) == -1 && n.push(e), t || (window.addEventListener("resize", i), t = !0)
    }, o = function(e) {
        var r = n.indexOf(e);
        r > -1 && n.splice(r, 1), n.length === 0 && t && (window.removeEventListener("resize", i), t = !1)
    };
    e.cloudViz.windowResize = {addHandler: s,removeHandler: o}
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.dvcore || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n), o = -1;
    s.init = function(e) {
        return Object.getPrototypeOf(s).init.apply(this, arguments), this._type = "line", this._chart = r.chart(), this._displayPoints = null, this._adjustClipHeight = 6, this._adjustClipWidth = 6, this._minTrendTickSpace = 135, this._showRibbons = !1, this._uniqueGroups = null, this
    }, s._initDefaultOptions = function() {
        var e = {normalized: !1,filled: !1,position: "identity",forceZero: null,dualYAxis: !1,showAnomalies: !1,mappings: {upperRangeBand: "upper",lowerRangeBand: "lower",forecast: "forecast"},formats: {x: "decimal",y: "decimal"}};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, e)
    }, s.reset = function() {
        Object.getPrototypeOf(s).reset.apply(this, arguments);
        var e = this._options, t = i.select(e.parent);
        t.selectAll(".behavior").text(""), t.selectAll(".behavior-under-geom").text(""), this._chart.on("mousemove.inspector", null), this._chart.on("mouseout.inspector", null), t.selectAll(".axis-y.axis-index-1").remove()
    }, s._setChartTypeOptions = function() {
        var e = this._chart, t = this._options, n = this, s = [r.geom.line().each("start", function(e, t) {
                i.select(this).attr("legend-group", e[0].stroke)
            }).map("stroke", this._getPropMapping("series"), r.scale.color().values(t.colors))];
        this._uniqueGroups = r.util.uniq(e.data()[this._getPropMapping("series")]), this._showRibbons = this._uniqueGroups.length == 1 && this._isMappedAndExistsInData("upperRangeBand") && this._isMappedAndExistsInData("lowerRangeBand"), this._showRibbons && (s.unshift(r.geom.ribbon().map("yMin", this._getPropMapping("lowerRangeBand")).map("yMax", this._getPropMapping("upperRangeBand")).set("alpha", .15).interpolate("cardinal")), t.filled = !1), this._showRibbons && this._isMappedAndExistsInData("forecast") && s.push(r.geom.line().map("y", this._getPropMapping("forecast")).set("alpha", .5).set("linetype", "dotted").interpolate("cardinal")), t.filled && s.push(r.geom.area().baseline(undefined).each("start", function(e, t) {
            i.select(this).attr("legend-group", e[0].fill)
        }).map("fill", this._getPropMapping("series"), r.scale.color().values(t.colors)).set("alpha", .2));
        var o = r.geom.point().map("stroke", this._getPropMapping("series"), r.scale.color().values(t.colors)).set("fill", "#fff").set("size", 7);
        s.push(o);
        var u = this._getPropMapping("group") || this._getPropMapping("series");
        e.layers(s).guide("stroke", this._legend).map("group", u).set("linetype", function(e, t, n) {
            return /::incomplete::$/.test(e.data[u]) ? "0,4,7,0" : "solid"
        }).position(t.position), o.each("start", function(e, t) {
            i.select(this).classed("point-hidden", !n._shouldDisplayPoint.call(n, e)).attr("legend-group", e.stroke).classed("line-point", !0)
        }), this._addBehaviors(e, t), this._mapPositionScales(e, t)
    }, s._shouldDisplayPoint = function(e) {
        return this._showRibbons ? this._isAnomalousDataPoint(e) : this._shouldDisplayPoints()
    }, s._shouldDisplayPoints = function() {
        if (this._displayPoints !== null)
            return this._displayPoints;
        var e = this._options, t = this._chart, n = t.layers()[1]._nestData, r = Math.max.apply(null, n.map(function(e) {
            return e.values.length
        })), i = t.getTrainedScale("x").range();
        return this._displayPoints = e.showAnomalies && this._showRibbons || (i[1] - i[0]) / r >= 60
    }, s._isAnomalousDataPoint = function(e) {
        return e.data[this._getPropMapping("y")] > e.data[this._getPropMapping("upperRangeBand")] || e.data[this._getPropMapping("y")] < e.data[this._getPropMapping("lowerRangeBand")]
    }, s._addBehaviors = function(e, t) {
        var n = this, s = i.select(t.parent), o = this._dataAdapter, u = o.formats().x;
        t.interactive && e.behaviors([r.behavior.inspector().gutterPadding(0).orientation("bottom").thickness(2).label(function(e) {
                if (o.isOvertime()) {
                    var r = o.dateGranularity(), i = o.l10n.dateFormat.fullFormat;
                    return n._formatTime(e, n._timeGranTemplate(r, i), r)
                }
                return n._formatNumber(u, e, t.precision)
            }).inspectorMove(function(t, r, o, u) {
                var a = e.getTrainedScale("stroke")[0];
                n._highlightHoveredPoints.call(n, s, u, a), s.selectAll(".axis-x .axis-label").style("opacity", 0), s.selectAll(".axis-x-title").style("opacity", 0), s.selectAll(".text-geom").style("opacity", 0), n._eventMap.mouseover && n._eventMap.mouseover.call(this, t, r, o, u, i.event)
            }).inspectorOut(function() {
                var t = e.getTrainedScale("stroke")[0];
                n._highlightHoveredPoints.call(n, s, null, t), s.selectAll(".axis-x .axis-label").style("opacity", 1), s.selectAll(".axis-x-title").style("opacity", 1), s.selectAll(".text-geom").style("opacity", 1), n._eventMap.mouseout && n._eventMap.mouseout.call(this, i.event)
            }).underGeoms(!0)])
    }, s._highlightHoveredPoints = function(e, t, n) {
        var s = {}, o = this, u = n.domain(), a = this._options;
        e.selectAll(".line-point").each(function(e) {
            var r = i.select(this), a = n.mapValue(e.stroke), f = o._dataValuesEqual.call(o, e.x, t), l = r.datum();
            r.classed("point-hidden", f ? !1 : !o._shouldDisplayPoint.call(o, e)), r.style("fill", f ? a : "#FFF").style("opacity", f ? 1 : ""), f && (s[r.attr("legend-group")] = {yVal: l.y,scaleIndex: u.indexOf(e.stroke)})
        }), e.selectAll(".cv-legend-entry").each(function(e) {
            var t = e.id, n = s[t], u = i.select(this).select(".cv-legend-num");
            if (!n)
                return u.text("");
            var f = o._getYFormatType(n.scaleIndex), l = n.yVal, c;
            if ("time" === f) {
                var h = o._dataAdapter.l10n, p = o._yTimeGranularity(o._dataAdapter.getUniqueStrokeExtentByStroke(t), r.guide.axis().ticks()()), d = h.time.plural[p.gran], v = h.labels.dvcore.legendTime;
                p && p.divisor > 0 && (l /= p.divisor), c = v.replace(/\{time\}/i, d).replace(/\{value\}/i, o._formatNumber(f, l, a.precision))
            } else
                c = o._formatNumber(f, l, a.precision);
            u.text(c)
        })
    }, s._dataValuesEqual = function(e, t) {
        return !e || !t ? !1 : this._dataAdapter.isOvertime() && e.getTime() === t.getTime() ? !0 : e === t
    }, s._mapPositionScales = function(e, t) {
        var n = [0, this._isSmallChart() ? 24 : 6], i = this._constructScale("y").rangePadding(n), s = this._getPropMapping("series"), o = this._getPropMapping("y"), u = this._getPropMapping("x"), a = this;
        a._dataAdapter._forceZero === null && t.filled && (a._dataAdapter._forceZero = !0, this._applyForceZero(i));
        if (t.normalized || t.dualYAxis && (t.position === "identity" || t.position === "dodge")) {
            var f = a._dataAdapter.uniqueStrokeValues();
            f.forEach(function(t, n) {
                var r = 0 === n ? i : i.copy();
                r.includeInDomain(function(e, t) {
                    return e.data[s] === a._dataAdapter.uniqueStrokeValues()[n]
                }), n > 0 && e.map("y", o, r, n)
            })
        } else {
            var l = e.getExplicitScalesMap().y;
            l && delete l[1]
        }
        var c = this._dataAdapter.isOvertime() ? r.scale.time() : r.scale.linear();
        c.rangePadding([10, 10]), e.map("y", o, i, 0), e.map("x", u, this._constructScale("x", c))
    }, s._xTickFormat = function() {
        var e = this, t = this._dataAdapter, n = this._options, r = t.formats().x;
        return function(t, i) {
            return e._formatNumber(r, t, n.precision)
        }
    }, s._drawSmall = function() {
        var e = this._options, t = this._chart, n = this, s = this._computeExtents(), o = i.extent(this._getEnabledValues("x")), u = this._getYFormatType(0), a = function(t, r) {
            return t ? n._formatNumber(u, t, e.precision) : "0"
        }, f = r.guide.axis().tickSize(0).title(this._dataAdapter.xAxisTitle()).tickDy(s.y.length > 1 ? -26 : -14).tickAnchor(function(e, t) {
            return t > 0 ? "end" : "start"
        }), l = r.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()), c = e.dualYAxis || e.position === "stack" && this._uniqueGroups.length > 1;
        if (!c) {
            var h = [r.geom.point().data(s).set("stroke", "none").map("y", "y", r.scale.linear()).map("x", "x", this._dataAdapter.isOvertime() ? r.scale.time() : r.scale.linear()).each("start", function(e, t) {
                    var n = e.panel.getTrainedScale("fill")[0], r = i.select(this);
                    r.style("fill", n.mapValue(e.data.fill)).attr("legend-group", e.data.fill)
                }).map("group", "fill").set("size", 6), r.geom.text().data(s).set("stroke", "none").map("y", "y", r.scale.linear()).map("x", "x", this._dataAdapter.isOvertime() ? r.scale.time() : r.scale.linear()).each("start", function(e, t) {
                    var n = e.panel.getTrainedScale("fill")[0], r = i.select(this);
                    r.style("fill", n.mapValue(e.data.fill)).attr("legend-group", e.data.fill), this.parentNode && i.select(this.parentNode.parentNode).classed("no-clip", !0).attr("clip-path", null)
                }).map("group", "fill").set("size", "11px").set("label", function(e, t, i) {
                    var s = e.panel.getTrainedScale("fill")[0].domain(), o = s.indexOf(e.data.fill), a = n._yTickFormat(o)(e.y);
                    if ("time" === u) {
                        var f = n._yTimeGranularity(n._getEnabledValues("y"), r.guide.axis().ticks()());
                        a += " " + n._dataAdapter.l10n.time.plural[f.gran]
                    }
                    return a
                }).textAnchor(function(e, t) {
                    return e.data && e.data.anchor || "middle"
                }).dy(function(e, t) {
                    return s.y.length === 1 || e.y === s.y[1] ? -8 : 15
                }).dx(function(e, t) {
                    return e.data && e.data.anchor == "end" ? 3 : 0
                })];
            t.layers(t.layers().concat(h))
        }
        t.map("fill", this._getPropMapping("series"), r.scale.color().values(e.colors));
        if (this._dataAdapter.isOvertime())
            f.tickValues(o).tickFormat(n._timeSmallXFormat()), c ? l.tickFormat(this._yTickFormat(0)) : l.tickFormat(function() {
                return ""
            });
        else if (e.dualYAxis) {
            var p = r.guide.axis().tickFormat(this._yTickFormat(1)).orientation("right").tickSize(15).tickDy(-8).tickAnchor("end").tickDx(4).ticks(3);
            l.tickSize(15).tickDy(-8).tickAnchor("start").tickDx(4).ticks(3), t.guide("y", p, 1)
        } else {
            var d = i.extent(this._dataAdapter.data()[this._getPropMapping("x")]);
            f.tickValues(d).tickFormat(this._xTickFormat()), l.tickFormat(this._yTickFormat(0)), t.guide("y", "none", 1)
        }
        t.guide("x", f).guide("y", l), this._checkNormalized()
    }, s._numXTicks = function() {
        var e = this;
        if (this._dataAdapter.isOvertime()) {
            var t = this._chart._data[this._getPropMapping("x")].length;
            return function(n) {
                var r = 0, i = Math.max(n / t, e._minTrendTickSpace);
                return Math.max(Math.min(Math.floor(n / i), t), 2)
            }
        }
        return Object.getPrototypeOf(s)._numXTicks.call(this)
    }, s._drawLarge = function() {
        var e = this._options, t = this._chart, n = i.select(e.parent), s = !1, o = this._dataAdapter.getUniqueStrokeExtent(0), u = this._dataAdapter.getUniqueStrokeExtent(1), a, f = r.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickDy(-8).tickAnchor(this._xTickAnchor(t)), l = r.guide.axis().htmlLabels(!0);
        this._dataAdapter.isOvertime() ? f.tickFormat(this._timeXTickFormat()).htmlLabels(!0) : f.tickFormat(this._xTickFormat());
        if (!e.dualYAxis || e.position !== "identity" && e.position !== "dodge")
            a = this._yTickFormat(0), l.title(this._yTitleFormat(0)), t.guide("y", "none", 1);
        else {
            a = this._yTickFormat(0, o), l.title(this._yTitleFormat(0, o));
            var c = r.guide.axis().tickFormat(this._yTickFormat(1, u)).title(this._yTitleFormat(1, u)).orientation("right").tickSize(15);
            l.tickSize(15), t.guide("y", c, 1)
        }
        l.tickFormat(function(t, n) {
            var o = i.select(this), u = l._scale();
            if (u instanceof r.scale.linear && t > 0 && (n === 0 || n === 1 && s)) {
                if (!(u.mapValue(t) < u.range()[0] - 10 || !e.interactive))
                    return s = !0, o.classed("arrow-container", !1), "";
                o.classed("arrow-container", !0)
            } else
                o.classed("arrow-container", !1);
            return a.call(this, t, n)
        }), t.guide("x", f).guide("y", l), this._checkNormalized()
    }, s._preRender = function() {
        Object.getPrototypeOf(s)._preRender.call(this), this._displayPoints = null
    }, s._computeExtents = function() {
        var e = -1, t = this._options, n = this._getEnabledValues("y"), r = this._getEnabledValues("x"), i = this._getEnabledValues("series"), s = n.length, o = {x: [undefined, undefined],y: [undefined, undefined],fill: [undefined, undefined],anchor: [undefined, undefined]}, u = null, a = null;
        r.forEach(function(e, t) {
            u = u === null || u > e ? e : u, a = a === null || a < e ? e : a
        });
        while (++e < s) {
            var f = n[e], l = r[e], c = i ? i[e] : t.colors[0];
            if (o.y[0] === undefined || f < o.y[0])
                o.y[0] = f, o.x[0] = l, o.fill[0] = c, o.anchor[0] = +l == +u ? "start" : +l == +a ? "end" : "middle";
            if (o.y[1] === undefined || f > o.y[1])
                o.y[1] = f, o.x[1] = l, o.fill[1] = c, o.anchor[1] = +l == +u ? "start" : +l == +a ? "end" : "middle"
        }
        return o.y[0] === 0 && (o.y.splice(0, 1), o.x.splice(0, 1), o.fill.splice(0, 1), o.anchor.splice(0, 1)), o
    }, s._isNormalized = function() {
        var e = this._options, t = this._isSmallChart() ? 1 : 2;
        return e.normalized || e.dualYAxis && this._dataAdapter.uniqueStrokeValues().length > t && (e.position === "identity" || e.position === "dodge")
    }, e.cloudViz.line = t.util.createConstructor(s)
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.dvcore || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        return Object.getPrototypeOf(s).init.apply(this, arguments), this._type = "point", this._chart = r.chart(), this
    }, s.getSelected = function() {
        var e = [], t = i.select(this._options.parent).selectAll(".point-geom.cv-highlight");
        return t.each(function(t) {
            e.push(t)
        }), e
    }, s.setSelected = function(e) {
        var t = this, n = [], r = i.select(this._options.parent).selectAll(".point-geom").filter(e);
        return r.each(function(e) {
            n.push(e)
        }), t._selectPoints(n), t
    }, s._selectPoints = function(e, t) {
        var n = this;
        return !t || !t.accumulate ? !t || e.length !== 0 ? i.select(n._options.parent).selectAll(".point-geom").each(function(t) {
            e.indexOf(t) >= 0 ? n._highlight(i.select(this), !0) : n._highlight(i.select(this), !1)
        }) : t.noneSelected === "selectAll" && n._highlight(i.select(n._options.parent).selectAll(".point-geom"), !0) : t.action === "add" ? i.select(n._options.parent).selectAll(".point-geom").each(function(t) {
            e.indexOf(t) >= 0 && n._highlight(i.select(this), !0)
        }) : t.action === "remove" && i.select(n._options.parent).selectAll(".point-geom").each(function(t) {
            e.indexOf(t) >= 0 && n._highlight(i.select(this), !1)
        }), n
    }, s._initDefaultOptions = function() {
        var e = {mappings: {size: "size"},sizeTitle: "",formats: {x: "decimal",y: "decimal",size: "decimal"},selectionEnabled: !1,selectPolicyCB: function() {
                return {start: null,end: null,move: null}
            },tooltipContent: null};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, e)
    }, s._setChartTypeOptions = function() {
        var e = this._chart, t = this._options, n = [], s = this;
        n[0] = r.geom.point().each("start", function(e, t) {
            i.select(this).attr("legend-group", e.fill)
        }), e.layers(n).map("x", this._getPropMapping("x"), this._constructScale("x").rangePadding([this._isSmallChart() ? 10 : 20, this._isSmallChart() ? 10 : 20])).map("y", this._getPropMapping("y"), this._constructScale("y").rangePadding([this._isSmallChart() ? 10 : 20, this._isSmallChart() ? 10 : 20])).map("fill", this._getPropMapping("series"), r.scale.color().values(t.colors)).guide("fill", this._legend).padding({left: 10}), this._dataAdapter.isBubble() ? n[0].map("size", this._getPropMapping("size"), r.scale.linear().to([9, 60])) : n[0].set("size", 10).set("alpha", .6), this._addBehaviors(e, n[0], t)
    }, s._addBehaviors = function(e, t, n) {
        var s = i.select(n.parent), o, u = this, a = this._getYFormatType(), f = function(e, t, n, r) {
            return e.data.hasOwnProperty(t.mapping()) ? '<span class="metric-value">' + n(e.data[t.mapping()]) + '</span><span class="metric-name">' + r + "</span>" : ""
        }, l = function(e, t, r) {
            var s = [];
            i.select(n.parent).selectAll(".point-geom").each(function(e, n) {
                t[0][0] <= e.x && t[1][0] >= e.x && t[0][1] <= e.y && t[1][1] >= e.y && (u._seriesState.isSeriesEnabled(e.data.group, "standard") || u._seriesState.isSeriesEnabled(e.data[u._getPropMapping("series")], "standard")) && s.push(e)
            });
            var o = u._options.selectPolicyCB.call();
            u._selectPoints(s, o[e]), u._eventMap.selectionStart && e === "start" && u._eventMap.selectionStart.call(u, s), u._eventMap.selectionEnd && e === "end" && u._eventMap.selectionEnd.call(u, s)
        };
        n.selectionEnabled ? e.behaviors([r.behavior.brush().brushStart(l).brushMove(l).brushEnd(l)]) : e.behaviors([]), !this._isSmallChart() && n.interactive && t.behaviors([r.behavior.voronoiRollover().pointDetectionRadius(25).content(function(e, t, r) {
                if (n.tooltipContent)
                    return n.tooltipContent.call(this, e, t, r);
                var i = this.__geom.getExplicitScale("group"), s = e.panel.xScale(e), o = e.panel.yScale(e), l = this._xGuides[s.scaleIndex()], c = this._yGuides[o.scaleIndex()], h = u._dataAdapter.l10n, p = l.__scale && l.tickFormat() ? l.tickFormat() : String, d = function(e) {
                    return u._formatNumber(a, e, n.precision)
                }, v = f(e, o, d, u._dataAdapter.yAxisTitle() || h.labels.point.yScale) + f(e, s, p, u._dataAdapter.xAxisTitle() || h.labels.point.xScale);
                if (u._dataAdapter.isBubble()) {
                    var m = e.panel.getTrainedScale("size")[0];
                    v += f(e, m, String, u._dataAdapter.sizeMetricName() || h.labels.point.sizeScale)
                }
                return i && i.mapping() && (v = '<span class="series-name">' + e.data[i.mapping()] + "</span>" + v), v
            }).mouseOver(function(e, t, n, r) {
                clearTimeout(o), s.selectAll(".point-geom").classed("cv-medium-duration", !1).classed("cv-unselected", function(t) {
                    return e !== t
                }), s.selectAll(".cv-legend-marker").classed("unselected", function(t) {
                    return t !== e.fill
                }).classed("cv-medium-duration", !1), u._eventMap.mouseover && u._eventMap.mouseover.call(this, e, t, n, r)
            }).mouseOut(function(e, t, n, r) {
                o = setTimeout(function() {
                    s.selectAll(".point-geom").classed("cv-unselected", !1).classed("cv-medium-duration", !0), s.selectAll(".cv-legend-marker").classed("unselected", !1).classed("cv-medium-duration", !0), u._eventMap.mouseout && u._eventMap.mouseout.call(this, e, t, n, r)
                }, 400)
            })])
    }, s._drawSmall = function() {
        var e = this._chart, t = i.extent(this._getEnabledValues("x")), n = this, s = this._dataAdapter, o = this._options, u = s.formats().x, a = this._getYFormatType();
        e.guide("x", r.guide.axis().tickSize(0).tickValues(t).title(this._dataAdapter.xAxisTitle()).tickFormat(function(e) {
            return n._formatNumber(u, e, o.precision)
        }).tickAnchor(function(e, t) {
            return t > 0 ? "end" : "start"
        })).guide("y", r.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(e) {
            return e ? n._formatNumber(a, e, o.precision) : ""
        }))
    }, s._drawLarge = function() {
        var e = this._chart, t = function(e) {
            return Math.max(2, Math.min(5, e / 70))
        }, n = this, i = this._dataAdapter, s = this._options, o = i.formats().x, u = this._getYFormatType();
        e.guide("x", r.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickFormat(function(e) {
            return n._formatNumber(o, e, s.precision)
        })).guide("y", r.guide.axis().ticks(t).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(e) {
            return e ? n._formatNumber(u, e, s.precision) : ""
        }))
    }, s._postRender = function() {
        Object.getPrototypeOf(s)._postRender.call(this);
        var e = this._options, t = this._chart, n = 5, r = i.select(e.parent).select(".cv-wrapper"), o = r.selectAll(".cv-bubble-size-metric").data([0]);
        this._dataAdapter.sizeMetricName() ? (o.enter().append("div").classed("cv-bubble-size-metric", !0).html("<span>" + this._dataAdapter.sizeMetricName() + "</span>  <i></i> &ndash; <i></i>"), setTimeout(function() {
            var e = t.padding(), r = t.facet().getPanel(t.facet()._panels.length - 1).bounds(), i = t.plotBounds(), s = o.selectAll("span"), u = i.right + e.right, a = r.top + r.height, f = u - o.node().offsetWidth - n, l = a - o.node().offsetHeight;
            o.style("top", l + "px").style("left", f + "px")
        }, 300)) : o.remove()
    }, e.cloudViz.point = t.util.createConstructor(s)
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.dvcore || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        return Object.getPrototypeOf(s).init.apply(this, arguments), this._type = "bar", this._chart = r.chart(), this._minTickSpace = 60, this
    }, s._initDefaultOptions = function() {
        var e = {normalized: !1,position: "dodge",dualYAxis: !1,clickHandler: null,formats: {x: "decimal",y: "decimal"},tooltipContent: null};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, e)
    }, s.reset = function() {
        Object.getPrototypeOf(s).reset.apply(this, arguments);
        var e = this._options, t = i.select(e.parent);
        t.selectAll(".axis-y.axis-index-1").remove()
    }, s._setChartTypeOptions = function() {
        var e = this._chart, t = this._options;
        e.layers([r.geom.bar().each("start", function(e, t) {
                i.select(this).attr("legend-group", e.fill)
            })]).map("fill", this._getPropMapping("series"), r.scale.color().values(t.colors)).guide("fill", this._legend).position(t.position).coord(r.coord.cartesian().flip(t.flip)), e._layers[0].on("click", this._eventMap.click ? this._eventMap.click : null), this._addBehaviors(e.layers()[0], t), this._mapPositionScales(e, t)
    }, s._mapPositionScales = function(e, t) {
        var n = this._isSmallChart(), i = [0, n ? 10 : 15], s = this._applyForceZero(this._constructScale("y")).rangePadding(i), o = this._getPropMapping("series"), u = this._getPropMapping("y"), a = this._getPropMapping("x"), f = n ? .8 : Math.min(.6, Math.max(.05, this._getChartWidth() / 4e3)), l = n ? 0 : .5, c = this;
        if (t.normalized || t.dualYAxis && (this._options.position === "identity" || this._options.position === "dodge")) {
            var h = c._dataAdapter.uniqueFillValues();
            h.forEach(function(t, n) {
                var r = 0 === n ? s : s.copy();
                r.includeInDomain(function(e, t) {
                    return e.data[o] === c._dataAdapter.uniqueFillValues()[n]
                }), n > 0 && e.map("y", u, r, n)
            })
        } else {
            var p = e.getExplicitScalesMap().y;
            p && delete p[1]
        }
        e.map("y", u, s, 0), e.map("x", this._getPropMapping("x"), r.scale.ordinal().padding(f).outerPadding(l).reverse(t.flip))
    }, s._addBehaviors = function(e, t) {
        var n = i.select(t.parent), s, o = this._dataAdapter, u = this;
        !this._isSmallChart() && t.interactive && e.behaviors([r.behavior.rollover().orientation(t.flip ? "top" : "right").content(function(e, n, i) {
                if (t.tooltipContent)
                    return t.tooltipContent.call(this, e, n, i);
                var s = this.__geom.getExplicitScale("group"), a = e.panel.yScale(e), f = u._yLabelFormat(a.scaleIndex()), l = '<span class="metric-value">' + f(e.y) + '</span><span class="metric-name">' + e.data[u._getPropMapping("seriesLabel")] + "</span>", c = o.dateGranularity(), h = o.l10n.dateFormat.fullFormat, p = r.util.isDate(e.x) ? u._formatTime(e.x, u._timeGranTemplate(c, h), c) : e.x;
                return s && s.mapping() && (l = '<span class="series-name">' + p + "</span>" + l), l
            }).showTooltip(function(e, t, r, o, a) {
                var f = i.select(this);
                f.classed("path-inactive") || (a._showTip.call(this, e, t, r, a), clearTimeout(s), n.selectAll(".bar-geom").classed("cv-medium-duration", !1).classed("cv-unselected", function(t) {
                    return e !== t
                }), n.selectAll(".cv-legend-marker").classed("unselected", function(t) {
                    return t !== e.fill
                }).classed("cv-medium-duration", !1), u._eventMap.mouseover && u._eventMap.mouseover.call(this, e, t, r, o))
            }).hideTooltip(function(e, t, r, o, a) {
                var f = i.select(this);
                f.classed("path-inactive") || (a._removeTip.call(this, e, t, r, a), s = setTimeout(function() {
                    n.selectAll(".bar-geom").classed("cv-unselected", !1).classed("cv-medium-duration", !0), n.selectAll(".cv-legend-marker").classed("unselected", !1).classed("cv-medium-duration", !0), u._eventMap.mouseout && u._eventMap.mouseout.call(this, e, t, r, o)
                }, 400))
            })])
    }, s._drawSmall = function() {
        var e = this._chart, t = this._options, n, s = t.flip ? undefined : 10, o = this;
        t.flip ? n = r.guide.axis().tickDx(function(e, t) {
            return i.select(this).select("span").node().offsetWidth
        }).tickDy(function(e, t) {
            return -i.select(this).select("span").node().offsetHeight
        }).tickSize(0) : n = r.guide.axis().tickSize(0).tickDy(function(e, t) {
            return t % 2 === 0 ? -8 : -26
        }), this._dataAdapter.isOvertime() ? n.tickValues(i.extent(this._dataAdapter.data()[this._getPropMapping("x")])).tickFormat(o._timeSmallXFormat()).tickAnchor(function(e, t) {
            return t > 0 ? "end" : "start"
        }).tickDy(-8) : n.tickFormat(function(e, t) {
            return o._truncateLabel(e, s)
        }), e.guide("x", n.title(this._dataAdapter.xAxisTitle())).guide("y", r.guide.axis().ticks(0).tickSize(0).tickFormat(function(e, t) {
            return ""
        }).title(this._dataAdapter.yAxisTitle())), this._checkNormalized()
    }, s._drawLarge = function() {
        var e = this._chart, t = this._options, n = this, i = function(e) {
            return Math.max(2, Math.min(5, e / 75))
        }, s = r.guide.axis().tickSize(0), o = r.guide.axis().ticks(i), u;
        if (!t.dualYAxis || this._options.position !== "identity" && this._options.position !== "dodge")
            o.tickFormat(this._yTickFormat(0)).title(this._yTitleFormat(0)), e.guide("y", "none", 1);
        else {
            var a = n._dataAdapter.getUniqueFillExtent(0), f = n._dataAdapter.getUniqueFillExtent(1);
            o.tickSize(15).tickFormat(this._yTickFormat(0, a)).title(this._yTitleFormat(0, a)), u = r.guide.axis().ticks(i).tickFormat(this._yTickFormat(1, f)).title(this._yTitleFormat(1, f)).orientation("right").tickSize(15), e.guide("y", u, 1)
        }
        t.flip ? s.tickDx(-10) : (s.tickDy(function(e, t) {
            return t % 2 === 0 ? -8 : -26
        }), o.tickDx(-10), u && u.tickDx(-10));
        if (this._dataAdapter.isOvertime()) {
            var l = {}, c = 0;
            e._data[this._getPropMapping("x")].forEach(function(e, t) {
                l[+e] || (c++, l[+e] = 1)
            }), s.tickDy(-8).tickFormat(this._timeXTickFormat(c)).htmlLabels(!0)
        } else
            s.tickFormat(function(e, t) {
                return n._truncateLabel(e)
            });
        e.guide("x", s.title(this._dataAdapter.xAxisTitle())).guide("y", o), this._checkNormalized()
    }, s._timeXTickValidator = function(e) {
        var t = this;
        return function(n, i) {
            var s = t._chart.getTrainedScale("x"), o = r.util.scaleRange(s), u = o[1] - o[0], a = Math.ceil(t._minTickSpace / (u / e));
            return i % a === 0
        }
    }, s._timeXTickFormat = function(e) {
        return Object.getPrototypeOf(s)._timeXTickFormat.call(this, this._timeXTickValidator(e))
    }, s._isNormalized = function() {
        var e = this._options, t = this._isSmallChart() ? 1 : 2;
        return e.normalized || e.dualYAxis && this._dataAdapter.uniqueFillValues().length > t && (e.position === "identity" || e.position === "dodge")
    }, e.cloudViz.bar = t.util.createConstructor(s)
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.dvcore || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        return Object.getPrototypeOf(s).init.apply(this, arguments), this._type = "donut", this._chart = r.chart(), this
    }, s._initDefaultOptions = function() {
        var e = {maxSlices: 6,innerRadius: "45%",outerRadius: "35%",clickHandler: null,formats: {x: "decimal",y: "decimal"},tooltipContent: null};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, e)
    }, s._buildLegend = function() {
        var e = this, t = this._options, n = Object.getPrototypeOf(s)._buildLegend.call(this, "x", "x");
        this._dataAdapter.processLabelData(n);
        if (n !== "none") {
            if (this._dataAdapter.numberOfFacets() == 1) {
                var r = this._dataAdapter.labelData().cvtextvallabel.map(function(t, n) {
                    return e._yLabelFormat(0)(t)
                });
                n.values(r)
            }
            !t.interactive && (!t.legendOrientation || t.legendOrientation === "top") && n.padding({bottom: 20})
        }
        return n
    }, s._getSeriesTotal = function(e) {
        var t = this._dataAdapter, n = t.data(), r = n[this._getPropMapping("y")], i = n[this._getPropMapping("series")], s, o = i.length, u = 0;
        for (s = 0; s < o; ++s)
            i[s] + "" == e + "" && (u += r[s]);
        return u
    }, s._createSeriesStates = function() {
        var e = this._options;
        if ("data" in this._changedOptions && this._changedOptions.data) {
            this._seriesState.removeStatesByType("standard");
            var t = r.util.uniq(this._dataAdapter.data()[this._getPropMapping("x")]), n = t.length;
            while (n--) {
                var i = t[n];
                this._seriesState.insertState(i, i, "standard")
            }
        }
        "targetValues" in this._changedOptions && e.targetValues && (this._seriesState.removeStatesByType("target"), this._seriesState.appendState(e.targetLabel || this._dataAdapter.l10n.labels.dvcore.target, "target", "target"))
    }, s._getCategoryTotal = function(e) {
        if (this._dataAdapter.numberOfFacets() !== 1)
            return "";
        var t = this._dataAdapter.data(), n = t[this._getPropMapping("y")], r = t[this._getPropMapping("x")], i, s = r.length, o = 0;
        for (i = 0; i < s; ++i)
            r[i] + "" == e + "" && (o += n[i]);
        return o
    }, s._shouldHideLabels = function(e) {
        var t = e.panel.bounds();
        return e.y <= .05 || Math.min(t.width, t.height) / 2 < 80
    }, s._setChartTypeOptions = function() {
        var e = this._chart, t = this._dataAdapter, n = this._options, s = i.select(n.parent), o = this, u = n.colors.slice(0);
        n.interactive && e.padding({top: 10}), t.showOtherCategory() && u.splice(n.maxSlices - 1, 0, "#ccc");
        var a = [r.geom.bar().position("fill").set("stroke", "#fff").each("start", function(e, t) {
                i.select(this).attr("legend-group", e.fill)
            })];
        a[0].on("click", this._eventMap.click ? this._eventMap.click : null);
        var f = o._dataAdapter.labelData();
        a.push(r.geom.text().data(f).map("label", "cvtextperclabel").set("stroke", "none").position("fill").textAnchor(function(e, t) {
            var n = (e.y0 + e.y / 2) * 100;
            return n < 50 ? "start" : n > 50 ? "end" : "middle"
        }).each("start", function(e, t) {
            i.select(this).classed("slice-label", !0).classed("hidden", o._shouldHideLabels.call(o, e)).attr("dy", ".35em").attr("legend-group", e.fill)
        }).set("alpha", function(e, t, n) {
            return o._shouldHideLabels.call(o, e) ? 0 : 1
        }).dx(function(e, t) {
            var i = e.panel.xOuterScale().range(), s = i[1] - i[0], o = s ? s / 2 : 0, u = r.util.getPercentValue(n.outerRadius, o), a = 30, f = (e.y0 + e.y / 2) * 100;
            return o + u - a
        }).dy(function(e, t) {
            var n = -e.panel._bounds.width / 2 * e.y, r = (e.y0 + e.y / 2) * 100;
            return r < 10 && (n -= (10 - r) / 2), r > 90 && (n += (10 - (100 - r)) / 2), r <= 50 && r > 40 && (n += (10 - (50 - r)) / 2), r > 50 && r < 60 && (n -= (10 - (r - 50)) / 2), n
        })), e.layers(a).map("group", "cvdonutorder").map("x", this._getPropMapping("series"), r.scale.ordinal()).map("y", this._getPropMapping("y"), this._constructScale("y")).map("fill", this._getPropMapping("x"), r.scale.color().values(u)).guide("fill", this._legend).guide(["x", "y"], "none").coord(r.coord.polar().flip(!0).innerRadius(n.innerRadius).outerRadius(n.outerRadius)).postrender(function() {
            var e = i.select(n.parent).select(".cv-wrapper"), t = e.selectAll(".cv-donut-facet-labels").data([0]), s = o._dataAdapter;
            t.enter().append("div").classed("cv-donut-facet-labels", !0), t.exit().remove();
            var u = t.selectAll(".cv-donut-facet-label").data(this.facet()._panels), a = u.enter().append("div").classed("cv-donut-facet-label", !0);
            u.each(function(e, t) {
                var u = e.bounds(), a = i.select(this), f = Math.min(u.width, u.height) / 2, l = u.height / 2 - f, c = r.util.getPercentValue(n.innerRadius, f), h = c < 25 ? "small" : c > 50 ? "large" : "medium", p = h === "large" ? c * 2 : u.width, d = h === "large" ? u.left + u.width / 2 - p / 2 : u.left, v = h === "large" ? u.top + u.height / 2 - 27 : u.top + l - 10;
                a.style("top", v + "px").style("width", p + "px").style("left", d + "px").classed("cv-donut-small-facet cv-donut-medium-facet cv-donut-large-facet", !1).classed("cv-donut-" + h + "-facet", !0);
                var m = a.selectAll(".cv-donut-label-number").data([0]);
                m.enter().append("div").classed("cv-donut-label-number", !0);
                var g = o._getSeriesTotal(e.xFacetTitle());
                m.text(o._yLabelFormat(e._facetIndex)(g));
                var y = a.selectAll(".cv-donut-label-title").data([0]);
                y.enter().append("div").classed("cv-donut-label-title", !0), y.text(s.yAxisTitle(e._facetIndex)), h === "medium" && m.style("top", u.height / 2 - l + "px")
            }), u.exit().remove()
        }), this._addBehaviors(a[0], n)
    }, s._addBehaviors = function(e, t) {
        var n = i.select(t.parent), s, o = this._dataAdapter, u = this, a = function(e, t, n) {
            return e.data.hasOwnProperty(t.mapping()) ? '<span class="metric-value">' + n(e.data[t.mapping()]) + '</span><span class="metric-name">' + t.mapping() + "</span>" : ""
        };
        !this._isSmallChart() && t.interactive && e.behaviors([r.behavior.rollover().content(function(e, n, i) {
                if (t.tooltipContent)
                    return t.tooltipContent.call(this, e, n, i);
                var s = this.__geom.getExplicitScale("group"), a = e.panel.yScale(e), f = u._yLabelFormat(a.scaleIndex()), l = '<span class="metric-value">' + f(e.data[u._getPropMapping("y")]) + '</span><span class="metric-name">' + e.data[u._getPropMapping("seriesLabel")] + "</span>", c = u._dataAdapter.dateGranularity(), h = o.l10n.dateFormat.fullFormat, p = r.util.isDate(e.fill) ? u._formatTime(e.fill, u._timeGranTemplate(c, h), c) : e.fill;
                return s && s.mapping() && (l = '<span class="series-name">' + p + "</span>" + l), l
            }).showTooltip(function(e, t, r, o, a) {
                var f = i.select(this);
                f.classed("path-inactive") || (a._showTip.call(this, e, t, r, a), clearTimeout(s), n.selectAll(".bar-geom").classed("cv-medium-duration", !1).classed("cv-unselected", function(t) {
                    return e !== t
                }), n.selectAll(".text-geom").classed("cv-medium-duration", !1).classed("cv-unselected", function(t) {
                    return e.group !== t.group
                }).classed("cv-selected", function(t) {
                    return e.group === t.group
                }), n.selectAll(".cv-legend-marker").classed("unselected", function(t) {
                    return t !== e.fill
                }).classed("cv-medium-duration", !1), u._eventMap.mouseover && u._eventMap.mouseover.call(this, e, t, r, o))
            }).hideTooltip(function(e, t, r, o, a) {
                var f = i.select(this);
                f.classed("path-inactive") || (a._removeTip.call(this, e, t, r, a), s = setTimeout(function() {
                    n.selectAll(".bar-geom").classed("cv-unselected", !1).classed("cv-medium-duration", !0), n.selectAll(".text-geom").classed("cv-unselected cv-selected", !1).classed("cv-medium-duration", !0), n.selectAll(".cv-legend-marker").classed("unselected", !1).classed("cv-medium-duration", !0), u._eventMap.mouseout && u._eventMap.mouseout.call(this, e, t, r, o)
                }, 400))
            })])
    }, s._drawSmall = function() {
        var e = this._chart, t = this._options;
        e.facet(r.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(1).titleFormat(undefined))
    }, s._drawLarge = function() {
        var e = this._chart;
        e.facet(r.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(3).titleFormat(undefined))
    }, e.cloudViz.donut = t.util.createConstructor(s)
}(this), function(e) {
    e.cloudViz.interactiveLegend = function() {
        var t = 10, n = 110, r = 250, i = 110, s, o, u = ["top", "right", "left"], a, f, l, c, h, p, d, v, m = !0, g, y, b, w = null, E = null, S, x = {};
        return x._render = function(e, t, n) {
            this._initSVG(t), this._sizeAndPositionLegendEntries(), this._positionLegend()
        }, x._initSVG = function(t) {
            b = d3.select(s).selectAll(".cv-legend").data([0]), b.enter().append("div").classed("cv-legend", !0), y = this._createLegendEntries(b, t), g = Math.min(Math.floor(this._getLegendContainingWidth() / y[0].length), r), u.indexOf(o) > -1 ? this._calculatedLegendOrientation = o : this._calculatedLegendOrientation = "top";
            var f = e.cloudViz.core._isSmallChart(a);
            g < n && !f && (this._calculatedLegendOrientation == "top" || this._calculatedLegendOrientation == "bottom") && (this._calculatedLegendOrientation = "left");
            switch (this._calculatedLegendOrientation) {
                case "top":
                case "bottom":
                    g = Math.max(g, n), b.style("height", null), c = !1;
                    break;
                case "left":
                case "right":
                    g = i, c = !0
            }
            u.forEach(dv.util.bind(function(e) {
                b.classed(e, this._calculatedLegendOrientation === e)
            }, this))
        }, x._getAdjustedDimensions = function(e) {
            var t = b.node();
            switch (this._calculatedLegendOrientation) {
                case "top":
                    e.top += this._getUsedHeight();
                    break;
                case "right":
                    e.width -= this._getUsedWidth();
                    break;
                case "left":
                    e.left += this._getUsedWidth();
                    break;
                case "bottom":
                    e.height -= this._getUsedHeight()
            }
            return e
        }, x._createLegendEntries = function(e, t) {
            var n = this, r = v.getStateObjects(), i, s, o, u;
            for (o in t)
                u = t[o][0], S = u._mapping;
            i = e.selectAll(".cv-legend-entry").data(r), s = i.enter().append("div").attr("class", function(e) {
                return "cv-legend-entry cv-legend-" + e.type + "-entry"
            }), s.append("div").classed("cv-legend-title", !0);
            var a = s.append("div").classed("cv-legend-details", !0);
            return a.append("div").classed("cv-legend-marker", !0), a.append("div").classed("cv-legend-num", !0), i.exit().on("click", null).remove(), i.each(function(e, t) {
                var n = d3.select(this);
                n.select(".cv-legend-title").text(e.name), n.select(".cv-legend-num").text(h && h.length > t ? h[t] : ""), n.select(".cv-legend-marker").attr("class", "cv-legend-marker " + p).style("background-color", function(e) {
                    var t = u.mapValue(e.id);
                    return t ? t : null
                })
            }), i.classed("inactive", function(e, t) {
                return m && !e.enabled
            }), i.on("click", function(e, t) {
                m && v.enableStateByIndex(t, !e.enabled)
            }), i
        }, x._onSeriesEnableChange = function(e, t) {
            m && y.filter(function(e) {
                return e.id === t.id && e.type === t.type
            }).classed("inactive", !t.enabled)
        }, x._positionLegend = function() {
            var e = {top: 0,left: 0};
            switch (this._calculatedLegendOrientation) {
                case "bottom":
                    e.top = f - b.node().offsetHeight;
                    break;
                case "right":
                    e.left = a - i
            }
            b.style("top", e.top + "px").style("left", e.left + "px")
        }, x._sizeAndPositionLegendEntries = function() {
            if (c)
                y.each(function(e, t, n) {
                    d3.select(this).style("width", g + "px").select(".cv-legend-title").style("height", null)
                });
            else {
                var e, t, n = 0, r = !1, i = y[0].length, s = i * g, o = this._getLegendContainingWidth(), u = 0;
                s < o && s + i > o && (u = o - s), b.style("width", s > o && !c ? o + "px" : ""), y.each(function(i, s, o) {
                    e = d3.select(this);
                    var a = g;
                    u > 0 && (a += 1, u -= 1), e.style("width", a + "px"), t = e.select(".cv-legend-title").style("height", null).node().offsetHeight, t !== n && (r = !0, n = Math.max(t, n))
                }), r && y.selectAll(".cv-legend-title").style("height", n + "px")
            }
        }, x._getLegendContainingWidth = function() {
            return a - l.right
        }, x._getUsedWidth = function() {
            return c ? i + t : 0
        }, x._getUsedHeight = function() {
            return c ? 0 : b.node().offsetHeight || 0
        }, x.destroy = function() {
            b.remove()
        }, x.parent = function(e) {
            return arguments.length ? (s = e, x) : s
        }, x.minLegendEntryWidth = function(e) {
            return arguments.length ? (n = e, x) : n
        }, x.maxLegendEntryWidth = function(e) {
            return arguments.length ? (r = e, x) : r
        }, x.legendVerticalWidth = function(e) {
            return arguments.length ? (i = +e, x) : i
        }, x.values = function(e) {
            return arguments.length ? (h = e, x) : h
        }, x.type = function(e) {
            return arguments.length ? (p = e, x) : p
        }, x.chartWidth = function(e) {
            return arguments.length ? (a = e, x) : a
        }, x.chartHeight = function(e) {
            return arguments.length ? (f = e, x) : f
        }, x.chartPadding = function(e) {
            return arguments.length ? (l = e, x) : l
        }, x.seriesState = function(e) {
            return arguments.length ? (v = e, v.on("enableChange.legend", this._onSeriesEnableChange), x) : v
        }, x.validOrientations = function(e) {
            return arguments.length ? (u = e, x) : u
        }, x.orientation = function(e) {
            return arguments.length ? (o = e, x) : o
        }, x.interactive = function(e) {
            return arguments.length ? (m = e, x) : m
        }, x.mapping = function() {
            return S
        }, x.isVertical = function() {
            return c
        }, x
    }
}(this), function(e) {
    d3.anomaly = function() {
        function H(e, t) {
            for (var n in t)
                e[n] = t[n];
            return e
        }
        function B() {
            var e = O.append("g").classed("temp-axis", !0);
            et(e, i[0], i[1]), r = j(e), E = i[0] - r.left - r.right, w = i[1] - r.top - r.bottom, e.remove()
        }
        function j(e) {
            var t = e.node().getBBox(), n = Math.abs(t.x), r = Math.abs(t.y);
            return {left: n,top: r,right: t.width - i[0] - n,bottom: t.height - i[1] - r}
        }
        function F() {
            var e = I(t, function(e) {
                return Date.parse(e[k])
            }, [d, p]), n = I(t, function(e) {
                return e[L]
            });
            g.domain(e);
            var r = g.ticks(c, h), i = +r[1] - +r[0];
            e[1] = i + +r[r.length - 1], e[0] = +r[0] > e[0] ? +r[0] - i : e[0], g.domain(e), C = g.ticks(c, h);
            var s = Math.max(Math.abs(n[0]), Math.abs(n[1]));
            u ? (y.domain([0, s]), b = d3.scale.linear().domain([-s, s])) : (y.domain([-s, s]), b = d3.scale.linear().domain(y.domain())), b.domain([0, .1, .2, .3, .4, .5, .6, .7, .8, .9, 1].map(b.invert)), b.range(["#3C476F", "#485485", "#53659C", "#6C7CAF", "#99A2BC", "#C5C5C5", "#ACC997", "#90C867", "#7CBC4B", "#6FA744", "#64913E"])
        }
        function I(e, t, n) {
            var r = [];
            return arguments.length < 3 || n[0] === undefined && n[1] === undefined ? r = d3.extent(e, t) : (r[0] = n[0] === undefined ? d3.min(e, t) : n[0], r[1] = n[1] === undefined ? d3.max(e, t) : n[1]), r
        }
        function q() {
            N = d3.svg.brush().x(g).y(y).on("brushstart", R).on("brush", U).on("brushend", z)
        }
        function R(e) {
            W()
        }
        function U(e) {
            O.selectAll(".extent").style("opacity", 1), W()
        }
        function z(e) {
            O.selectAll(".extent").style("opacity", 0), W()
        }
        function W() {
            var e = N.extent(), t = {left: Math.min(g(e[0][0]), g(e[1][0])),right: Math.max(g(e[0][0]), g(e[1][0])),top: Math.min(y(e[0][1]), y(e[1][1])),bottom: Math.max(y(e[0][1]), y(e[1][1]))}, n = O.selectAll(".anom-anomaly").filter(function(e, n) {
                return V({left: e.bounds.x,right: e.bounds.x + e.bounds.width,top: e.bounds.y,bottom: e.bounds.y + e.bounds.height}, t)
            });
            if (M && X(n[0], M[0]))
                return;
            M = n, v.select(n)
        }
        function X(e, t) {
            if (e.length != t.length)
                return !1;
            for (var n = 0, r = e.length; n < r; n++)
                if (t.indexOf(e[n]) === -1)
                    return !1;
            return !0
        }
        function V(e, t) {
            return !(t.left > e.right || t.right < e.left || t.top > e.bottom || t.bottom < e.top)
        }
        function $() {
            A = d3.select(a);
            var e = A.selectAll("svg").data([t]);
            e.enter().append("svg"), e.exit().remove(), e.attr("width", i[0]).attr("height", i[1]);
            var n = e.selectAll(".anom-container").data([0]);
            return n.enter().append("g").classed("anom-container", !0), n
        }
        function J() {
            T = y.ticks(o);
            var e = T[1] - T[0];
            T.push(e + T[T.length - 1]), u || T.unshift(T[0] - e), t = K(t), Q(t);
            var n = G(t);
            return Y(T, n), n
        }
        function K(e, t) {
            var n = g.domain();
            return e.filter(function(e) {
                var t = new Date(e[k]);
                return t >= n[0] && t < n[1]
            })
        }
        function Q(e) {
            e.sort(function(e, t) {
                return e = new Date(e[k]), t = new Date(t[k]), e < t ? -1 : e > t ? 1 : 0
            })
        }
        function G(e) {
            return d3.nest().key(function(e) {
                var t = Date.parse(e[k]), n = 0, r = -1, i = C.length;
                while (++r < i) {
                    if (+C[r] > +t)
                        break;
                    n = r
                }
                return +C[n]
            }).entries(e)
        }
        function Y(e, t) {
            t.forEach(function(t) {
                t.values = d3.layout.histogram().bins(e).value(function(e) {
                    return u ? Math.abs(e[L]) : e[L]
                })(t.values), x = t.values[0].dx
            })
        }
        function Z(e) {
            var t = new Date(0), n = C.length, r = Math.max(Math.ceil((C.length - 1) / (e / 70)), 1), i = d3.time.format("%b %e, %Y"), s = d3.time.format("%b %e"), o = d3.time.format("%a %e"), u = d3.time.format("%I:%M %p");
            return function(e, a) {
                var f = "";
                return a === n - 1 || a % r !== 0 ? "" : (a === 0 || t.getYear() !== e.getYear() ? f = i(e) : t.getMonth() !== e.getMonth() ? f = s(e) : t.getDate() !== e.getDate() ? f = o(e) : t.getHours() !== e.getHours() && (f = u(e)), t = e, f)
            }
        }
        function et(e, t, n) {
            var r = C.length, i = C.length > 1 && +C[1] - +C[0] <= P, s;
            g.rangeRound([0, t]), y.rangeRound([n, 0]);
            var o = e.selectAll(".anom-axes").data([0]);
            o.enter().append("g").classed("anom-axes", !0);
            var a = o.selectAll(".anom-axis").data(["x", "y"]);
            a.enter().append("g").attr("class", function(e) {
                return "anom-" + e + " anom-axis"
            });
            var f = o.selectAll(".anom-x").attr("transform", "translate(0," + n + ")").call(d3.svg.axis().scale(g).ticks(c, h).orient("bottom").tickSize(-n).tickPadding(20).tickFormat(Z(t)));
            f.selectAll("text").style("text-anchor", "start"), f.selectAll("line").style("opacity", function(e, t) {
                return t === r - 1 ? 0 : i && (e.getDay() === 6 || e.getDay() === 1) && e.getHours() === 0 && t < r - 1 ? .3 : null
            });
            var l = o.selectAll(".anom-y").call(d3.svg.axis().scale(y).tickValues(T).orient("left").tickSize(-t).tickPadding(10).tickFormat(function(e, t) {
                return t === 0 || t === Math.floor(T.length / 2) || t === T.length - 1 ? Math.round(e * 1e5) / 1e5 + "%" : ""
            }));
            u || l.selectAll("line").filter(function(e, t) {
                return e === 0
            }).style("stroke-dasharray", "4 4").style("opacity", .7)
        }
        function tt() {
            var e = Math.round(T.length > 1 ? y(T[0]) - y(T[1]) : w) - 1, t = Math.round(st(e)) - 1, n = O.selectAll(".anom-plot").data([S]);
            n.enter().append("g").classed("anom-plot", !0), n.exit().remove();
            var r = n.selectAll(".anom-column").data(function(e) {
                return e
            });
            r.enter().append("g").classed("anom-column", !0), r.exit().remove(), r.attr("transform", function(e) {
                return "translate(" + g(+e.key) + ",0)"
            });
            var i = r.selectAll(".anom-row").data(function(e) {
                return e.values
            });
            i.enter().append("g").classed("anom-row", !0), i.exit().remove(), i.attr("transform", function(t, n) {
                return "translate(0," + (y(T[n]) - e) + ")"
            });
            var s = i.selectAll(".anom-anomaly").data(function(e) {
                return e
            }), o = s.enter().append("g").classed("anom-anomaly", !0);
            s.attr("transform", function(n, r) {
                var i = it(u ? Math.abs(n[L]) : n[L]);
                return n[L] >= 0 && (i += x), n.bounds = {x: g(Date.parse(n[k])) + (r * (t + D) + D),y: y(i),width: t,height: e}, "translate(" + (r * (t + D) + D) + ",0)"
            }), s.exit().remove(), o.append("rect").classed("anom-cell", !0).attr("x", t / 2).attr("y", e / 2).attr("width", 0).attr("height", 0), s.selectAll(".anom-cell").attr("fill", function(e) {
                var t = it(u ? Math.abs(e[L]) : e[L]);
                return u && e[L] < 0 && (t *= -1), b(t)
            }).transition().duration(500).attr("x", 0).attr("y", 0).attr("width", t).attr("height", e);
            var a = o.append("g").classed("anom-select", !0);
            a.append("path").classed("outer-border", !0), a.append("path").classed("inner-border", !0);
            var f = s.selectAll(".anom-select");
            f.select(".outer-border").attr("d", rt(0, 0, t + .5, e + .5, 1)), t > 3 && f.select(".inner-border").attr("d", rt(0, 0, t + 1, e + 1, 2));
            var l = o.append("rect").classed("anom-hit-area", !0);
            l.on("mouseover", function(e, t) {
                v.mouseover(this, e, t)
            }).on("mouseout", function(e, t) {
                v.mouseout(this, e, t)
            }).on("mousedown", function(e, t) {
                N.clear();
                var n = d3.mouse(O.node()), r = g.invert(n[0]), i = y.invert(n[1]);
                N.extent([[r, i], [r, i]])
            }).on("click", function(e, t) {
                v.select(d3.select(this))
            }).style("cursor", "crosshair").style("opacity", 0).attr("x", 0).attr("y", 0).attr("width", t).attr("height", e)
        }
        function nt() {
            var e = O.selectAll(".anom-plot").data([0]);
            e.enter().append("g").classed("anom-plot", !0), e.exit().remove(), e.call(N)
        }
        function rt(e, t, n, r, i) {
            return "M" + i + "," + i + "L" + (n - i * 2) + "," + i + "L" + (n - i * 2) + "," + (r - i * 2) + "L" + i + "," + (r - i * 2) + "z"
        }
        function it(e) {
            var t = -1, n = T.length;
            while (++t < n) {
                if (e >= 0 && T[t] + x > e)
                    return T[t];
                if (e < 0 && T[t] + x > e)
                    return T[t] + x
            }
            return T[0]
        }
        function st(e) {
            var t = (C.length > 1 ? g(C[1]) - g(C[0]) : E) - _, n = ot();
            return f = t / n, f > e ? e : f
        }
        function ot() {
            var e = 0;
            return S.forEach(function(t) {
                t.values.forEach(function(t) {
                    e = Math.max(t.length, e)
                })
            }), e
        }
        function ut(e) {
            if (n[e] === undefined)
                throw new at(e);
            return n[e]
        }
        function at(e) {
            this.type = "MappingNotDefinedException", this.message = "The mapping for property " + e + " was not defined.", this.toString = function() {
                return this.type + " - " + this.message
            }
        }
        function ft() {
            this.type = "EmptyDataException", this.message = "The data is empty or null", this.toString = function() {
                return this.type + " - " + this.message
            }
        }
        function lt() {
            this.type = "ParentNotSpecifiedException", this.message = "A p was not specified for this visualization", this.toString = function() {
                return this.type + " - " + this.message
            }
        }
        var e = {}, t, n = {x: "date",y: "deviation"}, r, i = [50, 25], s = !0, o = 6, u = !1, a = null, f, l, c = 7, h, p, d, v = d3.dispatch("select", "mouseover", "mouseout"), m, g = d3.time.scale(), y = d3.scale.linear(), b, w, E, S, x, T, N, C, k, L, A, O, M, _ = 8, D = 1, P = 864e5;
        return d3.rebind(e, v, "on"), e.data = function(n) {
            return arguments.length ? (t = n, M = null, e) : t
        }, e.mappings = function(t) {
            return arguments.length ? (n = H(n, t), e) : n
        }, e.xUpperLimit = function(t) {
            return arguments.length ? (p = t, e) : p
        }, e.xLowerLimit = function(t) {
            return arguments.length ? (d = t, e) : d
        }, e.normalizePositive = function(t) {
            return arguments.length ? (u = t, e) : u
        }, e.xTicks = function(e, t) {
            if (!arguments.length)
                return t !== undefined ? [c, h] : this.xTicks;
            var n = !!(e && e.constructor && e.call && e.apply);
            return c = n ? d3.functor(e) : e, h = n ? t : undefined, this
        }, e.bins = function(t) {
            return arguments.length ? (o = t, e) : o
        }, e.size = function(t) {
            return arguments.length ? (i = t, e) : i
        }, e.interactive = function(t) {
            return arguments.length ? (s = t, e) : s
        }, e.parent = function(t) {
            return arguments.length ? (a = t, e) : a
        }, e.anomalyWidth = function() {
            return f
        }, e.anomalyHeight = function() {
            return l
        }, e.layout = function() {
            if (!e.data() || !e.data().length)
                throw new ft;
            if (!e.parent())
                throw new lt;
            return k = ut("x"), L = ut("y"), F(), q(), O = $(), S = J(), y.domain([T[0], T[T.length - 1]]), B(), O.attr("transform", "translate(" + r.left + "," + r.top + ")"), et(O, E, w), nt(), tt(), e
        }, e.nodes = function(e) {
            if (!A)
                throw new Error("layout must be called before nodes may be requested.");
            A.selectAll(".anom-anomaly").each(e)
        }, e
    }
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n), o = 400;
    s.init = function(e) {
        return this._type = "pathing", this._initDefaultOptions(), this.setOptions(e), this._pathLocked = null, this._pathedObj = null, this._activePaths = [], this._lineLocked = null, this._lastSide = 0, this
    }, s._initDefaultOptions = function() {
        var e = "Visits", t = {mappings: {},colors: ["#3287d2", "#9b8ce6", "#d755a5", "#fa5a50", "#f0a01e", "#c3d250", "#5faf69", "#1ebed7", "#5a6eaa", "#78b4f5", "#aa5fa5", "#f0557d", "#e8782d", "#f5c841", "#8cc350", "#3cb5a0", "#286eaf", "#826ee1", "#b93282", "#f04641", "#e18c00", "#a0b400", "#50965a", "#00a0be", "#465a87", "#4196e6", "#964196", "#dc3c69", "#dc5f00", "#e6b43c", "#7daf4b", "#32a08c"],nodeWidth: 100,minNodeHeight: 1,avgNodeHeight: 30,padding: {top: 80,left: 30,right: 30,bottom: 20},metricName: e,minNodeHorzPadding: 80,nodeVertPadding: 34,iterations: 32,pivotNode: null,collapseNode: null,expandNode: null,pathSelected: null};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s._onAutoResize = function() {
        this.render()
    }, s.reset = function() {
        Object.getPrototypeOf(s).reset.apply(this, arguments)
    }, s._preRender = function() {
        Object.getPrototypeOf(s)._preRender.apply(this);
        var e = this._options, t = i.select(e.parent), n = e.padding, r = t.selectAll(".pathing-cv-info-wrapper").data([0]);
        r.enter().insert("div", ":first-child").classed("pathing-cv-info-wrapper", !0);
        var o = r.selectAll(".pathing-cv-wrapper").data([0]);
        o.enter().insert("div", ":first-child").classed("pathing-cv-wrapper", !0);
        var u = o.selectAll(".pathing-cv-container").data([0]);
        u.enter().insert("div", ":first-child").classed("pathing-cv-container", !0);
        var a = u.selectAll(".pathing-svg").data([0]);
        a.enter().append("svg").classed("pathing-svg", !0);
        var f = a.selectAll(".pathing-svg-container").data([0]);
        f.enter().append("g").classed("pathing-svg-container", !0), f.attr("transform", "translate(" + n.left + "," + n.top + ")");
        var l = r.selectAll(".pathing-cv-info-pane").data([0]);
        l.enter().append("div").classed("pathing-cv-info-pane", !0), l.exit().remove();
        var c = l.selectAll(".info-pane-content").data([0]);
        c.enter().append("div").classed("info-pane-content", !0), c.exit().remove();
        var h = c.selectAll(".pathing-cv-info-title").data([0]);
        h.enter().append("div").classed("pathing-cv-info-title", !0), h.exit().remove();
        var p = c.selectAll(".pathing-cv-info-value").data([0]);
        p.enter().append("div").classed("pathing-cv-info-value", !0), p.exit().remove();
        var d = c.selectAll(".pathing-cv-info-paths").data([0]);
        d.enter().append("div").classed("pathing-cv-info-paths", !0), d.exit().remove(), this._sizeChart(), this._createGradients(a);
        var v = this._pathedObj;
        this._changedOptions && this._changedOptions.data && v ? this._isDataObjNode(v.data) ? this._unlockNode(v.data, v.elem)() : this._unlockLink(v.data, v.elem)() : (u.on("mousemove.node", null).on("click.node", null).on("click.link", null), this._removePathOverlays(u), this._removeNodeOptions(!0), this._defaultInformation())
    }, s._render = function() {
        Object.getPrototypeOf(s)._render.apply(this);
        if (!this._dataAdapter.isValidPathingData())
            return;
        this._createDiagram();
        var e = this._pathedObj;
        this._activePaths.length && e && (this._isDataObjNode(e.data) ? (this._renderNodePaths(e.data, e.elem, !0), this._showNodeOptions(e.data, e.elem)) : this._renderLinkPaths(e.data, e.elem, !0))
    }, s._postRender = function() {
        Object.getPrototypeOf(s)._postRender.apply(this)
    }, s._sizeChart = function(e) {
        clearTimeout(this._wrapperAnimation), clearTimeout(this._scrollAnimation);
        var t = this._options, n = this._dataAdapter.data(), s = i.select(t.parent), o = this, u = s.selectAll(".pathing-cv-info-wrapper"), a = u.selectAll(".pathing-cv-wrapper"), f = a.selectAll(".pathing-cv-container"), l = u.selectAll(".pathing-cv-info-pane"), c = t.parent.offsetWidth, h = t.parent.offsetHeight, p = r.util.getPercentValue(t.width, c), d = r.util.getPercentValue(t.height, h), v = p - parseInt(l.style("width"), 10), m = t.padding, g = n && n.nodes || [], y = this._numColumns = g.length && Math.max.apply(null, g.map(function(e) {
            return e.column
        })) + 1 || 1, b = [], w = 0;
        n.nodes.forEach(function(e, t) {
            b[e.column] ? b[e.column]++ : b[e.column] = 1
        }), w = b.length && Math.max.apply(null, b) || 0;
        var E = v - 2, S = d - 2, x = y * t.nodeWidth + (y - 1) * t.minNodeHorzPadding + m.left + m.right, T = w * t.avgNodeHeight + w * t.nodeVertPadding + m.top + m.bottom, N = x > v, C = T > d;
        a.classed("is-wider", N), N && (E = x, S -= 20), a.classed("is-taller", C), C && (S = T, E -= 20), u.style("width", p + "px").style("height", d + "px"), a.style("width", v + "px").style("height", d + "px"), f.style("width", E + "px").style("height", S + "px")
    }, s._getInnerDimensions = function() {
        var e = this._options, t = e.padding, n = i.select(e.parent).select(".pathing-cv-container"), r = parseInt(n.style("width"), 10), s = parseInt(n.style("height"), 10);
        return [r - t.right - t.left, s - t.top - t.bottom]
    }, s._createDiagram = function() {
        var e = this._options, t = this._dataAdapter.data(), n = i.select(e.parent).selectAll(".pathing-cv-container"), r = parseInt(n.style("width"), 10), s = parseInt(n.style("height"), 10), o = this._path = i.pathing().nodeWidth(e.nodeWidth).nodePadding(e.nodeVertPadding).size(this._getInnerDimensions()).nodes(t.nodes).links(t.links).minNodeHeight(e.minNodeHeight).layout(e.interations);
        if (!t.nodes.some(function(e) {
            return e.column !== 0
        })) {
            var u = o.nodeWidth(), a = e.padding;
            t.nodes.forEach(function(e) {
                e.x += (r - a.left - a.right) / 2 - u / 2
            })
        }
        var f = this._updateLinks(o, t.links);
        this._updateNodes(o, t.nodes, f, s);
        var l = i.select(e.parent).select(".pathing-svg").node();
        l.style.display = "none";
        var c = l.offsetHeight;
        l.style.display = ""
    }, s._updateNodes = function(e, t, n, r) {
        function p(t) {
            var s = r - this.getBBox().height - l.bottom;
            i.select(this).attr("transform", "translate(" + t.x + "," + (t.y = Math.max(0, Math.min(s, i.event.y))) + ")"), e.relayout(), n.attr("d", e.link())
        }
        var s = this, u = this._options, a = i.select(u.parent).select(".pathing-svg-container"), f = this._options.onNodeSelect, l = this._options.padding, c = !this._changedOptions || !this._changedOptions.data, h = c ? 0 : o, d = a.selectAll(".node-container").data([0]);
        d.enter().append("g").classed("node-container", !0), d.exit().remove();
        var v = d.selectAll(".node").data(t, this._dataAdapter.nodeKey()), m = e.nodeWidth();
        v.enter().append("g").classed("hide-node", !0).attr("transform", function(e) {
            return "translate(" + e.x + ",0)"
        }), v.on("mouseover.node", function(e, t) {
            s._showNodePaths(e, this)
        }).on("mouseout.node", function(e, t) {
            s._hideNodePaths()
        }).on("click.node", function(e, t) {
            s._activateNode(e, this)
        });
        var g = v.exit();
        g.classed("hide-node", !0).on("mouseover.node", null).on("mouseout.node", null).on("click.node", null).transition().duration(h).style("opacity", 0).attr("transform", function(e) {
            return "translate(" + e.x + ",0)"
        }), setTimeout(function() {
            g.remove()
        }, h), v.transition().duration(h).attr("transform", function(e) {
            return "translate(" + e.x + "," + e.y + ")"
        });
        var y = this._numColumns;
        v.each(function(t, n) {
            function u(e) {
                var t = !0, n = !1, r = !1;
                y > 1 && (n = 0 === e.column, r = y - 1 === e.column, t = !n && !r), i.select(this).attr("x", t ? m / 2 : n ? 2 : m - 4).attr("text-anchor", t ? "middle" : n ? "start" : "end")
            }
            function a(e) {
                var t = 20, n = 10, r = "…";
                return e.length < t ? e : e.slice(0, t - n) + r + e.slice(e.length - n)
            }
            var r = i.select(this), s = r.classed("hide-node");
            r.attr("class", "node"), r.classed("hide-node", s), r.classed("filter", t.id === "E_0"), r.classed("exit-filter", t.id === "X_0"), t.classname && r.classed(t.classname, !0);
            var o = r.selectAll(".node-bg").data([t]);
            o.enter().append("rect").classed("node-bg", !0), o.exit().remove(), o.attr("width", m), o.transition().duration(h).attr("height", function(e) {
                return e.dy
            });
            var f = r.selectAll(".node-title").data([t]);
            f.enter().append("text").classed("node-title", !0).attr("y", -5).attr("transform", null), f.exit().remove(), f.each(u), f.text(function(e) {
                return a(e.label)
            });
            var l = r.selectAll(".node-total").data([t]);
            l.enter().append("text").classed("node-total", !0).attr("y", 15).attr("transform", null), l.exit().remove(), l.each(u), l.text(function(e) {
                return i.format(",.0f")(e.value)
            });
            var c = r.selectAll(".node-hit-area").data([t]);
            c.enter().append("rect").classed("node-hit-area", !0), c.exit().remove(), c.attr("height", function(e) {
                return e.dy + 4
            }).attr("y", -4).attr("width", e.nodeWidth()).style("opacity", 0), setTimeout(function() {
                r.classed("hide-node", !1)
            }, h)
        })
    }, s.gradientCounter = {count: 0}, s._updateLinks = function(e, t) {
        var n = this._options, r = this, s = i.select(n.parent).select(".pathing-svg-container"), u = i.select(n.parent).selectAll("svg"), a = u.selectAll("defs").data([0]), f = !this._changedOptions || !this._changedOptions.data, l = f ? 0 : o;
        a.enter().append("defs");
        var c = a.selectAll(".path-fills").data([0]), h = c.enter().append("g").classed("path-fills", !0), p = s.selectAll(".link-container").data([0]);
        p.enter().append("g").classed("link-container", !0), p.exit().remove();
        var d = s.selectAll(".path-overlay-container").data([0]);
        d.enter().append("g").classed("path-overlay-container", !0), d.exit().remove();
        var v = p.selectAll("path").data(t, this._dataAdapter.linkKey());
        v.enter().append("path").classed("hide-link", !0), v.on("mouseover.link", function(e, t) {
            r._showLinkPaths(e, this)
        }).on("mouseout.link", function(e, t) {
            r._hideLinkPaths()
        }).on("click.link", function(e, t) {
            r._activateLink(e, this)
        });
        var m = v.exit();
        return m.classed("hide-link", !0).on("click.link", null).on("mouseover.link", null).on("mouseout.link", null), setTimeout(function() {
            m.remove()
        }, l), v.each(function(t, n) {
            var r = i.select(this), s = r.classed("hide-link");
            r.attr("class", function(e) {
                return e.source ? e.target ? "link" : "exit" : "entry"
            }), r.classed("hide-link", s), r.classed("hide-link") ? (r.attr("d", e.link()(t)), setTimeout(function() {
                r.classed("hide-link", !1)
            }, l)) : r.transition().duration(l).attr("d", e.link()(t)), t.source && "E_0" === t.source.id ? r.classed("entry-path", !0) : t.target && "X_0" === t.target.id && r.classed("exit-path", !0);
            var o = t.source && "E_0" === t.source.id, u = t.target && "X_0" === t.target.id;
            r.classed("filter", o), r.classed("exit-filter", u)
        }), v
    }, s._createGradients = function(e) {
        var t = e.selectAll("style").data([0]);
        t.enter().append("style"), t.text(function(e) {
            var t = ".pathing-svg .exit { fill: url(#exitFill); } \n";
            return t += ".pathing-svg .entry { fill: url(#entryFill); } \n", t += ".pathing-svg .exit:hover { fill: url(#exitHighlightFill); } \n", t += ".pathing-svg .entry:hover { fill: url(#entryHighlightFill); } \n", t += ".pathing-svg .pivot-entry { mask: url(#pivotEnterMask); } \n", t += ".pathing-svg .pivot-exit { mask: url(#pivotExitMask); } \n", t += ".pathing-svg .link-container .entry-path { fill: url(#entryGradient); } \n", t += ".pathing-svg .link-container .exit-path { fill: url(#exitGradient); } \n", t
        });
        var n = e.selectAll("defs").data([0]);
        n.enter().append("defs");
        var r = n.selectAll(".bounce-fills").data([0]), i = r.enter().append("g").classed("bounce-fills", !0), s = i.append("linearGradient").attr("id", "pivotEnterGrad");
        s.append("stop").attr("offset", "0%").style("stop-color", "#fff").style("stop-opacity", 0), s.append("stop").attr("offset", "50%").style("stop-color", "#fff").style("stop-opacity", 0), s.append("stop").attr("offset", "70%").style("stop-color", "#fff").style("stop-opacity", .5), s.append("stop").attr("offset", "100%").style("stop-color", "#fff").style("stop-opacity", 1);
        var o = i.append("mask").attr("id", "pivotEnterMask").attr("x", "0").attr("y", "0").attr("width", "1").attr("height", "1").attr("maskUnits", "objectBoundingBox").attr("maskContentUnits", "objectBoundingBox");
        o.append("rect").attr("x", "0").attr("y", "0").attr("width", "1").attr("height", "1").attr("fill", "url(#pivotEnterGrad)");
        var u = i.append("linearGradient").attr("id", "pivotExitGrad").attr("x1", "100%").attr("y1", "0%").attr("x2", "0%").attr("y2", "0%");
        u.append("stop").attr("offset", "0%").style("stop-color", "#fff").style("stop-opacity", 0), u.append("stop").attr("offset", "50%").style("stop-color", "#fff").style("stop-opacity", 0), u.append("stop").attr("offset", "70%").style("stop-color", "#fff").style("stop-opacity", .5), u.append("stop").attr("offset", "100%").style("stop-color", "#fff").style("stop-opacity", 1);
        var a = i.append("mask").attr("id", "pivotExitMask").attr("x", "0").attr("y", "0").attr("width", "1").attr("height", "1").attr("maskUnits", "objectBoundingBox").attr("maskContentUnits", "objectBoundingBox");
        a.append("rect").attr("x", "0").attr("y", "0").attr("width", "1").attr("height", "1").attr("fill", "url(#pivotExitGrad)");
        var f = i.append("linearGradient").attr("id", "entryGradient").attr("x1", "0%").attr("y1", "100%").attr("x2", "100%").attr("y2", "100%");
        f.append("stop").attr("offset", "0%").style("stop-color", "#8cc350"), f.append("stop").attr("offset", "100%").style("stop-color", "#3287D2");
        var l = i.append("linearGradient").attr("id", "exitGradient").attr("x1", "0%").attr("y1", "100%").attr("x2", "100%").attr("y2", "100%");
        l.append("stop").attr("offset", "0%").style("stop-color", "#3287D2"), l.append("stop").attr("offset", "100%").style("stop-color", "#cc2539");
        var c = i.append("linearGradient").attr("id", "exitFill").attr("x1", "0%").attr("y1", "0%").attr("x2", "0%").attr("y2", "100%");
        c.append("stop").attr("offset", "0%").style("stop-color", "#FA5A50").style("stop-opacity", .5), c.append("stop").attr("offset", "85%").style("stop-color", "#FA5A50").style("stop-opacity", .5), c.append("stop").attr("offset", "100%").style("stop-color", "#FA5A50").style("stop-opacity", .1);
        var h = i.append("linearGradient").attr("id", "exitHighlightFill").attr("x1", "0%").attr("y1", "0%").attr("x2", "0%").attr("y2", "100%");
        h.append("stop").attr("offset", "0%").style("stop-color", "#FA5A50").style("stop-opacity", 1), h.append("stop").attr("offset", "85%").style("stop-color", "#FA5A50").style("stop-opacity", 1), h.append("stop").attr("offset", "100%").style("stop-color", "#FA5A50").style("stop-opacity", .1);
        var p = i.append("linearGradient").attr("id", "entryFill").attr("x1", "0%").attr("y1", "0%").attr("x2", "0%").attr("y2", "100%");
        p.append("stop").attr("offset", "0%").style("stop-color", "#58AF5E").style("stop-opacity", .1), p.append("stop").attr("offset", "15%").style("stop-color", "#58AF5E").style("stop-opacity", .5), p.append("stop").attr("offset", "100%").style("stop-color", "#58AF5E").style("stop-opacity", .5);
        var d = i.append("linearGradient").attr("id", "entryHighlightFill").attr("x1", "0%").attr("y1", "0%").attr("x2", "0%").attr("y2", "100%");
        d.append("stop").attr("offset", "0%").style("stop-color", "#58AF5E").style("stop-opacity", .1), d.append("stop").attr("offset", "15%").style("stop-color", "#58AF5E").style("stop-opacity", 1), d.append("stop").attr("offset", "100%").style("stop-color", "#58AF5E").style("stop-opacity", 1)
    }, s._setOptionContainerContent = function(e, t) {
        var n = this._options, r = "", i, s = 0, o = e.classed("is-last-column"), u = this._dataAdapter, a = u.l10n.labels.pathing, f = [{id: "expand",label: a.expand,valid: n.expandNode && u.canExpandNode(t)}, {id: "pivot",label: a.focus,valid: n.pivotNode && u.canPivotNode(t)}, {id: "collapse",label: a.collapse,valid: n.collapseNode && u.canCollapseNode(t)}];
        o && f.reverse(), f = f.filter(function(e) {
            return e.valid
        });
        if (n.expandNode || n.collapseNode || n.pivotNode)
            for (var l = 0, c = f.length; l < c; ++l)
                i = f[l], r += '<a class="cv-node-option cv-node-option' + (o ? c - s - 1 : s) + " cv-node-" + i.id + '"><i class="' + i.id + '"></i><span>' + i.label + "</span></a>", ++s;
        r = '<div class="cv-node-options num-options-' + s + '">' + r + "</div>", e.html(r)
    }, s._activateNode = function(e, t) {
        var n = this;
        if (this._pathLocked && e === this._pathLocked.data) {
            n._unlockNode(e, t)();
            var r = i.mouse(t)[0] >= n._options.nodeWidth / 2 ? 1 : -1;
            if (!e.isPivot || r === n._lastSide)
                return
        }
        this._setPathLocked({data: e,elem: t}), i.select(n._options.parent).select(".pathing-cv-container").on("click.node", null).on("click.link", null), i.selectAll(".cv-node-active").classed("cv-node-active", !1), i.selectAll(".cv-link-active").classed("cv-link-active", !1), i.select(t).classed("cv-node-active", !0), this._renderNodePaths(e, t), this._showNodeOptions(e, t), this._showInformation(e, t), this._scrollToElem(t), setTimeout(function() {
            i.select(n._options.parent).select(".pathing-cv-container").on("click.node", n._unlockNode(e, t))
        }, 10)
    }, s._showNodePaths = function(e, t) {
        if (this._pathLocked)
            return;
        this._renderNodePaths(e, t)
    }, s._renderNodePaths = function(e, t, n) {
        function l() {
            a = o._activePaths = f.filter(function(t) {
                var n = t.nodes.indexOf(e._pid);
                return s > 0 && n + 1 < t.nodes.length || s < 0 && n > 0
            }), u = o._dataAdapter.nodePathData(a, e, s), o._createPathOverlays(u)
        }
        function c() {
            var e = 0;
            try {
                e = i.mouse(t)[0]
            } catch (n) {
            }
            var r = e >= o._options.nodeWidth / 2 ? 1 : -1;
            r !== s && (o._lastSide = s = r, l())
        }
        var r = i.select(this._options.parent).select(".pathing-cv-container");
        clearTimeout(this._hidePathOverlaysTimer), r.on("mousemove.node", null);
        if (this._pathedObj && this._pathedObj.data === e && !n)
            return;
        this._setPathedObj({data: e,elem: t});
        var s = 0, o = this, u, a, f = this._dataAdapter.nodePaths(e);
        e.isPivot ? n ? (s = o._lastSide, l()) : (c(), o._pathLocked || r.on("mousemove.node", function(e, t) {
            c()
        })) : (o._lastSide = 0, o._activePaths = f, u = this._dataAdapter.nodePathData(f, e, s), o._createPathOverlays(u)), setTimeout(function() {
            r.classed("path-overlays", !0)
        }, 1)
    }, s._showNodeOptions = function(e, t) {
        var n = this, r = this._numColumns, s = i.select(this._options.parent).select(".pathing-cv-container"), o = s.node(), u = this._options, a = 50, f = i.select(t).select(".node-bg").node(), l = o.getBoundingClientRect(), c = f.getBoundingClientRect(), h = c.top - l.top, p = c.left - l.left + u.nodeWidth / 2, d = s.select(".cv-path-node-options");
        if (d.empty())
            d = s.append("div").classed("cv-path-node-options", !0).attr("node", e._pid);
        else if (d.attr("node") != e._pid || !d.classed("is-open"))
            this._removeNodeOptions(), a = 300, d = s.append("div").classed("cv-path-node-options", !0).attr("node", e._pid);
        d.classed("is-last-column", r > 1 && r - 1 === e.column).style("top", h + "px").style("left", p + "px"), this._setOptionContainerContent(d, e), setTimeout(function() {
            d.classed("is-open", !0)
        }, a)
    }, s._formatMetricValue = function(e) {
        return this._formatNumber("decimal", e.value) + " " + this._options.metricName
    }, s._formatPathInformation = function(e) {
        var t = this._options, n = this, r = t.colors;
        return function(t, i) {
            var s = n._dataAdapter.getPathEnd(t), o = s ? s.value ? s.value : e : e, u = "", a = t.values[0], f = a / o;
            return i %= r.length, u += '<span class="pathing-path-marker" style="background-color: ' + r[i] + '"></span>', u += '<span class="pathing-path-value"><span class="pathing-path-num">' + n._formatNumber("decimal", a) + '</span> <span class="pathing-path-perc">' + n._formatNumber("percent", f) + "</span></span>", u
        }
    }, s._highlightPath = function(e, t, n) {
        var r = this._options, s = r.parent, o = i.event, u = !o || o && "click" === o.type, a = i.select(s).selectAll(".path-overlay-container"), f = i.select(s).selectAll(".pathing-cv-info-pane"), l = a.selectAll(".link.path" + t), c = a.selectAll(".link:not(.path" + t + ")");
        if (u) {
            if (this._lineLocked === e)
                return this._setLineLock(null), this._removeHightlightPath();
            this._setLineLock(e), f.selectAll(".locked").classed("locked", !1), i.select(n).classed("locked", !0)
        } else if (this._lineLocked)
            return;
        a.selectAll(".link.inactive").classed("inactive", !1), c.classed("inactive", !0), l.classed("active", !0)
    }, s._setLineLock = function(e) {
        var t = this._options;
        if (this._lineLocked === e)
            return;
        this._lineLocked = e, this._callPathSelected(e)
    }, s._setPathedObj = function(e) {
        this._pathedObj = e
    }, s._setPathLocked = function(e) {
        var t = this._options;
        if (this._pathLocked === e)
            return;
        this._pathLocked = e, this._callPathSelected()
    }, s._callPathSelected = function(e) {
        var t = {}, n = this._options, r = this._pathLocked && this._pathLocked.data || {};
        e && (t.path = e.nodes + ""), "undefined" != typeof r._pid && (t.node = r._pid, t.side = this._lastSide);
        if ("undefined" != typeof r.source || "undefined" != typeof r.target)
            t.source = r.source ? r.source._pid : null, t.target = r.target ? r.target._pid : null;
        "function" == typeof n.pathSelected && n.pathSelected(t, this._pathLocked, e)
    }, s._removeHightlightPath = function() {
        if (this._lineLocked)
            return;
        var e = this._options, t = e.parent, n = i.select(t).selectAll(".pathing-cv-info-pane"), r = i.select(t).selectAll(".path-overlay-container").selectAll(".link");
        r.classed("inactive", !1).classed("active", !1), n.selectAll(".locked").classed("locked", !1)
    }, s._showInformation = function(e, t) {
        var n = this, r = this._options, s = "", o = this._isDataObjNode(e), u = this._dataAdapter.l10n.labels.pathing, a = i.select(this._options.parent).select(".pathing-cv-info-pane"), f = a.selectAll(".pathing-cv-info-title"), l = a.selectAll(".pathing-cv-info-value"), c = a.selectAll(".pathing-cv-info-paths");
        this._setLineLock(null), this._removeHightlightPath();
        var h, p = this._formatMetricValue(e), d = !1;
        if (o)
            h = e.label, p = this._formatMetricValue(e), d = e.column == this._numColumns - 1;
        else {
            var v = u.percOfNode;
            if (!e.source)
                h = u.nodeEntries.replace(/\{label\}/i, e.target.label), p = this._formatMetricValue(e) + '<span class="perc">' + v.replace(/\{perc\}/i, this._formatNumber("percent", e.value / e.target.value)).replace(/\{label\}/i, e.target.label) + "</span>";
            else if (!e.target)
                h = u.nodeExits.replace(/\{label\}/i, e.source.label), p = this._formatMetricValue(e) + '<span class="perc">' + v.replace(/\{perc\}/i, this._formatNumber("percent", e.value / e.source.value)).replace(/\{label\}/i, e.source.label) + "</span>";
            else {
                var m = this._dataAdapter, g = m.getPathDirection(m.data().paths[e.paths[0]]), y = g < 0 ? e.target : e.source;
                h = u.nodeToNode.replace(/\{source\}/i, e.source.label).replace(/\{target\}/i, e.target.label), p = this._formatMetricValue(e) + '<span class="perc">' + v.replace(/\{perc\}/i, this._formatNumber("percent", e.value / y.value)).replace(/\{label\}/i, y.label) + "</span>"
            }
        }
        a.classed("is-last-column", d), f.html(h), l.html(p);
        var b = c.selectAll(".pathing-cv-path-title").data([0]);
        b.enter().append("span").classed("pathing-cv-path-title", !0), b.html(this._dataAdapter.activePathsTitle(this._activePaths));
        var w = c.selectAll(".pathing-cv-path-info").data(this._activePaths);
        w.enter().append("span").classed("pathing-cv-path-info", !0), w.on("click.line", function(e, t) {
            n._highlightPath(e, t, this)
        }).on("mouseover.line", function(e, t) {
            n._highlightPath(e, t, this)
        }).on("mouseout.line", function(e, t) {
            n._removeHightlightPath()
        }).html(this._formatPathInformation(e.value)), w.exit().on("click.line", null).on("mouseover.line", null).on("mouseout.line", null).remove()
    }, s._defaultInformation = function() {
        this._setLineLock(null), this._removeHightlightPath();
        var e = i.select(this._options.parent).select(".pathing-cv-info-pane"), t = e.selectAll(".pathing-cv-info-title"), n = e.selectAll(".pathing-cv-info-value"), r = e.selectAll(".pathing-cv-info-paths"), s = this._dataAdapter.l10n.labels.pathing, o = "<p>" + s.help1 + "</p>";
        o += "<p>" + s.help2 + "</p>", o += "<p>" + s.help3 + "</p>", o += '<p><span class="cv-node-option"><i class="pivot"></i></span><span class="cv-option-title">' + s.focus + "</span></p>", o += "<p>" + s.focusHelp + "</p>", o += '<p><span class="cv-node-option"><i class="expand"></i></span><span class="cv-option-title">' + s.expand + "</span></p>", o += "<p>" + s.expandHelp + "</p>", o += '<p><span class="cv-node-option"><i class="collapse"></i></span><span class="cv-option-title">' + s.collapse + "</span></p>", o += "<p>" + s.collapseHelp + "</p>", t.html(s.title), n.html('<div class="help">' + o + "</div>"), r.html("")
    }, s._scrollToElem = function(e) {
        function h(e, t) {
            return function() {
                var n = e !== null ? i.interpolateNumber(s.node().scrollLeft, e) : null, r = t !== null ? i.interpolateNumber(s.node().scrollTop, t) : null;
                return function(e) {
                    n !== null && (s.node().scrollLeft = n(e)), r !== null && (s.node().scrollTop = r(e))
                }
            }
        }
        var t = this._options, n = i.select(this._options.parent).select(".pathing-cv-container"), r = n.node(), s = i.select(t.parent).select(".pathing-cv-wrapper"), o = i.select(e), u = o.selectAll(".node-bg").empty() ? o.node() : o.select(".node-bg").node(), a = r.getBoundingClientRect(), f = u.getBoundingClientRect(), l = f.top - a.top, c = f.left - a.left + t.nodeWidth / 2;
        if (!s.classed("is-wider") && !s.classed("is-taller"))
            return;
        var p = null, d = null;
        if (s.classed("is-wider")) {
            var v = parseInt(s.style("width"), 10), m = parseInt(n.style("width"), 10);
            p = Math.min(m - v, Math.max(0, c - v / 2))
        }
        if (s.classed("is-taller")) {
            var g = parseInt(s.style("height"), 10), y = parseInt(n.style("height"), 10);
            d = Math.min(y - g, Math.max(0, l + 40 - g / 2))
        }
        i.transition().duration(300).tween("scroll", h(p, d))
    }, s._unlockNode = function(e, t) {
        var n = this;
        return function(r, s) {
            n._setPathLocked(null), i.select(n._options.parent).select(".pathing-cv-container").on("click.node", null), n._deactivateNode(i.event, e, t)
        }
    }, s._deactivateNode = function(e, t, n) {
        var r = i.select(e.target), s = this._options, o = t || {};
        i.select(n).classed("cv-node-active", !1), this._removeNodeOptions(!1), this._defaultInformation(), this._hideNodePaths(), "click" === e.type && (r.classed("cv-node-option") || (r = i.select(r.node().parentNode)), r.classed("cv-node-expand") && "function" == typeof s.expandNode && s.expandNode(o), r.classed("cv-node-collapse") && "function" == typeof s.collapseNode && s.collapseNode(o), r.classed("cv-node-pivot") && "function" == typeof s.pivotNode && s.pivotNode(o))
    }, s._removeNodeOptions = function(e) {
        var t = i.selectAll(".cv-path-node-options");
        t.classed("is-open", !1), setTimeout(function() {
            t.remove()
        }, e ? 0 : 300)
    }, s._hideNodePaths = function() {
        var e = i.select(this._options.parent).select(".pathing-cv-container");
        e.on("mousemove.node", null);
        if (this._pathLocked)
            return;
        this._removePathOverlays(e)
    }, s._activateLink = function(e, t) {
        var n = this;
        if (this._pathLocked && e === this._pathLocked.data) {
            n._unlockLink(e, t);
            return
        }
        this._setPathLocked({data: e,elem: t}), i.select(n._options.parent).select(".pathing-cv-container").on("click.node", null).on("click.link", null), i.selectAll(".cv-node-active").classed("cv-node-active", !1), i.selectAll(".cv-link-active").classed("cv-link-active", !1), i.select(t).classed("cv-link-active", !0), this._removeNodeOptions(), this._renderLinkPaths(e, t), this._showInformation(e, t), this._scrollToElem(t), setTimeout(function() {
            i.select(n._options.parent).select(".pathing-cv-container").on("click.link", n._unlockLink(e, t))
        }, 10)
    }, s._showLinkPaths = function(e, t) {
        if (this._pathLocked)
            return;
        this._renderLinkPaths(e, t)
    }, s._renderLinkPaths = function(e, t, n) {
        clearTimeout(this._hidePathOverlaysTimer);
        if (this._pathedObj && this._pathedObj.data === e && !n)
            return;
        this._setPathedObj({data: e,elem: t});
        var r = this._dataAdapter;
        this._activePaths = r.linkSortActivePaths(e), this._createPathOverlays(r.linkPathData(this._activePaths));
        var s = i.select(this._options.parent).select(".pathing-cv-container");
        setTimeout(function() {
            s.classed("path-overlays", !0)
        }, 1)
    }, s._unlockLink = function(e, t) {
        var n = this;
        return function(r, s) {
            n._setPathLocked(null), i.select(n._options.parent).select(".pathing-cv-container").on("click.link", null), n._deactivateLink(i.event, e, t)
        }
    }, s._deactivateLink = function(e, t, n) {
        var r = i.select(this._options.parent).select(".pathing-cv-container");
        i.select(n).classed("cv-link-active", !1), this._defaultInformation(), this._hideLinkPaths()
    }, s._hideLinkPaths = function() {
        var e = i.select(this._options.parent).select(".pathing-cv-container");
        if (this._pathLocked)
            return;
        this._removePathOverlays(e)
    }, s._createPathOverlays = function(e) {
        var t = this._options, n = this._path, r = i.select(t.parent).select(".path-overlay-container"), s = r.selectAll("path").data(e);
        s.enter().append("path"), s.exit().remove(), s.attr("class", function(e) {
            var t = e.pivotStart ? " pivot-entry" : e.pivotEnd ? " pivot-exit" : "";
            return "link path" + e.path + t
        }).attr("d", n.link()).attr("style", function(e, n) {
            var r = e.path % t.colors.length;
            return "fill: " + t.colors[r] + ";"
        }).sort(function(e, t) {
            return !e && !t ? 0 : e ? t ? t.dy - e.dy : -1 : 1
        })
    }, s._removePathOverlays = function(e) {
        clearTimeout(this._hidePathOverlaysTimer), this._setPathedObj(null), this._hidePathOverlaysTimer = setTimeout(function() {
            e.classed("path-overlays", !1)
        }, 20)
    }, s._isDataObjNode = function(e) {
        return "undefined" != typeof e._pid
    }, s.setActivePath = function(e) {
        var t = this._options, n = this, r = this._dataAdapter.data();
        e = e || {};
        var s = "undefined" != typeof e.node, o, u;
        s ? o = r.nodesById[e.node] : (o = r.links.filter(function(t) {
            return (!t.source && !e.source || t.source && e.source && t.source._pid + "" === e.source) && (!t.target && !e.target || t.target && e.target && t.target._pid + "" === e.target)
        }), o = o.length && o[0] || null), u = s ? ".node" : ".link";
        if (!o)
            return;
        var a = !1, f;
        a = r.paths.some(function(t) {
            return f = t.nodes, t.nodes.toString() === e.path
        }), i.select(t.parent).selectAll(u).each(function(e, r) {
            if (e === o) {
                s ? n._activateNode(e, this) : n._activateLink(e, this);
                if (!a)
                    return;
                i.select(t.parent).selectAll(".pathing-cv-path-info").filter(function(e, t) {
                    e.nodes.toString() === f.toString() && n._highlightPath(e, t, this)
                })
            }
        })
    }, e.cloudViz.pathing = t.util.createConstructor(s)
}(this), function(e) {
    d3.pathing = function() {
        function a() {
            i.forEach(function(e) {
                e.sourceLinks = [], e.targetLinks = [], e.entryLinks = [], e.exitLinks = []
            }), s.forEach(function(e) {
                var t = e.source, n = e.target;
                t !== null && typeof t == "number" && (t = e.source = i[e.source]), n !== null && typeof n == "number" && (n = e.target = i[e.target]), t !== null && n !== null ? (t.sourceLinks.push(e), n.targetLinks.push(e)) : t === null ? n.entryLinks.push(e) : t.exitLinks.push(e)
            })
        }
        function f() {
            function e(e) {
                return e.sourceLinks && e.sourceLinks.length || e.targetLinks && e.targetLinks.length || e.exitLinks && e.exitLinks.length || e.entryLinks && e.entryLinks.length
            }
            i.forEach(function(e) {
                e.hasOwnProperty("total") ? e.value = e.total : e.value = Math.max(d3.sum(e.sourceLinks, g) + d3.sum(e.exitLinks, g), d3.sum(e.targetLinks, g) + d3.sum(e.entryLinks, g))
            }), i.sort(function(t, n) {
                var r = e(t), i = e(n);
                return r && !i ? -1 : i && !r ? 1 : n.value - t.value
            })
        }
        function l() {
            var e = 0, n = [], s = r[0] - t;
            i.forEach(function(e) {
                e.x = e.column, e.dx = t, n.indexOf(e.column) < 0 ? (n.push(e.column), e.columnIndex = n.length - 1) : e.columnIndex = n.indexOf(e.column)
            }), o = n.length, p(o > 1 ? s / (o - 1) : s)
        }
        function c() {
            i.forEach(function(e) {
                e.targetLinks.length || (e.x = d3.min(e.sourceLinks, function(e) {
                    return e.target.x
                }) - 1)
            })
        }
        function h(e) {
            i.forEach(function(t) {
                t.sourceLinks.length || (t.x = e - 1)
            })
        }
        function p(e) {
            i.forEach(function(t) {
                t.x *= e
            })
        }
        function d(e) {
            function o() {
                var e = d3.min(t, function(e) {
                    var t = d3.sum(e, g) || 1;
                    return (r[1] - (e.length - 1) * n) / t
                });
                t.forEach(function(t) {
                    t.forEach(function(t, n) {
                        t.y = n, t.dy = Math.max(u, t.value * e)
                    })
                }), s.forEach(function(t) {
                    t.dy = t.value * e
                })
            }
            function a(e) {
                function n(e) {
                    return m(e.source) * e.value
                }
                t.forEach(function(t, r) {
                    t.forEach(function(t) {
                        if (t.targetLinks.length) {
                            var r = d3.sum(t.targetLinks, n) / d3.sum(t.targetLinks, g);
                            t.y += (r - m(t)) * e
                        }
                    })
                })
            }
            function f(e) {
                function n(e) {
                    return m(e.target) * e.value
                }
                t.slice().reverse().forEach(function(t) {
                    t.forEach(function(t) {
                        if (t.sourceLinks.length) {
                            var r = d3.sum(t.sourceLinks, n) / d3.sum(t.sourceLinks, g);
                            t.y += (r - m(t)) * e
                        }
                    })
                })
            }
            function l() {
                t.forEach(function(e) {
                    var t, i, s = 0, o = e.length, u;
                    e.sort(c);
                    for (u = 0; u < o; ++u)
                        t = e[u], i = s - t.y, i > 0 && (t.y += i), s = t.y + t.dy + n;
                    i = s - n - r[1];
                    if (i > 0) {
                        s = t.y -= i;
                        for (u = o - 2; u >= 0; --u)
                            t = e[u], i = t.y + t.dy + n - s, i > 0 && (t.y -= i), s = t.y
                    }
                })
            }
            function c(e, t) {
                return e.y - t.y
            }
            var t = d3.nest().key(function(e) {
                return e.x
            }).sortKeys(d3.ascending).entries(i).map(function(e) {
                return e.values
            });
            o(), l();
            for (var h = 1; e > 0; --e)
                f(h *= .99), l(), a(h), l()
        }
        function v() {
            function e(e, t) {
                return e.source.y - t.source.y
            }
            function t(e, t) {
                return e.target.y - t.target.y
            }
            i.forEach(function(n) {
                n.sourceLinks.sort(t), n.targetLinks.sort(e)
            }), i.forEach(function(e) {
                var t = 0, n = 0;
                e.entryLinks.forEach(function(e) {
                    e.ty = n, n += e.dy
                }), e.sourceLinks.forEach(function(e) {
                    e.sy = t, t += e.dy
                }), e.targetLinks.forEach(function(e) {
                    e.ty = n, n += e.dy
                }), e.exitLinks.forEach(function(e) {
                    e.sy = t, t += e.dy
                })
            })
        }
        function m(e) {
            return e.y + e.dy / 2
        }
        function g(e) {
            return e.value
        }
        var e = {}, t = 24, n = 8, r = [1, 1], i = [], s = [], o = NaN, u = 0;
        return e.nodeWidth = function(n) {
            return arguments.length ? (t = +n, e) : t
        }, e.nodePadding = function(t) {
            return arguments.length ? (n = +t, e) : n
        }, e.nodes = function(t) {
            return arguments.length ? (i = t, e) : i
        }, e.links = function(t) {
            return arguments.length ? (s = t, e) : s
        }, e.size = function(t) {
            return arguments.length ? (r = t, e) : r
        }, e.numColumns = function() {
            return o
        }, e.minNodeHeight = function(t) {
            return arguments.length ? (u = t, e) : u
        }, e.layout = function(t) {
            return a(), f(), l(), d(t), v(), e
        }, e.relayout = function() {
            return v(), e
        }, e.link = function() {
            function t(t) {
                var n, r, i, s, o, u, a, f, l, c, h, p, d, v = 5, m = 15;
                return p = d = Math.min(t.dy + v, m), t.source === null ? (n = t.target.x - p, r = t.target.x, f = t.target.y - v, l = t.target.y + t.dy, "M" + n + "," + f + "h" + p + "v" + (l - f) + "c-" + p + ",0" + ",-" + p + ",-" + d / 2 + ",-" + p + ",-" + d + "z") : t.target === null ? (n = t.source.x + t.source.dx, r = t.source.x + t.source.dx + p, f = t.source.y + t.source.dy - t.dy, l = t.source.y + t.source.dy + v, "M" + r + "," + l + "h-" + p + "v-" + (l - f) + "c" + p + ",0" + "," + p + "," + d / 2 + "," + p + "," + d + "V" + l + "z") : (n = t.source.x + t.source.dx, r = t.target.x, i = d3.interpolateNumber(n, r), s = i(e), o = i(1 - e), u = o + (t.dy < 15 ? t.source.y < t.target.y ? -1 * t.dy : t.dy : 0), a = s + (t.dy < 15 ? t.source.y < t.target.y ? -1 * t.dy : t.dy : 0), f = t.source.y + t.sy, l = t.target.y + t.ty, c = l + t.dy, h = f + t.dy, "M" + n + "," + f + "C" + s + "," + f + " " + o + "," + l + " " + r + "," + l + "v" + t.dy + "C" + u + "," + c + " " + a + "," + h + " " + n + "," + h + "Z")
            }
            var e = .5;
            return t.curvature = function(n) {
                return arguments.length ? (e = +n, t) : e
            }, t
        }, e
    }
}(this), function(e) {
    function o(e) {
        var t = [], n = !0;
        for (var r in e) {
            var i = e[r], s = -1, o = i.length;
            while (++s < o) {
                var u, a = i[s];
                n ? (u = {}, t.push(u)) : u = t[s], u[r] = a
            }
            n = !1
        }
        return t
    }
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        return this._type = "anomaly", e = e || {}, this._initDefaultOptions(), this.setOptions(e), this._initializeAnomaly(), this
    }, s._initDefaultOptions = function(e) {
        var t = {mappings: {x: "date",y: "deviation",category: "metric"},bins: 12,xTicks: 7,xTickInterval: undefined,xUpperLimit: undefined,xLowerLimit: undefined,normalizePositive: !1,onMouseOverAnomaly: null,onMouseOutAnomaly: null,onSelectAnomalies: null};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s._render = function() {
        this._configureAnomaly(), this._anom.layout()
    }, s._initializeAnomaly = function() {
        var e = this._options, t = e.mappings, n = this;
        this._anom = i.anomaly().on("mouseover", function(r, s, o) {
            n._anom.nodes(function(e, n) {
                var r = i.select(this).transition().duration(750).style("opacity", e[t.category] === s[t.category] ? .8 : .2)
            }), e.onMouseOverAnomaly && e.onMouseOverAnomaly.call(r, s, o)
        }).on("mouseout", function(t, r, s) {
            n._anom.nodes(function(e, t) {
                var n = i.select(this).transition().duration(750).style("opacity", 1)
            }), e.onMouseOutAnomaly && e.onMouseOutAnomaly.call(t, r, s)
        }).on("select", function(t) {
            n._anom.nodes(function(e, t) {
                i.select(this).classed("selected", !1)
            }), t.classed("selected", !0), e.onSelectAnomalies && e.onSelectAnomalies.call(t)
        })
    }, s._configureAnomaly = function() {
        var e = this._options, t = r.util.getPercentValue(e.width, e.parent.offsetWidth), n = r.util.getPercentValue(e.height, e.parent.offsetHeight);
        this._anom.data(o(e.data)).parent(e.parent).mappings(e.mappings).bins(e.bins).size([t, n]).xUpperLimit(e.xUpperLimit).xLowerLimit(e.xLowerLimit).normalizePositive(e.normalizePositive).xTicks(e.xTicks, e.xTickInterval)
    }, s._onAutoResize = function() {
        this.render()
    }, s.chart = function() {
        return this._anom
    }, e.cloudViz.anomaly = t.util.createConstructor(s)
}(this), function(e) {
    d3.choropleth = function() {
        function N() {
            this.type = "EmptyDataException", this.message = "The data is empty or null", this.toString = function() {
                return this.type + " - " + this.message
            }
        }
        function C() {
            this.type = "ParentNotSpecifiedException", this.message = "A parent was not specified for this visualization", this.toString = function() {
                return this.type + " - " + this.message
            }
        }
        var e = ["#fae6be", "#eb782d", "#dc283c", "#640046"], t = ["#c7b797", "#b85e23", "#a81e2e", "#300022"], n = ["#faf0c8", "#d2dc73", "#5faf69", "#00505A"], r = ["#c7bf9f", "#a0a858", "#437d4a", "#002226"], i = {}, s, o = [], u, a, f, l, c, h, p, d, v, m, g, y, b = [0, 1], w = (g - y) * b[0], E = (g - y) * b[1], S = {}, x = !1, T = {top: 0,left: 0,right: 0,bottom: 40};
        return i.layout = function() {
            var e = this;
            if (!i.data())
                throw new N;
            if (!i.parent())
                throw new C;
            o = i.determineSize(p), i.calcRange(), l = i.createSVGContainer(), typeof p.geoJson == "string" ? d3.json(p.geoJson, function(t) {
                e._layoutWithData.call(e, t)
            }) : this._layoutWithData(p.geoJson)
        }, i._layoutWithData = function(e) {
            i.drawGeos(e), p.interactive && i.drawTooltip(), i.drawLegend(p.theme, e)
        }, i.determineSize = function(e) {
            var t = e.parent, n = e.width ? e.width : t.offsetWidth, r = e.height ? e.height : t.offsetHeight;
            return n = n ? n : 700, r = r ? r : 450, [n, r]
        }, i.calcRange = function() {
            for (var e in p.data.values)
                typeof g == "undefined" && (g = p.data.values[e], y = p.data.values[e]), p.data.values[e] > g && (g = p.data.values[e]), p.data.values[e] < y && (y = p.data.values[e])
        }, i.drawLegend = function(u, a) {
            var l = this, h = 9, d = 12, v = 35, m = Math.min(o[0] - T.left, 630) - 25, w = (o[0] - T.left - m) / 2, E = m - v * 2 - d * 2, S = [], N = [];
            typeof u != "undefined" && u == "salmonRun" ? (S = e, N = t) : (S = n, N = r);
            var C = c.selectAll(".legend").data([s]);
            C.enter().append("g").classed("legend", !0), C.attr("transform", "translate(" + w + "," + (o[1] - 24) + ")");
            var k = C.selectAll("defs").data([u]);
            k.enter().append("defs"), k.exit().remove();
            var L = k.selectAll("#defaultGradient-" + u).data([u]);
            L.enter().append("linearGradient").attr("id", "defaultGradient-" + u), L.exit().remove();
            var A = k.selectAll("#darkGradient-" + u).data([u]);
            A.enter().append("linearGradient").attr("id", "darkGradient-" + u), A.exit().remove();
            var O = ["0%", "33%", "67%", "100%"], M = function(e, t, n) {
                var r = e.selectAll("stop").data(t);
                r.enter().append("stop").attr("class", function(e, t) {
                    return "stop" + t
                }), r.attr("offset", function(e) {
                    return e
                }).attr("stop-color", function(e, t) {
                    return n[t]
                })
            };
            M(L, O, S), M(A, O, N);
            var _ = C.selectAll(".grad-bg").data([s]);
            _.enter().append("rect").classed("grad-bg", !0), _.attr("x", v + d).attr("y", 0).attr("rx", h / 2).attr("ry", h / 2).attr("width", E).attr("height", h);
            var D = C.selectAll(".grad-rect").data([s]);
            D.enter().append("rect").classed("grad-rect", !0), D.classed("grad-rect", !0).attr("x", v + d).attr("y", 0).style("stroke", "url(#darkGradient-" + u + ")").style("fill", "url(#defaultGradient-" + u + ")").attr("width", E).attr("height", h);
            var P = f.selectAll(".legend-label").data([y, g]);
            P.enter().append("div").attr("class", function(e, t) {
                return "legend-label " + (t ? "max" : "min")
            }), P.style("left", function(e, t) {
                return t ? null : w + "px"
            }).style("right", function(e, t) {
                return t ? w + "px" : null
            }).text(function(e, t) {
                return p.formatFunction(t ? g : y)
            });
            if (p.interactive) {
                var H = d3.svg.brush().x(d3.scale.linear().range([0, E])).extent(b).on("brushstart", function() {
                    x = !0
                }).on("brushend", function() {
                    x = !1
                }).on("brush", function() {
                    b = H.extent(), c.selectAll(".grad-rect").attr("width", (b[1] - b[0]) * E).attr("x", E * b[0] + v + d), i.drawGeos(a)
                }), B = 9, j = 26, F = C.selectAll(".brush").data([s]);
                F.enter().append("g").classed("brush", !0), F.attr("transform", "translate(" + (v + d) + ",0)").call(H);
                var I = F.selectAll(".resize"), q = I.selectAll(".handle").data(function(e) {
                    return e
                });
                q.enter().append("rect").classed("handle", !0), q.attr("transform", "translate(" + -(B / 2) + "," + -B + ")").attr("rx", B / 3).attr("ry", B / 3).attr("width", B).attr("height", j)
            }
        }, i.drawTooltip = function(e) {
            var t = this, n = e == null || e.value == null;
            m = f.selectAll(".tooltip").data(n ? [] : [e]), m.enter().append("div").classed("tooltip", !0), m.exit().classed("visible", !1), setTimeout(function() {
                m.classed("visible", !0)
            }, 10);
            var r = m.selectAll(".tooltip-back").data([e]);
            r.enter().append("div").classed("tooltip-back", !0);
            var i = r.selectAll(".tt-name").data(function(e) {
                return [e.name]
            });
            i.enter().append("p").classed("tt-name", !0), i.text(function(e) {
                return e
            });
            var s = r.selectAll(".tt-value").data(function(e) {
                return [e.value]
            });
            s.enter().append("p").classed("tt-value", !0), s.text(function(e) {
                return p.formatFunction(e)
            });
            var o = r.selectAll(".tt-metric").data(typeof p.metric != "undefined" ? [p.metric] : []);
            o.enter().append("p").classed("tt-metric", !0), o.text(function(e) {
                return e
            }), o.exit().remove()
        }, i.hideTooltip = function() {
            i.drawTooltip({})
        }, i.showTooltip = function(e) {
            "value" in e && e.value ? i.drawTooltip(e) : i.hideTooltip()
        }, i.drawGeos = function(t) {
            var r = null, u, f, v, m = 1, S = Math.min(o[0], o[1]), N = o[0] - T.left - T.right, C = o[1] - T.top - T.bottom, k = 1, L = [0, 0];
            p.projection ? d = d3.geo[p.projection]() : d = d3.geo.equirectangular(), d.scale(k).translate(L);
            var A = d3.geo.path().projection(d), O = A.bounds(t);
            k = .95 / Math.max((O[1][0] - O[0][0]) / N, (O[1][1] - O[0][1]) / C), L = [(N - k * (O[1][0] + O[0][0])) / 2, (C - k * (O[1][1] + O[0][1])) / 2];
            var M = k * ((O[1][1] - O[0][1]) / C) * C, _ = k * ((O[1][0] - O[0][0]) / N) * N;
            d.scale(k).translate(L), A = A.projection(d);
            if (p.interactive) {
                var D = d3.behavior.zoom(), P = 4;
                h.call(D.scaleExtent([1, P]).translate([N / 2, C / 2]).scale(1).on("zoom", function() {
                    if (d3.event) {
                        var e = d3.event.translate, t = d3.event.scale, n = N / 2 * t, r = C / 2 * t, i = e[0] - n, s = e[1] - r, o = _ / 6, u = M / 6, a = -n - o, f = N - n + o, c = -r - u, h = C - r + u;
                        i = Math.min(i, f), i = Math.max(i, a), s = Math.min(s, h), s = Math.max(s, c), e[0] = i + n, e[1] = s + r, D.translate(e), l.attr("transform", "translate(" + i + "," + s + ") scale(" + t + ")")
                    }
                }))
            }
            w = (g - y) * b[0] + y, E = (g - y) * b[1] + y, u = [w, (E - w) / 3 + w, (E - w) / 3 * 2 + w, E], a.selectAll(".legend-label.min").text(function(e, t) {
                return p.formatFunction(w)
            }), a.selectAll(".legend-label.max").text(function(e, t) {
                return p.formatFunction(E)
            }), p.theme == "salmonRun" ? r = d3.scale.linear().domain(u).range(e) : r = d3.scale.linear().domain(u).range(n);
            var H = function(e) {
                return typeof s.values[e.properties.GEO_ID] == "undefined" || s.values[e.properties.GEO_ID] < w || s.values[e.properties.GEO_ID] > E ? "#ddd" : r(s.values[e.properties.GEO_ID])
            }, B = function(e, t) {
                if (x)
                    return;
                var n = e.properties.GEO_ID, r = c.selectAll("#" + n), o = r.node();
                o.parentNode.appendChild(o), r.classed("selected", !0), i.showTooltip({name: e.properties.name,id: e.properties.GEO_ID,value: s.values[e.properties.GEO_ID]})
            }, j = function(e, t) {
                if (x)
                    return;
                var n = e.properties.GEO_ID, r = c.selectAll("#" + n), s = r.node(), o = s.parentNode;
                r.classed("selected", !1), i.hideTooltip()
            }, F = l.selectAll(".geo").data(t.features, function(e) {
                return e.properties.GEO_ID
            });
            F.enter().append("path").classed("geo", !0).attr("id", function(e, t) {
                return e.properties.GEO_ID
            }).attr("vector-effect", "non-scaling-stroke").on("mouseover.choro", p.interactive ? B : null).on("mouseout.choro", p.interactive ? j : null), F.exit().on("mouseover.choro", null).on("mouseout.choro", null), F.attr("d", A).style("fill", H)
        }, i.createSVGContainer = function() {
            a = d3.select(u), f = a.selectAll(".cv-choropleth").data([s]), f.enter().append("div").classed("cv-choropleth", !0), f.style("width", o[0] + "px").style("height", o[1] + "px"), c = f.selectAll("svg").data([s]), c.enter().append("svg").attr("width", "100%").attr("height", "100%"), c.exit().remove();
            var e = c.selectAll("#plotClip").data([0]);
            e.enter().append("clipPath").attr("id", "plotClip").append("rect"), e.select("rect").attr("x", T.left).attr("y", T.top).attr("width", o[0] - T.left - T.right).attr("height", o[1] - T.top - T.bottom);
            var t = c.selectAll(".container-bg").data([s]);
            t.enter().append("rect").classed("container-bg", !0).attr("width", "100%").attr("height", "100%"), h = c.selectAll(".zoom-container").data([s]), h.enter().append("g").classed("zoom-container", !0).attr("clip-path", "url(#plotClip)");
            var n = h.selectAll(".zoom-container-plot-bg").data([s]);
            n.enter().append("rect").classed("zoom-container-plot-bg", !0), n.attr("x", T.left).attr("y", T.top).attr("width", o[0] - T.left - T.right).attr("height", o[1] - T.top - T.bottom);
            var r = h.selectAll(".choro-container").data([s]);
            return r.enter().append("g").classed("choro-container", !0), r
        }, i.data = function(e) {
            return arguments.length ? (s = e, i) : s
        }, i.parent = function(e) {
            return arguments.length ? (u = e, i) : u
        }, i.options = function(e) {
            return arguments.length ? (p = e, i) : p
        }, i
    }, d3.choropleth.gradIdCounter = 0
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        return this._type = "choropleth", e = e || {}, this._initDefaultOptions(), this.setOptions(e), this._initChoropleth(), this
    }, s._initDefaultOptions = function(e) {
        var t = {geoJson: null,theme: "sunnyDay",metric: "",projection: "equirectangular",format: "decimal",interactive: !0};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s._render = function() {
        this._configure(), this._choro.layout()
    }, s._initChoropleth = function() {
        this._choro = i.choropleth()
    }, s._configure = function() {
        var e = this, t = this._options, n = this._dataAdapter;
        t.formatFunction = function(n) {
            return e._formatNumber(t.format, n)
        }, t.metric = n.metric(), t.format = n.format(), t.data = n.data(), this._choro.data(this._options.data).parent(this._options.parent).options(this._options)
    }, e.cloudViz.choropleth = t.util.createConstructor(s)
}(this), function(e) {
    function t(e, t) {
        var n = new Array(e[1].length || 0);
        for (var r = 0; r < n.length; ++r)
            n[r] = e[0] * e[1][r] + t[0] * t[1][r];
        return n
    }
    e.venn = function(t, n, r) {
        r = r || {}, r.distance = r.distance || 0, r.maxIterations = r.maxIterations || 500;
        var i = r.lossFunction || e.lossFunction, s = r.layoutFunction || e.greedyLayout;
        t = s(t, n, r.distance);
        var o = new Array(2 * t.length);
        for (var u = 0; u < t.length; ++u)
            o[2 * u] = t[u].x, o[2 * u + 1] = t[u].y;
        var a = 0, f = e.fmin(function(e) {
            a += 1;
            var r = new Array(t.length);
            for (var s = 0; s < t.length; ++s)
                r[s] = {x: e[2 * s],y: e[2 * s + 1],radius: t[s].radius,size: t[s].size};
            return i(r, n)
        }, o, r), l = f.solution;
        for (u = 0; u < t.length; ++u)
            t[u].x = l[2 * u], t[u].y = l[2 * u + 1];
        return t
    }, e.distanceFromIntersectArea = function(t, n, r) {
        return Math.min(t, n) * Math.min(t, n) * Math.PI < r ? Math.abs(t - n) : e.bisect(function(e) {
            return window.circleIntersection.circleOverlap(t, n, e) - r
        }, 0, t + n)
    }, e.getDistanceMatrix = function(t, n, r) {
        var i = [], s;
        for (s = 0; s < t.length; ++s) {
            i.push([]);
            for (var o = 0; o < t.length; ++o)
                i[s].push(0)
        }
        for (s = 0; s < n.length; ++s) {
            var u = n[s];
            if (u.sets.length !== 2)
                continue;
            var a = u.sets[0], f = u.sets[1], l = Math.sqrt(t[a].size / Math.PI), c = Math.sqrt(t[f].size / Math.PI), h = e.distanceFromIntersectArea(l, c, u.size) + r;
            i[a][f] = i[f][a] = h
        }
        return i
    }, e.greedyLayout = function(t, n, r) {
        function p(e, t) {
            return t.size - e.size
        }
        function v(e) {
            return e.set in d
        }
        function m(e, n) {
            t[n].x = e.x, t[n].y = e.y, d[n] = !0
        }
        var i = {}, s, o, u;
        for (o = 0; o < t.length; ++o)
            i[o] = [], t[o].radius = Math.sqrt(t[o].size / Math.PI), t[o].x = t[o].y = 0;
        for (o = 0; o < n.length; ++o) {
            var a = n[o];
            if (a.sets.length !== 2)
                continue;
            var f = a.sets[0], l = a.sets[1];
            if (!i[f] || !i[l])
                continue;
            i[f].push({set: l,size: a.size}), i[l].push({set: f,size: a.size})
        }
        var c = [];
        for (s in i)
            if (i.hasOwnProperty(s)) {
                var h = 0;
                for (o = 0; o < i[s].length; ++o)
                    h += i[s][o].size;
                c.push({set: s,size: h})
            }
        if (!c.length)
            return t;
        c.sort(p);
        var d = {};
        m({x: 0,y: 0}, c[0].set);
        var g = e.getDistanceMatrix(t, n, r);
        for (o = 1; o < c.length; ++o) {
            var y = c[o].set, b = i[y].filter(v);
            s = t[y], b.sort(p);
            if (b.length === 0)
                throw "Need overlap information for set " + s;
            var w = [];
            for (u = 0; u < b.length; ++u) {
                var E = t[b[u].set], S = g[y][b[u].set];
                w.push({x: E.x + S,y: E.y}), w.push({x: E.x - S,y: E.y}), w.push({y: E.y + S,x: E.x}), w.push({y: E.y - S,x: E.x});
                for (var x = u + 1; x < b.length; ++x) {
                    var T = t[b[x].set], N = g[y][b[x].set], C = window.circleIntersection.circleCircleIntersection({x: E.x,y: E.y,radius: S}, {x: T.x,y: T.y,radius: N});
                    for (var k = 0; k < C.length; ++k)
                        w.push(C[k])
                }
            }
            var L = 1e50, A = w[0];
            for (u = 0; u < w.length; ++u) {
                t[y].x = w[u].x, t[y].y = w[u].y;
                var O = e.lossFunction(t, n);
                O < L && (L = O, A = w[u])
            }
            m(A, y)
        }
        return t
    }, e.classicMDSLayout = function(t, n) {
        var r = e.getDistanceMatrix(t, n, 0), i = window.mds.classic(r);
        for (var s = 0; s < t.length; ++s)
            t[s].x = i[s][0], t[s].y = i[s][1], t[s].radius = Math.sqrt(t[s].size / Math.PI);
        return t
    }, e.lossFunction = function(e, t) {
        function r(t) {
            return t.map(function(t) {
                return e[t]
            })
        }
        var n = 0;
        for (var i = 0; i < t.length; ++i) {
            var s = t[i], o;
            if (s.sets.length == 2) {
                var u = e[s.sets[0]], a = e[s.sets[1]];
                u == null || a == null ? o = 0 : o = window.circleIntersection.circleOverlap(u.radius, a.radius, window.circleIntersection.distance(u, a))
            } else
                o = window.circleIntersection.intersectionArea(r(s.sets));
            var f = s.weight == null ? 1 : s.weight;
            n += f * (o - s.size) * (o - s.size)
        }
        return n
    }, e.scaleSolution = function(e, t, n, r) {
        var i = function(t) {
            var n = Math.max.apply(null, e.map(function(e) {
                return e[t] + e.radius
            })), r = Math.min.apply(null, e.map(function(e) {
                return e[t] - e.radius
            }));
            return {max: n,min: r}
        };
        t -= 2 * r, n -= 2 * r;
        var s = i("x"), o = i("y"), u = s.max - s.min, a = o.max - o.min, f = u ? t / u : 0, l = a ? n / a : 0, c = Math.min(l, f);
        for (var h = 0; h < e.length; ++h) {
            var p = e[h];
            p.radius = c * p.radius, p.x = r + (p.x - s.min) * c, p.y = r + (p.y - o.min) * c
        }
        return e.scaling = c, e
    }, e.bisect = function(e, t, n, r) {
        r = r || {};
        var i = r.maxIterations || 100, s = r.tolerance || 1e-10, o = e(t), u = e(n), a = n - t;
        if (o * u > 0)
            throw "initial bisect points must have opposite signs";
        if (o === 0)
            return t;
        if (u === 0)
            return n;
        for (var f = 0; f < i; ++f) {
            a /= 2;
            var l = t + a, c = e(l);
            c * o >= 0 && (t = l);
            if (Math.abs(a) < s || c === 0)
                return l
        }
        return t + a
    }, e.fmin = function(e, n, r) {
        r = r || {};
        var i = r.maxIterations || n.length * 200, s = r.nonZeroDelta || 1.1, o = r.zeroDelta || .001, u = r.minErrorDelta || 1e-5, a = r.rho || 1, f = r.chi || 2, l = r.psi || -0.5, c = r.sigma || .5, h = r.callback, p = n.length, d = new Array(p + 1);
        d[0] = n, d[0].fx = e(n);
        for (var v = 0; v < p; ++v) {
            var m = n.slice();
            m[v] = m[v] ? m[v] * s : o, d[v + 1] = m, d[v + 1].fx = e(m)
        }
        var g = function(e, t) {
            return e.fx - t.fx
        };
        for (var y = 0; y < i; ++y) {
            d.sort(g), h && h(d);
            if (Math.abs(d[0].fx - d[p].fx) < u)
                break;
            var b = new Array(p);
            for (v = 0; v < p; ++v) {
                b[v] = 0;
                for (var w = 0; w < p; ++w)
                    b[v] += d[w][v];
                b[v] /= p
            }
            var E = d[p], S = t([1 + a, b], [-a, E]);
            S.fx = e(S);
            var x = S;
            if (S.fx <= d[0].fx) {
                var T = t([1 + f, b], [-f, E]);
                T.fx = e(T), T.fx < S.fx && (x = T)
            } else if (S.fx >= d[p - 1].fx) {
                var N = !1, C;
                S.fx <= E.fx ? (C = t([1 + l, b], [-l, E]), C.fx = e(C), C.fx < E.fx ? x = C : N = !0) : (C = t([1 - l * a, b], [l * a, E]), C.fx = e(C), C.fx <= S.fx ? x = C : N = !0);
                if (N)
                    for (v = 1; v < d.length; ++v)
                        d[v] = t([1 - c, d[0]], [c - 1, d[v]]), d[v].fx = e(d[v])
            }
            d[p] = x
        }
        return d.sort(g), {f: d[0].fx,solution: d[0]}
    }, e.drawD3Diagram = function(t, n, r, i, s) {
        s = s || {};
        var o = d3.scale.category10(), u = s.circleFillColours || o, a = s.circleStrokeColours || u, f = s.circleStrokeWidth || function(e) {
            return 0
        }, l = s.textFillColours || o, c = s.textStrokeColours || l, h = s.opacity || .3, p = s.padding || 6;
        n = e.scaleSolution(n, r, i, p);
        var d = t.append("svg").attr("width", r).attr("height", i), v = d.selectAll("circle").data(n).enter().append("g"), m = v.append("circle").attr("r", function(e) {
            return e.radius
        }).style("fill-opacity", h).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        }).style("stroke", function(e, t) {
            return a(t)
        }).style("stroke-width", function(e, t) {
            return f(t)
        }).style("fill", function(e, t) {
            return u(t)
        }), g = v.append("text").attr("x", function(e) {
            return e.x
        }).attr("y", function(e) {
            return e.y
        }).attr("text-anchor", "middle").style("stroke", function(e, t) {
            return c(t)
        }).style("fill", function(e, t) {
            return l(t)
        }).text(function(e) {
            return e.label
        });
        return {svg: d,nodes: v,circles: m,text: g}
    }, e.updateD3Diagram = function(t, n) {
        var r = t.select("svg"), i = parseInt(r.attr("width"), 10), s = parseInt(r.attr("height"), 10);
        n = e.scaleSolution(n, i, s, 6), t.selectAll("circle").data(n).transition().duration(400).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        }).attr("r", function(e) {
            return e.radius
        }), t.selectAll("text").data(n).transition().duration(400).attr("x", function(e) {
            return e.x
        }).attr("y", function(e) {
            return e.y
        })
    }
}(window.venn = window.venn || {}), function(e) {
    function n(t) {
        var n = [];
        for (var r = 0; r < t.length; ++r)
            for (var i = r + 1; i < t.length; ++i) {
                var s = e.circleCircleIntersection(t[r], t[i]);
                for (var o = 0; o < s.length; ++o) {
                    var u = s[o];
                    u.parentIndex = [r, i], n.push(u)
                }
            }
        return n
    }
    var t = 1e-10;
    e.intersectionArea = function(r, i) {
        var s = n(r), o = s.filter(function(t) {
            return e.containedInCircles(t, r)
        }), u = 0, a = 0, f = [], l;
        if (o.length > 1) {
            var c = e.getCenter(o);
            for (l = 0; l < o.length; ++l) {
                var h = o[l];
                h.angle = Math.atan2(h.x - c.x, h.y - c.y)
            }
            o.sort(function(e, t) {
                return t.angle - e.angle
            });
            var p = o[o.length - 1];
            for (l = 0; l < o.length; ++l) {
                var d = o[l];
                a += (p.x + d.x) * (d.y - p.y);
                var v = {x: (d.x + p.x) / 2,y: (d.y + p.y) / 2}, m = null;
                for (var g = 0; g < d.parentIndex.length; ++g)
                    if (p.parentIndex.indexOf(d.parentIndex[g]) > -1) {
                        var y = r[d.parentIndex[g]], b = Math.atan2(d.x - y.x, d.y - y.y), w = Math.atan2(p.x - y.x, p.y - y.y), E = w - b;
                        E < 0 && (E += 2 * Math.PI);
                        var S = w - E / 2, x = e.distance(v, {x: y.x + y.radius * Math.sin(S),y: y.y + y.radius * Math.cos(S)});
                        if (m === null || m.width > x)
                            m = {circle: y,width: x,p1: d,p2: p}
                    }
                f.push(m), u += e.circleArea(m.circle.radius, m.width), p = d
            }
        } else {
            var T = r[0];
            for (l = 1; l < r.length; ++l)
                r[l].radius < T.radius && (T = r[l]);
            var N = !1;
            for (l = 0; l < r.length; ++l)
                if (e.distance(r[l], T) > Math.abs(T.radius - r[l].radius)) {
                    N = !0;
                    break
                }
            N ? u = a = 0 : (u = T.radius * T.radius * Math.PI, f.push({circle: T,p1: {x: T.x,y: T.y + T.radius},p2: {x: T.x - t,y: T.y + T.radius},width: T.radius * 2}))
        }
        return a /= 2, i && (i.area = u + a, i.arcArea = u, i.polygonArea = a, i.arcs = f, i.innerPoints = o, i.intersectionPoints = s), u + a
    }, e.containedInCircles = function(n, r) {
        for (var i = 0; i < r.length; ++i)
            if (e.distance(n, r[i]) > r[i].radius + t)
                return !1;
        return !0
    }, e.circleIntegral = function(e, t) {
        var n = Math.sqrt(e * e - t * t);
        return t * n + e * e * Math.atan2(t, n)
    }, e.circleArea = function(t, n) {
        return e.circleIntegral(t, n - t) - e.circleIntegral(t, -t)
    }, e.distance = function(e, t) {
        return Math.sqrt((e.x - t.x) * (e.x - t.x) + (e.y - t.y) * (e.y - t.y))
    }, e.circleOverlap = function(t, n, r) {
        if (r >= t + n)
            return 0;
        if (r <= Math.abs(t - n))
            return Math.PI * Math.min(t, n) * Math.min(t, n);
        var i = t - (r * r - n * n + t * t) / (2 * r), s = n - (r * r - t * t + n * n) / (2 * r);
        return e.circleArea(t, i) + e.circleArea(n, s)
    }, e.circleCircleIntersection = function(t, n) {
        var r = e.distance(t, n), i = t.radius, s = n.radius;
        if (r >= i + s || r <= Math.abs(i - s))
            return [];
        var o = (i * i - s * s + r * r) / (2 * r), u = Math.sqrt(i * i - o * o), a = t.x + o * (n.x - t.x) / r, f = t.y + o * (n.y - t.y) / r, l = -(n.y - t.y) * (u / r), c = -(n.x - t.x) * (u / r);
        return [{x: a + l,y: f - c}, {x: a - l,y: f + c}]
    }, e.getCenter = function(e) {
        var t = {x: 0,y: 0};
        for (var n = 0; n < e.length; ++n)
            t.x += e[n].x, t.y += e[n].y;
        return t.x /= e.length, t.y /= e.length, t
    }
}(window.circleIntersection = window.circleIntersection || {}), function(e) {
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        var n = this;
        return this._type = "venn", e = e || {}, this._initDefaultOptions(), this.setOptions(e), this._cvWrapper = null, this._seriesState = t.seriesState(), this._seriesState.on("enableChange.venn", function(e, t) {
            n._onEnableState(t)
        }), this._dvColorScale = r.scale.ordinal(), this
    }, s._initDefaultOptions = function(e) {
        var t = {colors: ["#8cc350", "#d755a5", "#1ebed7", "#f0a01e", "#9b8ce6", "#3cb5a0", "#3287d2", "#f0557d", "#c3d250", "#eb782d", "#78b4f5", "#5faf69", "#aa5fa5", "#fa5a50", "#f5c841", "#5a6eaa"],legendVerticalWidth: 110,duration: 500,distance: 0};
        return this._margins = {top: 0,left: 0,right: 0,bottom: 0}, Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s._render = function() {
        this._id = Math.floor(Math.random() * 1e4), this._determineSize(), this._initScales(), this._draw()
    }, s._draw = function() {
        var e = this._options.data;
        e.distance = this._options.distance, this._initSVG(), this._createStates(), this._parsedSetNotation = this._parseSetNotation(e.notation), this._overlapMap = this._createOverlapMap(e.sets, e.overlaps);
        var t = this._drawLegend();
        this._positionContainer(t);
        var n = this._configureSets(e), r = this._generateOverlayCombinations(n, this._parsedSetNotation);
        this._drawCircles(n, r)
    }, s._onAutoResize = function() {
        this.render()
    }, s._determineSize = function(e) {
        var t = this._options, n = this._dataAdapter.data(), i = t.parent.offsetWidth, s = t.parent.offsetHeight, o = r.util.getPercentValue(t.width, i) || i, u = r.util.getPercentValue(t.height, s) || s;
        this._size = [o, u]
    }, s._initScales = function() {
        this._dvColorScale.range(this._options.colors)
    }, s._parseSetNotation = function(e) {
        var t = [];
        if (!e)
            return t;
        var n = e.split("|"), r = /\d+/g, i, s = n.length, o;
        for (i = 0; i < s; i++) {
            o = n[i];
            var u = o.match(r), a, f = [], l = u.length, c;
            for (a = 0; a < l; a++)
                f.push(+u[a]);
            t.push(f)
        }
        return t
    }, s._initSVG = function() {
        var e = this._options, t = i.select(e.parent);
        this._cvWrapper = t.selectAll(".cv-wrapper.cv-venn").data([0]), this._cvWrapper.enter().append("div").classed("cv-wrapper cv-venn", !0), this._cvWrapper.style("width", this._size[0] + "px").style("height", this._size[1] + "px");
        var n = this._cvWrapper.selectAll(".svg-wrapper").data([0]);
        n.enter().append("div").classed("svg-wrapper", !0);
        var r = n.selectAll("svg").data([0]);
        r.enter().append("svg"), this._d3Container = r.selectAll("g").data([0]), this._d3Container.enter().append("g")
    }, s._positionContainer = function(e) {
        this._size[0] -= e.left + e.right, this._size[1] -= e.top + e.bottom, this._cvWrapper.select(".svg-wrapper").style({"margin-left": e.left + "px","margin-top": e.top + "px","margin-right": e.right + "px","margin-bottom": e.bottom + "px",height: this._size[1] + "px"}), this._cvWrapper.selectAll(".cv-legend").style("height", e.left || e.right ? this._size[1] - 1 + "px" : null)
    }, s._configureSets = function(t) {
        var n = this._options;
        t = this._sanitizeOverlaps(t);
        var r = e.venn.scaleSolution(e.venn.venn(t.sets, t.overlaps, {distance: t.distance}), this._size[0], this._size[1], 7), i, s = r.length, o;
        for (i = 0; i < s; i++)
            o = r[i], o.index = i;
        return r
    }, s._combine = function(e, t, n) {
        arguments.length < 3 ? n = e.length - 1 : n--, arguments.length < 2 && (t = 1);
        var r = function(e, t, n, i) {
            if (e === 0) {
                n.length > 0 && (i[i.length] = n);
                return
            }
            for (var s = 0; s < t.length; s++)
                r(e - 1, t.slice(s + 1), n.concat([t[s]]), i);
            return
        }, i = [];
        for (var s = t; s <= n + 1; s++)
            r(s, e, [], i);
        return i
    }, s._intersect = function(e, t) {
        var n = [];
        for (var r = 0; r < e.length; r++)
            for (var i = 0; i < t.length; i++)
                if (e[r] == t[i]) {
                    n.push(e[r]);
                    break
                }
        return n
    }, s._union = function(e, t) {
        var n = {};
        for (var r = e.length - 1; r >= 0; --r)
            n[e[r]] = e[r];
        for (var i = t.length - 1; i >= 0; --i)
            n[t[i]] = t[i];
        var s = [];
        for (var o in n)
            n.hasOwnProperty(o) && s.push(n[o]);
        return s.sort(function(e, t) {
            return e - t
        }), s
    }, s._generateOverlayCombinations = function(t, n) {
        var r = this, i = {}, s = [], o = [];
        n.sort(function(e, t) {
            return t.length - e.length
        }), n.forEach(function(e, t) {
            var n = e.join("-");
            s = s.concat(r._combine(e, 1)), s.forEach(function(t, s) {
                var o = t.join("-"), u = i[o] || {}, a;
                u.fill || (a = r._intersect(e, t), u.fill = a.join("-") === n), i[o] = u
            })
        });
        for (var u in i) {
            var a = u.split("-"), f = [], l, c = a.length;
            for (l = 0; l < c; l++) {
                var h = t[a[l]];
                h && f.push(t[a[l]])
            }
            var p = {};
            f.length > 1 && e.circleIntersection.intersectionArea(f, p), f.length ? p.area = Math.PI * Math.pow(f[0].radius, 2) : p.area = 0, o.push({key: u,fill: i[u].fill,area: p.area})
        }
        return o.sort(function(e, t) {
            var n = t.area - e.area;
            return n ? n : e.key.length - t.key.length
        }), o
    }, s._sanitizeOverlaps = function(e) {
        var t = e.sets, n = e.overlaps, r = [], i, s, o, u, a, f, l, c = t.length, h = n.length, p = {}, d = function(e, t) {
            return +e - +t
        };
        for (o = 0; o < h; o++)
            f = n[o], f.sets.sort(d), p[f.sets.join("-")] = f;
        for (i = 0; i < c; i++) {
            u = t[i];
            for (s = i + 1; s < c; s++)
                a = t[s], l = !1, (!p.hasOwnProperty(i + "-" + s) || p[i + "-" + s].size === "0") && r.push({sets: [i, s],size: 0})
        }
        return e.overlaps = n.concat(r), e
    }, s._createOverlapMap = function(e, t) {
        var n = {}, r = function(e, t) {
            return e - t
        }, i, s = e.length, o;
        for (i = 0; i < s; i++)
            o = e[i], n[i] = o.size;
        var u, a = t.length, f;
        for (i = 0; i < a; i++)
            f = t[i], f.sets.sort(r), n[f.sets.join("-")] = f.size;
        return n
    }, s._drawCircles = function(e, t) {
        this._drawSetHitAreas(e), this._createClipPaths(e, t), this._drawFilledRegions(t), this._drawPadding(e), this._drawSetFills(e), this._drawBorders(e), this._makePlotFit(e)
    }, s._drawSetHitAreas = function(e) {
        var t = this, n = this._options, r = this._d3Container.selectAll(".set-hit-areas-container").data([e]);
        r.enter().append("g").classed("set-hit-areas-container", !0), r.exit().remove();
        var i = r.selectAll("circle").data(function(e) {
            return e
        });
        i.enter().append("circle").attr("r", 0).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        }).attr("tooltip", function(e) {
            return e.tooltip
        }), i.exit().remove(), i.sort(function(e, t) {
            return t.radius - e.radius
        }).on("mouseover", function(e, n) {
            t._seriesState.enableStateByTypeAndId("standard", e.index, !0)
        }).on("mouseout", function(e, n) {
            t._seriesState.enableStateByTypeAndId("standard", e.index, !1)
        }).transition().duration(n.duration).attr("r", function(e) {
            return Math.max(e.radius - 1, 0)
        }).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        })
    }, s._createClipPaths = function(e, t) {
        var n = this, r = this._cvWrapper.select("svg").selectAll("defs").data(t.length ? [0] : []);
        r.enter().insert("defs", ":first-child"), r.exit().remove();
        var i = r.selectAll("clipPath").data(t);
        i.enter().append("clipPath"), i.exit().remove(), i.attr("id", function(e) {
            return "clip-" + n._id + "-" + e.key
        });
        var s = i.selectAll("circle").data(function(t) {
            if (!t.key || !t.key.length)
                return [];
            var n = t.key.split("-"), r = {circleIndex: n.shift()};
            return n.length && (r.maskId = n.join("-")), !e || !e[r.circleIndex] ? [] : [r]
        });
        s.enter().append("circle"), s.exit().remove(), s.attr("clip-path", function(e) {
            return e.hasOwnProperty("maskId") ? "url(#clip-" + n._id + "-" + e.maskId + ")" : null
        }).attr("r", function(t) {
            return e[t.circleIndex].radius
        }).attr("cx", function(t) {
            return e[t.circleIndex].x
        }).attr("cy", function(t) {
            return e[t.circleIndex].y
        }).style("fill", "#FFF")
    }, s._drawFilledRegions = function(e) {
        var t = this, n = this._options, r = this._d3Container.selectAll(".filled-regions").data(e ? [e] : []);
        r.enter().append("g").classed("filled-regions", !0), r.exit().remove();
        var i = r.selectAll(".fill-region").data(function(e) {
            return e
        });
        i.enter().append("rect").classed("fill-region", !0), i.exit().remove(), i.attr("clip-path", function(e) {
            return "url(#clip-" + t._id + "-" + e.key + ")"
        }).style("opacity", 1e-6).attr("width", t._size[0]).attr("height", t._size[1]).classed("overlay", function(e) {
            return e.fill
        }).on("mouseover", function(e, n) {
            t._seriesState.enableStateByTypeAndId("highlight", "audience", !0)
        }).on("mouseout", function(e, n) {
            t._seriesState.enableStateByTypeAndId("highlight", "audience", !1)
        }).transition().delay(n.duration).duration(n.duration).style("opacity", 1)
    }, s._drawPadding = function(e) {
        var t = this._options, n = this._d3Container.selectAll(".padding-container").data([e]);
        n.enter().append("g").classed("padding-container", !0), n.exit().remove();
        var r = n.selectAll("circle").data(function(e) {
            return e
        });
        r.enter().append("circle").attr("r", 0).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        }), r.exit().remove(), r.transition().duration(t.duration).attr("r", function(e) {
            return e.radius
        }).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        })
    }, s._drawSetFills = function(e) {
        var t = this, n = this._options, r = this._d3Container.selectAll(".set-fills-container").data([e]);
        r.enter().append("g").classed("set-fills-container", !0), r.exit().remove();
        var i = r.selectAll("circle").data(function(e) {
            return e
        });
        i.enter().append("circle").attr("r", 0).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        }), i.exit().remove(), i.style("fill", function(e, n) {
            return t._dvColorScale.mapValue(n)
        }).transition().duration(n.duration).attr("r", function(e) {
            return Math.max(e.radius - 3, 0)
        }).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        })
    }, s._drawBorders = function(e) {
        var t = this, n = this._options, r = this._d3Container.selectAll(".border-container").data([e]);
        r.enter().append("g").classed("border-container", !0), r.exit().remove();
        var i = r.selectAll("circle").data(function(e) {
            return e
        });
        i.enter().append("circle").attr("r", 0).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        }), i.exit().remove(), i.style("stroke", function(e, n) {
            return t._dvColorScale.mapValue(n)
        }).classed("predicted", function(e) {
            return e.predicted
        }).transition().duration(n.duration).attr("r", function(e) {
            return e.radius
        }).attr("cx", function(e) {
            return e.x
        }).attr("cy", function(e) {
            return e.y
        })
    }, s._createStates = function() {
        var e = this._options, t = e.data.sets;
        if ("data" in this._changedOptions && this._changedOptions.data) {
            this._seriesState.removeStatesByType("standard"), this._seriesState.removeStatesByType("highlight"), this._seriesState.appendState(this._dataAdapter.l10n.labels.venn.definedAudience, "audience", "highlight", !1);
            var n, r = t.length, i = [], s;
            for (n = 0; n < r; n++)
                s = t[n], i.push(n), this._seriesState.appendState(s.label || n, n, "standard", !1);
            this._dvColorScale.domain(i)
        }
    }, s._drawLegend = function() {
        var e = this._options, n = this;
        this._legend || (this._legend = t.interactiveLegend()), this._legend.parent(this._cvWrapper.node()).orientation("bottom").chartWidth(this._size[0]).chartHeight(this._size[1]).chartPadding({left: 0,top: 0,right: 0,bottom: 0}).validOrientations(["bottom", "left"]).legendVerticalWidth(e.legendVerticalWidth).type("line").seriesState(this._seriesState).interactive(!1).values(this._calculateValues(this._options.data.sets, this._overlapMap, this._parsedSetNotation))._render(null, {fill: [this._dvColorScale]});
        var r = this._legend._getUsedWidth(), i = this._legend._getUsedHeight(), s = i !== 0, o = this._cvWrapper.selectAll(".cv-legend-entry").on("mouseover", function(e) {
            n._seriesState.enableStateByTypeAndId(e.type, e.id, !0)
        }).on("mouseout", function(e) {
            n._seriesState.enableStateByTypeAndId(e.type, e.id, !1)
        });
        return s && o.style("width", function(e, t) {
            return n._size[0] / (n._options.data.sets.length + 1) + "px"
        }), {left: r,bottom: i,right: 0,top: 0}
    }, s._onEnableState = function(e) {
        this._cvWrapper.selectAll(".set-fills-container circle").style("display", function(t, n) {
            return e.type === "standard" && e.id === n && e.enabled ? "block" : "none"
        }), this._cvWrapper.selectAll(".border-container circle").classed("muted", function(t, n) {
            return e.id !== n && e.enabled
        }), this._cvWrapper.selectAll(".filled-regions rect").classed("muted", function(t, n) {
            return e.type === "standard" && e.enabled
        }), this._cvWrapper.selectAll(".padding-container circle").style("display", function(t, n) {
            return e.type === "highlight" && e.enabled ? "none" : "block"
        }), this._cvWrapper.selectAll(".cv-legend-entry").classed("inactive", function(t) {
            return e.enabled && (t.id !== e.id || t.type !== e.type)
        })
    }, s._calculateValues = function(e, t, n) {
        var r = [this._formatNumber("decimal", this._calculateHighlightedValue(e, t, n))], i, s = e.length, o;
        for (i = 0; i < s; i++)
            o = e[i], r.push(o.sizeText ? o.sizeText : this._formatNumber("decimal", o.size));
        return r
    }, s._calculateHighlightedValue = function(e, t, n) {
        var r = function(e, n, i, s) {
            var o = this._combine(n, s, s), u, a = o.length, f, l = s % 2 ? 1 : -1;
            for (u = 0; u < a; u++) {
                f = o[u];
                var c, h = f.length, p, d, v = [];
                for (c = 0; c < h; c++)
                    p = f[c], v = this._union(e[p], v);
                d = v.join("-"), i += (t.hasOwnProperty(d) ? t[d] : 0) * l
            }
            return s++, s <= e.length && (i = r.call(this, e, n, i, s)), i
        }, i = function(e) {
            var t = [], n;
            for (n = 0; n < e; n++)
                t.push(n);
            return t
        };
        return r.call(this, n, i(n.length), 0, 1)
    }, s._makePlotFit = function(e) {
        var t = this._options, n = {x: 0,y: 0}, r = 0, i = 0, s = 4;
        e.forEach(function(e) {
            r = Math.max(r, e.x + e.radius), i = Math.max(i, e.y + e.radius)
        }), this._size[0] - r > this._size[1] - i ? n.x = (this._size[0] - r) / 2 - s : n.y = (this._size[1] - i) / 2 - s, this._cvWrapper.select("g").attr("transform", "translate(" + n.x + "," + n.y + ")")
    }, e.cloudViz.venn = t.util.createConstructor(s)
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        return this._type = "sunburst", this._hiddenNodes = [], this._outRangeNodes = [], this._invalidNodes = [], this._initDefaultOptions(), this.setOptions(e), this
    }, s._initDefaultOptions = function() {
        var e = "Visits", t = {otherColor: "#ccc",otherGrayColor: "#999",outRangeColor: "#5a5a5a",metricColor: "#fff",seqColors: ["#faf0c8", "#d2dc73", "#5faf69", "#00505A"],seqColorsHeat: ["#5a6eaa", "#3287d2", "#3cb5a0", "#5faf69", "#8cc350", "#c3d250", "#f5c841", "#f0a01e", "#eb782d", "#fa5a50"],colors: ["#3287d2", "#9b8ce6", "#d755a5", "#fa5a50", "#f0a01e", "#c3d250", "#5faf69", "#1ebed7", "#5a6eaa", "#78b4f5", "#aa5fa5", "#f0557d", "#e8782d", "#f5c841", "#8cc350", "#3cb5a0", "#286eaf", "#826ee1", "#b93282", "#f04641", "#e18c00", "#a0b400", "#50965a", "#00a0be", "#465a87", "#4196e6", "#964196", "#dc3c69", "#dc5f00", "#e6b43c", "#7daf4b", "#32a08c"],padding: {top: 10,bottom: 60,left: 10,right: 10}};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s._onAutoResize = function() {
        this.resize()
    }, s.resize = function() {
        if (!i.select(this._options.parent).selectAll(".sunburst-cv").node())
            return;
        this._sizeChart(), this._render(!0)
    }, s.reset = function() {
        Object.getPrototypeOf(s).reset.apply(this, arguments)
    }, s._preRender = function() {
        if (this._paths) {
            var e = this._oldKeys = this._dataAdapter.getDataByPathKey(), t, n;
            for (t in e)
                n = e[t], e[t] = {xo: n.x,dxo: n.dx,yo: n.y,dyo: n.dy}
        }
        Object.getPrototypeOf(s)._preRender.apply(this);
        var r = this._options, o = this, u = this._dataAdapter, a = u.l10n.labels.sunburst, f = i.select(r.parent);
        u.getSecondaryMetricIndex() && o._hideNode(u.data(), o._invalidNodes, function(e) {
            return o._isInvalidNode(e)
        });
        var l = this._hiddenNodes, c = u.getDataByPathKey();
        this._hiddenNodes = [], l.forEach(function(e, t) {
            var n = u.getPathKey(e);
            c[n] && o._hideNode(c[n], o._hiddenNodes)
        });
        var h = this._zoomedPath;
        this._zoomedPath = null, h && (h = c[u.getPathKey(h)], this._zoomedPath = this._oldZoomed = h);
        var p = this._lockedNode;
        this._lockedNode = null;
        if (p) {
            "path" === p.type && (p.data = c[u.getPathKey(p.data)], p.data && (this._oldLockedNode = p));
            if ("category" === p.type) {
                var d = u.categories().some(function(e) {
                    return p.data && p.data.name === e.name ? (p.data = e, !0) : !1
                });
                d && (this._oldLockedNode = p)
            }
        }
        var v = f.selectAll(".sunburst-cv").data([0]);
        v.enter().insert("div", ":first-child").classed("sunburst-cv", !0);
        var m = v.selectAll(".sunburst-cv-wrapper").data([0]);
        m.enter().insert("div", ":first-child").classed("sunburst-cv-wrapper", !0);
        var g = m.selectAll(".sunburst-cv-container").data([0]);
        g.enter().insert("div", ":first-child").classed("sunburst-cv-container", !0);
        var y = g.selectAll(".sunburst-svg").data([0]);
        y.enter().append("svg").classed("sunburst-svg", !0);
        var b = y.selectAll(".sunburst-svg-container").data([0]);
        b.enter().append("g").classed("sunburst-svg-container", !0);
        var w = m.selectAll(".sunburst-cv-label").data([0]);
        w.enter().append("div").classed("sunburst-cv-label", !0);
        var E = w.selectAll(".sunburst-cv-label-wrap").data([0]);
        E.enter().append("div").classed("sunburst-cv-label-wrap", !0);
        var S = E.selectAll(".sunburst-cv-label-metric").data([0]);
        S.enter().append("div").classed("sunburst-cv-label-metric", !0);
        var x = E.selectAll(".sunburst-audiences").data([0]);
        x.enter().append("div").classed("sunburst-audiences", !0), x.exit().remove();
        var T = v.selectAll(".sunburst-cv-actions-pane").data([0]);
        T.enter().append("div").classed("sunburst-cv-actions-pane", !0), T.exit().remove();
        var N = T.selectAll(".actions-pane-zoomout").data([0]);
        N.enter().append("div").classed("actions-pane-zoomout", !0).classed("actions-pane-action", !0), N.html('<i class="icon zoomout"></i><span>' + a.zoomout + "</span>"), N.on("click", function() {
            o._zoomPath(u.data())
        }), N.exit().remove();
        var C = T.selectAll(".actions-pane-hidden").data([0]);
        C.enter().append("div").classed("actions-pane-hidden", !0).classed("actions-pane-action", !0), C.html('<i class="icon hide"></i><span>' + o._hideLabelText() + "</span>"), C.on("click", function() {
            o._unhidePaths()
        }), C.exit().remove();
        var k = m.selectAll(".sunburst-cv-sec-viz").data([0]), L = k.enter().append("div").classed("sunburst-cv-sec-viz", !0);
        L.append("span").classed("title", !0);
        var A = L.append("span").classed("bar", !0);
        A.append("span").classed("button", !0).classed("color", !0).append("span"), A.append("span").classed("button", !0).classed("height", !0).append("span"), A.append("span").classed("button", !0).classed("both", !0).append("span"), k.selectAll(".button.color").on("click", function() {
            u.setSecondaryMetricType("color"), o._secondaryMetricChanged()
        }).selectAll("span").html(a.color), k.selectAll(".button.height").on("click", function() {
            u.setSecondaryMetricType("height"), o._secondaryMetricChanged()
        }).selectAll("span").html(a.height), k.selectAll(".button.both").on("click", function() {
            u.setSecondaryMetricType("both"), o._secondaryMetricChanged()
        }).selectAll("span").html(a.both), k.exit().remove();
        var O = m.selectAll(".sunburst-cv-secondary").data([0]);
        O.enter().append("div").classed("sunburst-cv-secondary", !0), O.exit().remove();
        var M = O.selectAll(".sunburst-cv-color").data([0]);
        M.enter().append("div").classed("sunburst-cv-color", !0), M.exit().remove();
        var _ = v.selectAll(".sunburst-cv-info-pane").data([0]);
        _.enter().append("div").classed("sunburst-cv-info-pane", !0), _.exit().remove();
        var D = _.selectAll(".info-pane-content").data([0]);
        D.enter().append("div").classed("info-pane-content", !0), D.exit().remove();
        var P = D.selectAll(".info-pane-categories").data([0]);
        P.enter().append("div").classed("info-pane-categories", !0).append("div").classed("pane-title", !0).append("span"), P.exit().remove();
        var H = D.selectAll(".sunburst-audiences").data([0]);
        H.enter().append("div").classed("sunburst-audiences", !0).append("div").classed("pane-title", !0).append("span").text(a.audience), H.exit().remove();
        var B = D.selectAll(".info-pane-actions").data([0]);
        B.enter().append("div").classed("info-pane-actions", !0), B.exit().remove();
        var j = D.selectAll(".info-pane-metrics").data([0]), F = j.enter().append("div").classed("info-pane-metrics", !0);
        F.append("div").classed("pane-title", !0).classed("pri-metric", !0).append("span"), F.append("div").classed("info-pane-metrics-labels", !0).classed("pri-metric-labels", !0), F.append("div").classed("pane-title", !0).classed("sec-metric", !0).append("span"), F.append("div").classed("info-pane-metrics-labels", !0).classed("sec-metrics-labels", !0).append("span").classed("sec-metrics-help", !0), F.append("div").classed("pane-title", !0).classed("rank-chart", !0).append("span"), F.append("div").classed("info-pane-metrics-chart", !0), j.exit().remove();
        var I = D.selectAll(".info-pane-extra").data([0]);
        I.enter().append("div").classed("info-pane-extra", !0), I.exit().remove();
        var q = v.selectAll(".sunburst-cv-mobile-scroll").data([0]);
        q.enter().append("div").classed("sunburst-cv-mobile-scroll", !0), q.html(a.mobilescroll), q.exit().remove(), this._sizeChart(), v.classed("hiddenpaths", !!this._hiddenNodes.length)
    }, s._render = function(e) {
        Object.getPrototypeOf(s)._render.apply(this);
        var t = this, n = this._options, r = this._dataAdapter, o = r.data(), u = i.select(n.parent).selectAll(".sunburst-cv"), a = u.selectAll(".sunburst-cv-container"), f = a.selectAll(".sunburst-svg-container"), l = parseInt(a.style("width"), 10), c = parseInt(a.style("height"), 10), h = this._radius = Math.min(l, c) / 2, p = this._isMobileSize(), d = o.categories.length + 1, v = this._ringDivisor = 1 / d, m = p ? 20 : 140, g = this._centerRadius = Math.ceil(m / 2 / Math.cos(Math.PI / 4));
        f.attr("transform", "translate(" + l / 2 + "," + c / 2 + ")"), !e && this._yScale && (this._oldYScale = this._yScale), !e && this._xScale && (this._oldXScale = this._xScale);
        var y = this._xScale = i.scale.linear().domain(this._oldXScale ? this._oldXScale.domain() : [0, 1]).range([0, 2 * Math.PI]), b = this._yScale = i.scale.linear().domain([0, v, 1]).range([0, g, h]), w = this._arc = i.svg.arc().startAngle(function(e) {
            return Math.max(0, Math.min(2 * Math.PI, y(e.x)))
        }).endAngle(function(e) {
            return Math.max(0, Math.min(2 * Math.PI, y(e.x + e.dx)))
        }).innerRadius(function(e) {
            return Math.max(0, b(e.y))
        }).outerRadius(function(e) {
            return Math.max(0, b(e.y + e.dy))
        });
        this._layoutPaths(e);
        var E = i.select(n.parent).select(".sunburst-cv-label"), S = Math.ceil(g * Math.cos(Math.PI / 4) * 2), x = S, T = n.padding.top + Math.floor(c / 2 - x / 2), N = n.padding.left + Math.floor(l / 2 - S / 2);
        p ? E.style("top", "").style("left", "").style("width", "").style("height", "") : E.style("top", T + "px").style("left", N + "px").style("width", S + "px").style("height", x + "px"), this._updateDetails(this._lockedNode), r.isDataEmpty() ? this._setErrorMessage(r.l10n.labels.core.nodata) : r.isSizeEmpty() ? this._setErrorMessage(r.l10n.labels.sunburst.emptyFirstMetric) : this._clearErrorMessage()
    }, s._getHiddenNodes = function() {
        return this._hiddenNodes.concat(this._outRangeNodes, this._invalidNodes)
    }, s._adjustDataSize = function(e, t, n) {
        var r = this._options, s = this, o = this._dataAdapter, u = e.depth - 1, a = this._zoomedPath, f = .15, l = o.getStackedMetricIndex();
        if (u >= 0 && e.metrics && e.metrics[l]) {
            e.y -= t;
            var c = e.metrics[l].value, h = n[u], p = h.max, d = Math.min(0, h.min), v = i.scale.linear().domain([d, p]).range([f, 1]), m = v(c) * e.dy;
            if (p === d || a && a.depth > e.depth)
                m = e.dy;
            t += e.dy - m, e.dy = m
        }
        if (!e.children || !e.children.length)
            return;
        e.children.forEach(function(e) {
            s._adjustDataSize(e, t, n)
        })
    }, s._getLevelUniqueNodes = function(e, t, n) {
        function f(e) {
            if (a && a.depth === e.depth && a !== e)
                return;
            if (e.depth === t) {
                if (!n && i.indexOf(e) >= 0)
                    return;
                if (o.indexOf(e.name) >= 0)
                    return;
                s.push(e), o.push(e.name);
                return
            }
            if (!e.children || !e.children.length)
                return;
            e.children.forEach(function(e) {
                f(e)
            })
        }
        var r = this._dataAdapter, i = this._getHiddenNodes(), s = [], o = [], u = this, a = this._zoomedPath;
        return f(e), s || []
    }, s._layoutPaths = function(e) {
        var t = this._options, n = this._arc, r = this, s = this._dataAdapter, o = s.data(), u = this._getHiddenNodes(), a = i.select(t.parent).selectAll(".sunburst-svg-container"), f = i.layout.partition().value(function(e) {
            return u.indexOf(e) < 0 ? e.size : 0
        }).sort(function(e, t) {
            return s.isOther(e) ? 1 : s.isOther(t) ? -1 : t.size - e.size
        });
        e && r._paths && r._paths.each(function(e) {
            e.xo = e.x, e.dxo = e.dx, e.yo = e.y, e.dyo = e.dy
        });
        var l = f.nodes(o), c = this._paths = a.selectAll("path").data(l, s.getPathKey);
        c.enter().insert("path", ":first-child"), c.attr("data-sid", function(e, t) {
            return e._sid
        }).on("click", function(e, t) {
            r._lockNode({data: e,type: "path"})
        }).on("dblclick", function(e, t) {
            r._zoomPath(e)
        }).on("mouseenter", function(e, t) {
            if (r._lockedNode || r._isTouch())
                return;
            r._highlightNode({data: e,type: "path"})
        });
        var h = c.exit().classed("removing", !0);
        setTimeout(function() {
            h.remove()
        }, 501), r.setColorScale(), this._updatePathColors(), r._buildColorSlider();
        var p;
        if (p = s.getStackedMetric()) {
            var d = s.getStackedMetricIndex(), v = this._zoomedPath, m = !1, g;
            if (m) {
                var y = r.getMetricCategoryMinMax(d);
                g = Array.apply(null, new Array(o.categories.length)).map(function() {
                    return y
                })
            } else
                g = o.categories.map(function(e, t) {
                    return r.getMetricCategoryMinMax(d, t)
                });
            r._adjustDataSize(o, 0, g)
        }
        if (this._oldKeys) {
            var b, w, E = this._oldYScale, S = E.domain(), x = this._yScale, T = x.domain();
            r._paths.each(function(e) {
                b = s.getPathKey(e);
                if (w = r._oldKeys[b])
                    e.xo = w.xo, e.dxo = w.dxo, e.yo = x.invert(E(w.yo)), s.isRoot(e) ? e.dyo = x.invert(E(w.dyo)) : e.dyo = x.invert(E(S[1] + w.dyo)) - T[1]
            }), this._oldKeys = null
        }
        c.each(function(e) {
            var t = s.getPathKey(e);
            "undefined" == typeof e.xo && (e.xo = e.x, e.dxo = e.dx, e.yo = 0, e.dyo = 0)
        }), c.transition().duration(500).attrTween("d", this._changeTween(!0)), a.on("mouseleave", function(e, t) {
            if (r._lockedNode || r._isTouch())
                return;
            r._unhighlightNode()
        }), e || (this._oldLockedNode ? this._lockNode(this._oldLockedNode) : this._unlockNode(), this._oldLockedNode = null, this._updateZoomPathStyles(this._oldZoomed), this._oldZoomed = null)
    }, s._isMobileSize = function() {
        var e = this._options, t = e.parent.offsetWidth, n = r.util.getPercentValue(e.width, t);
        return n < 640
    }, s._isTouch = function() {
        return "ontouchstart" in document.documentElement
    }, s._postRender = function() {
        Object.getPrototypeOf(s)._postRender.apply(this)
    }, s._sizeChart = function(e) {
        var t = this._options, n = this._dataAdapter.data(), s = i.select(t.parent), o = this, u = s.selectAll(".sunburst-cv"), a = u.selectAll(".sunburst-cv-wrapper"), f = a.selectAll(".sunburst-cv-container"), l = u.selectAll(".sunburst-cv-info-pane"), c = u.selectAll(".sunburst-cv-mobile-scroll"), h = t.parent.offsetWidth, p = t.parent.offsetHeight, d = r.util.getPercentValue(t.width, h), v = r.util.getPercentValue(t.height, p), m = this._isMobileSize(), g = d + (m ? 0 : -250), y = m ? Math.min(g, v) : v, b = t.padding, w = g - 2 - (b.left + b.right), E = y - 2 - (b.top + b.bottom);
        u.style("width", d + "px").style("height", v + "px").classed("is-desktop", !m).classed("not-touch", !this._isTouch()), a.style("width", g + "px").style("height", y + "px"), f.style("width", w + "px").style("height", E + "px"), f.style("padding-top", b.top + "px").style("padding-left", b.left + "px"), c.style("top", v - 30 + "px").classed("visible", !u.node().scrollTop).classed("show", v <= y + 130), u.on("scroll", function() {
            c.classed("visible", !u.node().scrollTop)
        })
    }, s._buildColorSlider = function() {
        var e = this._options, t = this, n = this._dataAdapter, r = i.select(e.parent).selectAll(".sunburst-cv-color");
        if (!n.getColorMetric())
            return r.text("");
        var s = n.data(), o = n.getColorMetric(), u = this._colorExtent, a = t._colorExtentMin, f = t._colorExtentMax, l = i.select(e.parent).selectAll(".sunburst-cv-container"), c = parseInt(l.style("width"), 10), h = c / 2, p = n.seqColors(), d = Math.round(100 / (p.length - 1)), v = [], m = 12, g = 10, y = 9, b = 40, w = m + g * 2 + 2, E = h, S = E - b * 2 - y * 2;
        p.forEach(function(e, t) {
            v.push(t * d + "%")
        }), r.style("width", E + "px");
        var x = r.selectAll(".legend-title").data([0]);
        x.enter().insert("div", ":first-child").classed("legend-title", !0), x.text(o.name);
        var T = r.selectAll(".color-slider-legend").data([0]);
        T.enter().append("div").classed("color-slider-legend", !0), T.style("width", E + "px").style("height", w + "px");
        var N = T.selectAll(".color-slider").data([0]);
        N.enter().append("svg").classed("color-slider", !0).style("height", w + "px").style("width", "100%");
        var C = N.selectAll("style").data([0]);
        C.enter().append("style"), C.text(function(e) {
            var t = ".sunburst-cv .sunburst-cv-color .grad-rect { fill: url(#backGradient); \n";
            return t
        });
        var k = N.selectAll("defs").data([0]);
        k.enter().append("defs");
        var L = k.selectAll("#backGradient").data([0]);
        L.enter().append("linearGradient").attr("id", "backGradient");
        var A = function(e, t, n) {
            var r = e.selectAll("stop").data(t);
            r.enter().append("stop").attr("class", function(e, t) {
                return "stop" + t
            }), r.attr("offset", function(e) {
                return e
            }).attr("stop-color", function(e, t) {
                return n[t]
            })
        };
        A(L, v, p);
        var O = N.selectAll(".grad-rect").data([0]);
        O.enter().append("rect").classed("grad-rect", !0), O.attr("x", b + y).attr("y", g).attr("rx", m / 2).attr("ry", m / 2).attr("width", S).attr("height", m);
        var M = T.selectAll(".legend-label").data(["min", "max"]);
        M.enter().append("div").attr("class", function(e) {
            return "legend-label " + e
        }), M.style("left", function(e) {
            return (e === "min" ? 0 : b + y * 2 + S) + "px"
        }).style("width", b + "px").text(function(e) {
            var n = e === "min" ? a : f;
            return n = null === n ? e === "min" ? "-" : "+" : t._formatNumber(o.format, n), n
        })
    }, s._isNodeOutsideRange = function(e) {
        var t = this._dataAdapter, n = this, r = e.children || [], i = r.some(function(e) {
            return !n._isNodeOutsideRange(e)
        });
        return !i && this.isOutsideRange(e)
    }, s._isInvalidNode = function(e) {
        return this._dataAdapter.isOther(e)
    }, s._hideLabelText = function() {
        var e = this._hiddenNodes.length, t = this._dataAdapter.l10n.labels.sunburst, n = e === 1 ? t.hidden : t["hidden2+"];
        return n.replace(/\{value\}/i, e)
    }, s._hideNode = function(e, t, n) {
        var r = this;
        if (t.indexOf(e) > -1)
            return;
        (n && n(e) || !n) && t.push(e);
        if (!e.children || !e.children.length)
            return;
        e.children.forEach(function(e) {
            r._hideNode(e, t, n)
        })
    }, s._hidePath = function(e, t, n) {
        var r = this._options, s = this._dataAdapter, o = this._paths;
        this._hideNode(e, t, n), this._layoutPaths(!0), this._lockedNode && t.indexOf(this._lockedNode.data) > -1 && this._unlockNode(), this._zoomedPath && t.indexOf(this._zoomedPath) > -1 && this._zoomPath(s.data());
        var u = this._hiddenNodes.length, a = i.select(r.parent);
        a.selectAll(".actions-pane-hidden").selectAll("span").html(this._hideLabelText()), a.selectAll(".sunburst-cv").classed("hiddenpaths", !!u)
    }, s._unhidePaths = function() {
        this._hiddenNodes = [], this._layoutPaths(!0), i.select(this._options.parent).selectAll(".sunburst-cv").classed("hiddenpaths", !1)
    }, s._zoomPath = function(e) {
        if (!this._canZoomIn(e))
            return;
        this._zoomedPath = e, this._layoutPaths(!0), this._updateZoomPathStyles(e), this._updateDetails(this._lockedNode)
    }, s._updateZoomPathStyles = function(e) {
        var t = this, n = i.select(this._options.parent).selectAll(".sunburst-cv");
        n.classed("zoomed", e && e.depth > 0), n.selectAll(".sunburst-cv-container").selectAll("path").each(function(n) {
            i.select(this).classed("beyondzoom", n && e && n !== e && n.depth > 0 && (n.depth <= e.depth || !t._hasAncestorNode(n, e))), i.select(this).classed("zoomed", n === e)
        })
    }, s._changeTween = function(e) {
        var t = this._xScale, n = this._yScale, r = this._zoomedPath || this._dataAdapter.data(), s = this._arc, o = this._radius, u = this._ringDivisor, a = this._centerRadius, f = this._dataAdapter.categories(), l = i.interpolate(t.domain(), [r.x, r.x + r.dx]), c = i.interpolate(n.domain(), r.y ? [0, u, r.y, 1] : [0, u, 1]), h = i.interpolate(n.range(), r.y ? [0, a, a, o] : [0, a, o]);
        return function(r, o) {
            var u = i.interpolate({x: r.xo,dx: r.dxo,y: r.yo,dy: r.dyo}, r);
            return o ? function(t) {
                return e ? s(u(t)) : s(r)
            } : function(i) {
                return t.domain(l(i)), n.domain(c(i)).range(h(i)), e ? s(u(i)) : s(r)
            }
        }
    }, s._updatePathColors = function() {
        var e = this, t = this._dataAdapter, n = this._getHiddenNodes(), r = i.select(this._options.parent).selectAll(".sunburst-cv"), s = r.classed("node-highlighted");
        this._paths.style("fill", function(t) {
            var n = i.select(this), r = s && !n.classed("highlighted");
            return e.getNodeColor(t, r)
        }).classed("hidden", function(e) {
            return n.indexOf(e) >= 0
        })
    }, s._lockNode = function(e) {
        var t = this, n = t._options, r = t._lockedNode;
        if (r && r.data === e.data && r.type === e.type)
            return t._unlockNode(e);
        t._lockedNode = e, t._highlightNode(e), t._updateLockedState(e), setTimeout(function() {
            i.select(t._options.parent).select(".sunburst-cv-wrapper").on("click.cvpath", function() {
                if (i.event && i.event.target && i.event.target.nodeName === "path")
                    return;
                t._unlockNode()
            })
        }, 10)
    }, s._unlockNode = function(e) {
        var t = this, n = t._options;
        t._lockedNode = null, t._updateLockedState(), e && !t._isTouch() ? t._highlightNode(e) : t._unhighlightNode(), i.select(t._options.parent).select(".sunburst-cv-container").on("click.cvpath", null)
    }, s._highlightNode = function(e) {
        var t = this, n = e && e.type || "path", r = e && e.data || null, s = this._getAncestorNodes(r), o = {};
        o.category = function(e) {
            return e.depth === r.index + 1
        }, o.item = function(e) {
            return e && r && e.name === r.name
        }, o.path = function(e) {
            return s.indexOf(e) >= 0 || t._lockedNode && e.parent === r
        };
        var u = i.select(this._options.parent).selectAll(".sunburst-cv");
        u.classed("node-highlighted", !0), u.selectAll(".sunburst-cv-container").selectAll("path").each(function(e) {
            i.select(this).classed("highlighted", o[n](e))
        }), t._lockedNode || u.selectAll(".info-pane-category").each(function(e) {
            i.select(this).classed("disabled", "category" === n && e !== r)
        }), this._updateDetails(e), this._updatePathColors()
    }, s._unhighlightNode = function() {
        this._removeHighlights(), this._updateDetails()
    }, s._removeHighlights = function() {
        var e = i.select(this._options.parent);
        e.selectAll(".sunburst-cv").classed("node-highlighted", !1).selectAll("path").classed("highlighted", !1), e.selectAll(".info-pane-category").classed("disabled", !1), this._updatePathColors()
    }, s._secondaryMetricChanged = function() {
        var e = this, t = this._dataAdapter, n = t.l10n.labels.sunburst, r = t.getSecondaryMetricIndex();
        e._outRangeNodes = [], r ? e._hidePath(t.data(), e._invalidNodes, function(t) {
            return e._isInvalidNode(t)
        }) : (e._invalidNodes = [], e._layoutPaths(!0));
        var s = i.select(this._options.parent);
        s.selectAll(".sunburst-cv").classed("secondary-metric", !!r);
        var o = s.selectAll(".sunburst-cv-sec-viz");
        o.selectAll(".button").classed("active", !1);
        var u = t.getSecondaryMetricType();
        u && o.selectAll(".button." + u).classed("active", !0);
        var a = t.getSecondaryMetric(), f = a && a.name || null;
        o.selectAll(".title").html(f ? n.mapmetric.replace(/\{metric\}/i, f) : ""), this._updateDetails(this._lockedNode), this._updateMetricState()
    }, s._updateDetails = function(e) {
        if (e && e.type === "item")
            return;
        this._setChartMetrics(e), this._setDetailsMetrics(e), this._setDetailsAudiences(e), this._setDetailsCategories(e), this._setDetailsActions(e)
    }, s._setDetailsCategories = function(e) {
        var t = this, n = this._dataAdapter, r = n.l10n.labels.sunburst, s = n.data(), o = n.categories(), u = i.select(this._options.parent).select(".info-pane-categories"), a = Math.max(0, t._zoomedPath ? t._zoomedPath.depth - 1 : 0), f = e && e.type === "path" && t._lockedNode ? [] : o.slice(a), l = f.length, c = e || {}, h = u.selectAll(".info-pane-category").data(f), p = h.enter().append("div").classed("info-pane-category", !0).classed("inactive", !0);
        u.select(".pane-title").select("span").text(1 === l.length ? r.category : r["category2+"]), h.each(function(e, n) {
            var s = i.select(this);
            s.text(""), t._createRingMarker(s, l, n), s.append("span").classed("name", !0).html(e && e.name || ""), s.append("span").classed("top", !0).html("(" + r.topresults.replace(/\{value\}/i, e.top) + ")"), c.type === "path" ? s.classed("disabled", !t._lockedNode && c.data && c.data.depth - 1 !== n - a) : t._lockedNode && t._lockedNode.type === "category" && s.classed("disabled", e !== t._lockedNode.data)
        }), setTimeout(function() {
            p.classed("inactive", !1)
        }, 1);
        var d = h.exit().classed("inactive", !0).on("mouseenter", null).on("mouseleave", null).on("click", null);
        setTimeout(function() {
            d.remove()
        }, 400), h.on("mouseenter", function(e, n) {
            if (t._lockedNode || t._isTouch())
                return;
            t._highlightNode({data: e,type: "category"})
        }), h.on("mouseleave", function(e, n) {
            if (t._lockedNode || t._isTouch())
                return;
            t._unhighlightNode()
        }), h.on("click", function(e, n) {
            t._lockNode({data: e,type: "category"})
        }), u.classed("empty", !f.length)
    }, s._setDetailsAudiences = function(e) {
        var t = this, n = this._dataAdapter, r = e && e.type || "", s = e && e.data || null, o = r === "category", u = n.data(), a = o ? this._getLevelUniqueNodes(u, s.index + 1, !1) : this._getAncestorNodes(s), f = o ? function(e, t) {
            return t
        } : function(e, t) {
            return e && e.depth || 0
        }, l = n.categories(), c = i.select(this._options.parent).selectAll(".sunburst-audiences"), h = a && a[0] || u, p = u === h, d = !a || p ? [] : a.slice();
        c.each(function(e) {
            var n = i.select(this), r = d.slice(), s = i.select(n.node().parentNode).classed("sunburst-cv-label-wrap");
            !o && !s ? (t._lockedNode || (r = []), r.reverse()) : o && s && (r = []);
            var u = n.selectAll(".sunburst-audience").data(r, f), a = u.enter().append("span").classed("sunburst-audience", !0).classed("inactive", !0);
            a.append("span").classed("marker", !0).style("background-color", "#dcdcdc"), a.append("span").classed("category", !0), a.append("span").classed("name", !0), u.each(function(e, r) {
                var u = i.select(this), a = l[e.depth - 1];
                u.select(".marker").style("background-color", t.getNodeColor(e)), u.select(".category").classed("hidden", o || s).text(!o && a && a.name || ""), u.select(".name").text(e.name), u.classed("to-remove", !1).attr("my-name", e.name).attr("my-depth", e.depth), u.on("mouseenter", function(e, n) {
                    if (t._isTouch())
                        return;
                    t._highlightNode({data: e,type: "item"})
                }), u.on("mouseleave", function(e, n) {
                    if (t._isTouch())
                        return;
                    t._lockedNode ? t._highlightNode(t._lockedNode) : t._unhighlightNode()
                });
                if (s)
                    return;
                var f = i.select(u.node().cloneNode(!0)).style("height", "").classed("test", !0).classed("inactive", !1);
                n.node().appendChild(f.node()), u.attr("my-height", parseInt(f.style("height"), 10)), f.remove()
            }), u.order(), setTimeout(function() {
                u.each(function(e, t) {
                    var n = i.select(this);
                    n.classed("inactive", !1);
                    if (s)
                        return;
                    n.style("height", n.attr("my-height") + "px")
                })
            }, 1);
            var c = u.exit().classed("inactive", !0).style("height", "").classed("to-remove", !0).on("mouseenter", null).on("mouseleave", null).on("click", null);
            setTimeout(function() {
                c.each(function(e, t) {
                    var n = i.select(this);
                    n.classed("to-remove") && n.remove()
                })
            }, 400), n.classed("empty", !r.length)
        })
    }, s._setDetailsActions = function(e) {
        function a() {
            t._zoomPath(t._lockedNode.data)
        }
        function f() {
            t._zoomPath(r)
        }
        function l() {
            t._hidePath(t._lockedNode.data, t._hiddenNodes)
        }
        function c() {
            var e = t._lockedNode.data, n = t._hiddenNodes;
            if (!e)
                return;
            t._hidePath(r, n, function(t) {
                return t.name === e.name || n.indexOf(t.parent) >= 0
            })
        }
        var t = this, n = this._dataAdapter, r = n.data(), s = i.select(this._options.parent).select(".info-pane-actions"), o = s.selectAll(".info-pane-actions-chart").data([0]);
        o.enter().append("div").classed("info-pane-actions-chart", !0).classed("info-pane-actions-pane", !0);
        var u = s.selectAll(".info-pane-actions-extra").data([0]);
        u.enter().append("div").classed("info-pane-actions-extra", !0).classed("info-pane-actions-pane", !0);
        var h = [], p = n.l10n.labels.sunburst;
        if (e && e.type === "path" && t._lockedNode) {
            var d = e.data, v = t._canZoomIn(d), m = d === r;
            t._lockedNode ? m || (v ? h.push({click: a,className: "zoomin",icon: "zoomin",label: p.zoomin}) : t._canZoomOut(d) && h.push({click: f,className: "zoomout",icon: "zoomout",label: p.zoomout}), h.push({click: l,className: "hide",icon: "hide",label: p.hide}), h.push({click: c,className: "hideallname",icon: "hide",label: p.hideall})) : (m || h.push({click: !1,icon: "more",label: p.moreAction}), v && h.push({click: !1,icon: "zoomin",label: p.zoomAction}))
        }
        var g = t._getExtraActions(e), y = !!h.length, b = !!g.length;
        s.classed("full-width", !y && b || !b && y), s.classed("empty", !y && !b), t._buildActionsPane(o, h), t._buildActionsPane(u, g);
        var w = s.selectAll(".hideallname");
        w.on("mouseenter", function() {
            if (t._isTouch())
                return;
            t._highlightNode({data: t._lockedNode.data,type: "item"})
        }), w.on("mouseleave", function(e, n) {
            if (t._isTouch())
                return;
            t._lockedNode ? t._highlightNode(t._lockedNode) : t._unhighlightNode()
        })
    }, s._buildActionsPane = function(e, t) {
        var n = e.selectAll(".info-pane-action").data(t), r = n.enter().append("a").classed("info-pane-action", !0).classed("inactive", !0);
        r.append("i").classed("icon", !0), r.append("span"), n.each(function(t, n) {
            var r = i.select(this);
            r.select(".icon").attr("class", "icon").classed(t.icon, !0), r.select("span").text(t.label), r.attr("class", "info-pane-action" + (r.classed("inactive") ? " inactive" : "") + (t.click || t.href ? " action" : " help")), t.click ? r.on("click", t.click) : r.on("click", null), t.href ? r.attr("href", t.href) : r.attr("href", null), t.className && r.classed(t.className, !0);
            var s = i.select(r.node().cloneNode(!0)).style("height", "").classed("test", !0).classed("inactive", !1);
            e.node().appendChild(s.node()), r.attr("my-height", parseInt(s.style("height"), 10)), s.remove()
        }), setTimeout(function() {
            n.each(function(e, t) {
                var n = i.select(this);
                n.style("height", n.attr("my-height") + "px").classed("inactive", !1)
            })
        }, 1);
        var s = n.exit().classed("inactive", !0).style("height", "").classed("to-remove", !0).on("click", null);
        return setTimeout(function() {
            s.each(function(e, t) {
                var n = i.select(this);
                n.classed("to-remove") && n.remove()
            })
        }, 400), !!t.length
    }, s._setDetailsMetrics = function(e) {
        var t = this, n = i.select(this._options.parent).select(".info-pane-metrics"), r = n.select(".pri-metric-labels"), s = n.select(".sec-metrics-labels"), o = n.select(".info-pane-metrics-chart"), u = this._dataAdapter, a = u.data(), f = a.metrics.slice(0, 1), l = a.metrics.slice(1), c = u.categories(), h = u.l10n.labels.sunburst, p = e && e.type === "path" ? e.data : null, d = p || a, v = p && p.children && p.children.length && this._lockedNode;
        n.classed("total", !v), n.selectAll(".pane-title").each(function(e, t) {
            var n = i.select(this), r = n.select("span");
            if (n.classed("pri-metric"))
                return r.text(h.primarymetric);
            if (n.classed("sec-metric"))
                return n.classed("hidden", !l.length), r.text(l.length ? l.length === 1 ? h.secondarymetric : h["secondarymetric2+"] : "");
            n.classed("rank-chart") && r.text(v ? c[p.depth] && c[p.depth].name : "")
        }), n.selectAll(".sec-metrics-help").each(function(e, t) {
            i.select(this).text(l.length === 1 ? h.secondarymetrichelp : h["secondarymetrichelp2+"]).classed("hidden", !l.length)
        }), this._setNodeMetricLabels(r, d, f, !!p), this._setNodeMetricLabels(s, d, l, !!p), this._setNodeMetricChart(o, this._lockedNode ? p : null)
    }, s._setChartMetrics = function(e) {
        var t = i.select(this._options.parent).select(".sunburst-cv-label-wrap"), n = this._dataAdapter.data(), r = n.metrics.slice(), s = e && e.type === "path" ? e.data : n;
        r.length > 1 && (r.length = 1), this._setNodeMetricLabels(t, s, r, !1)
    }, s._setNodeMetricLabels = function(e, t, n, r) {
        var s = this, o = this._dataAdapter, u = o.data(), a = o.l10n.labels.sunburst, f = e.classed("pri-metric-labels") || e.classed("sunburst-cv-label-wrap"), l = e.selectAll(".sunburst-cv-label-metric").data(n), c = l.enter().append("div").classed("sunburst-cv-label-metric", !0);
        r = t && t.children && t.children.length && this._lockedNode ? r : !1, l.each(function(e, n) {
            var l = i.select(this), c = s.getNodeValue(t, f ? n : n + 1), h = s.getNodeValue(u, f ? n : n + 1), p = "percent" === e.format, d = o.isOther(t) && !f || 0 === h, v = p ? c : c / s.getNodeValue(u, f ? n : n + 1), m = f || n + 1 === o.getSecondaryMetricIndex(), g = r && m, y = null !== c && !p && !d && t !== u;
            l.classed("active", m);
            var b = l.selectAll(".sunburst-cv-label-icon").data([e]);
            b.enter().append("i"), b.each(function(t) {
                i.select(this).attr("class", "sunburst-cv-label-icon icon").classed(e.icon || (f ? "donut" : "stack"), !0)
            });
            var w = l.selectAll(".sunburst-cv-label-number").data([e]);
            w.enter().append("span").classed("sunburst-cv-label-number", !0), w.html(d ? "" : s._formatValue(e, c)).classed("hidden", d);
            var E = l.selectAll(".sunburst-cv-label-name").data([e]);
            E.enter().append("span").classed("sunburst-cv-label-name", !0).append("span"), E.select("span").html(y ? a.percmetric.replace(/\{percent\}/i, s._formatNumber("percent", v)).replace(/\{metric\}/i, e.name) : e.name);
            var S = s.getMetricMaskNum(f ? n : n + 1), x = E.selectAll(".sunburst-cv-label-marker").data([e]);
            x.enter().insert("svg", ":first-child").classed("sunburst-cv-label-marker", !0).append("rect").attr("width", 12).attr("height", 12), x.classed("hidden", !g).select("rect").attr("style", null === S ? "" : "mask: url(#diagmask" + S + ");"), l.on("click", f ? null : function() {
                o.setSecondaryMetricIndex(n + 1), s._secondaryMetricChanged()
            })
        }), l.exit().remove()
    }, s._formatValue = function(e, t, n) {
        if ("time" !== e.format)
            return this._formatNumber(e.format, t);
        var r = t, i = this._dataAdapter, s = n ? i.l10n.time.abbreviation : 1 === r ? i.l10n.time.singular : i.l10n.time.plural, o = i.getTimeGranularity(r, !0);
        return this._formatNumber(e.format, r / o.divisor) + " " + s[o.gran]
    }, s._setNodeMetricChart = function(e, t) {
        function g(e, t) {
            return 0 === t || t === s.getSecondaryMetricIndex()
        }
        var n = this, s = this._dataAdapter, o = s.data(), u = n._getHiddenNodes(), a = t && t.children || [], f = a.filter(function(e) {
            return u.indexOf(e) < 0
        }), l = [], c = [], h = [], p = [], d = [], v = [], m = {x: l,y: c,fill: h,metric: p,format: v,node: d}, y = o.metrics.slice(), b = y.filter(g), w = b.map(function(e) {
            return e.name
        });
        f.reverse().forEach(function(e) {
            var t;
            y.forEach(function(r, i) {
                if (!g(r, i))
                    return;
                null !== (t = n.getNodeValue(e, i)) && (c.push(t), l.push(e.name), h.push(r.name), p.push(r.name), v.push(r.format), d.push(e))
            })
        });
        var E = !!c.length, S = e.selectAll(".info-pane-chart-svg").data([0]);
        S.enter().append("div").classed("info-pane-chart-svg", !0), S.exit().remove(), e.classed("hidden", !E);
        if (E) {
            var x = 15, T = 25, N = .05, C = b.length, k = f.length, L = C * x + T, A = T / L, O = Math.ceil(C * k * x / (1 - A));
            S.style("height", O + "px");
            var M = r.chart().layers([r.geom.bar().map("group", "fill").set("fill", function(e, t) {
                    return n.getNodeColor(e.data.node)
                }).each("start", function(e, t) {
                    var r = n.getMetricMaskNum(w.indexOf(e.data.metric));
                    i.select(this).attr("mask", null === r ? "" : "url(#diagmask" + r + ")")
                }).on("click", function(e) {
                    n._selectChildFromRanked(e)
                }).dodgePadding(N), r.geom.text().map("label", "y").map("group", "fill").set("fill", "#4b4b4b").textFormat(function(e, t) {
                    return e ? n._formatValue({format: this.__data__.data.format}, e, !0) : ""
                }).textAnchor("start").set("fill", "#4b4b4b").dx(4).dy(5).on("click", function(e) {
                    n._selectChildFromRanked(e)
                })]).coord(r.coord.cartesian().flip(!0)).data(m).position("dodge").guide("x", r.guide.axis().tickDx(function(e, t) {
                return i.select(this).select("span").node().offsetWidth
            }).tickDy(function(e, t) {
                return -C * x / 2 - i.select(this).select("span").node().offsetHeight / 2
            }).tickSize(0).tickAnchor("end")).guide("y", r.guide.axis().ticks(0).tickSize(0).tickFormat(function(e, t) {
                return ""
            })).map("x", "x", r.scale.ordinal().padding(A)).width("100%").height(O).duration(400).padding({top: 2,right: 65}).parent(S.node());
            w.forEach(function(e, t) {
                var n = r.scale.linear().lowerLimit(0);
                n.includeInDomain(function(e, n) {
                    return e.data.metric === w[t]
                }), M.map("y", "y", n, t)
            }), M.render();
            var _ = S.select("svg").selectAll("defs").data([0]);
            _.enter().append("defs");
            var D = [45], P = _.selectAll("pattern").data(D), H = P.enter().append("pattern").attr("id", function(e, t) {
                return "diag" + t
            }).attr("patternUnits", "userSpaceOnUse").attr("width", "3").attr("height", "3").attr("patternTransform", function(e, t) {
                return "rotate(" + e + " 2 2)"
            });
            H.append("rect").attr("x", "0").attr("y", "0").attr("width", "3").attr("height", "3").attr("style", "fill:#fff;"), H.append("path").attr("d", "M -1,0 l 10,0").attr("style", "stroke:#222; fill:none; stroke-width: 3px;");
            var B = _.selectAll("mask").data(D);
            B.enter().append("mask").attr("id", function(e, t) {
                return "diagmask" + t
            }).attr("x", "0").attr("y", "0").append("rect").attr("x", "0").attr("y", "0").attr("width", "100%").attr("height", "1").attr("style", function(e, t) {
                return "stroke:none; fill:url(#diag" + t + ")"
            }), _.selectAll("mask").selectAll("rect").attr("height", O)
        } else
            S.style("height", "0px")
    }, s._selectChildFromRanked = function(e) {
        var t = this._lockedNode.data, n = e.data.x;
        if (!t || !t.children || !t.children.length)
            return;
        var r, i = t.children.length, s, o = null;
        for (r = 0; r < i; ++r)
            if ((s = t.children[r]).name === n) {
                o = s;
                break
            }
        o && this._lockNode({data: o,type: "path"})
    }, s._createRingMarker = function(e, t, n) {
        var r = e.append("svg").classed("category-ring", !0), s = r.append("g").attr("transform", "translate(12,12)"), o = parseInt(r.style("width"), 10), u = o / 2, a = 2, f = 1, l = u - a * t - f * (t - 1), c, h, p;
        for (p = 0; p < t; ++p)
            c = l + (a + f) * p, h = c + a, s.append("path").classed("active", p === n).attr("d", i.svg.arc().innerRadius(c).outerRadius(h).startAngle(0).endAngle(2 * Math.PI))
    }, s._canZoomIn = function(e) {
        var t = this._dataAdapter.data(), n = this._zoomedPath;
        return e !== t && e !== n || e === t && t !== n && !!n
    }, s._canZoomOut = function(e) {
        return e === this._zoomedPath
    }, s._getAncestorNodes = function(e) {
        var t = [], n = e;
        if (!e)
            return t;
        while (n.parent)
            t.push(n), n = n.parent;
        return t.length || (t = [e]), t
    }, s._hasAncestorNode = function(e, t) {
        if (!e || !t || e.depth < t.depth || e === t)
            return !1;
        var n = e;
        while (n.parent) {
            if (n.parent === t)
                return !0;
            n = n.parent
        }
        return !1
    }, s._getInfoPaneHeight = function(e) {
        var t = 0, n;
        return i.selectAll(e.node().childNodes).each(function(e, r) {
            n = i.select(this), t += parseInt(n.style("height"), 10) + parseInt(n.style("padding-bottom"), 10) + parseInt(n.style("padding-top"), 10)
        }), t
    }, s._updateLockedState = function(e) {
        var t = this;
        t._eventMap["sunburst.locked"] && t._eventMap["sunburst.locked"].call(this, e, t._dataAdapter.data())
    }, s._updateMetricState = function() {
        var e = this, t = e._dataAdapter;
        e._eventMap["sunburst.metric"] && e._eventMap["sunburst.metric"].call(this, t.getSecondaryMetricIndex(), t.getSecondaryMetricType(), t.data())
    }, s._getExtraActions = function(e) {
        var t = this;
        return t._eventMap["sunburst.actions"] ? t._eventMap["sunburst.actions"].call(this, e, !!this._lockedNode, t._dataAdapter.data()) : []
    }, s.getNodeValue = function(e, t) {
        return e ? e.metrics && e.metrics.length && e.metrics[t] && "undefined" != typeof e.metrics[t].value ? e.metrics[t].value : t > 0 ? null : "undefined" != typeof e.size ? e.size : e.value : 0
    }, s.getMetricCategoryMinMax = function(e, t) {
        function a(s) {
            if (u && u.depth === s.depth && u !== s)
                return;
            if ("undefined" == typeof t || s.depth === t + 1) {
                if (i.isOther(s))
                    return;
                if (o.indexOf(s) >= 0)
                    return;
                var f = r.getNodeValue(s, e);
                "undefined" == typeof n ? n = {min: f,max: f} : (n.min = Math.min(n.min, f), n.max = Math.max(n.max, f));
                if (t)
                    return
            }
            if (!s.children || !s.children.length)
                return;
            s.children.forEach(function(e) {
                a(e)
            })
        }
        var n, r = this, i = this._dataAdapter, s = i.data(), o = this._getHiddenNodes(), u = this._zoomedPath;
        return a(s), n || null
    }, s.getNodeColor = function(e, t) {
        var n = this._dataAdapter, r = this.getColorScale(e), i;
        return e.depth ? (n.isOther(e) ? i = n.otherColor() : n.getColorMetric() ? i = this.isOutsideRange(e) ? n.outRangeColor() : r(e.metrics[n.getColorMetricIndex()].value) : i = r(e.name), t && (i = this._grayColor(i, e)), i) : n.metricColor()
    }, s._grayColor = function(e, t) {
        var n = this._dataAdapter;
        if (n.isOther(t))
            return n.otherGrayColor();
        var r = /^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i, i = e && e.match(r);
        if (!i)
            return e;
        var s = [parseInt(i[1], 16), parseInt(i[2], 16), parseInt(i[3], 16)], o = Math.round(.21 * s[0] + .71 * s[1] + .07 * s[2]);
        return "#" + ((1 << 24) + (o << 16) + (o << 8) + o).toString(16).slice(1)
    }, s.getMetricMaskNum = function(e) {
        return e === 0 ? null : 0
    }, s.isOutsideRange = function(e) {
        var t = this._dataAdapter, n = t.getColorMetric(), r = t.getColorMetricIndex();
        if (!n || !e || !e.metrics || "percent" !== n.format)
            return !1;
        var i = e.metrics[r].value;
        return i > this._colorExtentMax || i < this._colorExtentMin
    }, s.getColorScale = function(e) {
        var t = this._dataAdapter, n;
        return (n = t.getColorMetric()) ? "percent" === n.format ? this._colorScale : this._categoryColorScales[e.depth - 1] : this._colorScale
    }, s._createColorScale = function(e, t, n, r) {
        var s = this._dataAdapter, o = s.seqColors(), u = (t - n) * e[0] + n, a = (t - n) * e[1] + n, f = a - u, l = o.length - 1;
        r && (this._colorExtent = e, this._colorExtentMin = u, this._colorExtentMax = a);
        var c = [u];
        for (var h = 1; h < l; ++h)
            c.push(f / l * h + u);
        return c.push(a), i.scale.linear().domain(c).range(o).clamp(!0)
    }, s.setColorScale = function(e) {
        e = e || [0, 1];
        var t = this, n = this._dataAdapter, r = n.data(), s;
        if (!(s = n.getColorMetric())) {
            this._colorScale = i.scale.ordinal().domain(n.uniques()).range(n.colors());
            return
        }
        var o = n.getColorMetricIndex(), u;
        if ("percent" === s.format) {
            u = t.getMetricCategoryMinMax(o), this._colorScale = this._createColorScale(e, u.max, u.min, !0);
            return
        }
        u = r.categories.map(function(e, n) {
            return t.getMetricCategoryMinMax(o, n)
        }), this._categoryColorScales = u.map(function(n, r) {
            return t._createColorScale(e, n.max, n.min, !r)
        }), this._colorExtentMin = null, this._colorExtentMax = null
    }, e.cloudViz.sunburst = t.util.createConstructor(s)
}(this), function(e) {
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n);
    s.init = function(e) {
        return this._type = "flower", this._initDefaultOptions(), this.setOptions(e), this.colorScale = r.scale.color()._d3Scale, this
    }, s._initDefaultOptions = function() {
        var e = {animationDuration: 500,labelFormatter: null,clickHandler: null,onlyUseThreePetalLengths: !0,isEmotionChart: !0,mouseoverCallback: [null, null],horizontalPadding: 70,verticalPadding: 30,text_offset: 5};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, e)
    }, s._onAutoResize = function() {
        this._render()
    }, s.resize = function() {
        this._render()
    }, s.reset = function() {
        Object.getPrototypeOf(s).reset.apply(this, arguments)
    }, s._preRender = function() {
        Object.getPrototypeOf(s)._preRender.apply(this)
    }, s._setUpLayer = function(e, t) {
        this["layer" + t] = e.selectAll(".flower-cv-svg-group-layer" + t).data([0]), this["layer" + t].enter().append("g").classed("flower-cv-svg-group-layer" + t, !0)
    }, s.sprintf = function(e, t) {
        return e.replace(/\{([\w]+)\}/ig, function(e, n) {
            return t[n]
        })
    }, s._render = function() {
        Object.getPrototypeOf(s)._render.apply(this);
        var e = this;
        this._parent = i.select(this._options.parent);
        var t = this._parent.selectAll(".cv-wrapper.cv-flower").data([0]);
        t.enter().append("div").classed("cv-wrapper cv-flower", !0);
        var n = t.selectAll(".flower-cv-svg").data([0]);
        n.enter().append("svg").classed("flower-cv-svg", !0), this._svg_group = n.selectAll(".flower-cv-svg-group").data([0]), this._svg_group.enter().append("g").classed("flower-cv-svg-group", !0), this._setUpLayer(this._svg_group, 1), this._setUpLayer(this._svg_group, 2), this._setUpLayer(this._svg_group, 3), this._setUpLayer(this._svg_group, 4), this._setUpLayer(this._svg_group, 5), this._setUpLayer(this._svg_group, 6);
        var o = this._options.width || parseInt(this._parent.style("width"), 10), u = this._options.height || parseInt(this._parent.style("height"), 10);
        t.style("width", o + "px").style("height", u + "px");
        var a = o / 2, f = u / 2;
        this._svg_group.attr("transform", this.sprintf("translate({width},{height})", {width: a,height: f}));
        var l = e._dataAdapter.data(), c = a - this._options.horizontalPadding, h = f - this._options.verticalPadding, p = this._options.labelFormatter || function(t) {
            t.append("tspan").attr("class", "flower-cv-petal-label").text(function(e) {
                return e.label + " "
            }), t.append("tspan").attr("class", "flower-cv-petal-label-value").text(function(t) {
                return e._formatNumber("percent", t.value / e._total, 0)
            })
        }, d = this._options.mouseoverCallback[0] || function() {
            i.select(this).attr("opacity", 1)
        }, v = this._options.mouseoverCallback[1] || function(e) {
            i.select(this).attr("opacity", e.petal_opacity).attr("fill", e.petal_color)
        };
        this._is_single_mode = this._options.onlyUseThreePetalLengths, this._petal_size = Math.min(c, h), this._circle_size = this._petal_size * .676 / 2, this._arc_thickness = this._petal_size * .027, this._arc_half_angle = 360 / l.length / 2 + .5, this._petal_count = l.length;
        var m = i.scale.linear().domain([55, 185]).range([9, 12]).clamp(!0);
        this._font_size = m(this._petal_size);
        var g = [{offset_y: 1,fixed_offset_y: 0,offset_x: 0,location: "middle"}, {offset_y: 1,fixed_offset_y: 0,offset_x: -1.5,location: "middle"}, {offset_y: 0,fixed_offset_y: -2.5,offset_x: -0.8,location: "start"}, {offset_y: -1,fixed_offset_y: -9,offset_x: -1.5,location: "middle"}, {offset_y: -1,fixed_offset_y: -9,offset_x: 0,location: "middle"}, {offset_y: -1,fixed_offset_y: -9,offset_x: 1.5,location: "middle"}, {offset_y: 0,fixed_offset_y: -2.5,offset_x: .8,location: "end"}, {offset_y: 1,fixed_offset_y: 0,offset_x: 1.5,location: "middle"}];
        this._total = i.sum(l, function(e) {
            return e.value
        });
        var y = i.scale.linear().domain([0, l.length]).range([0, 360]);
        this._getTextOffsetIndex = i.scale.linear().domain([0, 360]).rangeRound([0, 8]).clamp(!0), this._getSizeZeroToThree = i.scale.linear().domain([0, i.max(l, function(e) {
                return e.value
            })]).rangeRound([0, 3]), this._getPetalSize = i.scale.linear().domain([i.min(l, function(e) {
                return e.value
            }), i.max(l, function(e) {
                return e.value
            })]).rangeRound([this._circle_size + this._arc_thickness + 10, this._petal_size]), r.util.each(l, function(t, n) {
            t.angle = y(n), e._addPetalSizes(t)
        }), this._getTextOffsetScale = function(e) {
            var t = this._getTextOffsetIndex(e);
            return t == 8 && (t = 0), g[t]
        };
        var b = this.layer1.selectAll(".flower-cv-gray-petals").data(l);
        b.enter().append("path").attr("class", "flower-cv-gray-petals").attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }).attr("d", e._makePetal(0, 0, 0, 0)).attr("opacity", 0), b.transition().duration(e._options.animationDuration).attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }).attr("d", function(t) {
            return e._makePetal(0, 0, 0, t.full_petal)
        }).attr("opacity", function(e) {
            return e.petal_size_number == 3 ? 0 : 1
        }), b.exit().transition().duration(e._options.animationDuration).attr("d", e._makePetal(0, 0, 0, 0)).attr("opacity", 0).remove();
        var w = this.layer2.selectAll(".flower-cv-color-petals").data(l);
        w.enter().append("path").attr("class", "flower-cv-color-petals").attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }).attr("opacity", function(e) {
            return e.petal_opacity
        }).attr("d", e._makePetal(0, 0, 0, 0)).attr("fill", function(e) {
            return e.petal_color
        }).on("mouseover", d).on("mouseout", v).on("click", function(t) {
            e._options.clickHandler && e._options.clickHandler(t)
        }), w.transition().duration(e._options.animationDuration).attr("d", function(t) {
            return e._makePetal(0, 0, 0, t.petal_size)
        }).attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }).attr("fill", function(e) {
            return e.petal_color
        }).attr("opacity", function(e) {
            return e.petal_opacity
        }), w.exit().transition().duration(e._options.animationDuration).attr("d", e._makePetal(0, 0, 0, 0)).attr("opacity", 0).remove();
        var E = this.layer3.selectAll(".flower-cv-white-arcs").data(l), S = i.svg.arc().innerRadius(0).outerRadius(this._circle_size + this._arc_thickness + 1).startAngle(-e._arc_half_angle * (Math.PI / 180)).endAngle(e._arc_half_angle * (Math.PI / 180));
        E.enter().append("path").attr("class", "flower-cv-white-arcs").attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }).attr("fill", "white"), E.transition().duration(e._options.animationDuration).attr("d", S).attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }), E.exit().remove(), S = i.svg.arc().innerRadius(0).outerRadius(this._circle_size + this._arc_thickness).startAngle(-(e._arc_half_angle - 1) * (Math.PI / 180)).endAngle((e._arc_half_angle - 1) * (Math.PI / 180));
        var x = this.layer4.selectAll(".flower-cv-color-arcs").data(l);
        x.enter().append("path").attr("class", "flower-cv-color-arcs").attr("d", S).attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }).attr("fill", function(e) {
            return e.arc_color
        }), x.transition().duration(e._options.animationDuration).attr("d", S).attr("fill", function(e) {
            return e.arc_color
        }).attr("transform", function(e) {
            return "rotate(" + e.angle + ")"
        }), x.exit().remove();
        var T = this.layer5.selectAll(".flower-cv-petal-labels").data(l);
        T.enter().append("text").attr("class", "flower-cv-petal-labels").attr("x", 0).attr("y", 0).attr("text-anchor", function(t) {
            return e._getTextOffsetScale(t.angle).location
        }).attr("dx", function(t) {
            return e._getTextOffsetScale(t.angle).offset_x * -e._options.text_offset
        }).attr("dy", function(t) {
            return e._getTextOffsetScale(t.angle).offset_y * -e._options.text_offset - e._getTextOffsetScale(t.angle).fixed_offset_y
        }).style("font-size", e._font_size).attr("transform", function(e) {
            return "rotate(" + e.angle + ") rotate(" + -e.angle + ", 0, " + 0 + ")"
        }).attr("opacity", 0), T.style("font-size", e._font_size + "px").attr("text-anchor", function(t) {
            return e._getTextOffsetScale(t.angle).location
        }).attr("dx", function(t) {
            return e._getTextOffsetScale(t.angle).offset_x * -e._options.text_offset
        }).attr("dy", function(t) {
            return e._getTextOffsetScale(t.angle).offset_y * -e._options.text_offset - e._getTextOffsetScale(t.angle).fixed_offset_y
        }).selectAll("*").remove(), p(T), T.transition().duration(e._options.animationDuration).attr("y", function(e) {
            return e.petal_size
        }).attr("transform", function(e) {
            return "rotate(" + e.angle + ") rotate(" + -e.angle + ", 0, " + e.petal_size + ")"
        }).attr("opacity", function(e) {
            return e.petal_number_size === 0 ? 0 : 1
        }), T.exit().remove();
        var N = this.layer6.selectAll(".flower-cv-main-circle").data([1]);
        N.enter().append("circle").attr("class", "flower-cv-main-circle").attr("cx", 0).attr("cy", 0), N.transition().duration(e._options.animationDuration).attr("r", e._circle_size)
    }, s._makePetal = function(e, t, n, r) {
        var i = this._circle_size + this._arc_thickness + 1, s = i * 2 * Math.PI / this._petal_count / 2, o = s / (i * 2 * Math.PI) * 360, u = Math.cos(o * Math.PI / 180) * i, a = Math.sin(o * Math.PI / 180) * i;
        t = -u;
        var f = e - a, l = e + a, c = (r - t) * -1 * .6, h = (r - t) * -1, p = h * .2, d = ["M", f, t, "C", f - p, t - c, e, r, n, r, "C", n, r, l + p, t - c, l, t];
        return d.join(" ")
    }, s._addPetalSizes = function(e) {
        e.color || (e.color = this.colorScale(e.label));
        var t = this._getSizeZeroToThree(e.value);
        this._is_single_mode || t === 0 && (t = 1), e.value === 0 && (t = 0);
        var n = .9, r = e.color, i = r, s = this._petal_size, o = s * -1;
        switch (t) {
            case 0:
                n = 0, i = "#e6e6e6", s = 0, r = r;
                break;
            case 3:
                n = .9;
                break;
            case 2:
                n = .75, s *= .795;
                break;
            case 1:
                n = .5, s *= .6
        }
        this._is_single_mode || (s = this._getPetalSize(e.value)), e.value === 0 && (s = 0), s *= -1, e.petal_opacity = n, e.petal_size = s, e.petal_color = r, e.full_petal = o, e.petal_number_size = t, e.arc_color = i
    }, e.cloudViz.flower = t.util.createConstructor(s)
}(this), function(e) {
    function y(e, t, n, r) {
        return w(b(e, t, n, r)) - w(n) - w(r) - Math.PI / 2
    }
    function b(e, t, n, r) {
        return n + e(t) * (r - n)
    }
    function w(e) {
        return e * Math.PI / 180
    }
    function E(e, t, n) {
        return Math.max(t, Math.min(n, e))
    }
    function S(e, t, n) {
        var r = [];
        if (n && t.length > 1) {
            var i = x(e.domain()), s = -1, o = t.length, u = (t[1] - t[0]) / ++n, a, f;
            while (++s < o)
                for (a = n; --a > 0; )
                    (f = +t[s] - a * u) >= i[0] && r.push(f);
            for (--s, a = 0; ++a < n && (f = +t[s] + a * u) < i[1]; )
                r.push(f)
        }
        return r
    }
    function x(e) {
        var t = e[0], n = e[e.length - 1];
        return t < n ? [t, n] : [n, t]
    }
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n), o = .15, u = .05, a = .09, f = 1 + u, l = .05, c = .025, h = 2, p = 14, d = .1, v = .75, m = null, g = null;
    s.init = function(e) {
        return this._type = "gauge", e = e || {}, this._initDefaultOptions(), this.setOptions(e), this
    }, s._initDefaultOptions = function(e) {
        var t = {duration: 750,percentOpen: d,showNeedle: !0,showAxis: !0,ticks: 5,tickSubdivisions: 0,format: "decimal",fillColor: "#3284d4",minValue: 0,maxValue: 10,colors: [{color: "#ff3400",alpha: 1,from: "0%",to: "33%"}, {color: "#faca00",alpha: 1,from: "33%",to: "66%"}, {color: "#68b672",alpha: 1,from: "66%",to: "100%"}],metric: "",value: 0};
        return this._margins = {top: 0,left: 0,right: 0,bottom: 0}, Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s.render = function() {
        return Object.getPrototypeOf(s).render.call(this, arguments), this._determineSize(), this._initScales(), this._draw(), this
    }, s._onAutoResize = function() {
        this.render()
    }, s._determineSize = function(e) {
        var t = this._options, n = t.parent, r = t.width ? t.width : n.offsetWidth, i = t.height ? t.height : n.offsetHeight, s = Math.max(d, Math.min(v, t.percentOpen));
        t.showNeedle && (this._margins.bottom = i * .05), this._maxAngle = (1 - s) * 180, this._minAngle = (1 - s) * -180, r -= this._margins.left + this._margins.right, this._size = [r, i], this._radius = Math.min(r - this._margins.left - this._margins.right, i - this._margins.top - this._margins.bottom) / 2
    }, s._initScales = function() {
        var e = this._options;
        if (e.minValue > e.maxValue)
            throw new Error("The minimum value is greater than the maximum value.");
        this._scale = i.scale.linear().domain([e.minValue, e.maxValue]).range([0, 1])
    }, s._draw = function() {
        this._initSVG(), this._drawTrack(), this._drawAxis(), this._drawSelectedIndicator(), this._drawLabels()
    }, s._initSVG = function() {
        var e = this._options, t = i.select(e.parent);
        m = t.selectAll(".cv-wrapper.cv-gauge").data([0]), m.enter().append("div").classed("cv-wrapper cv-gauge", !0), m.style("width", this._size[0] + "px").style("height", this._size[1] + "px");
        var n = m.selectAll(".chart-wrapper").data([0]);
        n.enter().append("div").classed("chart-wrapper", !0);
        var r = n.selectAll("svg").data([0]);
        r.enter().append("svg"), g = r.selectAll("g").data([0]), g.enter().append("g"), g.attr("transform", "translate(" + (this._size[0] - this._margins.left - this._margins.right) / 2 + "," + (this._size[1] - this._margins.top - this._margins.bottom) / 2 + ")")
    }, s._drawTrack = function() {
        var e = this, t = this._options, n = i.svg.arc().innerRadius(this._radius * (1 - u - o)).outerRadius(this._radius * (1 - u)).startAngle(function(t, n) {
            var i = r.util.isPercentString(t.from) ? parseInt(t.from, 10) / 100 : e._scale(t.from), s = (e._maxAngle - e._minAngle) * i + e._minAngle;
            return w(s)
        }).endAngle(function(t, n) {
            var i = r.util.isPercentString(t.to) ? parseInt(t.to, 10) / 100 : e._scale(t.to), s = (e._maxAngle - e._minAngle) * i + e._minAngle;
            return w(s)
        }), s = g.selectAll(".arc").data([0]);
        s.enter().append("g").classed("arc", !0);
        var a = s.selectAll("path").data(t.colors);
        a.enter().append("path"), a.exit().remove(), a.attr("fill", function(e, t) {
            return e.color
        }).attr("opacity", function(e, t) {
            return e.hasOwnProperty("alpha") ? e.alpha : 1
        }).attr("d", n)
    }, s._drawAxis = function() {
        var e = this, t = this._options, n = this._scale.ticks(t.ticks), r = function(t, n, r, i) {
            return function(s) {
                s.attr("x1", 0).attr("y1", h).attr("x2", 0).attr("y2", e._radius * i + h).attr("transform", function(i) {
                    var s = b(t, i, n, r);
                    return "rotate(" + b(t, i, n, r) + ") translate(0," + (e._radius * (o + u) - e._radius) + ")"
                })
            }
        }, i = g.selectAll(".axis").data(t.showAxis ? [0] : []);
        i.enter().append("g").classed("axis", !0), i.exit().remove();
        var s = i.selectAll(".tick").data(n);
        s.enter().append("line").classed("tick", !0), s.exit().remove(), s.call(r(this._scale, this._minAngle, this._maxAngle, l));
        var a = S(this._scale, n, t.tickSubdivisions), f = i.selectAll(".minor-tick").data(a);
        f.enter().append("line").classed("minor-tick", !0), f.exit().remove(), f.call(r(this._scale, e._minAngle, e._maxAngle, c));
        var d = i.selectAll(".tick-label").data(n);
        d.enter().append("text").classed("tick-label", !0), d.exit().remove(), d.attr("transform", function(t) {
            var n = b(e._scale, t, e._minAngle, e._maxAngle), r = y(e._scale, t, e._minAngle, e._maxAngle), i = (e._radius - p) * (1 - o - u - l), s = Math.cos(r) * i, a = Math.sin(r) * i;
            return n < -10 && n > -170 && (s -= 3), n > 10 && n < 170 && (s += 3), "translate(" + s + "," + a + ")"
        }).attr("text-anchor", function(t) {
            var n = b(e._scale, t, e._minAngle, e._maxAngle);
            return n > -10 && n < 10 ? "middle" : n < 0 ? null : "end"
        }).attr("dy", ".35em").style("font-size", E(e._radius * .05, 8, 14) + "px").text(function(n) {
            return e._formatNumber(t.format, n)
        })
    }, s._drawSelectedIndicator = function() {
        var e = this._options;
        this._drawNeedle(e.showNeedle ? [e.value] : []), this._drawProgressFill(e.showNeedle ? [] : [e.value])
    }, s._drawNeedle = function(e) {
        var t = this, n = this._options, r = this._radius * a / 2, s = this._radius * f, o = g.selectAll(".needle").data(e);
        o.enter().append("path").classed("needle", !0).attr("transform", "rotate(" + t._minAngle + ")"), o.exit().remove(), o.attr("d", "M" + r / 2 + "-" + r + "L0-" + s + "L-" + r / 2 + "-" + r + "C-" + r * .8257 + "-" + r * .8212 + "-" + r * 1.035 + "-" + r / 2 * .9448 + "-" + r * 1.035 + "-1" + "C-" + r * 1.035 + "," + r / 2 * .9078 + "-" + r * .5796 + "," + r * .9314 + ",0," + r * .9314 + "S" + r * 1.035 + "," + r / 2 * .9078 + "," + r * 1.035 + "-1" + "C" + r * 1.035 + "-" + r / 2 * .9448 + "," + r * .8257 + "-" + r * .8212 + "," + r / 2 + "-" + r + "z").transition().duration(n.duration).ease("cubic-in-out").attrTween("transform", function(e) {
            var r = this, s = Math.min(n.maxValue, Math.max(n.minValue, e)), o = b(t._scale, s, t._minAngle, t._maxAngle), u = this.__previousD__ === undefined ? t._minAngle : this.__previousD__, a = i.interpolate(u, o);
            return function(e) {
                return r.__previousD__ = a(e), "rotate(" + r.__previousD__ + ")"
            }
        })
    }, s._drawProgressFill = function(e) {
        var t = this, n = this._options, r = i.svg.arc().innerRadius(this._radius * (1 - u - o)).outerRadius(this._radius * (1 - u)).startAngle(w(t._minAngle)).endAngle(function(e) {
            return w(b(t._scale, e, t._minAngle, t._maxAngle))
        }), s = g.selectAll(".progress").data(e);
        s.enter().append("path").classed("progress", !0), s.exit().remove(), s.attr("fill", n.fillColor).transition().duration(n.duration).attrTween("d", function(e) {
            var t = this, s = Math.min(n.maxValue, Math.max(n.minValue, e)), o = this.__previousD__ === undefined ? n.minValue : this.__previousD__, u = i.interpolate(o, s);
            return function(e) {
                return t.__previousD__ = u(e), r(t.__previousD__)
            }
        })
    }, s._drawLabels = function() {
        var e = this, t = this._options, n = t.value === undefined ? [] : [t.value], r = t.metric === undefined ? [] : [t.metric], i = y(this._scale, t.minValue, this._minAngle, this._maxAngle), s = y(this._scale, t.maxValue, this._minAngle, this._maxAngle), a = this._radius * (1 - o - u), f = (this._radius - p) * (1 - o - u - l), c = Math.cos(i) * f + this._radius, h = Math.cos(s) * f + this._radius, d = Math.sin(i) * a + this._radius, v = m.selectAll(".label-container").data([0]);
        v.enter().append("div").classed("label-container", !0), v.style("left", this._size[0] / 2 - this._radius + "px");
        var g = v.selectAll(".label-title").data(r);
        g.enter().append("span").classed("label-title", !0), g.exit().remove(), g.style("font-size", E(this._radius * .1, 11, 18) + "px").classed("multiline-ellipsis", !t.showNeedle).text(String);
        var b = v.selectAll(".label-number").data(n), w = Math.max(d, this._radius * 1.1);
        b.enter().append("span").classed("label-number", !0).style("line-height", this._radius * o + "px"), b.exit().remove(), b.style("left", c + "px").style("width", h - c + "px").style("font-size", this._radius * o + "px").text(function(n) {
            return e._formatNumber(t.format, n)
        });
        if (t.showNeedle)
            g.style("top", w + this._radius * .2 + "px").style("left", 0).style("width", this._radius * 2 + "px"), b.style("top", w + "px");
        else {
            var S = E(this._radius * .1, 11, 20) * 2.3, x = this._radius * (1 - u);
            g.style("top", x + "px").style("left", this._radius * (o + u + l + .3) + "px").style("width", this._radius * (1 - o - u - l - .3) * 2 + "px").style("height", S + "px"), b.style("top", Math.max(x + S, w) + "px")
        }
    }, e.cloudViz.gauge = t.util.createConstructor(s)
}(this), function(e) {
    function S(e) {
        return "<span class='series-name'>" + e.parent.name + "</span>" + "<span class='metric-value'>" + e.value + "</span>" + "<span class='metric-name'>" + e.name + "</span>"
    }
    function x(e) {
        var t = function(e) {
            return e.depth === 1 ? 3 : e.depth === 2 ? 1 : 0
        };
        e.style("left", function(e) {
            return v(e.x) + 1 + "px"
        }).style("top", function(e) {
            return m(e.y) + 1 + "px"
        }).style("width", function(e) {
            return v(e.x + e.dx) - v(e.x) - 2 + "px"
        }).style("height", function(e) {
            return e.children && e.parent ? null : m(e.y + e.dy) - m(e.y) - 2 + "px"
        })
    }
    function T(e) {
        e.style("background-color", function(e) {
            return e.children || !e.parent ? null : g(e.parent.name)
        })
    }
    var t = e.cloudViz || {}, n = t.core || {}, r = e.dv || {}, i = e.d3 || {}, s = Object.create(n), o = 0, u = 0, a = 0, f = 25, l = 1, c = 1, h = 3, p = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?|\.[0-9]+)\s*\)/, d = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/, v = i.scale.linear(), m = i.scale.linear(), g = i.scale.ordinal(), y, b, w = !0, E;
    s.init = function(e) {
        return this._type = "treemap", e = e || {}, this._initDefaultOptions(), this.setOptions(e), this
    }, s._initDefaultOptions = function(e) {
        var t = {colors: ["#8cc350", "#5a6eaa", "#d755a5", "#1ebed7", "#f0a01e", "#9b8ce6", "#3cb5a0", "#3287d2", "#f0557d", "#c3d250", "#eb782d", "#78b4f5", "#5faf69", "#aa5fa5", "#fa5a50", "#f5c841"],layout: "squarify",duration: 750,tooltipContent: S};
        return Object.getPrototypeOf(s)._initDefaultOptions.call(this, t)
    }, s.reset = function() {
    }, s._preRender = function() {
        this._determineSize(this._options.data), this._configureScales(this._options.data), this._configureLayout()
    }, s._render = function() {
        return this._initContainer(), this._draw(this._options.data), w = !1, this
    }, s._postRender = function() {
    }, s._determineSize = function(e) {
        var t = this._options, n = t.parent;
        o = r.util.getPercentValue(t.width, n.offsetWidth), u = r.util.getPercentValue(t.height, n.offsetHeight)
    }, s._configureScales = function(e) {
        var t = this._options;
        g.domain(e.map(function(e) {
            return e.name
        })).range(t.colors);
        var n = e.hasOwnProperty("dx") ? [e.x, e.x + e.dx] : [0, o], r = e.hasOwnProperty("dy") ? [e.y, e.y + e.dy] : [0, u];
        v.domain(n).range([1, o - 2]), m.domain(r).range([1, u - 2])
    }, s._configureLayout = function() {
        E = i.layout.treemap().sticky(!0).value(function(e) {
            return e.value || 0
        }).sort(function(e, t) {
            return e.value - t.value
        }).mode(this._options.layout).round(!1)
    }, s._initContainer = function() {
        var e = this._options, t = i.select(e.parent).selectAll(".cv-wrapper.cv-treemap").data([0]);
        t.enter().append("div").classed("cv-wrapper cv-treemap", !0), y = t.selectAll(".chart-wrapper").data([0]), y.enter().append("div").classed("chart-wrapper", !0).style("position", "relative"), y.style("width", o + "px").style("height", u + "px"), b = y.selectAll(".node-container").data([0]), b.enter().append("div").classed("node-container", !0).style("overflow", "hidden"), b.style("width", o + "px").style("height", u + "px")
    }, s._draw = function(e) {
        var t = this, n = this._options, s = {children: this._options.data}, a = E.size([o, u]).padding([f, l, h, c]).nodes(s), p = a.filter(function(e) {
            return !e.children
        }), d = a.filter(function(e) {
            return e.parent && e.children
        }), v, m = b.selectAll(".cv-node").data(a), g = m.enter().append("div").classed("cv-node", !0).on("click", function(e, n) {
            if (e.depth > 0) {
                var r = i.select(this), s = [];
                if (e.children) {
                    s = b.selectAll(".second-level").filter(function(t) {
                        return e.children.indexOf(t) >= 0
                    }), s[0].push(this);
                    var o = b.selectAll(".cv-node.selected"), u = [];
                    o[0].indexOf(this) >= 0 ? u = o[0].filter(function(e) {
                        var t = s[0].indexOf(e) >= 0;
                        return !t
                    }) : u = s[0].concat(o[0]), s[0] = u, t._selectNodes(s)
                } else {
                    s = b.selectAll(".cv-node.selected");
                    var a = s[0].indexOf(this), f;
                    if (a >= 0) {
                        s[0].splice(a, 1), f = t._getParentNode(this);
                        var l = s[0].indexOf(f);
                        l >= 0 && (v = 0, f.__data__.children.forEach(function(e) {
                            s.each(function(t) {
                                t == e && v++
                            })
                        }), f.__data__.children.length - 1 === v && s[0].splice(l, 1))
                    } else
                        s[0].push(this), f = t._getParentNode(this), v = 0, f.__data__.children.forEach(function(e) {
                            s.each(function(t) {
                                t == e && v++
                            })
                        }), f.__data__.children.length === v && s[0].push(f);
                    t._selectNodes(s)
                }
                t._eventMap.click && t._eventMap.click.call(this, e, n, i.event)
            }
        }).on("mouseover", function(e, s) {
            if (!e.children) {
                var o = i.select(this), u = {x: e.x + e.dx / 4,y: e.y + e.dy / 2,width: e.dx / 2,height: e.dy / 2}, a = {x: 0,y: 0,width: y.node().getBoundingClientRect().width,height: y.node().getBoundingClientRect().height}, f = null;
                o.classed("hovered", !0), f = n.tooltipContent.call(this, e, s), r.showTooltip(u, a, f, "top", 5, y), t._eventMap.mouseover && t._eventMap.mouseover.call(this, e, s, i.event)
            }
        }).on("mouseout", function(e, n) {
            if (!e.children) {
                var s = i.select(this);
                s.classed("hovered", !1), r.removeTooltip(y), t._eventMap.mouseout && t._eventMap.mouseout.call(this, e, n, i.event)
            }
        });
        g.append("div"), g.call(x).call(T), m.exit().remove(), m.classed("main-level", function(e) {
            return e.depth === s.depth + 1
        }).classed("second-level", function(e) {
            return e.depth === s.depth + 2
        }).call(T).call(x), m.select("div").text(function(e) {
            var t = e.hasOwnProperty("name") && e.parent === s ? e.name : null, n = e.hasOwnProperty("label") && e.parent === s ? e.label : null;
            return n || t
        }).style("opacity", function(e) {
            return e.dx < 50 || e.dy < 25 ? 0 : 1
        })
    }, s._selectNodes = function(e) {
        var t = b.selectAll(".cv-node.selected");
        t.classed("selected", !1), e.classed("selected", !0)
    }, s._getParentNode = function(e) {
        var t, n = i.select(this._options.parent).selectAll(".main-level");
        return n[0].forEach(function(n) {
            n.__data__.children.indexOf(e.__data__) >= 0 && (t = n)
        }), t
    }, s.setSelected = function(e) {
        var t = this, n = i.select(this._options.parent).selectAll(".second-level").filter(e);
        return n[0].forEach(function(e) {
            var r = t._getParentNode(e), i = 0;
            r && (r.__data__.children.forEach(function(e) {
                n.each(function(t) {
                    t == e && i++
                })
            }), r.__data__.children.length === i && n[0].push(r))
        }), t._selectNodes(n), t
    }, s.getSelected = function() {
        var e = [], t = b.selectAll(".second-level.cv-node.selected");
        return t && t[0].forEach(function(t) {
            e.push(t.__data__)
        }), e
    }, e.cloudViz.treemap = t.util.createConstructor(s)
}(this), function(e) {
    var t = e.cloudViz, n = e.dv, r = t.util.namespace("cloudViz.dataAdapter.standard"), i = {};
    i._isDataValid = null, i.process = function(e, n) {
        this._options = e, this.l10n = t.util.deepExtend({}, t.localeDefinition(e.locale), e.l10n || {});
        if (!("data" in n || "mappings" in n))
            return;
        if (!this._validateData(e.data, e.mappings))
            return;
        this._processOptions(e, n)
    }, i._processOptions = function(e, t) {
    }, i._determineOvertime = function(e) {
        var t = this.mappings(), r = e[t.x];
        return !r || !r.length ? !1 : n.util.isDate(r[0])
    }, i._calculateDateGranularity = function(e) {
        var t = this.mappings(), n = e[t.x];
        if (!n || !n.length)
            return "*";
        var r = Math.min.apply(Math, n), i = Math.max.apply(Math, n), s = (i - r) / 1e3, o = s / n.length;
        return this.getTimeGranularity(o).gran
    }, i.getTimeGranularity = function(e, t) {
        var n = "second", r = 1;
        return e ? (t ? e >= (r = 31536e3) ? n = "year" : e >= (r = 2678400) ? n = "month" : e >= (r = 604800) ? n = "week" : e >= (r = 86400) ? n = "day" : e >= (r = 3600) ? n = "hour" : e >= (r = 60) ? n = "minute" : (n = "second", r = 1) : e <= (r = 1) ? n = "second" : e <= (r = 60) ? n = "minute" : e <= (r = 3600) ? n = "hour" : e <= (r = 86400) ? n = "day" : e <= (r = 604800) ? n = "week" : e <= (r = 2678400) ? n = "month" : (n = "year", r = 31536e3), {gran: n,divisor: r}) : {gran: n,divisor: r}
    }, i._getYTitleFromLabels = function(e) {
        var t = n.util.uniq(e);
        return t && t.length === 1 ? t[0] : null
    }, i.data = function() {
        return this._options.data
    }, i.mappings = function() {
        return this._options.mappings
    }, i.formats = function() {
        return this._options.formats
    }, i.xAxisTitle = function() {
        return this._options.xAxisTitle || null
    }, i.yAxisTitle = function() {
        return this._options.yAxisTitle || null
    }, i.dateGranularity = function() {
        return this._processedOptions.dateGranularity
    }, i.isDataValid = function() {
        return this._validateData(this._options.data, this._options.mappings)
    }, i._validateData = function(e, t) {
        if (!e)
            return !1;
        for (var n in e)
            if (e[n].length)
                return !0;
        return !1
    }, r.baseObj = i, r.base = t.util.createConstructor(i)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.baseObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e), i = this.data(), s = this.mappings();
        this._uniqueFillValues = this._processUniqueFillValues(i, s), this._uniqueFillExtents = this._processUniqueFillExtents(i, s, this._uniqueFillValues), n.isOvertime == null && (n.isOvertime = this._determineOvertime(i), n.isOvertime && (n.dateGranularity = n.dateGranularity || this._calculateDateGranularity(i))), Object.getPrototypeOf(r)._processOptions.call(this, n, t)
    }, r.isOvertime = function() {
        return this._processedOptions.isOvertime
    }, r.uniqueFillValues = function() {
        return this._uniqueFillValues || []
    }, r.uniqueFillExtents = function() {
        return this._uniqueFillExtents
    }, r.getUniqueFillExtent = function(e) {
        var t = this._uniqueFillValues[e];
        return t ? this._uniqueFillExtents[t] : null
    }, r.getUniqueFillExtentByFill = function(e) {
        return this._uniqueFillExtents[e]
    }, r._processUniqueFillValues = function(e, t) {
        var n = e[t.series];
        return n ? dv.util.uniq(n) : []
    }, r._processUniqueFillExtents = function(e, t, n) {
        var r = e[t.series], i = e[t.y], s = {};
        return i.map(function(e, t) {
            var n = r[t];
            if (!isFinite(e) || e === null)
                return;
            s[n] || (s[n] = [e, e]), s[n][0] = Math.min(e, s[n][0]), s[n][1] = Math.max(e, s[n][1])
        }), s
    }, n.barObj = r, n.bar = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.baseObj), i = e.d3 || {};
    r._processOptions = function(e, t) {
        Object.getPrototypeOf(r)._processOptions.apply(this, arguments)
    }, r._validateData = function(e, t) {
        return e ? !0 : !1
    }, r.data = function() {
        return this._options.data
    }, r.metric = function() {
        return this._options.metric
    }, r.format = function() {
        return this._options.format
    }, n.choroplethObj = r, n.choropleth = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.barObj), i = 3;
    r._processOptions = function(e, t) {
        this._processCategories(e), Object.getPrototypeOf(r)._processOptions.call(this, this._processedOptions, t)
    }, r._processCategories = function(e) {
        var t = Object.create(e), n = Object.create(e.data), r = e.mappings, i = r.y, s = r.x, o = r.series, u = r.seriesLabel || o, a = [], f, l = n[i].length, c, h = [], p = [], d = {}, v;
        for (f = 0; f < l; ++f) {
            a[f] = {};
            for (c in n) {
                v = n[c][f];
                if (c === o)
                    if (h.length) {
                        if (v !== h[h.length - 1]) {
                            if (h.length === this.maxFacets) {
                                l--, f--, a.pop();
                                break
                            }
                            h[h.length] = v, p[p.length] = n[u][f], d[v] = h.length
                        }
                    } else
                        h = [v], p = [n[u][f]], d[v] = h.length;
                a[f][c] = v
            }
        }
        this.numFacets = h.length, a.sort(function(e, t) {
            return e[o] === t[o] ? t[i] - e[i] : d[e[o]] - d[t[o]]
        });
        for (c in n)
            n[c] = [];
        n.cvdonutorder = [];
        var m = 0, g, y, b = this._options.maxSlices;
        this.otherIncluded = !1;
        for (f = 0, l = a.length; f < l; ++f) {
            y = a[f][o], y !== g && (m = 0, g = y);
            if (m == b - 1 && f + 1 < l && a[f + 1][o] === y) {
                for (c in n)
                    n[c] || (n[c] = []), n[c][f] = a[f][c];
                this.otherIncluded = !0, n[s][f] = this.l10n.labels.core.other, ++m, n.cvdonutorder[f] = f;
                continue
            }
            if (m >= b) {
                n[i][f - 1] += a[f][i], a.splice(f, 1), l = a.length, --f, ++m;
                continue
            }
            ++m;
            for (c in n)
                n[c][f] = a[f][c];
            n.cvdonutorder[f] = f
        }
        t.yAxisTitle = e.yAxisTitle || p, t.data = n, this._processedOptions = t
    }, r.processLabelData = function(e) {
        var t = this.data(), n = this.mappings(), r = this._labelData = Object.create(t), i = {}, s = {}, o = this, u = r[n.series], a = r[n.y], f = r[n.x];
        u.forEach(function(t, n) {
            i[t] === undefined && (i[t] = 0), s[t] === undefined && (s[t] = 0), i[t] += a[n];
            if (!e.isSeriesEnabled || e.isSeriesEnabled(f[n]))
                s[t] += a[n]
        });
        var l = r.cvtextvalue = [], c = r.cvtextperclabel = [], h = r.cvtextvallabel = [], p = {}, d, v, m, g;
        a.forEach(function(t, n) {
            d = u[n], v = parseFloat(t) / i[d] * 100, h[n] = t, c[n] = (v % 1 !== 0 ? v.toFixed(1) : v) + "%", g = !e.isSeriesEnabled || e.isSeriesEnabled(f[n]), m = parseFloat(t) / s[d] * 100, p[d] === undefined && (p[d] = 0), l[n] = g ? p[d] + m / 2 : 0, p[d] += g ? m : 0
        })
    }, r.data = function() {
        return this._processedOptions.data
    }, r.labelData = function() {
        return this._labelData
    }, r.yAxisTitle = function(e) {
        var t = this._processedOptions.yAxisTitle;
        return t instanceof Array && t.length > e && (t = t[e]), t
    }, r.showOtherCategory = function() {
        return this.otherIncluded
    }, r.numberOfFacets = function() {
        return this.numFacets
    }, n.donutObj = r, n.donut = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.baseObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e), i = this.data(), s = this.mappings();
        this._forceZero = e._forceZero, this._uniqueStrokeValues = this._processUniqueStrokeValues(i, s), this._uniqueStrokeExtents = this._processUniqueStrokeExtents(i, s), n.isOvertime == null && (n.isOvertime = this._determineOvertime(i), n.isOvertime && (n.dateGranularity = n.dateGranularity || this._calculateDateGranularity(i))), Object.getPrototypeOf(r)._processOptions.call(this, n, t)
    }, r.isOvertime = function() {
        return this._processedOptions.isOvertime
    }, r.uniqueStrokeValues = function() {
        return this._uniqueStrokeValues || []
    }, r.uniqueStrokeExtents = function() {
        return this._uniqueStrokeExtents
    }, r.getUniqueStrokeExtent = function(e) {
        var t = this._uniqueStrokeValues[e];
        return t ? this._uniqueStrokeExtents[t] : null
    }, r.getUniqueStrokeExtentByStroke = function(e) {
        return this._uniqueStrokeExtents[e]
    }, r._processUniqueStrokeValues = function(e, t) {
        var n = e[t.series];
        return n ? dv.util.uniq(n) : []
    }, r._processUniqueStrokeExtents = function(e, t) {
        var n = e[t.series], r = e[t.y], i = {};
        return r.map(function(e, t) {
            var r = n[t];
            if (!isFinite(e) || e === null)
                return;
            i[r] || (i[r] = [e, e]), i[r][0] = Math.min(e, i[r][0]), i[r][1] = Math.max(e, i[r][1])
        }), i
    }, n.lineObj = r, n.line = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.baseObj);
    r.sizeMetricName = function() {
        return this._options && this._options.sizeTitle || null
    }, r.isBubble = function() {
        var e = this.mappings().size;
        return e && e.length
    }, n.pointObj = r, n.point = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.baseObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e), i = JSON.parse(JSON.stringify(e.data));
        i.nodesById = [], i.nodes.map(function(e, t) {
            return e._pid = t, i.nodesById[t] = e, e
        }), i.links = [], i.linksById = [];
        var s, o, u, a, f, l = this;
        i.paths = i.paths.filter(function(e) {
            return e.values instanceof Array || (e.values = Array.apply(null, new Array(e.nodes.length - 1)).map(function() {
                return e.values
            })), e.values.some(function(e) {
                return e <= 0
            }) ? !1 : (e.nodes.map(function(e) {
                return e !== null ? i.nodes[e]._pid : null
            }), !0)
        }), i.paths.forEach(function(e, t) {
            e.nodes.forEach(function(n, r) {
                if (!r) {
                    s = e.nodes[r], s !== null && (i.nodesById[s].isPathStart = !0, i.nodesById[s].isPathEnd && (i.nodesById[s].isPivot = !0));
                    return
                }
                s = e.nodes[r - 1], o = n, r === e.nodes.length - 1 && o !== null && (i.nodesById[o].isPathEnd = !0, i.nodesById[o].isPathStart && (i.nodesById[o].isPivot = !0)), u = e.values[r - 1], a = l._generateLinkId(s, o), (f = i.linksById[a]) ? (f.value += u, f.paths.push(t)) : (f = {source: s,target: o,value: u,paths: [t]}, i.linksById[a] = f, i.links.push(f))
            })
        }), n.data = i, Object.getPrototypeOf(r)._processOptions.apply(this, arguments)
    }, r.data = function() {
        return this._processedOptions.data
    }, r.nodeKey = function() {
        return function(e, t) {
            return t
        }
    }, r.linkKey = function() {
        return function(e, t) {
            return t
        }
    }, r.pathingTitle = function() {
        return ""
    }, r.getPathEnd = function(e) {
        return null
    }, r.getPathDirection = function(e) {
        return 0
    }, r.activePathsTitle = function(e) {
        return e && e.length ? this.l10n.labels.pathing["path2+"] : ""
    }, r.isValidPathingData = function() {
        var e = this.data();
        return e ? !e.nodes || !e.paths ? !1 : e.nodes.length ? !0 : !1 : !1
    }, r._generateLinkId = function(e, t) {
        return e + "-" + t
    }, r._sortPaths = function(e, t) {
        var n = this.data();
        return function(i, s) {
            function o(e, t, r) {
                var u = e + r, a = t + r, f = u < i.nodes.length && u >= 0 ? i.nodes[u] : -1, l = a < s.nodes.length && a >= 0 ? s.nodes[a] : -1;
                f !== -1 && f !== null && (f = n.nodes.indexOf(n.nodesById[f])), l !== -1 && l !== null && (l = n.nodes.indexOf(n.nodesById[l]));
                if (null === f && null === l)
                    return 0;
                if (null === f)
                    return r > 0 ? 1 : -1;
                if (null === l)
                    return r > 0 ? -1 : 1;
                if (-1 === f && -1 === l)
                    return 0;
                if (-1 === f)
                    return 1;
                if (-1 === l)
                    return -1;
                var c = f - l;
                return c !== 0 ? c : o(u, a, r)
            }
            var u = i.nodes.indexOf(e._pid), a = s.nodes.indexOf(e._pid), f = o(u, a, t);
            return 0 === f && (f = o(u, a, -t)), 0 !== f ? f : s.nodes.length - i.nodes.length
        }
    }, r._generatePathLinks = function(e, t, n) {
        var r = this.data(), i = this, s, o, u, a, f, l, c, h, p = [];
        return !e || !e.nodes ? p : (e.nodes.forEach(function(n, d, v) {
            if (!d)
                return;
            s = e.nodes[d - 1], o = n, u = r.nodesById[s] || null, a = r.nodesById[o] || null, f = e.values[d - 1], l = null, d > 1 && (l = r.linksById[i._generateLinkId(e.nodes[d - 2], s)]), c = r.linksById[i._generateLinkId(s, o)], h = f / c.value * c.dy, u && p.push({dy: h,sy: l ? l.ty + l.offset - h : c.sy + c.offset,ty: a ? c.sy + c.offset : u.dy - h,source: {x: u.x,y: u.y,dx: 0},target: {x: u.x + u.dx,y: u.y},value: f,path: t,pivotStart: u.isPivot}), p.push({dy: h,sy: c.sy + c.offset,ty: c.ty + c.offset,source: u,target: a,value: f,path: t}), d + 1 === v.length && a && p.push({dy: h,sy: c.ty + c.offset,ty: c.ty + c.offset,source: {x: a.x,y: a.y,dx: 0},target: {x: a.x + a.dx,y: a.y},value: f,path: t,pivotEnd: a.isPivot}), c.offset += h
        }), p)
    }, r.nodePaths = function(e) {
        var t = this.data(), n = t.paths.filter(function(t) {
            return t.nodes.indexOf(e._pid) !== -1
        });
        return n
    }, r.nodePathData = function(e, t) {
        var n = this.data(), r = this, i = [], s = n.links;
        return s.forEach(function(e) {
            e.offset = 0
        }), e.sort(r._sortPaths(t, -1)), e.forEach(function(e, n) {
            i = i.concat(r._generatePathLinks(e, n, t))
        }), i
    }, r.linkSortActivePaths = function(e) {
        var t = this.data(), n = t.paths, r, i = e.source ? e.source : e.target;
        return t.links.forEach(function(e) {
            e.offset = 0
        }), r = e.paths.map(function(e) {
            return n[e]
        }), r.sort(this._sortPaths(i, -1)), r
    }, r.linkPathData = function(e) {
        var t = [], n = this;
        return e.forEach(function(e, r) {
            t = t.concat(n._generatePathLinks(e, r))
        }), t
    }, r.canExpandNode = function(e) {
        return !0
    }, r.canCollapseNode = function(e) {
        return !0
    }, r.canPivotNode = function(e) {
        return !0
    }, n.pathingObj = r, n.pathing = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.baseObj), i = e.d3 || {};
    r._processOptions = function(e, t, n) {
        function a(e) {
            return e.metrics && e.metrics.length && e.metrics[0] && "undefined" != typeof e.metrics[0].value ? e.metrics[0].value : !e.children || !e.children.length ? 0 : e.children.reduce(function(e, t) {
                return e + a(t)
            }, 0)
        }
        function f(e, t) {
            return a(t) - a(e)
        }
        function c(e, t) {
            e.size = "undefined" == typeof e.size ? a(e) : e.size;
            if (!e.children || !e.children.length)
                return;
            if (t < o.categories.length) {
                var n = o.categories[t], r = e.children.length;
                n.top = "undefined" != typeof n.top ? Math.max(n.top, r) : r
            }
            if ("undefined" != typeof e.size && u.format !== "percent") {
                var i = e.children.reduce(function(e, t) {
                    return e + a(t)
                }, 0);
                e.size > i && e.children.push({id: "cv-sb-other",name: l,size: e.size - i})
            }
            e.children.sort(f), e.children.forEach(function(e) {
                c(e, t + 1)
            })
        }
        function p(e, t, n) {
            var r = h[t] || (h[t] = []), i, s = e.length, o;
            for (i = 0; i < s; ++i) {
                o = e[i], o._sid = n + "s" + i;
                if (l === o.name)
                    continue;
                o.name && (r[r.length] = o.name), o.children && o.children.length && p(o.children, t + 1, o._sid)
            }
        }
        var i = n || this._processedOptions || {}, s = this._processedOptions = Object.create(e), o = JSON.parse(JSON.stringify(s.data)), u = o.metrics[0] || {name: "",format: "int"}, l = this.l10n.labels.core.other;
        c(o, 0);
        var h = [];
        p([o], 0, ""), o.name = u.name, h.push([u.name]), o.categories.forEach(function(e, t) {
            e.index = t
        }), s.uniques = h.reduce(function(e, t) {
            var n = t.reduce(function(e, t) {
                return e.indexOf(t) < 0 ? e.push(t) && e : e
            }, []);
            return e.concat(n)
        }, []), s.data = o, s.categories = o.categories, s.colorMetricIndex = i.colorMetricIndex, s.stackedMetricIndex = i.stackedMetricIndex, s.secondaryMetricIndex = i.secondaryMetricIndex, s.secondaryMetricType = i.secondaryMetricType, s.seqColors = s.seqColors, Object.getPrototypeOf(r)._processOptions.apply(this, arguments)
    }, r.data = function() {
        return this._processedOptions.data
    }, r.categories = function() {
        return this._processedOptions.categories
    }, r.uniques = function() {
        return this._processedOptions.uniques
    }, r.colors = function() {
        return this._processedOptions.colors
    }, r.seqColors = function() {
        return this._processedOptions.seqColors
    }, r.metricColor = function(e) {
        return this._processedOptions.metricColor
    }, r.otherColor = function(e) {
        return this._processedOptions.otherColor
    }, r.otherGrayColor = function(e) {
        return this._processedOptions.otherGrayColor
    }, r.outRangeColor = function(e) {
        return this._processedOptions.outRangeColor
    }, r.isOther = function(e) {
        return e.name === this.l10n.labels.core.other
    }, r.isRoot = function(e) {
        return !e.parent
    }, r.isDataEmpty = function() {
        var e = this.data();
        return !(e && e.children && e.children.length)
    }, r.isSizeEmpty = function() {
        return !this.data().size
    }, r._validateData = function(e) {
        return !e || !e.children || !e.children.length ? !1 : !0
    }, r.getPathKey = function(e, t) {
        return e && e._sid || t
    }, r.getDataByPathKey = function() {
        function i(e) {
            if (!e)
                return;
            r = t.getPathKey(e, null), r && (n[r] = e), e.children && e.children.forEach(i)
        }
        var e = this.data(), t = this, n = {}, r;
        return i(e), n
    }, r.getColorMetric = function() {
        var e = this._processedOptions.colorMetricIndex;
        return e ? this.data().metrics[e] : null
    }, r.getColorMetricIndex = function() {
        return this._processedOptions.colorMetricIndex
    }, r.setColorMetricIndex = function(e) {
        this._processedOptions.colorMetricIndex === e && (e = null), this._processedOptions.secondaryMetricIndex = e, this.setSecondaryMetricType("color")
    }, r.getStackedMetric = function() {
        var e = this._processedOptions.stackedMetricIndex;
        return e ? this.data().metrics[e] : null
    }, r.getStackedMetricIndex = function() {
        return this._processedOptions.stackedMetricIndex
    }, r.setStackedMetricIndex = function(e) {
        this._processedOptions.stackedMetricIndex === e && (e = null), this._processedOptions.secondaryMetricIndex = e, this.setSecondaryMetricType("height")
    }, r.getSecondaryMetricType = function() {
        return this._processedOptions.secondaryMetricType
    }, r.setSecondaryMetricType = function(e) {
        var t = this.getSecondaryMetricIndex() || 1, n = this._processedOptions, r = this;
        n.secondaryMetricIndex = t, n.secondaryMetricType = e;
        switch (e) {
            case "color":
                n.colorMetricIndex = t, n.stackedMetricIndex = null;
                break;
            case "height":
                n.colorMetricIndex = null, n.stackedMetricIndex = t;
                break;
            case "both":
                n.colorMetricIndex = t, n.stackedMetricIndex = t;
                break;
            default:
                n.colorMetricIndex = null, n.stackedMetricIndex = null, n.secondaryMetricIndex = null, n.secondaryMetricType = null
        }
    }, r.getSecondaryMetric = function() {
        var e = this._processedOptions.secondaryMetricIndex;
        return e ? this.data().metrics[e] : null
    }, r.getSecondaryMetricIndex = function() {
        return this._processedOptions.secondaryMetricIndex
    }, r.setSecondaryMetricIndex = function(e) {
        this._processedOptions.secondaryMetricIndex === e && (e = null), this._processedOptions.secondaryMetricIndex = e, this.setSecondaryMetricType(e ? this.getSecondaryMetricType() || "height" : null)
    }, n.sunburstObj = r, n.sunburst = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.standard"), r = Object.create(n.baseObj), i = e.d3 || {};
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e), i = e.data;
        e.isEmotionChart && (i = this._getEmotionData(e.data)), n.data = i, Object.getPrototypeOf(r)._processOptions.call(this, n, t)
    }, r._getEmotionData = function(e) {
        var t = this.l10n.labels.flower, n = [{index: "joy",label: t.joy,color: "#e6b43c"}, {index: "admiration",label: t.admiration,color: "#7daf4b"}, {index: "fear",label: t.fear,color: "#50965a"}, {index: "surprise",label: t.surprise,color: "#00a0be"}, {index: "sadness",label: t.sadness,color: "#286eaf"}, {index: "disgust",label: t.disgust,color: "#964196"}, {index: "anger",label: t.anger,color: "#f04641"}, {index: "anticipation",label: t.anticipation,color: "#dc5f00"}], r = {};
        return dv.util.each(e, function(e) {
            r[e.index] = e
        }), dv.util.each(n, function(e) {
            r[e.index] ? e.value = r[e.index].value || 0 : e.value = 0
        }), n
    }, r._validateData = function(e, t) {
        return e ? !0 : !1
    }, r.data = function() {
        return this._processedOptions.data
    }, n.flowerObj = r, n.flower = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.baseObj);
    r._getYFormats = function(e, t, n) {
        var r = [];
        if (!e || !e.metric || !t || !t.series || !n)
            return r;
        var i = e.metric.length;
        for (var s = 0; s < i; s++) {
            var o = e.metric[s], u = e[t.series], a = n.indexOf(u[s]);
            r[a] = o.type
        }
        return r
    }, r.mappings = function() {
        return this._processedOptions.mappings
    }, r.formats = function() {
        return this._processedOptions.formats
    }, n.baseObj = r, n.base = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.barObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e);
        n.isOvertime = this._determineOvertime(n.data), n.yAxisTitle = e.yAxisTitle || this._getYAxisTitle(n.data), n.dateGranularity = this._getTimeGranularity(n.data), this._processData(n), this._updateMappings(n), Object.getPrototypeOf(r)._processOptions.call(this, n, t), n.formats = {x: e.formats.x,y: this._getYFormats(n.data, n.mappings, this.uniqueFillValues())}
    }, r.isOvertime = function() {
        return this._processedOptions.isOvertime
    }, r.xAxisTitle = function() {
        return null
    }, r.yAxisTitle = function() {
        return this._processedOptions.yAxisTitle
    }, r.dateGranularity = function() {
        return this._processedOptions.dateGranularity
    }, r.data = function() {
        return this._processedOptions.data
    }, r.mappings = function() {
        return this._processedOptions.mappings
    }, r.formats = function() {
        return this._processedOptions.formats
    }, r._determineOvertime = function(e) {
        var t = e.date, n = e.metric && e.metric.some(function(e) {
            return e && e.date_ref && e.date_ref.length > 1
        });
        return t && t.length && n
    }, r._getYAxisTitle = function(e) {
        return this._getYTitleFromLabels(e.label)
    }, r._processData = function(e) {
        if (e.isOvertime)
            return;
        var t = Object.create(e.data), n, r = t.cell.length, i = null, s = null;
        t.group = [];
        for (n = 0; n < r; ++n)
            s = i, i = t.cell[n], t.group[n] = t.series[n], s && "incomplete" === i.status && "incomplete" !== s.status && (t.group[n] += "::incomplete::");
        e.data = t
    }, r._updateMappings = function(e) {
        var t = Object.create(e.mappings);
        e.isOvertime ? (t.x = "date", t.y = "value", t.group = "group", t.series = "series", t.seriesLabel = "series_name") : (t.x = "category", t.y = "value", t.series = "metric_series", t.seriesLabel = "metric_series_name"), e.mappings = t
    }, r._getTimeGranularity = function(e) {
        return e.metric[0].date_range.gran
    };
    var i = n.baseObj;
    r._getYFormats = i._getYFormats, n.bar = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.choroplethObj), i = e.d3 || {};
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e);
        this._processData(n, e), Object.getPrototypeOf(r)._processOptions.call(this, n, t)
    }, r._processData = function(e, t) {
        var n = t.data, r = n.data, i = n.metrics, s = n.filters, o = n.dates, u, a, f, l, c = {values: {}};
        for (var h = 0, p = i.length; h < p; ++h) {
            f = i[h], u = f.filter_ref, a = f.date_ref;
            for (var d = 0, v = u.length; d < v; ++d) {
                l = s[u[d]];
                for (var m = 0, g = a.length; m < g; ++m)
                    c.values[(l.info || {}).geo_id] = r[u[d]][a[m]][h].val
            }
        }
        e.data = c, e.metric = f.name, e.format = f.type
    }, r.data = function() {
        return this._processedOptions.data
    }, r.metric = function() {
        return this._processedOptions.metric
    }, r.format = function() {
        return this._processedOptions.format
    }, r._validateData = function(e, t) {
        return e ? !0 : !1
    }, r.data = function() {
        return this._processedOptions.data
    }, n.choropleth = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.donutObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e);
        this._updateMappings(n), Object.getPrototypeOf(r)._processOptions.call(this, n, t), n.formats = {x: e.formats.x,y: this._getYFormats(n.data, n.mappings, this.uniqueFillValues())}
    }, r.mappings = function() {
        return this._processedOptions.mappings
    }, r.formats = function() {
        return this._processedOptions.formats
    }, r._updateMappings = function(e) {
        var t = Object.create(e.mappings);
        t.x = "category", t.y = "value", t.series = "metric_series", t.seriesLabel = "metric_series_name", e.mappings = t
    };
    var i = n.baseObj;
    r._getYFormats = i._getYFormats, n.donut = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.lineObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e);
        n.isOvertime = this._determineOvertime(n.data), n.yAxisTitle = e.yAxisTitle || this._getYAxisTitle(n.data), n.dateGranularity = this._getTimeGranularity(n.data), this._updateMappings(n), this._processMultiMetric(n), this._processIncompleteData(n), Object.getPrototypeOf(r)._processOptions.call(this, n, t), n.formats = {x: e.formats.x,y: n.isOvertime ? this._getYFormats(n.data, n.mappings, this.uniqueStrokeValues()) : e.formats.y}
    }, r.data = function() {
        return this._processedOptions.data
    }, r.mappings = function() {
        return this._processedOptions.mappings
    }, r.formats = function() {
        return this._processedOptions.formats
    }, r.xAxisTitle = function() {
        return this._processedOptions.xAxisTitle
    }, r.yAxisTitle = function() {
        return this._processedOptions.yAxisTitle
    }, r.isOvertime = function() {
        return this._processedOptions.isOvertime
    }, r.dateGranularity = function() {
        return this._processedOptions.dateGranularity
    }, r._determineOvertime = function(e) {
        return +e.date[0] !== +e.date[e.date.length - 1]
    }, r._getYAxisTitle = function(e) {
        return this._getYTitleFromLabels(e.label)
    }, r._getTimeGranularity = function(e) {
        return this.isOvertime() ? e.metric[0].date_range.gran : "*"
    }, r._processMultiMetric = function(e) {
        if (e.isOvertime)
            return;
        var t = e.data, n = {series: []}, r = [], i = [], s, o, u;
        for (s = 0, o = t.label.length; s < o; ++s)
            u = t.label[s], n[u] || (r.push(u), t.metric && t.metric.length ? i.push(t.metric[s].type) : i.push(null), n[u] = []), n[u].push(t.value[s]), n.series[n[u].length - 1] = t.category[s];
        var a = {x: r[0],y: r[1]}, f = {x: i[0],y: {0: i[1]}};
        if (t.groups && t.groups.length && t.groups[0].length) {
            var l, c = t.groups.length, h, p = [];
            for (l = 0; l < c; ++l)
                h = t.groups[l], p[l] = h.join("-");
            n.facet_group = p, a.series = "facet_group"
        }
        r.length > 2 && (a.size = r[2], f.size = i[2], e.sizeMetricName = e.sizeTitle || r[2]), e.data = n, e.mappings = a, e.formats = f, e.xAxisTitle = e.xAxisTitle || r[0], e.yAxisTitle = e.yAxisTitle || r[1]
    }, r._updateMappings = function(e) {
        var t = Object.create(e.mappings);
        t.x = "date", t.y = "value", t.group = "series", t.series = "series", t.seriesLabel = "series_name", e.mappings = t
    }, r._processIncompleteData = function(e) {
        if (!e.isOvertime || !e.data.cell)
            return;
        if (e.position === "stack" || e.position === "fill")
            return;
        var t = e.data, n = e.mappings, r, i = t.cell.length, s = null, o = null, u, a = !1;
        t.cv_rs_group = t.cv_rs_group || [];
        for (r = 0; r < i; ++r) {
            o = s, s = t.cell[r], t.cv_rs_group[r] = t.cv_rs_group[r] || t.series[r];
            if (t.cv_rs_group[r].indexOf("::incomplete::") >= 0)
                continue;
            if (o && "incomplete" === s.status && "incomplete" !== o.status) {
                for (u in t)
                    t[u].splice(r, 0, t[u][r - 1]);
                t.cv_rs_group[r] += "::incomplete::", ++i, ++r
            }
            t.cv_rs_group[r] += "incomplete" === s.status ? "::incomplete::" : ""
        }
        n.group = "cv_rs_group"
    };
    var i = n.baseObj;
    r._getYFormats = i._getYFormats, n.line = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.pointObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e), i = e.data, s = {series: []}, o = [], u = [], a, f, l;
        for (a = 0, f = i.label.length; a < f; ++a)
            l = i.label[a], s[l] || (o.push(l), i.metric && i.metric.length ? u.push(i.metric[a].type) : u.push(null), s[l] = []), s[l].push(i.value[a]), s.series[s[l].length - 1] = i.category[a];
        var c = {x: o[0],y: o[1]}, h = {x: u[0],y: u[1]};
        if (i.groups && i.groups.length && i.groups[0].length) {
            var p, d = i.groups.length, v, m = [];
            for (p = 0; p < d; ++p)
                v = i.groups[p], m[p] = v.join("-");
            s.group = m, c.series = "group"
        } else
            c.series = "series";
        o.length > 2 && (c.size = o[2], h.size = u[2], n.sizeMetricName = e.sizeTitle || o[2]), n.data = s, n.mappings = c, n.formats = h, n.xAxisTitle = e.xAxisTitle || o[0], n.yAxisTitle = e.yAxisTitle || o[1], Object.getPrototypeOf(r)._processOptions.apply(this, arguments)
    }, r.data = function() {
        return this._processedOptions.data
    }, r.mappings = function() {
        return this._processedOptions.mappings
    }, r.formats = function() {
        return this._processedOptions.formats
    }, r.xAxisTitle = function() {
        return this._processedOptions.xAxisTitle
    }, r.yAxisTitle = function() {
        return this._processedOptions.yAxisTitle
    }, r.sizeMetricName = function() {
        return this._processedOptions.sizeMetricName
    }, n.point = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.pathingObj), i = 4;
    r._processOptions = function(e, t) {
        function l(e) {
            return "E" === e
        }
        function c(e) {
            return "X" === e
        }
        var n = Object.create(e), i = n.data, s = {}, o = s.nodes = [], u = s.paths = [], a = {}, f = this.l10n.labels.pathing, h, p, d, v, m, g, y, b, w, E, S, x = 0;
        for (p in i.filters) {
            h = i.filters[p], d = this._getFilterId(h);
            if (d) {
                v = h.info && h.info.name || "", m = this._getFilterChild(h), g = m && m.op || null, g && g !== "previous" && g !== "next" && (m = g = null), y = m && m.val ? [].concat(m.val) : [], E = 0;
                if ("previous" === g) {
                    if (y.some(l)) {
                        var T = "E_0";
                        a[T] || (b = {label: f.entry,id: T,column: E,index: o.length,filters: []}, o[o.length] = b, a[T] = b)
                    }
                    E = y.length
                }
                if ("next" === g) {
                    if (y.some(c)) {
                        var N = "X_0";
                        a[N] || (b = {label: f.exit,id: N,column: E,index: o.length,filters: []}, o[o.length] = b, a[N] = b)
                    }
                    E = 0 - y.length
                }
                w = d + "_" + E;
                if (a[w]) {
                    a[w].filters.push(h);
                    continue
                }
                S = "0" === String(d) && (f.exit === String(v) || f.entry === String(v));
                if (S)
                    continue;
                if ("0" === String(d))
                    continue;
                b = {label: v,id: w,column: E,index: o.length,filters: [h]}, o[o.length] = b, x = Math.min(x, E), a[w] = b
            }
        }
        if (0 !== x)
            for (var C in o)
                b = o[C], b.column -= x;
        var k, L, A, O, M, _, D, P, H, B, j, F, I;
        for (M = 0, _ = i.metrics.length; M < _; ++M) {
            k = i.metrics[M], L = k.filter_ref, A = k.date_ref;
            for (D = 0, P = L.length; D < P; ++D) {
                p = L[D], h = i.filters[p];
                for (H = 0, B = A.length; H < B; ++H) {
                    O = A[H], j = i.dates[O], F = i.data[p][O][M];
                    if ("invalid" === F.status)
                        continue;
                    if (b = this._getSingleNode(h, a)) {
                        b.total = +F.val;
                        continue
                    }
                    I = this._createPath(h, a);
                    if (!I || !I.length)
                        continue;
                    u[u.length] = {nodes: I,values: +F.val || 0}
                }
            }
        }
        u.sort(function(e, t) {
            return t.nodes.length - e.nodes.length
        });
        var q, R, U, z, W, X;
        for (q = 0, R = u.length; q < R; ++q) {
            W = u[q];
            for (U = 0, z = u.length; U < z; ++U) {
                if (q === U)
                    continue;
                X = u[U];
                if (X.nodes.length === W.nodes.length)
                    continue;
                -1 !== this._getPathString(W.nodes).indexOf(this._getPathString(X.nodes)) && (X.values -= W.values)
            }
        }
        s.paths = u = u.filter(function(e) {
            return e.values
        }), n.data = s;
        var V = e.data.metrics;
        n.pathingTitle = V && V.length && V[0].name, Object.getPrototypeOf(r)._processOptions.call(this, n, t)
    }, r.nodeKey = function() {
        return function(e, t) {
            return e.id
        }
    }, r.linkKey = function() {
        return function(e, t) {
            return (e.source ? e.source.id : "null") + "-" + (e.target ? e.target.id : "null")
        }
    }, r.pathingTitle = function() {
        return this._processedOptions.pathingTitle
    }, r.getPathEnd = function(e) {
        function o(e) {
            return e && (e.isPivot || e.id === "E_0" || e.id === "X_0")
        }
        if (!e || !e.nodes || !e.nodes.length)
            return null;
        if (e.nodes.length === 1)
            return e.nodes[0];
        var t = e.nodes, n = this._processedOptions.data, r = n.nodesById, i = r[t[0]], s = r[t[t.length - 1]];
        return o(i) ? i : o(s) ? s : null
    }, r.getPathDirection = function(e) {
        var t = this.getPathEnd(e);
        return t ? t._pid === e.nodes[0] ? 1 : -1 : 0
    }, r.activePathsTitle = function(e) {
        if (!e || !e.length)
            return "";
        var t = this.getPathEnd(e[0]), n = this.l10n.labels.pathing;
        if (!t)
            return n["path2+"];
        var r = this.getPathDirection(e[0]) === 1 ? n.pathFromNode : n.pathToNode;
        return r.replace(/\{path\}/i, e.length > 1 ? n["path2+"] : n.path).replace(/\{label\}/i, t.label)
    }, r._getSingleNode = function(e, t) {
        var n = this._getFilterId(e), r = e.filter_def && e.filter_def.length && e.filter_def[0] || null, i = r && r.op || null, s = this._getFilterChild(e), o = s && s.op || null;
        return "select" !== i && "equals" !== i && "id" !== i || "previous" === o || "next" === o ? !1 : t[n + "_0"]
    }, r._getPathString = function(e) {
        return e.map(function(e) {
            return null === e ? "null" : e
        }).toString()
    }, r._createPath = function(e, t) {
        var n = this._getFilterId(e), r = this._getFilterChild(e), i = r && r.op || null;
        if (i && i !== "previous" && i !== "next")
            return [];
        var s = r && r.val ? [].concat(r.val) : [];
        if (!s.length)
            return s;
        var o = "previous" === r.op, u = "0" === n, a = o ? 0 : u ? 0 - s.length + 1 : 0 - s.length, f = [];
        return o ? s.push(n) : s.unshift(n), this._mapNodeIds(a, s, t)
    }, r._mapNodeIds = function(e, t, n) {
        if (!isFinite(e) || !n)
            return [];
        e = +e;
        var r = !1, i = !1, s, o = t && t.map && t.map(function(t) {
            return "0" === t ? null : (s = t + "_" + e, n[s] ? (++e, r = !0, +n[s].index) : (i = !0, null))
        });
        return r && !i ? o : []
    }, r._getFilterId = function(e) {
        return e.info && (e.info.id || e.info.id === 0) ? e.info.id + "" : null
    }, r._getFilterChild = function(e) {
        var t = e.filter_def && e.filter_def.length && e.filter_def[0] || null;
        return t && t.child && t.child.length && t.child[0] || null
    }, r.canExpandNode = function(e) {
        var t = e.entryLinks.length + e.targetLinks.length, n = e.exitLinks.length + e.sourceLinks.length, r = Math.abs(parseInt(e.id.split("_")[1], 10));
        return r >= i ? !1 : n && e.id === "E_0" ? !1 : t && e.id === "X_0" ? !1 : !t || !n ? !0 : !1
    }, r.canCollapseNode = function(e) {
        var t = e.entryLinks.length + e.targetLinks.length, n = e.exitLinks.length + e.sourceLinks.length, r = parseInt(e.id.split("_")[1], 10);
        return e.id === "E_0" || e.id === "X_0" ? !1 : 0 === r && (n || t) || r > 0 && n || r < 0 && t
    }, r.canPivotNode = function(e) {
        var t = e.entryLinks.length + e.targetLinks.length, n = e.exitLinks.length + e.sourceLinks.length, r = Math.abs(parseInt(e.id.split("_")[1], 10));
        if (r !== 0)
            return !0;
        var i = this.data(), s = i.nodes.map(function(e) {
            return parseInt(e.id.split("_")[1], 10)
        }), o = 0;
        return s.some(function(e) {
            return e === 0 && o++, o > 1 ? !0 : !1
        }) ? !0 : !1
    }, n.pathingObj = r, n.pathing = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.sunburstObj);
    r._processOptions = function(e, t) {
        function s(e) {
            var t = e && e.op === "id" ? [e.val] : [];
            return e && e.child && e.child[0] ? s(e.child[0]).concat(t) : t
        }
        function o(e) {
            return e && e.child && e.child[0] ? o(e.child[0]) + 1 : 0
        }
        function u(e) {
            var t = e && e.filter_def && e.filter_def[0] || null;
            return o(t)
        }
        function a(e, t) {
            var n = u(e.filter), r = u(t.filter);
            return n === r ? t.cell[0].val - e.cell[0].val : n - r
        }
        var n = this._processedOptions, i = this._processedOptions = Object.create(e), f = e.data, l, c, h, p, d, v, m, g, y, b, w, E, S, x, T, N = {children: [],categories: [],metrics: f.metrics.map(function(e, t) {
                return {id: e.id,icon: e.icon,name: e.name || e.id,format: e.type,categories: []}
            })};
        if (l = f.metrics[0]) {
            b = [], c = l.filter_ref, h = l.date_ref;
            for (d = 0, v = c.length; d < v; ++d) {
                T = c[d], x = f.filters[T];
                for (m = 0, g = h.length; m < g; ++m) {
                    p = h[m], w = f.dates[p], E = f.data[T][p];
                    if (!E[0] || "invalid" === E[0].status)
                        continue;
                    if (x.info && x.info.id === 0)
                        continue;
                    b.push({filter: x,cell: E})
                }
            }
            b.sort(a);
            var C = {}, k, L, A, O, M;
            b.forEach(function(e) {
                x = e.filter, E = e.cell, A = x && x.filter_def && x.filter_def[0] || null, O = s(A), M = O.length, k = O.join("-");
                if (!k.length && !x.info) {
                    E.forEach(function(e, t) {
                        N.metrics[t].value = +e.val
                    });
                    return
                }
                e = {id: x.info.id,pid: k ? k + "-" + x.info.id : x.info.id,name: x.info.name,metrics: E.map(function(e) {
                        return {value: +e.val}
                    }),category: x.info.category || A && A["var"] || undefined,filtervar: A && A["var"] || undefined,children: []}, x.info.orig_name && (e.orig_name = x.info.orig_name), E.forEach(function(e, t) {
                    var n = N.metrics[t];
                    n.min = "undefined" != typeof n.min ? Math.min(n.min, +e.val) : +e.val, n.max = "undefined" != typeof n.max ? Math.max(n.max, +e.val) : +e.val;
                    var r;
                    (r = n.categories[M]) ? (r.min = Math.min(r.min, +e.val), r.max = Math.max(r.max, +e.val)) : n.categories[M] = {min: +e.val,max: +e.val}
                });
                if (k && (L = C[k]))
                    L.children.push(e);
                else {
                    if (!!O.length)
                        return;
                    N.children.push(e)
                }
                C[e.pid] = e, N.categories[M] = {name: x.info.category || A && A["var"] || N.categories[M]}
            })
        }
        i.data = N, Object.getPrototypeOf(r)._processOptions.call(this, i, t, n)
    }, r._validateData = function(e) {
        if (!e)
            return !1;
        for (var t in e)
            if (e[t].length)
                return !0;
        return !1
    }, r.getPathKey = function(e, t) {
        return !e || !e._sid ? 0 : e.pid ? e.pid : e._sid
    }, n.sunburst = t.util.createConstructor(r)
}(this), function(e) {
    var t = e.cloudViz, n = t.util.namespace("cloudViz.dataAdapter.rs"), r = Object.create(t.dataAdapter.standard.flowerObj);
    r._processOptions = function(e, t) {
        var n = this._processedOptions = Object.create(e);
        n.data = this._parseData(e.data), Object.getPrototypeOf(r)._processOptions.call(this, n, t)
    }, r._parseData = function(e) {
        if (!e.metric.length)
            return [];
        var t = [], n = e.metric[0].id;
        return dv.util.each(e.metric, function(r, i) {
            if (r.id != n)
                return;
            var s = e.filter[i].info.name, o = e.value[i];
            t.push({index: s.toLowerCase(),label: s,value: o})
        }), t
    }, r.formats = function() {
        return this._processedOptions.formats
    }, n.flower = t.util.createConstructor(r)
}(this), function(e) {
    e.cloudViz.localeDefinition("de-DE", {monthAbbreviations: ["Jan", "Feb", "März", "Apr", "Mai", "Juni", "Juli", "Aug", "Sep", "Okt", "Nov", "Dez"],months: ["Januar", "Februar", "März", "April", "Mai", "Juni", "Juli", "August", "September", "Oktober", "November", "Dezember"],weekdayAbbreviations: ["So", "Mo", "Di", "Mi", "Do", "Fr", "Sa"],weekdays: ["Sonntag", "Montag", "Dienstag", "Mittwoch", "Donnerstag", "Freitag", "Samstag"],ampm: ["AM", "PM"]}, "calendar"), e.cloudViz.localeDefinition("de-DE", {core: {nodata: "Das Diagramm enthält keine Daten.",erroronrender: "Hoppla! Ein Fehler ist aufgetreten und das Diagramm konnte nicht gerendert werden.",other: "Sonstige",normalized: "Normalisiert"},dvcore: {target: "Zielgruppe",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title} (in {time})",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "Größe"},pathing: {entry: "Einstieg",exit: "Ausstieg","entry2+": "Einstiege","exit2+": "Ausstiege",path: "Pfad","path2+": "Pfade",expand: "Erweitern",focus: "Fokus",collapse: "Reduzieren",title: "Pfaderstellungs-diagramm",nodeEntries: "Einstiege für {label}",nodeExits: "Ausstiege für {label}",nodeToNode: "{source} → {target}",percOfNode: "{perc} von {label}",pathToNode: "{path} zu {label}",pathFromNode: "{path} aus {label}",help1: "Dieses Diagramm stellt Pfade dar, die von einem Status in einen anderen übernommen wurden.",help2: "Jeder Knoten in Form eines Feldes repräsentiert einen Status im Pfad.",help3: "Durch Tippen oder Klicken auf einen Knoten werden zusätzliche Optionen zum Ändern des Diagramms angezeigt:",focusHelp: "Zeigt Pfade an, die am Knoten ein- oder ausgehen.",expandHelp: "Zeigt zusätzliche Pfade an, die am Knoten ein- oder ausgehen.",collapseHelp: "Entfernt Pfade, die am Knoten ein- oder ausgehen."},sunburst: {audience: "Zielgruppe","audience2+": "Zielgruppen",category: "Kategorie","category2+": "Kategorien",metric: "Metrik","metric2+": "Metriken",primarymetric: "Primäre Metrik",secondarymetric: "Sekundäre Metrik","secondarymetric2+": "Sekundäre Metriken",secondarymetrichelp: "Klicken Sie auf die Metrik, um die Höhe zu ändern.","secondarymetrichelp2+": "Klicken Sie auf die Metriken, um die Höhe zu ändern.",emptyFirstMetric: "Die erste Metrik enthält keine Werte. Wählen Sie eine andere Metrik.",total: "Gesamt",zoomAction: "Doppelklicken, um zu vergrößern.",moreAction: "Klicken Sie hier für weitere Optionen.",zoomin: "Nahansicht",zoomout: "Weitansicht",hide: "Ausblenden",hideall: "Alles ausblenden",hideother: "Sonstige ausblenden",hidden: "{value} verborgenes Element","hidden2+": "{value} verborgene Elemente",topresults: "Top {value}",color: "Farbe",height: "Höhe",both: "Beide",none: "Keine",mapmetric: "{metric} anzeigen als:",percmetric: "{percent} der {metric}",mobilescroll: "&#x25BC – scrollen Sie, um Details anzuzeigen."},flower: {joy: "Freude",admiration: "Bewunderung",fear: "Angst",surprise: "Überraschung",sadness: "Traurigkeit",disgust: "Empörung",anger: "Wut",anticipation: "Vorausschätzung"},venn: {definedAudience: "Definierte Zielgruppe"}}, "labels"), e.cloudViz.localeDefinition("de-DE", {shortFormat: {hour: "%H",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%H",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%H Uhr %a %e",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%H Uhr %a %e"},fullFormat: {hour: "%H Uhr %a %e",day: "%A %e",week: "%A %e",month: "%B %Y",quarter: "%B %Y",year: "%Y",fallback: "%e %b, %Y",condensed: "%d/%m/%Y"}}, "dateFormat"), e.cloudViz.localeDefinition("de-DE", {decimalSeparator: ",",groupSeparator: " ",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"},currency: {symbol: "€",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"}}, "numberFormat"), e.cloudViz.localeDefinition("de-DE", {singular: {second: "Sekunde",minute: "Minute",hour: "Stunde",day: "Tag",week: "Woche",month: "Monat",year: "Jahr"},plural: {second: "Sekunden",minute: "Minuten",hour: "Stunden",day: "Tagen",week: "Wochen",month: "Monate",year: "Jahre"},abbreviation: {second: "s",minute: "min",hour: "h",day: "d",week: "w",month: "mon",year: "y"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("en-US", {monthAbbreviations: ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"],months: ["January", "February", "March", "April", "May", "June", "July", "August", "September", "October", "November", "December"],weekdayAbbreviations: ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"],weekdays: ["Sunday", "Monday", "Tuesday", "Wednesday", "Thursday", "Friday", "Saturday"],ampm: ["AM", "PM"]}, "calendar"), e.cloudViz.localeDefinition("en-US", {core: {nodata: "The chart has no data",erroronrender: "Oops! There was an error and the chart could not be rendered.",other: "Other",normalized: "Normalized"},dvcore: {target: "Target",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title} (in {time})",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "Size"},pathing: {entry: "Entry",exit: "Exit","entry2+": "Entries","exit2+": "Exits",path: "Path","path2+": "Paths",expand: "Expand",focus: "Focus",collapse: "Collapse",title: "Pathing Chart",nodeEntries: "{label} Entries",nodeExits: "{label} Exits",nodeToNode: "{source} → {target}",percOfNode: "{perc} of {label}",pathToNode: "{path} to {label}",pathFromNode: "{path} from {label}",help1: "This chart represents paths taken from one state to another.",help2: "Each node, shaped as a box, represents a state in the path.",help3: "Tapping or clicking a node will provide additional options to modify the chart:",focusHelp: "Shows paths coming into and going out of node",expandHelp: "Shows additional paths coming or going from the node",collapseHelp: "Removes paths coming or going from the node"},sunburst: {audience: "Audience","audience2+": "Audiences",category: "Category","category2+": "Categories",metric: "Metric","metric2+": "Metrics",primarymetric: "Primary Metric",secondarymetric: "Secondary Metric","secondarymetric2+": "Secondary Metrics",secondarymetrichelp: "Click metric to toggle height","secondarymetrichelp2+": "Click metrics to toggle height",emptyFirstMetric: "The first metric has no values. Please pick a different metric.",total: "Total",zoomAction: "Double-click to Zoom in.",moreAction: "Click for more options.",zoomin: "Zoom In",zoomout: "Zoom Out",hide: "Hide",hideall: "Hide All",hideother: "Hide Other",hidden: "{value} Hidden Item","hidden2+": "{value} Hidden Items",topresults: "top {value}",color: "Color",height: "Height",both: "Both",none: "None",mapmetric: "Show {metric} as:",percmetric: "{percent} of {metric}",mobilescroll: "&#x25BC scroll for details"},flower: {joy: "Joy",admiration: "Admiration",fear: "Fear",surprise: "Surprise",sadness: "Sadness",disgust: "Disgust",anger: "Anger",anticipation: "Anticipation"},venn: {definedAudience: "Defined Audience"}}, "labels"), e.cloudViz.localeDefinition("en-US", {shortFormat: {hour: "%I %p",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%I %p",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%I %p %a %e",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%I %p %a %e"},fullFormat: {hour: "%I %p %a %e",day: "%A %e",week: "%A %e",month: "%B %Y",quarter: "%B %Y",year: "%Y",fallback: "%b %e, %Y",condensed: "%m/%d/%Y"}}, "dateFormat"), e.cloudViz.localeDefinition("en-US", {decimalSeparator: ".",groupSeparator: ",",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number}{symbol}",negativePattern: "-{number}{symbol}"},currency: {symbol: "$",positivePattern: "{symbol}{number}",negativePattern: "-{symbol}{number}"}}, "numberFormat"), e.cloudViz.localeDefinition("en-US", {singular: {second: "second",minute: "minute",hour: "hour",day: "day",week: "week",month: "month",year: "year"},plural: {second: "seconds",minute: "minutes",hour: "hours",day: "days",week: "weeks",month: "months",year: "years"},abbreviation: {second: "s",minute: "min",hour: "h",day: "d",week: "w",month: "mon",year: "y"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("es-ES", {monthAbbreviations: ["en.", "febr.", "mzo.", "abr.", "my.", "jun.", "jul.", "ag.", "sept.", "oct.", "nov.", "dic."],months: ["enero", "febrero", "marzo", "abril", "mayo", "junio", "julio", "agosto", "septiembre", "octubre", "noviembre", "diciembre"],weekdayAbbreviations: ["dom.", "lun.", "mart.", "miérc.", "juev.", "vier.", "sáb."],weekdays: ["domingo", "lunes", "martes", "miércoles", "jueves", "viernes", "sábado"],ampm: ["a. m.", "p. m."]}, "calendar"), e.cloudViz.localeDefinition("es-ES", {core: {nodata: "El gráfico no contiene datos",erroronrender: "Se ha producido un error y no se ha podido procesar el gráfico.",other: "Otro",normalized: "Normalizado"},dvcore: {target: "Destino",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title} (en {time})",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "Tamaño"},pathing: {entry: "Entrada",exit: "Salida","entry2+": "Entradas","exit2+": "Salidas",path: "Ruta","path2+": "Rutas",expand: "Expandir",focus: "Enfoque",collapse: "Contraer",title: "Gráfico de ruta",nodeEntries: "Entradas de {label}",nodeExits: "Salidas de {label}",nodeToNode: "{source} → {target}",percOfNode: "{perc} de {label}",pathToNode: "{path} a {label}",pathFromNode: "{path} de {label}",help1: "Este gráfico representa las rutas que se pueden tomar para ir de un estado a otro.",help2: "Los nodos, con forma de caja, representan un estado en la ruta.",help3: "Al hacer clic o tocar un nodo, se mostrarán opciones adicionales para modificar el gráfico:",focusHelp: "Muestra las rutas de ida al nodo o de vuelta",expandHelp: "Muestra rutas adicionales de ida al nodo o de vuelta",collapseHelp: "Suprime las rutas de ida al nodo o de vuelta"},sunburst: {audience: "Audiencia","audience2+": "Audiencias",category: "Categoría","category2+": "Categorías",metric: "Métrica","metric2+": "Métrica",primarymetric: "Métrica principal",secondarymetric: "Métrica secundaria","secondarymetric2+": "Métricas secundarias",secondarymetrichelp: "Haga clic en la métrica para alternar la altura","secondarymetrichelp2+": "Haga clic en las métricas para alternar la altura",emptyFirstMetric: "La primera métrica no contiene ningún valor. Elija otra métrica.",total: "Total",zoomAction: "Doble clic para aumentar.",moreAction: "Haga clic para ver más opciones.",zoomin: "Acercar",zoomout: "Alejar",hide: "Ocultar",hideall: "Ocultar todo",hideother: "Ocultar otro",hidden: "{value} elemento oculto","hidden2+": "{value} elementos ocultos",topresults: "{value} principales",color: "Color",height: "Altura",both: "Ambos",none: "Ninguno",mapmetric: "Mostrar {metric} como:",percmetric: "{percent} de {metric}",mobilescroll: "&#x25BC desplácese para más detalles"},flower: {joy: "Alegría",admiration: "Admiración",fear: "Miedo",surprise: "Sorpresa",sadness: "Tristeza",disgust: "Desagrado",anger: "Enfado",anticipation: "Expectación"},venn: {definedAudience: "Audiencia definida"}}, "labels"), e.cloudViz.localeDefinition("es-ES", {shortFormat: {hour: "%H",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%H",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%Hh %a %e",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%Hh %a %e"},fullFormat: {hour: "%Hh %I %p",day: "%A %e",week: "%A %e",month: "%B %Y",quarter: "%B %Y",year: "%Y",fallback: "%e %b, %Y",condensed: "%d/%m/%Y"}}, "dateFormat"), e.cloudViz.localeDefinition("es-ES", {decimalSeparator: ",",groupSeparator: " ",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"},currency: {symbol: "€",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"}}, "numberFormat"), e.cloudViz.localeDefinition("es-ES", {singular: {second: "segundo",minute: "minuto",hour: "hora",day: "día",week: "semana",month: "mes",year: "año"},plural: {second: "segundos",minute: "minutos",hour: "horas",day: "días",week: "semanas",month: "meses",year: "años"},abbreviation: {second: "s",minute: "min",hour: "h",day: "d",week: "w",month: "mon",year: "y"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("fr-FR", {monthAbbreviations: ["Janv.", "Févr.", "Mars", "Avr.", "Mai", "Juin", "Juill.", "Août", "Sept.", "Oct.", "Nov.", "Déc."],months: ["Janvier", "Février", "Mars", "Avril", "Mai", "Juin", "Juillet", "Août", "Septembre", "Octobre", "Novembre", "Décembre"],weekdayAbbreviations: ["Dim.", "Lun.", "Mar.", "Mer.", "Jeu.", "Ven.", "Sam."],weekdays: ["Dimanche", "Lundi", "Mardi", "Mercredi", "Jeudi", "Vendredi", "Samedi"],ampm: ["AM", "PM"]}, "calendar"), e.cloudViz.localeDefinition("fr-FR", {core: {nodata: "Le graphique ne contient aucune donnée",erroronrender: "Une erreur s’est produite, impossible de restituer le graphique.",other: "Autre",normalized: "Normalisé"},dvcore: {target: "Cible",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title} (en {time})",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "Taille"},pathing: {entry: "Entrée",exit: "Sortie","entry2+": "Entrées de","exit2+": "Sorties de",path: "Chemin d’accès","path2+": "Chemins d’accès",expand: "Développer",focus: "Mise au point",collapse: "Réduire",title: "Graphique du cheminement",nodeEntries: "Entrées {label}",nodeExits: "Sorties {label}",nodeToNode: "{source} → {target}",percOfNode: "{perc} de {label}",pathToNode: "{path} à {label}",pathFromNode: "{path} de {label}",help1: "Ce graphique représente les chemins d’accès récupérés d’un état à un autre.",help2: "Chaque nœud, en forme de cadre, représente un état dans le chemin d’accès.",help3: "Le fait d’appuyer ou de cliquer sur un nœud fournit d’autres options pour modifier le graphique :",focusHelp: "Présente les chemins d’accès issus du nœud ou y parvenant",expandHelp: "Présente des chemins d’accès supplémentaires issus du nœud ou y parvenant.",collapseHelp: "Supprime les chemins d’accès supplémentaires issus du nœud ou y parvenant."},sunburst: {audience: "Audience","audience2+": "Audiences",category: "Catégorie","category2+": "Catégories",metric: "Mesure","metric2+": "Mesures",primarymetric: "Mesure principale",secondarymetric: "Mesure secondaire","secondarymetric2+": "Mesures secondaires",secondarymetrichelp: "Cliquer sur une mesure pour activer/désactiver la hauteur","secondarymetrichelp2+": "Cliquer sur des mesures pour activer/désactiver la hauteur",emptyFirstMetric: "La première mesure n’a aucune valeur. Sélectionnez une autre mesure.",total: "Total",zoomAction: "Double-cliquez pour effectuer un zoom avant.",moreAction: "Cliquez pour plus d’options.",zoomin: "Zoom avant",zoomout: "Zoom arrière",hide: "Masquer",hideall: "Tout masquer",hideother: "Masquer autres",hidden: "{value} élément masqué","hidden2+": "{value} éléments masqués",topresults: "{value} premiers",color: "Couleur",height: "Hauteur",both: "Les deux",none: "Néant",mapmetric: "Afficher {metric} comme :",percmetric: "{percent} des {metric}",mobilescroll: "Défilement &#x25BC pour plus de détails"},flower: {joy: "Joie",admiration: "Admiration",fear: "Peur",surprise: "Surprise",sadness: "Tristesse",disgust: "Dégoût",anger: "Colère",anticipation: "Anticipation"},venn: {definedAudience: "Audience définie"}}, "labels"), e.cloudViz.localeDefinition("fr-FR", {shortFormat: {hour: "%H",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%H",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%H h %a %e",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%H h %a %e"},fullFormat: {hour: "%H h %a %e",day: "%A %e",week: "%A %e",month: "%B %Y",quarter: "%B %Y",year: "%Y",fallback: "%e %b %Y",condensed: "%d/%m/%Y"}}, "dateFormat"), e.cloudViz.localeDefinition("fr-FR", {decimalSeparator: ",",groupSeparator: " ",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"},currency: {symbol: "€",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"}}, "numberFormat"), e.cloudViz.localeDefinition("fr-FR", {singular: {second: "seconde",minute: "minute",hour: "heure",day: "jour",week: "semaine",month: "mois",year: "année"},plural: {second: "secondes",minute: "minutes",hour: "heures",day: "jours",week: "semaines",month: "mois",year: "années"},abbreviation: {second: "s",minute: "min",hour: "h",day: "d",week: "w",month: "mon",year: "y"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("ja-JP", {monthAbbreviations: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"],months: ["1月", "2月", "3月", "4月", "5月", "6月", "7月", "8月", "9月", "10月", "11月", "12月"],weekdayAbbreviations: ["日", "月", "火", "水", "木", "金", "土"],weekdays: ["日曜日", "月曜日", "火曜日", "水曜日", "木曜日", "金曜日", "土曜日"],ampm: ["午前", "午後"]}, "calendar"), e.cloudViz.localeDefinition("ja-JP", {core: {nodata: "データがありません",erroronrender: "エラーのためチャートを作成できません",other: "その他",normalized: "正規化済み"},dvcore: {target: "Target",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title} ({time})",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "Size"},pathing: {entry: "入口",exit: "出口","entry2+": "入口","exit2+": "出口",path: "パス内訳","path2+": "パス内訳",expand: "展開する",focus: "再スタート",collapse: "減らす",title: "遷移チャート",nodeEntries: "{label} 入口",nodeExits: "{label} 出口",nodeToNode: "{source} → {target}",percOfNode: "{label}の{perc}",pathToNode: "{label}への{path}",pathFromNode: "{label}からの{path}",help1: "流れ（パス）を現すチャートです。",help2: "四角形のノードがデータ項目です。",help3: "ノードをクリック（タップ）すると、以下のようなチャート設定用アイコンが表示されます：",focusHelp: "画面をクリアし、該当ノードの前後のパスのみを表示",expandHelp: "該当ノードの前後のパスをさらに表示",collapseHelp: "展開したパスを元に戻す"},sunburst: {audience: "オーディエンス","audience2+": "オーディエンス",category: "カテゴリ","category2+": "カテゴリ",metric: "指標","metric2+": "指標",primarymetric: "一次指標",secondarymetric: "二次指標","secondarymetric2+": "二次指標",secondarymetrichelp: "指標をクリックすると高さが変わる","secondarymetrichelp2+": "指標をクリックすると高さが変わる",emptyFirstMetric: "最も内側の円となる最初の指標のデータが存在しないため、チャートを描画できません。",total: "合計",zoomAction: "ダブルクリックでズームイン",moreAction: "クリックで選択肢を表示",zoomin: "ズームイン",zoomout: "ズームアウト",hide: "選択項目のみ除外",hideall: "全体から同じ項目を除外",hideother: "この項目以外を除外",hidden: "{value} 個の項目を除外中","hidden2+": "{value} 個の項目を除外中",topresults: "上位{value}件",color: "色",height: "高さ",both: "両方",none: "なし",mapmetric: "{metric}の表示方法:",percmetric: "{metric}の{percent}",mobilescroll: "&#x25BC スクロールして詳細を表示"},flower: {joy: "喜び",admiration: "賞賛",fear: "恐怖",surprise: "驚き",sadness: "悲しみ",disgust: "不快",anger: "怒り",anticipation: "予測"},venn: {definedAudience: "定義されたオーディエンス"}}, "labels"), e.cloudViz.localeDefinition("ja-JP", {shortFormat: {hour: "%p %I 時",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%p %I 時",day: "%e 日 (%a)",week: "%e 日 (%a)",month: "%b",quarter: "%b",year: "%Y",fallback: "%e 日 (%a)"},longFormat: {hour: "%e 日 (%a) %p %I 時",day: "%e 日 (%a)",week: "%e 日 (%a)",month: "%B",quarter: "%B",year: "%Y",fallback: "%e 日 (%a) %p %I 時"},fullFormat: {hour: "%e 日 (%a) %p %I 時",day: "%e 日 (%a)",week: "%e 日 (%a)",month: "%Y 年 %B",quarter: "%Y 年 %B",year: "%Y",fallback: "%Y 年 %b %e 日",condensed: "%Y/%m/%d"}}, "dateFormat"), e.cloudViz.localeDefinition("ja-JP", {decimalSeparator: ".",groupSeparator: ",",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number}{symbol}",negativePattern: "-{number}{symbol}"},currency: {symbol: "¥",positivePattern: "{symbol}{number}",negativePattern: "-{symbol}{number}"}}, "numberFormat"), e.cloudViz.localeDefinition("ja-JP", {singular: {second: "秒",minute: "分",hour: "時間",day: "日",week: "週間",month: "か月",year: "年"},plural: {second: "秒",minute: "分",hour: "時間",day: "日",week: "週間",month: "か月",year: "年"},abbreviation: {second: "秒",minute: "分",hour: "時間",day: "日",week: "週間",month: "か月",year: "年"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("ko-KR", {monthAbbreviations: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],months: ["1월", "2월", "3월", "4월", "5월", "6월", "7월", "8월", "9월", "10월", "11월", "12월"],weekdayAbbreviations: ["일", "월", "화", "수", "목", "금", "토"],weekdays: ["일요일", "월요일", "화요일", "수요일", "목요일", "금요일", "토요일"],ampm: ["오전", "오후"]}, "calendar"), e.cloudViz.localeDefinition("ko-KR", {core: {nodata: "차트에 데이터가 없습니다.",erroronrender: "오류가 발생하여 차트를 렌더링할 수 없습니다.",other: "기타",normalized: "정규화됨"},dvcore: {target: "목표",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title}({time})",legendTime: "{value}{time}"},point: {xScale: "X",yScale: "Y",sizeScale: "크기"},pathing: {entry: "시작",exit: "종료","entry2+": "시작","exit2+": "종료",path: "경로","path2+": "경로",expand: "확장",focus: "포커스",collapse: "축소",title: "경로 지정 차트",nodeEntries: "{label} 시작",nodeExits: "{label} 종료",nodeToNode: "{source} → {target}",percOfNode: "{label}의 {perc}",pathToNode: "{label} 나가는 {path}",pathFromNode: "{label} 들어오는 {path}",help1: "이 차트는 하나의 주에서 다른 주로 가져온 경로를 나타냅니다.",help2: "상자 모양의 노드는 각각 경로 내의 주를 나타냅니다.",help3: "노드를 누르거나 클릭하면 차트를 수정할 추가 옵션을 설정할 수 있습니다.",focusHelp: "노드에 들어오거나 나가는 경로 표시",expandHelp: "노드에 들어오거나 나가는 추가 경로 표시",collapseHelp: "노드에 들어오거나 나가는 경로 제거"},sunburst: {audience: "대상","audience2+": "대상",category: "카테고리","category2+": "카테고리",metric: "지표","metric2+": "지표",primarymetric: "기본 지표",secondarymetric: "보조 지표","secondarymetric2+": "보조 지표",secondarymetrichelp: "지표를 클릭하여 높이 전환","secondarymetrichelp2+": "지표를 클릭하여 높이 전환",emptyFirstMetric: "첫 번째 지표에 값이 없습니다. 다른 지표를 선택하십시오.",total: "합계",zoomAction: "확대하려면 두 번 클릭하십시오.",moreAction: "추가 옵션을 보려면 클릭하십시오.",zoomin: "확대",zoomout: "축소",hide: "숨김",hideall: "모두 숨기기",hideother: "나머지 숨기기",hidden: "{value}개의 숨긴 항목","hidden2+": "{value}개의 숨긴 항목",topresults: "상위 {value}개",color: "색상",height: "높이",both: "둘 다",none: "없음",mapmetric: "{metric} 다음으로 표시:",percmetric: "{metric} 수의 {percent} ",mobilescroll: "&#x25BC 자세한 내용을 보려면 스크롤하십시오."},flower: {joy: "기쁨",admiration: "감탄",fear: "두려움",surprise: "놀람",sadness: "슬픔",disgust: "혐오",anger: "분노",anticipation: "기대"},venn: {definedAudience: "정의된 대상"}}, "labels"), e.cloudViz.localeDefinition("ko-KR", {shortFormat: {hour: "%p %I",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%p %I",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%e일 %a %p %I",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%e일 %a %p %I"},fullFormat: {hour: "%e일 %a %p %I",day: "%A %e",week: "%A %e",month: "%Y 년 %B",quarter: "%Y %B",year: "%Y",fallback: "%Y %b %e일",condensed: "%Y/%m/%d"}}, "dateFormat"), e.cloudViz.localeDefinition("ko-KR", {decimalSeparator: ".",groupSeparator: ",",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number}{symbol}",negativePattern: "-{number}{symbol}"},currency: {symbol: "₩",positivePattern: "{symbol}{number}",negativePattern: "-{symbol}{number}"}}, "numberFormat"), e.cloudViz.localeDefinition("ko-KR", {singular: {second: "초",minute: "분",hour: "시간",day: "일",week: "주",month: "월",year: "년"},plural: {second: "초",minute: "분",hour: "시간",day: "일",week: "주",month: "월",year: "년"},abbreviation: {second: "초",minute: "분",hour: "시간",day: "일",week: "주",month: "월",year: "년"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("pt-BR", {monthAbbreviations: ["Jan", "Fev", "Mar", "Abr", "Mai", "Jun", "Jul", "Ago", "Set", "Out", "Nov", "Dez"],months: ["Janeiro", "Fevereiro", "Março", "Abril", "Maio", "Junho", "Julho", "Agosto", "Setembro", "Outubro", "Novembro", "Dezembro"],weekdayAbbreviations: ["Dom", "Seg", "Ter", "Qua", "Qui", "Sex", "Sáb"],weekdays: ["Domingo", "Segunda-feira", "Terça-feira", "Quarta-feira", "Quinta-feira", "Sexta-feira", "Sábado"],ampm: ["AM", "PM"]}, "calendar"), e.cloudViz.localeDefinition("pt-BR", {core: {nodata: "O gráfico não possui dados",erroronrender: "Ops! Houve um erro e o gráfico não pôde ser processado.",other: "Outro",normalized: "Normalizado"},dvcore: {target: "Meta",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title} (em {time})",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "Tamanho"},pathing: {entry: "Entrada",exit: "Sair","entry2+": "Entradas","exit2+": "Saídas",path: "Caminho","path2+": "Caminhos",expand: "Expandir",focus: "Foco",collapse: "Recolher",title: "Gráfico de criação de caminho",nodeEntries: "{label} Entradas",nodeExits: "{label} Saídas",nodeToNode: "{source} → {target}",percOfNode: "{perc} de {label}",pathToNode: "{path} para {label}",pathFromNode: "{path} de {label}",help1: "Esse gráfico representa os caminhos tomados de um estado para outro.",help2: "Cada nó, formado como uma caixa representa um estado no caminho.",help3: "Tocar ou clicar em um nó fornecerá opções adicionais para modificar o gráfico:",focusHelp: "Mostra os caminhos entrando ou saindo do nó",expandHelp: "Mostra caminhos adicionais entrando ou saindo do nó",collapseHelp: "Remove os caminhos saindo ou entrando no nó"},sunburst: {audience: "Público-alvo","audience2+": "Públicos-alvos",category: "Categoria","category2+": "Categorias",metric: "Métrica","metric2+": "Métricas",primarymetric: "Métrica principal",secondarymetric: "Métrica secundária","secondarymetric2+": "Métricas secundárias",secondarymetrichelp: "Clique na métrica para alternar a altura","secondarymetrichelp2+": "Clique nas métricas para alternar a altura",emptyFirstMetric: "A primeira métrica não tem valores. Esolha uma métrica diferente.",total: "Total",zoomAction: "Clique duas vezes para aumentar o zoom.",moreAction: "Clique para ver mais opções.",zoomin: "Ampliar",zoomout: "Reduzir",hide: "Ocultar",hideall: "Ocultar tudo",hideother: "Ocultar outro",hidden: "{value} Item oculto","hidden2+": "{value} itens ocultos",topresults: "principais {value}",color: "Cor",height: "Altura",both: "Ambos",none: "Nenhum",mapmetric: "Mostrar {metric} como:",percmetric: "{percent} de {metric}",mobilescroll: "&#x25BC role para ver os detalhes"},flower: {joy: "Alegria",admiration: "Admiração",fear: "Medo",surprise: "Problemas",sadness: "Tristeza",disgust: "Repulsa",anger: "Raiva",anticipation: "Antecipação"},venn: {definedAudience: "Público-alvo definido"}}, "labels"), e.cloudViz.localeDefinition("pt-BR", {shortFormat: {hour: "%H",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%H",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%Hh %a %e",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%Hh %a %e"},fullFormat: {hour: "%Hh %a %e",day: "%A %e",week: "%A %e",month: "%B %Y",quarter: "%B %Y",year: "%Y",fallback: "%e %b, %Y",condensed: "%Y/%m/%d"}}, "dateFormat"), e.cloudViz.localeDefinition("pt-BR", {decimalSeparator: ",",groupSeparator: " ",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"},currency: {symbol: "R$",positivePattern: "{number} {symbol}",negativePattern: "-{number} {symbol}"}}, "numberFormat"), e.cloudViz.localeDefinition("pt-BR", {singular: {second: "segundo",minute: "minuto",hour: "hora",day: "día",week: "semana",month: "mês",year: "ano"},plural: {second: "segundos",minute: "minutos",hour: "horas",day: "dias",week: "semanas",month: "meses",year: "anos"},abbreviation: {second: "s",minute: "min",hour: "h",day: "d",week: "w",month: "mon",year: "y"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("zh-CN", {monthAbbreviations: ["1 月", "2 月", "3 月", "4 月", "5 月", "6 月", "7 月", "8 月", "9 月", "10 月", "11 月", "12 月"],months: ["1 月", "2 月", "3 月", "4 月", "5 月", "6 月", "7 月", "8 月", "9 月", "10 月", "11 月", "12 月"],weekdayAbbreviations: ["周日", "周一", "周二", "周三", "周四", "周五", "周六"],weekdays: ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"],ampm: ["上午", "下午"]}, "calendar"), e.cloudViz.localeDefinition("zh-CN", {core: {nodata: "图表无数据",erroronrender: "抱歉！出现错误，无法呈现图表。",other: "其他",normalized: "已标准化"},dvcore: {target: "目标",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title}（{time}）",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "大小"},pathing: {entry: "登入",exit: "退出","entry2+": "登入","exit2+": "退出",path: "路径","path2+": "路径",expand: "展开",focus: "聚焦",collapse: "折叠",title: "路径图表",nodeEntries: "{label} 登入",nodeExits: "{label} 退出",nodeToNode: "{source} → {target}",percOfNode: "{perc} 的 {label}",pathToNode: "前往 {label} 的 {path}",pathFromNode: "来自 {label} 的 {path}",help1: "此图表代表从一种状态转变为另一种状态的路径。",help2: "每个长方形节点代表路径中的一种状态。",help3: "轻按或单击节点可以提供修改图表的其他选项：",focusHelp: "显示来往于节点的路径",expandHelp: "显示来往于节点的其他路径",collapseHelp: "删除来往于节点的路径"},sunburst: {audience: "受众","audience2+": "受众",category: "类别","category2+": "类别",metric: "量度","metric2+": "量度",primarymetric: "主要量度",secondarymetric: "次要量度","secondarymetric2+": "次要量度",secondarymetrichelp: "单击量度可切换高度","secondarymetrichelp2+": "单击量度可切换高度",emptyFirstMetric: "第一个量度没有值。请选择其他量度。",total: "合计",zoomAction: "双击可放大。",moreAction: "单击可获取更多选项。",zoomin: "放大",zoomout: "缩小",hide: "隐藏",hideall: "全部隐藏",hideother: "隐藏其他",hidden: "{value} 个隐藏的条目","hidden2+": "{value} 个隐藏的条目",topresults: "排名前 {value}",color: "彩色",height: "高度",both: "两者",none: "无",mapmetric: "{metric} 显示方式:",percmetric: "{percent} 的 {metric}",mobilescroll: "&#x25BC 展开详细信息"},flower: {joy: "欢快",admiration: "羡慕",fear: "害怕",surprise: "惊讶",sadness: "伤心",disgust: "厌恶",anger: "生气",anticipation: "期待"},venn: {definedAudience: "定义的受众"}}, "labels"), e.cloudViz.localeDefinition("zh-CN", {shortFormat: {hour: "%p %I",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%p %I",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%e 日 %a %p %I",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%e 日 %a %p %I"},fullFormat: {hour: "%e 日 %a %p %I",day: "%A %e",week: "%A %e",month: "%Y 年%B",quarter: "%Y %B",year: "%Y",fallback: "%Y %b %e 日",condensed: "%Y/%m/%d"}}, "dateFormat"), e.cloudViz.localeDefinition("zh-CN", {decimalSeparator: ".",groupSeparator: ",",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number}{symbol}",negativePattern: "-{number}{symbol}"},currency: {symbol: "¥",positivePattern: "{symbol}{number}",negativePattern: "-{symbol}{number}"}}, "numberFormat"), e.cloudViz.localeDefinition("zh-CN", {singular: {second: "秒",minute: "分钟",hour: "小时",day: "天",week: "周",month: "月",year: "年"},plural: {second: "秒",minute: "分钟",hour: "小时",day: "天",week: "周",month: "月",year: "年"},abbreviation: {second: "秒",minute: "分钟",hour: "小时",day: "天",week: "周",month: "月",year: "年"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("zh-TW", {monthAbbreviations: ["1 月", "2 月", "3 月", "4 月", "5 月", "6 月", "7 月", "8 月", "9 月", "10 月", "11 月", "12 月"],months: ["1 月", "2 月", "3 月", "4 月", "5 月", "6 月", "7 月", "8 月", "9 月", "10 月", "11 月", "12 月"],weekdayAbbreviations: ["週日", "週一", "週二", "週三", "週四", "週五", "週六"],weekdays: ["星期日", "星期一", "星期二", "星期三", "星期四", "星期五", "星期六"],ampm: ["上午", "下午"]}, "calendar"), e.cloudViz.localeDefinition("zh-TW", {core: {nodata: "此圖表沒有任何資料",erroronrender: "糟糕！發生錯誤，無法產生圖表。",other: "其他",normalized: "已標準化"},dvcore: {target: "目標",yAxisTimeNoTitle: "{time}",yAxisTimeWithTitle: "{title} (以{time}數計)",legendTime: "{value} {time}"},point: {xScale: "X",yScale: "Y",sizeScale: "大小"},pathing: {entry: "登入點",exit: "退出點","entry2+": "登入點","exit2+": "退出點",path: "路徑","path2+": "路徑",expand: "展開",focus: "焦點",collapse: "摺疊",title: "路徑圖表",nodeEntries: "{label} 登入點",nodeExits: "{label} 退出點",nodeToNode: "{source} → {target}",percOfNode: "{perc} 的 {label}",pathToNode: "連至 {label} 的 {path}",pathFromNode: "來自 {label} 的 {path}",help1: "此圖表代表從一狀態變為另一狀態的路徑。",help2: "每個設計成方塊的節點都代表路徑中的一種狀態。",help3: "點選或按一下節點即可取得用於修改圖表的其他選項:",focusHelp: "顯示進出節點的路徑",expandHelp: "顯示前往或遠離節點的其他路徑",collapseHelp: "移除前往或遠離節點的路徑"},sunburst: {audience: "讀者","audience2+": "讀者",category: "類別","category2+": "類別",metric: "量度","metric2+": "量度",primarymetric: "主要量度",secondarymetric: "次要量度","secondarymetric2+": "次要量度",secondarymetrichelp: "按一下量度以切換高度","secondarymetrichelp2+": "按一下量度以切換高度",emptyFirstMetric: "第一個量度沒有值。請選擇其他量度。",total: "總計",zoomAction: "連按兩下來放大顯示。",moreAction: "按一下存取更多選項。",zoomin: "放大",zoomout: "縮小",hide: "隱藏",hideall: "全部隱藏",hideother: "隱藏其他",hidden: "{value} 個隱藏項目","hidden2+": "{value} 個隱藏項目",topresults: "前 {value} 個項目",color: "色彩",height: "高度",both: "兩者",none: "無",mapmetric: "將 {metric} 顯示為:",percmetric: "{percent} 的 {metric}",mobilescroll: "&#x25BC 捲動以瞭解詳細資料"},flower: {joy: "歡樂",admiration: "欽佩",fear: "恐懼",surprise: "驚喜",sadness: "傷心",disgust: "噁心",anger: "憤怒",anticipation: "期望"},venn: {definedAudience: "特定讀者"}}, "labels"), e.cloudViz.localeDefinition("zh-TW", {shortFormat: {hour: "%p %I",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "%Y",fallback: "%e"},mediumFormat: {hour: "%p %I",day: "%a %e",week: "%a %e",month: "%b",quarter: "%b",year: "%Y",fallback: "%a %e"},longFormat: {hour: "%e 日 %a %p %I",day: "%A %e",week: "%A %e",month: "%B",quarter: "%B",year: "%Y",fallback: "%e 日 %a %p %I"},fullFormat: {hour: "%e 日 %a %p %I",day: "%A %e",week: "%A %e",month: "%Y 年 %B",quarter: "%Y %B",year: "%Y",fallback: "%Y %b %e 日",condensed: "%Y/%m/%d"}}, "dateFormat"), e.cloudViz.localeDefinition("zh-TW", {decimalSeparator: ".",groupSeparator: ",",negativePattern: "-{number}",percent: {symbol: "%",positivePattern: "{number}{symbol}",negativePattern: "-{number}{symbol}"},currency: {symbol: "NT$",positivePattern: "{symbol}{number}",negativePattern: "-{symbol}{number}"}}, "numberFormat"), e.cloudViz.localeDefinition("zh-TW", {singular: {second: "秒",minute: "分鐘",hour: "小時",day: "天",week: "週",month: "月",year: "年"},plural: {second: "秒",minute: "分鐘",hour: "小時",day: "天",week: "週",month: "月",year: "年"},abbreviation: {second: "秒",minute: "分鐘",hour: "小時",day: "天",week: "週",month: "月",year: "年"}}, "time")
}(this), function(e) {
    e.cloudViz.localeDefinition("zz-ZZ", {monthAbbreviations: ["[g] 승_Jan_文", "[q] 승_Feb_文", "[r] 승_Mar_文", "[n] 승_Apr_文", "[p] 승_May_文", "[k] 승_Jun_文", "[l] 승_Jul_文", "[i] 승_Aug_文", "[j] 승_Sep_文", "[h] 승_Oct_文", "[o] 승_Nov_文", "[m] 승_Dec_文"],months: ["[1] 승_January_文", "[2] 승_February_文", "[3] 승_March_文", "[x] 승_April_文", "[y] 승_May_文", "[z] 승_June_文", "[0] 승_July_文", "[s] 승_August_文", "[t] 승_September_文", "[u] 승_October_文", "[v] 승_November_文", "[w] 승_December_文"],weekdayAbbreviations: ["[+] 승_Sun_文", "[4] 승_Mon_文", "[5] 승_Tue_文", "[6] 승_Wed_文", "[7] 승_Thu_文", "[8] 승_Fri_文", "[9] 승_Sat_文"],weekdays: ["[BB] 승_Sunday_文", "[BA] 승_Monday_文", "[/] 승_Tuesday_文", "[BC] 승_Wednesday_文", "[BD] 승_Thursday_文", "[BE] 승_Friday_文", "[BF] 승_Saturday_文"],ampm: ["[e] 승_AM_文", "[f] 승_PM_文"]}, "calendar"), e.cloudViz.localeDefinition("zz-ZZ", {core: {nodata: "[BH] 승_The chart has no data_文",erroronrender: "[BG] 승_Oops! There was an error and the chart could not be rendered._文",other: "[BJ] 승_Other_文",normalized: "[BI] 승_Normalized_文"},dvcore: {target: "[BL] 승_Target_文",yAxisTimeNoTitle: "[BK] 승_{time}_文",yAxisTimeWithTitle: "[BN] 승_{title} (in {time})_文",legendTime: "[BM] 승_{value} {time}_文"},point: {xScale: "[Bp] 승_X_文",yScale: "[Br] 승_Y_文",sizeScale: "[Bq] 승_Size_文"},pathing: {entry: "[Be] 승_Entry_文",exit: "[Bg] 승_Exit_文","entry2+": "[Bn] 승_Entries_文","exit2+": "[Bb] 승_Exits_文",path: "[BZ] 승_Path_文","path2+": "[Bf] 승_Paths_文",expand: "[BX] 승_Expand_文",focus: "[BW] 승_Focus_文",collapse: "[Bj] 승_Collapse_文",title: "[Bc] 승_Pathing Chart_文",nodeEntries: "[Cz] 승_{label} Entries_文",nodeExits: "[C0] 승_{label} Exits_文",nodeToNode: "[Cy] 승_{source} → {target}_文",percOfNode: "[Ba] 승_{perc} of {label}_文",pathToNode: "[Bo] 승_{path} to {label}_文",pathFromNode: "[Bd] 승_{path} from {label}_文",help1: "[BY] 승_This chart represents paths taken from one state to another._文",help2: "[Bh] 승_Each node, shaped as a box, represents a state in the path._文",help3: "[Bk] 승_Tapping or clicking a node will provide additional options to modify the chart:_文",focusHelp: "[Bm] 승_Shows paths coming into and going out of node_文",expandHelp: "[Bi] 승_Shows additional paths coming or going from the node_文",collapseHelp: "[Bl] 승_Removes paths coming or going from the node_文"},sunburst: {audience: "[Ci] 승_Audience_文","audience2+": "[Ce] 승_Audiences_文",category: "[Ch] 승_Category_文","category2+": "[Cf] 승_Categories_文",metric: "[Cd] 승_Metric_文","metric2+": "[Cg] 승_Metrics_文",primarymetric: "[Cj] 승_Primary Metric_文",secondarymetric: "[Cl] 승_Secondary Metric_文","secondarymetric2+": "[Ck] 승_Secondary Metrics_文",secondarymetrichelp: "[Cm] 승_Click metric to toggle height_文","secondarymetrichelp2+": "[Cn] 승_Click metrics to toggle height_文",emptyFirstMetric: "[B2] 승_The first metric has no values. Please pick a different metric._文",total: "[B7] 승_Total_文",zoomAction: "[By] 승_Double-click to Zoom in._文",moreAction: "[B5] 승_Click for more options._文",zoomin: "[Bz] 승_Zoom In_文",zoomout: "[Bs] 승_Zoom Out_文",hide: "[Bt] 승_Hide_文",hideall: "[Bw] 승_Hide All_文",hideother: "[Bu] 승_Hide Other_文",hidden: "[B4] 승_{value} Hidden Item_文","hidden2+": "[B0] 승_{value} Hidden Items_文",topresults: "[B8] 승_top {value}_文",color: "[Bx] 승_Color_文",height: "[Bv] 승_Height_文",both: "[B6] 승_Both_文",none: "[B3] 승_None_文",mapmetric: "[B9] 승_Show {metric} as:_文",percmetric: "[B1] 승_{percent} of {metric}_文",mobilescroll: "[Co] 승_&#x25BC scroll for details_文"},flower: {joy: "[BU] 승_Joy_文",admiration: "[BT] 승_Admiration_文",fear: "[BQ] 승_Fear_文",surprise: "[BR] 승_Surprise_文",sadness: "[BO] 승_Sadness_文",disgust: "[BP] 승_Disgust_文",anger: "[BV] 승_Anger_文",anticipation: "[BS] 승_Anticipation_文"},venn: {definedAudience: "[B+] 승_Defined Audience_文"}}, "labels"), e.cloudViz.localeDefinition("zz-ZZ", {shortFormat: {hour: "[Z] 승_%I %p_文",day: "%e",week: "%e",month: "%b",quarter: "%b",year: "[d] 승_%Y_文",fallback: "%e"},mediumFormat: {hour: "[S] 승_%I %p_文",day: "[Q] 승_%a %e_文",week: "[T] 승_%a %e_文",month: "%b",quarter: "%b",year: "[U] 승_%Y_文",fallback: "[V] 승_%a %e_文"},longFormat: {hour: "[P] 승_%I %p %a %e_文",day: "[M] 승_%A %e_文",week: "[O] 승_%A %e_文",month: "[L] 승_%B_文",quarter: "[K] 승_%B_文",year: "[J] 승_%Y_文",fallback: "[N] 승_%I %p %a %e_文"},fullFormat: {hour: "[D] 승_%I %p %a %e_文",day: "[C] 승_%A %e_文",week: "[B] 승_%A %e_文",month: "[G] 승_%B %Y_文",quarter: "[E] 승_%B %Y_文",year: "[I] 승_%Y_文",fallback: "[F] 승_%b %e, %Y_文",condensed: "[H] 승_%m/%d/%Y_文"}}, "dateFormat"), e.cloudViz.localeDefinition("zz-ZZ", {decimalSeparator: "[CC] 승_._文",groupSeparator: "[CD] 승_,_文",negativePattern: "[CE] 승_-{number}_文",percent: {symbol: "[CF] 승_%_文",positivePattern: "[CG] 승_{number}{symbol}_文",negativePattern: "[CH] 승_-{number}{symbol}_文"},currency: {symbol: "[B/] 승_$_文",positivePattern: "[CA] 승_{symbol}{number}_文",negativePattern: "[CB] 승_-{symbol}{number}_文"}}, "numberFormat"), e.cloudViz.localeDefinition("zz-ZZ", {singular: {second: "[CX] 승_second_文",minute: "[CY] 승_minute_文",hour: "[CZ] 승_hour_文",day: "[CV] 승_day_文",week: "[Ca] 승_week_文",month: "[Cb] 승_month_文",year: "[CW] 승_year_文"},plural: {second: "[CS] 승_seconds_文",minute: "[CP] 승_minutes_文",hour: "[Cc] 승_hours_文",day: "[CR] 승_days_文",week: "[CQ] 승_weeks_文",month: "[CT] 승_months_文",year: "[CU] 승_years_文"},abbreviation: {second: "[CJ] 승_s_文",minute: "[CO] 승_min_文",hour: "[CK] 승_h_文",day: "[CI] 승_d_文",week: "[CL] 승_w_文",month: "[CM] 승_mon_文",year: "[CN] 승_y_文"}}, "time")
}(this), define("adobe_am/trait_builder/views/viewPageGraph", ["backbone", "backbone.marionette", "demdex_utils", "globals", "d3", "dv", "cloudViz", "adobe"], function(e, t, n, r, i, s, o, u) {
    return e.Marionette.ItemView.extend({tagName: "div",className: "graph",$appendToElement: null,initialize: function(e) {
            _.bindAll(this, ["displayGraph"]);
            var t = '<h3>Trait Graph</h3><div class="graph_container"><div id="cloudVizChart"></div></div>';
            this.$el.append(t), $(e.container).append(this.$el)
        },onShow: function() {
            var e = moment().utc().hours(0).minutes(0).minutes(0).seconds(0).milliseconds(0), t = e.valueOf(), n = u.AM.API.TRAITS.trend.sid.url(this.model.get("sid"), e.subtract("days", 90).valueOf(), t, "1D");
            $.getJSON(n).always(this.displayGraph)
        },displayGraph: function(e) {
            if (e.metrics !== Object(e.metrics) || Object.keys(e.metrics).length === 0) {
                $("#cloudVizChart").addClass("no_results").html(DEMDEX.UTILS.noDataMsg);
                return
            }
            var t = [{Uniques: "uniques"}], n = e.metrics, r = u.AM.UTILS.HELPERS.parseDataFormatForCloudViz(e.metrics, t), s = u.AM.UTILS.HELPERS.transformDataToCloudViz(r), a = o.line({parent: i.select("#cloudVizChart").node(),data: s,filled: !1,autoResize: !0,interactive: !0});
            a.on("mouseover", function() {
                this.label(function(e) {
                    return u.AM.UTILS.HELPERS.formatTimestampToUTC(e, "MM/DD/YYYY")
                })
            }), setTimeout(function() {
                a.render()
            }, 0)
        },render: function() {
            return !0
        }})
}), define("adobe_am/trait_builder/views/viewPageSegmentWithTraitRow", ["backbone", "backbone.marionette", "globals", "text!adobe_am/trait_builder/templates.html"], function(e, t, n, r) {
    return e.Marionette.ItemView.extend({tagName: "tr",templateHelpers: {displayLink: function(e) {
                return n.segment_view_page + "#view/" + e
            }},template: getTemplate("view_page_segments_with_trait_row", r)})
}), define("adobe_am/trait_builder/views/viewPageSegments", ["backbone", "backbone.marionette", "modules/Segment/Models/Segment", "text!adobe_am/trait_builder/templates.html", "adobe_am/trait_builder/views/viewPageSegmentWithTraitRow"], function(e, t, n, r, i) {
    return e.Marionette.CompositeView.extend({className: "content",noData: !1,initialize: function() {
            this.noData = !this.collection.length
        },template: getTemplate("view_page_segments_with_trait_table", r),itemView: i,appendHtml: function(e, t) {
            e.$(".segments_with_trait_body").append(t.el)
        },onShow: function() {
            this.noData && this.showEmptyTableRow()
        },showEmptyTableRow: function() {
            var e = getTemplate("view_page_segments_with_trait_row_empty", r);
            this.$el.find("tbody").append(e())
        }})
}), define("adobe_am/trait_builder/views/traitRuleWidget", ["backbone", "backbone.marionette", "text!adobe_am/trait_builder/templates.html", "adobe", "adobe_am/vent"], function(e, t, n, r, i) {
    function f() {
        var e, t = "<tr class='ruleOp off'><td class='first'></td><td colspan='3'><select class='ruleOpSelect'><option></option><option value='AND'>AND</option><option>AND NOT</option><option>OR</option></select></td><td class='last'></td></tr>";
        s.$rule_widget.find("tbody tr:not('.ruleBorder')").each(function() {
            $(this).hasClass("signalRule") ? (e == "rule" && $(this).before(t), e = "rule") : (e == "op-on" || $(this).next("tr").hasClass("ruleBorder") || $(this).prev("tr").hasClass("ruleBorder") ? $(this).remove() : e == "op-off" && $(this).prev("tr").remove(), $(this).hasClass("on") ? e = "op-on" : e = "op-off")
        })
    }
    function l(e, t) {
        t = p(t);
        if (typeof t.errorMsg != "undefined") {
            var n = {errorMsg: " ",msg: t.errorMsg};
            ADOBE.AM.alertBox(n)
        } else
            $("#" + e + " .key").html(t.key), $("#" + e + " .op").html(" " + t.operator + " "), $("#" + e + " .val").html(t.value), $("#" + e + " .last").html("<ul class='ruleActions'><li class='editRuleBtn' data-id='" + e + "' title='Edit'></li>" + "<li class='deleteRuleBtn' title='Delete'></li>" + "</ul>"), $("#rulesTable #" + e).data("rule", t), c()
    }
    function c() {
        $("#traitRule").val("");
        var e = "", t = "op";
        $("#rulesTable tbody tr:not('.ruleBorder')").each(function() {
            $(this).hasClass("signalRule") ? (t == "rule" && (e += " OR "), e += $(this).children("td:not('.last, .first')").map(function() {
                return $(this).text()
            }).get().join(" "), t = "rule") : $(this).hasClass("on") && (e += ") " + $(this).find("select").val() + " (", t = "op")
        }), e != "" && (e = "(" + e + ")"), $("#traitRule").val(e)
    }
    function h() {
        $("#exprTable tbody").html(""), s.$rule_widget.find("tbody tr").each(function() {
            $(this).hasClass("ruleNotice") && $(this).find("td").html(s.model.get("traitRule"));
            if ($(this).hasClass("on")) {
                var e = $(this).find("select").val();
                $("#exprTable tbody").append("<tr class='ruleOp'><td class='first'></td><td colspan='3'><div>" + e + "</div></td><td class='last'></td></tr>")
            } else
                $(this).hasClass("off") || $(this).clone().appendTo("#exprTable tbody")
        })
    }
    function p(e) {
        var t = "";
        e.key.match(/^[A-z]|\"/) || (t += "<li>" + u.MESSAGES.getMessage("trait_error_1").message + "</li>"), e.key.match(/\W-/g) && (t += "<li>" + u.MESSAGES.getMessage("trait_error_2").message + "</li>"), e.key.match(/\s/) && !e.key.match(/^\".*?\"$/) && (t += "<li>" + u.MESSAGES.getMessage("trait_error_7").message + "</li>");
        var n = e.value;
        n.match(/^".*"$/) && (n = n.substr(1, n.length - 2));
        if (e.operator.search(/[>|<]|(&gt;)|(&lt;)/) < 0) {
            if (n.match(/[^"]"{1,2}[^"]/g) || n.match(/^"{1,2}[^"]/g) || n.match(/[^"]"{1,2}$/g))
                t += "<li>" + u.MESSAGES.getMessage("trait_error_3").message + "</li>";
            e.value = '"' + n + '"'
        } else {
            if (n.match(/[^-.0-9]/) || n.match(/.+[-]/) || n.match(/\..*\./))
                t += "<li>" + u.MESSAGES.getMessage("trait_error_4").message + "</li>";
            e.value = n
        }
        return e.operator == "" && (t += "<li>" + u.MESSAGES.getMessage("trait_error_5").message + "</li>"), n == "" && (t += "<li>" + u.MESSAGES.getMessage("trait_error_6").message + "</li>"), t.length > 0 && (e.errorMsg = "<ul>" + t + "</ul>"), e
    }
    function d(e) {
        e = p(e);
        if (typeof e.errorMsg == "undefined") {
            var n = "rule" + o, r = "<tr id='" + n + "' class='signalRule' >" + "<td class='first'></td>" + "<td class='key'> " + e.key + "</td>" + "<td class='op'> " + e.operator + "</td>" + "<td class='val'> " + e.value + "</td>" + "<td class='last'> " + "<ul class='ruleActions'>" + "<li class='editRuleBtn' data-id='" + n + "' title='Edit'></li>" + "<li class='deleteRuleBtn' title='Delete'></li>" + "</ul>" + "</td>" + "</tr>";
            return $(r).insertBefore(s.$rule_widget.find(".groupBtm")), s.$rule_widget.find("#" + n).data("rule", e), s.$rule_widget.find(".ruleBorder").show(), s.$rule_widget.find(".clearRuleBtn").click(), f(), o++, n
        }
        var t = {errorMsg: " ",msg: e.errorMsg};
        ADOBE.AM.alertBox(t)
    }
    function v(e) {
        return {key: e.name,operator: e.expressionName,value: e.value}
    }
    function m(e, t) {
        var r = "", i = u.UTILS.G6.SEGMENTS, a = [], f = [], l = "", c = "";
        if (s.model && s.model.get("codeViewOnly")) {
            g();
            return
        }
        i.tree_helper.init(), i.inOrderTreeTraversal(e, i.tree_helper.storeNode);
        if (!i.tree_helper.nodes.length)
            return;
        var h = !1;
        i.tree_helper.nodes.forEach(function(e, t) {
            if (h && e.type === "op") {
                a[a.length - 1].value += " " + e.value, h = !1;
                return
            }
            h = !1, e.type === "op" && (h = !0), a.push(e)
        }), r += getTemplate("rule_builder_top", n)(), l = getTemplate("rule_builder_rule", n), c = getTemplate("rule_builder_op", n), a.forEach(function(e, t) {
            var n = null;
            switch (e.type) {
                case "rule":
                    e.name.match(/\s/) && (e.name = '"' + e.name + '"'), n = p(v(e)), f.push(n);
                    if (typeof n.errorMsg != "undefined") {
                        var i = {errorMsg: " ",msg: n.errorMsg};
                        ADOBE.AM.alertBox(i)
                    } else
                        r += l(_.extend(n, {cnt: o++}));
                    break;
                case "op":
                    r += c(_.extend(e, {on_off: e.on ? "on off" : "off",isSelected: function(t) {
                            if (t === e.value)
                                return 'selected="selected"'
                        }}));
                    break;
                case "default":
            }
        }), r += getTemplate("rule_builder_bottom", n)(), s.$rule_widget.find("tbody").html(r), s.$rule_widget.find(".signalRule").each(function(e, t) {
            $(t).data("rule", f[e])
        })
    }
    function g() {
        var e = "<tr class='signalRule ruleNotice'><td colspan='5'>This trait expression is too complex to show in the builder view.  Please use the code view to edit this expression.</td></tr>";
        s.$rule_widget.find("tbody .signalRule").remove(), s.$rule_widget.find("tbody .ruleOp").remove(), s.$rule_widget.find(".ruleBorder").hide(), $(e).insertBefore(s.$rule_widget.find(".groupBtm"))
    }
    var s = null, o = 0, u = ADOBE.AM, a = e.Marionette.ItemView.extend({mode: null,$attachToElement: null,$rule_widget: null,initialize: function(e) {
            s = this, _.bindAll(this, ["show"]);
            if (e && !e.mode || _.indexOf(_.values(this.constructor.MODES), e.mode) == -1)
                throw new Error("mode is required");
            this.expressionTree = e.expressionTree, this.mode = e.mode, this.$attachToElement = $(e.attachToElement)
        },template: getTemplate("view_page_rule_widget", n),getMode: function() {
            return this.mode
        },isViewMode: function() {
            return this.mode === this.constructor.MODES.VIEW
        },isEditMode: function() {
            return this.mode === this.constructor.MODES.EDIT
        },onShow: function() {
            this.show()
        },show: function() {
            var e = this;
            if (this.isViewMode()) {
                this.$el.find("tbody .signalRule").remove(), this.$el.find("tbody .ruleOp").remove();
                var t = this.model.get("expressionTree");
                if (typeof t != "undefined")
                    m(this.model.get("expressionTree"), 0), h();
                else {
                    var i = getTemplate("view_page_rule_widget_no_rule", n);
                    $("#exprTable tbody").append(i({no_rules: r.AM.MESSAGES.getMessage("no_trait_rule").message}))
                }
            } else
                this.$attachToElement.append(this.$el), _.isEmpty(this.expressionTree) || m(this.expressionTree, 0), this.$attachToElement.find(".addRuleBtn").click(function() {
                    var e = {};
                    return e.operator = $("#operator").val(), e.value = $("#val").val(), e.key = $("#key").val(), d(e), c(), !1
                }), $(".clearRuleBtn").click(function() {
                    e.$attachToElement.find(".addRule input, .addRule select").val("")
                }), $("#rulesTable tbody").sortable({items: "tr:not('.ruleBorder')",helper: function(e, t) {
                        return t.children().each(function() {
                            $(this).width($(this).width())
                        }), t
                    },update: function() {
                        f(), c()
                    }}).delegate("tr.ruleOp", {click: function(e) {
                        var t = e.target;
                        return t.nodeName == "SELECT" && ($(this).addClass("on clicked"), $(t).val() == "" && $(this).addClass("off")), c(), !0
                    },mouseover: function() {
                        $(this).addClass("on"), c()
                    },mouseleave: function() {
                        if ($(this).hasClass("clicked")) {
                            $(this).removeClass("clicked");
                            return
                        }
                        $(this).find("select").val() == "" && $(this).removeClass("on").addClass("off"), c()
                    }}).delegate(".deleteRuleBtn", "click", function() {
                    $(this).parents("#rulesTable tr").remove(), f(), c(), $("#rulesTable tbody tr:not('.ruleBorder')").size() == 0 && $(".ruleBorder").hide()
                }).delegate(".editRuleBtn", "click", function() {
                    var e = $(this).closest("tr.signalRule"), t = $("#rulesTable tr.signalRule").not(e);
                    t.find("#cancelRuleBtn:visible").click();
                    var n = "#rulesTable #" + $(this).attr("data-id"), r = $(n).data("rule");
                    $(n).children().html(""), $(n + " .key").append($("#key").clone().val(r.key).attr("id", "inlineKey")), $(n + " .op").append($("#operator").clone().attr("id", "inlineOp").val(r.operator)), $(n + " .val").append($("#val").clone().val(r.value).attr("id", "inlineVal")), $(n + " .last").append("<button id='applyRuleBtn' class='primary'>Apply</button> <button id='cancelRuleBtn'>Cancel</button>")
                }).delegate("#applyRuleBtn", "click", function() {
                    var e = $(this).parents("#rulesTable tr").attr("id"), t = {};
                    t.key = $("#inlineKey").val(), t.operator = $("#inlineOp").val(), t.value = $("#inlineVal").val(), l(e, t)
                }).delegate("#cancelRuleBtn", "click", function() {
                    var e = $(this).parents("#rulesTable tr"), t = e.attr("id"), n = e.data("rule");
                    l(t, n)
                });
            $("#key, #val").keypress(function(e) {
                r.AM.UTILS.pressedEnter(e) && $(".addRuleBtn").click()
            })
        },render: function() {
            var e = this, t = getTemplate("view_page_rule_builder", n);
            return this.$el.html(this.template()), this.isViewMode() && this.$attachToElement.find(".view_trait_expression").append(t()), this.isEditMode(), this.$rule_widget = this.$el, !0
        }}, {MODES: {VIEW: "view",EDIT: "edit"}});
    return function(e) {
        return i.on("traitWidget:reset", function() {
            c()
        }), new a(e)
    }
}), define("adobe_am/trait_builder/views/viewPageLowerLeftHandPanel", ["backbone", "backbone.marionette", "text!adobe_am/trait_builder/templates.html", "adobe", "adobe_am/trait_builder/views/traitRuleWidget"], function(e, t, n, r, i) {
    return e.Marionette.ItemView.extend({_panel_type: null,tagName: "div",$rule_widget: null,initialize: function(e) {
            var t = this;
            e && e.model && e.model.isAlgoTrait() ? (this.template = getTemplate("view_page_algo_configuration", n), this._panel_type = this.constructor.PANEL_TYPES.ALGO) : e && e.model && (e.model.isDPMTrait() || this.model.isRuleBasedTrait()) && (this.template = getTemplate("view_page_trait_expression", n), this._panel_type = this.constructor.PANEL_TYPES.RULE_ONBOARD), e && e.model && (this.$rule_widget = new i({model: e.model,mode: "view",attachToElement: this.el}))
        },isAlgoPanel: function() {
            return this._panel_type === this.constructor.PANEL_TYPES.ALGO
        },isRuleOnboardPanel: function() {
            return this._panel_type === this.constructor.PANEL_TYPES.RULE_ONBOARD
        },templateHelpers: {formatNumber: function(e) {
                return this.goal == "REACH" ? r.AM.UTILS.HELPERS.formatNumber(e) : e
            }},renderAlgoPanel: function() {
            var e = "", t = null;
            t = this.model.getAlgoModel(), e = t.get("name") || "";
            var n = {name: e,goal: this.model.get("thresholdType") || "",value: this.model.get("accuracy")};
            this.$el.html(this.template(_.extend(n, this.templateHelpers))).unwrap()
        },onShow: function() {
            this.isRuleOnboardPanel() && this.$rule_widget.show()
        },render: function() {
            return this.isAlgoPanel() ? this.renderAlgoPanel() : this.isRuleOnboardPanel() && (this.$el.append(this.template()), this.$rule_widget.render()), !0
        }}, {PANEL_TYPES: {ALGO: "algo",RULE_ONBOARD: "rule_onboard"}})
}), define("adobe_am/trait_builder/view", ["backbone", "backbone.marionette", "adobe_am/trait_builder/views/viewPageLayout", "adobe_am/trait_builder/routers/viewPageRouter", "adobe_am/trait_builder/controllers/viewPageController", "modules/Trait/Models/Trait", "modules/Trait/Models/AlgoTrait", "modules/Segment/Collections/Segments", "adobe", "adobe_am/vent", "adobe_am/trait_builder/views/viewPageToolbar", "adobe_am/trait_builder/views/viewPageBasicInfo", "adobe_am/trait_builder/views/viewPageGraph", "adobe_am/trait_builder/views/viewPageSegments", "adobe_am/trait_builder/views/viewPageLowerLeftHandPanel"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d) {
    var v = {}, m = a.AM, g = m.UTILS, y = null, b = null, w = null, E = null, S = function(e) {
        w.isAlgoTrait() && (w = new o(e)), b = new n({model: w}), y.main.show(b)
    }, x = function() {
        f.trigger("modal:show", {type: "error",message: m.MESSAGES.getMessage("general_trait_problem").message,buttons: [{text: "OK",className: "primary",onClick: function() {
                        f.trigger("show:listpage"), f.trigger("modal:hide")
                    }}]})
    }, T = function(e) {
        var t = "";
        try {
            t = m.MESSAGES.getAPIErrorMessage(e, {codePrefix: "traits_"})
        } catch (n) {
            t = m.MESSAGES.getMessage("generic_error").message
        }
        f.trigger("modal:show", {type: "error",message: t})
    }, N = function() {
        f.trigger("trait:deleted")
    }, C = function() {
        f.trigger("modal:show", {type: "loading",header: m.MESSAGES.getMessage("message").message,message: m.MESSAGES.getMessage("loading").message}), w.destroy().done(N).fail(T)
    }, k = function(t) {
        f.trigger("modal:show", {type: "loading"}), a.AM.UTILS.HELPERS.switchPage("view"), f.trigger("title:change", {title: "View Trait"}), w = new s({sid: t,query_string_params: {includeExprTree: !0}});
        var n = w.fetch();
        n.fail(x).done(S);
        var r = n.pipe(function() {
            var e = $.Deferred(), n = $.Deferred(), r = $.Deferred(), i = $.Deferred(), s = [r, n];
            w.get("categoryId") && (s.push(e), w.loadCategory().always(e.resolve)), w.loadFolder().always(n.resolve), w.loadDataSource().always(r.resolve), y.user.checked_perms.can_view_segments && (E = new u, s.push(i), E.fetch({data: {containsTrait: t}}).always(i.resolve));
            if (w.isAlgoTrait()) {
                var o = $.Deferred();
                w.loadAlgoModel().always(o.resolve), s.push(o)
            }
            return $.when.apply(null, s)
        });
        $.when(r).then(function() {
            b.toolbar.show(new l({model: w,user: y.user,permission_checker: y.GateKeeper})), b.basic_info.show(new c({model: w})), b.graph.show(new h({container: b.graph.el,model: w}));
            var t = null;
            y.user.checked_perms.can_view_segments ? t = new p({collection: E}) : t = new (e.Marionette.CompositeView.extend({template: _.template("<div></div>"),className: "content",render: function() {
                    this.$el.html(m.MESSAGES.getMessage("segments_permission_missing_view").message)
                }})), b.segments.show(t), b.lower_left_panel.show(new d({model: w})), f.trigger("modal:hide"), a.AM.UTILS.HELPERS.bindContextHelp()
        })
    };
    return v.begin = function(e) {
        y = e, y.user.checked_perms.can_view_segments = y.GateKeeper.checkPermissions([y.user.permissions], "can_view_segments"), new r({controller: i})
    }, f.on("show:new", function(t) {
        e.history.navigate("#new/" + t, !0)
    }), f.on("show:edit", function() {
        e.history.navigate("#edit/" + w.get("sid"), !0)
    }), f.on("show:clone", function() {
        e.history.navigate("#clone/" + w.get("sid"), !0)
    }), f.on("show:viewpage", function(e) {
        if (!g.HELPERS.isNumeric(e))
            return f.trigger("modal:show", {type: "error",message: m.MESSAGES.getMessage("generic_error").message}), f.trigger("show:listpage"), !1;
        k(e)
    }), f.on("trait:deleted", function() {
        f.trigger("show:listpage"), f.trigger("modal:show", {type: "success",message: m.MESSAGES.getMessage("trait_deleted").message})
    }), f.on("delete:trait", function() {
        f.trigger("modal:show", {type: "notice",message: m.MESSAGES.getMessage("delete_trait").message,buttons: [{text: "OK",className: "primary",onClick: C}, {text: "Cancel",className: "secondary",onClick: function() {
                        f.trigger("modal:hide")
                    }}]})
    }), v
}), define("adobe_am/trait_builder/views/listPageLayout", ["backbone", "backbone.marionette", "underscore", "app", "adobe", "adobe.templates"], function(e, t, n, r, i, s) {
    var r = r || APP;
    return e.Marionette.Layout.extend({template: n.template(s.trait_builder.page.list_page),regions: {toolbar: ".top_toolbar",sidebar: ".traits_sidebar",traits_list: ".traits_list"},events: {"click li.new_model": "newModel","click li.new_trait": "newTrait","click li.delete_model": "deleteModels"},newModel: function() {
        },newTrait: function() {
        },deleteModels: function(e) {
        },onShow: function() {
            i.AM.UTILS.HELPERS.bindContextHelp()
        }})
}), define("modules/DataSource/Collections/DataSources", ["backbone", "modules/DataSource/Models/DataSource", "adobe", "globals"], function(e, t, n, r) {
    var i, s;
    return arguments.length == 0 ? (i = ADOBE.AM.pid, s = ADOBE.AM.API, e = Backbone, t = ADOBE.AM.DataSource.Models.DataSource) : (i = r.pid, s = n.AM.API), e.Collection.extend({model: t,url: function() {
            return s.DATASOURCES.dataSources.url()
        },getFirstParty: function(e) {
            return typeof e == "undefined" ? [] : this.filter(function(t) {
                return parseInt(t.get("pid"), 10) === e
            })
        }})
}), define("adobe_am/trait_builder/views/traitRow", ["backbone", "backbone.marionette", "text!adobe_am/trait_builder/templates.html", "modules/DataSource/Collections/DataSources", "adobe_am/vent", "adobe", "modules/Model/Models/AlgoModel"], function(e, t, n, r, i, s, o) {
    var u = e.Marionette.ItemView.extend({template: getTemplate("list_traits_table_row", n),gate_keeper: null,tagName: "tr",initialize: function(e) {
            _.bindAll(this, "cloneAlgoTrait"), this.dataSourceName = e.model._datasource_name;
            var t = e.model._permission_checker, n = e.model._user_perms;
            this.gate_keeper = t, this.permission_actions = {};
            try {
                t.setPermissionObjects([n, e.model.relational.permissions]), t.setCurrentScheme("can_edit_trait"), t.permissionCheck() && (this.permission_actions.edit = !0), this.model.isClonable() && (this.model.isRuleBasedTrait() ? (t.setCurrentScheme("can_clone_rule_based_trait_in_traitbuilder"), t.permissionCheck() && (this.permission_actions.clone = !0)) : this.model.isAlgoTrait() && (t.setCurrentScheme("can_clone_algo_trait_in_traitbuilder"), t.permissionCheck() && (this.permission_actions.clone = !0))), t.setCurrentScheme("can_delete_trait"), t.permissionCheck() && (this.permission_actions.del = !0), t.clearAll()
            } catch (r) {
            }
        },events: {"click span.result_checkbox": "checkBox","click .getPixel": "getPixel","click tr.rule-based .editTrait": "editRuleTrait","click tr.onboarded .editTrait": "editRuleTrait","click tr.rule-based .cloneTrait": "cloneRuleTrait","click tr.algorithmic .editTrait": "editAlgoTrait","click tr.algorithmic .cloneTrait": "cloneAlgoTrait","click tr .deleteTrait": "deleteTrait"},isChecked: function(e) {
            var t = _.indexOf(u.checked_traits, e);
            return t >= 0
        },checkBox: function(e) {
            var t = this.model.get("sid");
            this.isChecked(t) ? u.checked_traits.splice(_.indexOf(u.checked_traits, t), 1) : u.checked_traits.push(t), this.render()
        },getPixel: function() {
            var e = this, t = e.model.get("url");
            i.trigger("modal:show", {type: "notice",message: s.AM.MESSAGES.getMessage("trait_get_pixel_url").message,buttons: [{text: "Close",className: "secondary",onClick: function() {
                            i.trigger("modal:hide")
                        }}]}), $("#__trait_url").val("http://" + t), $("#__trait_secure_url").val("https://" + t), $("#__trait_img_tag").val('<img src="http://' + t + '" width="0" height="0" />'), $("#__trait_img_secure_tag").val('<img src="https://' + t + '" width="0" height="0" />')
        },editRuleTrait: function() {
            e.history.navigate("#edit/" + this.model.get("sid"), !0)
        },cloneRuleTrait: function() {
            e.history.navigate("#clone/" + this.model.get("sid"), !0)
        },editAlgoTrait: function() {
            e.history.navigate("#edit/" + this.model.get("sid"), !0)
        },cloneAlgoTrait: function() {
            e.history.navigate("#clone/" + this.model.get("sid"), !0)
        },deleteTrait: function() {
            var e = this, t = function(e) {
                var t = "";
                try {
                    var n = JSON.parse(e.responseText), r = n.childMessages;
                    t = n.message;
                    if (r) {
                        var o = "<ul>";
                        _.each(r, function(e) {
                            o += "<li>" + e + "</li>"
                        }), o += "</ul>", t += o
                    }
                } catch (u) {
                    t = s.AM.MESSAGES.getMessage("generic_error").message
                }
                i.trigger("modal:show", {type: "error",message: t}), i.trigger("show:listpage")
            }, n = function() {
                i.trigger("list:reload:traits"), i.trigger("modal:show", {type: "success",message: s.AM.MESSAGES.getMessage("trait_deleted").message})
            }, r = function() {
                i.trigger("modal:show", {type: "loading",header: s.AM.MESSAGES.getMessage("message").message,message: s.AM.MESSAGES.getMessage("loading").message}), e.model.destroy({wait: !0}).done(n).fail(t)
            };
            return i.trigger("modal:show", {type: "notice",message: s.AM.MESSAGES.getMessage("delete_trait").message,buttons: [{text: "OK",className: "primary",onClick: r}, {text: "Cancel",className: "secondary",onClick: function() {
                            i.trigger("modal:hide")
                        }}]}), !1
        },templateHelpers: function() {
            var e = this;
            return {formatTimestamp: function(e) {
                    var t = "-";
                    if (e != undefined)
                        try {
                            t = ADOBE.AM.UTILS.HELPERS.formatDate(e, function(e, t, n) {
                                return (e.charAt(1) ? e : "0" + e.charAt(0)) + "/" + (t.charAt(1) ? t : "0" + t.charAt(0)) + "/" + n
                            })
                        } catch (n) {
                            ADOBE.AM.UTILS.LOGGER.log("ModelRow:templateHelpers:formatTimestamp: " + n.message)
                        }
                    return t
                },displayCheckbox: function() {
                    return e.isChecked(this.sid) ? '<img src="/css/aam/images/checkbox_checked.png" class="result_checkbox_enabled" />' : '<img src="/css/aam/images/checkbox_unchecked.png" class="result_checkbox_disabled" />'
                },getStatusImage: function() {
                    return this.status == "1" ? '<img class="pause btn_action" src="/css/aam/images/Pause_Standard.png" alt="Pause" title="Pause" />' : '<img class="play btn_action" src="' + APP.state.vars.images.play_standard + '" alt="Play" title="Play" />'
                },displayStatus: function(t) {
                    return e.model.constructor.getStatusName(t)
                },getTraitTypeName: function(t) {
                    return e.model.constructor.getTraitTypeName(t)
                },getDataSourceName: function(t) {
                    return e.dataSourceName
                },getPermission: function(t) {
                    return e.permission_actions[t]
                }}
        }}, {checked_traits: []});
    return u
}), define("adobe_am/trait_builder/views/traitTable", ["backbone", "backbone.marionette", "text!adobe_am/trait_builder/templates.html", "adobe_am/trait_builder/views/traitRow", "adobe_am/vent"], function(e, t, n, r, i) {
    return e.Marionette.CompositeView.extend({template: getTemplate("list_traits_table", n),className: "content",tagName: "div",events: {"click th:not(:first-child)": "doSort","click th:first-child": "checkbox"},initialize: function(e) {
            var t = function(t) {
                t.each(function(t) {
                    var n = _.findWhere(e.dataSources, {dataSourceId: t.get("dataSourceId")});
                    t._datasource_name = typeof n != "undefined" ? n.name : "", t._permission_checker = e.permission_checker, t._user_perms = e.user_permission
                })
            };
            this.collection.on("reset", t), t(this.collection)
        },onRender: function() {
            this.$table_col_headers = this.$el.find("th")
        },checkbox: function(e) {
            var t = $(e.currentTarget), n = t.hasClass("enabled") || !1, r = t.find("input[type=checkbox]"), i = !r.prop("checked");
            r.prop("checked", i), i ? (t.removeClass("disabled").addClass("enabled"), this.itemView.checked_traits = this.collection.pluck("sid")) : (t.removeClass("enabled").addClass("disabled"), this.itemView.checked_traits = []), this.renderCollection()
        },doSort: function(e) {
            var t = $(e.currentTarget), n = t.data("sortby"), r = !0;
            t.hasClass("asc") ? (this.$table_col_headers.removeClass("desc asc"), t.addClass("desc")) : (r = !1, this.$table_col_headers.removeClass("desc asc"), t.addClass("asc")), this.collection.resetPagination(), this.collection.setParams(_.extend(this.collection.custom_query_string_params, {customParam1: r,sortField: n})), this.collection.pager()
        },itemView: r,appendHtml: function(e, t) {
            var n = t.model;
            $(t.el).addClass(n.constructor.getTraitTypeName(n.get("traitType")).toLowerCase()), e.$("#traits_table tbody").append(t.el), $("#traits_table tbody tr").length == this.collection.length && i.trigger("list:loaded")
        }})
}), define("modules/Widget/Views/SearchField", ["backbone", "aui"], function(e, t) {
    return e == undefined && (e = Backbone), t == undefined && (t = AUI), e.View.extend({query_string_args: {},errors: [],initialize: function(e) {
            _.bindAll(this, "render"), _.bindAll(this, "clear"), _.bindAll(this, "getSearchButton"), _.bindAll(this, "triggerSearch"), e && e.query_string_args && (this.query_string_args = e.query_string_args), e && e.beforeSearch && (this.beforeSearch = e.beforeSearch), e && e.afterSearch && (this.afterSearch = e.afterSearch), this.render()
        },events: {"keypress button.AUI_SearchField_Search": "triggerSearch","keyup input[type=text]": "triggerSearchOnEnter"},triggerSearchOnEnter: function(e) {
            if (e.keyCode != 13)
                return e.preventDefault(), e.stopPropagation(), !1;
            this.triggerSearch(e)
        },clear: function() {
            this.aui_reference.set("value", "")
        },beforeSearch: function() {
        },afterSearch: function() {
        },triggerSearch: function(e) {
            var t = this, n = t.aui_reference.get("value");
            this.beforeSearch(), this.errors = [], this.collection.setParams(_.extend({query: n}, this.query_string_args)), this.collection.resetPagination(), this.collection.fetch().always(this.afterSearch)
        },getSearchButton: function() {
            return this.$el.find("button.AUI_SearchField_Search").get(0)
        },render: function() {
            var e = null;
            this.aui_reference = t.SimpleSearch({parent: this.el,width: "151px"}).render(), e = this.getSearchButton(), t.addListener(e, "click", this.triggerSearch)
        }})
}), define("modules/Widget/Views/PaginatedView", ["backbone", "adobe.templates"], function(e, t) {
    return e == undefined && (e = Backbone), t == undefined && (t = APP.templates), e.View.extend({events: {"click a.servernext": "nextResultPage","click a.serverprevious": "previousResultPage","change select.serverhowmany": "changeCount","change select.pagination_pages": "gotoPage"},tagName: "aside",template: _.template(t.server_pagination),initialize: function(e) {
            _.extend(this, e), this.isRendered = !1, this.collection.on("reset", this.render, this), this.collection.on("change", this.render, this), this.$el.appendTo(this.parent_element)
        },beforeEventClick: function() {
        },afterRender: function() {
        },render: function() {
            var e = this.template(this.collection.info());
            this.$el.html(e), this.isRendered ? this.afterRender() : this.isRendered = !0
        },nextResultPage: function(e) {
            this.beforeEventClick(), e.preventDefault(), this.collection.requestNextPage()
        },previousResultPage: function(e) {
            this.beforeEventClick(), e.preventDefault(), this.collection.requestPreviousPage()
        },gotoPage: function(e) {
            this.beforeEventClick(), e.preventDefault();
            var t = $(e.target).val();
            this.collection.goTo(t)
        },changeCount: function(e) {
            this.beforeEventClick(), e.preventDefault();
            var t = $(e.target).val();
            this.collection.howManyPer(t)
        }})
}), function(e, t) {
    function n(t, n) {
        var i = t.nodeName.toLowerCase();
        return "area" === i ? (n = t.parentNode, i = n.name, !t.href || !i || n.nodeName.toLowerCase() !== "map" ? !1 : (t = e("img[usemap=#" + i + "]")[0], !!t && r(t))) : (/input|select|textarea|button|object/.test(i) ? !t.disabled : "a" == i ? t.href || n : n) && r(t)
    }
    function r(t) {
        return !e(t).parents().andSelf().filter(function() {
            return e.curCSS(this, "visibility") === "hidden" || e.expr.filters.hidden(this)
        }).length
    }
    e.ui = e.ui || {}, e.ui.version || (e.extend(e.ui, {version: "1.8.16",keyCode: {ALT: 18,BACKSPACE: 8,CAPS_LOCK: 20,COMMA: 188,COMMAND: 91,COMMAND_LEFT: 91,COMMAND_RIGHT: 93,CONTROL: 17,DELETE: 46,DOWN: 40,END: 35,ENTER: 13,ESCAPE: 27,HOME: 36,INSERT: 45,LEFT: 37,MENU: 93,NUMPAD_ADD: 107,NUMPAD_DECIMAL: 110,NUMPAD_DIVIDE: 111,NUMPAD_ENTER: 108,NUMPAD_MULTIPLY: 106,NUMPAD_SUBTRACT: 109,PAGE_DOWN: 34,PAGE_UP: 33,PERIOD: 190,RIGHT: 39,SHIFT: 16,SPACE: 32,TAB: 9,UP: 38,WINDOWS: 91}}), e.fn.extend({propAttr: e.fn.prop || e.fn.attr,_focus: e.fn.focus,focus: function(t, n) {
            return typeof t == "number" ? this.each(function() {
                var r = this;
                setTimeout(function() {
                    e(r).focus(), n && n.call(r)
                }, t)
            }) : this._focus.apply(this, arguments)
        },scrollParent: function() {
            var t;
            return t = e.browser.msie && /(static|relative)/.test(this.css("position")) || /absolute/.test(this.css("position")) ? this.parents().filter(function() {
                return /(relative|absolute|fixed)/.test(e.curCSS(this, "position", 1)) && /(auto|scroll)/.test(e.curCSS(this, "overflow", 1) + e.curCSS(this, "overflow-y", 1) + e.curCSS(this, "overflow-x", 1))
            }).eq(0) : this.parents().filter(function() {
                return /(auto|scroll)/.test(e.curCSS(this, "overflow", 1) + e.curCSS(this, "overflow-y", 1) + e.curCSS(this, "overflow-x", 1))
            }).eq(0), /fixed/.test(this.css("position")) || !t.length ? e(document) : t
        },zIndex: function(n) {
            if (n !== t)
                return this.css("zIndex", n);
            if (this.length) {
                n = e(this[0]);
                for (var r; n.length && n[0] !== document; ) {
                    r = n.css("position");
                    if (r === "absolute" || r === "relative" || r === "fixed") {
                        r = parseInt(n.css("zIndex"), 10);
                        if (!isNaN(r) && r !== 0)
                            return r
                    }
                    n = n.parent()
                }
            }
            return 0
        },disableSelection: function() {
            return this.bind((e.support.selectstart ? "selectstart" : "mousedown") + ".ui-disableSelection", function(e) {
                e.preventDefault()
            })
        },enableSelection: function() {
            return this.unbind(".ui-disableSelection")
        }}), e.each(["Width", "Height"], function(n, r) {
        function i(t, n, r, i) {
            return e.each(s, function() {
                n -= parseFloat(e.curCSS(t, "padding" + this, !0)) || 0, r && (n -= parseFloat(e.curCSS(t, "border" + this + "Width", !0)) || 0), i && (n -= parseFloat(e.curCSS(t, "margin" + this, !0)) || 0)
            }), n
        }
        var s = r === "Width" ? ["Left", "Right"] : ["Top", "Bottom"], o = r.toLowerCase(), u = {innerWidth: e.fn.innerWidth,innerHeight: e.fn.innerHeight,outerWidth: e.fn.outerWidth,outerHeight: e.fn.outerHeight};
        e.fn["inner" + r] = function(n) {
            return n === t ? u["inner" + r].call(this) : this.each(function() {
                e(this).css(o, i(this, n) + "px")
            })
        }, e.fn["outer" + r] = function(t, n) {
            return typeof t != "number" ? u["outer" + r].call(this, t) : this.each(function() {
                e(this).css(o, i(this, t, !0, n) + "px")
            })
        }
    }), e.extend(e.expr[":"], {data: function(t, n, r) {
            return !!e.data(t, r[3])
        },focusable: function(t) {
            return n(t, !isNaN(e.attr(t, "tabindex")))
        },tabbable: function(t) {
            var r = e.attr(t, "tabindex"), i = isNaN(r);
            return (i || r >= 0) && n(t, !i)
        }}), e(function() {
        var t = document.body, n = t.appendChild(n = document.createElement("div"));
        e.extend(n.style, {minHeight: "100px",height: "auto",padding: 0,borderWidth: 0}), e.support.minHeight = n.offsetHeight === 100, e.support.selectstart = "onselectstart" in n, t.removeChild(n).style.display = "none"
    }), e.extend(e.ui, {plugin: {add: function(t, n, r) {
                t = e.ui[t].prototype;
                for (var i in r)
                    t.plugins[i] = t.plugins[i] || [], t.plugins[i].push([n, r[i]])
            },call: function(e, t, n) {
                if ((t = e.plugins[t]) && e.element[0].parentNode)
                    for (var r = 0; r < t.length; r++)
                        e.options[t[r][0]] && t[r][1].apply(e.element, n)
            }},contains: function(e, t) {
            return document.compareDocumentPosition ? e.compareDocumentPosition(t) & 16 : e !== t && e.contains(t)
        },hasScroll: function(t, n) {
            if (e(t).css("overflow") === "hidden")
                return !1;
            n = n && n === "left" ? "scrollLeft" : "scrollTop";
            var r = !1;
            return t[n] > 0 ? !0 : (t[n] = 1, r = t[n] > 0, t[n] = 0, r)
        },isOverAxis: function(e, t, n) {
            return e > t && e < t + n
        },isOver: function(t, n, r, i, s, o) {
            return e.ui.isOverAxis(t, r, s) && e.ui.isOverAxis(n, i, o)
        }}))
}(jQuery), function(e, t) {
    if (e.cleanData) {
        var n = e.cleanData;
        e.cleanData = function(t) {
            for (var r = 0, i; (i = t[r]) != null; r++)
                try {
                    e(i).triggerHandler("remove")
                } catch (s) {
                }
            n(t)
        }
    } else {
        var r = e.fn.remove;
        e.fn.remove = function(t, n) {
            return this.each(function() {
                return n || (!t || e.filter(t, [this]).length) && e("*", this).add([this]).each(function() {
                    try {
                        e(this).triggerHandler("remove")
                    } catch (t) {
                    }
                }), r.call(e(this), t, n)
            })
        }
    }
    e.widget = function(t, n, r) {
        var i = t.split(".")[0], s;
        t = t.split(".")[1], s = i + "-" + t, r || (r = n, n = e.Widget), e.expr[":"][s] = function(n) {
            return !!e.data(n, t)
        }, e[i] = e[i] || {}, e[i][t] = function(e, t) {
            arguments.length && this._createWidget(e, t)
        }, n = new n, n.options = e.extend(!0, {}, n.options), e[i][t].prototype = e.extend(!0, n, {namespace: i,widgetName: t,widgetEventPrefix: e[i][t].prototype.widgetEventPrefix || t,widgetBaseClass: s}, r), e.widget.bridge(t, e[i][t])
    }, e.widget.bridge = function(n, r) {
        e.fn[n] = function(i) {
            var s = typeof i == "string", o = Array.prototype.slice.call(arguments, 1), u = this;
            return i = !s && o.length ? e.extend.apply(null, [!0, i].concat(o)) : i, s && i.charAt(0) === "_" ? u : (s ? this.each(function() {
                var r = e.data(this, n), s = r && e.isFunction(r[i]) ? r[i].apply(r, o) : r;
                if (s !== r && s !== t)
                    return u = s, !1
            }) : this.each(function() {
                var t = e.data(this, n);
                t ? t.option(i || {})._init() : e.data(this, n, new r(i, this))
            }), u)
        }
    }, e.Widget = function(e, t) {
        arguments.length && this._createWidget(e, t)
    }, e.Widget.prototype = {widgetName: "widget",widgetEventPrefix: "",options: {disabled: !1},_createWidget: function(t, n) {
            e.data(n, this.widgetName, this), this.element = e(n), this.options = e.extend(!0, {}, this.options, this._getCreateOptions(), t);
            var r = this;
            this.element.bind("remove." + this.widgetName, function() {
                r.destroy()
            }), this._create(), this._trigger("create"), this._init()
        },_getCreateOptions: function() {
            return e.metadata && e.metadata.get(this.element[0])[this.widgetName]
        },_create: function() {
        },_init: function() {
        },destroy: function() {
            this.element.unbind("." + this.widgetName).removeData(this.widgetName), this.widget().unbind("." + this.widgetName).removeAttr("aria-disabled").removeClass(this.widgetBaseClass + "-disabled ui-state-disabled")
        },widget: function() {
            return this.element
        },option: function(n, r) {
            var i = n;
            if (arguments.length === 0)
                return e.extend({}, this.options);
            if (typeof n == "string") {
                if (r === t)
                    return this.options[n];
                i = {}, i[n] = r
            }
            return this._setOptions(i), this
        },_setOptions: function(t) {
            var n = this;
            return e.each(t, function(e, t) {
                n._setOption(e, t)
            }), this
        },_setOption: function(e, t) {
            return this.options[e] = t, e === "disabled" && this.widget()[t ? "addClass" : "removeClass"](this.widgetBaseClass + "-disabled ui-state-disabled").attr("aria-disabled", t), this
        },enable: function() {
            return this._setOption("disabled", !1)
        },disable: function() {
            return this._setOption("disabled", !0)
        },_trigger: function(t, n, r) {
            var i = this.options[t];
            n = e.Event(n), n.type = (t === this.widgetEventPrefix ? t : this.widgetEventPrefix + t).toLowerCase(), r = r || {};
            if (n.originalEvent) {
                t = e.event.props.length;
                for (var s; t; )
                    s = e.event.props[--t], n[s] = n.originalEvent[s]
            }
            return this.element.trigger(n, r), !(e.isFunction(i) && i.call(this.element[0], n, r) === !1 || n.isDefaultPrevented())
        }}
}(jQuery), function(e) {
    var t = !1;
    e(document).mouseup(function() {
        t = !1
    }), e.widget("ui.mouse", {options: {cancel: ":input,option",distance: 1,delay: 0},_mouseInit: function() {
            var t = this;
            this.element.bind("mousedown." + this.widgetName, function(e) {
                return t._mouseDown(e)
            }).bind("click." + this.widgetName, function(n) {
                if (!0 === e.data(n.target, t.widgetName + ".preventClickEvent"))
                    return e.removeData(n.target, t.widgetName + ".preventClickEvent"), n.stopImmediatePropagation(), !1
            }), this.started = !1
        },_mouseDestroy: function() {
            this.element.unbind("." + this.widgetName)
        },_mouseDown: function(n) {
            if (!t) {
                this._mouseStarted && this._mouseUp(n), this._mouseDownEvent = n;
                var r = this, i = n.which == 1, s = typeof this.options.cancel == "string" && n.target.nodeName ? e(n.target).closest(this.options.cancel).length : !1;
                if (!i || s || !this._mouseCapture(n))
                    return !0;
                this.mouseDelayMet = !this.options.delay, this.mouseDelayMet || (this._mouseDelayTimer = setTimeout(function() {
                    r.mouseDelayMet = !0
                }, this.options.delay));
                if (this._mouseDistanceMet(n) && this._mouseDelayMet(n)) {
                    this._mouseStarted = this._mouseStart(n) !== !1;
                    if (!this._mouseStarted)
                        return n.preventDefault(), !0
                }
                return !0 === e.data(n.target, this.widgetName + ".preventClickEvent") && e.removeData(n.target, this.widgetName + ".preventClickEvent"), this._mouseMoveDelegate = function(e) {
                    return r._mouseMove(e)
                }, this._mouseUpDelegate = function(e) {
                    return r._mouseUp(e)
                }, e(document).bind("mousemove." + this.widgetName, this._mouseMoveDelegate).bind("mouseup." + this.widgetName, this._mouseUpDelegate), n.preventDefault(), t = !0
            }
        },_mouseMove: function(t) {
            return !e.browser.msie || document.documentMode >= 9 || !!t.button ? this._mouseStarted ? (this._mouseDrag(t), t.preventDefault()) : (this._mouseDistanceMet(t) && this._mouseDelayMet(t) && ((this._mouseStarted = this._mouseStart(this._mouseDownEvent, t) !== !1) ? this._mouseDrag(t) : this._mouseUp(t)), !this._mouseStarted) : this._mouseUp(t)
        },_mouseUp: function(t) {
            return e(document).unbind("mousemove." + this.widgetName, this._mouseMoveDelegate).unbind("mouseup." + this.widgetName, this._mouseUpDelegate), this._mouseStarted && (this._mouseStarted = !1, t.target == this._mouseDownEvent.target && e.data(t.target, this.widgetName + ".preventClickEvent", !0), this._mouseStop(t)), !1
        },_mouseDistanceMet: function(e) {
            return Math.max(Math.abs(this._mouseDownEvent.pageX - e.pageX), Math.abs(this._mouseDownEvent.pageY - e.pageY)) >= this.options.distance
        },_mouseDelayMet: function() {
            return this.mouseDelayMet
        },_mouseStart: function() {
        },_mouseDrag: function() {
        },_mouseStop: function() {
        },_mouseCapture: function() {
            return !0
        }})
}(jQuery), function(e) {
    e.ui = e.ui || {};
    var t = /left|center|right/, n = /top|center|bottom/, r = e.fn.position, i = e.fn.offset;
    e.fn.position = function(i) {
        if (!i || !i.of)
            return r.apply(this, arguments);
        i = e.extend({}, i);
        var s = e(i.of), u = s[0], a = (i.collision || "flip").split(" "), f = i.offset ? i.offset.split(" ") : [0, 0], l, h, p;
        return u.nodeType === 9 ? (l = s.width(), h = s.height(), p = {top: 0,left: 0}) : u.setTimeout ? (l = s.width(), h = s.height(), p = {top: s.scrollTop(),left: s.scrollLeft()}) : u.preventDefault ? (i.at = "left top", l = h = 0, p = {top: i.of.pageY,left: i.of.pageX}) : (l = s.outerWidth(), h = s.outerHeight(), p = s.offset()), e.each(["my", "at"], function() {
            var e = (i[this] || "").split(" ");
            e.length === 1 && (e = t.test(e[0]) ? e.concat(["center"]) : n.test(e[0]) ? ["center"].concat(e) : ["center", "center"]), e[0] = t.test(e[0]) ? e[0] : "center", e[1] = n.test(e[1]) ? e[1] : "center", i[this] = e
        }), a.length === 1 && (a[1] = a[0]), f[0] = parseInt(f[0], 10) || 0, f.length === 1 && (f[1] = f[0]), f[1] = parseInt(f[1], 10) || 0, i.at[0] === "right" ? p.left += l : i.at[0] === "center" && (p.left += l / 2), i.at[1] === "bottom" ? p.top += h : i.at[1] === "center" && (p.top += h / 2), p.left += f[0], p.top += f[1], this.each(function() {
            var t = e(this), n = t.outerWidth(), r = t.outerHeight(), s = parseInt(e.curCSS(this, "marginLeft", !0)) || 0, o = parseInt(e.curCSS(this, "marginTop", !0)) || 0, u = n + s + (parseInt(e.curCSS(this, "marginRight", !0)) || 0), d = r + o + (parseInt(e.curCSS(this, "marginBottom", !0)) || 0), v = e.extend({}, p), m;
            i.my[0] === "right" ? v.left -= n : i.my[0] === "center" && (v.left -= n / 2), i.my[1] === "bottom" ? v.top -= r : i.my[1] === "center" && (v.top -= r / 2), v.left = Math.round(v.left), v.top = Math.round(v.top), m = {left: v.left - s,top: v.top - o}, e.each(["left", "top"], function(t, s) {
                e.ui.position[a[t]] && e.ui.position[a[t]][s](v, {targetWidth: l,targetHeight: h,elemWidth: n,elemHeight: r,collisionPosition: m,collisionWidth: u,collisionHeight: d,offset: f,my: i.my,at: i.at})
            }), e.fn.bgiframe && t.bgiframe(), t.offset(e.extend(v, {using: i.using}))
        })
    }, e.ui.position = {fit: {left: function(t, n) {
                var r = e(window);
                r = n.collisionPosition.left + n.collisionWidth - r.width() - r.scrollLeft(), t.left = r > 0 ? t.left - r : Math.max(t.left - n.collisionPosition.left, t.left)
            },top: function(t, n) {
                var r = e(window);
                r = n.collisionPosition.top + n.collisionHeight - r.height() - r.scrollTop(), t.top = r > 0 ? t.top - r : Math.max(t.top - n.collisionPosition.top, t.top)
            }},flip: {left: function(t, n) {
                if (n.at[0] !== "center") {
                    var r = e(window);
                    r = n.collisionPosition.left + n.collisionWidth - r.width() - r.scrollLeft();
                    var i = n.my[0] === "left" ? -n.elemWidth : n.my[0] === "right" ? n.elemWidth : 0, s = n.at[0] === "left" ? n.targetWidth : -n.targetWidth, o = -2 * n.offset[0];
                    t.left += n.collisionPosition.left < 0 ? i + s + o : r > 0 ? i + s + o : 0
                }
            },top: function(t, n) {
                if (n.at[1] !== "center") {
                    var r = e(window);
                    r = n.collisionPosition.top + n.collisionHeight - r.height() - r.scrollTop();
                    var i = n.my[1] === "top" ? -n.elemHeight : n.my[1] === "bottom" ? n.elemHeight : 0, s = n.at[1] === "top" ? n.targetHeight : -n.targetHeight, o = -2 * n.offset[1];
                    t.top += n.collisionPosition.top < 0 ? i + s + o : r > 0 ? i + s + o : 0
                }
            }}}, e.offset.setOffset || (e.offset.setOffset = function(t, n) {
        /static/.test(e.curCSS(t, "position")) && (t.style.position = "relative");
        var r = e(t), i = r.offset(), s = parseInt(e.curCSS(t, "top", !0), 10) || 0, o = parseInt(e.curCSS(t, "left", !0), 10) || 0;
        i = {top: n.top - i.top + s,left: n.left - i.left + o}, "using" in n ? n.using.call(t, i) : r.css(i)
    }, e.fn.offset = function(t) {
        var n = this[0];
        return !n || !n.ownerDocument ? null : t ? this.each(function() {
            e.offset.setOffset(this, t)
        }) : i.call(this)
    })
}(jQuery), function(e) {
    e.widget("ui.draggable", e.ui.mouse, {widgetEventPrefix: "drag",options: {addClasses: !0,appendTo: "parent",axis: !1,connectToSortable: !1,containment: !1,cursor: "auto",cursorAt: !1,grid: !1,handle: !1,helper: "original",iframeFix: !1,opacity: !1,refreshPositions: !1,revert: !1,revertDuration: 500,scope: "default",scroll: !0,scrollSensitivity: 20,scrollSpeed: 20,snap: !1,snapMode: "both",snapTolerance: 20,stack: !1,zIndex: !1},_create: function() {
            this.options.helper == "original" && !/^(?:r|a|f)/.test(this.element.css("position")) && (this.element[0].style.position = "relative"), this.options.addClasses && this.element.addClass("ui-draggable"), this.options.disabled && this.element.addClass("ui-draggable-disabled"), this._mouseInit()
        },destroy: function() {
            if (this.element.data("draggable"))
                return this.element.removeData("draggable").unbind(".draggable").removeClass("ui-draggable ui-draggable-dragging ui-draggable-disabled"), this._mouseDestroy(), this
        },_mouseCapture: function(t) {
            var n = this.options;
            return this.helper || n.disabled || e(t.target).is(".ui-resizable-handle") ? !1 : (this.handle = this._getHandle(t), this.handle ? (n.iframeFix && e(n.iframeFix === !0 ? "iframe" : n.iframeFix).each(function() {
                e('<div class="ui-draggable-iframeFix" style="background: #fff;"></div>').css({width: this.offsetWidth + "px",height: this.offsetHeight + "px",position: "absolute",opacity: "0.001",zIndex: 1e3}).css(e(this).offset()).appendTo("body")
            }), !0) : !1)
        },_mouseStart: function(t) {
            var n = this.options;
            return this.helper = this._createHelper(t), this._cacheHelperProportions(), e.ui.ddmanager && (e.ui.ddmanager.current = this), this._cacheMargins(), this.cssPosition = this.helper.css("position"), this.scrollParent = this.helper.scrollParent(), this.offset = this.positionAbs = this.element.offset(), this.offset = {top: this.offset.top - this.margins.top,left: this.offset.left - this.margins.left}, e.extend(this.offset, {click: {left: t.pageX - this.offset.left,top: t.pageY - this.offset.top},parent: this._getParentOffset(),relative: this._getRelativeOffset()}), this.originalPosition = this.position = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, n.cursorAt && this._adjustOffsetFromHelper(n.cursorAt), n.containment && this._setContainment(), this._trigger("start", t) === !1 ? (this._clear(), !1) : (this._cacheHelperProportions(), e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.helper.addClass("ui-draggable-dragging"), this._mouseDrag(t, !0), e.ui.ddmanager && e.ui.ddmanager.dragStart(this, t), !0)
        },_mouseDrag: function(t, n) {
            this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute");
            if (!n) {
                n = this._uiHash();
                if (this._trigger("drag", t, n) === !1)
                    return this._mouseUp({}), !1;
                this.position = n.position
            }
            if (!this.options.axis || this.options.axis != "y")
                this.helper[0].style.left = this.position.left + "px";
            if (!this.options.axis || this.options.axis != "x")
                this.helper[0].style.top = this.position.top + "px";
            return e.ui.ddmanager && e.ui.ddmanager.drag(this, t), !1
        },_mouseStop: function(t) {
            var n = !1;
            e.ui.ddmanager && !this.options.dropBehaviour && (n = e.ui.ddmanager.drop(this, t)), this.dropped && (n = this.dropped, this.dropped = !1);
            if ((!this.element[0] || !this.element[0].parentNode) && this.options.helper == "original")
                return !1;
            if (this.options.revert == "invalid" && !n || this.options.revert == "valid" && n || this.options.revert === !0 || e.isFunction(this.options.revert) && this.options.revert.call(this.element, n)) {
                var r = this;
                e(this.helper).animate(this.originalPosition, parseInt(this.options.revertDuration, 10), function() {
                    r._trigger("stop", t) !== !1 && r._clear()
                })
            } else
                this._trigger("stop", t) !== !1 && this._clear();
            return !1
        },_mouseUp: function(t) {
            return this.options.iframeFix === !0 && e("div.ui-draggable-iframeFix").each(function() {
                this.parentNode.removeChild(this)
            }), e.ui.ddmanager && e.ui.ddmanager.dragStop(this, t), e.ui.mouse.prototype._mouseUp.call(this, t)
        },cancel: function() {
            return this.helper.is(".ui-draggable-dragging") ? this._mouseUp({}) : this._clear(), this
        },_getHandle: function(t) {
            var n = !this.options.handle || !e(this.options.handle, this.element).length ? !0 : !1;
            return e(this.options.handle, this.element).find("*").andSelf().each(function() {
                this == t.target && (n = !0)
            }), n
        },_createHelper: function(t) {
            var n = this.options;
            return t = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t])) : n.helper == "clone" ? this.element.clone().removeAttr("id") : this.element, t.parents("body").length || t.appendTo(n.appendTo == "parent" ? this.element[0].parentNode : n.appendTo), t[0] != this.element[0] && !/(fixed|absolute)/.test(t.css("position")) && t.css("position", "absolute"), t
        },_adjustOffsetFromHelper: function(t) {
            typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {left: +t[0],top: +t[1] || 0}), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
        },_getParentOffset: function() {
            this.offsetParent = this.helper.offsetParent();
            var t = this.offsetParent.offset();
            this.cssPosition == "absolute" && this.scrollParent[0] != document && e.ui.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
            if (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && e.browser.msie)
                t = {top: 0,left: 0};
            return {top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
        },_getRelativeOffset: function() {
            if (this.cssPosition == "relative") {
                var e = this.element.position();
                return {top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
            }
            return {top: 0,left: 0}
        },_cacheMargins: function() {
            this.margins = {left: parseInt(this.element.css("marginLeft"), 10) || 0,top: parseInt(this.element.css("marginTop"), 10) || 0,right: parseInt(this.element.css("marginRight"), 10) || 0,bottom: parseInt(this.element.css("marginBottom"), 10) || 0}
        },_cacheHelperProportions: function() {
            this.helperProportions = {width: this.helper.outerWidth(),height: this.helper.outerHeight()}
        },_setContainment: function() {
            var t = this.options;
            t.containment == "parent" && (t.containment = this.helper[0].parentNode);
            if (t.containment == "document" || t.containment == "window")
                this.containment = [t.containment == "document" ? 0 : e(window).scrollLeft() - this.offset.relative.left - this.offset.parent.left, t.containment == "document" ? 0 : e(window).scrollTop() - this.offset.relative.top - this.offset.parent.top, (t.containment == "document" ? 0 : e(window).scrollLeft()) + e(t.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (t.containment == "document" ? 0 : e(window).scrollTop()) + (e(t.containment == "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
            if (!/^(document|window|parent)$/.test(t.containment) && t.containment.constructor != Array) {
                t = e(t.containment);
                var n = t[0];
                if (n) {
                    t.offset();
                    var r = e(n).css("overflow") != "hidden";
                    this.containment = [(parseInt(e(n).css("borderLeftWidth"), 10) || 0) + (parseInt(e(n).css("paddingLeft"), 10) || 0), (parseInt(e(n).css("borderTopWidth"), 10) || 0) + (parseInt(e(n).css("paddingTop"), 10) || 0), (r ? Math.max(n.scrollWidth, n.offsetWidth) : n.offsetWidth) - (parseInt(e(n).css("borderLeftWidth"), 10) || 0) - (parseInt(e(n).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left - this.margins.right, (r ? Math.max(n.scrollHeight, n.offsetHeight) : n.offsetHeight) - (parseInt(e(n).css("borderTopWidth"), 10) || 0) - (parseInt(e(n).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top - this.margins.bottom], this.relative_container = t
                }
            } else
                t.containment.constructor == Array && (this.containment = t.containment)
        },_convertPositionTo: function(t, n) {
            n || (n = this.position), t = t == "absolute" ? 1 : -1;
            var r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName);
            return {top: n.top + this.offset.relative.top * t + this.offset.parent.top * t - (e.browser.safari && e.browser.version < 526 && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()) * t),left: n.left + this.offset.relative.left * t + this.offset.parent.left * t - (e.browser.safari && e.browser.version < 526 && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft()) * t)}
        },_generatePosition: function(t) {
            var n = this.options, r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName), s = t.pageX, o = t.pageY;
            if (this.originalPosition) {
                var u;
                this.containment && (this.relative_container ? (u = this.relative_container.offset(), u = [this.containment[0] + u.left, this.containment[1] + u.top, this.containment[2] + u.left, this.containment[3] + u.top]) : u = this.containment, t.pageX - this.offset.click.left < u[0] && (s = u[0] + this.offset.click.left), t.pageY - this.offset.click.top < u[1] && (o = u[1] + this.offset.click.top), t.pageX - this.offset.click.left > u[2] && (s = u[2] + this.offset.click.left), t.pageY - this.offset.click.top > u[3] && (o = u[3] + this.offset.click.top)), n.grid && (o = n.grid[1] ? this.originalPageY + Math.round((o - this.originalPageY) / n.grid[1]) * n.grid[1] : this.originalPageY, o = u ? o - this.offset.click.top < u[1] || o - this.offset.click.top > u[3] ? o - this.offset.click.top < u[1] ? o + n.grid[1] : o - n.grid[1] : o : o, s = n.grid[0] ? this.originalPageX + Math.round((s - this.originalPageX) / n.grid[0]) * n.grid[0] : this.originalPageX, s = u ? s - this.offset.click.left < u[0] || s - this.offset.click.left > u[2] ? s - this.offset.click.left < u[0] ? s + n.grid[0] : s - n.grid[0] : s : s)
            }
            return {top: o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (e.browser.safari && e.browser.version < 526 && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()),left: s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (e.browser.safari && e.browser.version < 526 && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft())}
        },_clear: function() {
            this.helper.removeClass("ui-draggable-dragging"), this.helper[0] != this.element[0] && !this.cancelHelperRemoval && this.helper.remove(), this.helper = null, this.cancelHelperRemoval = !1
        },_trigger: function(t, n, r) {
            return r = r || this._uiHash(), e.ui.plugin.call(this, t, [n, r]), t == "drag" && (this.positionAbs = this._convertPositionTo("absolute")), e.Widget.prototype._trigger.call(this, t, n, r)
        },plugins: {},_uiHash: function() {
            return {helper: this.helper,position: this.position,originalPosition: this.originalPosition,offset: this.positionAbs}
        }}), e.extend(e.ui.draggable, {version: "1.8.16"}), e.ui.plugin.add("draggable", "connectToSortable", {start: function(t, n) {
            var r = e(this).data("draggable"), i = r.options, s = e.extend({}, n, {item: r.element});
            r.sortables = [], e(i.connectToSortable).each(function() {
                var n = e.data(this, "sortable");
                n && !n.options.disabled && (r.sortables.push({instance: n,shouldRevert: n.options.revert}), n.refreshPositions(), n._trigger("activate", t, s))
            })
        },stop: function(t, n) {
            var r = e(this).data("draggable"), i = e.extend({}, n, {item: r.element});
            e.each(r.sortables, function() {
                this.instance.isOver ? (this.instance.isOver = 0, r.cancelHelperRemoval = !0, this.instance.cancelHelperRemoval = !1, this.shouldRevert && (this.instance.options.revert = !0), this.instance._mouseStop(t), this.instance.options.helper = this.instance.options._helper, r.options.helper == "original" && this.instance.currentItem.css({top: "auto",left: "auto"})) : (this.instance.cancelHelperRemoval = !1, this.instance._trigger("deactivate", t, i))
            })
        },drag: function(t, n) {
            var r = e(this).data("draggable"), i = this;
            e.each(r.sortables, function() {
                this.instance.positionAbs = r.positionAbs, this.instance.helperProportions = r.helperProportions, this.instance.offset.click = r.offset.click, this.instance._intersectsWith(this.instance.containerCache) ? (this.instance.isOver || (this.instance.isOver = 1, this.instance.currentItem = e(i).clone().removeAttr("id").appendTo(this.instance.element).data("sortable-item", !0), this.instance.options._helper = this.instance.options.helper, this.instance.options.helper = function() {
                    return n.helper[0]
                }, t.target = this.instance.currentItem[0], this.instance._mouseCapture(t, !0), this.instance._mouseStart(t, !0, !0), this.instance.offset.click.top = r.offset.click.top, this.instance.offset.click.left = r.offset.click.left, this.instance.offset.parent.left -= r.offset.parent.left - this.instance.offset.parent.left, this.instance.offset.parent.top -= r.offset.parent.top - this.instance.offset.parent.top, r._trigger("toSortable", t), r.dropped = this.instance.element, r.currentItem = r.element, this.instance.fromOutside = r), this.instance.currentItem && this.instance._mouseDrag(t)) : this.instance.isOver && (this.instance.isOver = 0, this.instance.cancelHelperRemoval = !0, this.instance.options.revert = !1, this.instance._trigger("out", t, this.instance._uiHash(this.instance)), this.instance._mouseStop(t, !0), this.instance.options.helper = this.instance.options._helper, this.instance.currentItem.remove(), this.instance.placeholder && this.instance.placeholder.remove(), r._trigger("fromSortable", t), r.dropped = !1)
            })
        }}), e.ui.plugin.add("draggable", "cursor", {start: function() {
            var t = e("body"), n = e(this).data("draggable").options;
            t.css("cursor") && (n._cursor = t.css("cursor")), t.css("cursor", n.cursor)
        },stop: function() {
            var t = e(this).data("draggable").options;
            t._cursor && e("body").css("cursor", t._cursor)
        }}), e.ui.plugin.add("draggable", "opacity", {start: function(t, n) {
            t = e(n.helper), n = e(this).data("draggable").options, t.css("opacity") && (n._opacity = t.css("opacity")), t.css("opacity", n.opacity)
        },stop: function(t, n) {
            t = e(this).data("draggable").options, t._opacity && e(n.helper).css("opacity", t._opacity)
        }}), e.ui.plugin.add("draggable", "scroll", {start: function() {
            var t = e(this).data("draggable");
            t.scrollParent[0] != document && t.scrollParent[0].tagName != "HTML" && (t.overflowOffset = t.scrollParent.offset())
        },drag: function(t) {
            var n = e(this).data("draggable"), r = n.options, i = !1;
            if (n.scrollParent[0] != document && n.scrollParent[0].tagName != "HTML") {
                if (!r.axis || r.axis != "x")
                    n.overflowOffset.top + n.scrollParent[0].offsetHeight - t.pageY < r.scrollSensitivity ? n.scrollParent[0].scrollTop = i = n.scrollParent[0].scrollTop + r.scrollSpeed : t.pageY - n.overflowOffset.top < r.scrollSensitivity && (n.scrollParent[0].scrollTop = i = n.scrollParent[0].scrollTop - r.scrollSpeed);
                if (!r.axis || r.axis != "y")
                    n.overflowOffset.left + n.scrollParent[0].offsetWidth - t.pageX < r.scrollSensitivity ? n.scrollParent[0].scrollLeft = i = n.scrollParent[0].scrollLeft + r.scrollSpeed : t.pageX - n.overflowOffset.left < r.scrollSensitivity && (n.scrollParent[0].scrollLeft = i = n.scrollParent[0].scrollLeft - r.scrollSpeed)
            } else {
                if (!r.axis || r.axis != "x")
                    t.pageY - e(document).scrollTop() < r.scrollSensitivity ? i = e(document).scrollTop(e(document).scrollTop() - r.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < r.scrollSensitivity && (i = e(document).scrollTop(e(document).scrollTop() + r.scrollSpeed));
                if (!r.axis || r.axis != "y")
                    t.pageX - e(document).scrollLeft() < r.scrollSensitivity ? i = e(document).scrollLeft(e(document).scrollLeft() - r.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < r.scrollSensitivity && (i = e(document).scrollLeft(e(document).scrollLeft() + r.scrollSpeed))
            }
            i !== !1 && e.ui.ddmanager && !r.dropBehaviour && e.ui.ddmanager.prepareOffsets(n, t)
        }}), e.ui.plugin.add("draggable", "snap", {start: function() {
            var t = e(this).data("draggable"), n = t.options;
            t.snapElements = [], e(n.snap.constructor != String ? n.snap.items || ":data(draggable)" : n.snap).each(function() {
                var n = e(this), r = n.offset();
                this != t.element[0] && t.snapElements.push({item: this,width: n.outerWidth(),height: n.outerHeight(),top: r.top,left: r.left})
            })
        },drag: function(t, n) {
            for (var r = e(this).data("draggable"), i = r.options, s = i.snapTolerance, o = n.offset.left, u = o + r.helperProportions.width, a = n.offset.top, f = a + r.helperProportions.height, l = r.snapElements.length - 1; l >= 0; l--) {
                var c = r.snapElements[l].left, h = c + r.snapElements[l].width, p = r.snapElements[l].top, v = p + r.snapElements[l].height;
                if (c - s < o && o < h + s && p - s < a && a < v + s || c - s < o && o < h + s && p - s < f && f < v + s || c - s < u && u < h + s && p - s < a && a < v + s || c - s < u && u < h + s && p - s < f && f < v + s) {
                    if (i.snapMode != "inner") {
                        var m = Math.abs(p - f) <= s, g = Math.abs(v - a) <= s, y = Math.abs(c - u) <= s, b = Math.abs(h - o) <= s;
                        m && (n.position.top = r._convertPositionTo("relative", {top: p - r.helperProportions.height,left: 0}).top - r.margins.top), g && (n.position.top = r._convertPositionTo("relative", {top: v,left: 0}).top - r.margins.top), y && (n.position.left = r._convertPositionTo("relative", {top: 0,left: c - r.helperProportions.width}).left - r.margins.left), b && (n.position.left = r._convertPositionTo("relative", {top: 0,left: h}).left - r.margins.left)
                    }
                    var w = m || g || y || b;
                    i.snapMode != "outer" && (m = Math.abs(p - a) <= s, g = Math.abs(v - f) <= s, y = Math.abs(c - o) <= s, b = Math.abs(h - u) <= s, m && (n.position.top = r._convertPositionTo("relative", {top: p,left: 0}).top - r.margins.top), g && (n.position.top = r._convertPositionTo("relative", {top: v - r.helperProportions.height,left: 0}).top - r.margins.top), y && (n.position.left = r._convertPositionTo("relative", {top: 0,left: c}).left - r.margins.left), b && (n.position.left = r._convertPositionTo("relative", {top: 0,left: h - r.helperProportions.width}).left - r.margins.left)), !r.snapElements[l].snapping && (m || g || y || b || w) && r.options.snap.snap && r.options.snap.snap.call(r.element, t, e.extend(r._uiHash(), {snapItem: r.snapElements[l].item})), r.snapElements[l].snapping = m || g || y || b || w
                } else
                    r.snapElements[l].snapping && r.options.snap.release && r.options.snap.release.call(r.element, t, e.extend(r._uiHash(), {snapItem: r.snapElements[l].item})), r.snapElements[l].snapping = !1
            }
        }}), e.ui.plugin.add("draggable", "stack", {start: function() {
            var t = e(this).data("draggable").options;
            t = e.makeArray(e(t.stack)).sort(function(t, n) {
                return (parseInt(e(t).css("zIndex"), 10) || 0) - (parseInt(e(n).css("zIndex"), 10) || 0)
            });
            if (t.length) {
                var n = parseInt(t[0].style.zIndex) || 0;
                e(t).each(function(e) {
                    this.style.zIndex = n + e
                }), this[0].style.zIndex = n + t.length
            }
        }}), e.ui.plugin.add("draggable", "zIndex", {start: function(t, n) {
            t = e(n.helper), n = e(this).data("draggable").options, t.css("zIndex") && (n._zIndex = t.css("zIndex")), t.css("zIndex", n.zIndex)
        },stop: function(t, n) {
            t = e(this).data("draggable").options, t._zIndex && e(n.helper).css("zIndex", t._zIndex)
        }})
}(jQuery), function(e) {
    e.widget("ui.droppable", {widgetEventPrefix: "drop",options: {accept: "*",activeClass: !1,addClasses: !0,greedy: !1,hoverClass: !1,scope: "default",tolerance: "intersect"},_create: function() {
            var t = this.options, n = t.accept;
            this.isover = 0, this.isout = 1, this.accept = e.isFunction(n) ? n : function(e) {
                return e.is(n)
            }, this.proportions = {width: this.element[0].offsetWidth,height: this.element[0].offsetHeight}, e.ui.ddmanager.droppables[t.scope] = e.ui.ddmanager.droppables[t.scope] || [], e.ui.ddmanager.droppables[t.scope].push(this), t.addClasses && this.element.addClass("ui-droppable")
        },destroy: function() {
            for (var t = e.ui.ddmanager.droppables[this.options.scope], n = 0; n < t.length; n++)
                t[n] == this && t.splice(n, 1);
            return this.element.removeClass("ui-droppable ui-droppable-disabled").removeData("droppable").unbind(".droppable"), this
        },_setOption: function(t, n) {
            t == "accept" && (this.accept = e.isFunction(n) ? n : function(e) {
                return e.is(n)
            }), e.Widget.prototype._setOption.apply(this, arguments)
        },_activate: function(t) {
            var n = e.ui.ddmanager.current;
            this.options.activeClass && this.element.addClass(this.options.activeClass), n && this._trigger("activate", t, this.ui(n))
        },_deactivate: function(t) {
            var n = e.ui.ddmanager.current;
            this.options.activeClass && this.element.removeClass(this.options.activeClass), n && this._trigger("deactivate", t, this.ui(n))
        },_over: function(t) {
            var n = e.ui.ddmanager.current;
            !!n && (n.currentItem || n.element)[0] != this.element[0] && this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.addClass(this.options.hoverClass), this._trigger("over", t, this.ui(n)))
        },_out: function(t) {
            var n = e.ui.ddmanager.current;
            !!n && (n.currentItem || n.element)[0] != this.element[0] && this.accept.call(this.element[0], n.currentItem || n.element) && (this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("out", t, this.ui(n)))
        },_drop: function(t, n) {
            var r = n || e.ui.ddmanager.current;
            if (!r || (r.currentItem || r.element)[0] == this.element[0])
                return !1;
            var i = !1;
            return this.element.find(":data(droppable)").not(".ui-draggable-dragging").each(function() {
                var t = e.data(this, "droppable");
                if (t.options.greedy && !t.options.disabled && t.options.scope == r.options.scope && t.accept.call(t.element[0], r.currentItem || r.element) && e.ui.intersect(r, e.extend(t, {offset: t.element.offset()}), t.options.tolerance))
                    return i = !0, !1
            }), i ? !1 : this.accept.call(this.element[0], r.currentItem || r.element) ? (this.options.activeClass && this.element.removeClass(this.options.activeClass), this.options.hoverClass && this.element.removeClass(this.options.hoverClass), this._trigger("drop", t, this.ui(r)), this.element) : !1
        },ui: function(e) {
            return {draggable: e.currentItem || e.element,helper: e.helper,position: e.position,offset: e.positionAbs}
        }}), e.extend(e.ui.droppable, {version: "1.8.16"}), e.ui.intersect = function(t, n, r) {
        if (!n.offset)
            return !1;
        var i = (t.positionAbs || t.position.absolute).left, s = i + t.helperProportions.width, o = (t.positionAbs || t.position.absolute).top, u = o + t.helperProportions.height, a = n.offset.left, f = a + n.proportions.width, l = n.offset.top, c = l + n.proportions.height;
        switch (r) {
            case "fit":
                return a <= i && s <= f && l <= o && u <= c;
            case "intersect":
                return a < i + t.helperProportions.width / 2 && s - t.helperProportions.width / 2 < f && l < o + t.helperProportions.height / 2 && u - t.helperProportions.height / 2 < c;
            case "pointer":
                return e.ui.isOver((t.positionAbs || t.position.absolute).top + (t.clickOffset || t.offset.click).top, (t.positionAbs || t.position.absolute).left + (t.clickOffset || t.offset.click).left, l, a, n.proportions.height, n.proportions.width);
            case "touch":
                return (o >= l && o <= c || u >= l && u <= c || o < l && u > c) && (i >= a && i <= f || s >= a && s <= f || i < a && s > f);
            default:
                return !1
        }
    }, e.ui.ddmanager = {current: null,droppables: {"default": []},prepareOffsets: function(t, n) {
            var r = e.ui.ddmanager.droppables[t.options.scope] || [], i = n ? n.type : null, s = (t.currentItem || t.element).find(":data(droppable)").andSelf(), o = 0;
            e: for (; o < r.length; o++)
                if (!(r[o].options.disabled || t && !r[o].accept.call(r[o].element[0], t.currentItem || t.element))) {
                    for (var u = 0; u < s.length; u++)
                        if (s[u] == r[o].element[0]) {
                            r[o].proportions.height = 0;
                            continue e
                        }
                    r[o].visible = r[o].element.css("display") != "none", r[o].visible && (i == "mousedown" && r[o]._activate.call(r[o], n), r[o].offset = r[o].element.offset(), r[o].proportions = {width: r[o].element[0].offsetWidth,height: r[o].element[0].offsetHeight})
                }
        },drop: function(t, n) {
            var r = !1;
            return e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
                this.options && (!this.options.disabled && this.visible && e.ui.intersect(t, this, this.options.tolerance) && (r = r || this._drop.call(this, n)), !this.options.disabled && this.visible && this.accept.call(this.element[0], t.currentItem || t.element) && (this.isout = 1, this.isover = 0, this._deactivate.call(this, n)))
            }), r
        },dragStart: function(t, n) {
            t.element.parents(":not(body,html)").bind("scroll.droppable", function() {
                t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
            })
        },drag: function(t, n) {
            t.options.refreshPositions && e.ui.ddmanager.prepareOffsets(t, n), e.each(e.ui.ddmanager.droppables[t.options.scope] || [], function() {
                if (!(this.options.disabled || this.greedyChild || !this.visible)) {
                    var r = e.ui.intersect(t, this, this.options.tolerance);
                    if (r = !r && this.isover == 1 ? "isout" : r && this.isover == 0 ? "isover" : null) {
                        var i;
                        if (this.options.greedy) {
                            var s = this.element.parents(":data(droppable):eq(0)");
                            s.length && (i = e.data(s[0], "droppable"), i.greedyChild = r == "isover" ? 1 : 0)
                        }
                        i && r == "isover" && (i.isover = 0, i.isout = 1, i._out.call(i, n)), this[r] = 1, this[r == "isout" ? "isover" : "isout"] = 0, this[r == "isover" ? "_over" : "_out"].call(this, n), i && r == "isout" && (i.isout = 0, i.isover = 1, i._over.call(i, n))
                    }
                }
            })
        },dragStop: function(t, n) {
            t.element.parents(":not(body,html)").unbind("scroll.droppable"), t.options.refreshPositions || e.ui.ddmanager.prepareOffsets(t, n)
        }}
}(jQuery), function(e) {
    e.widget("ui.resizable", e.ui.mouse, {widgetEventPrefix: "resize",options: {alsoResize: !1,animate: !1,animateDuration: "slow",animateEasing: "swing",aspectRatio: !1,autoHide: !1,containment: !1,ghost: !1,grid: !1,handles: "e,s,se",helper: !1,maxHeight: null,maxWidth: null,minHeight: 10,minWidth: 10,zIndex: 1e3},_create: function() {
            var t = this, n = this.options;
            this.element.addClass("ui-resizable"), e.extend(this, {_aspectRatio: !!n.aspectRatio,aspectRatio: n.aspectRatio,originalElement: this.element,_proportionallyResizeElements: [],_helper: n.helper || n.ghost || n.animate ? n.helper || "ui-resizable-helper" : null}), this.element[0].nodeName.match(/canvas|textarea|input|select|button|img/i) && (/relative/.test(this.element.css("position")) && e.browser.opera && this.element.css({position: "relative",top: "auto",left: "auto"}), this.element.wrap(e('<div class="ui-wrapper" style="overflow: hidden;"></div>').css({position: this.element.css("position"),width: this.element.outerWidth(),height: this.element.outerHeight(),top: this.element.css("top"),left: this.element.css("left")})), this.element = this.element.parent().data("resizable", this.element.data("resizable")), this.elementIsWrapper = !0, this.element.css({marginLeft: this.originalElement.css("marginLeft"),marginTop: this.originalElement.css("marginTop"),marginRight: this.originalElement.css("marginRight"),marginBottom: this.originalElement.css("marginBottom")}), this.originalElement.css({marginLeft: 0,marginTop: 0,marginRight: 0,marginBottom: 0}), this.originalResizeStyle = this.originalElement.css("resize"), this.originalElement.css("resize", "none"), this._proportionallyResizeElements.push(this.originalElement.css({position: "static",zoom: 1,display: "block"})), this.originalElement.css({margin: this.originalElement.css("margin")}), this._proportionallyResize()), this.handles = n.handles || (e(".ui-resizable-handle", this.element).length ? {n: ".ui-resizable-n",e: ".ui-resizable-e",s: ".ui-resizable-s",w: ".ui-resizable-w",se: ".ui-resizable-se",sw: ".ui-resizable-sw",ne: ".ui-resizable-ne",nw: ".ui-resizable-nw"} : "e,s,se");
            if (this.handles.constructor == String) {
                this.handles == "all" && (this.handles = "n,e,s,w,se,sw,ne,nw");
                var r = this.handles.split(",");
                this.handles = {};
                for (var i = 0; i < r.length; i++) {
                    var s = e.trim(r[i]), o = e('<div class="ui-resizable-handle ' + ("ui-resizable-" + s) + '"></div>');
                    /sw|se|ne|nw/.test(s) && o.css({zIndex: ++n.zIndex}), "se" == s && o.addClass("ui-icon ui-icon-gripsmall-diagonal-se"), this.handles[s] = ".ui-resizable-" + s, this.element.append(o)
                }
            }
            this._renderAxis = function(t) {
                t = t || this.element;
                for (var n in this.handles) {
                    this.handles[n].constructor == String && (this.handles[n] = e(this.handles[n], this.element).show());
                    if (this.elementIsWrapper && this.originalElement[0].nodeName.match(/textarea|input|select|button/i)) {
                        var r = e(this.handles[n], this.element), i = 0;
                        i = /sw|ne|nw|se|n|s/.test(n) ? r.outerHeight() : r.outerWidth(), r = ["padding", /ne|nw|n/.test(n) ? "Top" : /se|sw|s/.test(n) ? "Bottom" : /^e$/.test(n) ? "Right" : "Left"].join(""), t.css(r, i), this._proportionallyResize()
                    }
                    e(this.handles[n])
                }
            }, this._renderAxis(this.element), this._handles = e(".ui-resizable-handle", this.element).disableSelection(), this._handles.mouseover(function() {
                if (!t.resizing) {
                    if (this.className)
                        var e = this.className.match(/ui-resizable-(se|sw|ne|nw|n|e|s|w)/i);
                    t.axis = e && e[1] ? e[1] : "se"
                }
            }), n.autoHide && (this._handles.hide(), e(this.element).addClass("ui-resizable-autohide").hover(function() {
                n.disabled || (e(this).removeClass("ui-resizable-autohide"), t._handles.show())
            }, function() {
                n.disabled || t.resizing || (e(this).addClass("ui-resizable-autohide"), t._handles.hide())
            })), this._mouseInit()
        },destroy: function() {
            this._mouseDestroy();
            var t = function(t) {
                e(t).removeClass("ui-resizable ui-resizable-disabled ui-resizable-resizing").removeData("resizable").unbind(".resizable").find(".ui-resizable-handle").remove()
            };
            if (this.elementIsWrapper) {
                t(this.element);
                var n = this.element;
                n.after(this.originalElement.css({position: n.css("position"),width: n.outerWidth(),height: n.outerHeight(),top: n.css("top"),left: n.css("left")})).remove()
            }
            return this.originalElement.css("resize", this.originalResizeStyle), t(this.originalElement), this
        },_mouseCapture: function(t) {
            var n = !1;
            for (var r in this.handles)
                e(this.handles[r])[0] == t.target && (n = !0);
            return !this.options.disabled && n
        },_mouseStart: function(n) {
            var r = this.options, i = this.element.position(), s = this.element;
            this.resizing = !0, this.documentScroll = {top: e(document).scrollTop(),left: e(document).scrollLeft()}, (s.is(".ui-draggable") || /absolute/.test(s.css("position"))) && s.css({position: "absolute",top: i.top,left: i.left}), e.browser.opera && /relative/.test(s.css("position")) && s.css({position: "relative",top: "auto",left: "auto"}), this._renderProxy(), i = t(this.helper.css("left"));
            var o = t(this.helper.css("top"));
            return r.containment && (i += e(r.containment).scrollLeft() || 0, o += e(r.containment).scrollTop() || 0), this.offset = this.helper.offset(), this.position = {left: i,top: o}, this.size = this._helper ? {width: s.outerWidth(),height: s.outerHeight()} : {width: s.width(),height: s.height()}, this.originalSize = this._helper ? {width: s.outerWidth(),height: s.outerHeight()} : {width: s.width(),height: s.height()}, this.originalPosition = {left: i,top: o}, this.sizeDiff = {width: s.outerWidth() - s.width(),height: s.outerHeight() - s.height()}, this.originalMousePosition = {left: n.pageX,top: n.pageY}, this.aspectRatio = typeof r.aspectRatio == "number" ? r.aspectRatio : this.originalSize.width / this.originalSize.height || 1, r = e(".ui-resizable-" + this.axis).css("cursor"), e("body").css("cursor", r == "auto" ? this.axis + "-resize" : r), s.addClass("ui-resizable-resizing"), this._propagate("start", n), !0
        },_mouseDrag: function(e) {
            var t = this.helper, n = this.originalMousePosition, r = this._change[this.axis];
            if (!r)
                return !1;
            n = r.apply(this, [e, e.pageX - n.left || 0, e.pageY - n.top || 0]), this._updateVirtualBoundaries(e.shiftKey);
            if (this._aspectRatio || e.shiftKey)
                n = this._updateRatio(n, e);
            return n = this._respectSize(n, e), this._propagate("resize", e), t.css({top: this.position.top + "px",left: this.position.left + "px",width: this.size.width + "px",height: this.size.height + "px"}), !this._helper && this._proportionallyResizeElements.length && this._proportionallyResize(), this._updateCache(n), this._trigger("resize", e, this.ui()), !1
        },_mouseStop: function(t) {
            this.resizing = !1;
            var n = this.options, r = this;
            if (this._helper) {
                var i = this._proportionallyResizeElements, s = i.length && /textarea/i.test(i[0].nodeName);
                i = s && e.ui.hasScroll(i[0], "left") ? 0 : r.sizeDiff.height, s = s ? 0 : r.sizeDiff.width, s = {width: r.helper.width() - s,height: r.helper.height() - i}, i = parseInt(r.element.css("left"), 10) + (r.position.left - r.originalPosition.left) || null;
                var o = parseInt(r.element.css("top"), 10) + (r.position.top - r.originalPosition.top) || null;
                n.animate || this.element.css(e.extend(s, {top: o,left: i})), r.helper.height(r.size.height), r.helper.width(r.size.width), this._helper && !n.animate && this._proportionallyResize()
            }
            return e("body").css("cursor", "auto"), this.element.removeClass("ui-resizable-resizing"), this._propagate("stop", t), this._helper && this.helper.remove(), !1
        },_updateVirtualBoundaries: function(e) {
            var t = this.options, r, i, s;
            t = {minWidth: n(t.minWidth) ? t.minWidth : 0,maxWidth: n(t.maxWidth) ? t.maxWidth : Infinity,minHeight: n(t.minHeight) ? t.minHeight : 0,maxHeight: n(t.maxHeight) ? t.maxHeight : Infinity};
            if (this._aspectRatio || e)
                e = t.minHeight * this.aspectRatio, i = t.minWidth / this.aspectRatio, r = t.maxHeight * this.aspectRatio, s = t.maxWidth / this.aspectRatio, e > t.minWidth && (t.minWidth = e), i > t.minHeight && (t.minHeight = i), r < t.maxWidth && (t.maxWidth = r), s < t.maxHeight && (t.maxHeight = s);
            this._vBoundaries = t
        },_updateCache: function(e) {
            this.offset = this.helper.offset(), n(e.left) && (this.position.left = e.left), n(e.top) && (this.position.top = e.top), n(e.height) && (this.size.height = e.height), n(e.width) && (this.size.width = e.width)
        },_updateRatio: function(e) {
            var t = this.position, r = this.size, i = this.axis;
            return n(e.height) ? e.width = e.height * this.aspectRatio : n(e.width) && (e.height = e.width / this.aspectRatio), i == "sw" && (e.left = t.left + (r.width - e.width), e.top = null), i == "nw" && (e.top = t.top + (r.height - e.height), e.left = t.left + (r.width - e.width)), e
        },_respectSize: function(e) {
            var t = this._vBoundaries, r = this.axis, i = n(e.width) && t.maxWidth && t.maxWidth < e.width, s = n(e.height) && t.maxHeight && t.maxHeight < e.height, o = n(e.width) && t.minWidth && t.minWidth > e.width, u = n(e.height) && t.minHeight && t.minHeight > e.height;
            o && (e.width = t.minWidth), u && (e.height = t.minHeight), i && (e.width = t.maxWidth), s && (e.height = t.maxHeight);
            var a = this.originalPosition.left + this.originalSize.width, f = this.position.top + this.size.height, l = /sw|nw|w/.test(r);
            return r = /nw|ne|n/.test(r), o && l && (e.left = a - t.minWidth), i && l && (e.left = a - t.maxWidth), u && r && (e.top = f - t.minHeight), s && r && (e.top = f - t.maxHeight), (t = !e.width && !e.height) && !e.left && e.top ? e.top = null : t && !e.top && e.left && (e.left = null), e
        },_proportionallyResize: function() {
            if (this._proportionallyResizeElements.length)
                for (var t = this.helper || this.element, n = 0; n < this._proportionallyResizeElements.length; n++) {
                    var r = this._proportionallyResizeElements[n];
                    if (!this.borderDif) {
                        var i = [r.css("borderTopWidth"), r.css("borderRightWidth"), r.css("borderBottomWidth"), r.css("borderLeftWidth")], s = [r.css("paddingTop"), r.css("paddingRight"), r.css("paddingBottom"), r.css("paddingLeft")];
                        this.borderDif = e.map(i, function(e, t) {
                            return e = parseInt(e, 10) || 0, t = parseInt(s[t], 10) || 0, e + t
                        })
                    }
                    e.browser.msie && (e(t).is(":hidden") || e(t).parents(":hidden").length) || r.css({height: t.height() - this.borderDif[0] - this.borderDif[2] || 0,width: t.width() - this.borderDif[1] - this.borderDif[3] || 0})
                }
        },_renderProxy: function() {
            var t = this.options;
            this.elementOffset = this.element.offset();
            if (this._helper) {
                this.helper = this.helper || e('<div style="overflow:hidden;"></div>');
                var n = e.browser.msie && e.browser.version < 7, r = n ? 1 : 0;
                n = n ? 2 : -1, this.helper.addClass(this._helper).css({width: this.element.outerWidth() + n,height: this.element.outerHeight() + n,position: "absolute",left: this.elementOffset.left - r + "px",top: this.elementOffset.top - r + "px",zIndex: ++t.zIndex}), this.helper.appendTo("body").disableSelection()
            } else
                this.helper = this.element
        },_change: {e: function(e, t) {
                return {width: this.originalSize.width + t}
            },w: function(e, t) {
                return {left: this.originalPosition.left + t,width: this.originalSize.width - t}
            },n: function(e, t, n) {
                return {top: this.originalPosition.top + n,height: this.originalSize.height - n}
            },s: function(e, t, n) {
                return {height: this.originalSize.height + n}
            },se: function(t, n, r) {
                return e.extend(this._change.s.apply(this, arguments), this._change.e.apply(this, [t, n, r]))
            },sw: function(t, n, r) {
                return e.extend(this._change.s.apply(this, arguments), this._change.w.apply(this, [t, n, r]))
            },ne: function(t, n, r) {
                return e.extend(this._change.n.apply(this, arguments), this._change.e.apply(this, [t, n, r]))
            },nw: function(t, n, r) {
                return e.extend(this._change.n.apply(this, arguments), this._change.w.apply(this, [t, n, r]))
            }},_propagate: function(t, n) {
            e.ui.plugin.call(this, t, [n, this.ui()]), t != "resize" && this._trigger(t, n, this.ui())
        },plugins: {},ui: function() {
            return {originalElement: this.originalElement,element: this.element,helper: this.helper,position: this.position,size: this.size,originalSize: this.originalSize,originalPosition: this.originalPosition}
        }}), e.extend(e.ui.resizable, {version: "1.8.16"}), e.ui.plugin.add("resizable", "alsoResize", {start: function() {
            var t = e(this).data("resizable").options, n = function(t) {
                e(t).each(function() {
                    var t = e(this);
                    t.data("resizable-alsoresize", {width: parseInt(t.width(), 10),height: parseInt(t.height(), 10),left: parseInt(t.css("left"), 10),top: parseInt(t.css("top"), 10),position: t.css("position")})
                })
            };
            typeof t.alsoResize == "object" && !t.alsoResize.parentNode ? t.alsoResize.length ? (t.alsoResize = t.alsoResize[0], n(t.alsoResize)) : e.each(t.alsoResize, function(e) {
                n(e)
            }) : n(t.alsoResize)
        },resize: function(t, n) {
            var r = e(this).data("resizable");
            t = r.options;
            var i = r.originalSize, s = r.originalPosition, o = {height: r.size.height - i.height || 0,width: r.size.width - i.width || 0,top: r.position.top - s.top || 0,left: r.position.left - s.left || 0}, u = function(t, i) {
                e(t).each(function() {
                    var t = e(this), s = e(this).data("resizable-alsoresize"), u = {}, f = i && i.length ? i : t.parents(n.originalElement[0]).length ? ["width", "height"] : ["width", "height", "top", "left"];
                    e.each(f, function(e, t) {
                        (e = (s[t] || 0) + (o[t] || 0)) && e >= 0 && (u[t] = e || null)
                    }), e.browser.opera && /relative/.test(t.css("position")) && (r._revertToRelativePosition = !0, t.css({position: "absolute",top: "auto",left: "auto"})), t.css(u)
                })
            };
            typeof t.alsoResize == "object" && !t.alsoResize.nodeType ? e.each(t.alsoResize, function(e, t) {
                u(e, t)
            }) : u(t.alsoResize)
        },stop: function() {
            var t = e(this).data("resizable"), n = t.options, r = function(t) {
                e(t).each(function() {
                    var t = e(this);
                    t.css({position: t.data("resizable-alsoresize").position})
                })
            };
            t._revertToRelativePosition && (t._revertToRelativePosition = !1, typeof n.alsoResize == "object" && !n.alsoResize.nodeType ? e.each(n.alsoResize, function(e) {
                r(e)
            }) : r(n.alsoResize)), e(this).removeData("resizable-alsoresize")
        }}), e.ui.plugin.add("resizable", "animate", {stop: function(t) {
            var n = e(this).data("resizable"), r = n.options, i = n._proportionallyResizeElements, s = i.length && /textarea/i.test(i[0].nodeName), o = s && e.ui.hasScroll(i[0], "left") ? 0 : n.sizeDiff.height;
            s = {width: n.size.width - (s ? 0 : n.sizeDiff.width),height: n.size.height - o}, o = parseInt(n.element.css("left"), 10) + (n.position.left - n.originalPosition.left) || null;
            var u = parseInt(n.element.css("top"), 10) + (n.position.top - n.originalPosition.top) || null;
            n.element.animate(e.extend(s, u && o ? {top: u,left: o} : {}), {duration: r.animateDuration,easing: r.animateEasing,step: function() {
                    var r = {width: parseInt(n.element.css("width"), 10),height: parseInt(n.element.css("height"), 10),top: parseInt(n.element.css("top"), 10),left: parseInt(n.element.css("left"), 10)};
                    i && i.length && e(i[0]).css({width: r.width,height: r.height}), n._updateCache(r), n._propagate("resize", t)
                }})
        }}), e.ui.plugin.add("resizable", "containment", {start: function() {
            var n = e(this).data("resizable"), r = n.element, i = n.options.containment;
            if (r = i instanceof e ? i.get(0) : /parent/.test(i) ? r.parent().get(0) : i) {
                n.containerElement = e(r);
                if (/document/.test(i) || i == document)
                    n.containerOffset = {left: 0,top: 0}, n.containerPosition = {left: 0,top: 0}, n.parentData = {element: e(document),left: 0,top: 0,width: e(document).width(),height: e(document).height() || document.body.parentNode.scrollHeight};
                else {
                    var s = e(r), o = [];
                    e(["Top", "Right", "Left", "Bottom"]).each(function(e, n) {
                        o[e] = t(s.css("padding" + n))
                    }), n.containerOffset = s.offset(), n.containerPosition = s.position(), n.containerSize = {height: s.innerHeight() - o[3],width: s.innerWidth() - o[1]}, i = n.containerOffset;
                    var u = n.containerSize.height, a = n.containerSize.width;
                    a = e.ui.hasScroll(r, "left") ? r.scrollWidth : a, u = e.ui.hasScroll(r) ? r.scrollHeight : u, n.parentData = {element: r,left: i.left,top: i.top,width: a,height: u}
                }
            }
        },resize: function(t) {
            var n = e(this).data("resizable"), r = n.options, i = n.containerOffset, s = n.position;
            t = n._aspectRatio || t.shiftKey;
            var o = {top: 0,left: 0}, u = n.containerElement;
            u[0] != document && /static/.test(u.css("position")) && (o = i), s.left < (n._helper ? i.left : 0) && (n.size.width += n._helper ? n.position.left - i.left : n.position.left - o.left, t && (n.size.height = n.size.width / r.aspectRatio), n.position.left = r.helper ? i.left : 0), s.top < (n._helper ? i.top : 0) && (n.size.height += n._helper ? n.position.top - i.top : n.position.top, t && (n.size.width = n.size.height * r.aspectRatio), n.position.top = n._helper ? i.top : 0), n.offset.left = n.parentData.left + n.position.left, n.offset.top = n.parentData.top + n.position.top, r = Math.abs((n._helper ? n.offset.left - o.left : n.offset.left - o.left) + n.sizeDiff.width), i = Math.abs((n._helper ? n.offset.top - o.top : n.offset.top - i.top) + n.sizeDiff.height), s = n.containerElement.get(0) == n.element.parent().get(0), o = /relative|absolute/.test(n.containerElement.css("position")), s && o && (r -= n.parentData.left), r + n.size.width >= n.parentData.width && (n.size.width = n.parentData.width - r, t && (n.size.height = n.size.width / n.aspectRatio)), i + n.size.height >= n.parentData.height && (n.size.height = n.parentData.height - i, t && (n.size.width = n.size.height * n.aspectRatio))
        },stop: function() {
            var t = e(this).data("resizable"), n = t.options, r = t.containerOffset, i = t.containerPosition, s = t.containerElement, o = e(t.helper), u = o.offset(), a = o.outerWidth() - t.sizeDiff.width;
            o = o.outerHeight() - t.sizeDiff.height, t._helper && !n.animate && /relative/.test(s.css("position")) && e(this).css({left: u.left - i.left - r.left,width: a,height: o}), t._helper && !n.animate && /static/.test(s.css("position")) && e(this).css({left: u.left - i.left - r.left,width: a,height: o})
        }}), e.ui.plugin.add("resizable", "ghost", {start: function() {
            var t = e(this).data("resizable"), n = t.options, r = t.size;
            t.ghost = t.originalElement.clone(), t.ghost.css({opacity: .25,display: "block",position: "relative",height: r.height,width: r.width,margin: 0,left: 0,top: 0}).addClass("ui-resizable-ghost").addClass(typeof n.ghost == "string" ? n.ghost : ""), t.ghost.appendTo(t.helper)
        },resize: function() {
            var t = e(this).data("resizable");
            t.ghost && t.ghost.css({position: "relative",height: t.size.height,width: t.size.width})
        },stop: function() {
            var t = e(this).data("resizable");
            t.ghost && t.helper && t.helper.get(0).removeChild(t.ghost.get(0))
        }}), e.ui.plugin.add("resizable", "grid", {resize: function() {
            var t = e(this).data("resizable"), n = t.options, r = t.size, i = t.originalSize, s = t.originalPosition, o = t.axis;
            n.grid = typeof n.grid == "number" ? [n.grid, n.grid] : n.grid;
            var u = Math.round((r.width - i.width) / (n.grid[0] || 1)) * (n.grid[0] || 1);
            n = Math.round((r.height - i.height) / (n.grid[1] || 1)) * (n.grid[1] || 1), /^(se|s|e)$/.test(o) ? (t.size.width = i.width + u, t.size.height = i.height + n) : /^(ne)$/.test(o) ? (t.size.width = i.width + u, t.size.height = i.height + n, t.position.top = s.top - n) : (/^(sw)$/.test(o) ? (t.size.width = i.width + u, t.size.height = i.height + n) : (t.size.width = i.width + u, t.size.height = i.height + n, t.position.top = s.top - n), t.position.left = s.left - u)
        }});
    var t = function(e) {
        return parseInt(e, 10) || 0
    }, n = function(e) {
        return !isNaN(parseInt(e, 10))
    }
}(jQuery), function(e) {
    e.widget("ui.selectable", e.ui.mouse, {options: {appendTo: "body",autoRefresh: !0,distance: 0,filter: "*",tolerance: "touch"},_create: function() {
            var t = this;
            this.element.addClass("ui-selectable"), this.dragged = !1;
            var n;
            this.refresh = function() {
                n = e(t.options.filter, t.element[0]), n.each(function() {
                    var t = e(this), n = t.offset();
                    e.data(this, "selectable-item", {element: this,$element: t,left: n.left,top: n.top,right: n.left + t.outerWidth(),bottom: n.top + t.outerHeight(),startselected: !1,selected: t.hasClass("ui-selected"),selecting: t.hasClass("ui-selecting"),unselecting: t.hasClass("ui-unselecting")})
                })
            }, this.refresh(), this.selectees = n.addClass("ui-selectee"), this._mouseInit(), this.helper = e("<div class='ui-selectable-helper'></div>")
        },destroy: function() {
            return this.selectees.removeClass("ui-selectee").removeData("selectable-item"), this.element.removeClass("ui-selectable ui-selectable-disabled").removeData("selectable").unbind(".selectable"), this._mouseDestroy(), this
        },_mouseStart: function(t) {
            var n = this;
            this.opos = [t.pageX, t.pageY];
            if (!this.options.disabled) {
                var r = this.options;
                this.selectees = e(r.filter, this.element[0]), this._trigger("start", t), e(r.appendTo).append(this.helper), this.helper.css({left: t.clientX,top: t.clientY,width: 0,height: 0}), r.autoRefresh && this.refresh(), this.selectees.filter(".ui-selected").each(function() {
                    var r = e.data(this, "selectable-item");
                    r.startselected = !0, t.metaKey || (r.$element.removeClass("ui-selected"), r.selected = !1, r.$element.addClass("ui-unselecting"), r.unselecting = !0, n._trigger("unselecting", t, {unselecting: r.element}))
                }), e(t.target).parents().andSelf().each(function() {
                    var r = e.data(this, "selectable-item");
                    if (r) {
                        var i = !t.metaKey || !r.$element.hasClass("ui-selected");
                        return r.$element.removeClass(i ? "ui-unselecting" : "ui-selected").addClass(i ? "ui-selecting" : "ui-unselecting"), r.unselecting = !i, r.selecting = i, (r.selected = i) ? n._trigger("selecting", t, {selecting: r.element}) : n._trigger("unselecting", t, {unselecting: r.element}), !1
                    }
                })
            }
        },_mouseDrag: function(t) {
            var n = this;
            this.dragged = !0;
            if (!this.options.disabled) {
                var r = this.options, i = this.opos[0], s = this.opos[1], o = t.pageX, u = t.pageY;
                if (i > o) {
                    var a = o;
                    o = i, i = a
                }
                return s > u && (a = u, u = s, s = a), this.helper.css({left: i,top: s,width: o - i,height: u - s}), this.selectees.each(function() {
                    var a = e.data(this, "selectable-item");
                    if (!!a && a.element != n.element[0]) {
                        var l = !1;
                        r.tolerance == "touch" ? l = !(a.left > o || a.right < i || a.top > u || a.bottom < s) : r.tolerance == "fit" && (l = a.left > i && a.right < o && a.top > s && a.bottom < u), l ? (a.selected && (a.$element.removeClass("ui-selected"), a.selected = !1), a.unselecting && (a.$element.removeClass("ui-unselecting"), a.unselecting = !1), a.selecting || (a.$element.addClass("ui-selecting"), a.selecting = !0, n._trigger("selecting", t, {selecting: a.element}))) : (a.selecting && (t.metaKey && a.startselected ? (a.$element.removeClass("ui-selecting"), a.selecting = !1, a.$element.addClass("ui-selected"), a.selected = !0) : (a.$element.removeClass("ui-selecting"), a.selecting = !1, a.startselected && (a.$element.addClass("ui-unselecting"), a.unselecting = !0), n._trigger("unselecting", t, {unselecting: a.element}))), a.selected && !t.metaKey && !a.startselected && (a.$element.removeClass("ui-selected"), a.selected = !1, a.$element.addClass("ui-unselecting"), a.unselecting = !0, n._trigger("unselecting", t, {unselecting: a.element})))
                    }
                }), !1
            }
        },_mouseStop: function(t) {
            var n = this;
            return this.dragged = !1, e(".ui-unselecting", this.element[0]).each(function() {
                var r = e.data(this, "selectable-item");
                r.$element.removeClass("ui-unselecting"), r.unselecting = !1, r.startselected = !1, n._trigger("unselected", t, {unselected: r.element})
            }), e(".ui-selecting", this.element[0]).each(function() {
                var r = e.data(this, "selectable-item");
                r.$element.removeClass("ui-selecting").addClass("ui-selected"), r.selecting = !1, r.selected = !0, r.startselected = !0, n._trigger("selected", t, {selected: r.element})
            }), this._trigger("stop", t), this.helper.remove(), !1
        }}), e.extend(e.ui.selectable, {version: "1.8.16"})
}(jQuery), function(e) {
    e.widget("ui.sortable", e.ui.mouse, {widgetEventPrefix: "sort",options: {appendTo: "parent",axis: !1,connectWith: !1,containment: !1,cursor: "auto",cursorAt: !1,dropOnEmpty: !0,forcePlaceholderSize: !1,forceHelperSize: !1,grid: !1,handle: !1,helper: "original",items: "> *",opacity: !1,placeholder: !1,revert: !1,scroll: !0,scrollSensitivity: 20,scrollSpeed: 20,scope: "default",tolerance: "intersect",zIndex: 1e3},_create: function() {
            var e = this.options;
            this.containerCache = {}, this.element.addClass("ui-sortable"), this.refresh(), this.floating = this.items.length ? e.axis === "x" || /left|right/.test(this.items[0].item.css("float")) || /inline|table-cell/.test(this.items[0].item.css("display")) : !1, this.offset = this.element.offset(), this._mouseInit()
        },destroy: function() {
            this.element.removeClass("ui-sortable ui-sortable-disabled").removeData("sortable").unbind(".sortable"), this._mouseDestroy();
            for (var e = this.items.length - 1; e >= 0; e--)
                this.items[e].item.removeData("sortable-item");
            return this
        },_setOption: function(t, n) {
            t === "disabled" ? (this.options[t] = n, this.widget()[n ? "addClass" : "removeClass"]("ui-sortable-disabled")) : e.Widget.prototype._setOption.apply(this, arguments)
        },_mouseCapture: function(t, n) {
            if (this.reverting)
                return !1;
            if (this.options.disabled || this.options.type == "static")
                return !1;
            this._refreshItems(t);
            var r = null, i = this;
            e(t.target).parents().each(function() {
                if (e.data(this, "sortable-item") == i)
                    return r = e(this), !1
            }), e.data(t.target, "sortable-item") == i && (r = e(t.target));
            if (!r)
                return !1;
            if (this.options.handle && !n) {
                var s = !1;
                e(this.options.handle, r).find("*").andSelf().each(function() {
                    this == t.target && (s = !0)
                });
                if (!s)
                    return !1
            }
            return this.currentItem = r, this._removeCurrentsFromItems(), !0
        },_mouseStart: function(t, n, r) {
            n = this.options;
            var i = this;
            this.currentContainer = this, this.refreshPositions(), this.helper = this._createHelper(t), this._cacheHelperProportions(), this._cacheMargins(), this.scrollParent = this.helper.scrollParent(), this.offset = this.currentItem.offset(), this.offset = {top: this.offset.top - this.margins.top,left: this.offset.left - this.margins.left}, this.helper.css("position", "absolute"), this.cssPosition = this.helper.css("position"), e.extend(this.offset, {click: {left: t.pageX - this.offset.left,top: t.pageY - this.offset.top},parent: this._getParentOffset(),relative: this._getRelativeOffset()}), this.originalPosition = this._generatePosition(t), this.originalPageX = t.pageX, this.originalPageY = t.pageY, n.cursorAt && this._adjustOffsetFromHelper(n.cursorAt), this.domPosition = {prev: this.currentItem.prev()[0],parent: this.currentItem.parent()[0]}, this.helper[0] != this.currentItem[0] && this.currentItem.hide(), this._createPlaceholder(), n.containment && this._setContainment(), n.cursor && (e("body").css("cursor") && (this._storedCursor = e("body").css("cursor")), e("body").css("cursor", n.cursor)), n.opacity && (this.helper.css("opacity") && (this._storedOpacity = this.helper.css("opacity")), this.helper.css("opacity", n.opacity)), n.zIndex && (this.helper.css("zIndex") && (this._storedZIndex = this.helper.css("zIndex")), this.helper.css("zIndex", n.zIndex)), this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" && (this.overflowOffset = this.scrollParent.offset()), this._trigger("start", t, this._uiHash()), this._preserveHelperProportions || this._cacheHelperProportions();
            if (!r)
                for (r = this.containers.length - 1; r >= 0; r--)
                    this.containers[r]._trigger("activate", t, i._uiHash(this));
            return e.ui.ddmanager && (e.ui.ddmanager.current = this), e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t), this.dragging = !0, this.helper.addClass("ui-sortable-helper"), this._mouseDrag(t), !0
        },_mouseDrag: function(t) {
            this.position = this._generatePosition(t), this.positionAbs = this._convertPositionTo("absolute"), this.lastPositionAbs || (this.lastPositionAbs = this.positionAbs);
            if (this.options.scroll) {
                var n = this.options, r = !1;
                this.scrollParent[0] != document && this.scrollParent[0].tagName != "HTML" ? (this.overflowOffset.top + this.scrollParent[0].offsetHeight - t.pageY < n.scrollSensitivity ? this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop + n.scrollSpeed : t.pageY - this.overflowOffset.top < n.scrollSensitivity && (this.scrollParent[0].scrollTop = r = this.scrollParent[0].scrollTop - n.scrollSpeed), this.overflowOffset.left + this.scrollParent[0].offsetWidth - t.pageX < n.scrollSensitivity ? this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft + n.scrollSpeed : t.pageX - this.overflowOffset.left < n.scrollSensitivity && (this.scrollParent[0].scrollLeft = r = this.scrollParent[0].scrollLeft - n.scrollSpeed)) : (t.pageY - e(document).scrollTop() < n.scrollSensitivity ? r = e(document).scrollTop(e(document).scrollTop() - n.scrollSpeed) : e(window).height() - (t.pageY - e(document).scrollTop()) < n.scrollSensitivity && (r = e(document).scrollTop(e(document).scrollTop() + n.scrollSpeed)), t.pageX - e(document).scrollLeft() < n.scrollSensitivity ? r = e(document).scrollLeft(e(document).scrollLeft() - n.scrollSpeed) : e(window).width() - (t.pageX - e(document).scrollLeft()) < n.scrollSensitivity && (r = e(document).scrollLeft(e(document).scrollLeft() + n.scrollSpeed))), r !== !1 && e.ui.ddmanager && !n.dropBehaviour && e.ui.ddmanager.prepareOffsets(this, t)
            }
            this.positionAbs = this._convertPositionTo("absolute");
            if (!this.options.axis || this.options.axis != "y")
                this.helper[0].style.left = this.position.left + "px";
            if (!this.options.axis || this.options.axis != "x")
                this.helper[0].style.top = this.position.top + "px";
            for (n = this.items.length - 1; n >= 0; n--) {
                r = this.items[n];
                var i = r.item[0], s = this._intersectsWithPointer(r);
                if (s && i != this.currentItem[0] && this.placeholder[s == 1 ? "next" : "prev"]()[0] != i && !e.ui.contains(this.placeholder[0], i) && (this.options.type == "semi-dynamic" ? !e.ui.contains(this.element[0], i) : !0)) {
                    this.direction = s == 1 ? "down" : "up";
                    if (this.options.tolerance != "pointer" && !this._intersectsWithSides(r))
                        break;
                    this._rearrange(t, r), this._trigger("change", t, this._uiHash());
                    break
                }
            }
            return this._contactContainers(t), e.ui.ddmanager && e.ui.ddmanager.drag(this, t), this._trigger("sort", t, this._uiHash()), this.lastPositionAbs = this.positionAbs, !1
        },_mouseStop: function(t, n) {
            if (t) {
                e.ui.ddmanager && !this.options.dropBehaviour && e.ui.ddmanager.drop(this, t);
                if (this.options.revert) {
                    var r = this;
                    n = r.placeholder.offset(), r.reverting = !0, e(this.helper).animate({left: n.left - this.offset.parent.left - r.margins.left + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollLeft),top: n.top - this.offset.parent.top - r.margins.top + (this.offsetParent[0] == document.body ? 0 : this.offsetParent[0].scrollTop)}, parseInt(this.options.revert, 10) || 500, function() {
                        r._clear(t)
                    })
                } else
                    this._clear(t, n);
                return !1
            }
        },cancel: function() {
            var t = this;
            if (this.dragging) {
                this._mouseUp({target: null}), this.options.helper == "original" ? this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper") : this.currentItem.show();
                for (var n = this.containers.length - 1; n >= 0; n--)
                    this.containers[n]._trigger("deactivate", null, t._uiHash(this)), this.containers[n].containerCache.over && (this.containers[n]._trigger("out", null, t._uiHash(this)), this.containers[n].containerCache.over = 0)
            }
            return this.placeholder && (this.placeholder[0].parentNode && this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.options.helper != "original" && this.helper && this.helper[0].parentNode && this.helper.remove(), e.extend(this, {helper: null,dragging: !1,reverting: !1,_noFinalSort: null}), this.domPosition.prev ? e(this.domPosition.prev).after(this.currentItem) : e(this.domPosition.parent).prepend(this.currentItem)), this
        },serialize: function(t) {
            var n = this._getItemsAsjQuery(t && t.connected), r = [];
            return t = t || {}, e(n).each(function() {
                var n = (e(t.item || this).attr(t.attribute || "id") || "").match(t.expression || /(.+)[-=_](.+)/);
                n && r.push((t.key || n[1] + "[]") + "=" + (t.key && t.expression ? n[1] : n[2]))
            }), !r.length && t.key && r.push(t.key + "="), r.join("&")
        },toArray: function(t) {
            var n = this._getItemsAsjQuery(t && t.connected), r = [];
            return t = t || {}, n.each(function() {
                r.push(e(t.item || this).attr(t.attribute || "id") || "")
            }), r
        },_intersectsWith: function(e) {
            var t = this.positionAbs.left, n = t + this.helperProportions.width, r = this.positionAbs.top, i = r + this.helperProportions.height, s = e.left, o = s + e.width, u = e.top, a = u + e.height, f = this.offset.click.top, l = this.offset.click.left;
            return f = r + f > u && r + f < a && t + l > s && t + l < o, this.options.tolerance == "pointer" || this.options.forcePointerForContainers || this.options.tolerance != "pointer" && this.helperProportions[this.floating ? "width" : "height"] > e[this.floating ? "width" : "height"] ? f : s < t + this.helperProportions.width / 2 && n - this.helperProportions.width / 2 < o && u < r + this.helperProportions.height / 2 && i - this.helperProportions.height / 2 < a
        },_intersectsWithPointer: function(t) {
            var n = e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top, t.height);
            t = e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left, t.width), n = n && t, t = this._getDragVerticalDirection();
            var r = this._getDragHorizontalDirection();
            return n ? this.floating ? r && r == "right" || t == "down" ? 2 : 1 : t && (t == "down" ? 2 : 1) : !1
        },_intersectsWithSides: function(t) {
            var n = e.ui.isOverAxis(this.positionAbs.top + this.offset.click.top, t.top + t.height / 2, t.height);
            t = e.ui.isOverAxis(this.positionAbs.left + this.offset.click.left, t.left + t.width / 2, t.width);
            var r = this._getDragVerticalDirection(), i = this._getDragHorizontalDirection();
            return this.floating && i ? i == "right" && t || i == "left" && !t : r && (r == "down" && n || r == "up" && !n)
        },_getDragVerticalDirection: function() {
            var e = this.positionAbs.top - this.lastPositionAbs.top;
            return e != 0 && (e > 0 ? "down" : "up")
        },_getDragHorizontalDirection: function() {
            var e = this.positionAbs.left - this.lastPositionAbs.left;
            return e != 0 && (e > 0 ? "right" : "left")
        },refresh: function(e) {
            return this._refreshItems(e), this.refreshPositions(), this
        },_connectWith: function() {
            var e = this.options;
            return e.connectWith.constructor == String ? [e.connectWith] : e.connectWith
        },_getItemsAsjQuery: function(t) {
            var n = [], r = [], i = this._connectWith();
            if (i && t)
                for (t = i.length - 1; t >= 0; t--)
                    for (var s = e(i[t]), o = s.length - 1; o >= 0; o--) {
                        var u = e.data(s[o], "sortable");
                        u && u != this && !u.options.disabled && r.push([e.isFunction(u.options.items) ? u.options.items.call(u.element) : e(u.options.items, u.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), u])
                    }
            r.push([e.isFunction(this.options.items) ? this.options.items.call(this.element, null, {options: this.options,item: this.currentItem}) : e(this.options.items, this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"), this]);
            for (t = r.length - 1; t >= 0; t--)
                r[t][0].each(function() {
                    n.push(this)
                });
            return e(n)
        },_removeCurrentsFromItems: function() {
            for (var e = this.currentItem.find(":data(sortable-item)"), t = 0; t < this.items.length; t++)
                for (var n = 0; n < e.length; n++)
                    e[n] == this.items[t].item[0] && this.items.splice(t, 1)
        },_refreshItems: function(t) {
            this.items = [], this.containers = [this];
            var n = this.items, r = [[e.isFunction(this.options.items) ? this.options.items.call(this.element[0], t, {item: this.currentItem}) : e(this.options.items, this.element), this]], i = this._connectWith();
            if (i)
                for (var s = i.length - 1; s >= 0; s--)
                    for (var o = e(i[s]), u = o.length - 1; u >= 0; u--) {
                        var a = e.data(o[u], "sortable");
                        a && a != this && !a.options.disabled && (r.push([e.isFunction(a.options.items) ? a.options.items.call(a.element[0], t, {item: this.currentItem}) : e(a.options.items, a.element), a]), this.containers.push(a))
                    }
            for (s = r.length - 1; s >= 0; s--) {
                t = r[s][1], i = r[s][0], u = 0;
                for (o = i.length; u < o; u++)
                    a = e(i[u]), a.data("sortable-item", t), n.push({item: a,instance: t,width: 0,height: 0,left: 0,top: 0})
            }
        },refreshPositions: function(t) {
            this.offsetParent && this.helper && (this.offset.parent = this._getParentOffset());
            for (var n = this.items.length - 1; n >= 0; n--) {
                var r = this.items[n];
                if (r.instance == this.currentContainer || !this.currentContainer || r.item[0] == this.currentItem[0]) {
                    var i = this.options.toleranceElement ? e(this.options.toleranceElement, r.item) : r.item;
                    t || (r.width = i.outerWidth(), r.height = i.outerHeight()), i = i.offset(), r.left = i.left, r.top = i.top
                }
            }
            if (this.options.custom && this.options.custom.refreshContainers)
                this.options.custom.refreshContainers.call(this);
            else
                for (n = this.containers.length - 1; n >= 0; n--)
                    i = this.containers[n].element.offset(), this.containers[n].containerCache.left = i.left, this.containers[n].containerCache.top = i.top, this.containers[n].containerCache.width = this.containers[n].element.outerWidth(), this.containers[n].containerCache.height = this.containers[n].element.outerHeight();
            return this
        },_createPlaceholder: function(t) {
            var n = t || this, r = n.options;
            if (!r.placeholder || r.placeholder.constructor == String) {
                var i = r.placeholder;
                r.placeholder = {element: function() {
                        var t = e(document.createElement(n.currentItem[0].nodeName)).addClass(i || n.currentItem[0].className + " ui-sortable-placeholder").removeClass("ui-sortable-helper")[0];
                        return i || (t.style.visibility = "hidden"), t
                    },update: function(e, t) {
                        if (!i || !!r.forcePlaceholderSize)
                            t.height() || t.height(n.currentItem.innerHeight() - parseInt(n.currentItem.css("paddingTop") || 0, 10) - parseInt(n.currentItem.css("paddingBottom") || 0, 10)), t.width() || t.width(n.currentItem.innerWidth() - parseInt(n.currentItem.css("paddingLeft") || 0, 10) - parseInt(n.currentItem.css("paddingRight") || 0, 10))
                    }}
            }
            n.placeholder = e(r.placeholder.element.call(n.element, n.currentItem)), n.currentItem.after(n.placeholder), r.placeholder.update(n, n.placeholder)
        },_contactContainers: function(t) {
            for (var n = null, r = null, i = this.containers.length - 1; i >= 0; i--)
                if (!e.ui.contains(this.currentItem[0], this.containers[i].element[0]))
                    if (this._intersectsWith(this.containers[i].containerCache)) {
                        if (!n || !e.ui.contains(this.containers[i].element[0], n.element[0]))
                            n = this.containers[i], r = i
                    } else
                        this.containers[i].containerCache.over && (this.containers[i]._trigger("out", t, this._uiHash(this)), this.containers[i].containerCache.over = 0);
            if (n)
                if (this.containers.length === 1)
                    this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1;
                else if (this.currentContainer != this.containers[r]) {
                    n = 1e4, i = null;
                    for (var s = this.positionAbs[this.containers[r].floating ? "left" : "top"], o = this.items.length - 1; o >= 0; o--)
                        if (e.ui.contains(this.containers[r].element[0], this.items[o].item[0])) {
                            var u = this.items[o][this.containers[r].floating ? "left" : "top"];
                            Math.abs(u - s) < n && (n = Math.abs(u - s), i = this.items[o])
                        }
                    if (i || this.options.dropOnEmpty)
                        this.currentContainer = this.containers[r], i ? this._rearrange(t, i, null, !0) : this._rearrange(t, null, this.containers[r].element, !0), this._trigger("change", t, this._uiHash()), this.containers[r]._trigger("change", t, this._uiHash(this)), this.options.placeholder.update(this.currentContainer, this.placeholder), this.containers[r]._trigger("over", t, this._uiHash(this)), this.containers[r].containerCache.over = 1
                }
        },_createHelper: function(t) {
            var n = this.options;
            return t = e.isFunction(n.helper) ? e(n.helper.apply(this.element[0], [t, this.currentItem])) : n.helper == "clone" ? this.currentItem.clone() : this.currentItem, t.parents("body").length || e(n.appendTo != "parent" ? n.appendTo : this.currentItem[0].parentNode)[0].appendChild(t[0]), t[0] == this.currentItem[0] && (this._storedCSS = {width: this.currentItem[0].style.width,height: this.currentItem[0].style.height,position: this.currentItem.css("position"),top: this.currentItem.css("top"),left: this.currentItem.css("left")}), (t[0].style.width == "" || n.forceHelperSize) && t.width(this.currentItem.width()), (t[0].style.height == "" || n.forceHelperSize) && t.height(this.currentItem.height()), t
        },_adjustOffsetFromHelper: function(t) {
            typeof t == "string" && (t = t.split(" ")), e.isArray(t) && (t = {left: +t[0],top: +t[1] || 0}), "left" in t && (this.offset.click.left = t.left + this.margins.left), "right" in t && (this.offset.click.left = this.helperProportions.width - t.right + this.margins.left), "top" in t && (this.offset.click.top = t.top + this.margins.top), "bottom" in t && (this.offset.click.top = this.helperProportions.height - t.bottom + this.margins.top)
        },_getParentOffset: function() {
            this.offsetParent = this.helper.offsetParent();
            var t = this.offsetParent.offset();
            this.cssPosition == "absolute" && this.scrollParent[0] != document && e.ui.contains(this.scrollParent[0], this.offsetParent[0]) && (t.left += this.scrollParent.scrollLeft(), t.top += this.scrollParent.scrollTop());
            if (this.offsetParent[0] == document.body || this.offsetParent[0].tagName && this.offsetParent[0].tagName.toLowerCase() == "html" && e.browser.msie)
                t = {top: 0,left: 0};
            return {top: t.top + (parseInt(this.offsetParent.css("borderTopWidth"), 10) || 0),left: t.left + (parseInt(this.offsetParent.css("borderLeftWidth"), 10) || 0)}
        },_getRelativeOffset: function() {
            if (this.cssPosition == "relative") {
                var e = this.currentItem.position();
                return {top: e.top - (parseInt(this.helper.css("top"), 10) || 0) + this.scrollParent.scrollTop(),left: e.left - (parseInt(this.helper.css("left"), 10) || 0) + this.scrollParent.scrollLeft()}
            }
            return {top: 0,left: 0}
        },_cacheMargins: function() {
            this.margins = {left: parseInt(this.currentItem.css("marginLeft"), 10) || 0,top: parseInt(this.currentItem.css("marginTop"), 10) || 0}
        },_cacheHelperProportions: function() {
            this.helperProportions = {width: this.helper.outerWidth(),height: this.helper.outerHeight()}
        },_setContainment: function() {
            var t = this.options;
            t.containment == "parent" && (t.containment = this.helper[0].parentNode);
            if (t.containment == "document" || t.containment == "window")
                this.containment = [0 - this.offset.relative.left - this.offset.parent.left, 0 - this.offset.relative.top - this.offset.parent.top, e(t.containment == "document" ? document : window).width() - this.helperProportions.width - this.margins.left, (e(t.containment == "document" ? document : window).height() || document.body.parentNode.scrollHeight) - this.helperProportions.height - this.margins.top];
            if (!/^(document|window|parent)$/.test(t.containment)) {
                var n = e(t.containment)[0];
                t = e(t.containment).offset();
                var r = e(n).css("overflow") != "hidden";
                this.containment = [t.left + (parseInt(e(n).css("borderLeftWidth"), 10) || 0) + (parseInt(e(n).css("paddingLeft"), 10) || 0) - this.margins.left, t.top + (parseInt(e(n).css("borderTopWidth"), 10) || 0) + (parseInt(e(n).css("paddingTop"), 10) || 0) - this.margins.top, t.left + (r ? Math.max(n.scrollWidth, n.offsetWidth) : n.offsetWidth) - (parseInt(e(n).css("borderLeftWidth"), 10) || 0) - (parseInt(e(n).css("paddingRight"), 10) || 0) - this.helperProportions.width - this.margins.left, t.top + (r ? Math.max(n.scrollHeight, n.offsetHeight) : n.offsetHeight) - (parseInt(e(n).css("borderTopWidth"), 10) || 0) - (parseInt(e(n).css("paddingBottom"), 10) || 0) - this.helperProportions.height - this.margins.top]
            }
        },_convertPositionTo: function(t, n) {
            n || (n = this.position), t = t == "absolute" ? 1 : -1;
            var r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName);
            return {top: n.top + this.offset.relative.top * t + this.offset.parent.top * t - (e.browser.safari && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()) * t),left: n.left + this.offset.relative.left * t + this.offset.parent.left * t - (e.browser.safari && this.cssPosition == "fixed" ? 0 : (this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft()) * t)}
        },_generatePosition: function(t) {
            var n = this.options, r = this.cssPosition != "absolute" || this.scrollParent[0] != document && !!e.ui.contains(this.scrollParent[0], this.offsetParent[0]) ? this.scrollParent : this.offsetParent, i = /(html|body)/i.test(r[0].tagName);
            this.cssPosition == "relative" && (this.scrollParent[0] == document || this.scrollParent[0] == this.offsetParent[0]) && (this.offset.relative = this._getRelativeOffset());
            var s = t.pageX, o = t.pageY;
            return this.originalPosition && (this.containment && (t.pageX - this.offset.click.left < this.containment[0] && (s = this.containment[0] + this.offset.click.left), t.pageY - this.offset.click.top < this.containment[1] && (o = this.containment[1] + this.offset.click.top), t.pageX - this.offset.click.left > this.containment[2] && (s = this.containment[2] + this.offset.click.left), t.pageY - this.offset.click.top > this.containment[3] && (o = this.containment[3] + this.offset.click.top)), n.grid && (o = this.originalPageY + Math.round((o - this.originalPageY) / n.grid[1]) * n.grid[1], o = this.containment ? o - this.offset.click.top < this.containment[1] || o - this.offset.click.top > this.containment[3] ? o - this.offset.click.top < this.containment[1] ? o + n.grid[1] : o - n.grid[1] : o : o, s = this.originalPageX + Math.round((s - this.originalPageX) / n.grid[0]) * n.grid[0], s = this.containment ? s - this.offset.click.left < this.containment[0] || s - this.offset.click.left > this.containment[2] ? s - this.offset.click.left < this.containment[0] ? s + n.grid[0] : s - n.grid[0] : s : s)), {top: o - this.offset.click.top - this.offset.relative.top - this.offset.parent.top + (e.browser.safari && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollTop() : i ? 0 : r.scrollTop()),left: s - this.offset.click.left - this.offset.relative.left - this.offset.parent.left + (e.browser.safari && this.cssPosition == "fixed" ? 0 : this.cssPosition == "fixed" ? -this.scrollParent.scrollLeft() : i ? 0 : r.scrollLeft())}
        },_rearrange: function(e, t, n, r) {
            n ? n[0].appendChild(this.placeholder[0]) : t.item[0].parentNode.insertBefore(this.placeholder[0], this.direction == "down" ? t.item[0] : t.item[0].nextSibling), this.counter = this.counter ? ++this.counter : 1;
            var i = this, s = this.counter;
            window.setTimeout(function() {
                s == i.counter && i.refreshPositions(!r)
            }, 0)
        },_clear: function(t, n) {
            this.reverting = !1;
            var r = [];
            !this._noFinalSort && this.currentItem.parent().length && this.placeholder.before(this.currentItem), this._noFinalSort = null;
            if (this.helper[0] == this.currentItem[0]) {
                for (var i in this._storedCSS)
                    if (this._storedCSS[i] == "auto" || this._storedCSS[i] == "static")
                        this._storedCSS[i] = "";
                this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")
            } else
                this.currentItem.show();
            this.fromOutside && !n && r.push(function(e) {
                this._trigger("receive", e, this._uiHash(this.fromOutside))
            }), (this.fromOutside || this.domPosition.prev != this.currentItem.prev().not(".ui-sortable-helper")[0] || this.domPosition.parent != this.currentItem.parent()[0]) && !n && r.push(function(e) {
                this._trigger("update", e, this._uiHash())
            });
            if (!e.ui.contains(this.element[0], this.currentItem[0])) {
                n || r.push(function(e) {
                    this._trigger("remove", e, this._uiHash())
                });
                for (i = this.containers.length - 1; i >= 0; i--)
                    e.ui.contains(this.containers[i].element[0], this.currentItem[0]) && !n && (r.push(function(e) {
                        return function(t) {
                            e._trigger("receive", t, this._uiHash(this))
                        }
                    }.call(this, this.containers[i])), r.push(function(e) {
                        return function(t) {
                            e._trigger("update", t, this._uiHash(this))
                        }
                    }.call(this, this.containers[i])))
            }
            for (i = this.containers.length - 1; i >= 0; i--)
                n || r.push(function(e) {
                    return function(t) {
                        e._trigger("deactivate", t, this._uiHash(this))
                    }
                }.call(this, this.containers[i])), this.containers[i].containerCache.over && (r.push(function(e) {
                    return function(t) {
                        e._trigger("out", t, this._uiHash(this))
                    }
                }.call(this, this.containers[i])), this.containers[i].containerCache.over = 0);
            this._storedCursor && e("body").css("cursor", this._storedCursor), this._storedOpacity && this.helper.css("opacity", this._storedOpacity), this._storedZIndex && this.helper.css("zIndex", this._storedZIndex == "auto" ? "" : this._storedZIndex), this.dragging = !1;
            if (this.cancelHelperRemoval) {
                if (!n) {
                    this._trigger("beforeStop", t, this._uiHash());
                    for (i = 0; i < r.length; i++)
                        r[i].call(this, t);
                    this._trigger("stop", t, this._uiHash())
                }
                return !1
            }
            n || this._trigger("beforeStop", t, this._uiHash()), this.placeholder[0].parentNode.removeChild(this.placeholder[0]), this.helper[0] != this.currentItem[0] && this.helper.remove(), this.helper = null;
            if (!n) {
                for (i = 0; i < r.length; i++)
                    r[i].call(this, t);
                this._trigger("stop", t, this._uiHash())
            }
            return this.fromOutside = !1, !0
        },_trigger: function() {
            e.Widget.prototype._trigger.apply(this, arguments) === !1 && this.cancel()
        },_uiHash: function(t) {
            var n = t || this;
            return {helper: n.helper,placeholder: n.placeholder || e([]),position: n.position,originalPosition: n.originalPosition,offset: n.positionAbs,item: n.currentItem,sender: t ? t.element : null}
        }}), e.extend(e.ui.sortable, {version: "1.8.16"})
}(jQuery), function(e) {
    e.widget("ui.accordion", {options: {active: 0,animated: "slide",autoHeight: !0,clearStyle: !1,collapsible: !1,event: "click",fillSpace: !1,header: "> li > :first-child,> :not(li):even",icons: {header: "ui-icon-triangle-1-e",headerSelected: "ui-icon-triangle-1-s"},navigation: !1,navigationFilter: function() {
                return this.href.toLowerCase() === location.href.toLowerCase()
            }},_create: function() {
            var t = this, n = t.options;
            t.running = 0, t.element.addClass("ui-accordion ui-widget ui-helper-reset").children("li").addClass("ui-accordion-li-fix"), t.headers = t.element.find(n.header).addClass("ui-accordion-header ui-helper-reset ui-state-default ui-corner-all").bind("mouseenter.accordion", function() {
                n.disabled || e(this).addClass("ui-state-hover")
            }).bind("mouseleave.accordion", function() {
                n.disabled || e(this).removeClass("ui-state-hover")
            }).bind("focus.accordion", function() {
                n.disabled || e(this).addClass("ui-state-focus")
            }).bind("blur.accordion", function() {
                n.disabled || e(this).removeClass("ui-state-focus")
            }), t.headers.next().addClass("ui-accordion-content ui-helper-reset ui-widget-content ui-corner-bottom");
            if (n.navigation) {
                var r = t.element.find("a").filter(n.navigationFilter).eq(0);
                if (r.length) {
                    var i = r.closest(".ui-accordion-header");
                    t.active = i.length ? i : r.closest(".ui-accordion-content").prev()
                }
            }
            t.active = t._findActive(t.active || n.active).addClass("ui-state-default ui-state-active").toggleClass("ui-corner-all").toggleClass("ui-corner-top"), t.active.next().addClass("ui-accordion-content-active"), t._createIcons(), t.resize(), t.element.attr("role", "tablist"), t.headers.attr("role", "tab").bind("keydown.accordion", function(e) {
                return t._keydown(e)
            }).next().attr("role", "tabpanel"), t.headers.not(t.active || "").attr({"aria-expanded": "false","aria-selected": "false",tabIndex: -1}).next().hide(), t.active.length ? t.active.attr({"aria-expanded": "true","aria-selected": "true",tabIndex: 0}) : t.headers.eq(0).attr("tabIndex", 0), e.browser.safari || t.headers.find("a").attr("tabIndex", -1), n.event && t.headers.bind(n.event.split(" ").join(".accordion ") + ".accordion", function(e) {
                t._clickHandler.call(t, e, this), e.preventDefault()
            })
        },_createIcons: function() {
            var t = this.options;
            t.icons && (e("<span></span>").addClass("ui-icon " + t.icons.header).prependTo(this.headers), this.active.children(".ui-icon").toggleClass(t.icons.header).toggleClass(t.icons.headerSelected), this.element.addClass("ui-accordion-icons"))
        },_destroyIcons: function() {
            this.headers.children(".ui-icon").remove(), this.element.removeClass("ui-accordion-icons")
        },destroy: function() {
            var t = this.options;
            this.element.removeClass("ui-accordion ui-widget ui-helper-reset").removeAttr("role"), this.headers.unbind(".accordion").removeClass("ui-accordion-header ui-accordion-disabled ui-helper-reset ui-state-default ui-corner-all ui-state-active ui-state-disabled ui-corner-top").removeAttr("role").removeAttr("aria-expanded").removeAttr("aria-selected").removeAttr("tabIndex"), this.headers.find("a").removeAttr("tabIndex"), this._destroyIcons();
            var n = this.headers.next().css("display", "").removeAttr("role").removeClass("ui-helper-reset ui-widget-content ui-corner-bottom ui-accordion-content ui-accordion-content-active ui-accordion-disabled ui-state-disabled");
            return (t.autoHeight || t.fillHeight) && n.css("height", ""), e.Widget.prototype.destroy.call(this)
        },_setOption: function(t, n) {
            e.Widget.prototype._setOption.apply(this, arguments), t == "active" && this.activate(n), t == "icons" && (this._destroyIcons(), n && this._createIcons()), t == "disabled" && this.headers.add(this.headers.next())[n ? "addClass" : "removeClass"]("ui-accordion-disabled ui-state-disabled")
        },_keydown: function(t) {
            if (!(this.options.disabled || t.altKey || t.ctrlKey)) {
                var n = e.ui.keyCode, r = this.headers.length, i = this.headers.index(t.target), s = !1;
                switch (t.keyCode) {
                    case n.RIGHT:
                    case n.DOWN:
                        s = this.headers[(i + 1) % r];
                        break;
                    case n.LEFT:
                    case n.UP:
                        s = this.headers[(i - 1 + r) % r];
                        break;
                    case n.SPACE:
                    case n.ENTER:
                        this._clickHandler({target: t.target}, t.target), t.preventDefault()
                }
                return s ? (e(t.target).attr("tabIndex", -1), e(s).attr("tabIndex", 0), s.focus(), !1) : !0
            }
        },resize: function() {
            var t = this.options, n;
            if (t.fillSpace) {
                if (e.browser.msie) {
                    var r = this.element.parent().css("overflow");
                    this.element.parent().css("overflow", "hidden")
                }
                n = this.element.parent().height(), e.browser.msie && this.element.parent().css("overflow", r), this.headers.each(function() {
                    n -= e(this).outerHeight(!0)
                }), this.headers.next().each(function() {
                    e(this).height(Math.max(0, n - e(this).innerHeight() + e(this).height()))
                }).css("overflow", "auto")
            } else
                t.autoHeight && (n = 0, this.headers.next().each(function() {
                    n = Math.max(n, e(this).height("").height())
                }).height(n));
            return this
        },activate: function(e) {
            return this.options.active = e, e = this._findActive(e)[0], this._clickHandler({target: e}, e), this
        },_findActive: function(t) {
            return t ? typeof t == "number" ? this.headers.filter(":eq(" + t + ")") : this.headers.not(this.headers.not(t)) : t === !1 ? e([]) : this.headers.filter(":eq(0)")
        },_clickHandler: function(t, n) {
            var r = this.options;
            if (!r.disabled)
                if (t.target) {
                    t = e(t.currentTarget || n), n = t[0] === this.active[0], r.active = r.collapsible && n ? !1 : this.headers.index(t);
                    if (!(this.running || !r.collapsible && n)) {
                        var i = this.active;
                        a = t.next(), o = this.active.next(), u = {options: r,newHeader: n && r.collapsible ? e([]) : t,oldHeader: this.active,newContent: n && r.collapsible ? e([]) : a,oldContent: o};
                        var s = this.headers.index(this.active[0]) > this.headers.index(t[0]);
                        this.active = n ? e([]) : t, this._toggle(a, o, u, n, s), i.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(r.icons.headerSelected).addClass(r.icons.header), n || (t.removeClass("ui-state-default ui-corner-all").addClass("ui-state-active ui-corner-top").children(".ui-icon").removeClass(r.icons.header).addClass(r.icons.headerSelected), t.next().addClass("ui-accordion-content-active"))
                    }
                } else if (r.collapsible) {
                    this.active.removeClass("ui-state-active ui-corner-top").addClass("ui-state-default ui-corner-all").children(".ui-icon").removeClass(r.icons.headerSelected).addClass(r.icons.header), this.active.next().addClass("ui-accordion-content-active");
                    var o = this.active.next(), u = {options: r,newHeader: e([]),oldHeader: r.active,newContent: e([]),oldContent: o}, a = this.active = e([]);
                    this._toggle(a, o, u)
                }
        },_toggle: function(t, n, r, i, s) {
            var o = this, u = o.options;
            o.toShow = t, o.toHide = n, o.data = r;
            var a = function() {
                if (o)
                    return o._completed.apply(o, arguments)
            };
            o._trigger("changestart", null, o.data), o.running = n.size() === 0 ? t.size() : n.size();
            if (u.animated) {
                r = {}, r = u.collapsible && i ? {toShow: e([]),toHide: n,complete: a,down: s,autoHeight: u.autoHeight || u.fillSpace} : {toShow: t,toHide: n,complete: a,down: s,autoHeight: u.autoHeight || u.fillSpace}, u.proxied || (u.proxied = u.animated), u.proxiedDuration || (u.proxiedDuration = u.duration), u.animated = e.isFunction(u.proxied) ? u.proxied(r) : u.proxied, u.duration = e.isFunction(u.proxiedDuration) ? u.proxiedDuration(r) : u.proxiedDuration, i = e.ui.accordion.animations;
                var f = u.duration, l = u.animated;
                l && !i[l] && !e.easing[l] && (l = "slide"), i[l] || (i[l] = function(e) {
                    this.slide(e, {easing: l,duration: f || 700})
                }), i[l](r)
            } else
                u.collapsible && i ? t.toggle() : (n.hide(), t.show()), a(!0);
            n.prev().attr({"aria-expanded": "false","aria-selected": "false",tabIndex: -1}).blur(), t.prev().attr({"aria-expanded": "true","aria-selected": "true",tabIndex: 0}).focus()
        },_completed: function(e) {
            this.running = e ? 0 : --this.running, this.running || (this.options.clearStyle && this.toShow.add(this.toHide).css({height: "",overflow: ""}), this.toHide.removeClass("ui-accordion-content-active"), this.toHide.length && (this.toHide.parent()[0].className = this.toHide.parent()[0].className), this._trigger("change", null, this.data))
        }}), e.extend(e.ui.accordion, {version: "1.8.16",animations: {slide: function(t, n) {
                t = e.extend({easing: "swing",duration: 300}, t, n);
                if (t.toHide.size())
                    if (t.toShow.size()) {
                        var r = t.toShow.css("overflow"), i = 0, s = {}, o = {}, u;
                        n = t.toShow, u = n[0].style.width, n.width(parseInt(n.parent().width(), 10) - parseInt(n.css("paddingLeft"), 10) - parseInt(n.css("paddingRight"), 10) - (parseInt(n.css("borderLeftWidth"), 10) || 0) - (parseInt(n.css("borderRightWidth"), 10) || 0)), e.each(["height", "paddingTop", "paddingBottom"], function(n, r) {
                            o[r] = "hide", n = ("" + e.css(t.toShow[0], r)).match(/^([\d+-.]+)(.*)$/), s[r] = {value: n[1],unit: n[2] || "px"}
                        }), t.toShow.css({height: 0,overflow: "hidden"}).show(), t.toHide.filter(":hidden").each(t.complete).end().filter(":visible").animate(o, {step: function(e, n) {
                                n.prop == "height" && (i = n.end - n.start === 0 ? 0 : (n.now - n.start) / (n.end - n.start)), t.toShow[0].style[n.prop] = i * s[n.prop].value + s[n.prop].unit
                            },duration: t.duration,easing: t.easing,complete: function() {
                                t.autoHeight || t.toShow.css("height", ""), t.toShow.css({width: u,overflow: r}), t.complete()
                            }})
                    } else
                        t.toHide.animate({height: "hide",paddingTop: "hide",paddingBottom: "hide"}, t);
                else
                    t.toShow.animate({height: "show",paddingTop: "show",paddingBottom: "show"}, t)
            },bounceslide: function(e) {
                this.slide(e, {easing: e.down ? "easeOutBounce" : "swing",duration: e.down ? 1e3 : 200})
            }}})
}(jQuery), function(e) {
    var t = 0;
    e.widget("ui.autocomplete", {options: {appendTo: "body",autoFocus: !1,delay: 300,minLength: 1,position: {my: "left top",at: "left bottom",collision: "none"},source: null},pending: 0,_create: function() {
            var t = this, n = this.element[0].ownerDocument, r;
            this.element.addClass("ui-autocomplete-input").attr("autocomplete", "off").attr({role: "textbox","aria-autocomplete": "list","aria-haspopup": "true"}).bind("keydown.autocomplete", function(n) {
                if (!t.options.disabled && !t.element.propAttr("readOnly")) {
                    r = !1;
                    var i = e.ui.keyCode;
                    switch (n.keyCode) {
                        case i.PAGE_UP:
                            t._move("previousPage", n);
                            break;
                        case i.PAGE_DOWN:
                            t._move("nextPage", n);
                            break;
                        case i.UP:
                            t._move("previous", n), n.preventDefault();
                            break;
                        case i.DOWN:
                            t._move("next", n), n.preventDefault();
                            break;
                        case i.ENTER:
                        case i.NUMPAD_ENTER:
                            t.menu.active && (r = !0, n.preventDefault());
                        case i.TAB:
                            if (!t.menu.active)
                                return;
                            t.menu.select(n);
                            break;
                        case i.ESCAPE:
                            t.element.val(t.term), t.close(n);
                            break;
                        default:
                            clearTimeout(t.searching), t.searching = setTimeout(function() {
                                t.term != t.element.val() && (t.selectedItem = null, t.search(null, n))
                            }, t.options.delay)
                    }
                }
            }).bind("keypress.autocomplete", function(e) {
                r && (r = !1, e.preventDefault())
            }).bind("focus.autocomplete", function() {
                t.options.disabled || (t.selectedItem = null, t.previous = t.element.val())
            }).bind("blur.autocomplete", function(e) {
                t.options.disabled || (clearTimeout(t.searching), t.closing = setTimeout(function() {
                    t.close(e), t._change(e)
                }, 150))
            }), this._initSource(), this.response = function() {
                return t._response.apply(t, arguments)
            }, this.menu = e("<ul></ul>").addClass("ui-autocomplete").appendTo(e(this.options.appendTo || "body", n)[0]).mousedown(function(n) {
                var r = t.menu.element[0];
                e(n.target).closest(".ui-menu-item").length || setTimeout(function() {
                    e(document).one("mousedown", function(n) {
                        n.target !== t.element[0] && n.target !== r && !e.ui.contains(r, n.target) && t.close()
                    })
                }, 1), setTimeout(function() {
                    clearTimeout(t.closing)
                }, 13)
            }).menu({focus: function(e, n) {
                    n = n.item.data("item.autocomplete"), !1 !== t._trigger("focus", e, {item: n}) && /^key/.test(e.originalEvent.type) && t.element.val(n.value)
                },selected: function(e, r) {
                    var i = r.item.data("item.autocomplete"), s = t.previous;
                    t.element[0] !== n.activeElement && (t.element.focus(), t.previous = s, setTimeout(function() {
                        t.previous = s, t.selectedItem = i
                    }, 1)), !1 !== t._trigger("select", e, {item: i}) && t.element.val(i.value), t.term = t.element.val(), t.close(e), t.selectedItem = i
                },blur: function() {
                    t.menu.element.is(":visible") && t.element.val() !== t.term && t.element.val(t.term)
                }}).zIndex(this.element.zIndex() + 1).css({top: 0,left: 0}).hide().data("menu"), e.fn.bgiframe && this.menu.element.bgiframe()
        },destroy: function() {
            this.element.removeClass("ui-autocomplete-input").removeAttr("autocomplete").removeAttr("role").removeAttr("aria-autocomplete").removeAttr("aria-haspopup"), this.menu.element.remove(), e.Widget.prototype.destroy.call(this)
        },_setOption: function(t, n) {
            e.Widget.prototype._setOption.apply(this, arguments), t === "source" && this._initSource(), t === "appendTo" && this.menu.element.appendTo(e(n || "body", this.element[0].ownerDocument)[0]), t === "disabled" && n && this.xhr && this.xhr.abort()
        },_initSource: function() {
            var n = this, r, i;
            e.isArray(this.options.source) ? (r = this.options.source, this.source = function(t, n) {
                n(e.ui.autocomplete.filter(r, t.term))
            }) : typeof this.options.source == "string" ? (i = this.options.source, this.source = function(r, s) {
                n.xhr && n.xhr.abort(), n.xhr = e.ajax({url: i,data: r,dataType: "json",autocompleteRequest: ++t,success: function(e) {
                        this.autocompleteRequest === t && s(e)
                    },error: function() {
                        this.autocompleteRequest === t && s([])
                    }})
            }) : this.source = this.options.source
        },search: function(e, t) {
            e = e != null ? e : this.element.val(), this.term = this.element.val();
            if (e.length < this.options.minLength)
                return this.close(t);
            clearTimeout(this.closing);
            if (this._trigger("search", t) !== !1)
                return this._search(e)
        },_search: function(e) {
            this.pending++, this.element.addClass("ui-autocomplete-loading"), this.source({term: e}, this.response)
        },_response: function(e) {
            !this.options.disabled && e && e.length ? (e = this._normalize(e), this._suggest(e), this._trigger("open")) : this.close(), this.pending--, this.pending || this.element.removeClass("ui-autocomplete-loading")
        },close: function(e) {
            clearTimeout(this.closing), this.menu.element.is(":visible") && (this.menu.element.hide(), this.menu.deactivate(), this._trigger("close", e))
        },_change: function(e) {
            this.previous !== this.element.val() && this._trigger("change", e, {item: this.selectedItem})
        },_normalize: function(t) {
            return t.length && t[0].label && t[0].value ? t : e.map(t, function(t) {
                return typeof t == "string" ? {label: t,value: t} : e.extend({label: t.label || t.value,value: t.value || t.label}, t)
            })
        },_suggest: function(t) {
            var n = this.menu.element.empty().zIndex(this.element.zIndex() + 1);
            this._renderMenu(n, t), this.menu.deactivate(), this.menu.refresh(), n.show(), this._resizeMenu(), n.position(e.extend({of: this.element}, this.options.position)), this.options.autoFocus && this.menu.next(new e.Event("mouseover"))
        },_resizeMenu: function() {
            var e = this.menu.element;
            e.outerWidth(Math.max(e.width("").outerWidth(), this.element.outerWidth()))
        },_renderMenu: function(t, n) {
            var r = this;
            e.each(n, function(e, n) {
                r._renderItem(t, n)
            })
        },_renderItem: function(t, n) {
            return e("<li></li>").data("item.autocomplete", n).append(e("<a></a>").text(n.label)).appendTo(t)
        },_move: function(e, t) {
            this.menu.element.is(":visible") ? this.menu.first() && /^previous/.test(e) || this.menu.last() && /^next/.test(e) ? (this.element.val(this.term), this.menu.deactivate()) : this.menu[e](t) : this.search(null, t)
        },widget: function() {
            return this.menu.element
        }}), e.extend(e.ui.autocomplete, {escapeRegex: function(e) {
            return e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g, "\\$&")
        },filter: function(t, n) {
            var r = new RegExp(e.ui.autocomplete.escapeRegex(n), "i");
            return e.grep(t, function(e) {
                return r.test(e.label || e.value || e)
            })
        }})
}(jQuery), function(e) {
    e.widget("ui.menu", {_create: function() {
            var t = this;
            this.element.addClass("ui-menu ui-widget ui-widget-content ui-corner-all").attr({role: "listbox","aria-activedescendant": "ui-active-menuitem"}).click(function(n) {
                e(n.target).closest(".ui-menu-item a").length && (n.preventDefault(), t.select(n))
            }), this.refresh()
        },refresh: function() {
            var t = this;
            this.element.children("li:not(.ui-menu-item):has(a)").addClass("ui-menu-item").attr("role", "menuitem").children("a").addClass("ui-corner-all").attr("tabindex", -1).mouseenter(function(n) {
                t.activate(n, e(this).parent())
            }).mouseleave(function() {
                t.deactivate()
            })
        },activate: function(e, t) {
            this.deactivate();
            if (this.hasScroll()) {
                var n = t.offset().top - this.element.offset().top, r = this.element.scrollTop(), i = this.element.height();
                n < 0 ? this.element.scrollTop(r + n) : n >= i && this.element.scrollTop(r + n - i + t.height())
            }
            this.active = t.eq(0).children("a").addClass("ui-state-hover").attr("id", "ui-active-menuitem").end(), this._trigger("focus", e, {item: t})
        },deactivate: function() {
            this.active && (this.active.children("a").removeClass("ui-state-hover").removeAttr("id"), this._trigger("blur"), this.active = null)
        },next: function(e) {
            this.move("next", ".ui-menu-item:first", e)
        },previous: function(e) {
            this.move("prev", ".ui-menu-item:last", e)
        },first: function() {
            return this.active && !this.active.prevAll(".ui-menu-item").length
        },last: function() {
            return this.active && !this.active.nextAll(".ui-menu-item").length
        },move: function(e, t, n) {
            this.active ? (e = this.active[e + "All"](".ui-menu-item").eq(0), e.length ? this.activate(n, e) : this.activate(n, this.element.children(t))) : this.activate(n, this.element.children(t))
        },nextPage: function(t) {
            if (this.hasScroll())
                if (!this.active || this.last())
                    this.activate(t, this.element.children(".ui-menu-item:first"));
                else {
                    var n = this.active.offset().top, r = this.element.height(), i = this.element.children(".ui-menu-item").filter(function() {
                        var t = e(this).offset().top - n - r + e(this).height();
                        return t < 10 && t > -10
                    });
                    i.length || (i = this.element.children(".ui-menu-item:last")), this.activate(t, i)
                }
            else
                this.activate(t, this.element.children(".ui-menu-item").filter(!this.active || this.last() ? ":first" : ":last"))
        },previousPage: function(t) {
            if (this.hasScroll())
                if (!this.active || this.first())
                    this.activate(t, this.element.children(".ui-menu-item:last"));
                else {
                    var n = this.active.offset().top, r = this.element.height();
                    result = this.element.children(".ui-menu-item").filter(function() {
                        var t = e(this).offset().top - n + r - e(this).height();
                        return t < 10 && t > -10
                    }), result.length || (result = this.element.children(".ui-menu-item:first")), this.activate(t, result)
                }
            else
                this.activate(t, this.element.children(".ui-menu-item").filter(!this.active || this.first() ? ":last" : ":first"))
        },hasScroll: function() {
            return this.element.height() < this.element[e.fn.prop ? "prop" : "attr"]("scrollHeight")
        },select: function(e) {
            this._trigger("selected", e, {item: this.active})
        }})
}(jQuery), function(e) {
    var t, n, r, i, s = function() {
        var t = e(this).find(":ui-button");
        setTimeout(function() {
            t.button("refresh")
        }, 1)
    }, o = function(t) {
        var n = t.name, r = t.form, i = e([]);
        return n && (i = r ? e(r).find("[name='" + n + "']") : e("[name='" + n + "']", t.ownerDocument).filter(function() {
            return !this.form
        })), i
    };
    e.widget("ui.button", {options: {disabled: null,text: !0,label: null,icons: {primary: null,secondary: null}},_create: function() {
            this.element.closest("form").unbind("reset.button").bind("reset.button", s), typeof this.options.disabled != "boolean" && (this.options.disabled = this.element.propAttr("disabled")), this._determineButtonType(), this.hasTitle = !!this.buttonElement.attr("title");
            var u = this, a = this.options, f = this.type === "checkbox" || this.type === "radio", c = "ui-state-hover" + (f ? "" : " ui-state-active");
            a.label === null && (a.label = this.buttonElement.html()), this.element.is(":disabled") && (a.disabled = !0), this.buttonElement.addClass("ui-button ui-widget ui-state-default ui-corner-all").attr("role", "button").bind("mouseenter.button", function() {
                a.disabled || (e(this).addClass("ui-state-hover"), this === t && e(this).addClass("ui-state-active"))
            }).bind("mouseleave.button", function() {
                a.disabled || e(this).removeClass(c)
            }).bind("click.button", function(e) {
                a.disabled && (e.preventDefault(), e.stopImmediatePropagation())
            }), this.element.bind("focus.button", function() {
                u.buttonElement.addClass("ui-state-focus")
            }).bind("blur.button", function() {
                u.buttonElement.removeClass("ui-state-focus")
            }), f && (this.element.bind("change.button", function() {
                i || u.refresh()
            }), this.buttonElement.bind("mousedown.button", function(e) {
                a.disabled || (i = !1, n = e.pageX, r = e.pageY)
            }).bind("mouseup.button", function(e) {
                !a.disabled && (n !== e.pageX || r !== e.pageY) && (i = !0)
            })), this.type === "checkbox" ? this.buttonElement.bind("click.button", function() {
                if (a.disabled || i)
                    return !1;
                e(this).toggleClass("ui-state-active"), u.buttonElement.attr("aria-pressed", u.element[0].checked)
            }) : this.type === "radio" ? this.buttonElement.bind("click.button", function() {
                if (a.disabled || i)
                    return !1;
                e(this).addClass("ui-state-active"), u.buttonElement.attr("aria-pressed", "true");
                var t = u.element[0];
                o(t).not(t).map(function() {
                    return e(this).button("widget")[0]
                }).removeClass("ui-state-active").attr("aria-pressed", "false")
            }) : (this.buttonElement.bind("mousedown.button", function() {
                if (a.disabled)
                    return !1;
                e(this).addClass("ui-state-active"), t = this, e(document).one("mouseup", function() {
                    t = null
                })
            }).bind("mouseup.button", function() {
                if (a.disabled)
                    return !1;
                e(this).removeClass("ui-state-active")
            }).bind("keydown.button", function(t) {
                if (a.disabled)
                    return !1;
                (t.keyCode == e.ui.keyCode.SPACE || t.keyCode == e.ui.keyCode.ENTER) && e(this).addClass("ui-state-active")
            }).bind("keyup.button", function() {
                e(this).removeClass("ui-state-active")
            }), this.buttonElement.is("a") && this.buttonElement.keyup(function(t) {
                t.keyCode === e.ui.keyCode.SPACE && e(this).click()
            })), this._setOption("disabled", a.disabled), this._resetButton()
        },_determineButtonType: function() {
            this.type = this.element.is(":checkbox") ? "checkbox" : this.element.is(":radio") ? "radio" : this.element.is("input") ? "input" : "button";
            if (this.type === "checkbox" || this.type === "radio") {
                var e = this.element.parents().filter(":last"), t = "label[for='" + this.element.attr("id") + "']";
                this.buttonElement = e.find(t), this.buttonElement.length || (e = e.length ? e.siblings() : this.element.siblings(), this.buttonElement = e.filter(t), this.buttonElement.length || (this.buttonElement = e.find(t))), this.element.addClass("ui-helper-hidden-accessible"), (e = this.element.is(":checked")) && this.buttonElement.addClass("ui-state-active"), this.buttonElement.attr("aria-pressed", e)
            } else
                this.buttonElement = this.element
        },widget: function() {
            return this.buttonElement
        },destroy: function() {
            this.element.removeClass("ui-helper-hidden-accessible"), this.buttonElement.removeClass("ui-button ui-widget ui-state-default ui-corner-all ui-state-hover ui-state-active  ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only").removeAttr("role").removeAttr("aria-pressed").html(this.buttonElement.find(".ui-button-text").html()), this.hasTitle || this.buttonElement.removeAttr("title"), e.Widget.prototype.destroy.call(this)
        },_setOption: function(t, n) {
            e.Widget.prototype._setOption.apply(this, arguments), t === "disabled" ? n ? this.element.propAttr("disabled", !0) : this.element.propAttr("disabled", !1) : this._resetButton()
        },refresh: function() {
            var t = this.element.is(":disabled");
            t !== this.options.disabled && this._setOption("disabled", t), this.type === "radio" ? o(this.element[0]).each(function() {
                e(this).is(":checked") ? e(this).button("widget").addClass("ui-state-active").attr("aria-pressed", "true") : e(this).button("widget").removeClass("ui-state-active").attr("aria-pressed", "false")
            }) : this.type === "checkbox" && (this.element.is(":checked") ? this.buttonElement.addClass("ui-state-active").attr("aria-pressed", "true") : this.buttonElement.removeClass("ui-state-active").attr("aria-pressed", "false"))
        },_resetButton: function() {
            if (this.type === "input")
                this.options.label && this.element.val(this.options.label);
            else {
                var t = this.buttonElement.removeClass("ui-button-icons-only ui-button-icon-only ui-button-text-icons ui-button-text-icon-primary ui-button-text-icon-secondary ui-button-text-only"), n = e("<span></span>").addClass("ui-button-text").html(this.options.label).appendTo(t.empty()).text(), r = this.options.icons, i = r.primary && r.secondary, s = [];
                r.primary || r.secondary ? (this.options.text && s.push("ui-button-text-icon" + (i ? "s" : r.primary ? "-primary" : "-secondary")), r.primary && t.prepend("<span class='ui-button-icon-primary ui-icon " + r.primary + "'></span>"), r.secondary && t.append("<span class='ui-button-icon-secondary ui-icon " + r.secondary + "'></span>"), this.options.text || (s.push(i ? "ui-button-icons-only" : "ui-button-icon-only"), this.hasTitle || t.attr("title", n))) : s.push("ui-button-text-only"), t.addClass(s.join(" "))
            }
        }}), e.widget("ui.buttonset", {options: {items: ":button, :submit, :reset, :checkbox, :radio, a, :data(button)"},_create: function() {
            this.element.addClass("ui-buttonset")
        },_init: function() {
            this.refresh()
        },_setOption: function(t, n) {
            t === "disabled" && this.buttons.button("option", t, n), e.Widget.prototype._setOption.apply(this, arguments)
        },refresh: function() {
            var t = this.element.css("direction") === "ltr";
            this.buttons = this.element.find(this.options.items).filter(":ui-button").button("refresh").end().not(":ui-button").button().end().map(function() {
                return e(this).button("widget")[0]
            }).removeClass("ui-corner-all ui-corner-left ui-corner-right").filter(":first").addClass(t ? "ui-corner-left" : "ui-corner-right").end().filter(":last").addClass(t ? "ui-corner-right" : "ui-corner-left").end().end()
        },destroy: function() {
            this.element.removeClass("ui-buttonset"), this.buttons.map(function() {
                return e(this).button("widget")[0]
            }).removeClass("ui-corner-left ui-corner-right").end().button("destroy"), e.Widget.prototype.destroy.call(this)
        }})
}(jQuery), function(e, t) {
    var n = {buttons: !0,height: !0,maxHeight: !0,maxWidth: !0,minHeight: !0,minWidth: !0,width: !0}, r = {maxHeight: !0,maxWidth: !0,minHeight: !0,minWidth: !0}, i = e.attrFn || {val: !0,css: !0,html: !0,text: !0,data: !0,width: !0,height: !0,offset: !0,click: !0};
    e.widget("ui.dialog", {options: {autoOpen: !0,buttons: {},closeOnEscape: !0,closeText: "close",dialogClass: "",draggable: !0,hide: null,height: "auto",maxHeight: !1,maxWidth: !1,minHeight: 150,minWidth: 150,modal: !1,position: {my: "center",at: "center",collision: "fit",using: function(t) {
                    var n = e(this).css(t).offset().top;
                    n < 0 && e(this).css("top", t.top - n)
                }},resizable: !0,show: null,stack: !0,title: "",width: 300,zIndex: 1e3},_create: function() {
            this.originalTitle = this.element.attr("title"), typeof this.originalTitle != "string" && (this.originalTitle = ""), this.options.title = this.options.title || this.originalTitle;
            var t = this, n = t.options, r = n.title || "&#160;", i = e.ui.dialog.getTitleId(t.element), s = (t.uiDialog = e("<div></div>")).appendTo(document.body).hide().addClass("ui-dialog ui-widget ui-widget-content ui-corner-all " + n.dialogClass).css({zIndex: n.zIndex}).attr("tabIndex", -1).css("outline", 0).keydown(function(r) {
                n.closeOnEscape && !r.isDefaultPrevented() && r.keyCode && r.keyCode === e.ui.keyCode.ESCAPE && (t.close(r), r.preventDefault())
            }).attr({role: "dialog","aria-labelledby": i}).mousedown(function(e) {
                t.moveToTop(!1, e)
            });
            t.element.show().removeAttr("title").addClass("ui-dialog-content ui-widget-content").appendTo(s);
            var o = (t.uiDialogTitlebar = e("<div></div>")).addClass("ui-dialog-titlebar ui-widget-header ui-corner-all ui-helper-clearfix").prependTo(s), u = e('<a href="#"></a>').addClass("ui-dialog-titlebar-close ui-corner-all").attr("role", "button").hover(function() {
                u.addClass("ui-state-hover")
            }, function() {
                u.removeClass("ui-state-hover")
            }).focus(function() {
                u.addClass("ui-state-focus")
            }).blur(function() {
                u.removeClass("ui-state-focus")
            }).click(function(e) {
                return t.close(e), !1
            }).appendTo(o);
            (t.uiDialogTitlebarCloseText = e("<span></span>")).addClass("ui-icon ui-icon-closethick").text(n.closeText).appendTo(u), e("<span></span>").addClass("ui-dialog-title").attr("id", i).html(r).prependTo(o), e.isFunction(n.beforeclose) && !e.isFunction(n.beforeClose) && (n.beforeClose = n.beforeclose), o.find("*").add(o).disableSelection(), n.draggable && e.fn.draggable && t._makeDraggable(), n.resizable && e.fn.resizable && t._makeResizable(), t._createButtons(n.buttons), t._isOpen = !1, e.fn.bgiframe && s.bgiframe()
        },_init: function() {
            this.options.autoOpen && this.open()
        },destroy: function() {
            var e = this;
            return e.overlay && e.overlay.destroy(), e.uiDialog.hide(), e.element.unbind(".dialog").removeData("dialog").removeClass("ui-dialog-content ui-widget-content").hide().appendTo("body"), e.uiDialog.remove(), e.originalTitle && e.element.attr("title", e.originalTitle), e
        },widget: function() {
            return this.uiDialog
        },close: function(t) {
            var n = this, r, i;
            if (!1 !== n._trigger("beforeClose", t))
                return n.overlay && n.overlay.destroy(), n.uiDialog.unbind("keypress.ui-dialog"), n._isOpen = !1, n.options.hide ? n.uiDialog.hide(n.options.hide, function() {
                    n._trigger("close", t)
                }) : (n.uiDialog.hide(), n._trigger("close", t)), e.ui.dialog.overlay.resize(), n.options.modal && (r = 0, e(".ui-dialog").each(function() {
                    this !== n.uiDialog[0] && (i = e(this).css("z-index"), isNaN(i) || (r = Math.max(r, i)))
                }), e.ui.dialog.maxZ = r), n
        },isOpen: function() {
            return this._isOpen
        },moveToTop: function(t, n) {
            var r = this, i = r.options;
            return i.modal && !t || !i.stack && !i.modal ? r._trigger("focus", n) : (i.zIndex > e.ui.dialog.maxZ && (e.ui.dialog.maxZ = i.zIndex), r.overlay && (e.ui.dialog.maxZ += 1, r.overlay.$el.css("z-index", e.ui.dialog.overlay.maxZ = e.ui.dialog.maxZ)), t = {scrollTop: r.element.scrollTop(),scrollLeft: r.element.scrollLeft()}, e.ui.dialog.maxZ += 1, r.uiDialog.css("z-index", e.ui.dialog.maxZ), r.element.attr(t), r._trigger("focus", n), r)
        },open: function() {
            if (!this._isOpen) {
                var t = this, n = t.options, r = t.uiDialog;
                return t.overlay = n.modal ? new e.ui.dialog.overlay(t) : null, t._size(), t._position(n.position), r.show(n.show), t.moveToTop(!0), n.modal && r.bind("keypress.ui-dialog", function(t) {
                    if (t.keyCode === e.ui.keyCode.TAB) {
                        var n = e(":tabbable", this), r = n.filter(":first");
                        n = n.filter(":last");
                        if (t.target === n[0] && !t.shiftKey)
                            return r.focus(1), !1;
                        if (t.target === r[0] && t.shiftKey)
                            return n.focus(1), !1
                    }
                }), e(t.element.find(":tabbable").get().concat(r.find(".ui-dialog-buttonpane :tabbable").get().concat(r.get()))).eq(0).focus(), t._isOpen = !0, t._trigger("open"), t
            }
        },_createButtons: function(t) {
            var n = this, r = !1, s = e("<div></div>").addClass("ui-dialog-buttonpane ui-widget-content ui-helper-clearfix"), u = e("<div></div>").addClass("ui-dialog-buttonset").appendTo(s);
            n.uiDialog.find(".ui-dialog-buttonpane").remove(), typeof t == "object" && t !== null && e.each(t, function() {
                return !(r = !0)
            }), r && (e.each(t, function(t, r) {
                r = e.isFunction(r) ? {click: r,text: t} : r;
                var s = e('<button type="button"></button>').click(function() {
                    r.click.apply(n.element[0], arguments)
                }).appendTo(u);
                e.each(r, function(e, t) {
                    e !== "click" && (e in i ? s[e](t) : s.attr(e, t))
                }), e.fn.button && s.button()
            }), s.appendTo(n.uiDialog))
        },_makeDraggable: function() {
            function t(e) {
                return {position: e.position,offset: e.offset}
            }
            var n = this, r = n.options, i = e(document), s;
            n.uiDialog.draggable({cancel: ".ui-dialog-content, .ui-dialog-titlebar-close",handle: ".ui-dialog-titlebar",containment: "document",start: function(i, o) {
                    s = r.height === "auto" ? "auto" : e(this).height(), e(this).height(e(this).height()).addClass("ui-dialog-dragging"), n._trigger("dragStart", i, t(o))
                },drag: function(e, r) {
                    n._trigger("drag", e, t(r))
                },stop: function(o, u) {
                    r.position = [u.position.left - i.scrollLeft(), u.position.top - i.scrollTop()], e(this).removeClass("ui-dialog-dragging").height(s), n._trigger("dragStop", o, t(u)), e.ui.dialog.overlay.resize()
                }})
        },_makeResizable: function(n) {
            function r(e) {
                return {originalPosition: e.originalPosition,originalSize: e.originalSize,position: e.position,size: e.size}
            }
            n = n === t ? this.options.resizable : n;
            var i = this, s = i.options, o = i.uiDialog.css("position");
            n = typeof n == "string" ? n : "n,e,s,w,se,sw,ne,nw", i.uiDialog.resizable({cancel: ".ui-dialog-content",containment: "document",alsoResize: i.element,maxWidth: s.maxWidth,maxHeight: s.maxHeight,minWidth: s.minWidth,minHeight: i._minHeight(),handles: n,start: function(t, n) {
                    e(this).addClass("ui-dialog-resizing"), i._trigger("resizeStart", t, r(n))
                },resize: function(e, t) {
                    i._trigger("resize", e, r(t))
                },stop: function(t, n) {
                    e(this).removeClass("ui-dialog-resizing"), s.height = e(this).height(), s.width = e(this).width(), i._trigger("resizeStop", t, r(n)), e.ui.dialog.overlay.resize()
                }}).css("position", o).find(".ui-resizable-se").addClass("ui-icon ui-icon-grip-diagonal-se")
        },_minHeight: function() {
            var e = this.options;
            return e.height === "auto" ? e.minHeight : Math.min(e.minHeight, e.height)
        },_position: function(t) {
            var n = [], r = [0, 0], i;
            if (t) {
                if (typeof t == "string" || typeof t == "object" && "0" in t)
                    n = t.split ? t.split(" ") : [t[0], t[1]], n.length === 1 && (n[1] = n[0]), e.each(["left", "top"], function(e, t) {
                        +n[e] === n[e] && (r[e] = n[e], n[e] = t)
                    }), t = {my: n.join(" "),at: n.join(" "),offset: r.join(" ")};
                t = e.extend({}, e.ui.dialog.prototype.options.position, t)
            } else
                t = e.ui.dialog.prototype.options.position;
            (i = this.uiDialog.is(":visible")) || this.uiDialog.show(), this.uiDialog.css({top: 0,left: 0}).position(e.extend({of: window}, t)), i || this.uiDialog.hide()
        },_setOptions: function(t) {
            var i = this, s = {}, o = !1;
            e.each(t, function(e, t) {
                i._setOption(e, t), e in n && (o = !0), e in r && (s[e] = t)
            }), o && this._size(), this.uiDialog.is(":data(resizable)") && this.uiDialog.resizable("option", s)
        },_setOption: function(t, n) {
            var r = this, i = r.uiDialog;
            switch (t) {
                case "beforeclose":
                    t = "beforeClose";
                    break;
                case "buttons":
                    r._createButtons(n);
                    break;
                case "closeText":
                    r.uiDialogTitlebarCloseText.text("" + n);
                    break;
                case "dialogClass":
                    i.removeClass(r.options.dialogClass).addClass("ui-dialog ui-widget ui-widget-content ui-corner-all " + n);
                    break;
                case "disabled":
                    n ? i.addClass("ui-dialog-disabled") : i.removeClass("ui-dialog-disabled");
                    break;
                case "draggable":
                    var s = i.is(":data(draggable)");
                    s && !n && i.draggable("destroy"), !s && n && r._makeDraggable();
                    break;
                case "position":
                    r._position(n);
                    break;
                case "resizable":
                    (s = i.is(":data(resizable)")) && !n && i.resizable("destroy"), s && typeof n == "string" && i.resizable("option", "handles", n), !s && n !== !1 && r._makeResizable(n);
                    break;
                case "title":
                    e(".ui-dialog-title", r.uiDialogTitlebar).html("" + (n || "&#160;"))
            }
            e.Widget.prototype._setOption.apply(r, arguments)
        },_size: function() {
            var t = this.options, n, r, i = this.uiDialog.is(":visible");
            this.element.show().css({width: "auto",minHeight: 0,height: 0}), t.minWidth > t.width && (t.width = t.minWidth), n = this.uiDialog.css({height: "auto",width: t.width}).height(), r = Math.max(0, t.minHeight - n), t.height === "auto" ? e.support.minHeight ? this.element.css({minHeight: r,height: "auto"}) : (this.uiDialog.show(), t = this.element.css("height", "auto").height(), i || this.uiDialog.hide(), this.element.height(Math.max(t, r))) : this.element.height(Math.max(t.height - n, 0)), this.uiDialog.is(":data(resizable)") && this.uiDialog.resizable("option", "minHeight", this._minHeight())
        }}), e.extend(e.ui.dialog, {version: "1.8.16",uuid: 0,maxZ: 0,getTitleId: function(e) {
            return e = e.attr("id"), e || (this.uuid += 1, e = this.uuid), "ui-dialog-title-" + e
        },overlay: function(t) {
            this.$el = e.ui.dialog.overlay.create(t)
        }}), e.extend(e.ui.dialog.overlay, {instances: [],oldInstances: [],maxZ: 0,events: e.map("focus,mousedown,mouseup,keydown,keypress,click".split(","), function(e) {
            return e + ".dialog-overlay"
        }).join(" "),create: function(t) {
            this.instances.length === 0 && (setTimeout(function() {
                e.ui.dialog.overlay.instances.length && e(document).bind(e.ui.dialog.overlay.events, function(t) {
                    if (e(t.target).zIndex() < e.ui.dialog.overlay.maxZ)
                        return !1
                })
            }, 1), e(document).bind("keydown.dialog-overlay", function(n) {
                t.options.closeOnEscape && !n.isDefaultPrevented() && n.keyCode && n.keyCode === e.ui.keyCode.ESCAPE && (t.close(n), n.preventDefault())
            }), e(window).bind("resize.dialog-overlay", e.ui.dialog.overlay.resize));
            var n = (this.oldInstances.pop() || e("<div></div>").addClass("ui-widget-overlay")).appendTo(document.body).css({width: this.width(),height: this.height()});
            return e.fn.bgiframe && n.bgiframe(), this.instances.push(n), n
        },destroy: function(t) {
            var n = e.inArray(t, this.instances);
            n != -1 && this.oldInstances.push(this.instances.splice(n, 1)[0]), this.instances.length === 0 && e([document, window]).unbind(".dialog-overlay"), t.remove();
            var r = 0;
            e.each(this.instances, function() {
                r = Math.max(r, this.css("z-index"))
            }), this.maxZ = r
        },height: function() {
            var t, n;
            return e.browser.msie && e.browser.version < 7 ? (t = Math.max(document.documentElement.scrollHeight, document.body.scrollHeight), n = Math.max(document.documentElement.offsetHeight, document.body.offsetHeight), t < n ? e(window).height() + "px" : t + "px") : e(document).height() + "px"
        },width: function() {
            var t, n;
            return e.browser.msie ? (t = Math.max(document.documentElement.scrollWidth, document.body.scrollWidth), n = Math.max(document.documentElement.offsetWidth, document.body.offsetWidth), t < n ? e(window).width() + "px" : t + "px") : e(document).width() + "px"
        },resize: function() {
            var t = e([]);
            e.each(e.ui.dialog.overlay.instances, function() {
                t = t.add(this)
            }), t.css({width: 0,height: 0}).css({width: e.ui.dialog.overlay.width(),height: e.ui.dialog.overlay.height()})
        }}), e.extend(e.ui.dialog.overlay.prototype, {destroy: function() {
            e.ui.dialog.overlay.destroy(this.$el)
        }})
}(jQuery), function(e) {
    e.widget("ui.slider", e.ui.mouse, {widgetEventPrefix: "slide",options: {animate: !1,distance: 0,max: 100,min: 0,orientation: "horizontal",range: !1,step: 1,value: 0,values: null},_create: function() {
            var t = this, n = this.options, r = this.element.find(".ui-slider-handle").addClass("ui-state-default ui-corner-all"), i = n.values && n.values.length || 1, s = [];
            this._mouseSliding = this._keySliding = !1, this._animateOff = !0, this._handleIndex = null, this._detectOrientation(), this._mouseInit(), this.element.addClass("ui-slider ui-slider-" + this.orientation + " ui-widget ui-widget-content ui-corner-all" + (n.disabled ? " ui-slider-disabled ui-disabled" : "")), this.range = e([]), n.range && (n.range === !0 && (n.values || (n.values = [this._valueMin(), this._valueMin()]), n.values.length && n.values.length !== 2 && (n.values = [n.values[0], n.values[0]])), this.range = e("<div></div>").appendTo(this.element).addClass("ui-slider-range ui-widget-header" + (n.range === "min" || n.range === "max" ? " ui-slider-range-" + n.range : "")));
            for (var o = r.length; o < i; o += 1)
                s.push("<a class='ui-slider-handle ui-state-default ui-corner-all' href='#'></a>");
            this.handles = r.add(e(s.join("")).appendTo(t.element)), this.handle = this.handles.eq(0), this.handles.add(this.range).filter("a").click(function(e) {
                e.preventDefault()
            }).hover(function() {
                n.disabled || e(this).addClass("ui-state-hover")
            }, function() {
                e(this).removeClass("ui-state-hover")
            }).focus(function() {
                n.disabled ? e(this).blur() : (e(".ui-slider .ui-state-focus").removeClass("ui-state-focus"), e(this).addClass("ui-state-focus"))
            }).blur(function() {
                e(this).removeClass("ui-state-focus")
            }), this.handles.each(function(t) {
                e(this).data("index.ui-slider-handle", t)
            }), this.handles.keydown(function(n) {
                var r = !0, i = e(this).data("index.ui-slider-handle"), s, o, u;
                if (!t.options.disabled) {
                    switch (n.keyCode) {
                        case e.ui.keyCode.HOME:
                        case e.ui.keyCode.END:
                        case e.ui.keyCode.PAGE_UP:
                        case e.ui.keyCode.PAGE_DOWN:
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            r = !1;
                            if (!t._keySliding) {
                                t._keySliding = !0, e(this).addClass("ui-state-active"), s = t._start(n, i);
                                if (s === !1)
                                    return
                            }
                    }
                    u = t.options.step, s = t.options.values && t.options.values.length ? o = t.values(i) : o = t.value();
                    switch (n.keyCode) {
                        case e.ui.keyCode.HOME:
                            o = t._valueMin();
                            break;
                        case e.ui.keyCode.END:
                            o = t._valueMax();
                            break;
                        case e.ui.keyCode.PAGE_UP:
                            o = t._trimAlignValue(s + (t._valueMax() - t._valueMin()) / 5);
                            break;
                        case e.ui.keyCode.PAGE_DOWN:
                            o = t._trimAlignValue(s - (t._valueMax() - t._valueMin()) / 5);
                            break;
                        case e.ui.keyCode.UP:
                        case e.ui.keyCode.RIGHT:
                            if (s === t._valueMax())
                                return;
                            o = t._trimAlignValue(s + u);
                            break;
                        case e.ui.keyCode.DOWN:
                        case e.ui.keyCode.LEFT:
                            if (s === t._valueMin())
                                return;
                            o = t._trimAlignValue(s - u)
                    }
                    return t._slide(n, i, o), r
                }
            }).keyup(function(n) {
                var r = e(this).data("index.ui-slider-handle");
                t._keySliding && (t._keySliding = !1, t._stop(n, r), t._change(n, r), e(this).removeClass("ui-state-active"))
            }), this._refreshValue(), this._animateOff = !1
        },destroy: function() {
            return this.handles.remove(), this.range.remove(), this.element.removeClass("ui-slider ui-slider-horizontal ui-slider-vertical ui-slider-disabled ui-widget ui-widget-content ui-corner-all").removeData("slider").unbind(".slider"), this._mouseDestroy(), this
        },_mouseCapture: function(t) {
            var n = this.options, r, i, s, o, u;
            return n.disabled ? !1 : (this.elementSize = {width: this.element.outerWidth(),height: this.element.outerHeight()}, this.elementOffset = this.element.offset(), r = this._normValueFromMouse({x: t.pageX,y: t.pageY}), i = this._valueMax() - this._valueMin() + 1, o = this, this.handles.each(function(t) {
                var n = Math.abs(r - o.values(t));
                i > n && (i = n, s = e(this), u = t)
            }), n.range === !0 && this.values(1) === n.min && (u += 1, s = e(this.handles[u])), this._start(t, u) === !1 ? !1 : (this._mouseSliding = !0, o._handleIndex = u, s.addClass("ui-state-active").focus(), n = s.offset(), this._clickOffset = e(t.target).parents().andSelf().is(".ui-slider-handle") ? {left: t.pageX - n.left - s.width() / 2,top: t.pageY - n.top - s.height() / 2 - (parseInt(s.css("borderTopWidth"), 10) || 0) - (parseInt(s.css("borderBottomWidth"), 10) || 0) + (parseInt(s.css("marginTop"), 10) || 0)} : {left: 0,top: 0}, this.handles.hasClass("ui-state-hover") || this._slide(t, u, r), this._animateOff = !0))
        },_mouseStart: function() {
            return !0
        },_mouseDrag: function(e) {
            var t = this._normValueFromMouse({x: e.pageX,y: e.pageY});
            return this._slide(e, this._handleIndex, t), !1
        },_mouseStop: function(e) {
            return this.handles.removeClass("ui-state-active"), this._mouseSliding = !1, this._stop(e, this._handleIndex), this._change(e, this._handleIndex), this._clickOffset = this._handleIndex = null, this._animateOff = !1
        },_detectOrientation: function() {
            this.orientation = this.options.orientation === "vertical" ? "vertical" : "horizontal"
        },_normValueFromMouse: function(e) {
            var t;
            return this.orientation === "horizontal" ? (t = this.elementSize.width, e = e.x - this.elementOffset.left - (this._clickOffset ? this._clickOffset.left : 0)) : (t = this.elementSize.height, e = e.y - this.elementOffset.top - (this._clickOffset ? this._clickOffset.top : 0)), t = e / t, t > 1 && (t = 1), t < 0 && (t = 0), this.orientation === "vertical" && (t = 1 - t), e = this._valueMax() - this._valueMin(), this._trimAlignValue(this._valueMin() + t * e)
        },_start: function(e, t) {
            var n = {handle: this.handles[t],value: this.value()};
            return this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("start", e, n)
        },_slide: function(e, t, n) {
            var r;
            this.options.values && this.options.values.length ? (r = this.values(t ? 0 : 1), this.options.values.length === 2 && this.options.range === !0 && (t === 0 && n > r || t === 1 && n < r) && (n = r), n !== this.values(t) && (r = this.values(), r[t] = n, e = this._trigger("slide", e, {handle: this.handles[t],value: n,values: r}), this.values(t ? 0 : 1), e !== !1 && this.values(t, n, !0))) : n !== this.value() && (e = this._trigger("slide", e, {handle: this.handles[t],value: n}), e !== !1 && this.value(n))
        },_stop: function(e, t) {
            var n = {handle: this.handles[t],value: this.value()};
            this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("stop", e, n)
        },_change: function(e, t) {
            if (!this._keySliding && !this._mouseSliding) {
                var n = {handle: this.handles[t],value: this.value()};
                this.options.values && this.options.values.length && (n.value = this.values(t), n.values = this.values()), this._trigger("change", e, n)
            }
        },value: function(e) {
            if (!arguments.length)
                return this._value();
            this.options.value = this._trimAlignValue(e), this._refreshValue(), this._change(null, 0)
        },values: function(t, n) {
            var r, i, s;
            if (arguments.length > 1)
                this.options.values[t] = this._trimAlignValue(n), this._refreshValue(), this._change(null, t);
            else {
                if (!arguments.length)
                    return this._values();
                if (!e.isArray(arguments[0]))
                    return this.options.values && this.options.values.length ? this._values(t) : this.value();
                r = this.options.values, i = arguments[0];
                for (s = 0; s < r.length; s += 1)
                    r[s] = this._trimAlignValue(i[s]), this._change(null, s);
                this._refreshValue()
            }
        },_setOption: function(t, n) {
            var r, i = 0;
            e.isArray(this.options.values) && (i = this.options.values.length), e.Widget.prototype._setOption.apply(this, arguments);
            switch (t) {
                case "disabled":
                    n ? (this.handles.filter(".ui-state-focus").blur(), this.handles.removeClass("ui-state-hover"), this.handles.propAttr("disabled", !0), this.element.addClass("ui-disabled")) : (this.handles.propAttr("disabled", !1), this.element.removeClass("ui-disabled"));
                    break;
                case "orientation":
                    this._detectOrientation(), this.element.removeClass("ui-slider-horizontal ui-slider-vertical").addClass("ui-slider-" + this.orientation), this._refreshValue();
                    break;
                case "value":
                    this._animateOff = !0, this._refreshValue(), this._change(null, 0), this._animateOff = !1;
                    break;
                case "values":
                    this._animateOff = !0, this._refreshValue();
                    for (r = 0; r < i; r += 1)
                        this._change(null, r);
                    this._animateOff = !1
            }
        },_value: function() {
            var e = this.options.value;
            return e = this._trimAlignValue(e)
        },_values: function(e) {
            var t, n;
            if (arguments.length)
                return t = this.options.values[e], t = this._trimAlignValue(t);
            t = this.options.values.slice();
            for (n = 0; n < t.length; n += 1)
                t[n] = this._trimAlignValue(t[n]);
            return t
        },_trimAlignValue: function(e) {
            if (e <= this._valueMin())
                return this._valueMin();
            if (e >= this._valueMax())
                return this._valueMax();
            var t = this.options.step > 0 ? this.options.step : 1, n = (e - this._valueMin()) % t;
            return e -= n, Math.abs(n) * 2 >= t && (e += n > 0 ? t : -t), parseFloat(e.toFixed(5))
        },_valueMin: function() {
            return this.options.min
        },_valueMax: function() {
            return this.options.max
        },_refreshValue: function() {
            var t = this.options.range, n = this.options, r = this, i = this._animateOff ? !1 : n.animate, s, o = {}, u, a, f, l;
            this.options.values && this.options.values.length ? this.handles.each(function(t) {
                s = (r.values(t) - r._valueMin()) / (r._valueMax() - r._valueMin()) * 100, o[r.orientation === "horizontal" ? "left" : "bottom"] = s + "%", e(this).stop(1, 1)[i ? "animate" : "css"](o, n.animate), r.options.range === !0 && (r.orientation === "horizontal" ? (t === 0 && r.range.stop(1, 1)[i ? "animate" : "css"]({left: s + "%"}, n.animate), t === 1 && r.range[i ? "animate" : "css"]({width: s - u + "%"}, {queue: !1,duration: n.animate})) : (t === 0 && r.range.stop(1, 1)[i ? "animate" : "css"]({bottom: s + "%"}, n.animate), t === 1 && r.range[i ? "animate" : "css"]({height: s - u + "%"}, {queue: !1,duration: n.animate}))), u = s
            }) : (a = this.value(), f = this._valueMin(), l = this._valueMax(), s = l !== f ? (a - f) / (l - f) * 100 : 0, o[r.orientation === "horizontal" ? "left" : "bottom"] = s + "%", this.handle.stop(1, 1)[i ? "animate" : "css"](o, n.animate), t === "min" && this.orientation === "horizontal" && this.range.stop(1, 1)[i ? "animate" : "css"]({width: s + "%"}, n.animate), t === "max" && this.orientation === "horizontal" && this.range[i ? "animate" : "css"]({width: 100 - s + "%"}, {queue: !1,duration: n.animate}), t === "min" && this.orientation === "vertical" && this.range.stop(1, 1)[i ? "animate" : "css"]({height: s + "%"}, n.animate), t === "max" && this.orientation === "vertical" && this.range[i ? "animate" : "css"]({height: 100 - s + "%"}, {queue: !1,duration: n.animate}))
        }}), e.extend(e.ui.slider, {version: "1.8.16"})
}(jQuery), function(e, n) {
    function r() {
        return ++s
    }
    function i() {
        return ++o
    }
    var s = 0, o = 0;
    e.widget("ui.tabs", {options: {add: null,ajaxOptions: null,cache: !1,cookie: null,collapsible: !1,disable: null,disabled: [],enable: null,event: "click",fx: null,idPrefix: "ui-tabs-",load: null,panelTemplate: "<div></div>",remove: null,select: null,show: null,spinner: "<em>Loading&#8230;</em>",tabTemplate: "<li><a href='#{href}'><span>#{label}</span></a></li>"},_create: function() {
            this._tabify(!0)
        },_setOption: function(e, t) {
            e == "selected" ? this.options.collapsible && t == this.options.selected || this.select(t) : (this.options[e] = t, this._tabify())
        },_tabId: function(e) {
            return e.title && e.title.replace(/\s/g, "_").replace(/[^\w\u00c0-\uFFFF-]/g, "") || this.options.idPrefix + r()
        },_sanitizeSelector: function(e) {
            return e.replace(/:/g, "\\:")
        },_cookie: function() {
            var t = this.cookie || (this.cookie = this.options.cookie.name || "ui-tabs-" + i());
            return e.cookie.apply(null, [t].concat(e.makeArray(arguments)))
        },_ui: function(e, t) {
            return {tab: e,panel: t,index: this.anchors.index(e)}
        },_cleanup: function() {
            this.lis.filter(".ui-state-processing").removeClass("ui-state-processing").find("span:data(label.tabs)").each(function() {
                var t = e(this);
                t.html(t.data("label.tabs")).removeData("label.tabs")
            })
        },_tabify: function(t) {
            function r(t, n) {
                t.css("display", ""), !e.support.opacity && n.opacity && t[0].style.removeAttribute("filter")
            }
            var i = this, s = this.options, o = /^#.+/;
            this.list = this.element.find("ol,ul").eq(0), this.lis = e(" > li:has(a[href])", this.list), this.anchors = this.lis.map(function() {
                return e("a", this)[0]
            }), this.panels = e([]), this.anchors.each(function(t, n) {
                var r = e(n).attr("href"), u = r.split("#")[0], a;
                u && (u === location.toString().split("#")[0] || (a = e("base")[0]) && u === a.href) && (r = n.hash, n.href = r), o.test(r) ? i.panels = i.panels.add(i.element.find(i._sanitizeSelector(r))) : r && r !== "#" ? (e.data(n, "href.tabs", r), e.data(n, "load.tabs", r.replace(/#.*$/, "")), r = i._tabId(n), n.href = "#" + r, n = i.element.find("#" + r), n.length || (n = e(s.panelTemplate).attr("id", r).addClass("ui-tabs-panel ui-widget-content ui-corner-bottom").insertAfter(i.panels[t - 1] || i.list), n.data("destroy.tabs", !0)), i.panels = i.panels.add(n)) : s.disabled.push(t)
            }), t ? (this.element.addClass("ui-tabs ui-widget ui-widget-content ui-corner-all"), this.list.addClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"), this.lis.addClass("ui-state-default ui-corner-top"), this.panels.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom"), s.selected === n ? (location.hash && this.anchors.each(function(e, t) {
                if (t.hash == location.hash)
                    return s.selected = e, !1
            }), typeof s.selected != "number" && s.cookie && (s.selected = parseInt(i._cookie(), 10)), typeof s.selected != "number" && this.lis.filter(".ui-tabs-selected").length && (s.selected = this.lis.index(this.lis.filter(".ui-tabs-selected"))), s.selected = s.selected || (this.lis.length ? 0 : -1)) : s.selected === null && (s.selected = -1), s.selected = s.selected >= 0 && this.anchors[s.selected] || s.selected < 0 ? s.selected : 0, s.disabled = e.unique(s.disabled.concat(e.map(this.lis.filter(".ui-state-disabled"), function(e) {
                return i.lis.index(e)
            }))).sort(), e.inArray(s.selected, s.disabled) != -1 && s.disabled.splice(e.inArray(s.selected, s.disabled), 1), this.panels.addClass("ui-tabs-hide"), this.lis.removeClass("ui-tabs-selected ui-state-active"), s.selected >= 0 && this.anchors.length && (i.element.find(i._sanitizeSelector(i.anchors[s.selected].hash)).removeClass("ui-tabs-hide"), this.lis.eq(s.selected).addClass("ui-tabs-selected ui-state-active"), i.element.queue("tabs", function() {
                i._trigger("show", null, i._ui(i.anchors[s.selected], i.element.find(i._sanitizeSelector(i.anchors[s.selected].hash))[0]))
            }), this.load(s.selected)), e(window).bind("unload", function() {
                i.lis.add(i.anchors).unbind(".tabs"), i.lis = i.anchors = i.panels = null
            })) : s.selected = this.lis.index(this.lis.filter(".ui-tabs-selected")), this.element[s.collapsible ? "addClass" : "removeClass"]("ui-tabs-collapsible"), s.cookie && this._cookie(s.selected, s.cookie), t = 0;
            for (var u; u = this.lis[t]; t++)
                e(u)[e.inArray(t, s.disabled) != -1 && !e(u).hasClass("ui-tabs-selected") ? "addClass" : "removeClass"]("ui-state-disabled");
            s.cache === !1 && this.anchors.removeData("cache.tabs"), this.lis.add(this.anchors).unbind(".tabs");
            if (s.event !== "mouseover") {
                var a = function(e, t) {
                    t.is(":not(.ui-state-disabled)") && t.addClass("ui-state-" + e)
                }, f = function(e, t) {
                    t.removeClass("ui-state-" + e)
                };
                this.lis.bind("mouseover.tabs", function() {
                    a("hover", e(this))
                }), this.lis.bind("mouseout.tabs", function() {
                    f("hover", e(this))
                }), this.anchors.bind("focus.tabs", function() {
                    a("focus", e(this).closest("li"))
                }), this.anchors.bind("blur.tabs", function() {
                    f("focus", e(this).closest("li"))
                })
            }
            var l, c;
            s.fx && (e.isArray(s.fx) ? (l = s.fx[0], c = s.fx[1]) : l = c = s.fx);
            var h = c ? function(t, n) {
                e(t).closest("li").addClass("ui-tabs-selected ui-state-active"), n.hide().removeClass("ui-tabs-hide").animate(c, c.duration || "normal", function() {
                    r(n, c), i._trigger("show", null, i._ui(t, n[0]))
                })
            } : function(t, n) {
                e(t).closest("li").addClass("ui-tabs-selected ui-state-active"), n.removeClass("ui-tabs-hide"), i._trigger("show", null, i._ui(t, n[0]))
            }, v = l ? function(e, t) {
                t.animate(l, l.duration || "normal", function() {
                    i.lis.removeClass("ui-tabs-selected ui-state-active"), t.addClass("ui-tabs-hide"), r(t, l), i.element.dequeue("tabs")
                })
            } : function(e, t) {
                i.lis.removeClass("ui-tabs-selected ui-state-active"), t.addClass("ui-tabs-hide"), i.element.dequeue("tabs")
            };
            this.anchors.bind(s.event + ".tabs", function() {
                var t = this, n = e(t).closest("li"), r = i.panels.filter(":not(.ui-tabs-hide)"), o = i.element.find(i._sanitizeSelector(t.hash));
                if (n.hasClass("ui-tabs-selected") && !s.collapsible || n.hasClass("ui-state-disabled") || n.hasClass("ui-state-processing") || i.panels.filter(":animated").length || i._trigger("select", null, i._ui(this, o[0])) === !1)
                    return this.blur(), !1;
                s.selected = i.anchors.index(this), i.abort();
                if (s.collapsible) {
                    if (n.hasClass("ui-tabs-selected"))
                        return s.selected = -1, s.cookie && i._cookie(s.selected, s.cookie), i.element.queue("tabs", function() {
                            v(t, r)
                        }).dequeue("tabs"), this.blur(), !1;
                    if (!r.length)
                        return s.cookie && i._cookie(s.selected, s.cookie), i.element.queue("tabs", function() {
                            h(t, o)
                        }), i.load(i.anchors.index(this)), this.blur(), !1
                }
                s.cookie && i._cookie(s.selected, s.cookie);
                if (!o.length)
                    throw "jQuery UI Tabs: Mismatching fragment identifier.";
                r.length && i.element.queue("tabs", function() {
                    v(t, r)
                }), i.element.queue("tabs", function() {
                    h(t, o)
                }), i.load(i.anchors.index(this)), e.browser.msie && this.blur()
            }), this.anchors.bind("click.tabs", function() {
                return !1
            })
        },_getIndex: function(e) {
            return typeof e == "string" && (e = this.anchors.index(this.anchors.filter("[href$=" + e + "]"))), e
        },destroy: function() {
            var t = this.options;
            return this.abort(), this.element.unbind(".tabs").removeClass("ui-tabs ui-widget ui-widget-content ui-corner-all ui-tabs-collapsible").removeData("tabs"), this.list.removeClass("ui-tabs-nav ui-helper-reset ui-helper-clearfix ui-widget-header ui-corner-all"), this.anchors.each(function() {
                var t = e.data(this, "href.tabs");
                t && (this.href = t);
                var n = e(this).unbind(".tabs");
                e.each(["href", "load", "cache"], function(e, t) {
                    n.removeData(t + ".tabs")
                })
            }), this.lis.unbind(".tabs").add(this.panels).each(function() {
                e.data(this, "destroy.tabs") ? e(this).remove() : e(this).removeClass("ui-state-default ui-corner-top ui-tabs-selected ui-state-active ui-state-hover ui-state-focus ui-state-disabled ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide")
            }), t.cookie && this._cookie(null, t.cookie), this
        },add: function(t, r, i) {
            i === n && (i = this.anchors.length);
            var s = this, o = this.options;
            r = e(o.tabTemplate.replace(/#\{href\}/g, t).replace(/#\{label\}/g, r)), t = t.indexOf("#") ? this._tabId(e("a", r)[0]) : t.replace("#", ""), r.addClass("ui-state-default ui-corner-top").data("destroy.tabs", !0);
            var u = s.element.find("#" + t);
            return u.length || (u = e(o.panelTemplate).attr("id", t).data("destroy.tabs", !0)), u.addClass("ui-tabs-panel ui-widget-content ui-corner-bottom ui-tabs-hide"), i >= this.lis.length ? (r.appendTo(this.list), u.appendTo(this.list[0].parentNode)) : (r.insertBefore(this.lis[i]), u.insertBefore(this.panels[i])), o.disabled = e.map(o.disabled, function(e) {
                return e >= i ? ++e : e
            }), this._tabify(), this.anchors.length == 1 && (o.selected = 0, r.addClass("ui-tabs-selected ui-state-active"), u.removeClass("ui-tabs-hide"), this.element.queue("tabs", function() {
                s._trigger("show", null, s._ui(s.anchors[0], s.panels[0]))
            }), this.load(0)), this._trigger("add", null, this._ui(this.anchors[i], this.panels[i])), this
        },remove: function(t) {
            t = this._getIndex(t);
            var n = this.options, r = this.lis.eq(t).remove(), i = this.panels.eq(t).remove();
            return r.hasClass("ui-tabs-selected") && this.anchors.length > 1 && this.select(t + (t + 1 < this.anchors.length ? 1 : -1)), n.disabled = e.map(e.grep(n.disabled, function(e) {
                return e != t
            }), function(e) {
                return e >= t ? --e : e
            }), this._tabify(), this._trigger("remove", null, this._ui(r.find("a")[0], i[0])), this
        },enable: function(t) {
            t = this._getIndex(t);
            var n = this.options;
            if (e.inArray(t, n.disabled) != -1)
                return this.lis.eq(t).removeClass("ui-state-disabled"), n.disabled = e.grep(n.disabled, function(e) {
                    return e != t
                }), this._trigger("enable", null, this._ui(this.anchors[t], this.panels[t])), this
        },disable: function(e) {
            e = this._getIndex(e);
            var t = this.options;
            return e != t.selected && (this.lis.eq(e).addClass("ui-state-disabled"), t.disabled.push(e), t.disabled.sort(), this._trigger("disable", null, this._ui(this.anchors[e], this.panels[e]))), this
        },select: function(e) {
            e = this._getIndex(e);
            if (e == -1) {
                if (!this.options.collapsible || this.options.selected == -1)
                    return this;
                e = this.options.selected
            }
            return this.anchors.eq(e).trigger(this.options.event + ".tabs"), this
        },load: function(t) {
            t = this._getIndex(t);
            var n = this, r = this.options, i = this.anchors.eq(t)[0], s = e.data(i, "load.tabs");
            this.abort();
            if (!(!s || this.element.queue("tabs").length !== 0 && e.data(i, "cache.tabs"))) {
                this.lis.eq(t).addClass("ui-state-processing");
                if (r.spinner) {
                    var o = e("span", i);
                    o.data("label.tabs", o.html()).html(r.spinner)
                }
                return this.xhr = e.ajax(e.extend({}, r.ajaxOptions, {url: s,success: function(s, o) {
                        n.element.find(n._sanitizeSelector(i.hash)).html(s), n._cleanup(), r.cache && e.data(i, "cache.tabs", !0), n._trigger("load", null, n._ui(n.anchors[t], n.panels[t]));
                        try {
                            r.ajaxOptions.success(s, o)
                        } catch (u) {
                        }
                    },error: function(e, s) {
                        n._cleanup(), n._trigger("load", null, n._ui(n.anchors[t], n.panels[t]));
                        try {
                            r.ajaxOptions.error(e, s, t, i)
                        } catch (o) {
                        }
                    }})), n.element.dequeue("tabs"), this
            }
            this.element.dequeue("tabs")
        },abort: function() {
            return this.element.queue([]), this.panels.stop(!1, !0), this.element.queue("tabs", this.element.queue("tabs").splice(-2, 2)), this.xhr && (this.xhr.abort(), delete this.xhr), this._cleanup(), this
        },url: function(e, t) {
            return this.anchors.eq(e).removeData("cache.tabs").data("load.tabs", t), this
        },length: function() {
            return this.anchors.length
        }}), e.extend(e.ui.tabs, {version: "1.8.16"}), e.extend(e.ui.tabs.prototype, {rotation: null,rotate: function(e, n) {
            var r = this, i = this.options, s = r._rotate || (r._rotate = function(t) {
                clearTimeout(r.rotation), r.rotation = setTimeout(function() {
                    var e = i.selected;
                    r.select(++e < r.anchors.length ? e : 0)
                }, e), t && t.stopPropagation()
            });
            return n = r._unrotate || (r._unrotate = n ? function() {
                t = i.selected, s()
            } : function(e) {
                e.clientX && r.rotate(null)
            }), e ? (this.element.bind("tabsshow", s), this.anchors.bind(i.event + ".tabs", n), s()) : (clearTimeout(r.rotation), this.element.unbind("tabsshow", s), this.anchors.unbind(i.event + ".tabs", n), delete this._rotate, delete this._unrotate), this
        }})
}(jQuery), function(e, t) {
    e.widget("ui.progressbar", {options: {value: 0,max: 100},min: 0,_create: function() {
            this.element.addClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").attr({role: "progressbar","aria-valuemin": this.min,"aria-valuemax": this.options.max,"aria-valuenow": this._value()}), this.valueDiv = e("<div class='ui-progressbar-value ui-widget-header ui-corner-left'></div>").appendTo(this.element), this.oldValue = this._value(), this._refreshValue()
        },destroy: function() {
            this.element.removeClass("ui-progressbar ui-widget ui-widget-content ui-corner-all").removeAttr("role").removeAttr("aria-valuemin").removeAttr("aria-valuemax").removeAttr("aria-valuenow"), this.valueDiv.remove(), e.Widget.prototype.destroy.apply(this, arguments)
        },value: function(e) {
            return e === t ? this._value() : (this._setOption("value", e), this)
        },_setOption: function(t, n) {
            t === "value" && (this.options.value = n, this._refreshValue(), this._value() === this.options.max && this._trigger("complete")), e.Widget.prototype._setOption.apply(this, arguments)
        },_value: function() {
            var e = this.options.value;
            return typeof e != "number" && (e = 0), Math.min(this.options.max, Math.max(this.min, e))
        },_percentage: function() {
            return 100 * this._value() / this.options.max
        },_refreshValue: function() {
            var e = this.value(), t = this._percentage();
            this.oldValue !== e && (this.oldValue = e, this._trigger("change")), this.valueDiv.toggle(e > this.min).toggleClass("ui-corner-right", e === this.options.max).width(t.toFixed(0) + "%"), this.element.attr("aria-valuenow", e)
        }}), e.extend(e.ui.progressbar, {version: "1.8.16"})
}(jQuery), jQuery.effects || function(e, t) {
    function n(t) {
        var n;
        return t && t.constructor == Array && t.length == 3 ? t : (n = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(t)) ? [parseInt(n[1], 10), parseInt(n[2], 10), parseInt(n[3], 10)] : (n = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(t)) ? [parseFloat(n[1]) * 2.55, parseFloat(n[2]) * 2.55, parseFloat(n[3]) * 2.55] : (n = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(t)) ? [parseInt(n[1], 16), parseInt(n[2], 16), parseInt(n[3], 16)] : (n = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(t)) ? [parseInt(n[1] + n[1], 16), parseInt(n[2] + n[2], 16), parseInt(n[3] + n[3], 16)] : /rgba\(0, 0, 0, 0\)/.exec(t) ? f.transparent : f[e.trim(t).toLowerCase()]
    }
    function r(t, r) {
        var i;
        do {
            i = e.curCSS(t, r);
            if (i != "" && i != "transparent" || e.nodeName(t, "body"))
                break;
            r = "backgroundColor"
        } while (t = t.parentNode);
        return n(i)
    }
    function i() {
        var e = document.defaultView ? document.defaultView.getComputedStyle(this, null) : this.currentStyle, t = {}, n, r;
        if (e && e.length && e[0] && e[e[0]])
            for (var i = e.length; i--; )
                n = e[i], typeof e[n] == "string" && (r = n.replace(/\-(\w)/g, function(e, t) {
                    return t.toUpperCase()
                }), t[r] = e[n]);
        else
            for (n in e)
                typeof e[n] == "string" && (t[n] = e[n]);
        return t
    }
    function s(t) {
        var n, r;
        for (n in t)
            r = t[n], (r == null || e.isFunction(r) || n in c || /scrollbar/.test(n) || !/color/i.test(n) && isNaN(parseFloat(r))) && delete t[n];
        return t
    }
    function o(e, t) {
        var n = {_: 0}, r;
        for (r in t)
            e[r] != t[r] && (n[r] = t[r]);
        return n
    }
    function u(t, n, r, i) {
        typeof t == "object" && (i = n, r = null, n = t, t = n.effect), e.isFunction(n) && (i = n, r = null, n = {});
        if (typeof n == "number" || e.fx.speeds[n])
            i = r, r = n, n = {};
        return e.isFunction(r) && (i = r, r = null), n = n || {}, r = r || n.duration, r = e.fx.off ? 0 : typeof r == "number" ? r : r in e.fx.speeds ? e.fx.speeds[r] : e.fx.speeds._default, i = i || n.complete, [t, n, r, i]
    }
    function a(t) {
        return !t || typeof t == "number" || e.fx.speeds[t] ? !0 : typeof t == "string" && !e.effects[t] ? !0 : !1
    }
    e.effects = {}, e.each(["backgroundColor", "borderBottomColor", "borderLeftColor", "borderRightColor", "borderTopColor", "borderColor", "color", "outlineColor"], function(t, i) {
        e.fx.step[i] = function(e) {
            e.colorInit || (e.start = r(e.elem, i), e.end = n(e.end), e.colorInit = !0), e.elem.style[i] = "rgb(" + Math.max(Math.min(parseInt(e.pos * (e.end[0] - e.start[0]) + e.start[0], 10), 255), 0) + "," + Math.max(Math.min(parseInt(e.pos * (e.end[1] - e.start[1]) + e.start[1], 10), 255), 0) + "," + Math.max(Math.min(parseInt(e.pos * (e.end[2] - e.start[2]) + e.start[2], 10), 255), 0) + ")"
        }
    });
    var f = {aqua: [0, 255, 255],azure: [240, 255, 255],beige: [245, 245, 220],black: [0, 0, 0],blue: [0, 0, 255],brown: [165, 42, 42],cyan: [0, 255, 255],darkblue: [0, 0, 139],darkcyan: [0, 139, 139],darkgrey: [169, 169, 169],darkgreen: [0, 100, 0],darkkhaki: [189, 183, 107],darkmagenta: [139, 0, 139],darkolivegreen: [85, 107, 47],darkorange: [255, 140, 0],darkorchid: [153, 50, 204],darkred: [139, 0, 0],darksalmon: [233, 150, 122],darkviolet: [148, 0, 211],fuchsia: [255, 0, 255],gold: [255, 215, 0],green: [0, 128, 0],indigo: [75, 0, 130],khaki: [240, 230, 140],lightblue: [173, 216, 230],lightcyan: [224, 255, 255],lightgreen: [144, 238, 144],lightgrey: [211, 211, 211],lightpink: [255, 182, 193],lightyellow: [255, 255, 224],lime: [0, 255, 0],magenta: [255, 0, 255],maroon: [128, 0, 0],navy: [0, 0, 128],olive: [128, 128, 0],orange: [255, 165, 0],pink: [255, 192, 203],purple: [128, 0, 128],violet: [128, 0, 128],red: [255, 0, 0],silver: [192, 192, 192],white: [255, 255, 255],yellow: [255, 255, 0],transparent: [255, 255, 255]}, l = ["add", "remove", "toggle"], c = {border: 1,borderBottom: 1,borderColor: 1,borderLeft: 1,borderRight: 1,borderTop: 1,borderWidth: 1,margin: 1,padding: 1};
    e.effects.animateClass = function(t, n, r, u) {
        return e.isFunction(r) && (u = r, r = null), this.queue(function() {
            var a = e(this), f = a.attr("style") || " ", c = s(i.call(this)), h, v = a.attr("class");
            e.each(l, function(e, n) {
                t[n] && a[n + "Class"](t[n])
            }), h = s(i.call(this)), a.attr("class", v), a.animate(o(c, h), {queue: !1,duration: n,easing: r,complete: function() {
                    e.each(l, function(e, n) {
                        t[n] && a[n + "Class"](t[n])
                    }), typeof a.attr("style") == "object" ? (a.attr("style").cssText = "", a.attr("style").cssText = f) : a.attr("style", f), u && u.apply(this, arguments), e.dequeue(this)
                }})
        })
    }, e.fn.extend({_addClass: e.fn.addClass,addClass: function(t, n, r, i) {
            return n ? e.effects.animateClass.apply(this, [{add: t}, n, r, i]) : this._addClass(t)
        },_removeClass: e.fn.removeClass,removeClass: function(t, n, r, i) {
            return n ? e.effects.animateClass.apply(this, [{remove: t}, n, r, i]) : this._removeClass(t)
        },_toggleClass: e.fn.toggleClass,toggleClass: function(n, r, i, s, o) {
            return typeof r == "boolean" || r === t ? i ? e.effects.animateClass.apply(this, [r ? {add: n} : {remove: n}, i, s, o]) : this._toggleClass(n, r) : e.effects.animateClass.apply(this, [{toggle: n}, r, i, s])
        },switchClass: function(t, n, r, i, s) {
            return e.effects.animateClass.apply(this, [{add: n,remove: t}, r, i, s])
        }}), e.extend(e.effects, {version: "1.8.16",save: function(e, t) {
            for (var n = 0; n < t.length; n++)
                t[n] !== null && e.data("ec.storage." + t[n], e[0].style[t[n]])
        },restore: function(e, t) {
            for (var n = 0; n < t.length; n++)
                t[n] !== null && e.css(t[n], e.data("ec.storage." + t[n]))
        },setMode: function(e, t) {
            return t == "toggle" && (t = e.is(":hidden") ? "show" : "hide"), t
        },getBaseline: function(e, t) {
            var n;
            switch (e[0]) {
                case "top":
                    n = 0;
                    break;
                case "middle":
                    n = .5;
                    break;
                case "bottom":
                    n = 1;
                    break;
                default:
                    n = e[0] / t.height
            }
            switch (e[1]) {
                case "left":
                    e = 0;
                    break;
                case "center":
                    e = .5;
                    break;
                case "right":
                    e = 1;
                    break;
                default:
                    e = e[1] / t.width
            }
            return {x: e,y: n}
        },createWrapper: function(t) {
            if (t.parent().is(".ui-effects-wrapper"))
                return t.parent();
            var n = {width: t.outerWidth(!0),height: t.outerHeight(!0),"float": t.css("float")}, r = e("<div></div>").addClass("ui-effects-wrapper").css({fontSize: "100%",background: "transparent",border: "none",margin: 0,padding: 0}), i = document.activeElement;
            return t.wrap(r), (t[0] === i || e.contains(t[0], i)) && e(i).focus(), r = t.parent(), t.css("position") == "static" ? (r.css({position: "relative"}), t.css({position: "relative"})) : (e.extend(n, {position: t.css("position"),zIndex: t.css("z-index")}), e.each(["top", "left", "bottom", "right"], function(e, r) {
                n[r] = t.css(r), isNaN(parseInt(n[r], 10)) && (n[r] = "auto")
            }), t.css({position: "relative",top: 0,left: 0,right: "auto",bottom: "auto"})), r.css(n).show()
        },removeWrapper: function(t) {
            var n, r = document.activeElement;
            return t.parent().is(".ui-effects-wrapper") ? (n = t.parent().replaceWith(t), (t[0] === r || e.contains(t[0], r)) && e(r).focus(), n) : t
        },setTransition: function(t, n, r, i) {
            return i = i || {}, e.each(n, function(e, n) {
                unit = t.cssUnit(n), unit[0] > 0 && (i[n] = unit[0] * r + unit[1])
            }), i
        }}), e.fn.extend({effect: function(t) {
            var n = u.apply(this, arguments), r = {options: n[1],duration: n[2],callback: n[3]};
            n = r.options.mode;
            var i = e.effects[t];
            return e.fx.off || !i ? n ? this[n](r.duration, r.callback) : this.each(function() {
                r.callback && r.callback.call(this)
            }) : i.call(this, r)
        },_show: e.fn.show,show: function(e) {
            if (a(e))
                return this._show.apply(this, arguments);
            var t = u.apply(this, arguments);
            return t[1].mode = "show", this.effect.apply(this, t)
        },_hide: e.fn.hide,hide: function(e) {
            if (a(e))
                return this._hide.apply(this, arguments);
            var t = u.apply(this, arguments);
            return t[1].mode = "hide", this.effect.apply(this, t)
        },__toggle: e.fn.toggle,toggle: function(t) {
            if (a(t) || typeof t == "boolean" || e.isFunction(t))
                return this.__toggle.apply(this, arguments);
            var n = u.apply(this, arguments);
            return n[1].mode = "toggle", this.effect.apply(this, n)
        },cssUnit: function(t) {
            var n = this.css(t), r = [];
            return e.each(["em", "px", "%", "pt"], function(e, t) {
                n.indexOf(t) > 0 && (r = [parseFloat(n), t])
            }), r
        }}), e.easing.jswing = e.easing.swing, e.extend(e.easing, {def: "easeOutQuad",swing: function(t, n, r, i, s) {
            return e.easing[e.easing.def](t, n, r, i, s)
        },easeInQuad: function(e, t, n, r, i) {
            return r * (t /= i) * t + n
        },easeOutQuad: function(e, t, n, r, i) {
            return -r * (t /= i) * (t - 2) + n
        },easeInOutQuad: function(e, t, n, r, i) {
            return (t /= i / 2) < 1 ? r / 2 * t * t + n : -r / 2 * (--t * (t - 2) - 1) + n
        },easeInCubic: function(e, t, n, r, i) {
            return r * (t /= i) * t * t + n
        },easeOutCubic: function(e, t, n, r, i) {
            return r * ((t = t / i - 1) * t * t + 1) + n
        },easeInOutCubic: function(e, t, n, r, i) {
            return (t /= i / 2) < 1 ? r / 2 * t * t * t + n : r / 2 * ((t -= 2) * t * t + 2) + n
        },easeInQuart: function(e, t, n, r, i) {
            return r * (t /= i) * t * t * t + n
        },easeOutQuart: function(e, t, n, r, i) {
            return -r * ((t = t / i - 1) * t * t * t - 1) + n
        },easeInOutQuart: function(e, t, n, r, i) {
            return (t /= i / 2) < 1 ? r / 2 * t * t * t * t + n : -r / 2 * ((t -= 2) * t * t * t - 2) + n
        },easeInQuint: function(e, t, n, r, i) {
            return r * (t /= i) * t * t * t * t + n
        },easeOutQuint: function(e, t, n, r, i) {
            return r * ((t = t / i - 1) * t * t * t * t + 1) + n
        },easeInOutQuint: function(e, t, n, r, i) {
            return (t /= i / 2) < 1 ? r / 2 * t * t * t * t * t + n : r / 2 * ((t -= 2) * t * t * t * t + 2) + n
        },easeInSine: function(e, t, n, r, i) {
            return -r * Math.cos(t / i * (Math.PI / 2)) + r + n
        },easeOutSine: function(e, t, n, r, i) {
            return r * Math.sin(t / i * (Math.PI / 2)) + n
        },easeInOutSine: function(e, t, n, r, i) {
            return -r / 2 * (Math.cos(Math.PI * t / i) - 1) + n
        },easeInExpo: function(e, t, n, r, i) {
            return t == 0 ? n : r * Math.pow(2, 10 * (t / i - 1)) + n
        },easeOutExpo: function(e, t, n, r, i) {
            return t == i ? n + r : r * (-Math.pow(2, -10 * t / i) + 1) + n
        },easeInOutExpo: function(e, t, n, r, i) {
            return t == 0 ? n : t == i ? n + r : (t /= i / 2) < 1 ? r / 2 * Math.pow(2, 10 * (t - 1)) + n : r / 2 * (-Math.pow(2, -10 * --t) + 2) + n
        },easeInCirc: function(e, t, n, r, i) {
            return -r * (Math.sqrt(1 - (t /= i) * t) - 1) + n
        },easeOutCirc: function(e, t, n, r, i) {
            return r * Math.sqrt(1 - (t = t / i - 1) * t) + n
        },easeInOutCirc: function(e, t, n, r, i) {
            return (t /= i / 2) < 1 ? -r / 2 * (Math.sqrt(1 - t * t) - 1) + n : r / 2 * (Math.sqrt(1 - (t -= 2) * t) + 1) + n
        },easeInElastic: function(e, t, n, r, i) {
            e = 1.70158;
            var s = 0, o = r;
            return t == 0 ? n : (t /= i) == 1 ? n + r : (s || (s = i * .3), o < Math.abs(r) ? (o = r, e = s / 4) : e = s / (2 * Math.PI) * Math.asin(r / o), -(o * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * i - e) * 2 * Math.PI / s)) + n)
        },easeOutElastic: function(e, t, n, r, i) {
            e = 1.70158;
            var s = 0, o = r;
            return t == 0 ? n : (t /= i) == 1 ? n + r : (s || (s = i * .3), o < Math.abs(r) ? (o = r, e = s / 4) : e = s / (2 * Math.PI) * Math.asin(r / o), o * Math.pow(2, -10 * t) * Math.sin((t * i - e) * 2 * Math.PI / s) + r + n)
        },easeInOutElastic: function(e, t, n, r, i) {
            e = 1.70158;
            var s = 0, o = r;
            return t == 0 ? n : (t /= i / 2) == 2 ? n + r : (s || (s = i * .3 * 1.5), o < Math.abs(r) ? (o = r, e = s / 4) : e = s / (2 * Math.PI) * Math.asin(r / o), t < 1 ? -0.5 * o * Math.pow(2, 10 * (t -= 1)) * Math.sin((t * i - e) * 2 * Math.PI / s) + n : o * Math.pow(2, -10 * (t -= 1)) * Math.sin((t * i - e) * 2 * Math.PI / s) * .5 + r + n)
        },easeInBack: function(e, n, r, i, s, o) {
            return o == t && (o = 1.70158), i * (n /= s) * n * ((o + 1) * n - o) + r
        },easeOutBack: function(e, n, r, i, s, o) {
            return o == t && (o = 1.70158), i * ((n = n / s - 1) * n * ((o + 1) * n + o) + 1) + r
        },easeInOutBack: function(e, n, r, i, s, o) {
            return o == t && (o = 1.70158), (n /= s / 2) < 1 ? i / 2 * n * n * (((o *= 1.525) + 1) * n - o) + r : i / 2 * ((n -= 2) * n * (((o *= 1.525) + 1) * n + o) + 2) + r
        },easeInBounce: function(t, n, r, i, s) {
            return i - e.easing.easeOutBounce(t, s - n, 0, i, s) + r
        },easeOutBounce: function(e, t, n, r, i) {
            return (t /= i) < 1 / 2.75 ? r * 7.5625 * t * t + n : t < 2 / 2.75 ? r * (7.5625 * (t -= 1.5 / 2.75) * t + .75) + n : t < 2.5 / 2.75 ? r * (7.5625 * (t -= 2.25 / 2.75) * t + .9375) + n : r * (7.5625 * (t -= 2.625 / 2.75) * t + .984375) + n
        },easeInOutBounce: function(t, n, r, i, s) {
            return n < s / 2 ? e.easing.easeInBounce(t, n * 2, 0, i, s) * .5 + r : e.easing.easeOutBounce(t, n * 2 - s, 0, i, s) * .5 + i * .5 + r
        }})
}(jQuery), function(e) {
    e.effects.blind = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right"], i = e.effects.setMode(n, t.options.mode || "hide"), s = t.options.direction || "vertical";
            e.effects.save(n, r), n.show();
            var o = e.effects.createWrapper(n).css({overflow: "hidden"}), u = s == "vertical" ? "height" : "width";
            s = s == "vertical" ? o.height() : o.width(), i == "show" && o.css(u, 0);
            var a = {};
            a[u] = i == "show" ? s : 0, o.animate(a, t.duration, t.options.easing, function() {
                i == "hide" && n.hide(), e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(n[0], arguments), n.dequeue()
            })
        })
    }
}(jQuery), function(e) {
    e.effects.bounce = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right"], i = e.effects.setMode(n, t.options.mode || "effect"), s = t.options.direction || "up", o = t.options.distance || 20, u = t.options.times || 5, a = t.duration || 250;
            /show|hide/.test(i) && r.push("opacity"), e.effects.save(n, r), n.show(), e.effects.createWrapper(n);
            var f = s == "up" || s == "down" ? "top" : "left";
            s = s == "up" || s == "left" ? "pos" : "neg", o = t.options.distance || (f == "top" ? n.outerHeight({margin: !0}) / 3 : n.outerWidth({margin: !0}) / 3), i == "show" && n.css("opacity", 0).css(f, s == "pos" ? -o : o), i == "hide" && (o /= u * 2), i != "hide" && u--;
            if (i == "show") {
                var l = {opacity: 1};
                l[f] = (s == "pos" ? "+=" : "-=") + o, n.animate(l, a / 2, t.options.easing), o /= 2, u--
            }
            for (l = 0; l < u; l++) {
                var c = {}, h = {};
                c[f] = (s == "pos" ? "-=" : "+=") + o, h[f] = (s == "pos" ? "+=" : "-=") + o, n.animate(c, a / 2, t.options.easing).animate(h, a / 2, t.options.easing), o = i == "hide" ? o * 2 : o / 2
            }
            i == "hide" ? (l = {opacity: 0}, l[f] = (s == "pos" ? "-=" : "+=") + o, n.animate(l, a / 2, t.options.easing, function() {
                n.hide(), e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(this, arguments)
            })) : (c = {}, h = {}, c[f] = (s == "pos" ? "-=" : "+=") + o, h[f] = (s == "pos" ? "+=" : "-=") + o, n.animate(c, a / 2, t.options.easing).animate(h, a / 2, t.options.easing, function() {
                e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(this, arguments)
            })), n.queue("fx", function() {
                n.dequeue()
            }), n.dequeue()
        })
    }
}(jQuery), function(e) {
    e.effects.clip = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right", "height", "width"], i = e.effects.setMode(n, t.options.mode || "hide"), s = t.options.direction || "vertical";
            e.effects.save(n, r), n.show();
            var o = e.effects.createWrapper(n).css({overflow: "hidden"});
            o = n[0].tagName == "IMG" ? o : n;
            var u = {size: s == "vertical" ? "height" : "width",position: s == "vertical" ? "top" : "left"};
            s = s == "vertical" ? o.height() : o.width(), i == "show" && (o.css(u.size, 0), o.css(u.position, s / 2));
            var a = {};
            a[u.size] = i == "show" ? s : 0, a[u.position] = i == "show" ? 0 : s / 2, o.animate(a, {queue: !1,duration: t.duration,easing: t.options.easing,complete: function() {
                    i == "hide" && n.hide(), e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(n[0], arguments), n.dequeue()
                }})
        })
    }
}(jQuery), function(e) {
    e.effects.drop = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right", "opacity"], i = e.effects.setMode(n, t.options.mode || "hide"), s = t.options.direction || "left";
            e.effects.save(n, r), n.show(), e.effects.createWrapper(n);
            var o = s == "up" || s == "down" ? "top" : "left";
            s = s == "up" || s == "left" ? "pos" : "neg";
            var u = t.options.distance || (o == "top" ? n.outerHeight({margin: !0}) / 2 : n.outerWidth({margin: !0}) / 2);
            i == "show" && n.css("opacity", 0).css(o, s == "pos" ? -u : u);
            var a = {opacity: i == "show" ? 1 : 0};
            a[o] = (i == "show" ? s == "pos" ? "+=" : "-=" : s == "pos" ? "-=" : "+=") + u, n.animate(a, {queue: !1,duration: t.duration,easing: t.options.easing,complete: function() {
                    i == "hide" && n.hide(), e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(this, arguments), n.dequeue()
                }})
        })
    }
}(jQuery), function(e) {
    e.effects.explode = function(t) {
        return this.queue(function() {
            var n = t.options.pieces ? Math.round(Math.sqrt(t.options.pieces)) : 3, r = t.options.pieces ? Math.round(Math.sqrt(t.options.pieces)) : 3;
            t.options.mode = t.options.mode == "toggle" ? e(this).is(":visible") ? "hide" : "show" : t.options.mode;
            var i = e(this).show().css("visibility", "hidden"), s = i.offset();
            s.top -= parseInt(i.css("marginTop"), 10) || 0, s.left -= parseInt(i.css("marginLeft"), 10) || 0;
            for (var o = i.outerWidth(!0), u = i.outerHeight(!0), f = 0; f < n; f++)
                for (var l = 0; l < r; l++)
                    i.clone().appendTo("body").wrap("<div></div>").css({position: "absolute",visibility: "visible",left: -l * (o / r),top: -f * (u / n)}).parent().addClass("ui-effects-explode").css({position: "absolute",overflow: "hidden",width: o / r,height: u / n,left: s.left + l * (o / r) + (t.options.mode == "show" ? (l - Math.floor(r / 2)) * (o / r) : 0),top: s.top + f * (u / n) + (t.options.mode == "show" ? (f - Math.floor(n / 2)) * (u / n) : 0),opacity: t.options.mode == "show" ? 0 : 1}).animate({left: s.left + l * (o / r) + (t.options.mode == "show" ? 0 : (l - Math.floor(r / 2)) * (o / r)),top: s.top + f * (u / n) + (t.options.mode == "show" ? 0 : (f - Math.floor(n / 2)) * (u / n)),opacity: t.options.mode == "show" ? 1 : 0}, t.duration || 500);
            setTimeout(function() {
                t.options.mode == "show" ? i.css({visibility: "visible"}) : i.css({visibility: "visible"}).hide(), t.callback && t.callback.apply(i[0]), i.dequeue(), e("div.ui-effects-explode").remove()
            }, t.duration || 500)
        })
    }
}(jQuery), function(e) {
    e.effects.fade = function(t) {
        return this.queue(function() {
            var n = e(this), r = e.effects.setMode(n, t.options.mode || "hide");
            n.animate({opacity: r}, {queue: !1,duration: t.duration,easing: t.options.easing,complete: function() {
                    t.callback && t.callback.apply(this, arguments), n.dequeue()
                }})
        })
    }
}(jQuery), function(e) {
    e.effects.fold = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right"], i = e.effects.setMode(n, t.options.mode || "hide"), s = t.options.size || 15, o = !!t.options.horizFirst, u = t.duration ? t.duration / 2 : e.fx.speeds._default / 2;
            e.effects.save(n, r), n.show();
            var f = e.effects.createWrapper(n).css({overflow: "hidden"}), l = i == "show" != o, h = l ? ["width", "height"] : ["height", "width"];
            l = l ? [f.width(), f.height()] : [f.height(), f.width()];
            var p = /([0-9]+)%/.exec(s);
            p && (s = parseInt(p[1], 10) / 100 * l[i == "hide" ? 0 : 1]), i == "show" && f.css(o ? {height: 0,width: s} : {height: s,width: 0}), o = {}, p = {}, o[h[0]] = i == "show" ? l[0] : s, p[h[1]] = i == "show" ? l[1] : 0, f.animate(o, u, t.options.easing).animate(p, u, t.options.easing, function() {
                i == "hide" && n.hide(), e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(n[0], arguments), n.dequeue()
            })
        })
    }
}(jQuery), function(e) {
    e.effects.highlight = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["backgroundImage", "backgroundColor", "opacity"], i = e.effects.setMode(n, t.options.mode || "show"), s = {backgroundColor: n.css("backgroundColor")};
            i == "hide" && (s.opacity = 0), e.effects.save(n, r), n.show().css({backgroundImage: "none",backgroundColor: t.options.color || "#ffff99"}).animate(s, {queue: !1,duration: t.duration,easing: t.options.easing,complete: function() {
                    i == "hide" && n.hide(), e.effects.restore(n, r), i == "show" && !e.support.opacity && this.style.removeAttribute("filter"), t.callback && t.callback.apply(this, arguments), n.dequeue()
                }})
        })
    }
}(jQuery), function(e) {
    e.effects.pulsate = function(t) {
        return this.queue(function() {
            var n = e(this), r = e.effects.setMode(n, t.options.mode || "show");
            times = (t.options.times || 5) * 2 - 1, duration = t.duration ? t.duration / 2 : e.fx.speeds._default / 2, isVisible = n.is(":visible"), animateTo = 0, isVisible || (n.css("opacity", 0).show(), animateTo = 1), (r == "hide" && isVisible || r == "show" && !isVisible) && times--;
            for (r = 0; r < times; r++)
                n.animate({opacity: animateTo}, duration, t.options.easing), animateTo = (animateTo + 1) % 2;
            n.animate({opacity: animateTo}, duration, t.options.easing, function() {
                animateTo == 0 && n.hide(), t.callback && t.callback.apply(this, arguments)
            }), n.queue("fx", function() {
                n.dequeue()
            }).dequeue()
        })
    }
}(jQuery), function(e) {
    e.effects.puff = function(t) {
        return this.queue(function() {
            var n = e(this), r = e.effects.setMode(n, t.options.mode || "hide"), i = parseInt(t.options.percent, 10) || 150, s = i / 100, o = {height: n.height(),width: n.width()};
            e.extend(t.options, {fade: !0,mode: r,percent: r == "hide" ? i : 100,from: r == "hide" ? o : {height: o.height * s,width: o.width * s}}), n.effect("scale", t.options, t.duration, t.callback), n.dequeue()
        })
    }, e.effects.scale = function(t) {
        return this.queue(function() {
            var n = e(this), r = e.extend(!0, {}, t.options), i = e.effects.setMode(n, t.options.mode || "effect"), s = parseInt(t.options.percent, 10) || (parseInt(t.options.percent, 10) == 0 ? 0 : i == "hide" ? 0 : 100), o = t.options.direction || "both", u = t.options.origin;
            i != "effect" && (r.origin = u || ["middle", "center"], r.restore = !0), u = {height: n.height(),width: n.width()}, n.from = t.options.from || (i == "show" ? {height: 0,width: 0} : u), s = {y: o != "horizontal" ? s / 100 : 1,x: o != "vertical" ? s / 100 : 1}, n.to = {height: u.height * s.y,width: u.width * s.x}, t.options.fade && (i == "show" && (n.from.opacity = 0, n.to.opacity = 1), i == "hide" && (n.from.opacity = 1, n.to.opacity = 0)), r.from = n.from, r.to = n.to, r.mode = i, n.effect("size", r, t.duration, t.callback), n.dequeue()
        })
    }, e.effects.size = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right", "width", "height", "overflow", "opacity"], i = ["position", "top", "bottom", "left", "right", "overflow", "opacity"], s = ["width", "height", "overflow"], o = ["fontSize"], u = ["borderTopWidth", "borderBottomWidth", "paddingTop", "paddingBottom"], a = ["borderLeftWidth", "borderRightWidth", "paddingLeft", "paddingRight"], f = e.effects.setMode(n, t.options.mode || "effect"), l = t.options.restore || !1, h = t.options.scale || "both", p = t.options.origin, d = {height: n.height(),width: n.width()};
            n.from = t.options.from || d, n.to = t.options.to || d, p && (p = e.effects.getBaseline(p, d), n.from.top = (d.height - n.from.height) * p.y, n.from.left = (d.width - n.from.width) * p.x, n.to.top = (d.height - n.to.height) * p.y, n.to.left = (d.width - n.to.width) * p.x);
            var v = {from: {y: n.from.height / d.height,x: n.from.width / d.width},to: {y: n.to.height / d.height,x: n.to.width / d.width}};
            if (h == "box" || h == "both")
                v.from.y != v.to.y && (r = r.concat(u), n.from = e.effects.setTransition(n, u, v.from.y, n.from), n.to = e.effects.setTransition(n, u, v.to.y, n.to)), v.from.x != v.to.x && (r = r.concat(a), n.from = e.effects.setTransition(n, a, v.from.x, n.from), n.to = e.effects.setTransition(n, a, v.to.x, n.to));
            (h == "content" || h == "both") && v.from.y != v.to.y && (r = r.concat(o), n.from = e.effects.setTransition(n, o, v.from.y, n.from), n.to = e.effects.setTransition(n, o, v.to.y, n.to)), e.effects.save(n, l ? r : i), n.show(), e.effects.createWrapper(n), n.css("overflow", "hidden").css(n.from);
            if (h == "content" || h == "both")
                u = u.concat(["marginTop", "marginBottom"]).concat(o), a = a.concat(["marginLeft", "marginRight"]), s = r.concat(u).concat(a), n.find("*[width]").each(function() {
                    child = e(this), l && e.effects.save(child, s);
                    var n = {height: child.height(),width: child.width()};
                    child.from = {height: n.height * v.from.y,width: n.width * v.from.x}, child.to = {height: n.height * v.to.y,width: n.width * v.to.x}, v.from.y != v.to.y && (child.from = e.effects.setTransition(child, u, v.from.y, child.from), child.to = e.effects.setTransition(child, u, v.to.y, child.to)), v.from.x != v.to.x && (child.from = e.effects.setTransition(child, a, v.from.x, child.from), child.to = e.effects.setTransition(child, a, v.to.x, child.to)), child.css(child.from), child.animate(child.to, t.duration, t.options.easing, function() {
                        l && e.effects.restore(child, s)
                    })
                });
            n.animate(n.to, {queue: !1,duration: t.duration,easing: t.options.easing,complete: function() {
                    n.to.opacity === 0 && n.css("opacity", n.from.opacity), f == "hide" && n.hide(), e.effects.restore(n, l ? r : i), e.effects.removeWrapper(n), t.callback && t.callback.apply(this, arguments), n.dequeue()
                }})
        })
    }
}(jQuery), function(e) {
    e.effects.shake = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right"];
            e.effects.setMode(n, t.options.mode || "effect");
            var i = t.options.direction || "left", s = t.options.distance || 20, o = t.options.times || 3, u = t.duration || t.options.duration || 140;
            e.effects.save(n, r), n.show(), e.effects.createWrapper(n);
            var f = i == "up" || i == "down" ? "top" : "left", l = i == "up" || i == "left" ? "pos" : "neg";
            i = {};
            var c = {}, h = {};
            i[f] = (l == "pos" ? "-=" : "+=") + s, c[f] = (l == "pos" ? "+=" : "-=") + s * 2, h[f] = (l == "pos" ? "-=" : "+=") + s * 2, n.animate(i, u, t.options.easing);
            for (s = 1; s < o; s++)
                n.animate(c, u, t.options.easing).animate(h, u, t.options.easing);
            n.animate(c, u, t.options.easing).animate(i, u / 2, t.options.easing, function() {
                e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(this, arguments)
            }), n.queue("fx", function() {
                n.dequeue()
            }), n.dequeue()
        })
    }
}(jQuery), function(e) {
    e.effects.slide = function(t) {
        return this.queue(function() {
            var n = e(this), r = ["position", "top", "bottom", "left", "right"], i = e.effects.setMode(n, t.options.mode || "show"), s = t.options.direction || "left";
            e.effects.save(n, r), n.show(), e.effects.createWrapper(n).css({overflow: "hidden"});
            var o = s == "up" || s == "down" ? "top" : "left";
            s = s == "up" || s == "left" ? "pos" : "neg";
            var u = t.options.distance || (o == "top" ? n.outerHeight({margin: !0}) : n.outerWidth({margin: !0}));
            i == "show" && n.css(o, s == "pos" ? isNaN(u) ? "-" + u : -u : u);
            var a = {};
            a[o] = (i == "show" ? s == "pos" ? "+=" : "-=" : s == "pos" ? "-=" : "+=") + u, n.animate(a, {queue: !1,duration: t.duration,easing: t.options.easing,complete: function() {
                    i == "hide" && n.hide(), e.effects.restore(n, r), e.effects.removeWrapper(n), t.callback && t.callback.apply(this, arguments), n.dequeue()
                }})
        })
    }
}(jQuery), function(e) {
    e.effects.transfer = function(t) {
        return this.queue(function() {
            var n = e(this), r = e(t.options.to), i = r.offset();
            r = {top: i.top,left: i.left,height: r.innerHeight(),width: r.innerWidth()}, i = n.offset();
            var s = e('<div class="ui-effects-transfer"></div>').appendTo(document.body).addClass(t.options.className).css({top: i.top,left: i.left,height: n.innerHeight(),width: n.innerWidth(),position: "absolute"}).animate(r, t.duration, t.options.easing, function() {
                s.remove(), t.callback && t.callback.apply(n[0], arguments), n.dequeue()
            })
        })
    }
}(jQuery), define("jquery.jquery-ui-1.8.16", function() {
});
if (typeof ADOBE == "undefined")
    var ADOBE = {};
typeof ADOBE.AM == "undefined" && (ADOBE.AM = {}), ADOBE.AM.hierarchy_tree = function() {
    this.treeElement = "", this.folderSrc = "", this.listSrc = [], this.inc3rdParty = !1, this.foldersOnly = !1, this.folderThemeSrc = "", this.showCheckboxes = !0, this.two_state = !1, this.dots = !1, this.icons = !0, this.initially_select = [], this.initially_open = [], this.formatData = function(e) {
        jQuery.each(e, function(e, t) {
            t.data = DEMDEX.UTILS.unescape(t.data)
        })
    };
    var e = function() {
        var e = null;
        return arguments[1] == "segment" ? e = new RegExp("(seg_)?\\d+_segment_row_", "") : arguments[1] == "destination" ? e = new RegExp("(seg_)?\\d+_order_row_", "") : e = new RegExp("(seg_)?(\\d+_)?folder_row_", ""), arguments[0].replace(e, "")
    }, t = function(e, t, n) {
        var r = {wrapper: '<div id="%%id%%" class="btn_wrap hide-spans">%%contents%%</div>',edit: '<img src="https://a248.e.akamai.net/demdex.download.akamai.com/corp/images/edit.png" title="Edit" alt="Edit" />',play: '<img src="https://a248.e.akamai.net/demdex.download.akamai.com/corp/images/play.png" title="Activate" alt="Play" />',stop: '<img src="https://a248.e.akamai.net/demdex.download.akamai.com/corp/images/pause.png" title="Deactivate" alt="Stop" />',"delete": '<img src="https://a248.e.akamai.net/demdex.download.akamai.com/corp/images/bin.png" title="Delete" alt="Delete" />'}, i = "";
        switch (e) {
            case "folder":
                i = r.wrapper.replace("%%id%%", "seg_" + t).replace("%%contents%%", "<span>" + r.edit + "</span><span>" + r["delete"] + "</span>");
                break;
            case "segment":
                i = r.wrapper.replace("%%id%%", "seg_" + t).replace("%%contents%%", "<span>" + r.edit + "</span><span>" + (+n == 1 ? r.stop : r.play) + "</span><span>" + r["delete"] + "</span>");
                break;
            default:
        }
        return i
    };
    this.loadTree = function() {
        var n;
        this.showCheckboxes ? n = ["themes", "json_data", "ui", "search", "types", "checkbox"] : n = ["themes", "json_data", "ui", "search", "types"];
        var r = this.foldersOnly, i = this.inc3rdParty;
        return $(this.treeElement).jstree({plugins: n,themes: {theme: "default",dots: this.dots,icons: this.icons,url: this.folderThemeSrc},json_data: {progressive_render: !0,ajax: {url: this.folderSrc,async: !1,data: function(t) {
                        return {q: (new Date).getTime(),operation: "get_children",id: t.attr ? e(t.attr("id"), t.attr("rel")) : -1,foldersOnly: r,includeThirdParty: i}
                    },success: this.formatData},row_hook: function(e, n) {
                    var r = null, i = "";
                    return typeof n.attr == "undefined" ? e : (n.attr.rel == "folder" ? (i = t(n.attr.rel, n.attr.id, n.status), r = $(i).click(function(e) {
                        var t = e.target.nodeName.toLowerCase(), n = t == "span" ? $(e.target).find("img")[0] : e.target;
                        $(document).trigger("folder_action", [this, n])
                    })) : (i = t(n.attr.rel, n.attr.id, n.status), r = $(i).click(function(e) {
                        var t = e.target.nodeName.toLowerCase(), n = t == "span" ? $(e.target).find("img")[0] : e.target;
                        $(document).trigger("segment_action", [this, n])
                    })), e.append(r), e)
                }},search: {ajax: {url: this.folderSrc + "?q=" + (new Date).getTime(),data: function(e) {
                        return {operation: "search",search_str: e}
                    }}},types: {max_depth: -2,max_children: -2,valid_children: ["drive", "folder", "destination", "category"],types: {trait: {valid_children: "none",icon: {image: "/css/aam/images/leaf.gif"}},destination: {valid_children: "none",icon: {image: "/css/aam/images/leaf.gif"}},segment: {valid_children: "none",icon: {image: "/css/aam/images/leaf.gif"}},folder: {valid_children: ["segment", "folder"],icon: {image: "/css/aam/images/folder.gif"}},category: {valid_children: ["category"]}}},ui: {initially_select: this.initially_select},core: {initially_open: this.initially_open,animation: 0,html_titles: !0},checkbox: {two_state: this.two_state}}), $(this.treeElement).bind("select_node.jstree", function(e, t) {
            var n = t.rslt.obj.attr("id");
            $(this.treeElement + " a").removeClass("selectedNode"), $("#" + n + ">a").addClass("selectedNode"), $(this).jstree("open_node", $("#" + n))
        }), $(this.treeElement)
    }
}, ADOBE.AM.contextHelpArr = [], ADOBE.AM.addHelpObj = function(e) {
    var t = ADOBE.AM.API.BASEURL + "/contextualhelp/pid-" + ADOBE.AM.pid + "/" + e;
    $.getJSON(t, function(t) {
        ADOBE.AM.contextHelpArr[e] = t, ADOBE.AM.showContextHelp(e)
    })
}, ADOBE.AM.showContextHelp = function(e) {
    var t = {}, n = ADOBE.AM.contextHelpArr[e];
    n.intro = ADOBE.AM.UTILS.HELPERS.htmlEntityDecode(n.intro);
    var r = n.intro + "<a tabindex='-1' class='moreHelpLink' href='" + n.url + "' target='_blank'>Click here for more information</a>";
    t.title = n.title, t.msg = r, ADOBE.AM.alertBox(t)
}, ADOBE.AM.alertBox = function(e) {
    $("#alertBoxDialog .message").hide(), $alertBoxDialog.dialog("option", "title", "Alert"), typeof e != "undefined" && (typeof e.title != "undefined" && $alertBoxDialog.dialog("option", "title", e.title), typeof e.errorMsg != "undefined" && ($("#alertBoxDialog .errorMsg").html(e.errorMsg), $("#alertError").show()), typeof e.warningMsg != "undefined" && ($("#alertBoxDialog .warningMsg").html(e.warningMsg), $("#alertWarning").show()), typeof e.msg != "undefined" && $("#alertMsg").html(e.msg));
    try {
        $alertBoxDialog.dialog("open")
    } catch (t) {
    }
}, ADOBE.AM.AlertModal = function(e) {
    function a() {
        $("button.primary", t.el("container")).off().on("click", function() {
            $(t.el("container")).fadeOut("slow", function() {
                $(n.el("container")).remove(), t.hide(), $("body").removeClass("disableMainScroll"), $(t.el("container")).find(".AUI_Dialog_outerContainer").removeClass("chromeFix").css({top: "50%"})
            })
        })
    }
    function f() {
        var e = t.el("container"), n = e.getAttribute("class");
        n += " headless", e.setAttribute("class", n)
    }
    function l() {
        var e = t.el("container"), n = e.getAttribute("class");
        n = n.replace(/\s?headless\s?/g, " "), e.setAttribute("class", n)
    }
    function c(e) {
        var t = {}, n = _.pick.apply(null, [].concat(e).concat(o));
        return _.extend(t, u, n)
    }
    function h(e) {
        var t = {}, n = document.createElement("div"), r = _.pick.apply(null, [].concat(e).concat(i));
        return _.isEmpty(r) ? _.extend(t, s) : (r.buttons && (_.each(r.buttons, function(e) {
            var t = document.createElement("button");
            t.innerHTML = e.text, t.className = e.className, n.appendChild(t), AUI.addListener(t, "click", e.onClick)
        }), r.footer = n), delete r.buttons, _.extend(t, s, r))
    }
    var t = null, n = null, r = {}, i = ["width", "header", "buttons"], s = {width: "300px",footer: '<button class="primary" style="margin-right:4px">OK</button>'}, o = ["type", "message"], u = {type: "error",message: "",header: !0};
    return r = h(e), t = (new AUI.Dialog(r)).render().show(), t.el("container").setAttribute("id", "alertModal"), _.extend(u, {parent: t.el("content")}), ADOBE.AM.AlertModal = function(e) {
        var r = {}, i = !1, s = !1, o = !1, u = {};
        return r = _.extend(c(e), {header: !0}), s = u.header === undefined, i = r.type === "loading", o = e.buttons === undefined, u = h(e), s ? f() : (l(), t.set("header", u.header)), i ? (t.set("footer", ""), delete r.header) : (t.set("footer", u.footer), o && a()), n instanceof AUI.Alert && n.destroy(), n = (new AUI.Alert(r)).render().show(), $(".AUI_Dialog:visible").length || t.set("zIndex", 1001), $(t.el("container")).show(), t.show(), t
    }, ADOBE.AM.AlertModal(e)
}, ADOBE.AM.LoadingOverlay = {store: {},instance_properties: {overlay: null,parent_element: null,rendered: null,message: "Loading...",show: function() {
            var e = this;
            if (this.rendered) {
                this.overlay.css({height: this.parent_element.outerHeight(),width: this.parent_element.outerWidth()}), this.overlay.css("display", "block"), this.aui_alert.show();
                return
            }
            this.overlay = $('<div class="loading_overlay" />'), this.overlay.css({height: function() {
                    return e.parent_element.outerHeight()
                },width: this.parent_element.outerWidth()}), this.parent_element.append(this.overlay), this.aui_alert = (new AUI.Alert({parent: this.parent_element.get(0),type: "loading",label: "",message: this.message})).render().show(), this.rendered = !0
        },hide: function() {
            this.overlay && this.overlay.css("display", "none"), this.aui_alert && this.aui_alert.get("visible") && this.aui_alert.hide()
        }},config: function(e) {
        var t = null;
        if (e.id == null)
            throw Error("You must supply an id property");
        return t = this.store[e.id], t && t.rendered ? t : (t = _.extend({}, this.instance_properties, e), this.store[e.id] = t, this.store[e.id])
    },flush: function(e) {
        typeof e == "string" ? delete this.store[e] : this.store = {}
    }}, $(document).ready(function() {
    $alertBoxDialog = $("#alertBoxDialog").dialog({autoOpen: !1,closeText: "Close",modal: !0,create: function() {
            $("#alertBoxDialog .close, #alertBoxDialog .oldClose").click(function() {
                $alertBoxDialog.dialog("close")
            })
        }}), window.location.href.indexOf("SegmentBuilder") == -1 && $(".context-help").click(function() {
        var e = $(this).attr("data-id");
        typeof ADOBE.AM.contextHelpArr[e] == "undefined" ? ADOBE.AM.addHelpObj(e) : ADOBE.AM.showContextHelp(e)
    })
}), define("adobe.widgets", function() {
}), function() {
    if (jQuery && jQuery.jstree)
        return;
    var e = !1, t = !1, n = !1;
    (function(r) {
        r.vakata = {}, r.vakata.css = {get_css: function(e, t, n) {
                e = e.toLowerCase();
                var r = n.cssRules || n.rules, i = 0;
                do {
                    if (r.length && i > r.length + 5)
                        return !1;
                    if (r[i].selectorText && r[i].selectorText.toLowerCase() == e)
                        return t === !0 ? (n.removeRule && n.removeRule(i), n.deleteRule && n.deleteRule(i), !0) : r[i]
                } while (r[++i]);
                return !1
            },add_css: function(e, t) {
                return r.jstree.css.get_css(e, !1, t) ? !1 : (t.insertRule ? t.insertRule(e + " { }", 0) : t.addRule(e, null, 0), r.vakata.css.get_css(e))
            },remove_css: function(e, t) {
                return r.vakata.css.get_css(e, !0, t)
            },add_sheet: function(e) {
                var t = !1, n = !0;
                if (e.str)
                    return e.title && (t = r("style[id='" + e.title + "-stylesheet']")[0]), t ? n = !1 : (t = document.createElement("style"), t.setAttribute("type", "text/css"), e.title && t.setAttribute("id", e.title + "-stylesheet")), t.styleSheet ? n ? (document.getElementsByTagName("head")[0].appendChild(t), t.styleSheet.cssText = e.str) : t.styleSheet.cssText = t.styleSheet.cssText + " " + e.str : (t.appendChild(document.createTextNode(e.str)), document.getElementsByTagName("head")[0].appendChild(t)), t.sheet || t.styleSheet;
                if (e.url) {
                    if (!document.createStyleSheet)
                        return t = document.createElement("link"), t.rel = "stylesheet", t.type = "text/css", t.media = "all", t.href = e.url, document.getElementsByTagName("head")[0].appendChild(t), t.styleSheet;
                    try {
                        t = document.createStyleSheet(e.url)
                    } catch (i) {
                    }
                }
            }};
        var i = [], s = -1, o = {}, u = {};
        r.fn.jstree = function(e) {
            var t = typeof e == "string", n = Array.prototype.slice.call(arguments, 1), s = this;
            if (t) {
                if (e.substring(0, 1) == "_")
                    return s;
                this.each(function() {
                    var t = i[r.data(this, "jstree_instance_id")], o = t && r.isFunction(t[e]) ? t[e].apply(t, n) : t;
                    if (typeof o != "undefined" && (e.indexOf("is_") === 0 || o !== !0 && o !== !1))
                        return s = o, !1
                })
            } else
                this.each(function() {
                    var t = r.data(this, "jstree_instance_id"), s = [], u = e ? r.extend({}, !0, e) : {}, a = r(this), f = !1, l = [];
                    s = s.concat(n), a.data("jstree") && s.push(a.data("jstree")), u = s.length ? r.extend.apply(null, [!0, u].concat(s)) : u, typeof t != "undefined" && i[t] && i[t].destroy(), t = parseInt(i.push({}), 10) - 1, r.data(this, "jstree_instance_id", t), u.plugins = r.isArray(u.plugins) ? u.plugins : r.jstree.defaults.plugins.slice(), u.plugins.unshift("core"), u.plugins = u.plugins.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g, "$1$2$4").replace(/,,+/g, ",").replace(/,$/, "").split(","), f = r.extend(!0, {}, r.jstree.defaults, u), f.plugins = u.plugins, r.each(o, function(e, t) {
                        r.inArray(e, f.plugins) === -1 ? (f[e] = null, delete f[e]) : l.push(e)
                    }), f.plugins = l, i[t] = new r.jstree._instance(t, r(this).addClass("jstree jstree-" + t), f), r.each(i[t]._get_settings().plugins, function(e, n) {
                        i[t].data[n] = {}
                    }), r.each(i[t]._get_settings().plugins, function(e, n) {
                        o[n] && o[n].__init.apply(i[t])
                    }), setTimeout(function() {
                        i[t] && i[t].init()
                    }, 0)
                });
            return s
        }, r.jstree = {defaults: {plugins: []},_focused: function() {
                return i[s] || null
            },_reference: function(e) {
                if (i[e])
                    return i[e];
                var t = r(e);
                return !t.length && typeof e == "string" && (t = r("#" + e)), t.length ? i[t.closest(".jstree").data("jstree_instance_id")] || null : null
            },_instance: function(e, t, n) {
                this.data = {core: {}}, this.get_settings = function() {
                    return r.extend(!0, {}, n)
                }, this._get_settings = function() {
                    return n
                }, this.get_index = function() {
                    return e
                }, this.get_container = function() {
                    return t
                }, this.get_container_ul = function() {
                    return t.children("ul:eq(0)")
                }, this._set_settings = function(e) {
                    n = r.extend(!0, {}, n, e)
                }
            },_fn: {},plugin: function(e, t) {
                t = r.extend({}, {__init: r.noop,__destroy: r.noop,_fn: {},defaults: !1}, t), o[e] = t, r.jstree.defaults[e] = t.defaults, r.each(t._fn, function(t, n) {
                    n.plugin = e, n.old = r.jstree._fn[t], r.jstree._fn[t] = function() {
                        var e, i = n, s = Array.prototype.slice.call(arguments), o = new r.Event("before.jstree"), u = !1;
                        if (this.data.core.locked === !0 && t !== "unlock" && t !== "is_locked")
                            return;
                        do {
                            if (i && i.plugin && r.inArray(i.plugin, this._get_settings().plugins) !== -1)
                                break;
                            i = i.old
                        } while (i);
                        if (!i)
                            return;
                        if (t.indexOf("_") === 0)
                            e = i.apply(this, s);
                        else {
                            e = this.get_container().triggerHandler(o, {func: t,inst: this,args: s,plugin: i.plugin});
                            if (e === !1)
                                return;
                            typeof e != "undefined" && (s = e), e = i.apply(r.extend({}, this, {__callback: function(e) {
                                    this.get_container().triggerHandler(t + ".jstree", {inst: this,args: s,rslt: e,rlbk: u})
                                },__rollback: function() {
                                    return u = this.get_rollback(), u
                                },__call_old: function(e) {
                                    return i.old.apply(this, e ? Array.prototype.slice.call(arguments, 1) : s)
                                }}), s)
                        }
                        return e
                    }, r.jstree._fn[t].old = n.old, r.jstree._fn[t].plugin = e
                })
            },rollback: function(e) {
                e && (r.isArray(e) || (e = [e]), r.each(e, function(e, t) {
                    i[t.i].set_rollback(t.h, t.d)
                }))
            }}, r.jstree._fn = r.jstree._instance.prototype = {}, r(function() {
            var i = navigator.userAgent.toLowerCase(), s = (i.match(/.+?(?:rv|it|ra|ie)[\/: ]([\d.]+)/) || [0, "0"])[1], o = ".jstree ul, .jstree li { display:block; margin:0 0 0 0; padding:0 0 0 0; list-style-type:none; } .jstree li { display:block; min-height:18px; line-height:18px; white-space:nowrap; margin-left:18px; min-width:18px; } .jstree-rtl li { margin-left:0; margin-right:18px; } .jstree > ul > li { margin-left:0px; } .jstree-rtl > ul > li { margin-right:0px; } .jstree ins { display:inline-block; text-decoration:none; width:18px; height:18px; margin:0 0 0 0; padding:0; } .jstree a { display:inline-block; line-height:16px; height:16px; color:black; white-space:nowrap; text-decoration:none; padding:1px 2px; margin:0; } .jstree a:focus { outline: none; } .jstree a > ins { height:16px; width:16px; } .jstree a > .jstree-icon { margin-right:3px; } .jstree-rtl a > .jstree-icon { margin-left:3px; margin-right:0; } li.jstree-open > ul { display:block; } li.jstree-closed > ul { display:none; } ";
            if (/msie/.test(i) && parseInt(s, 10) == 6) {
                e = !0;
                try {
                    document.execCommand("BackgroundImageCache", !1, !0)
                } catch (u) {
                }
                o += ".jstree li { height:18px; margin-left:0; margin-right:0; } .jstree li li { margin-left:18px; } .jstree-rtl li li { margin-left:0px; margin-right:18px; } li.jstree-open ul { display:block; } li.jstree-closed ul { display:none !important; } .jstree li a { display:inline; border-width:0 !important; padding:0px 2px !important; } .jstree li a ins { height:16px; width:16px; margin-right:3px; } .jstree-rtl li a ins { margin-right:0px; margin-left:3px; } "
            }
            /msie/.test(i) && parseInt(s, 10) == 7 && (t = !0, o += ".jstree li a { border-width:0 !important; padding:0px 2px !important; } "), !/compatible/.test(i) && /mozilla/.test(i) && parseFloat(s, 10) < 1.9 && (n = !0, o += ".jstree ins { display:-moz-inline-box; } .jstree li { line-height:12px; } .jstree a { display:-moz-inline-box; } .jstree .jstree-no-icons .jstree-checkbox { display:-moz-inline-stack !important; } "), r.vakata.css.add_sheet({str: o,title: "jstree"})
        }), r.jstree.plugin("core", {__init: function() {
                this.data.core.locked = !1, this.data.core.to_open = this.get_settings().core.initially_open, this.data.core.to_load = this.get_settings().core.initially_load
            },defaults: {html_titles: !1,animation: 500,initially_open: [],initially_load: [],open_parents: !0,notify_plugins: !0,rtl: !1,load_open: !1,strings: {loading: "Loading ...",new_node: "New node",multiple_selection: "Multiple selection"}},_fn: {init: function() {
                    this.set_focus(), this._get_settings().core.rtl && this.get_container().addClass("jstree-rtl").css("direction", "rtl"), this.get_container().html("<ul><li class='jstree-last jstree-leaf'><ins>&#160;</ins><a class='jstree-loading' href='#'><ins class='jstree-icon'>&#160;</ins>" + this._get_string("loading") + "</a></li></ul>"), this.data.core.li_height = this.get_container_ul().find("li.jstree-closed, li.jstree-leaf").eq(0).height() || 18, this.get_container().delegate("li > ins", "click.jstree", r.proxy(function(e) {
                        var t = r(e.target);
                        this.toggle_node(t)
                    }, this)).bind("mousedown.jstree", r.proxy(function() {
                        this.set_focus()
                    }, this)).bind("dblclick.jstree", function(e) {
                        var t;
                        if (document.selection && document.selection.empty)
                            document.selection.empty();
                        else if (window.getSelection) {
                            t = window.getSelection();
                            try {
                                t.removeAllRanges(), t.collapse()
                            } catch (n) {
                            }
                        }
                    }), this._get_settings().core.notify_plugins && this.get_container().bind("load_node.jstree", r.proxy(function(e, t) {
                        var n = this._get_node(t.rslt.obj), i = this;
                        n === -1 && (n = this.get_container_ul());
                        if (!n.length)
                            return;
                        n.find("li").each(function() {
                            var e = r(this);
                            e.data("jstree") && r.each(e.data("jstree"), function(t, n) {
                                i.data[t] && r.isFunction(i["_" + t + "_notify"]) && i["_" + t + "_notify"].call(i, e, n)
                            })
                        })
                    }, this)), this._get_settings().core.load_open && this.get_container().bind("load_node.jstree", r.proxy(function(e, t) {
                        var n = this._get_node(t.rslt.obj), i = this;
                        n === -1 && (n = this.get_container_ul());
                        if (!n.length)
                            return;
                        n.find("li.jstree-open:not(:has(ul))").each(function() {
                            i.load_node(this, r.noop, r.noop)
                        })
                    }, this)), this.__callback(), this.load_node(-1, function() {
                        this.loaded(), this.reload_nodes()
                    })
                },destroy: function() {
                    var e, t = this.get_index(), n = this._get_settings(), u = this;
                    r.each(n.plugins, function(e, t) {
                        try {
                            o[t].__destroy.apply(u)
                        } catch (n) {
                        }
                    }), this.__callback();
                    if (this.is_focused())
                        for (e in i)
                            if (i.hasOwnProperty(e) && e != t) {
                                i[e].set_focus();
                                break
                            }
                    t === s && (s = -1), this.get_container().unbind(".jstree").undelegate(".jstree").removeData("jstree_instance_id").find("[class^='jstree']").andSelf().attr("class", function() {
                        return this.className.replace(/jstree[^ ]*|$/ig, "")
                    }), r(document).unbind(".jstree-" + t).undelegate(".jstree-" + t), i[t] = null, delete i[t]
                },_core_notify: function(e, t) {
                    t.opened && this.open_node(e, !1, !0)
                },lock: function() {
                    this.data.core.locked = !0, this.get_container().children("ul").addClass("jstree-locked").css("opacity", "0.7"), this.__callback({})
                },unlock: function() {
                    this.data.core.locked = !1, this.get_container().children("ul").removeClass("jstree-locked").css("opacity", "1"), this.__callback({})
                },is_locked: function() {
                    return this.data.core.locked
                },save_opened: function() {
                    var e = this;
                    this.data.core.to_open = [], this.get_container_ul().find("li.jstree-open").each(function() {
                        this.id && e.data.core.to_open.push("#" + this.id.toString().replace(/^#/, "").replace(/\\\//g, "/").replace(/\//g, "\\/").replace(/\\\./g, ".").replace(/\./g, "\\.").replace(/\:/g, "\\:"))
                    }), this.__callback(e.data.core.to_open)
                },save_loaded: function() {
                },reload_nodes: function(e) {
                    var t = this, n = !0, i = [], s = [];
                    e || (this.data.core.reopen = !1, this.data.core.refreshing = !0, this.data.core.to_open = r.map(r.makeArray(this.data.core.to_open), function(e) {
                        return "#" + e.toString().replace(/^#/, "").replace(/\\\//g, "/").replace(/\//g, "\\/").replace(/\\\./g, ".").replace(/\./g, "\\.").replace(/\:/g, "\\:")
                    }), this.data.core.to_load = r.map(r.makeArray(this.data.core.to_load), function(e) {
                        return "#" + e.toString().replace(/^#/, "").replace(/\\\//g, "/").replace(/\//g, "\\/").replace(/\\\./g, ".").replace(/\./g, "\\.").replace(/\:/g, "\\:")
                    }), this.data.core.to_open.length && (this.data.core.to_load = this.data.core.to_load.concat(this.data.core.to_open))), this.data.core.to_load.length && (r.each(this.data.core.to_load, function(e, t) {
                        if (t == "#")
                            return !0;
                        r(t).length ? i.push(t) : s.push(t)
                    }), i.length && (this.data.core.to_load = s, r.each(i, function(e, r) {
                        t._is_loaded(r) || (t.load_node(r, function() {
                            t.reload_nodes(!0)
                        }, function() {
                            t.reload_nodes(!0)
                        }), n = !1)
                    }))), this.data.core.to_open.length && r.each(this.data.core.to_open, function(e, n) {
                        t.open_node(n, !1, !0)
                    }), n && (this.data.core.reopen && clearTimeout(this.data.core.reopen), this.data.core.reopen = setTimeout(function() {
                        t.__callback({}, t)
                    }, 50), this.data.core.refreshing = !1, this.reopen())
                },reopen: function() {
                    var e = this;
                    this.data.core.to_open.length && r.each(this.data.core.to_open, function(t, n) {
                        e.open_node(n, !1, !0)
                    }), this.__callback({})
                },refresh: function(e) {
                    var t = this;
                    this.save_opened(), e || (e = -1), e = this._get_node(e), e || (e = -1), e !== -1 ? e.children("UL").remove() : this.get_container_ul().empty(), this.load_node(e, function() {
                        t.__callback({obj: e}), t.reload_nodes()
                    })
                },loaded: function() {
                    this.__callback()
                },set_focus: function() {
                    if (this.is_focused())
                        return;
                    var e = r.jstree._focused();
                    e && e.unset_focus(), this.get_container().addClass("jstree-focused"), s = this.get_index(), this.__callback()
                },is_focused: function() {
                    return s == this.get_index()
                },unset_focus: function() {
                    this.is_focused() && (this.get_container().removeClass("jstree-focused"), s = -1), this.__callback()
                },_get_node: function(e) {
                    var t = r(e, this.get_container());
                    return t.is(".jstree") || e == -1 ? -1 : (t = t.closest("li", this.get_container()), t.length ? t : !1)
                },_get_next: function(e, t) {
                    return e = this._get_node(e), e === -1 ? this.get_container().find("> ul > li:first-child") : e.length ? t ? e.nextAll("li").size() > 0 ? e.nextAll("li:eq(0)") : !1 : e.hasClass("jstree-open") ? e.find("li:eq(0)") : e.nextAll("li").size() > 0 ? e.nextAll("li:eq(0)") : e.parentsUntil(".jstree", "li").next("li").eq(0) : !1
                },_get_prev: function(e, t) {
                    e = this._get_node(e);
                    if (e === -1)
                        return this.get_container().find("> ul > li:last-child");
                    if (!e.length)
                        return !1;
                    if (t)
                        return e.prevAll("li").length > 0 ? e.prevAll("li:eq(0)") : !1;
                    if (e.prev("li").length) {
                        e = e.prev("li").eq(0);
                        while (e.hasClass("jstree-open"))
                            e = e.children("ul:eq(0)").children("li:last");
                        return e
                    }
                    var n = e.parentsUntil(".jstree", "li:eq(0)");
                    return n.length ? n : !1
                },_get_parent: function(e) {
                    e = this._get_node(e);
                    if (e == -1 || !e.length)
                        return !1;
                    var t = e.parentsUntil(".jstree", "li:eq(0)");
                    return t.length ? t : -1
                },_get_children: function(e) {
                    return e = this._get_node(e), e === -1 ? this.get_container().children("ul:eq(0)").children("li") : e.length ? e.children("ul:eq(0)").children("li") : !1
                },get_path: function(e, t) {
                    var n = [], r = this;
                    return e = this._get_node(e), e === -1 || !e || !e.length ? !1 : (e.parentsUntil(".jstree", "li").each(function() {
                        n.push(t ? this.id : r.get_text(this))
                    }), n.reverse(), n.push(t ? e.attr("id") : this.get_text(e)), n)
                },_get_string: function(e) {
                    return this._get_settings().core.strings[e] || e
                },is_open: function(e) {
                    return e = this._get_node(e), e && e !== -1 && e.hasClass("jstree-open")
                },is_closed: function(e) {
                    return e = this._get_node(e), e && e !== -1 && e.hasClass("jstree-closed")
                },is_leaf: function(e) {
                    return e = this._get_node(e), e && e !== -1 && e.hasClass("jstree-leaf")
                },correct_state: function(e) {
                    e = this._get_node(e);
                    if (!e || e === -1)
                        return !1;
                    e.removeClass("jstree-closed jstree-open").addClass("jstree-leaf").children("ul").remove(), this.__callback({obj: e})
                },open_node: function(t, n, r) {
                    t = this._get_node(t);
                    if (!t.length)
                        return !1;
                    if (!t.hasClass("jstree-closed"))
                        return n && n.call(), !1;
                    var i = r || e ? 0 : this._get_settings().core.animation, s = this;
                    this._is_loaded(t) ? (this._get_settings().core.open_parents && t.parentsUntil(".jstree", ".jstree-closed").each(function() {
                        s.open_node(this, !1, !0)
                    }), i && t.children("ul").css("display", "none"), t.removeClass("jstree-closed").addClass("jstree-open").children("a").removeClass("jstree-loading"), i ? t.children("ul").stop(!0, !0).slideDown(i, function() {
                        this.style.display = "", s.after_open(t)
                    }) : s.after_open(t), this.__callback({obj: t}), n && n.call()) : (t.children("a").addClass("jstree-loading"), this.load_node(t, function() {
                        s.open_node(t, n, r)
                    }, n))
                },after_open: function(e) {
                    this.__callback({obj: e})
                },close_node: function(t, n) {
                    t = this._get_node(t);
                    var r = n || e ? 0 : this._get_settings().core.animation, i = this;
                    if (!t.length || !t.hasClass("jstree-open"))
                        return !1;
                    r && t.children("ul").attr("style", "display:block !important"), t.removeClass("jstree-open").addClass("jstree-closed"), r ? t.children("ul").stop(!0, !0).slideUp(r, function() {
                        this.style.display = "", i.after_close(t)
                    }) : i.after_close(t), this.__callback({obj: t})
                },after_close: function(e) {
                    this.__callback({obj: e})
                },toggle_node: function(e) {
                    e = this._get_node(e);
                    if (e.hasClass("jstree-closed"))
                        return this.open_node(e);
                    if (e.hasClass("jstree-open"))
                        return this.close_node(e)
                },open_all: function(e, t, n) {
                    e = e ? this._get_node(e) : -1;
                    if (!e || e === -1)
                        e = this.get_container_ul();
                    n ? e = e.find("li.jstree-closed") : (n = e, e.is(".jstree-closed") ? e = e.find("li.jstree-closed").andSelf() : e = e.find("li.jstree-closed"));
                    var r = this;
                    e.each(function() {
                        var e = this;
                        r._is_loaded(this) ? r.open_node(this, !1, !t) : r.open_node(this, function() {
                            r.open_all(e, t, n)
                        }, !t)
                    }), n.find("li.jstree-closed").length === 0 && this.__callback({obj: n})
                },close_all: function(e, t) {
                    var n = this;
                    e = e ? this._get_node(e) : this.get_container();
                    if (!e || e === -1)
                        e = this.get_container_ul();
                    e.find("li.jstree-open").andSelf().each(function() {
                        n.close_node(this, !t)
                    }), this.__callback({obj: e})
                },clean_node: function(e) {
                    e = e && e != -1 ? r(e) : this.get_container_ul(), e = e.is("li") ? e.find("li").andSelf() : e.find("li"), e.removeClass("jstree-last").filter("li:last-child").addClass("jstree-last").end().filter(":has(li)").not(".jstree-open").removeClass("jstree-leaf").addClass("jstree-closed"), e.not(".jstree-open, .jstree-closed").addClass("jstree-leaf").children("ul").remove(), this.__callback({obj: e})
                },get_rollback: function() {
                    return this.__callback(), {i: this.get_index(),h: this.get_container().children("ul").clone(!0),d: this.data}
                },set_rollback: function(e, t) {
                    this.get_container().empty().append(e), this.data = t, this.__callback()
                },load_node: function(e, t, n) {
                    this.__callback({obj: e})
                },_is_loaded: function(e) {
                    return !0
                },create_node: function(e, t, n, i, s) {
                    e = this._get_node(e), t = typeof t == "undefined" ? "last" : t;
                    var o = r("<li />"), u = this._get_settings().core, a;
                    if (e !== -1 && !e.length)
                        return !1;
                    if (!s && !this._is_loaded(e))
                        return this.load_node(e, function() {
                            this.create_node(e, t, n, i, !0)
                        }), !1;
                    this.__rollback(), typeof n == "string" && (n = {data: n}), n || (n = {}), n.attr && o.attr(n.attr), n.metadata && o.data(n.metadata), n.state && o.addClass("jstree-" + n.state), n.data || (n.data = this._get_string("new_node")), r.isArray(n.data) || (a = n.data, n.data = [], n.data.push(a)), r.each(n.data, function(e, t) {
                        a = r("<a />"), r.isFunction(t) && (t = t.call(this, n)), typeof t == "string" ? a.attr("href", "#")[u.html_titles ? "html" : "text"](t) : (t.attr || (t.attr = {}), t.attr.href || (t.attr.href = "#"), a.attr(t.attr)[u.html_titles ? "html" : "text"](t.title), t.language && a.addClass(t.language)), a.prepend("<ins class='jstree-icon'>&#160;</ins>"), !t.icon && n.icon && (t.icon = n.icon), t.icon && (t.icon.indexOf("/") === -1 ? a.children("ins").addClass(t.icon) : a.children("ins").css("background", "url('" + t.icon + "') center center no-repeat")), o.append(a)
                    }), o.prepend("<ins class='jstree-icon'>&#160;</ins>"), e === -1 && (e = this.get_container(), t === "before" && (t = "first"), t === "after" && (t = "last"));
                    switch (t) {
                        case "before":
                            e.before(o), a = this._get_parent(e);
                            break;
                        case "after":
                            e.after(o), a = this._get_parent(e);
                            break;
                        case "inside":
                        case "first":
                            e.children("ul").length || e.append("<ul />"), e.children("ul").prepend(o), a = e;
                            break;
                        case "last":
                            e.children("ul").length || e.append("<ul />"), e.children("ul").append(o), a = e;
                            break;
                        default:
                            e.children("ul").length || e.append("<ul />"), t || (t = 0), a = e.children("ul").children("li").eq(t), a.length ? a.before(o) : e.children("ul").append(o), a = e
                    }
                    if (a === -1 || a.get(0) === this.get_container().get(0))
                        a = -1;
                    return this.clean_node(a), this.__callback({obj: o,parent: a}), i && i.call(this, o), o
                },get_text: function(e) {
                    e = this._get_node(e);
                    if (!e.length)
                        return !1;
                    var t = this._get_settings().core.html_titles;
                    return e = e.children("a:eq(0)"), t ? (e = e.clone(), e.children("INS").remove(), e.html()) : (e = e.contents().filter(function() {
                        return this.nodeType == 3
                    })[0], e.nodeValue)
                },set_text: function(e, t) {
                    e = this._get_node(e);
                    if (!e.length)
                        return !1;
                    e = e.children("a:eq(0)");
                    if (this._get_settings().core.html_titles) {
                        var n = e.children("INS").clone();
                        return e.html(t).prepend(n), this.__callback({obj: e,name: t}), !0
                    }
                    return e = e.contents().filter(function() {
                        return this.nodeType == 3
                    })[0], this.__callback({obj: e,name: t}), e.nodeValue = t
                },rename_node: function(e, t) {
                    e = this._get_node(e), this.__rollback(), e && e.length && this.set_text.apply(this, Array.prototype.slice.call(arguments)) && this.__callback({obj: e,name: t})
                },delete_node: function(e) {
                    e = this._get_node(e);
                    if (!e.length)
                        return !1;
                    this.__rollback();
                    var t = this._get_parent(e), n = r([]), i = this;
                    return e.each(function() {
                        n = n.add(i._get_prev(this))
                    }), e = e.detach(), t !== -1 && t.find("> ul > li").length === 0 && t.removeClass("jstree-open jstree-closed").addClass("jstree-leaf"), this.clean_node(t), this.__callback({obj: e,prev: n,parent: t}), e
                },prepare_move: function(e, t, n, i, s) {
                    var o = {};
                    o.ot = r.jstree._reference(e) || this, o.o = o.ot._get_node(e), o.r = t === -1 ? -1 : this._get_node(t), o.p = typeof n == "undefined" || n === !1 ? "last" : n;
                    if (!s && u.o && u.o[0] === o.o[0] && u.r[0] === o.r[0] && u.p === o.p) {
                        this.__callback(u), i && i.call(this, u);
                        return
                    }
                    o.ot = r.jstree._reference(o.o) || this, o.rt = r.jstree._reference(o.r) || this;
                    if (o.r === -1 || !o.r) {
                        o.cr = -1;
                        switch (o.p) {
                            case "first":
                            case "before":
                            case "inside":
                                o.cp = 0;
                                break;
                            case "after":
                            case "last":
                                o.cp = o.rt.get_container().find(" > ul > li").length;
                                break;
                            default:
                                o.cp = o.p
                        }
                    } else {
                        if (!/^(before|after)$/.test(o.p) && !this._is_loaded(o.r))
                            return this.load_node(o.r, function() {
                                this.prepare_move(e, t, n, i, !0)
                            });
                        switch (o.p) {
                            case "before":
                                o.cp = o.r.index(), o.cr = o.rt._get_parent(o.r);
                                break;
                            case "after":
                                o.cp = o.r.index() + 1, o.cr = o.rt._get_parent(o.r);
                                break;
                            case "inside":
                            case "first":
                                o.cp = 0, o.cr = o.r;
                                break;
                            case "last":
                                o.cp = o.r.find(" > ul > li").length, o.cr = o.r;
                                break;
                            default:
                                o.cp = o.p, o.cr = o.r
                        }
                    }
                    o.np = o.cr == -1 ? o.rt.get_container() : o.cr, o.op = o.ot._get_parent(o.o), o.cop = o.o.index(), o.op === -1 && (o.op = o.ot ? o.ot.get_container() : this.get_container()), !/^(before|after)$/.test(o.p) && o.op && o.np && o.op[0] === o.np[0] && o.o.index() < o.cp && o.cp++, o.or = o.np.find(" > ul > li:nth-child(" + (o.cp + 1) + ")"), u = o, this.__callback(u), i && i.call(this, u)
                },check_move: function() {
                    var e = u, t = !0, n = e.r === -1 ? this.get_container() : e.r;
                    return !e || !e.o || e.or[0] === e.o[0] ? !1 : e.op && e.np && e.op[0] === e.np[0] && e.cp - 1 === e.o.index() ? !1 : (e.o.each(function() {
                        if (n.parentsUntil(".jstree", "li").andSelf().index(this) !== -1)
                            return t = !1, !1
                    }), t)
                },move_node: function(e, t, n, i, s, o) {
                    if (!s)
                        return this.prepare_move(e, t, n, function(e) {
                            this.move_node(e, !1, !1, i, !0, o)
                        });
                    i && (u.cy = !0);
                    if (!o && !this.check_move())
                        return !1;
                    this.__rollback();
                    var a = !1;
                    i ? (a = e.o.clone(!0), a.find("*[id]").andSelf().each(function() {
                        this.id && (this.id = "copy_" + this.id)
                    })) : a = e.o, e.or.length ? e.or.before(a) : (e.np.children("ul").length || r("<ul />").appendTo(e.np), e.np.children("ul:eq(0)").append(a));
                    try {
                        e.ot.clean_node(e.op), e.rt.clean_node(e.np), e.op.find("> ul > li").length || e.op.removeClass("jstree-open jstree-closed").addClass("jstree-leaf").children("ul").remove()
                    } catch (f) {
                    }
                    return i && (u.cy = !0, u.oc = a), this.__callback(u), u
                },_get_move: function() {
                    return u
                }}})
    })(jQuery), function(e) {
        var t, n, r;
        e(function() {
            /msie/.test(navigator.userAgent.toLowerCase()) ? (n = e('<textarea cols="10" rows="2"></textarea>').css({position: "absolute",top: -1e3,left: 0}).appendTo("body"), r = e('<textarea cols="10" rows="2" style="overflow: hidden;"></textarea>').css({position: "absolute",top: -1e3,left: 0}).appendTo("body"), t = n.width() - r.width(), n.add(r).remove()) : (n = e("<div />").css({width: 100,height: 100,overflow: "auto",position: "absolute",top: -1e3,left: 0}).prependTo("body").append("<div />").find("div").css({width: "100%",height: 200}), t = 100 - n.width(), n.parent().remove())
        }), e.jstree.plugin("ui", {__init: function() {
                this.data.ui.selected = e(), this.data.ui.last_selected = !1, this.data.ui.hovered = null, this.data.ui.to_select = this.get_settings().ui.initially_select, this.get_container().delegate("a", "click.jstree", e.proxy(function(t) {
                    t.preventDefault(), t.currentTarget.blur(), e(t.currentTarget).hasClass("jstree-loading") || this.select_node(t.currentTarget, !0, t)
                }, this)).delegate("a", "mouseenter.jstree", e.proxy(function(t) {
                    e(t.currentTarget).hasClass("jstree-loading") || this.hover_node(t.target)
                }, this)).delegate("a", "mouseleave.jstree", e.proxy(function(t) {
                    e(t.currentTarget).hasClass("jstree-loading") || this.dehover_node(t.target)
                }, this)).bind("reopen.jstree", e.proxy(function() {
                    this.reselect()
                }, this)).bind("get_rollback.jstree", e.proxy(function() {
                    this.dehover_node(), this.save_selected()
                }, this)).bind("set_rollback.jstree", e.proxy(function() {
                    this.reselect()
                }, this)).bind("close_node.jstree", e.proxy(function(t, n) {
                    var r = this._get_settings().ui, i = this._get_node(n.rslt.obj), s = i && i.length ? i.children("ul").find("a.jstree-clicked") : e(), o = this;
                    if (r.selected_parent_close === !1 || !s.length)
                        return;
                    s.each(function() {
                        o.deselect_node(this), r.selected_parent_close === "select_parent" && o.select_node(i)
                    })
                }, this)).bind("delete_node.jstree", e.proxy(function(e, t) {
                    var n = this._get_settings().ui.select_prev_on_delete, r = this._get_node(t.rslt.obj), i = r && r.length ? r.find("a.jstree-clicked") : [], s = this;
                    i.each(function() {
                        s.deselect_node(this)
                    }), n && i.length && t.rslt.prev.each(function() {
                        if (this.parentNode)
                            return s.select_node(this), !1
                    })
                }, this)).bind("move_node.jstree", e.proxy(function(e, t) {
                    t.rslt.cy && t.rslt.oc.find("a.jstree-clicked").removeClass("jstree-clicked")
                }, this))
            },defaults: {select_limit: -1,select_multiple_modifier: "ctrl",select_range_modifier: "shift",selected_parent_close: "select_parent",selected_parent_open: !0,select_prev_on_delete: !0,disable_selecting_children: !1,initially_select: []},_fn: {_get_node: function(t, n) {
                    if (typeof t == "undefined" || t === null)
                        return n ? this.data.ui.selected : this.data.ui.last_selected;
                    var r = e(t, this.get_container());
                    return r.is(".jstree") || t == -1 ? -1 : (r = r.closest("li", this.get_container()), r.length ? r : !1)
                },_ui_notify: function(e, t) {
                    t.selected && this.select_node(e, !1)
                },save_selected: function() {
                    var e = this;
                    this.data.ui.to_select = [], this.data.ui.selected.each(function() {
                        this.id && e.data.ui.to_select.push("#" + this.id.toString().replace(/^#/, "").replace(/\\\//g, "/").replace(/\//g, "\\/").replace(/\\\./g, ".").replace(/\./g, "\\.").replace(/\:/g, "\\:"))
                    }), this.__callback(this.data.ui.to_select)
                },reselect: function() {
                    var t = this, n = this.data.ui.to_select;
                    n = e.map(e.makeArray(n), function(e) {
                        return "#" + e.toString().replace(/^#/, "").replace(/\\\//g, "/").replace(/\//g, "\\/").replace(/\\\./g, ".").replace(/\./g, "\\.").replace(/\:/g, "\\:")
                    }), e.each(n, function(e, n) {
                        n && n !== "#" && t.select_node(n)
                    }), this.data.ui.selected = this.data.ui.selected.filter(function() {
                        return this.parentNode
                    }), this.__callback()
                },refresh: function(e) {
                    return this.save_selected(), this.__call_old()
                },hover_node: function(e) {
                    e = this._get_node(e);
                    if (!e.length)
                        return !1;
                    e.hasClass("jstree-hovered") || this.dehover_node(), this.data.ui.hovered = e.children("a").addClass("jstree-hovered").parent(), this._fix_scroll(e), this.__callback({obj: e})
                },dehover_node: function() {
                    var e = this.data.ui.hovered, t;
                    if (!e || !e.length)
                        return !1;
                    t = e.children("a").removeClass("jstree-hovered").parent(), this.data.ui.hovered[0] === t[0] && (this.data.ui.hovered = null), this.__callback({obj: e})
                },select_node: function(e, t, n) {
                    e = this._get_node(e);
                    if (e == -1 || !e || !e.length)
                        return !1;
                    var r = this._get_settings().ui, i = r.select_multiple_modifier == "on" || r.select_multiple_modifier !== !1 && n && n[r.select_multiple_modifier + "Key"], s = r.select_range_modifier !== !1 && n && n[r.select_range_modifier + "Key"] && this.data.ui.last_selected && this.data.ui.last_selected[0] !== e[0] && this.data.ui.last_selected.parent()[0] === e.parent()[0], o = this.is_selected(e), u = !0, a = this;
                    if (t) {
                        if (r.disable_selecting_children && i && (e.parentsUntil(".jstree", "li").children("a.jstree-clicked").length || e.children("ul").find("a.jstree-clicked:eq(0)").length))
                            return !1;
                        u = !1;
                        switch (!0) {
                            case s:
                                this.data.ui.last_selected.addClass("jstree-last-selected"), e = e[e.index() < this.data.ui.last_selected.index() ? "nextUntil" : "prevUntil"](".jstree-last-selected").andSelf(), r.select_limit == -1 || e.length < r.select_limit ? (this.data.ui.last_selected.removeClass("jstree-last-selected"), this.data.ui.selected.each(function() {
                                    this !== a.data.ui.last_selected[0] && a.deselect_node(this)
                                }), o = !1, u = !0) : u = !1;
                                break;
                            case o && !i:
                                this.deselect_all(), o = !1, u = !0;
                                break;
                            case !o && !i:
                                if (r.select_limit == -1 || r.select_limit > 0)
                                    this.deselect_all(), u = !0;
                                break;
                            case o && i:
                                this.deselect_node(e);
                                break;
                            case !o && i:
                                if (r.select_limit == -1 || this.data.ui.selected.length + 1 <= r.select_limit)
                                    u = !0
                        }
                    }
                    u && !o && (s || (this.data.ui.last_selected = e), e.children("a").addClass("jstree-clicked"), r.selected_parent_open && e.parents(".jstree-closed").each(function() {
                        a.open_node(this, !1, !0)
                    }), this.data.ui.selected = this.data.ui.selected.add(e), this._fix_scroll(e.eq(0)), this.__callback({obj: e,e: n}))
                },_fix_scroll: function(e) {
                    var n = this.get_container()[0], r;
                    if (n.scrollHeight > n.offsetHeight) {
                        e = this._get_node(e);
                        if (!e || e === -1 || !e.length || !e.is(":visible"))
                            return;
                        r = e.offset().top - this.get_container().offset().top, r < 0 && (n.scrollTop = n.scrollTop + r - 1), r + this.data.core.li_height + (n.scrollWidth > n.offsetWidth ? t : 0) > n.offsetHeight && (n.scrollTop = n.scrollTop + (r - n.offsetHeight + this.data.core.li_height + 1 + (n.scrollWidth > n.offsetWidth ? t : 0)))
                    }
                },deselect_node: function(e) {
                    e = this._get_node(e);
                    if (!e.length)
                        return !1;
                    this.is_selected(e) && (e.children("a").removeClass("jstree-clicked"), this.data.ui.selected = this.data.ui.selected.not(e), this.data.ui.last_selected.get(0) === e.get(0) && (this.data.ui.last_selected = this.data.ui.selected.eq(0)), this.__callback({obj: e}))
                },toggle_select: function(e) {
                    e = this._get_node(e);
                    if (!e.length)
                        return !1;
                    this.is_selected(e) ? this.deselect_node(e) : this.select_node(e)
                },is_selected: function(e) {
                    return this.data.ui.selected.index(this._get_node(e)) >= 0
                },get_selected: function(t) {
                    return t ? e(t).find("a.jstree-clicked").parent() : this.data.ui.selected
                },deselect_all: function(t) {
                    var n = t ? e(t).find("a.jstree-clicked").parent() : this.get_container().find("a.jstree-clicked").parent();
                    n.children("a.jstree-clicked").removeClass("jstree-clicked"), this.data.ui.selected = e([]), this.data.ui.last_selected = !1, this.__callback({obj: n})
                }}}), e.jstree.defaults.plugins.push("ui")
    }(jQuery), function(e) {
        e.jstree.plugin("crrm", {__init: function() {
                this.get_container().bind("move_node.jstree", e.proxy(function(e, t) {
                    if (this._get_settings().crrm.move.open_onmove) {
                        var n = this;
                        t.rslt.np.parentsUntil(".jstree").andSelf().filter(".jstree-closed").each(function() {
                            n.open_node(this, !1, !0)
                        })
                    }
                }, this))
            },defaults: {input_width_limit: 200,move: {always_copy: !1,open_onmove: !0,default_position: "last",check_move: function(e) {
                        return !0
                    }}},_fn: {_show_input: function(t, n) {
                    t = this._get_node(t);
                    var r = this._get_settings().core.rtl, i = this._get_settings().crrm.input_width_limit, s = t.children("ins").width(), o = t.find("> a:visible > ins").width() * t.find("> a:visible > ins").length, u = this.get_text(t), a = e("<div />", {css: {position: "absolute",top: "-200px",left: r ? "0px" : "-1000px",visibility: "hidden"}}).appendTo("body"), f = t.css("position", "relative").append(e("<input />", {value: u,"class": "jstree-rename-input",css: {padding: "0",border: "1px solid silver",position: "absolute",left: r ? "auto" : s + o + 4 + "px",right: r ? s + o + 4 + "px" : "auto",top: "0px",height: this.data.core.li_height - 2 + "px",lineHeight: this.data.core.li_height - 2 + "px",width: "150px"},blur: e.proxy(function() {
                            var e = t.children(".jstree-rename-input"), r = e.val();
                            r === "" && (r = u), a.remove(), e.remove(), this.set_text(t, u), this.rename_node(t, r), n.call(this, t, r, u), t.css("position", "")
                        }, this),keyup: function(e) {
                            var t = e.keyCode || e.which;
                            if (t == 27) {
                                this.value = u, this.blur();
                                return
                            }
                            if (t == 13) {
                                this.blur();
                                return
                            }
                            f.width(Math.min(a.text("pW" + this.value).width(), i))
                        },keypress: function(e) {
                            var t = e.keyCode || e.which;
                            if (t == 13)
                                return !1
                        }})).children(".jstree-rename-input");
                    this.set_text(t, ""), a.css({fontFamily: f.css("fontFamily") || "",fontSize: f.css("fontSize") || "",fontWeight: f.css("fontWeight") || "",fontStyle: f.css("fontStyle") || "",fontStretch: f.css("fontStretch") || "",fontVariant: f.css("fontVariant") || "",letterSpacing: f.css("letterSpacing") || "",wordSpacing: f.css("wordSpacing") || ""}), f.width(Math.min(a.text("pW" + f[0].value).width(), i))[0].select()
                },rename: function(e) {
                    e = this._get_node(e), this.__rollback();
                    var t = this.__callback;
                    this._show_input(e, function(e, n, r) {
                        t.call(this, {obj: e,new_name: n,old_name: r})
                    })
                },create: function(t, n, r, i, s) {
                    var o, u = this;
                    return t = this._get_node(t), t || (t = -1), this.__rollback(), o = this.create_node(t, n, r, function(t) {
                        var n = this._get_parent(t), r = e(t).index();
                        i && i.call(this, t), n.length && n.hasClass("jstree-closed") && this.open_node(n, !1, !0), s ? u.__callback({obj: t,name: this.get_text(t),parent: n,position: r}) : this._show_input(t, function(e, t, i) {
                            u.__callback({obj: e,name: t,parent: n,position: r})
                        })
                    }), o
                },remove: function(e) {
                    e = this._get_node(e, !0);
                    var t = this._get_parent(e), n = this._get_prev(e);
                    this.__rollback(), e = this.delete_node(e), e !== !1 && this.__callback({obj: e,prev: n,parent: t})
                },check_move: function() {
                    if (!this.__call_old())
                        return !1;
                    var e = this._get_settings().crrm.move;
                    return e.check_move.call(this, this._get_move()) ? !0 : !1
                },move_node: function(e, t, n, r, i, s) {
                    var o = this._get_settings().crrm.move;
                    if (!i)
                        return typeof n == "undefined" && (n = o.default_position), n === "inside" && !o.default_position.match(/^(before|after)$/) && (n = o.default_position), this.__call_old(!0, e, t, n, r, !1, s);
                    if (o.always_copy === !0 || o.always_copy === "multitree" && e.rt.get_index() !== e.ot.get_index())
                        r = !0;
                    this.__call_old(!0, e, t, n, r, !0, s)
                },cut: function(e) {
                    e = this._get_node(e, !0);
                    if (!e || !e.length)
                        return !1;
                    this.data.crrm.cp_nodes = !1, this.data.crrm.ct_nodes = e, this.__callback({obj: e})
                },copy: function(e) {
                    e = this._get_node(e, !0);
                    if (!e || !e.length)
                        return !1;
                    this.data.crrm.ct_nodes = !1, this.data.crrm.cp_nodes = e, this.__callback({obj: e})
                },paste: function(e) {
                    e = this._get_node(e);
                    if (!e || !e.length)
                        return !1;
                    var t = this.data.crrm.ct_nodes ? this.data.crrm.ct_nodes : this.data.crrm.cp_nodes;
                    if (!this.data.crrm.ct_nodes && !this.data.crrm.cp_nodes)
                        return !1;
                    this.data.crrm.ct_nodes && (this.move_node(this.data.crrm.ct_nodes, e), this.data.crrm.ct_nodes = !1), this.data.crrm.cp_nodes && this.move_node(this.data.crrm.cp_nodes, e, !1, !0), this.__callback({obj: e,nodes: t})
                }}})
    }(jQuery), function(e) {
        var t = [];
        e.jstree._themes = !1, e.jstree.plugin("themes", {__init: function() {
                this.get_container().bind("init.jstree", e.proxy(function() {
                    var e = this._get_settings().themes;
                    this.data.themes.dots = e.dots, this.data.themes.icons = e.icons, this.set_theme(e.theme, e.url)
                }, this)).bind("loaded.jstree", e.proxy(function() {
                    this.data.themes.dots ? this.show_dots() : this.hide_dots(), this.data.themes.icons ? this.show_icons() : this.hide_icons()
                }, this))
            },defaults: {theme: "default",url: !1,dots: !0,icons: !0},_fn: {set_theme: function(n, r) {
                    if (!n)
                        return !1;
                    r || (r = e.jstree._themes + n + "/style.css"), e.inArray(r, t) == -1 && (e.vakata.css.add_sheet({url: r}), t.push(r)), this.data.themes.theme != n && (this.get_container().removeClass("jstree-" + this.data.themes.theme), this.data.themes.theme = n), this.get_container().addClass("jstree-" + n), this.data.themes.dots ? this.show_dots() : this.hide_dots(), this.data.themes.icons ? this.show_icons() : this.hide_icons(), this.__callback()
                },get_theme: function() {
                    return this.data.themes.theme
                },show_dots: function() {
                    this.data.themes.dots = !0, this.get_container().children("ul").removeClass("jstree-no-dots")
                },hide_dots: function() {
                    this.data.themes.dots = !1, this.get_container().children("ul").addClass("jstree-no-dots")
                },toggle_dots: function() {
                    this.data.themes.dots ? this.hide_dots() : this.show_dots()
                },show_icons: function() {
                    this.data.themes.icons = !0, this.get_container().children("ul").removeClass("jstree-no-icons")
                },hide_icons: function() {
                    this.data.themes.icons = !1, this.get_container().children("ul").addClass("jstree-no-icons")
                },toggle_icons: function() {
                    this.data.themes.icons ? this.hide_icons() : this.show_icons()
                }}}), e(function() {
            e.jstree._themes === !1 && e("script").each(function() {
                if (this.src.toString().match(/jquery\.jstree[^\/]*?\.js(\?.*)?$/))
                    return e.jstree._themes = this.src.toString().replace(/jquery\.jstree[^\/]*?\.js(\?.*)?$/, "") + "themes/", !1
            }), e.jstree._themes === !1 && (e.jstree._themes = "themes/")
        }), e.jstree.defaults.plugins.push("themes")
    }(jQuery), function(e) {
        function n(t, n) {
            var r = e.jstree._focused(), i;
            if (r && r.data && r.data.hotkeys && r.data.hotkeys.enabled) {
                i = r._get_settings().hotkeys[t];
                if (i)
                    return i.call(r, n)
            }
        }
        var t = [];
        e.jstree.plugin("hotkeys", {__init: function() {
                if (typeof e.hotkeys == "undefined")
                    throw "jsTree hotkeys: jQuery hotkeys plugin not included.";
                if (!this.data.ui)
                    throw "jsTree hotkeys: jsTree UI plugin not included.";
                e.each(this._get_settings().hotkeys, function(r, i) {
                    i !== !1 && e.inArray(r, t) == -1 && (e(document).bind("keydown", r, function(e) {
                        return n(r, e)
                    }), t.push(r))
                }), this.get_container().bind("lock.jstree", e.proxy(function() {
                    this.data.hotkeys.enabled && (this.data.hotkeys.enabled = !1, this.data.hotkeys.revert = !0)
                }, this)).bind("unlock.jstree", e.proxy(function() {
                    this.data.hotkeys.revert && (this.data.hotkeys.enabled = !0)
                }, this)), this.enable_hotkeys()
            },defaults: {up: function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected || -1;
                    return this.hover_node(this._get_prev(e)), !1
                },"ctrl+up": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected || -1;
                    return this.hover_node(this._get_prev(e)), !1
                },"shift+up": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected || -1;
                    return this.hover_node(this._get_prev(e)), !1
                },down: function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected || -1;
                    return this.hover_node(this._get_next(e)), !1
                },"ctrl+down": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected || -1;
                    return this.hover_node(this._get_next(e)), !1
                },"shift+down": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected || -1;
                    return this.hover_node(this._get_next(e)), !1
                },left: function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected;
                    return e && (e.hasClass("jstree-open") ? this.close_node(e) : this.hover_node(this._get_prev(e))), !1
                },"ctrl+left": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected;
                    return e && (e.hasClass("jstree-open") ? this.close_node(e) : this.hover_node(this._get_prev(e))), !1
                },"shift+left": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected;
                    return e && (e.hasClass("jstree-open") ? this.close_node(e) : this.hover_node(this._get_prev(e))), !1
                },right: function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected;
                    return e && e.length && (e.hasClass("jstree-closed") ? this.open_node(e) : this.hover_node(this._get_next(e))), !1
                },"ctrl+right": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected;
                    return e && e.length && (e.hasClass("jstree-closed") ? this.open_node(e) : this.hover_node(this._get_next(e))), !1
                },"shift+right": function() {
                    var e = this.data.ui.hovered || this.data.ui.last_selected;
                    return e && e.length && (e.hasClass("jstree-closed") ? this.open_node(e) : this.hover_node(this._get_next(e))), !1
                },space: function() {
                    return this.data.ui.hovered && this.data.ui.hovered.children("a:eq(0)").click(), !1
                },"ctrl+space": function(e) {
                    return e.type = "click", this.data.ui.hovered && this.data.ui.hovered.children("a:eq(0)").trigger(e), !1
                },"shift+space": function(e) {
                    return e.type = "click", this.data.ui.hovered && this.data.ui.hovered.children("a:eq(0)").trigger(e), !1
                },f2: function() {
                    this.rename(this.data.ui.hovered || this.data.ui.last_selected)
                },del: function() {
                    this.remove(this.data.ui.hovered || this._get_node(null))
                }},_fn: {enable_hotkeys: function() {
                    this.data.hotkeys.enabled = !0
                },disable_hotkeys: function() {
                    this.data.hotkeys.enabled = !1
                }}})
    }(jQuery), function(e) {
        e.jstree.plugin("json_data", {__init: function() {
                var e = this._get_settings().json_data;
                e.progressive_unload && this.get_container().bind("after_close.jstree", function(e, t) {
                    t.rslt.obj.children("ul").remove()
                })
            },defaults: {data: !1,ajax: !1,correct_state: !0,progressive_render: !1,progressive_unload: !1},_fn: {load_node: function(e, t, n) {
                    var r = this;
                    this.load_node_json(e, function() {
                        r.__callback({obj: r._get_node(e)}), t.call(this)
                    }, n)
                },_is_loaded: function(t) {
                    var n = this._get_settings().json_data;
                    return t = this._get_node(t), t == -1 || !t || !n.ajax && !n.progressive_render && !e.isFunction(n.data) || t.is(".jstree-open, .jstree-leaf") || t.children("ul").children("li").length > 0
                },refresh: function(t) {
                    t = this._get_node(t);
                    var n = this._get_settings().json_data;
                    return t && t !== -1 && n.progressive_unload && (e.isFunction(n.data) || !!n.ajax) && t.removeData("jstree_children"), this.__call_old()
                },load_node_json: function(t, n, r) {
                    var i = this.get_settings().json_data, s, o = function() {
                    }, u = function() {
                    };
                    t = this._get_node(t);
                    if (t && t !== -1 && (i.progressive_render || i.progressive_unload) && !t.is(".jstree-open, .jstree-leaf") && t.children("ul").children("li").length === 0 && t.data("jstree_children")) {
                        s = this._parse_json(t.data("jstree_children"), t), s && (t.append(s), i.progressive_unload || t.removeData("jstree_children")), this.clean_node(t), n && n.call(this);
                        return
                    }
                    if (t && t !== -1) {
                        if (t.data("jstree_is_loading"))
                            return;
                        t.data("jstree_is_loading", !0)
                    }
                    switch (!0) {
                        case !i.data && !i.ajax:
                            throw "Neither data nor ajax settings supplied.";
                        case e.isFunction(i.data):
                            i.data.call(this, t, e.proxy(function(e) {
                                e = this._parse_json(e, t), e ? (t === -1 || !t ? this.get_container().children("ul").empty().append(e.children()) : (t.append(e).children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading")), this.clean_node(t), n && n.call(this)) : (t === -1 || !t ? i.correct_state && this.get_container().children("ul").empty() : (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), i.correct_state && this.correct_state(t)), r && r.call(this))
                            }, this));
                            break;
                        case !!i.data && !i.ajax || !!i.data && !!i.ajax && (!t || t === -1):
                            if (!t || t == -1)
                                s = this._parse_json(i.data, t), s ? (this.get_container().children("ul").empty().append(s.children()), this.clean_node()) : i.correct_state && this.get_container().children("ul").empty();
                            n && n.call(this);
                            break;
                        case !i.data && !!i.ajax || !!i.data && !!i.ajax && t && t !== -1:
                            o = function(e, n, s) {
                                var o = this.get_settings().json_data.ajax.error;
                                o && o.call(this, e, n, s), t != -1 && t.length ? (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), n === "success" && i.correct_state && this.correct_state(t)) : n === "success" && i.correct_state && this.get_container().children("ul").empty(), r && r.call(this)
                            }, u = function(r, s, u) {
                                var a = this.get_settings().json_data.ajax.success;
                                a && (r = a.call(this, r, s, u) || r);
                                if (r === "" || r && r.toString && r.toString().replace(/^[\s\n]+$/, "") === "" || !e.isArray(r) && !e.isPlainObject(r))
                                    return o.call(this, u, s, "");
                                r = this._parse_json(r, t), r ? (t === -1 || !t ? this.get_container().children("ul").empty().append(r.children()) : (t.append(r).children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading")), this.clean_node(t), n && n.call(this)) : t === -1 || !t ? i.correct_state && (this.get_container().children("ul").empty(), n && n.call(this)) : (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), i.correct_state && (this.correct_state(t), n && n.call(this)))
                            }, i.ajax.context = this, i.ajax.error = o, i.ajax.success = u, i.ajax.dataType || (i.ajax.dataType = "json"), e.isFunction(i.ajax.url) && (i.ajax.url = i.ajax.url.call(this, t)), e.isFunction(i.ajax.data) && (i.ajax.data = i.ajax.data.call(this, t)), e.ajax(i.ajax)
                    }
                },_parse_json: function(t, n, r) {
                    var i = !1, s = this._get_settings(), o = s.json_data, u = s.core.html_titles, a, f, l, c, h;
                    if (!t)
                        return i;
                    o.progressive_unload && n && n !== -1 && n.data("jstree_children", i);
                    if (e.isArray(t)) {
                        i = e();
                        if (!t.length)
                            return !1;
                        for (f = 0, l = t.length; f < l; f++)
                            a = this._parse_json(t[f], n, !0), a.length && (i = i.add(a))
                    } else {
                        typeof t == "string" && (t = {data: t});
                        if (!t.data && t.data !== "")
                            return i;
                        i = e("<li />"), t.attr && i.attr(t.attr), t.metadata && i.data(t.metadata), t.state && i.addClass("jstree-" + t.state), e.isArray(t.data) || (a = t.data, t.data = [], t.data.push(a)), e.each(t.data, function(n, r) {
                            a = e("<a />"), e.isFunction(r) && (r = r.call(this, t)), typeof r == "string" ? a.attr("href", "#")[u ? "html" : "text"](r) : (r.attr || (r.attr = {}), r.attr.href || (r.attr.href = "#"), a.attr(r.attr)[u ? "html" : "text"](r.title), r.language && a.addClass(r.language)), a.prepend("<ins class='jstree-icon'>&#160;</ins>"), !r.icon && t.icon && (r.icon = t.icon), r.icon && (r.icon.indexOf("/") === -1 ? a.children("ins").addClass(r.icon) : a.children("ins").css("background", "url('" + r.icon + "') center center no-repeat")), i.append(a)
                        }), i.prepend("<ins class='jstree-icon'>&#160;</ins>"), t.children && (o.progressive_render && t.state !== "open" ? i.addClass("jstree-closed").data("jstree_children", t.children) : (o.progressive_unload && i.data("jstree_children", t.children), e.isArray(t.children) && t.children.length && (a = this._parse_json(t.children, n, !0), a.length && (h = e("<ul />"), h.append(a), i.append(h)))))
                    }
                    return r || (c = e("<ul />"), c.append(i), i = c), i
                },get_json: function(t, n, r, i) {
                    var s = [], o = this._get_settings(), u = this, a, f, l, c, h, p;
                    t = this._get_node(t);
                    if (!t || t === -1)
                        t = this.get_container().find("> ul > li");
                    return n = e.isArray(n) ? n : ["id", "class"], !i && this.data.types && n.push(o.types.type_attr), r = e.isArray(r) ? r : [], t.each(function() {
                        l = e(this), a = {data: []}, n.length && (a.attr = {}), e.each(n, function(e, t) {
                            f = l.attr(t), f && f.length && f.replace(/jstree[^ ]*/ig, "").length && (a.attr[t] = (" " + f).replace(/ jstree[^ ]*/ig, "").replace(/\s+$/ig, " ").replace(/^ /, "").replace(/ $/, ""))
                        }), l.hasClass("jstree-open") && (a.state = "open"), l.hasClass("jstree-closed") && (a.state = "closed"), l.data() && (a.metadata = l.data()), c = l.children("a"), c.each(function() {
                            h = e(this), r.length || e.inArray("languages", o.plugins) !== -1 || h.children("ins").get(0).style.backgroundImage.length || h.children("ins").get(0).className && h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig, "").length ? (p = !1, e.inArray("languages", o.plugins) !== -1 && e.isArray(o.languages) && o.languages.length && e.each(o.languages, function(e, t) {
                                if (h.hasClass(t))
                                    return p = t, !1
                            }), f = {attr: {},title: u.get_text(h, p)}, e.each(r, function(e, t) {
                                f.attr[t] = (" " + (h.attr(t) || "")).replace(/ jstree[^ ]*/ig, "").replace(/\s+$/ig, " ").replace(/^ /, "").replace(/ $/, "")
                            }), e.inArray("languages", o.plugins) !== -1 && e.isArray(o.languages) && o.languages.length && e.each(o.languages, function(e, t) {
                                if (h.hasClass(t))
                                    return f.language = t, !0
                            }), h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig, "").replace(/^\s+$/ig, "").length && (f.icon = h.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig, "").replace(/\s+$/ig, " ").replace(/^ /, "").replace(/ $/, "")), h.children("ins").get(0).style.backgroundImage.length && (f.icon = h.children("ins").get(0).style.backgroundImage.replace("url(", "").replace(")", ""))) : f = u.get_text(h), c.length > 1 ? a.data.push(f) : a.data = f
                        }), l = l.find("> ul > li"), l.length && (a.children = u.get_json(l, n, r, !0)), s.push(a)
                    }), s
                }}})
    }(jQuery), function(e) {
        e.jstree.plugin("languages", {__init: function() {
                this._load_css()
            },defaults: [],_fn: {set_lang: function(t) {
                    var n = this._get_settings().languages, r = !1, i = ".jstree-" + this.get_index() + " a";
                    if (!e.isArray(n) || n.length === 0)
                        return !1;
                    if (e.inArray(t, n) == -1) {
                        if (!n[t])
                            return !1;
                        t = n[t]
                    }
                    return t == this.data.languages.current_language ? !0 : (r = e.vakata.css.get_css(i + "." + this.data.languages.current_language, !1, this.data.languages.language_css), r !== !1 && (r.style.display = "none"), r = e.vakata.css.get_css(i + "." + t, !1, this.data.languages.language_css), r !== !1 && (r.style.display = ""), this.data.languages.current_language = t, this.__callback(t), !0)
                },get_lang: function() {
                    return this.data.languages.current_language
                },_get_string: function(t, n) {
                    var r = this._get_settings().languages, i = this._get_settings().core.strings;
                    return e.isArray(r) && r.length && (n = n && e.inArray(n, r) != -1 ? n : this.data.languages.current_language), i[n] && i[n][t] ? i[n][t] : i[t] ? i[t] : t
                },get_text: function(t, n) {
                    t = this._get_node(t) || this.data.ui.last_selected;
                    if (!t.size())
                        return !1;
                    var r = this._get_settings().languages, i = this._get_settings().core.html_titles;
                    return e.isArray(r) && r.length ? (n = n && e.inArray(n, r) != -1 ? n : this.data.languages.current_language, t = t.children("a." + n)) : t = t.children("a:eq(0)"), i ? (t = t.clone(), t.children("INS").remove(), t.html()) : (t = t.contents().filter(function() {
                        return this.nodeType == 3
                    })[0], t.nodeValue)
                },set_text: function(t, n, r) {
                    t = this._get_node(t) || this.data.ui.last_selected;
                    if (!t.size())
                        return !1;
                    var i = this._get_settings().languages, s = this._get_settings().core.html_titles, o;
                    return e.isArray(i) && i.length ? (r = r && e.inArray(r, i) != -1 ? r : this.data.languages.current_language, t = t.children("a." + r)) : t = t.children("a:eq(0)"), s ? (o = t.children("INS").clone(), t.html(n).prepend(o), this.__callback({obj: t,name: n,lang: r}), !0) : (t = t.contents().filter(function() {
                        return this.nodeType == 3
                    })[0], this.__callback({obj: t,name: n,lang: r}), t.nodeValue = n)
                },_load_css: function() {
                    var t = this._get_settings().languages, n = "/* languages css */", r = ".jstree-" + this.get_index() + " a", i;
                    if (e.isArray(t) && t.length) {
                        this.data.languages.current_language = t[0];
                        for (i = 0; i < t.length; i++)
                            n += r + "." + t[i] + " {", t[i] != this.data.languages.current_language && (n += " display:none; "), n += " } ";
                        this.data.languages.language_css = e.vakata.css.add_sheet({str: n,title: "jstree-languages"})
                    }
                },create_node: function(t, n, r, i) {
                    var s = this.__call_old(!0, t, n, r, function(t) {
                        var n = this._get_settings().languages, r = t.children("a"), s;
                        if (e.isArray(n) && n.length) {
                            for (s = 0; s < n.length; s++)
                                r.is("." + n[s]) || t.append(r.eq(0).clone().removeClass(n.join(" ")).addClass(n[s]));
                            r.not("." + n.join(", .")).remove()
                        }
                        i && i.call(this, t)
                    });
                    return s
                }}})
    }(jQuery), function(e) {
        e.jstree.plugin("cookies", {__init: function() {
                if (typeof e.cookie == "undefined")
                    throw "jsTree cookie: jQuery cookie plugin not included.";
                var t = this._get_settings().cookies, n;
                !t.save_loaded || (n = e.cookie(t.save_loaded), n && n.length && (this.data.core.to_load = n.split(","))), !t.save_opened || (n = e.cookie(t.save_opened), n && n.length && (this.data.core.to_open = n.split(","))), !t.save_selected || (n = e.cookie(t.save_selected), n && n.length && this.data.ui && (this.data.ui.to_select = n.split(","))), this.get_container().one((this.data.ui ? "reselect" : "reopen") + ".jstree", e.proxy(function() {
                    this.get_container().bind("open_node.jstree close_node.jstree select_node.jstree deselect_node.jstree", e.proxy(function(e) {
                        this._get_settings().cookies.auto_save && this.save_cookie((e.handleObj.namespace + e.handleObj.type).replace("jstree", ""))
                    }, this))
                }, this))
            },defaults: {save_loaded: "jstree_load",save_opened: "jstree_open",save_selected: "jstree_select",auto_save: !0,cookie_options: {}},_fn: {save_cookie: function(t) {
                    if (this.data.core.refreshing)
                        return;
                    var n = this._get_settings().cookies;
                    if (!t) {
                        n.save_loaded && (this.save_loaded(), e.cookie(n.save_loaded, this.data.core.to_load.join(","), n.cookie_options)), n.save_opened && (this.save_opened(), e.cookie(n.save_opened, this.data.core.to_open.join(","), n.cookie_options)), n.save_selected && this.data.ui && (this.save_selected(), e.cookie(n.save_selected, this.data.ui.to_select.join(","), n.cookie_options));
                        return
                    }
                    switch (t) {
                        case "open_node":
                        case "close_node":
                            !n.save_opened || (this.save_opened(), e.cookie(n.save_opened, this.data.core.to_open.join(","), n.cookie_options)), !n.save_loaded || (this.save_loaded(), e.cookie(n.save_loaded, this.data.core.to_load.join(","), n.cookie_options));
                            break;
                        case "select_node":
                        case "deselect_node":
                            !!n.save_selected && this.data.ui && (this.save_selected(), e.cookie(n.save_selected, this.data.ui.to_select.join(","), n.cookie_options))
                    }
                }}})
    }(jQuery), function(e) {
        e.jstree.plugin("sort", {__init: function() {
                this.get_container().bind("load_node.jstree", e.proxy(function(e, t) {
                    var n = this._get_node(t.rslt.obj);
                    n = n === -1 ? this.get_container().children("ul") : n.children("ul"), this.sort(n)
                }, this)).bind("rename_node.jstree create_node.jstree create.jstree", e.proxy(function(e, t) {
                    this.sort(t.rslt.obj.parent())
                }, this)).bind("move_node.jstree", e.proxy(function(e, t) {
                    var n = t.rslt.np == -1 ? this.get_container() : t.rslt.np;
                    this.sort(n.children("ul"))
                }, this))
            },defaults: function(e, t) {
                return this.get_text(e) > this.get_text(t) ? 1 : -1
            },_fn: {sort: function(t) {
                    var n = this._get_settings().sort, r = this;
                    t.append(e.makeArray(t.children("li")).sort(e.proxy(n, r))), t.find("> li > ul").each(function() {
                        r.sort(e(this))
                    }), this.clean_node(t)
                }}})
    }(jQuery), function(e) {
        var t = !1, n = !1, r = !1, i = !1, s = !1, o = !1, u = !1, a = !1, f = !1;
        e.vakata.dnd = {is_down: !1,is_drag: !1,helper: !1,scroll_spd: 10,init_x: 0,init_y: 0,threshold: 5,helper_left: 5,helper_top: 10,user_data: {},drag_start: function(t, n, r) {
                e.vakata.dnd.is_drag && e.vakata.drag_stop({});
                try {
                    t.currentTarget.unselectable = "on", t.currentTarget.onselectstart = function() {
                        return !1
                    }, t.currentTarget.style && (t.currentTarget.style.MozUserSelect = "none")
                } catch (i) {
                }
                return e.vakata.dnd.init_x = t.pageX, e.vakata.dnd.init_y = t.pageY, e.vakata.dnd.user_data = n, e.vakata.dnd.is_down = !0, e.vakata.dnd.helper = e("<div id='vakata-dragged' />").html(r), e(document).bind("mousemove", e.vakata.dnd.drag), e(document).bind("mouseup", e.vakata.dnd.drag_stop), !1
            },drag: function(t) {
                if (!e.vakata.dnd.is_down)
                    return;
                if (!e.vakata.dnd.is_drag) {
                    if (!(Math.abs(t.pageX - e.vakata.dnd.init_x) > 5 || Math.abs(t.pageY - e.vakata.dnd.init_y) > 5))
                        return;
                    e.vakata.dnd.helper.appendTo("body"), e.vakata.dnd.is_drag = !0, e(document).triggerHandler("drag_start.vakata", {event: t,data: e.vakata.dnd.user_data})
                }
                if (t.type === "mousemove") {
                    var n = e(document), r = n.scrollTop(), i = n.scrollLeft();
                    t.pageY - r < 20 ? (o && u === "down" && (clearInterval(o), o = !1), o || (u = "up", o = setInterval(function() {
                        e(document).scrollTop(e(document).scrollTop() - e.vakata.dnd.scroll_spd)
                    }, 150))) : o && u === "up" && (clearInterval(o), o = !1), e(window).height() - (t.pageY - r) < 20 ? (o && u === "up" && (clearInterval(o), o = !1), o || (u = "down", o = setInterval(function() {
                        e(document).scrollTop(e(document).scrollTop() + e.vakata.dnd.scroll_spd)
                    }, 150))) : o && u === "down" && (clearInterval(o), o = !1), t.pageX - i < 20 ? (s && a === "right" && (clearInterval(s), s = !1), s || (a = "left", s = setInterval(function() {
                        e(document).scrollLeft(e(document).scrollLeft() - e.vakata.dnd.scroll_spd)
                    }, 150))) : s && a === "left" && (clearInterval(s), s = !1), e(window).width() - (t.pageX - i) < 20 ? (s && a === "left" && (clearInterval(s), s = !1), s || (a = "right", s = setInterval(function() {
                        e(document).scrollLeft(e(document).scrollLeft() + e.vakata.dnd.scroll_spd)
                    }, 150))) : s && a === "right" && (clearInterval(s), s = !1)
                }
                e.vakata.dnd.helper.css({left: t.pageX + e.vakata.dnd.helper_left + "px",top: t.pageY + e.vakata.dnd.helper_top + "px"}), e(document).triggerHandler("drag.vakata", {event: t,data: e.vakata.dnd.user_data})
            },drag_stop: function(t) {
                s && clearInterval(s), o && clearInterval(o), e(document).unbind("mousemove", e.vakata.dnd.drag), e(document).unbind("mouseup", e.vakata.dnd.drag_stop), e(document).triggerHandler("drag_stop.vakata", {event: t,data: e.vakata.dnd.user_data}), e.vakata.dnd.helper.remove(), e.vakata.dnd.init_x = 0, e.vakata.dnd.init_y = 0, e.vakata.dnd.user_data = {}, e.vakata.dnd.is_down = !1, e.vakata.dnd.is_drag = !1
            }}, e(function() {
            var t = "#vakata-dragged { display:block; margin:0 0 0 0; padding:4px 4px 4px 24px; position:absolute; top:-2000px; line-height:16px; z-index:10000; } ";
            e.vakata.css.add_sheet({str: t,title: "vakata"})
        }), e.jstree.plugin("dnd", {__init: function() {
                this.data.dnd = {active: !1,after: !1,inside: !1,before: !1,off: !1,prepared: !1,w: 0,to1: !1,to2: !1,cof: !1,cw: !1,ch: !1,i1: !1,i2: !1,mto: !1}, this.get_container().bind("mouseenter.jstree", e.proxy(function(n) {
                    if (e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree) {
                        this.data.themes && (r.attr("class", "jstree-" + this.data.themes.theme), i && i.attr("class", "jstree-" + this.data.themes.theme), e.vakata.dnd.helper.attr("class", "jstree-dnd-helper jstree-" + this.data.themes.theme));
                        if (n.currentTarget === n.target && e.vakata.dnd.user_data.obj && e(e.vakata.dnd.user_data.obj).length && e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0] !== n.target) {
                            var s = e.jstree._reference(n.target), o;
                            s.data.dnd.foreign ? (o = s._get_settings().dnd.drag_check.call(this, {o: t,r: s.get_container(),is_root: !0}), (o === !0 || o.inside === !0 || o.before === !0 || o.after === !0) && e.vakata.dnd.helper.children("ins").attr("class", "jstree-ok")) : (s.prepare_move(t, s.get_container(), "last"), s.check_move() && e.vakata.dnd.helper.children("ins").attr("class", "jstree-ok"))
                        }
                    }
                }, this)).bind("mouseup.jstree", e.proxy(function(n) {
                    if (e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree && n.currentTarget === n.target && e.vakata.dnd.user_data.obj && e(e.vakata.dnd.user_data.obj).length && e(e.vakata.dnd.user_data.obj).parents(".jstree:eq(0)")[0] !== n.target) {
                        var r = e.jstree._reference(n.currentTarget), i;
                        r.data.dnd.foreign ? (i = r._get_settings().dnd.drag_check.call(this, {o: t,r: r.get_container(),is_root: !0}), (i === !0 || i.inside === !0 || i.before === !0 || i.after === !0) && r._get_settings().dnd.drag_finish.call(this, {o: t,r: r.get_container(),is_root: !0})) : r.move_node(t, r.get_container(), "last", n[r._get_settings().dnd.copy_modifier + "Key"])
                    }
                }, this)).bind("mouseleave.jstree", e.proxy(function(t) {
                    if (t.relatedTarget && t.relatedTarget.id && t.relatedTarget.id === "jstree-marker-line")
                        return !1;
                    e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree && (this.data.dnd.i1 && clearInterval(this.data.dnd.i1), this.data.dnd.i2 && clearInterval(this.data.dnd.i2), this.data.dnd.to1 && clearTimeout(this.data.dnd.to1), this.data.dnd.to2 && clearTimeout(this.data.dnd.to2), e.vakata.dnd.helper.children("ins").hasClass("jstree-ok") && e.vakata.dnd.helper.children("ins").attr("class", "jstree-invalid"))
                }, this)).bind("mousemove.jstree", e.proxy(function(t) {
                    if (e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree) {
                        var n = this.get_container()[0];
                        t.pageX + 24 > this.data.dnd.cof.left + this.data.dnd.cw ? (this.data.dnd.i1 && clearInterval(this.data.dnd.i1), this.data.dnd.i1 = setInterval(e.proxy(function() {
                            this.scrollLeft += e.vakata.dnd.scroll_spd
                        }, n), 100)) : t.pageX - 24 < this.data.dnd.cof.left ? (this.data.dnd.i1 && clearInterval(this.data.dnd.i1), this.data.dnd.i1 = setInterval(e.proxy(function() {
                            this.scrollLeft -= e.vakata.dnd.scroll_spd
                        }, n), 100)) : this.data.dnd.i1 && clearInterval(this.data.dnd.i1), t.pageY + 24 > this.data.dnd.cof.top + this.data.dnd.ch ? (this.data.dnd.i2 && clearInterval(this.data.dnd.i2), this.data.dnd.i2 = setInterval(e.proxy(function() {
                            this.scrollTop += e.vakata.dnd.scroll_spd
                        }, n), 100)) : t.pageY - 24 < this.data.dnd.cof.top ? (this.data.dnd.i2 && clearInterval(this.data.dnd.i2), this.data.dnd.i2 = setInterval(e.proxy(function() {
                            this.scrollTop -= e.vakata.dnd.scroll_spd
                        }, n), 100)) : this.data.dnd.i2 && clearInterval(this.data.dnd.i2)
                    }
                }, this)).bind("scroll.jstree", e.proxy(function(t) {
                    e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree && r && i && (r.hide(), i.hide())
                }, this)).delegate("a", "mousedown.jstree", e.proxy(function(e) {
                    if (e.which === 1)
                        return this.start_drag(e.currentTarget, e), !1
                }, this)).delegate("a", "mouseenter.jstree", e.proxy(function(t) {
                    e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree && this.dnd_enter(t.currentTarget)
                }, this)).delegate("a", "mousemove.jstree", e.proxy(function(t) {
                    e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree && ((!n || !n.length || n.children("a")[0] !== t.currentTarget) && this.dnd_enter(t.currentTarget), typeof this.data.dnd.off.top == "undefined" && (this.data.dnd.off = e(t.target).offset()), this.data.dnd.w = (t.pageY - (this.data.dnd.off.top || 0)) % this.data.core.li_height, this.data.dnd.w < 0 && (this.data.dnd.w += this.data.core.li_height), this.dnd_show())
                }, this)).delegate("a", "mouseleave.jstree", e.proxy(function(t) {
                    if (e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree) {
                        if (t.relatedTarget && t.relatedTarget.id && t.relatedTarget.id === "jstree-marker-line")
                            return !1;
                        r && r.hide(), i && i.hide(), this.data.dnd.mto = setTimeout(function(e) {
                            return function() {
                                e.dnd_leave(t)
                            }
                        }(this), 0)
                    }
                }, this)).delegate("a", "mouseup.jstree", e.proxy(function(t) {
                    e.vakata.dnd.is_drag && e.vakata.dnd.user_data.jstree && this.dnd_finish(t)
                }, this)), e(document).bind("drag_stop.vakata", e.proxy(function() {
                    this.data.dnd.to1 && clearTimeout(this.data.dnd.to1), this.data.dnd.to2 && clearTimeout(this.data.dnd.to2), this.data.dnd.i1 && clearInterval(this.data.dnd.i1), this.data.dnd.i2 && clearInterval(this.data.dnd.i2), this.data.dnd.after = !1, this.data.dnd.before = !1, this.data.dnd.inside = !1, this.data.dnd.off = !1, this.data.dnd.prepared = !1, this.data.dnd.w = !1, this.data.dnd.to1 = !1, this.data.dnd.to2 = !1, this.data.dnd.i1 = !1, this.data.dnd.i2 = !1, this.data.dnd.active = !1, this.data.dnd.foreign = !1, r && r.css({top: "-2000px"}), i && i.css({top: "-2000px"})
                }, this)).bind("drag_start.vakata", e.proxy(function(t, n) {
                    if (n.data.jstree) {
                        var r = e(n.event.target);
                        r.closest(".jstree").hasClass("jstree-" + this.get_index()) && this.dnd_enter(r)
                    }
                }, this));
                var s = this._get_settings().dnd;
                s.drag_target && e(document).delegate(s.drag_target, "mousedown.jstree-" + this.get_index(), e.proxy(function(n) {
                    t = n.target, e.vakata.dnd.drag_start(n, {jstree: !0,obj: n.target}, "<ins class='jstree-icon'></ins>" + e(n.target).text()), this.data.themes && (r && r.attr("class", "jstree-" + this.data.themes.theme), i && i.attr("class", "jstree-" + this.data.themes.theme), e.vakata.dnd.helper.attr("class", "jstree-dnd-helper jstree-" + this.data.themes.theme)), e.vakata.dnd.helper.children("ins").attr("class", "jstree-invalid");
                    var s = this.get_container();
                    this.data.dnd.cof = s.offset(), this.data.dnd.cw = parseInt(s.width(), 10), this.data.dnd.ch = parseInt(s.height(), 10), this.data.dnd.foreign = !0, n.preventDefault()
                }, this)), s.drop_target && e(document).delegate(s.drop_target, "mouseenter.jstree-" + this.get_index(), e.proxy(function(n) {
                    this.data.dnd.active && this._get_settings().dnd.drop_check.call(this, {o: t,r: e(n.target),e: n}) && e.vakata.dnd.helper.children("ins").attr("class", "jstree-ok")
                }, this)).delegate(s.drop_target, "mouseleave.jstree-" + this.get_index(), e.proxy(function(t) {
                    this.data.dnd.active && e.vakata.dnd.helper.children("ins").attr("class", "jstree-invalid")
                }, this)).delegate(s.drop_target, "mouseup.jstree-" + this.get_index(), e.proxy(function(n) {
                    this.data.dnd.active && e.vakata.dnd.helper.children("ins").hasClass("jstree-ok") && this._get_settings().dnd.drop_finish.call(this, {o: t,r: e(n.target),e: n})
                }, this))
            },defaults: {copy_modifier: "ctrl",check_timeout: 100,open_timeout: 500,drop_target: ".jstree-drop",drop_check: function(e) {
                    return !0
                },drop_finish: e.noop,drag_target: ".jstree-draggable",drag_finish: e.noop,drag_check: function(e) {
                    return {after: !1,before: !1,inside: !0}
                }},_fn: {dnd_prepare: function() {
                    if (!n || !n.length)
                        return;
                    this.data.dnd.off = n.offset(), this._get_settings().core.rtl && (this.data.dnd.off.right = this.data.dnd.off.left + n.width());
                    if (this.data.dnd.foreign) {
                        var e = this._get_settings().dnd.drag_check.call(this, {o: t,r: n});
                        return this.data.dnd.after = e.after, this.data.dnd.before = e.before, this.data.dnd.inside = e.inside, this.data.dnd.prepared = !0, this.dnd_show()
                    }
                    return this.prepare_move(t, n, "before"), this.data.dnd.before = this.check_move(), this.prepare_move(t, n, "after"), this.data.dnd.after = this.check_move(), this._is_loaded(n) ? (this.prepare_move(t, n, "inside"), this.data.dnd.inside = this.check_move()) : this.data.dnd.inside = !1, this.data.dnd.prepared = !0, this.dnd_show()
                },dnd_show: function() {
                    if (!this.data.dnd.prepared)
                        return;
                    var t = ["before", "inside", "after"], n = !1, s = this._get_settings().core.rtl, o;
                    this.data.dnd.w < this.data.core.li_height / 3 ? t = ["before", "inside", "after"] : this.data.dnd.w <= this.data.core.li_height * 2 / 3 ? t = this.data.dnd.w < this.data.core.li_height / 2 ? ["inside", "before", "after"] : ["inside", "after", "before"] : t = ["after", "inside", "before"], e.each(t, e.proxy(function(t, r) {
                        if (this.data.dnd[r])
                            return e.vakata.dnd.helper.children("ins").attr("class", "jstree-ok"), n = r, !1
                    }, this)), n === !1 && e.vakata.dnd.helper.children("ins").attr("class", "jstree-invalid"), o = s ? this.data.dnd.off.right - 18 : this.data.dnd.off.left + 10;
                    switch (n) {
                        case "before":
                            r.css({left: o + "px",top: this.data.dnd.off.top - 6 + "px"}).show(), i && i.css({left: o + 8 + "px",top: this.data.dnd.off.top - 1 + "px"}).show();
                            break;
                        case "after":
                            r.css({left: o + "px",top: this.data.dnd.off.top + this.data.core.li_height - 6 + "px"}).show(), i && i.css({left: o + 8 + "px",top: this.data.dnd.off.top + this.data.core.li_height - 1 + "px"}).show();
                            break;
                        case "inside":
                            r.css({left: o + (s ? -4 : 4) + "px",top: this.data.dnd.off.top + this.data.core.li_height / 2 - 5 + "px"}).show(), i && i.hide();
                            break;
                        default:
                            r.hide(), i && i.hide()
                    }
                    return f = n, n
                },dnd_open: function() {
                    this.data.dnd.to2 = !1, this.open_node(n, e.proxy(this.dnd_prepare, this), !0)
                },dnd_finish: function(e) {
                    this.data.dnd.foreign ? (this.data.dnd.after || this.data.dnd.before || this.data.dnd.inside) && this._get_settings().dnd.drag_finish.call(this, {o: t,r: n,p: f}) : (this.dnd_prepare(), this.move_node(t, n, f, e[this._get_settings().dnd.copy_modifier + "Key"])), t = !1, n = !1, r.hide(), i && i.hide()
                },dnd_enter: function(t) {
                    this.data.dnd.mto && (clearTimeout(this.data.dnd.mto), this.data.dnd.mto = !1);
                    var r = this._get_settings().dnd;
                    this.data.dnd.prepared = !1, n = this._get_node(t), r.check_timeout ? (this.data.dnd.to1 && clearTimeout(this.data.dnd.to1), this.data.dnd.to1 = setTimeout(e.proxy(this.dnd_prepare, this), r.check_timeout)) : this.dnd_prepare(), r.open_timeout ? (this.data.dnd.to2 && clearTimeout(this.data.dnd.to2), n && n.length && n.hasClass("jstree-closed") && (this.data.dnd.to2 = setTimeout(e.proxy(this.dnd_open, this), r.open_timeout))) : n && n.length && n.hasClass("jstree-closed") && this.dnd_open()
                },dnd_leave: function(t) {
                    this.data.dnd.after = !1, this.data.dnd.before = !1, this.data.dnd.inside = !1, e.vakata.dnd.helper.children("ins").attr("class", "jstree-invalid"), r.hide(), i && i.hide(), n && n[0] === t.target.parentNode && (this.data.dnd.to1 && (clearTimeout(this.data.dnd.to1), this.data.dnd.to1 = !1), this.data.dnd.to2 && (clearTimeout(this.data.dnd.to2), this.data.dnd.to2 = !1))
                },start_drag: function(n, s) {
                    t = this._get_node(n), this.data.ui && this.is_selected(t) && (t = this._get_node(null, !0));
                    var o = t.length > 1 ? this._get_string("multiple_selection") : this.get_text(t), u = this.get_container();
                    this._get_settings().core.html_titles || (o = o.replace(/</ig, "&lt;").replace(/>/ig, "&gt;")), e.vakata.dnd.drag_start(s, {jstree: !0,obj: t}, "<ins class='jstree-icon'></ins>" + o), this.data.themes && (r && r.attr("class", "jstree-" + this.data.themes.theme), i && i.attr("class", "jstree-" + this.data.themes.theme), e.vakata.dnd.helper.attr("class", "jstree-dnd-helper jstree-" + this.data.themes.theme)), this.data.dnd.cof = u.offset(), this.data.dnd.cw = parseInt(u.width(), 10), this.data.dnd.ch = parseInt(u.height(), 10), this.data.dnd.active = !0
                }}}), e(function() {
            var t = "#vakata-dragged ins { display:block; text-decoration:none; width:16px; height:16px; margin:0 0 0 0; padding:0; position:absolute; top:4px; left:4px;  -moz-border-radius:4px; border-radius:4px; -webkit-border-radius:4px; } #vakata-dragged .jstree-ok { background:green; } #vakata-dragged .jstree-invalid { background:red; } #jstree-marker { padding:0; margin:0; font-size:12px; overflow:hidden; height:12px; width:8px; position:absolute; top:-30px; z-index:10001; background-repeat:no-repeat; display:none; background-color:transparent; text-shadow:1px 1px 1px white; color:black; line-height:10px; } #jstree-marker-line { padding:0; margin:0; line-height:0%; font-size:1px; overflow:hidden; height:1px; width:100px; position:absolute; top:-30px; z-index:10000; background-repeat:no-repeat; display:none; background-color:#456c43;  cursor:pointer; border:1px solid #eeeeee; border-left:0; -moz-box-shadow: 0px 0px 2px #666; -webkit-box-shadow: 0px 0px 2px #666; box-shadow: 0px 0px 2px #666;  -moz-border-radius:1px; border-radius:1px; -webkit-border-radius:1px; }";
            e.vakata.css.add_sheet({str: t,title: "jstree"}), r = e("<div />").attr({id: "jstree-marker"}).hide().html("&raquo;").bind("mouseleave mouseenter", function(e) {
                return r.hide(), i.hide(), e.preventDefault(), e.stopImmediatePropagation(), !1
            }).appendTo("body"), i = e("<div />").attr({id: "jstree-marker-line"}).hide().bind("mouseup", function(e) {
                if (n && n.length)
                    return n.children("a").trigger(e), e.preventDefault(), e.stopImmediatePropagation(), !1
            }).bind("mouseleave", function(t) {
                var s = e(t.relatedTarget);
                if (s.is(".jstree") || s.closest(".jstree").length === 0)
                    if (n && n.length)
                        return n.children("a").trigger(t), r.hide(), i.hide(), t.preventDefault(), t.stopImmediatePropagation(), !1
            }).appendTo("body"), e(document).bind("drag_start.vakata", function(e, t) {
                t.data.jstree && (r.show(), i && i.show())
            }), e(document).bind("drag_stop.vakata", function(e, t) {
                t.data.jstree && (r.hide(), i && i.hide())
            })
        })
    }(jQuery), function(e) {
        e.jstree.plugin("checkbox", {__init: function() {
                this.data.checkbox.noui = this._get_settings().checkbox.override_ui, this.data.ui && this.data.checkbox.noui && (this.select_node = this.deselect_node = this.deselect_all = e.noop, this.get_selected = this.get_checked), this.get_container().bind("open_node.jstree create_node.jstree clean_node.jstree refresh.jstree", e.proxy(function(e, t) {
                    this._prepare_checkboxes(t.rslt.obj)
                }, this)).bind("loaded.jstree", e.proxy(function(e) {
                    this._prepare_checkboxes()
                }, this)).delegate(this.data.ui && this.data.checkbox.noui ? "a" : "ins.jstree-checkbox", "click.jstree", e.proxy(function(e) {
                    e.preventDefault(), this._get_node(e.target).hasClass("jstree-checked") ? this.uncheck_node(e.target) : this.check_node(e.target);
                    if (!this.data.ui || !this.data.checkbox.noui)
                        return e.stopImmediatePropagation(), !1;
                    this.save_selected(), this.data.cookies && this.save_cookie("select_node")
                }, this))
            },defaults: {override_ui: !1,two_state: !1,real_checkboxes: !1,checked_parent_open: !0,real_checkboxes_names: function(e) {
                    return ["check_" + (e[0].id || Math.ceil(Math.random() * 1e4)), 1]
                }},__destroy: function() {
                this.get_container().find("input.jstree-real-checkbox").removeClass("jstree-real-checkbox").end().find("ins.jstree-checkbox").remove()
            },_fn: {_checkbox_notify: function(e, t) {
                    t.checked && this.check_node(e, !1)
                },_prepare_checkboxes: function(t) {
                    t = !t || t == -1 ? this.get_container().find("> ul > li") : this._get_node(t);
                    if (t === !1)
                        return;
                    var n, r = this, i, s = this._get_settings().checkbox.two_state, o = this._get_settings().checkbox.real_checkboxes, u = this._get_settings().checkbox.real_checkboxes_names;
                    t.each(function() {
                        i = e(this), n = i.is("li") && (i.hasClass("jstree-checked") || o && i.children(":checked").length) ? "jstree-checked" : "jstree-unchecked", i.find("li").andSelf().each(function() {
                            var t = e(this), i;
                            t.children("a" + (r.data.languages ? "" : ":eq(0)")).not(":has(.jstree-checkbox)").prepend("<ins class='jstree-checkbox'>&#160;</ins>").parent().not(".jstree-checked, .jstree-unchecked").addClass(s ? "jstree-unchecked" : n), o && (t.children(":checkbox").length ? t.children(":checkbox").addClass("jstree-real-checkbox") : (i = u.call(r, t), t.prepend("<input type='checkbox' class='jstree-real-checkbox' id='" + i[0] + "' name='" + i[0] + "' value='" + i[1] + "' />"))), s ? (t.hasClass("jstree-checked") || t.children(":checked").length) && t.addClass("jstree-checked").children(":checkbox").prop("checked", !0) : (n === "jstree-checked" || t.hasClass("jstree-checked") || t.children(":checked").length) && t.find("li").andSelf().addClass("jstree-checked").children(":checkbox").prop("checked", !0)
                        })
                    }), s || t.find(".jstree-checked").parent().parent().each(function() {
                        r._repair_state(this)
                    })
                },change_state: function(t, n) {
                    t = this._get_node(t);
                    var r = !1, i = this._get_settings().checkbox.real_checkboxes;
                    if (!t || t === -1)
                        return !1;
                    n = n === !1 || n === !0 ? n : t.hasClass("jstree-checked");
                    if (this._get_settings().checkbox.two_state)
                        n ? (t.removeClass("jstree-checked").addClass("jstree-unchecked"), i && t.children(":checkbox").prop("checked", !1)) : (t.removeClass("jstree-unchecked").addClass("jstree-checked"), i && t.children(":checkbox").prop("checked", !0));
                    else {
                        if (n) {
                            r = t.find("li").andSelf();
                            if (!r.filter(".jstree-checked, .jstree-undetermined").length)
                                return !1;
                            r.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"), i && r.children(":checkbox").prop("checked", !1)
                        } else {
                            r = t.find("li").andSelf();
                            if (!r.filter(".jstree-unchecked, .jstree-undetermined").length)
                                return !1;
                            r.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"), i && r.children(":checkbox").prop("checked", !0), this.data.ui && (this.data.ui.last_selected = t), this.data.checkbox.last_selected = t
                        }
                        t.parentsUntil(".jstree", "li").each(function() {
                            var t = e(this);
                            if (n) {
                                if (t.children("ul").children("li.jstree-checked, li.jstree-undetermined").length)
                                    return t.parentsUntil(".jstree", "li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"), i && t.parentsUntil(".jstree", "li").andSelf().children(":checkbox").prop("checked", !1), !1;
                                t.removeClass("jstree-checked jstree-undetermined").addClass("jstree-unchecked"), i && t.children(":checkbox").prop("checked", !1)
                            } else {
                                if (t.children("ul").children("li.jstree-unchecked, li.jstree-undetermined").length)
                                    return t.parentsUntil(".jstree", "li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"), i && t.parentsUntil(".jstree", "li").andSelf().children(":checkbox").prop("checked", !1), !1;
                                t.removeClass("jstree-unchecked jstree-undetermined").addClass("jstree-checked"), i && t.children(":checkbox").prop("checked", !0)
                            }
                        })
                    }
                    return this.data.ui && this.data.checkbox.noui && (this.data.ui.selected = this.get_checked()), this.__callback(t), !0
                },check_node: function(e) {
                    if (this.change_state(e, !1)) {
                        e = this._get_node(e);
                        if (this._get_settings().checkbox.checked_parent_open) {
                            var t = this;
                            e.parents(".jstree-closed").each(function() {
                                t.open_node(this, !1, !0)
                            })
                        }
                        this.__callback({obj: e})
                    }
                },uncheck_node: function(e) {
                    this.change_state(e, !0) && this.__callback({obj: this._get_node(e)})
                },check_all: function() {
                    var e = this, t = this._get_settings().checkbox.two_state ? this.get_container_ul().find("li") : this.get_container_ul().children("li");
                    t.each(function() {
                        e.change_state(this, !1)
                    }), this.__callback()
                },uncheck_all: function() {
                    var e = this, t = this._get_settings().checkbox.two_state ? this.get_container_ul().find("li") : this.get_container_ul().children("li");
                    t.each(function() {
                        e.change_state(this, !0)
                    }), this.__callback()
                },is_checked: function(e) {
                    return e = this._get_node(e), e.length ? e.is(".jstree-checked") : !1
                },get_checked: function(e, t) {
                    return e = !e || e === -1 ? this.get_container() : this._get_node(e), t || this._get_settings().checkbox.two_state ? e.find(".jstree-checked") : e.find("> ul > .jstree-checked, .jstree-undetermined > ul > .jstree-checked")
                },get_unchecked: function(e, t) {
                    return e = !e || e === -1 ? this.get_container() : this._get_node(e), t || this._get_settings().checkbox.two_state ? e.find(".jstree-unchecked") : e.find("> ul > .jstree-unchecked, .jstree-undetermined > ul > .jstree-unchecked")
                },show_checkboxes: function() {
                    this.get_container().children("ul").removeClass("jstree-no-checkboxes")
                },hide_checkboxes: function() {
                    this.get_container().children("ul").addClass("jstree-no-checkboxes")
                },_repair_state: function(e) {
                    e = this._get_node(e);
                    if (!e.length)
                        return;
                    if (this._get_settings().checkbox.two_state) {
                        e.find("li").andSelf().not(".jstree-checked").removeClass("jstree-undetermined").addClass("jstree-unchecked").children(":checkbox").prop("checked", !0);
                        return
                    }
                    var t = this._get_settings().checkbox.real_checkboxes, n = e.find("> ul > .jstree-checked").length, r = e.find("> ul > .jstree-undetermined").length, i = e.find("> ul > li").length;
                    i === 0 ? e.hasClass("jstree-undetermined") && this.change_state(e, !1) : n === 0 && r === 0 ? this.change_state(e, !0) : n === i ? this.change_state(e, !1) : (e.parentsUntil(".jstree", "li").andSelf().removeClass("jstree-checked jstree-unchecked").addClass("jstree-undetermined"), t && e.parentsUntil(".jstree", "li").andSelf().children(":checkbox").prop("checked", !1))
                },reselect: function() {
                    if (this.data.ui && this.data.checkbox.noui) {
                        var t = this, n = this.data.ui.to_select;
                        n = e.map(e.makeArray(n), function(e) {
                            return "#" + e.toString().replace(/^#/, "").replace(/\\\//g, "/").replace(/\//g, "\\/").replace(/\\\./g, ".").replace(/\./g, "\\.").replace(/\:/g, "\\:")
                        }), this.deselect_all(), e.each(n, function(e, n) {
                            t.check_node(n)
                        }), this.__callback()
                    } else
                        this.__call_old()
                },save_loaded: function() {
                    var e = this;
                    this.data.core.to_load = [], this.get_container_ul().find("li.jstree-closed.jstree-undetermined").each(function() {
                        this.id && e.data.core.to_load.push("#" + this.id)
                    })
                }}}), e(function() {
            var t = ".jstree .jstree-real-checkbox { display:none; } ";
            e.vakata.css.add_sheet({str: t,title: "jstree"})
        })
    }(jQuery), function(e) {
        e.vakata.xslt = function(t, n, r) {
            var i = "", s, o, u, a;
            return document.recalc ? (s = document.createElement("xml"), o = document.createElement("xml"), s.innerHTML = t, o.innerHTML = n, e("body").append(s).append(o), setTimeout(function(t, n, r) {
                return function() {
                    r.call(null, t.transformNode(n.XMLDocument)), setTimeout(function(t, n) {
                        return function() {
                            e(t).remove(), e(n).remove()
                        }
                    }(t, n), 200)
                }
            }(s, o, r), 100), !0) : (typeof window.DOMParser != "undefined" && typeof window.XMLHttpRequest != "undefined" && typeof window.XSLTProcessor == "undefined" && (t = (new DOMParser).parseFromString(t, "text/xml"), n = (new DOMParser).parseFromString(n, "text/xml")), typeof window.DOMParser != "undefined" && typeof window.XMLHttpRequest != "undefined" && typeof window.XSLTProcessor != "undefined" ? (u = new XSLTProcessor, a = e.isFunction(u.transformDocument) ? typeof window.XMLSerializer != "undefined" : !0, a ? (t = (new DOMParser).parseFromString(t, "text/xml"), n = (new DOMParser).parseFromString(n, "text/xml"), e.isFunction(u.transformDocument) ? (i = document.implementation.createDocument("", "", null), u.transformDocument(t, n, i, null), r.call(null, (new XMLSerializer).serializeToString(i)), !0) : (u.importStylesheet(n), i = u.transformToFragment(t, document), r.call(null, e("<div />").append(i).html()), !0)) : !1) : !1)
        };
        var t = {nest: '<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/html" /><xsl:template match="/">	<xsl:call-template name="nodes">		<xsl:with-param name="node" select="/root" />	</xsl:call-template></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<ul>	<xsl:for-each select="$node/item">		<xsl:variable name="children" select="count(./item) &gt; 0" />		<li>			<xsl:attribute name="class">				<xsl:if test="position() = last()">jstree-last </xsl:if>				<xsl:choose>					<xsl:when test="@state = \'open\'">jstree-open </xsl:when>					<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>					<xsl:otherwise>jstree-leaf </xsl:otherwise>				</xsl:choose>				<xsl:value-of select="@class" />			</xsl:attribute>			<xsl:for-each select="@*">				<xsl:if test="name() != \'class\' and name() != \'state\' and name() != \'hasChildren\'">					<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>				</xsl:if>			</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>			<xsl:for-each select="content/name">				<a>				<xsl:attribute name="href">					<xsl:choose>					<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>					<xsl:otherwise>#</xsl:otherwise>					</xsl:choose>				</xsl:attribute>				<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>				<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>				<xsl:for-each select="@*">					<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">						<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>					</xsl:if>				</xsl:for-each>					<ins>						<xsl:attribute name="class">jstree-icon 							<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>						</xsl:attribute>						<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>						<xsl:text>&#xa0;</xsl:text>					</ins>					<xsl:copy-of select="./child::node()" />				</a>			</xsl:for-each>			<xsl:if test="$children or @hasChildren"><xsl:call-template name="nodes"><xsl:with-param name="node" select="current()" /></xsl:call-template></xsl:if>		</li>	</xsl:for-each>	</ul></xsl:template></xsl:stylesheet>',flat: '<?xml version="1.0" encoding="utf-8" ?><xsl:stylesheet version="1.0" xmlns:xsl="http://www.w3.org/1999/XSL/Transform" ><xsl:output method="html" encoding="utf-8" omit-xml-declaration="yes" standalone="no" indent="no" media-type="text/xml" /><xsl:template match="/">	<ul>	<xsl:for-each select="//item[not(@parent_id) or @parent_id=0 or not(@parent_id = //item/@id)]">		<xsl:call-template name="nodes">			<xsl:with-param name="node" select="." />			<xsl:with-param name="is_last" select="number(position() = last())" />		</xsl:call-template>	</xsl:for-each>	</ul></xsl:template><xsl:template name="nodes">	<xsl:param name="node" />	<xsl:param name="is_last" />	<xsl:variable name="children" select="count(//item[@parent_id=$node/attribute::id]) &gt; 0" />	<li>	<xsl:attribute name="class">		<xsl:if test="$is_last = true()">jstree-last </xsl:if>		<xsl:choose>			<xsl:when test="@state = \'open\'">jstree-open </xsl:when>			<xsl:when test="$children or @hasChildren or @state = \'closed\'">jstree-closed </xsl:when>			<xsl:otherwise>jstree-leaf </xsl:otherwise>		</xsl:choose>		<xsl:value-of select="@class" />	</xsl:attribute>	<xsl:for-each select="@*">		<xsl:if test="name() != \'parent_id\' and name() != \'hasChildren\' and name() != \'class\' and name() != \'state\'">		<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>		</xsl:if>	</xsl:for-each>	<ins class="jstree-icon"><xsl:text>&#xa0;</xsl:text></ins>	<xsl:for-each select="content/name">		<a>		<xsl:attribute name="href">			<xsl:choose>			<xsl:when test="@href"><xsl:value-of select="@href" /></xsl:when>			<xsl:otherwise>#</xsl:otherwise>			</xsl:choose>		</xsl:attribute>		<xsl:attribute name="class"><xsl:value-of select="@lang" /> <xsl:value-of select="@class" /></xsl:attribute>		<xsl:attribute name="style"><xsl:value-of select="@style" /></xsl:attribute>		<xsl:for-each select="@*">			<xsl:if test="name() != \'style\' and name() != \'class\' and name() != \'href\'">				<xsl:attribute name="{name()}"><xsl:value-of select="." /></xsl:attribute>			</xsl:if>		</xsl:for-each>			<ins>				<xsl:attribute name="class">jstree-icon 					<xsl:if test="string-length(attribute::icon) > 0 and not(contains(@icon,\'/\'))"><xsl:value-of select="@icon" /></xsl:if>				</xsl:attribute>				<xsl:if test="string-length(attribute::icon) > 0 and contains(@icon,\'/\')"><xsl:attribute name="style">background:url(<xsl:value-of select="@icon" />) center center no-repeat;</xsl:attribute></xsl:if>				<xsl:text>&#xa0;</xsl:text>			</ins>			<xsl:copy-of select="./child::node()" />		</a>	</xsl:for-each>	<xsl:if test="$children">		<ul>		<xsl:for-each select="//item[@parent_id=$node/attribute::id]">			<xsl:call-template name="nodes">				<xsl:with-param name="node" select="." />				<xsl:with-param name="is_last" select="number(position() = last())" />			</xsl:call-template>		</xsl:for-each>		</ul>	</xsl:if>	</li></xsl:template></xsl:stylesheet>'}, n = function(e) {
            return e.toString().replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;").replace(/"/g, "&quot;").replace(/'/g, "&apos;")
        };
        e.jstree.plugin("xml_data", {defaults: {data: !1,ajax: !1,xsl: "flat",clean_node: !1,correct_state: !0,get_skip_empty: !1,get_include_preamble: !0},_fn: {load_node: function(e, t, n) {
                    var r = this;
                    this.load_node_xml(e, function() {
                        r.__callback({obj: r._get_node(e)}), t.call(this)
                    }, n)
                },_is_loaded: function(t) {
                    var n = this._get_settings().xml_data;
                    return t = this._get_node(t), t == -1 || !t || !n.ajax && !e.isFunction(n.data) || t.is(".jstree-open, .jstree-leaf") || t.children("ul").children("li").size() > 0
                },load_node_xml: function(t, n, r) {
                    var i = this.get_settings().xml_data, s = function() {
                    }, o = function() {
                    };
                    t = this._get_node(t);
                    if (t && t !== -1) {
                        if (t.data("jstree_is_loading"))
                            return;
                        t.data("jstree_is_loading", !0)
                    }
                    switch (!0) {
                        case !i.data && !i.ajax:
                            throw "Neither data nor ajax settings supplied.";
                        case e.isFunction(i.data):
                            i.data.call(this, t, e.proxy(function(r) {
                                this.parse_xml(r, e.proxy(function(r) {
                                    r && (r = r.replace(/ ?xmlns="[^"]*"/ig, ""), r.length > 10 ? (r = e(r), t === -1 || !t ? this.get_container().children("ul").empty().append(r.children()) : (t.children("a.jstree-loading").removeClass("jstree-loading"), t.append(r), t.removeData("jstree_is_loading")), i.clean_node && this.clean_node(t), n && n.call(this)) : t && t !== -1 ? (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), i.correct_state && (this.correct_state(t), n && n.call(this))) : i.correct_state && (this.get_container().children("ul").empty(), n && n.call(this)))
                                }, this))
                            }, this));
                            break;
                        case !!i.data && !i.ajax || !!i.data && !!i.ajax && (!t || t === -1):
                            (!t || t == -1) && this.parse_xml(i.data, e.proxy(function(r) {
                                r ? (r = r.replace(/ ?xmlns="[^"]*"/ig, ""), r.length > 10 && (r = e(r), this.get_container().children("ul").empty().append(r.children()), i.clean_node && this.clean_node(t), n && n.call(this))) : i.correct_state && (this.get_container().children("ul").empty(), n && n.call(this))
                            }, this));
                            break;
                        case !i.data && !!i.ajax || !!i.data && !!i.ajax && t && t !== -1:
                            s = function(e, n, s) {
                                var o = this.get_settings().xml_data.ajax.error;
                                o && o.call(this, e, n, s), t !== -1 && t.length ? (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), n === "success" && i.correct_state && this.correct_state(t)) : n === "success" && i.correct_state && this.get_container().children("ul").empty(), r && r.call(this)
                            }, o = function(r, o, u) {
                                r = u.responseText;
                                var a = this.get_settings().xml_data.ajax.success;
                                a && (r = a.call(this, r, o, u) || r);
                                if (r === "" || r && r.toString && r.toString().replace(/^[\s\n]+$/, "") === "")
                                    return s.call(this, u, o, "");
                                this.parse_xml(r, e.proxy(function(r) {
                                    r && (r = r.replace(/ ?xmlns="[^"]*"/ig, ""), r.length > 10 ? (r = e(r), t === -1 || !t ? this.get_container().children("ul").empty().append(r.children()) : (t.children("a.jstree-loading").removeClass("jstree-loading"), t.append(r), t.removeData("jstree_is_loading")), i.clean_node && this.clean_node(t), n && n.call(this)) : t && t !== -1 ? (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), i.correct_state && (this.correct_state(t), n && n.call(this))) : i.correct_state && (this.get_container().children("ul").empty(), n && n.call(this)))
                                }, this))
                            }, i.ajax.context = this, i.ajax.error = s, i.ajax.success = o, i.ajax.dataType || (i.ajax.dataType = "xml"), e.isFunction(i.ajax.url) && (i.ajax.url = i.ajax.url.call(this, t)), e.isFunction(i.ajax.data) && (i.ajax.data = i.ajax.data.call(this, t)), e.ajax(i.ajax)
                    }
                },parse_xml: function(n, r) {
                    var i = this._get_settings().xml_data;
                    e.vakata.xslt(n, t[i.xsl], r)
                },get_xml: function(t, r, i, s, o) {
                    var u = "", a = this._get_settings(), f = this, l, c, h, p, d;
                    t || (t = "flat"), o || (o = 0), r = this._get_node(r);
                    if (!r || r === -1)
                        r = this.get_container().find("> ul > li");
                    return i = e.isArray(i) ? i : ["id", "class"], !o && this.data.types && e.inArray(a.types.type_attr, i) === -1 && i.push(a.types.type_attr), s = e.isArray(s) ? s : [], o || (a.xml_data.get_include_preamble && (u += '<?xml version="1.0" encoding="UTF-8"?>'), u += "<root>"), r.each(function() {
                        u += "<item", h = e(this), e.each(i, function(e, t) {
                            var r = h.attr(t);
                            if (!a.xml_data.get_skip_empty || typeof r != "undefined")
                                u += " " + t + '="' + n((" " + (r || "")).replace(/ jstree[^ ]*/ig, "").replace(/\s+$/ig, " ").replace(/^ /, "").replace(/ $/, "")) + '"'
                        }), h.hasClass("jstree-open") && (u += ' state="open"'), h.hasClass("jstree-closed") && (u += ' state="closed"'), t === "flat" && (u += ' parent_id="' + n(o) + '"'), u += ">", u += "<content>", p = h.children("a"), p.each(function() {
                            l = e(this), d = !1, u += "<name", e.inArray("languages", a.plugins) !== -1 && e.each(a.languages, function(e, t) {
                                if (l.hasClass(t))
                                    return u += ' lang="' + n(t) + '"', d = t, !1
                            }), s.length && e.each(s, function(e, t) {
                                var r = l.attr(t);
                                if (!a.xml_data.get_skip_empty || typeof r != "undefined")
                                    u += " " + t + '="' + n((" " + r || "").replace(/ jstree[^ ]*/ig, "").replace(/\s+$/ig, " ").replace(/^ /, "").replace(/ $/, "")) + '"'
                            }), l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig, "").replace(/^\s+$/ig, "").length && (u += ' icon="' + n(l.children("ins").get(0).className.replace(/jstree[^ ]*|$/ig, "").replace(/\s+$/ig, " ").replace(/^ /, "").replace(/ $/, "")) + '"'), l.children("ins").get(0).style.backgroundImage.length && (u += ' icon="' + n(l.children("ins").get(0).style.backgroundImage.replace("url(", "").replace(")", "").replace(/'/ig, "").replace(/"/ig, "")) + '"'), u += ">", u += "<![CDATA[" + f.get_text(l, d) + "]]>", u += "</name>"
                        }), u += "</content>", c = h[0].id || !0, h = h.find("> ul > li"), h.length ? c = f.get_xml(t, h, i, s, c) : c = "", t == "nest" && (u += c), u += "</item>", t == "flat" && (u += c)
                    }), o || (u += "</root>"), u
                }}})
    }(jQuery), function(e) {
        e.expr[":"].jstree_contains = function(e, t, n) {
            return (e.textContent || e.innerText || "").toLowerCase().indexOf(n[3].toLowerCase()) >= 0
        }, e.expr[":"].jstree_title_contains = function(e, t, n) {
            return (e.getAttribute("title") || "").toLowerCase().indexOf(n[3].toLowerCase()) >= 0
        }, e.jstree.plugin("search", {__init: function() {
                this.data.search.str = "", this.data.search.result = e(), this._get_settings().search.show_only_matches && this.get_container().bind("search.jstree", function(t, n) {
                    e(this).children("ul").find("li").hide().removeClass("jstree-last"), n.rslt.nodes.parentsUntil(".jstree").andSelf().show().filter("ul").each(function() {
                        e(this).children("li:visible").eq(-1).addClass("jstree-last")
                    })
                }).bind("clear_search.jstree", function() {
                    e(this).children("ul").find("li").css("display", "").end().end().jstree("clean_node", -1)
                })
            },defaults: {ajax: !1,search_method: "jstree_contains",show_only_matches: !1},_fn: {search: function(t, n) {
                    if (e.trim(t) === "") {
                        this.clear_search();
                        return
                    }
                    var r = this.get_settings().search, i = this, s = function() {
                    }, o = function() {
                    };
                    this.data.search.str = t;
                    if (!n && r.ajax !== !1 && this.get_container_ul().find("li.jstree-closed:not(:has(ul)):eq(0)").length > 0) {
                        this.search.supress_callback = !0, s = function() {
                        }, o = function(e, t, n) {
                            var r = this.get_settings().search.ajax.success;
                            r && (e = r.call(this, e, t, n) || e), this.data.search.to_open = e, this._search_open()
                        }, r.ajax.context = this, r.ajax.error = s, r.ajax.success = o, e.isFunction(r.ajax.url) && (r.ajax.url = r.ajax.url.call(this, t)), e.isFunction(r.ajax.data) && (r.ajax.data = r.ajax.data.call(this, t)), r.ajax.data || (r.ajax.data = {search_string: t});
                        if (!r.ajax.dataType || /^json/.exec(r.ajax.dataType))
                            r.ajax.dataType = "json";
                        e.ajax(r.ajax);
                        return
                    }
                    this.data.search.result.length && this.clear_search(), this.data.search.result = this.get_container().find("a" + (this.data.languages ? "." + this.get_lang() : "") + ":" + r.search_method + "(" + this.data.search.str + ")"), this.data.search.result.addClass("jstree-search").parent().parents(".jstree-closed").each(function() {
                        i.open_node(this, !1, !0)
                    }), this.__callback({nodes: this.data.search.result,str: t})
                },clear_search: function(t) {
                    this.data.search.result.removeClass("jstree-search"), this.__callback(this.data.search.result), this.data.search.result = e()
                },_search_open: function(t) {
                    var n = this, r = !0, i = [], s = [];
                    this.data.search.to_open.length && (e.each(this.data.search.to_open, function(t, n) {
                        if (n == "#")
                            return !0;
                        e(n).length && e(n).is(".jstree-closed") ? i.push(n) : s.push(n)
                    }), i.length && (this.data.search.to_open = s, e.each(i, function(e, t) {
                        n.open_node(t, function() {
                            n._search_open(!0)
                        })
                    }), r = !1)), r && this.search(this.data.search.str, !0)
                }}})
    }(jQuery), function(e) {
        e.vakata.context = {hide_on_mouseleave: !1,cnt: e("<div id='vakata-contextmenu' />"),vis: !1,tgt: !1,par: !1,func: !1,data: !1,rtl: !1,show: function(t, n, r, i, s, o, u) {
                e.vakata.context.rtl = !!u;
                var a = e.vakata.context.parse(t), f, l;
                if (!a)
                    return;
                e.vakata.context.vis = !0, e.vakata.context.tgt = n, e.vakata.context.par = o || n || null, e.vakata.context.data = s || null, e.vakata.context.cnt.html(a).css({visibility: "hidden",display: "block",left: 0,top: 0}), e.vakata.context.hide_on_mouseleave && e.vakata.context.cnt.one("mouseleave", function(t) {
                    e.vakata.context.hide()
                }), f = e.vakata.context.cnt.height(), l = e.vakata.context.cnt.width(), r + l > e(document).width() && (r = e(document).width() - (l + 5), e.vakata.context.cnt.find("li > ul").addClass("right")), i + f > e(document).height() && (i -= f + n[0].offsetHeight, e.vakata.context.cnt.find("li > ul").addClass("bottom")), e.vakata.context.cnt.css({left: r,top: i}).find("li:has(ul)").bind("mouseenter", function(t) {
                    var n = e(document).width(), r = e(document).height(), i = e(this).children("ul").show();
                    n !== e(document).width() && i.toggleClass("right"), r !== e(document).height() && i.toggleClass("bottom")
                }).bind("mouseleave", function(t) {
                    e(this).children("ul").hide()
                }).end().css({visibility: "visible"}).show(), e(document).triggerHandler("context_show.vakata")
            },hide: function() {
                e.vakata.context.vis = !1, e.vakata.context.cnt.attr("class", "").css({visibility: "hidden"}), e(document).triggerHandler("context_hide.vakata")
            },parse: function(t, n) {
                if (!t)
                    return !1;
                var r = "", i = !1, s = !0;
                return n || (e.vakata.context.func = {}), r += "<ul>", e.each(t, function(t, n) {
                    if (!n)
                        return !0;
                    e.vakata.context.func[t] = n.action, !s && n.separator_before && (r += "<li class='vakata-separator vakata-separator-before'></li>"), s = !1, r += "<li class='" + (n._class || "") + (n._disabled ? " jstree-contextmenu-disabled " : "") + "'><ins ", n.icon && n.icon.indexOf("/") === -1 && (r += " class='" + n.icon + "' "), n.icon && n.icon.indexOf("/") !== -1 && (r += " style='background:url(" + n.icon + ") center center no-repeat;' "), r += ">&#160;</ins><a href='#' rel='" + t + "'>", n.submenu && (r += "<span style='float:" + (e.vakata.context.rtl ? "left" : "right") + ";'>&raquo;</span>"), r += n.label + "</a>", n.submenu && (i = e.vakata.context.parse(n.submenu, !0), i && (r += i)), r += "</li>", n.separator_after && (r += "<li class='vakata-separator vakata-separator-after'></li>", s = !0)
                }), r = r.replace(/<li class\='vakata-separator vakata-separator-after'\><\/li\>$/, ""), r += "</ul>", e(document).triggerHandler("context_parse.vakata"), r.length > 10 ? r : !1
            },exec: function(t) {
                return e.isFunction(e.vakata.context.func[t]) ? (e.vakata.context.func[t].call(e.vakata.context.data, e.vakata.context.par), !0) : !1
            }}, e(function() {
            var t = "#vakata-contextmenu { display:block; visibility:hidden; left:0; top:-200px; position:absolute; margin:0; padding:0; min-width:180px; background:#ebebeb; border:1px solid silver; z-index:10000; *width:180px; } #vakata-contextmenu ul { min-width:180px; *width:180px; } #vakata-contextmenu ul, #vakata-contextmenu li { margin:0; padding:0; list-style-type:none; display:block; } #vakata-contextmenu li { line-height:20px; min-height:20px; position:relative; padding:0px; } #vakata-contextmenu li a { padding:1px 6px; line-height:17px; display:block; text-decoration:none; margin:1px 1px 0 1px; } #vakata-contextmenu li ins { float:left; width:16px; height:16px; text-decoration:none; margin-right:2px; } #vakata-contextmenu li a:hover, #vakata-contextmenu li.vakata-hover > a { background:gray; color:white; } #vakata-contextmenu li ul { display:none; position:absolute; top:-2px; left:100%; background:#ebebeb; border:1px solid gray; } #vakata-contextmenu .right { right:100%; left:auto; } #vakata-contextmenu .bottom { bottom:-1px; top:auto; } #vakata-contextmenu li.vakata-separator { min-height:0; height:1px; line-height:1px; font-size:1px; overflow:hidden; margin:0 2px; background:silver; /* border-top:1px solid #fefefe; */ padding:0; } ";
            e.vakata.css.add_sheet({str: t,title: "vakata"}), e.vakata.context.cnt.delegate("a", "click", function(e) {
                e.preventDefault()
            }).delegate("a", "mouseup", function(t) {
                !e(this).parent().hasClass("jstree-contextmenu-disabled") && e.vakata.context.exec(e(this).attr("rel")) ? e.vakata.context.hide() : e(this).blur()
            }).delegate("a", "mouseover", function() {
                e.vakata.context.cnt.find(".vakata-hover").removeClass("vakata-hover")
            }).appendTo("body"), e(document).bind("mousedown", function(t) {
                e.vakata.context.vis && !e.contains(e.vakata.context.cnt[0], t.target) && e.vakata.context.hide()
            }), typeof e.hotkeys != "undefined" && e(document).bind("keydown", "up", function(t) {
                if (e.vakata.context.vis) {
                    var n = e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").prevAll("li:not(.vakata-separator)").first();
                    n.length || (n = e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").last()), n.addClass("vakata-hover"), t.stopImmediatePropagation(), t.preventDefault()
                }
            }).bind("keydown", "down", function(t) {
                if (e.vakata.context.vis) {
                    var n = e.vakata.context.cnt.find("ul:visible").last().children(".vakata-hover").removeClass("vakata-hover").nextAll("li:not(.vakata-separator)").first();
                    n.length || (n = e.vakata.context.cnt.find("ul:visible").last().children("li:not(.vakata-separator)").first()), n.addClass("vakata-hover"), t.stopImmediatePropagation(), t.preventDefault()
                }
            }).bind("keydown", "right", function(t) {
                e.vakata.context.vis && (e.vakata.context.cnt.find(".vakata-hover").children("ul").show().children("li:not(.vakata-separator)").removeClass("vakata-hover").first().addClass("vakata-hover"), t.stopImmediatePropagation(), t.preventDefault())
            }).bind("keydown", "left", function(t) {
                e.vakata.context.vis && (e.vakata.context.cnt.find(".vakata-hover").children("ul").hide().children(".vakata-separator").removeClass("vakata-hover"), t.stopImmediatePropagation(), t.preventDefault())
            }).bind("keydown", "esc", function(t) {
                e.vakata.context.hide(), t.preventDefault()
            }).bind("keydown", "space", function(t) {
                e.vakata.context.cnt.find(".vakata-hover").last().children("a").click(), t.preventDefault()
            })
        }), e.jstree.plugin("contextmenu", {__init: function() {
                this.get_container().delegate("a", "contextmenu.jstree", e.proxy(function(t) {
                    t.preventDefault(), e(t.currentTarget).hasClass("jstree-loading") || this.show_contextmenu(t.currentTarget, t.pageX, t.pageY)
                }, this)).delegate("a", "click.jstree", e.proxy(function(t) {
                    this.data.contextmenu && e.vakata.context.hide()
                }, this)).bind("destroy.jstree", e.proxy(function() {
                    this.data.contextmenu && e.vakata.context.hide()
                }, this)), e(document).bind("context_hide.vakata", e.proxy(function() {
                    this.data.contextmenu = !1
                }, this))
            },defaults: {select_node: !1,show_at_node: !0,items: {create: {separator_before: !1,separator_after: !0,label: "Create",action: function(e) {
                            this.create(e)
                        }},rename: {separator_before: !1,separator_after: !1,label: "Rename",action: function(e) {
                            this.rename(e)
                        }},remove: {separator_before: !1,icon: !1,separator_after: !1,label: "Delete",action: function(e) {
                            this.is_selected(e) ? this.remove() : this.remove(e)
                        }},ccp: {separator_before: !0,icon: !1,separator_after: !1,label: "Edit",action: !1,submenu: {cut: {separator_before: !1,separator_after: !1,label: "Cut",action: function(e) {
                                    this.cut(e)
                                }},copy: {separator_before: !1,icon: !1,separator_after: !1,label: "Copy",action: function(e) {
                                    this.copy(e)
                                }},paste: {separator_before: !1,icon: !1,separator_after: !1,label: "Paste",action: function(e) {
                                    this.paste(e)
                                }}}}}},_fn: {show_contextmenu: function(t, n, r) {
                    t = this._get_node(t);
                    var i = this.get_settings().contextmenu, s = t.children("a:visible:eq(0)"), o = !1, u = !1;
                    i.select_node && this.data.ui && !this.is_selected(t) && (this.deselect_all(), this.select_node(t, !0));
                    if (i.show_at_node || typeof n == "undefined" || typeof r == "undefined")
                        o = s.offset(), n = o.left, r = o.top + this.data.core.li_height;
                    u = t.data("jstree") && t.data("jstree").contextmenu ? t.data("jstree").contextmenu : i.items, e.isFunction(u) && (u = u.call(this, t)), this.data.contextmenu = !0, e.vakata.context.show(u, s, n, r, this, t, this._get_settings().core.rtl), this.data.themes && e.vakata.context.cnt.attr("class", "jstree-" + this.data.themes.theme + "-context")
                }}})
    }(jQuery), function(t) {
        t.jstree.plugin("types", {__init: function() {
                var n = this._get_settings().types;
                this.data.types.attach_to = [], this.get_container().bind("init.jstree", t.proxy(function() {
                    var e = n.types, r = n.type_attr, i = "", o = this;
                    t.each(e, function(e, n) {
                        t.each(n, function(e, t) {
                            /^(max_depth|max_children|icon|valid_children)$/.test(e) || o.data.types.attach_to.push(e)
                        });
                        if (!n.icon)
                            return !0;
                        if (n.icon.image || n.icon.position)
                            e == "default" ? i += ".jstree-" + o.get_index() + " a > .jstree-icon { " : i += ".jstree-" + o.get_index() + " li[" + r + '="' + e + '"] > a > .jstree-icon { ', n.icon.image && (i += " background-image:url(" + n.icon.image + "); "), n.icon.position ? i += " background-position:" + n.icon.position + "; " : i += " background-position:0 0; ", i += "} "
                    }), i !== "" && t.vakata.css.add_sheet({str: i,title: "jstree-types"})
                }, this)).bind("before.jstree", t.proxy(function(e, n) {
                    var r, i, s = this._get_settings().types.use_data ? this._get_node(n.args[0]) : !1, o = s && s !== -1 && s.length ? s.data("jstree") : !1;
                    if (o && o.types && o.types[n.func] === !1)
                        return e.stopImmediatePropagation(), !1;
                    if (t.inArray(n.func, this.data.types.attach_to) !== -1) {
                        if (!n.args[0] || !n.args[0].tagName && !n.args[0].jquery)
                            return;
                        r = this._get_settings().types.types, i = this._get_type(n.args[0]);
                        if ((r[i] && typeof r[i][n.func] != "undefined" || r["default"] && typeof r["default"][n.func] != "undefined") && this._check(n.func, n.args[0]) === !1)
                            return e.stopImmediatePropagation(), !1
                    }
                }, this)), (e || t.browser.msie && t.browser.version == 9) && this.get_container().bind("load_node.jstree set_type.jstree", t.proxy(function(e, n) {
                    var r = n && n.rslt && n.rslt.obj && n.rslt.obj !== -1 ? this._get_node(n.rslt.obj).parent() : this.get_container_ul(), i = !1, s = this._get_settings().types;
                    t.each(s.types, function(e, t) {
                        t.icon && (t.icon.image || t.icon.position) && (i = e === "default" ? r.find("li > a > .jstree-icon") : r.find("li[" + s.type_attr + "='" + e + "'] > a > .jstree-icon"), t.icon.image && i.css("backgroundImage", "url(" + t.icon.image + ")"), i.css("backgroundPosition", t.icon.position || "0 0"))
                    })
                }, this))
            },defaults: {max_children: -1,max_depth: -1,valid_children: "all",use_data: !1,type_attr: "rel",types: {"default": {max_children: -1,max_depth: -1,valid_children: "all"}}},_fn: {_types_notify: function(e, t) {
                    t.type && this._get_settings().types.use_data && this.set_type(t.type, e)
                },_get_type: function(e) {
                    return e = this._get_node(e), !e || !e.length ? !1 : e.attr(this._get_settings().types.type_attr) || "default"
                },set_type: function(e, t) {
                    t = this._get_node(t);
                    var n = !t.length || !e ? !1 : t.attr(this._get_settings().types.type_attr, e);
                    return n && this.__callback({obj: t,type: e}), n
                },_check: function(e, n, r) {
                    n = this._get_node(n);
                    var i = !1, s = this._get_type(n), o = 0, u = this, a = this._get_settings().types, f = !1;
                    if (n === -1) {
                        if (!a[e])
                            return;
                        i = a[e]
                    } else {
                        if (s === !1)
                            return;
                        f = a.use_data ? n.data("jstree") : !1, f && f.types && typeof f.types[e] != "undefined" ? i = f.types[e] : !a.types[s] || typeof a.types[s][e] == "undefined" ? !!a.types["default"] && typeof a.types["default"][e] != "undefined" && (i = a.types["default"][e]) : i = a.types[s][e]
                    }
                    return t.isFunction(i) && (i = i.call(this, n)), e === "max_depth" && n !== -1 && r !== !1 && a.max_depth !== -2 && i !== 0 && n.children("a:eq(0)").parentsUntil(".jstree", "li").each(function(t) {
                        if (a.max_depth !== -1 && a.max_depth - (t + 1) <= 0)
                            return i = 0, !1;
                        o = t === 0 ? i : u._check(e, this, !1);
                        if (o !== -1 && o - (t + 1) <= 0)
                            return i = 0, !1;
                        o >= 0 && (o - (t + 1) < i || i < 0) && (i = o - (t + 1)), a.max_depth >= 0 && (a.max_depth - (t + 1) < i || i < 0) && (i = a.max_depth - (t + 1))
                    }), i
                },check_move: function() {
                    if (!this.__call_old())
                        return !1;
                    var e = this._get_move(), n = e.rt._get_settings().types, r = e.rt._check("max_children", e.cr), i = e.rt._check("max_depth", e.cr), s = e.rt._check("valid_children", e.cr), o = 0, u = 1, a;
                    if (s === "none")
                        return !1;
                    if (t.isArray(s) && e.ot && e.ot._get_type) {
                        e.o.each(function() {
                            if (t.inArray(e.ot._get_type(this), s) === -1)
                                return u = !1, !1
                        });
                        if (u === !1)
                            return !1
                    }
                    if (n.max_children !== -2 && r !== -1) {
                        o = e.cr === -1 ? this.get_container().find("> ul > li").not(e.o).length : e.cr.find("> ul > li").not(e.o).length;
                        if (o + e.o.length > r)
                            return !1
                    }
                    if (n.max_depth !== -2 && i !== -1) {
                        u = 0;
                        if (i === 0)
                            return !1;
                        if (typeof e.o.d == "undefined") {
                            a = e.o;
                            while (a.length > 0)
                                a = a.find("> ul > li"), u++;
                            e.o.d = u
                        }
                        if (i - e.o.d < 0)
                            return !1
                    }
                    return !0
                },create_node: function(e, n, r, i, s, o) {
                    if (!o && (s || this._is_loaded(e))) {
                        var u = typeof n == "string" && n.match(/^before|after$/i) && e !== -1 ? this._get_parent(e) : this._get_node(e), a = this._get_settings().types, f = this._check("max_children", u), l = this._check("max_depth", u), c = this._check("valid_children", u), h;
                        typeof r == "string" && (r = {data: r}), r || (r = {});
                        if (c === "none")
                            return !1;
                        if (t.isArray(c))
                            if (!r.attr || !r.attr[a.type_attr])
                                r.attr || (r.attr = {}), r.attr[a.type_attr] = c[0];
                            else if (t.inArray(r.attr[a.type_attr], c) === -1)
                                return !1;
                        if (a.max_children !== -2 && f !== -1) {
                            h = u === -1 ? this.get_container().find("> ul > li").length : u.find("> ul > li").length;
                            if (h + 1 > f)
                                return !1
                        }
                        if (a.max_depth !== -2 && l !== -1 && l - 1 < 0)
                            return !1
                    }
                    return this.__call_old(!0, e, n, r, i, s, o)
                }}})
    }(jQuery), function(e) {
        e.jstree.plugin("html_data", {__init: function() {
                this.data.html_data.original_container_html = this.get_container().find(" > ul > li").clone(!0), this.data.html_data.original_container_html.find("li").andSelf().contents().filter(function() {
                    return this.nodeType == 3
                }).remove()
            },defaults: {data: !1,ajax: !1,correct_state: !0},_fn: {load_node: function(e, t, n) {
                    var r = this;
                    this.load_node_html(e, function() {
                        r.__callback({obj: r._get_node(e)}), t.call(this)
                    }, n)
                },_is_loaded: function(t) {
                    return t = this._get_node(t), t == -1 || !t || !this._get_settings().html_data.ajax && !e.isFunction(this._get_settings().html_data.data) || t.is(".jstree-open, .jstree-leaf") || t.children("ul").children("li").size() > 0
                },load_node_html: function(t, n, r) {
                    var i, s = this.get_settings().html_data, o = function() {
                    }, u = function() {
                    };
                    t = this._get_node(t);
                    if (t && t !== -1) {
                        if (t.data("jstree_is_loading"))
                            return;
                        t.data("jstree_is_loading", !0)
                    }
                    switch (!0) {
                        case e.isFunction(s.data):
                            s.data.call(this, t, e.proxy(function(r) {
                                r && r !== "" && r.toString && r.toString().replace(/^[\s\n]+$/, "") !== "" ? (r = e(r), r.is("ul") || (r = e("<ul />").append(r)), t == -1 || !t ? this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function() {
                                    return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== "INS"
                                }).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon") : (t.children("a.jstree-loading").removeClass("jstree-loading"), t.append(r).children("ul").find("li, a").filter(function() {
                                    return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== "INS"
                                }).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"), t.removeData("jstree_is_loading")), this.clean_node(t), n && n.call(this)) : t && t !== -1 ? (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), s.correct_state && (this.correct_state(t), n && n.call(this))) : s.correct_state && (this.get_container().children("ul").empty(), n && n.call(this))
                            }, this));
                            break;
                        case !s.data && !s.ajax:
                            if (!t || t == -1)
                                this.get_container().children("ul").empty().append(this.data.html_data.original_container_html).find("li, a").filter(function() {
                                    return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== "INS"
                                }).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"), this.clean_node();
                            n && n.call(this);
                            break;
                        case !!s.data && !s.ajax || !!s.data && !!s.ajax && (!t || t === -1):
                            if (!t || t == -1)
                                i = e(s.data), i.is("ul") || (i = e("<ul />").append(i)), this.get_container().children("ul").empty().append(i.children()).find("li, a").filter(function() {
                                    return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== "INS"
                                }).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"), this.clean_node();
                            n && n.call(this);
                            break;
                        case !s.data && !!s.ajax || !!s.data && !!s.ajax && t && t !== -1:
                            t = this._get_node(t), o = function(e, n, i) {
                                var o = this.get_settings().html_data.ajax.error;
                                o && o.call(this, e, n, i), t != -1 && t.length ? (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), n === "success" && s.correct_state && this.correct_state(t)) : n === "success" && s.correct_state && this.get_container().children("ul").empty(), r && r.call(this)
                            }, u = function(r, i, u) {
                                var a = this.get_settings().html_data.ajax.success;
                                a && (r = a.call(this, r, i, u) || r);
                                if (r === "" || r && r.toString && r.toString().replace(/^[\s\n]+$/, "") === "")
                                    return o.call(this, u, i, "");
                                r ? (r = e(r), r.is("ul") || (r = e("<ul />").append(r)), t == -1 || !t ? this.get_container().children("ul").empty().append(r.children()).find("li, a").filter(function() {
                                    return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== "INS"
                                }).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon") : (t.children("a.jstree-loading").removeClass("jstree-loading"), t.append(r).children("ul").find("li, a").filter(function() {
                                    return !this.firstChild || !this.firstChild.tagName || this.firstChild.tagName !== "INS"
                                }).prepend("<ins class='jstree-icon'>&#160;</ins>").end().filter("a").children("ins:first-child").not(".jstree-icon").addClass("jstree-icon"), t.removeData("jstree_is_loading")), this.clean_node(t), n && n.call(this)) : t && t !== -1 ? (t.children("a.jstree-loading").removeClass("jstree-loading"), t.removeData("jstree_is_loading"), s.correct_state && (this.correct_state(t), n && n.call(this))) : s.correct_state && (this.get_container().children("ul").empty(), n && n.call(this))
                            }, s.ajax.context = this, s.ajax.error = o, s.ajax.success = u, s.ajax.dataType || (s.ajax.dataType = "html"), e.isFunction(s.ajax.url) && (s.ajax.url = s.ajax.url.call(this, t)), e.isFunction(s.ajax.data) && (s.ajax.data = s.ajax.data.call(this, t)), e.ajax(s.ajax)
                    }
                }}}), e.jstree.defaults.plugins.push("html_data")
    }(jQuery), function(e) {
        e.jstree.plugin("themeroller", {__init: function() {
                var t = this._get_settings().themeroller;
                this.get_container().addClass("ui-widget-content").addClass("jstree-themeroller").delegate("a", "mouseenter.jstree", function(n) {
                    e(n.currentTarget).hasClass("jstree-loading") || e(this).addClass(t.item_h)
                }).delegate("a", "mouseleave.jstree", function() {
                    e(this).removeClass(t.item_h)
                }).bind("init.jstree", e.proxy(function(e, t) {
                    t.inst.get_container().find("> ul > li > .jstree-loading > ins").addClass("ui-icon-refresh"), this._themeroller(t.inst.get_container().find("> ul > li"))
                }, this)).bind("open_node.jstree create_node.jstree", e.proxy(function(e, t) {
                    this._themeroller(t.rslt.obj)
                }, this)).bind("loaded.jstree refresh.jstree", e.proxy(function(e) {
                    this._themeroller()
                }, this)).bind("close_node.jstree", e.proxy(function(e, t) {
                    this._themeroller(t.rslt.obj)
                }, this)).bind("delete_node.jstree", e.proxy(function(e, t) {
                    this._themeroller(t.rslt.parent)
                }, this)).bind("correct_state.jstree", e.proxy(function(e, n) {
                    n.rslt.obj.children("ins.jstree-icon").removeClass(t.opened + " " + t.closed + " ui-icon").end().find("> a > ins.ui-icon").filter(function() {
                        return this.className.toString().replace(t.item_clsd, "").replace(t.item_open, "").replace(t.item_leaf, "").indexOf("ui-icon-") === -1
                    }).removeClass(t.item_open + " " + t.item_clsd).addClass(t.item_leaf || "jstree-no-icon")
                }, this)).bind("select_node.jstree", e.proxy(function(e, n) {
                    n.rslt.obj.children("a").addClass(t.item_a)
                }, this)).bind("deselect_node.jstree deselect_all.jstree", e.proxy(function(e, n) {
                    this.get_container().find("a." + t.item_a).removeClass(t.item_a).end().find("a.jstree-clicked").addClass(t.item_a)
                }, this)).bind("dehover_node.jstree", e.proxy(function(e, n) {
                    n.rslt.obj.children("a").removeClass(t.item_h)
                }, this)).bind("hover_node.jstree", e.proxy(function(e, n) {
                    this.get_container().find("a." + t.item_h).not(n.rslt.obj).removeClass(t.item_h), n.rslt.obj.children("a").addClass(t.item_h)
                }, this)).bind("move_node.jstree", e.proxy(function(e, t) {
                    this._themeroller(t.rslt.o), this._themeroller(t.rslt.op)
                }, this))
            },__destroy: function() {
                var t = this._get_settings().themeroller, n = ["ui-icon"];
                e.each(t, function(e, t) {
                    t = t.split(" "), t.length && (n = n.concat(t))
                }), this.get_container().removeClass("ui-widget-content").find("." + n.join(", .")).removeClass(n.join(" "))
            },_fn: {_themeroller: function(e) {
                    var t = this._get_settings().themeroller;
                    e = !e || e == -1 ? this.get_container_ul() : this._get_node(e).parent(), e.find("li.jstree-closed").children("ins.jstree-icon").removeClass(t.opened).addClass("ui-icon " + t.closed).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function() {
                        return this.className.toString().replace(t.item_clsd, "").replace(t.item_open, "").replace(t.item_leaf, "").indexOf("ui-icon-") === -1
                    }).removeClass(t.item_leaf + " " + t.item_open).addClass(t.item_clsd || "jstree-no-icon").end().end().end().end().find("li.jstree-open").children("ins.jstree-icon").removeClass(t.closed).addClass("ui-icon " + t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function() {
                        return this.className.toString().replace(t.item_clsd, "").replace(t.item_open, "").replace(t.item_leaf, "").indexOf("ui-icon-") === -1
                    }).removeClass(t.item_leaf + " " + t.item_clsd).addClass(t.item_open || "jstree-no-icon").end().end().end().end().find("li.jstree-leaf").children("ins.jstree-icon").removeClass(t.closed + " ui-icon " + t.opened).end().children("a").addClass(t.item).children("ins.jstree-icon").addClass("ui-icon").filter(function() {
                        return this.className.toString().replace(t.item_clsd, "").replace(t.item_open, "").replace(t.item_leaf, "").indexOf("ui-icon-") === -1
                    }).removeClass(t.item_clsd + " " + t.item_open).addClass(t.item_leaf || "jstree-no-icon")
                }},defaults: {opened: "ui-icon-triangle-1-se",closed: "ui-icon-triangle-1-e",item: "ui-state-default",item_h: "ui-state-hover",item_a: "ui-state-active",item_open: "ui-icon-folder-open",item_clsd: "ui-icon-folder-collapsed",item_leaf: "ui-icon-document"}}), e(function() {
            var t = ".jstree-themeroller .ui-icon { overflow:visible; } .jstree-themeroller a { padding:0 2px; } .jstree-themeroller .jstree-no-icon { display:none; }";
            e.vakata.css.add_sheet({str: t,title: "jstree"})
        })
    }(jQuery), function(e) {
        e.jstree.plugin("unique", {__init: function() {
                this.get_container().bind("before.jstree", e.proxy(function(t, n) {
                    var r = [], i = !0, s, o;
                    n.func == "move_node" && n.args[4] === !0 && n.args[0].o && n.args[0].o.length && (n.args[0].o.children("a").each(function() {
                        r.push(e(this).text().replace(/^\s+/g, ""))
                    }), i = this._check_unique(r, n.args[0].np.find("> ul > li").not(n.args[0].o), "move_node"));
                    if (n.func == "create_node")
                        if (n.args[4] || this._is_loaded(n.args[0])) {
                            s = this._get_node(n.args[0]);
                            if (n.args[1] && (n.args[1] === "before" || n.args[1] === "after")) {
                                s = this._get_parent(n.args[0]);
                                if (!s || s === -1)
                                    s = this.get_container()
                            }
                            typeof n.args[2] == "string" ? r.push(n.args[2]) : !n.args[2] || !n.args[2].data ? r.push(this._get_string("new_node")) : r.push(n.args[2].data), i = this._check_unique(r, s.find("> ul > li"), "create_node")
                        }
                    if (n.func == "rename_node") {
                        r.push(n.args[1]), o = this._get_node(n.args[0]), s = this._get_parent(o);
                        if (!s || s === -1)
                            s = this.get_container();
                        i = this._check_unique(r, s.find("> ul > li").not(o), "rename_node")
                    }
                    if (!i)
                        return t.stopPropagation(), !1
                }, this))
            },defaults: {error_callback: e.noop},_fn: {_check_unique: function(t, n, r) {
                    var i = [];
                    return n.children("a").each(function() {
                        i.push(e(this).text().replace(/^\s+/g, ""))
                    }), !i.length || !t.length ? !0 : (i = i.sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g, "$1$2$4").replace(/,,+/g, ",").replace(/,$/, "").split(","), i.length + t.length != i.concat(t).sort().join(",,").replace(/(,|^)([^,]+)(,,\2)+(,|$)/g, "$1$2$4").replace(/,,+/g, ",").replace(/,$/, "").split(",").length ? (this._get_settings().unique.error_callback.call(null, t, n, r), !1) : !0)
                },check_move: function() {
                    if (!this.__call_old())
                        return !1;
                    var t = this._get_move(), n = [];
                    return t.o && t.o.length ? (t.o.children("a").each(function() {
                        n.push(e(this).text().replace(/^\s+/g, ""))
                    }), this._check_unique(n, t.np.find("> ul > li").not(t.o), "check_move")) : !0
                }}})
    }(jQuery), function(r) {
        r.jstree.plugin("wholerow", {__init: function() {
                if (!this.data.ui)
                    throw "jsTree wholerow: jsTree UI plugin not included.";
                this.data.wholerow.html = !1, this.data.wholerow.to = !1, this.get_container().bind("init.jstree", r.proxy(function(e, t) {
                    this._get_settings().core.animation = 0
                }, this)).bind("open_node.jstree create_node.jstree clean_node.jstree loaded.jstree", r.proxy(function(e, t) {
                    this._prepare_wholerow_span(t && t.rslt && t.rslt.obj ? t.rslt.obj : -1)
                }, this)).bind("search.jstree clear_search.jstree reopen.jstree after_open.jstree after_close.jstree create_node.jstree delete_node.jstree clean_node.jstree", r.proxy(function(e, t) {
                    this.data.to && clearTimeout(this.data.to), this.data.to = setTimeout(function(e, t) {
                        return function() {
                            e._prepare_wholerow_ul(t)
                        }
                    }(this, t && t.rslt && t.rslt.obj ? t.rslt.obj : -1), 0)
                }, this)).bind("deselect_all.jstree", r.proxy(function(e, t) {
                    this.get_container().find(" > .jstree-wholerow .jstree-clicked").removeClass("jstree-clicked " + (this.data.themeroller ? this._get_settings().themeroller.item_a : ""))
                }, this)).bind("select_node.jstree deselect_node.jstree ", r.proxy(function(e, t) {
                    t.rslt.obj.each(function() {
                        var e = t.inst.get_container().find(" > .jstree-wholerow li:visible:eq(" + parseInt((r(this).offset().top - t.inst.get_container().offset().top + t.inst.get_container()[0].scrollTop) / t.inst.data.core.li_height, 10) + ")");
                        e.children("a").attr("class", t.rslt.obj.children("a").attr("class"))
                    })
                }, this)).bind("hover_node.jstree dehover_node.jstree", r.proxy(function(e, t) {
                    this.get_container().find(" > .jstree-wholerow .jstree-hovered").removeClass("jstree-hovered " + (this.data.themeroller ? this._get_settings().themeroller.item_h : ""));
                    if (e.type === "hover_node") {
                        var n = this.get_container().find(" > .jstree-wholerow li:visible:eq(" + parseInt((t.rslt.obj.offset().top - this.get_container().offset().top + this.get_container()[0].scrollTop) / this.data.core.li_height, 10) + ")");
                        n.children("a").attr("class", t.rslt.obj.children(".jstree-hovered").attr("class"))
                    }
                }, this)).delegate(".jstree-wholerow-span, ins.jstree-icon, li", "click.jstree", function(e) {
                    var t = r(e.currentTarget);
                    if (e.target.tagName === "A" || e.target.tagName === "INS" && t.closest("li").is(".jstree-open, .jstree-closed"))
                        return;
                    t.closest("li").children("a:visible:eq(0)").click(), e.stopImmediatePropagation()
                }).delegate("li", "mouseover.jstree", r.proxy(function(e) {
                    return e.stopImmediatePropagation(), r(e.currentTarget).children(".jstree-hovered, .jstree-clicked").length ? !1 : (this.hover_node(e.currentTarget), !1)
                }, this)).delegate("li", "mouseleave.jstree", r.proxy(function(e) {
                    if (r(e.currentTarget).children("a").hasClass("jstree-hovered").length)
                        return;
                    this.dehover_node(e.currentTarget)
                }, this)), (t || e) && r.vakata.css.add_sheet({str: ".jstree-" + this.get_index() + " { position:relative; } ",title: "jstree"})
            },defaults: {},__destroy: function() {
                this.get_container().children(".jstree-wholerow").remove(), this.get_container().find(".jstree-wholerow-span").remove()
            },_fn: {_prepare_wholerow_span: function(e) {
                    e = !e || e == -1 ? this.get_container().find("> ul > li") : this._get_node(e);
                    if (e === !1)
                        return;
                    e.each(function() {
                        r(this).find("li").andSelf().each(function() {
                            var e = r(this);
                            if (e.children(".jstree-wholerow-span").length)
                                return !0;
                            e.prepend("<span class='jstree-wholerow-span' style='width:" + e.parentsUntil(".jstree", "li").length * 18 + "px;'>&#160;</span>")
                        })
                    })
                },_prepare_wholerow_ul: function() {
                    var e = this.get_container().children("ul").eq(0), n = e.html();
                    e.addClass("jstree-wholerow-real"), this.data.wholerow.last_html !== n && (this.data.wholerow.last_html = n, this.get_container().children(".jstree-wholerow").remove(), this.get_container().append(e.clone().removeClass("jstree-wholerow-real").wrapAll("<div class='jstree-wholerow' />").parent().width(e.parent()[0].scrollWidth).css("top", (e.height() + (t ? 5 : 0)) * -1).find("li[id]").each(function() {
                        this.removeAttribute("id")
                    }).end()))
                }}}), r(function() {
            var i = ".jstree .jstree-wholerow-real { position:relative; z-index:1; } .jstree .jstree-wholerow-real li { cursor:pointer; } .jstree .jstree-wholerow-real a { border-left-color:transparent !important; border-right-color:transparent !important; } .jstree .jstree-wholerow { position:relative; z-index:0; height:0; } .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { width:100%; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li, .jstree .jstree-wholerow a { margin:0 !important; padding:0 !important; } .jstree .jstree-wholerow, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow li { background:transparent !important; }.jstree .jstree-wholerow ins, .jstree .jstree-wholerow span, .jstree .jstree-wholerow input { display:none !important; }.jstree .jstree-wholerow a, .jstree .jstree-wholerow a:hover { text-indent:-9999px; !important; width:100%; padding:0 !important; border-right-width:0px !important; border-left-width:0px !important; } .jstree .jstree-wholerow-span { position:absolute; left:0; margin:0px; padding:0; height:18px; border-width:0; padding:0; z-index:0; }";
            n && (i += ".jstree .jstree-wholerow a { display:block; height:18px; margin:0; padding:0; border:0; } .jstree .jstree-wholerow-real a { border-color:transparent !important; } ");
            if (t || e)
                i += ".jstree .jstree-wholerow, .jstree .jstree-wholerow li, .jstree .jstree-wholerow ul, .jstree .jstree-wholerow a { margin:0; padding:0; line-height:18px; } .jstree .jstree-wholerow a { display:block; height:18px; line-height:18px; overflow:hidden; } ";
            r.vakata.css.add_sheet({str: i,title: "jstree"})
        })
    }(jQuery), function(e) {
        var t = ["getChildren", "getChildrenCount", "getAttr", "getName", "getProps"], n = function(t, n) {
            var r = !0;
            return t = t || {}, n = [].concat(n), e.each(n, function(n, i) {
                if (!e.isFunction(t[i]))
                    return r = !1, !1
            }), r
        };
        e.jstree.plugin("model", {__init: function() {
                if (!this.data.json_data)
                    throw "jsTree model: jsTree json_data plugin not included.";
                this._get_settings().json_data.data = function(r, i) {
                    var s = r == -1 ? this._get_settings().model.object : r.data("jstree_model");
                    if (!n(s, t))
                        return i.call(null, !1);
                    this._get_settings().model.async ? s.getChildren(e.proxy(function(e) {
                        this.model_done(e, i)
                    }, this)) : this.model_done(s.getChildren(), i)
                }
            },defaults: {object: !1,id_prefix: !1,async: !1},_fn: {model_done: function(t, n) {
                    var r = [], i = this._get_settings(), s = this;
                    e.isArray(t) || (t = [t]), e.each(t, function(t, n) {
                        var o = n.getProps() || {};
                        o.attr = n.getAttr() || {}, n.getChildrenCount() && (o.state = "closed"), o.data = n.getName(), e.isArray(o.data) || (o.data = [o.data]), s.data.types && e.isFunction(n.getType) && (o.attr[i.types.type_attr] = n.getType()), o.attr.id && i.model.id_prefix && (o.attr.id = i.model.id_prefix + o.attr.id), o.metadata || (o.metadata = {}), o.metadata.jstree_model = n, r.push(o)
                    }), n.call(null, r)
                }}})
    }(jQuery)
}(), define("jquery.jstree", function() {
}), define("modules/Widget/Views/FolderTree", ["backbone", "adobe", "adobe.widgets", "jquery.jstree"], function(e, t, n) {
    var r;
    return arguments.length == 0 ? (e = Backbone, r = ADOBE.AM.UTILS, n = ADOBE.AM) : (n = t.AM, r = n.UTILS), e.View.extend({tree: null,tagName: "div",className: "",folder_api_url: "",$hoveredElement: null,tree_widget: null,tree_options: null,dialogs_parent: "body",dialogs: {rename: {id: "",name_id: "",instance: null,html: {icon: "<span class='edit btnIcon' title='Rename this folder'></span>",makeDialogHTML: function(e, t) {
                        return '<div class="dialog" style="display:none;" id="' + e + '" title="Rename Folder">' + '<ul class="formFields">' + '<li>Folder Name: <input type="text" id="' + t + '" size="20" /></li>' + '<li>Folder ID: <span class="folderId"></span></li>' + "</ul>" + '<div class="buttons">' + '<button class="primary save" >Save</button>  <button class="secondary cancel">Cancel</button>' + "</div>" + "</div>"
                    }}},add: {id: "",name_id: "",instance: null,html: {icon: "<span class='add btnIcon' title='Add a folder'></span>",makeDialogHTML: function(e, t) {
                        return '<div class="dialog" style="display:none;" id="' + e + '" title="Add Folder">' + '<ul class="formFields">' + '<li>Folder Name: <input type="text" id="' + t + '" size="20" /></li>' + "</ul>" + '<div class="buttons">' + '<button class="primary save" >Save</button>  <button class="secondary cancel">Cancel</button>' + "</div>" + "</div>"
                    }}},remove: {id: "",name_id: "",instance: null,html: {icon: "<span class='delete btnIcon' title='Delete this folder'></span>",makeDialogHTML: function(e) {
                        return '<div class="dialog" style="display:none;" id="' + e + '" title="Delete Folder">' + "Are you sure you want to delete this folder?" + '<div><span class="folderName"></span> (<span class="folderId"></span>)</div>' + '<div class="buttons">' + '<button class="primary delete" >Delete</button>  <button class="secondary cancel">Cancel</button>' + "</div>" + "</div>"
                    }}}},unique_id: null,isRendered: !1,folderActionsEnabled: !1,render: function() {
            $(this.el).addClass("folder_tree"), $(this.parentElement).append($(this.el)), this.addFolderWidget(), this.loadFolders(), this.isRendered = !0
        },addFolderWidget: function() {
            var e = null, t = this, n = "";
            e = new this.tree_widget, e.treeElement = this.el;
            if (this.tree_options.initially_open != undefined)
                var r = this.makeJSTreeId(this.tree_options.initially_open);
            e.initially_open = [r], e.initially_select = this.tree_options.initially_select, e.showCheckboxes = !1, e.folderThemeSrc = "/css/aam/style.css", e.folderSrc = this.tree_options.folderSrc || this.folder_api_url(), e.inc3rdParty = this.tree_options.inc3rdParty, e.foldersOnly = this.tree_options.foldersOnly, e.formatData = this.tree_options.formatData, e.two_state = typeof this.tree_options.two_state != "undefined" ? this.tree_options.two_state : !1, e.dots = typeof this.tree_options.dots != "undefined" ? this.tree_options.dots : !1, e.icons = typeof this.tree_options.icons != "undefined" ? this.tree_options.icons : !0, this.tree = e, this.folderActionsEnabled && (this.dialogs.add.id && $("#" + this.dialogs.add.id).length == 0 && this.addFolderDialog(), this.dialogs.remove.id && $("#" + this.dialogs.remove.id).length == 0 && this.addRemoveDialog(), this.dialogs.rename.id && $("#" + this.dialogs.rename.id).length == 0 && this.addRenameDialog())
        },addFolderDialog: function() {
            var e = this, t = this.dialogs.add, i = "";
            i = t.html.makeDialogHTML(t.id, t.name_id), $(this.dialogs_parent).append(i), t.instance = $("#" + t.id).dialog({autoOpen: !1,modal: !0,create: function() {
                    var i = $("#" + t.id);
                    i.find(".cancel").click(function() {
                        t.instance.dialog("close")
                    }), i.find(".save").click(function() {
                        var r = null, i = "", s = null, o = {domainid: 0};
                        try {
                            r = parseInt(e.$hoveredElement.parent().attr("id"), 10)
                        } catch (u) {
                            throw new Error("Error getting the parent folder")
                        }
                        t.instance.dialog("close"), s = $("#" + t.name_id), i = s.val(), _.extend(o, {parentFolderId: r,name: $.trim(i)}), s.val(""), $.ajax({url: e.folder_api_url(),type: "POST",dataType: "json",contentType: "application/json",data: JSON.stringify(o),success: function(t) {
                                var n = "";
                                try {
                                    n = "#" + $(e.tree.treeElement).jstree("get_selected").attr("id")
                                } catch (r) {
                                    throw new Error("Could not select folder")
                                }
                                e.tree.initially_select = [n], e.loadFolders()
                            },error: function(t, r, i) {
                                var s = {title: e.constructor.error_messages.cannot_save_folder};
                                t.status == 409 ? (s.errorMsg = e.constructor.error_messages.duplicate_name, s.msg = e.constructor.error_messages.change_name_try_again) : (s.errorMsg = e.constructor.error_messages.unknown_error, s.msg = i), n.alertBox(s)
                            }})
                    }), i.find("input").keypress(function(e) {
                        r.pressedEnter(e) && i.find(".save").click()
                    })
                }})
        },addRemoveDialog: function() {
            var e = this, t = e.dialogs.remove, r = "";
            r = t.html.makeDialogHTML(t.id, t.name_id), $(this.dialogs_parent).append(r), t.instance = $("#" + t.id).dialog({autoOpen: !1,modal: !0,create: function() {
                    $("#" + t.id).find(".cancel").click(function() {
                        t.instance.dialog("close")
                    }), $("#" + t.id).find(".delete").click(function() {
                        t.instance.dialog("close");
                        var r = parseInt(e.$hoveredElement.parent().attr("id"), 10);
                        $.ajax({url: e.folder_api_url(r),type: "DELETE",dataType: "json",success: function() {
                                var t = null;
                                try {
                                    t = parseInt(e.$hoveredElement.parent().attr("id"), 10), e.tree.initially_open = ["#0_folder", t], e.tree.initially_select = [t], e.loadFolders()
                                } catch (n) {
                                    throw new Error("The folder was delete but could not open a folder")
                                }
                            },error: function(t, r, i) {
                                var s = {title: e.constructor.error_messages.delete_folder};
                                t.status == 409 ? (s.errorMsg = e.constructor.error_messages.cannot_delete_folder, s.msg = e.constructor.error_messages.cannot_delete_folder_message) : (s.errorMsg = e.constructor.error_messages.unknown_error, s.msg = i), n.alertBox(s)
                            }})
                    })
                }})
        },addRenameDialog: function() {
            var e = this, t = this.dialogs.rename, i = "";
            i = t.html.makeDialogHTML(t.id, t.name_id), $(this.dialogs_parent).append(i), t.instance = $("#" + t.id).dialog({autoOpen: !1,modal: !0,create: function() {
                    var i = $("#" + t.id);
                    i.find(".cancel").click(function() {
                        t.instance.dialog("close")
                    }), i.find(".save").click(function(r) {
                        t.instance.dialog("close");
                        var i = null, s = "", o = null, u = "";
                        try {
                            o = $("#" + e.dialogs.rename.name_id), i = parseInt(e.$hoveredElement.parent().attr("id"), 10), s = $.trim(o.val()), u = e.folder_api_url(i)
                        } catch (a) {
                            throw new Error("Rename folder error")
                        }
                        o.val(""), $.getJSON(u, function(t) {
                            t.name = s, $.ajax({url: u,type: "PUT",dataType: "json",contentType: "application/json",data: JSON.stringify(t),success: function() {
                                    var t = "#" + $(e.tree.treeElement).jstree("get_selected").attr("id");
                                    e.tree.initially_select = [t], e.loadFolders()
                                },error: function(t, r, i) {
                                    var s = {title: e.constructor.error_messages.cannot_save_folder};
                                    t.status == 409 ? (s.errorMsg = e.constructor.error_messages.duplicate_folder_name, s.msg = e.constructor.error_messages.change_name_try_again) : (s.errorMsg = e.constructor.error_messages.unknown_error, s.msg = i), n.alertBox(s)
                                }})
                        })
                    }), $("#" + e.dialogs.rename.id).find("input").keypress(function(t) {
                        r.pressedEnter(t) && $("#" + e.dialogs.rename.id).find(".save").click()
                    })
                }})
        },loadFolders: function(e) {
            var t = this.tree.loadTree(), n = this, e = e || {};
            $(n.tree.treeElement).html(""), t.bind("loaded.jstree", function(e, t) {
                n.hookTreeLoaded()
            }), t.bind("hover_node.jstree", function(e, t) {
                var r = "";
                if (n.folderActionsEnabled) {
                    n.dialogs.add.id && (r += n.dialogs.add.html.icon), n.dialogs.rename.id && (r += n.dialogs.rename.html.icon), n.dialogs.remove.id && (r += n.dialogs.remove.html.icon);
                    var i = $(t.args[0]);
                    if (i.prop("nodeName") != "A")
                        return;
                    n.$hoveredElement = i;
                    if (i.find("span").length)
                        return;
                    i.append(r).find("span").on("click", function(e) {
                        e.stopPropagation();
                        var t = n.dialogs, r = parseInt($(e.target).closest("li[id]").attr("id"), 10);
                        return $(e.target).hasClass("add") ? t.add.instance.dialog("open") : $(e.target).hasClass("edit") ? ($("#" + t.rename.name_id).val($.trim($(e.target).parent().text())), $("#" + t.rename.id).find(".folderId").text(r), t.rename.instance.dialog("open")) : $(e.target).hasClass("delete") && ($("#" + t.remove.id + " .folderName").text($(e.target).parent().text()), $("#" + t.remove.id).find(".folderId").text(r), t.remove.instance.dialog("open")), $(".ui-dialog:visible").addClass("fixed-pos"), !1
                    })
                }
            }), t.bind("select_node.jstree", function(e, t) {
                var r = $(n.tree.treeElement).jstree("get_selected").attr("id"), i = parseInt(r, 10);
                n.hookSelectNode({folderNode: r,folderId: i}), e.stopPropagation()
            })
        },hookTreeLoaded: function() {
        },hookSelectNode: function(e) {
        },makeJSTreeId: function(e, t) {
            return "#" + e + (t ? t : "_folder")
        },selectNode: function(e, t) {
            var n = e;
            isNaN(e) || (n = this.makeJSTreeId(e, t));
            var r = null, i = this.getSelectedNode();
            i && (r = "#" + i.attr("id")), r != n && (this.clearFolders(), this.closeAllNodes(), this.$el.jstree("select_node", n))
        },openNode: function(e, t) {
            var n = e;
            isNaN(e) || (n = this.makeJSTreeId(e, t)), this.$el.jstree("open_node", n)
        },closeAllNodes: function() {
            $(this.el).find("li.jstree-open").removeClass("open").addClass("jstree-closed")
        },clearFolders: function() {
            $(this.tree.treeElement).jstree("get_selected").find("a.selectedNode").removeClass("selectedNode")
        },getSelectedNode: function() {
        },getDialogId: function(e) {
            switch (e) {
                case "remove":
                case "delete":
                    return this.dialogs.remove.id;
                case "rename":
                    return this.dialogs.rename.id;
                case "add":
                    return this.dialogs.add.id;
                default:
                    return !1
            }
        },checkArguments: function(e) {
            if (e == undefined)
                throw new this.constructor.ArgError("arguments", "certain arguments are required");
            if (e && e.className == undefined)
                throw new this.constructor.ArgError("className", "className must be defined");
            if (e && e.folder_api_url == undefined)
                throw new this.constructor.ArgError("folder_api_url", "folder_api_url must be defined");
            if (e && typeof e.folder_api_url != "function")
                throw new this.constructor.ArgError("folder_api_url", "folder_api_url must be a function");
            if (e.tree_widget == undefined)
                throw new this.constructor.ArgError("tree_widget", "tree_widget must be defined");
            if (e && e.tree_options == undefined)
                throw new this.constructor.ArgError("tree_options", "tree_options must be defined");
            return !0
        },initialize: function(e) {
            var t = this.dialogs;
            if (!this.checkArguments(e))
                return !1;
            this.unique_id = (new Date).getTime(), e && e.folder_actions && (this.folderActionsEnabled = !0, e.folder_actions.rename && (t.rename.id = "renameFolderDialog_" + this.unique_id, t.rename.name_id = "renameFolderName_" + this.unique_id), e.folder_actions.add && (t.add.id = "addSubFolderDialog_" + this.unique_id, t.add.name_id = "subFolderName_" + this.unique_id), e.folder_actions.remove && (t.remove.id = "deleteFolderDialog_" + this.unique_id), delete e.folder_actions), _.bindAll(this, "render", "addFolderWidget", "loadFolders", "selectNode", "getSelectedNode", "closeAllNodes", "clearFolders", "hookTreeLoaded", "hookSelectNode", "getDialogId", "addFolderDialog", "addRenameDialog", "addRemoveDialog"), _.extend(this, e)
        }}, {ArgError: function(e, t) {
            this.param = e, this.message = t
        },error_messages: {cannot_save_folder: "Cannot save folder",duplicate_name: "Duplicate name.",change_name_try_again: "Change the name and try again.",unknown_error: "An error occured.",delete_folder: "Delete Folder",cannot_delete_folder: "Cannot delete.",cannot_delete_folder_message: "You cannot delete this folder.  It contains traits or another folder.  Move or delete the contents first.",duplicate_folder_name: "Duplicate name."}})
}), define("modules/DataSource/Collections/DataSourcesForTraits", ["backbone", "modules/DataSource/Collections/DataSources", "adobe", "globals"], function(e, t, n, r) {
    var i, s;
    return arguments.length == 0 ? (i = ADOBE.AM.pid, s = ADOBE.AM.API, e = Backbone, t = ADOBE.AM.DataSource.Collections.DataSources) : (i = r.pid, s = n.AM.API), t.extend({url: function() {
            return s.DATASOURCES.dataSources_traits.url()
        }})
}), define("adobe_am/trait_builder/routers/listPageRouter", ["backbone", "backbone.marionette"], function(e, t) {
    return e.Marionette.AppRouter.extend({appRoutes: {"": "showListPage","show/list": "showListPage"}})
}), define("adobe_am/trait_builder/controllers/listPageController", ["adobe_am/vent"], function(e) {
    return {showListPage: function() {
            e.trigger("show:listpage")
        }}
}), define("adobe_am/trait_builder/views/listPageToolbar", ["backbone", "backbone.marionette", "underscore", "app", "adobe_am/vent", "adobe", "adobe.templates", "globals"], function(e, t, n, r, i, s, o, u) {
    var a = s.AM, f = a.UTILS, l = null, c = e.Marionette.ItemView.extend({template: n.template(o.trait_builder.list_page_toolbar_buttons),events: {"click ul li.delete_algotrait": "deleteTrait","click ul li.clone_algotrait": "cloneTrait","click ul li.edit_algotrait": "editTrait","click ul li.createModelWithTrait": "createModelWithTrait","click ul li.deleteSelected": "deleteSelected","click ul li.createSegmentWithTraits": "createSegmentWithTraits"},id: "toolbarDiv",createSegmentWithTraits: function() {
            i.trigger("button:create_segment_selected")
        },deleteSelected: function() {
            i.trigger("button:delete_selected")
        },createModelWithTrait: function() {
            i.trigger("button:create_model_selected")
        },editTrait: function() {
            i.trigger("show:edit")
        },cloneTrait: function() {
            i.trigger("show:clone")
        },createTrait: function(e) {
            return i.trigger("show:createpage", e), !1
        },ruleBasedTrait: function() {
            return i.trigger("show:new", "rulebased"), !1
        },deleteTrait: function() {
            return i.trigger("delete:trait"), !1
        },render: function() {
            var e = {};
            l.can_create_trait && (e.add = !0), l.can_create_model_with_trait && (e.create_model = !0), l.can_show_delete_toolbar_button_in_traitbuilder && (e.can_show_delete = !0), l.can_show_add_segment_toolbar_button_in_traitbuilder && (e.can_show_segment = !0), this.$el.html(this.template({data: e}))
        },onShow: function() {
            this.$el.find(".am-aui-menu a").click(function(t) {
                t.preventDefault(), e.history.navigate($(this).attr("href"), {trigger: !0})
            })
        }});
    return function(e) {
        var t = null;
        return e && e.model && (t = e.model), e && e.permissions && (l = e.permissions), new c
    }
}), define("adobe_am/trait_builder/list", ["backbone", "backbone.marionette", "adobe", "adobe_am/trait_builder/views/listPageLayout", "modules/Trait/Collections/PaginatedTraits", "modules/Trait/Models/Trait", "adobe_am/trait_builder/views/traitTable", "modules/Widget/Views/SearchField", "modules/Widget/Views/PaginatedView", "modules/Widget/Views/FolderTree", "modules/DataSource/Collections/DataSourcesForTraits", "adobe_am/trait_builder/routers/listPageRouter", "adobe_am/trait_builder/controllers/listPageController", "adobe_am/vent", "adobe_am/trait_builder/views/listPageToolbar", "globals"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v) {
    var m = {}, g = null, y = null, b = new i, w = new l, E = null, S = null, x = null, T = [];
    b.setParams({includePermissions: !0});
    var N = function() {
        var e = n.AM.UTILS.HELPERS.cookieHandler, t = e.load("list_page_prefs");
        if (t == null) {
            p.trigger("search:start");
            return
        }
        typeof t.action != undefined && (t.action == "search" ? (t.cached_value.search && S.aui_reference.set("value", t.cached_value.search), p.trigger("search:start")) : t.action == "folder" && typeof t.cached_value.folder != "undefined" && T.push(function() {
            setTimeout(function() {
                E.selectNode(t.cached_value.folder)
            }, 300)
        }))
    }, C = function() {
        n.AM.UTILS.HELPERS.switchPage("list");
        var e = new r;
        p.trigger("title:change", {title: "List Traits"}), y != null && n.AM.LoadingOverlay.flush("traits_table"), g.main.show(e), e.toolbar.show(new d({permissions: g.user.checked_perms})), S = new u({template: _.template('<div id="trait_search"></div>'),el: ".trait_search",collection: b,aui_args: {parent: "trait_search"},beforeSearch: function() {
                n.AM.UTILS.HELPERS.cookieHandler.save("list_page_prefs", {cached_value: {search: S.aui_reference.get("value")},action: "search"}), this.query_string_args && (this.query_string_args.folderId = null), L(!0)
            },afterSearch: function(e) {
                e.length || p.trigger("list:loaded")
            }});
        var t = w.fetch();
        t.done(function(t) {
            x = new o({collection: b,dataSources: t,permission_checker: g.GateKeeper,user_permission: g.user.permissions}), e.traits_list.show(x)
        }).fail(function(e) {
            var t = "";
            try {
                var r = JSON.parse(e.responseText), i = r.childMessages;
                t = r.message;
                if (i) {
                    var s = "<ul>";
                    _.each(i, function(e) {
                        s += "<li>" + e + "</li>"
                    }), s += "</ul>", t += s
                }
            } catch (o) {
                t = n.AM.MESSAGES.getMessage("generic_error").message
            }
            p.trigger("modal:show", {type: "error",message: t}), p.trigger("show:listpage")
        });
        var i = new a({parent_element: $("#trait_pagination"),collection: b,beforeEventClick: function() {
            },afterRender: function() {
            }});
        i.render(), E = new f({className: "traits_folder_tree",tree_widget: n.AM.hierarchy_tree,folder_api_url: n.AM.API.TRAITS.folders.url,folder_actions: {rename: !0,remove: !0,add: !0},tree_options: {initially_open: 0,inc3rdParty: !0,foldersOnly: !0,formatData: function(e) {
                    var t = [];
                    return $.each(e, function(e, r) {
                        var i = n.AM.UTILS.HELPERS.formatFolderHierarchy(r);
                        t.push(i)
                    }), t
                }},parentElement: ".trait_sidebar",hookTreeLoaded: function() {
                if (T.length) {
                    var e = null;
                    while (e = T.shift())
                        e()
                }
            },hookSelectNode: function(e) {
                p.trigger("TraitFolderSelectReceived", e), n.AM.UTILS.HELPERS.cookieHandler.save("list_page_prefs", {cached_value: {folder: e.folderId},action: "folder"})
            }}), E.render(), N()
    }, k = 0, L = function(e) {
        y = n.AM.LoadingOverlay.config({id: "traits_table",parent_element: $(".col2.container"),message: "Loading..."}), e ? y.show() : y.hide()
    };
    return m.begin = function(e) {
        g = e;
        var t = new c({controller: h})
    }, p.on("show:listpage", C), p.on("TraitFolderSelectReceived", function(e) {
        L(!0), b.setParams({query: null,folderId: e.folderId}), b.resetPagination(), b.fetch({success: function() {
                L(!1)
            },error: function(e, t) {
                typeof t == "object" && t.readyState != 0 && t.statusText != "abort" && L(!1)
            }})
    }), p.on("search:start", function() {
        L(!0), S.triggerSearch()
    }), p.on("list:loaded", function() {
        L(!1)
    }), p.on("list:reload:traits", function(e) {
        var t = e && e.cb ? e.cb : function() {
        };
        b.fetch({success: function() {
                t(), L(!1)
            },error: function() {
                t(), L(!1)
            }})
    }), p.on("button:create_segment_selected", function() {
        var e = 0;
        x.itemView && x.itemView.checked_traits && (e = x.itemView.checked_traits), e.length === 0 ? p.trigger("modal:show", {type: "notice",message: n.AM.MESSAGES.getMessage("traits_no_selected").message}) : window.location.href = v.segment_create_page_with_traits + e.join(",")
    }), p.on("button:create_model_selected", function() {
        var e = 0;
        x.itemView && x.itemView.checked_traits && (e = x.itemView.checked_traits);
        switch (e.length) {
            case 0:
                p.trigger("modal:show", {type: "notice",message: n.AM.MESSAGES.getMessage("trait_no_model_selected").message});
                break;
            case 1:
                var t, r = g.trait_dpids_for_model_creation;
                if (r.length) {
                    t = b.get(e[0]).get("dataSourceId");
                    if (_.indexOf(r, t) > -1) {
                        window.location.href = v.model_create_page_with_trait + e[0];
                        break
                    }
                }
                p.trigger("modal:show", {type: "notice",message: n.AM.MESSAGES.getMessage("cannot_create_model_with_trait").message});
                break;
            default:
                p.trigger("modal:show", {type: "notice",message: n.AM.MESSAGES.getMessage("too_many_traits_selected").message})
        }
    }), p.on("button:delete_selected", function() {
        var e = 0, t = "", r = [], i = [], s = !1, o = function() {
            p.trigger("modal:show", {type: "loading"}), n.AM.API.TRAITS.bulkDelete.method({success: function() {
                    p.trigger("list:reload:traits", {cb: function() {
                            x.itemView.checked_traits = [], p.trigger("modal:hide")
                        }})
                },error: function(e, t, r) {
                    var i = n.AM.MESSAGES.getAPIErrorMessage(e, {codePrefix: "traits_"});
                    p.trigger("modal:show", {type: "error",message: i})
                },ids: i})
        };
        x.itemView && x.itemView.checked_traits && (e = x.itemView.checked_traits);
        var u = b.filter(function(t) {
            return _.indexOf(e, t.get("sid")) > -1
        });
        if (e.length === 0) {
            p.trigger("modal:show", {type: "notice",message: n.AM.MESSAGES.getMessage("traits_no_model_selected").message});
            return
        }
        _.each(u, function(e) {
            try {
                g.GateKeeper.checkPermissions([g.user.permissions, e.relational.permissions], "can_delete_trait") ? i.push(e.get("sid")) : r.push(e.get("sid"))
            } catch (t) {
                n.AM.UTILS.LOGGER.log("Error in bulk delete: " + t.message), s = !0
            }
        });
        if (s) {
            p.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("error_in_trait_bulk_delete").message});
            return
        }
        r.length > 0 && (t += n.AM.MESSAGES.getMessage("traits_cannot_be_deleted").message, _.each(r, function(e) {
            t += "<br /> - " + e
        }), t += "<br /><br />");
        if (i.length === 0) {
            t = n.AM.MESSAGES.getMessage("traits_cannot_be_deleted_no_permissions").message, p.trigger("modal:show", {type: "error",message: t});
            return
        }
        t += e.length === 1 ? n.AM.MESSAGES.getMessage("delete_trait").message : n.AM.MESSAGES.getMessage("delete_traits").message, p.trigger("modal:show", {type: "notice",message: t,buttons: [{text: "OK",className: "primary",onClick: o}, {text: "Cancel",className: "secondary",onClick: function() {
                        p.trigger("modal:hide")
                    }}]})
    }), m
}), define("modules/Widget/Views/Accordion", ["backbone", "aui"], function(e, t) {
    return e == undefined && (e = Backbone), t == undefined && (t = AUI), e.View.extend({renderSubViews: function() {
            var e = this;
            _.each(this.sub_views, function(t) {
                t.render(e.el)
            })
        },hasBeenRendered: function() {
            return this.isRendered
        },initialize: function(e) {
            var n = null;
            return _.bindAll(this, "render"), _.bindAll(this, "renderSubViews"), _.bindAll(this, "hasBeenRendered"), _.bindAll(this, "isVisible"), this.isRendered = !1, this.sub_views = e.sub_views, this.lazy_load_views = e.lazy_load_views, e.help && (this.help = e.help), n = {title: e.title,parent: e.parent}, e.aui_args && _.extend(n, e.aui_args), this.panel = new t.CollapsiblePanel(n), !0
        },isVisible: function() {
            return this.$el.is("visible")
        },render: function() {
            var e = this;
            return this.panel.on("change:expanded", function() {
            }), this.panel.render(), this.el = this.panel.el("content"), this.$el = $(this.el), this.renderSubViews(), this.isRendered = !0, this.help && !$(this.panel.el("title")).find(".context-help").length && $(this.panel.el("title")).append($('<span class="context-help" title="Help" data-id="' + this.help + '">&nbsp;</span>')), this
        }})
}), define("modules/Model/Collections/PaginatedModels", ["backbone", "modules/Common/Collections/PaginatedItems", "modules/Model/Models/AlgoModel", "adobe", "globals"], function(e, t, n, r, i) {
    var s, o;
    return arguments.length == 0 ? (t = ADOBE.AM.Common.Collections.PaginatedItems, n = ADOBE.AM.Model.Models.AlgoModel, o = ADOBE.AM.API, s = ADOBE.AM.pid, e = Backbone) : (s = i.pid, o = r.AM.API), t.extend({model: n,pendingRequest: {},custom_query_string_params: {},sync: function(e, n, r) {
            var i = r.data || {};
            return _.extend(i, this.custom_query_string_params), r.data = i, r.url = this.url, this.pendingRequest && this.pendingRequest.readyState && this.pendingRequest.readyState != 4 && this.pendingRequest.abort(), this.pendingRequest = t.prototype.sync(e, n, r), this.pendingRequest
        },url: o.MODELS.algo_model.url(),bulkDelete: function(e) {
            if (e == undefined || !_.isArray(e) || e.length == 0)
                return !1;
            var t = _.difference(e, this.pluck("id"));
            if (t.length)
                return !1;
            var n = o.MODELS.bulk_delete.url(), r = $.ajax({dataType: "json",contentType: "application/json",url: n,type: "POST",data: JSON.stringify(e)});
            return r
        }})
}), define("modules/Algorithm/Collections/Algorithms", ["backbone", "modules/Algorithm/Models/Algorithm", "adobe", "globals"], function(e, t, n, r) {
    var i, s;
    return arguments.length == 0 ? (i = ADOBE.AM.pid, e = Backbone, t = ADOBE.AM.Algorithm.Models.Algorithm, api = ADOBE.AM.API) : (i = r.pid, api = n.AM.API), typeof e == undefined && (i = r.pid, s = null), e.Collection.extend({model: t,url: api.MODELS.algorithms.url()})
}), define("modules/Widget/Views/Table", ["backbone"], function(e) {
    return e == undefined && (e = Backbone), e.View.extend({events: {"click thead th.sortable": "tableColumnHeaderClick","click thead th.column_checkbox": "tableColumnCheckboxClick"},query_params: {},tableColumnCheckboxClick: function(e) {
            var t = $(e.currentTarget), n = t.hasClass("enabled") || !1;
            n ? (t.removeClass("enabled").addClass("disabled"), this.collection.each(function(e) {
                e.get("checked") && e.set({checked: !1})
            })) : (t.removeClass("disabled").addClass("enabled"), this.collection.each(function(e) {
                e.get("checked") || e.set({checked: !0})
            }))
        },tableColumnHeaderClick: function(e) {
            var t = $(e.currentTarget), n = function() {
            }, r = t.data("type");
            t.hasClass("desc") ? (this.$table_col_headers.removeClass("desc asc"), t.addClass("asc"), n = function(e, t) {
                return e.get(r) == t.get(r) ? 0 : e.get(r) < t.get(r) ? -1 : 1
            }) : (this.$table_col_headers.removeClass("desc asc"), t.addClass("desc"), n = function(e, t) {
                return e.get(r) == t.get(r) ? 0 : e.get(r) < t.get(r) ? 1 : -1
            }), this.collection.comparator = n, this.collection.sort(), this.onBeforeSort()
        },initialize: function(e) {
            var t = this.collection || null;
            _.bindAll(this, "addOne"), _.bindAll(this, "addAll"), _.bindAll(this, "remove"), _.bindAll(this, "render"), _.bindAll(this, "emptyTable"), _.extend(this, e), this.$table_col_headers = this.$el.find("th"), this.$table_body = this.$el.find("tbody"), t && (t.on("add", this.addOne, this), t.on("reset", this.addAll, this), t.on("all", this.render, this))
        },onBeforeSort: function() {
        },onAfterSort: function() {
        },render: function() {
        },emptyTable: function() {
            this.$table_body.empty()
        },addAll: function() {
            this.emptyTable();
            if (this.collection.length > 0)
                this.collection.each(this.addOne);
            else {
                var e = this.$table_col_headers.length;
                this.$table_body.html('<tr><td colspan="' + e + '">' + "No results returned" + "</td></tr>")
            }
            this.onAfterSort()
        },addOne: function(e) {
            var t = new this.new_row({model: e});
            this.$table_body.append(t.render().el)
        }})
}), define("modules/Widget/Views/PaginatedTable2", ["modules/Widget/Views/Table"], function(e) {
    return e == undefined && (e = ADOBE.AM.Widget.Views.Table), e.extend({tableColumnCheckboxClick: function(e) {
            var t = this, n = $(e.currentTarget), r = n.hasClass("enabled") || !1;
            r ? (n.removeClass("enabled").addClass("disabled"), this.collection.each(function(e) {
                if (e.get("checked")) {
                    e.set({checked: !1});
                    var n = $.inArray(e.get("sid"), t.checkedRows);
                    t.checkedRows.splice(n, 1), t.cache && t.cache.cache.splice(n, 1)
                }
            })) : (n.removeClass("disabled").addClass("enabled"), this.collection.each(function(e) {
                e.get("checked") || (e.set({checked: !0}), t.checkedRows.push(e.get("sid")), t.cache && t.cache.addTrait(e.toJSON()))
            }))
        },tableColumnHeaderClick: function(e) {
            var t = null, n = $(e.currentTarget), r = n.data("sortby");
            n.hasClass("desc") ? (t = !0, this.$table_col_headers.removeClass("desc asc"), n.addClass("asc")) : (t = !1, this.$table_col_headers.removeClass("desc asc"), n.addClass("desc")), this.collection.resetPagination(), this.collection.setParams(_.extend(this.query_params, {customParam1: t,sortField: r,includePermissions: !0})), this.collection.pager(), this.onBeforeSort()
        }})
}), define("modules/Model/Views/ModelsModal", ["backbone", "backbone.marionette", "modules/Model/Collections/PaginatedModels", "modules/Algorithm/Collections/Algorithms", "modules/Widget/Views/SearchField", "modules/Widget/Views/PaginatedTable2", "modules/Widget/Views/PaginatedView", "modules/Model/Models/AlgoModel", "modules/Model/Models/ModelPermission", "adobe", "adobe_am/vent"], function(e, t, n, r, i, s, o, u, a, f, l) {
    if (arguments.length == 0)
        return;
    var c = new f.AM.UTILS.GATEKEEPER;
    c.setPermissionClass(a), c.setErrorTypes(f.AM.UTILS.ERRORS.TYPES), c.setSchemes(f.AM.PERMS.permission_schemes);
    var n = new n({hook_parse: function(e) {
            var t = _.filter(e.list, function(e) {
                var t = new a({permissions: e.permissions});
                return c.checkPermissions([t], "can_view_model")
            });
            return e.list = t, e
        }}), h = document.createElement("button"), p = document.createElement("button"), d = document.createElement("div");
    h.className = "primary", h.innerHTML = "Add Selected Model to Trait", p.className = "secondary", p.innerHTML = "Cancel", AUI.addListener(h, "click", function(e) {
        var t = $("input[name=selected_model]:radio:checked").val(), r = n.get(t);
        if (r && !r.wasLastRunSuccessfulWithData())
            return l.trigger("modal:show", {type: "notice",message: f.AM.MESSAGES.getMessage("model_run_once").message}), !1;
        if (!t)
            return l.trigger("modal:show", {type: "notice",message: "You have not selected a model to add."}), !1;
        var i = n.get(t);
        l.trigger("modal:model:selected", i)
    }), AUI.addListener(p, "click", function() {
        l.trigger("modal:models:hide")
    }), d.appendChild(h), d.appendChild(p);
    var v = new AUI.Dialog({header: "Browse All Models",width: "1026px",height: "780px",footer: d,center: !0,zIndex: 1003}), m = !1, g = new r({}), y = function() {
        $("body").addClass("disableMainScroll");
        if (m) {
            v.render().show();
            return
        }
        g.fetch().always(b)
    }, b = function() {
        v.render().show(), v.append("content", APP.templates.browse_models_modal), $(".AUI_CloseButton").click(function() {
            $("body").removeClass("disableMainScroll")
        });
        var t = new i({el: $(".models_search"),collection: n,query_string_args: {includeMetrics: !0,includePermissions: !0},beforeSearch: function() {
                E(!0)
            },afterSearch: function(e) {
                E(!1);
                if (e.status == 404)
                    return l.trigger("modal:show", {type: "notice",message: f.AM.MESSAGES.getMessage("generic_404").message}), l.trigger("modal:models:hide"), !1
            }}), r = new s({el: $("#models_table"),query_params: {includeMetrics: !0},collection: n,new_row: e.View.extend({initialize: function() {
                    _.bindAll(this, "checkbox"), this.model.bind("change", this.render, this)
                },tagName: "tr",events: {"click .result_checkbox": "checkbox"},checkbox: function(e) {
                },template: APP.templates.model_table_row,templateHelpers: {formatTimestamp: function(e) {
                        var t = "";
                        if (e)
                            try {
                                t = f.AM.UTILS.HELPERS.formatDate(e, function(e, t, n) {
                                    return (e[1] ? e : "0" + e[0]) + "/" + (t[1] ? t : "0" + t[0]) + "/" + n
                                })
                            } catch (n) {
                                f.AM.UTILS.LOGGER.log("ModelsTable:formatTimestamp: " + n.message), t = ""
                            }
                        return t
                    },displayAlgorithm: function(e) {
                        var t = g.get(e);
                        return t ? t.getName() : e
                    },displayStatus: function(e) {
                        return u.getStatusName(e)
                    }},render: function() {
                    var e = this.model, t = {t: e};
                    return _.extend(t, this.templateHelpers), this.$el.html(_.template(this.template, t)), this
                }}),onBeforeSort: function() {
                E(!0)
            },onAfterSort: function() {
                E(!1)
            },checkedRows: []}), a = new o({parent_element: $(".AUI_Dialog_footer div"),collection: n,beforeEventClick: function() {
                E(!0)
            },afterRender: function() {
                E(!1)
            }});
        t.triggerSearch(), m = !0
    }, w = 0, E = function(e) {
        var t = f.AM.LoadingOverlay.config({id: "models_modal_table",parent_element: $(".models_list"),message: "Loading..."});
        if (e)
            w == 0 ? (t.show(), w = 1) : w += 1;
        else if (w == 1)
            t.hide(), w = 0;
        else {
            if (w == 0)
                return !1;
            w -= 1
        }
    };
    l.on("modal:models:show", function() {
        y()
    }), l.on("modal:models:hide", function() {
        $("body").removeClass("disableMainScroll"), v.hide()
    })
}), define("adobe_am/trait_builder/views/createPageLayout", ["backbone", "backbone.marionette", "underscore", "app", "adobe", "adobe.templates", "adobe_am/vent", "globals"], function(e, t, n, r, i, s, o, u) {
    var r = r || APP;
    return e.Marionette.Layout.extend({tagName: "form",id: "form_trait",template: n.template(s.trait_builder.page.create_edit_page),regions: null,traitType: null,selected_reach_accuracy_model: null,newTrait: null,initialize: function(e) {
            this.traitType = e.type, this.traitType == "rule" || this.traitType == "onboarded" ? this.regions = {accordion_basicinfo: "#accordion_basicinfo",accordion_advanced: "#accordion_second",accordion_traitexp: "#accordion_traitexp"} : this.regions = {accordion_basicinfo: "#accordion_basicinfo",accordion_config: "#accordion_second"}, this.selected_reach_accuracy_model = e.selected_reach_accuracy_model, this.newTrait = e.newTrait
        },events: {"click button.save": "saveTrait","click button.cancel": "eventCancel"},saveTrait: function() {
            o.trigger("trait:save")
        },eventCancel: function() {
            e.history.navigate("#show/list", !0)
        },onShow: function() {
            i.AM.UTILS.HELPERS.bindContextHelp()
        },render: function() {
            var e;
            switch (this.traitType) {
                case "algo":
                    e = "Algorithmic";
                    break;
                case "onboarded":
                    e = "Onboarded";
                    break;
                case "rule":
                    e = "Rule-based";
                    break;
                default:
                    e = "Rule-based"
            }
            $(this.parentElement).append($(this.el).html(this.template({type: e})))
        }})
}), define("adobe_am/trait_builder/views/createPageBasicInfoAccordionLayout", ["backbone", "backbone.marionette", "adobe.templates"], function(e, t, n) {
    if (arguments.length == 0)
        return;
    return e.Marionette.Layout.extend({className: "padding",template: _.template(n.algo_trait.page.basic_info_accordion),regions: {basic_inputs: "#basic_inputs",traits_storage: "#traits_storage",categories: "#categories"}})
}), define("adobe_am/trait_builder/views/createPageConfigAccordionLayout", ["backbone", "backbone.marionette", "adobe.templates"], function(e, t, n) {
    if (arguments.length == 0)
        return;
    return e.Marionette.Layout.extend({className: "conf_layout",template: _.template(n.algo_trait.page.configuration_accordion),regions: {select_model: ".select_model",reach_accuracy: ".reach_accuracy",adjust_reach_accuracy: ".adjust_reach_accuracy"}})
}), define("adobe_am/trait_builder/views/createPageBasicInputsView", ["backbone", "backbone.marionette", "adobe.templates"], function(e, t, n) {
    if (arguments.length == 0)
        return;
    return e.Marionette.ItemView.extend({className: "create_basic_info_itemview",template: _.template(n.algo_trait.page.basic_inputs),templateHelpers: {isAlgoTrait: function() {
                return this.traitType === "ALGO_TRAIT"
            }},render: function() {
            _.extend(this.options, this.templateHelpers), this.$el.append(this.template(this.options))
        }})
}), define("adobe_am/trait_builder/views/createPageTraitsStorageView", ["backbone", "backbone.marionette", "modules/Trait/Models/Trait", "adobe_am/vent", "adobe.templates", "globals"], function(e, t, n, r, i, s) {
    if (arguments.length == 0)
        return;
    return e.Marionette.CompositeView.extend({template: _.template(i.algo_trait.page.traits_storage),events: {"click li": "selectFolder"},selectFolder: function(e) {
            e.stopPropagation();
            var t = e.currentTarget.getAttribute("id"), n = parseInt(t, 10);
            $("input[name=folderId]").val(n)
        }})
}), define("adobe_am/trait_builder/views/createPageCategoriesView", ["backbone", "backbone.marionette", "adobe.templates"], function(e, t, n) {
    if (arguments.length == 0)
        return;
    return e.Marionette.CompositeView.extend({template: _.template(n.algo_trait.page.data_category),events: {"click li": "selectFolder"},selectFolder: function(e) {
            e.stopPropagation();
            var t = e.currentTarget.getAttribute("id"), n = parseInt(t, 10);
            $("input[name=categoryId]").val(n)
        }})
}), define("adobe_am/trait_builder/views/createPageAdvancedOptionsView", ["backbone", "backbone.marionette", "adobe.templates"], function(e, t, n) {
    if (arguments.length == 0)
        return;
    return e.Marionette.ItemView.extend({className: "create_advanced_options_itemview",template: _.template(n.trait_builder.page.create_page.advanced_options),render: function() {
            this.$el.append(this.template(_.extend(this.model.toJSON(), this.options)))
        }})
}), define("adobe_am/trait_builder/views/createPageSelectModelView", ["backbone", "backbone.marionette", "adobe.templates", "adobe_am/vent"], function(e, t, n, r) {
    if (arguments.length == 0)
        return;
    return e.Marionette.ItemView.extend({id: "select_model",template: _.template(n.algo_trait.select_model),events: {"click button#browse_all_models": "browseAllModels"},browseAllModels: function(e) {
            e.preventDefault(), r.trigger("modal:models:show")
        },templateHelpers: {isEditMode: function() {
            },isCreateMode: function() {
            }},render: function(e) {
            var t = typeof e == "object" && typeof e.name != "undefined" ? e.name : "";
            this.$el.html(this.template(_.extend({name: t}, this.templateHelpers)))
        }})
}), function(e) {
    e.color = {}, e.color.make = function(t, n, r, i) {
        var s = {};
        return s.r = t || 0, s.g = n || 0, s.b = r || 0, s.a = i != null ? i : 1, s.add = function(e, t) {
            for (var n = 0; n < e.length; ++n)
                s[e.charAt(n)] += t;
            return s.normalize()
        }, s.scale = function(e, t) {
            for (var n = 0; n < e.length; ++n)
                s[e.charAt(n)] *= t;
            return s.normalize()
        }, s.toString = function() {
            return s.a >= 1 ? "rgb(" + [s.r, s.g, s.b].join(",") + ")" : "rgba(" + [s.r, s.g, s.b, s.a].join(",") + ")"
        }, s.normalize = function() {
            function e(e, t, n) {
                return t < e ? e : t > n ? n : t
            }
            return s.r = e(0, parseInt(s.r), 255), s.g = e(0, parseInt(s.g), 255), s.b = e(0, parseInt(s.b), 255), s.a = e(0, s.a, 1), s
        }, s.clone = function() {
            return e.color.make(s.r, s.b, s.g, s.a)
        }, s.normalize()
    }, e.color.extract = function(t, n) {
        var r;
        do {
            r = t.css(n).toLowerCase();
            if (r != "" && r != "transparent")
                break;
            t = t.parent()
        } while (!e.nodeName(t.get(0), "body"));
        return r == "rgba(0, 0, 0, 0)" && (r = "transparent"), e.color.parse(r)
    }, e.color.parse = function(n) {
        var r, i = e.color.make;
        if (r = /rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/.exec(n))
            return i(parseInt(r[1], 10), parseInt(r[2], 10), parseInt(r[3], 10));
        if (r = /rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))
            return i(parseInt(r[1], 10), parseInt(r[2], 10), parseInt(r[3], 10), parseFloat(r[4]));
        if (r = /rgb\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*\)/.exec(n))
            return i(parseFloat(r[1]) * 2.55, parseFloat(r[2]) * 2.55, parseFloat(r[3]) * 2.55);
        if (r = /rgba\(\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\%\s*,\s*([0-9]+(?:\.[0-9]+)?)\s*\)/.exec(n))
            return i(parseFloat(r[1]) * 2.55, parseFloat(r[2]) * 2.55, parseFloat(r[3]) * 2.55, parseFloat(r[4]));
        if (r = /#([a-fA-F0-9]{2})([a-fA-F0-9]{2})([a-fA-F0-9]{2})/.exec(n))
            return i(parseInt(r[1], 16), parseInt(r[2], 16), parseInt(r[3], 16));
        if (r = /#([a-fA-F0-9])([a-fA-F0-9])([a-fA-F0-9])/.exec(n))
            return i(parseInt(r[1] + r[1], 16), parseInt(r[2] + r[2], 16), parseInt(r[3] + r[3], 16));
        var s = e.trim(n).toLowerCase();
        return s == "transparent" ? i(255, 255, 255, 0) : (r = t[s] || [0, 0, 0], i(r[0], r[1], r[2]))
    };
    var t = {aqua: [0, 255, 255],azure: [240, 255, 255],beige: [245, 245, 220],black: [0, 0, 0],blue: [0, 0, 255],brown: [165, 42, 42],cyan: [0, 255, 255],darkblue: [0, 0, 139],darkcyan: [0, 139, 139],darkgrey: [169, 169, 169],darkgreen: [0, 100, 0],darkkhaki: [189, 183, 107],darkmagenta: [139, 0, 139],darkolivegreen: [85, 107, 47],darkorange: [255, 140, 0],darkorchid: [153, 50, 204],darkred: [139, 0, 0],darksalmon: [233, 150, 122],darkviolet: [148, 0, 211],fuchsia: [255, 0, 255],gold: [255, 215, 0],green: [0, 128, 0],indigo: [75, 0, 130],khaki: [240, 230, 140],lightblue: [173, 216, 230],lightcyan: [224, 255, 255],lightgreen: [144, 238, 144],lightgrey: [211, 211, 211],lightpink: [255, 182, 193],lightyellow: [255, 255, 224],lime: [0, 255, 0],magenta: [255, 0, 255],maroon: [128, 0, 0],navy: [0, 0, 128],olive: [128, 128, 0],orange: [255, 165, 0],pink: [255, 192, 203],purple: [128, 0, 128],violet: [128, 0, 128],red: [255, 0, 0],silver: [192, 192, 192],white: [255, 255, 255],yellow: [255, 255, 0]}
}(jQuery), function(e) {
    function t(t, r, s, o) {
        function N(e, t) {
            t = [T].concat(t);
            for (var n = 0; n < e.length; ++n)
                e[n].apply(this, t)
        }
        function C() {
            for (var t = 0; t < o.length; ++t) {
                var n = o[t];
                n.init(T), n.options && e.extend(!0, f, n.options)
            }
        }
        function k(t) {
            var n;
            e.extend(!0, f, t), f.xaxis.color == null && (f.xaxis.color = f.grid.color), f.yaxis.color == null && (f.yaxis.color = f.grid.color), f.xaxis.tickColor == null && (f.xaxis.tickColor = f.grid.tickColor), f.yaxis.tickColor == null && (f.yaxis.tickColor = f.grid.tickColor), f.grid.borderColor == null && (f.grid.borderColor = f.grid.color), f.grid.tickColor == null && (f.grid.tickColor = e.color.parse(f.grid.color).scale("a", .22).toString());
            for (n = 0; n < Math.max(1, f.xaxes.length); ++n)
                f.xaxes[n] = e.extend(!0, {}, f.xaxis, f.xaxes[n]);
            for (n = 0; n < Math.max(1, f.yaxes.length); ++n)
                f.yaxes[n] = e.extend(!0, {}, f.yaxis, f.yaxes[n]);
            f.xaxis.noTicks && f.xaxis.ticks == null && (f.xaxis.ticks = f.xaxis.noTicks), f.yaxis.noTicks && f.yaxis.ticks == null && (f.yaxis.ticks = f.yaxis.noTicks), f.x2axis && (f.xaxes[1] = e.extend(!0, {}, f.xaxis, f.x2axis), f.xaxes[1].position = "top"), f.y2axis && (f.yaxes[1] = e.extend(!0, {}, f.yaxis, f.y2axis), f.yaxes[1].position = "right"), f.grid.coloredAreas && (f.grid.markings = f.grid.coloredAreas), f.grid.coloredAreasColor && (f.grid.markingsColor = f.grid.coloredAreasColor), f.lines && e.extend(!0, f.series.lines, f.lines), f.points && e.extend(!0, f.series.points, f.points), f.bars && e.extend(!0, f.series.bars, f.bars), f.shadowSize != null && (f.series.shadowSize = f.shadowSize);
            for (n = 0; n < f.xaxes.length; ++n)
                P(m, n + 1).options = f.xaxes[n];
            for (n = 0; n < f.yaxes.length; ++n)
                P(g, n + 1).options = f.yaxes[n];
            for (var r in x)
                f.hooks[r] && f.hooks[r].length && (x[r] = x[r].concat(f.hooks[r]));
            N(x.processOptions, [f])
        }
        function L(e) {
            u = A(e), H(), B()
        }
        function A(t) {
            var n = [];
            for (var r = 0; r < t.length; ++r) {
                var i = e.extend(!0, {}, f.series);
                t[r].data != null ? (i.data = t[r].data, delete t[r].data, e.extend(!0, i, t[r]), t[r].data = i.data) : i.data = t[r], n.push(i)
            }
            return n
        }
        function O(e, t) {
            var n = e[t + "axis"];
            return typeof n == "object" && (n = n.n), typeof n != "number" && (n = 1), n
        }
        function M() {
            return e.grep(m.concat(g), function(e) {
                return e
            })
        }
        function _(e) {
            var t = {}, n, r;
            for (n = 0; n < m.length; ++n)
                r = m[n], r && r.used && (t["x" + r.n] = r.c2p(e.left));
            for (n = 0; n < g.length; ++n)
                r = g[n], r && r.used && (t["y" + r.n] = r.c2p(e.top));
            return t.x1 !== undefined && (t.x = t.x1), t.y1 !== undefined && (t.y = t.y1), t
        }
        function D(e) {
            var t = {}, n, r, i;
            for (n = 0; n < m.length; ++n) {
                r = m[n];
                if (r && r.used) {
                    i = "x" + r.n, e[i] == null && r.n == 1 && (i = "x");
                    if (e[i] != null) {
                        t.left = r.p2c(e[i]);
                        break
                    }
                }
            }
            for (n = 0; n < g.length; ++n) {
                r = g[n];
                if (r && r.used) {
                    i = "y" + r.n, e[i] == null && r.n == 1 && (i = "y");
                    if (e[i] != null) {
                        t.top = r.p2c(e[i]);
                        break
                    }
                }
            }
            return t
        }
        function P(t, n) {
            return t[n - 1] || (t[n - 1] = {n: n,direction: t == m ? "x" : "y",options: e.extend(!0, {}, t == m ? f.xaxis : f.yaxis)}), t[n - 1]
        }
        function H() {
            var t, n = u.length, r = [], i = [];
            for (t = 0; t < u.length; ++t) {
                var s = u[t].color;
                s != null && (--n, typeof s == "number" ? i.push(s) : r.push(e.color.parse(u[t].color)))
            }
            for (t = 0; t < i.length; ++t)
                n = Math.max(n, i[t] + 1);
            var o = [], a = 0;
            t = 0;
            while (o.length < n) {
                var l;
                f.colors.length == t ? l = e.color.make(100, 100, 100) : l = e.color.parse(f.colors[t]);
                var h = a % 2 == 1 ? -1 : 1;
                l.scale("rgb", 1 + h * Math.ceil(a / 2) * .2), o.push(l), ++t, t >= f.colors.length && (t = 0, ++a)
            }
            var p = 0, d;
            for (t = 0; t < u.length; ++t) {
                d = u[t], d.color == null ? (d.color = o[p].toString(), ++p) : typeof d.color == "number" && (d.color = o[d.color].toString());
                if (d.lines.show == null) {
                    var v, y = !0;
                    for (v in d)
                        if (d[v] && d[v].show) {
                            y = !1;
                            break
                        }
                    y && (d.lines.show = !0)
                }
                d.xaxis = P(m, O(d, "x")), d.yaxis = P(g, O(d, "y"))
            }
        }
        function B() {
            function w(e, t, n) {
                t < e.datamin && t != -r && (e.datamin = t), n > e.datamax && n != r && (e.datamax = n)
            }
            var t = Number.POSITIVE_INFINITY, n = Number.NEGATIVE_INFINITY, r = Number.MAX_VALUE, i, s, o, a, f, l, h, p, d, v, m, g, y, b;
            e.each(M(), function(e, r) {
                r.datamin = t, r.datamax = n, r.used = !1
            });
            for (i = 0; i < u.length; ++i)
                l = u[i], l.datapoints = {points: []}, N(x.processRawData, [l, l.data, l.datapoints]);
            for (i = 0; i < u.length; ++i) {
                l = u[i];
                var E = l.data, S = l.datapoints.format;
                if (!S) {
                    S = [], S.push({x: !0,number: !0,required: !0}), S.push({y: !0,number: !0,required: !0});
                    if (l.bars.show || l.lines.show && l.lines.fill)
                        S.push({y: !0,number: !0,required: !1,defaultValue: 0}), l.bars.horizontal && (delete S[S.length - 1].y, S[S.length - 1].x = !0);
                    l.datapoints.format = S
                }
                if (l.datapoints.pointsize != null)
                    continue;
                l.datapoints.pointsize = S.length, p = l.datapoints.pointsize, h = l.datapoints.points, insertSteps = l.lines.show && l.lines.steps, l.xaxis.used = l.yaxis.used = !0;
                for (s = o = 0; s < E.length; ++s, o += p) {
                    b = E[s];
                    var T = b == null;
                    if (!T)
                        for (a = 0; a < p; ++a)
                            g = b[a], y = S[a], y && (y.number && g != null && (g = +g, isNaN(g) ? g = null : g == Infinity ? g = r : g == -Infinity && (g = -r)), g == null && (y.required && (T = !0), y.defaultValue != null && (g = y.defaultValue))), h[o + a] = g;
                    if (T)
                        for (a = 0; a < p; ++a)
                            g = h[o + a], g != null && (y = S[a], y.x && w(l.xaxis, g, g), y.y && w(l.yaxis, g, g)), h[o + a] = null;
                    else if (insertSteps && o > 0 && h[o - p] != null && h[o - p] != h[o] && h[o - p + 1] != h[o + 1]) {
                        for (a = 0; a < p; ++a)
                            h[o + p + a] = h[o + a];
                        h[o + 1] = h[o - p + 1], o += p
                    }
                }
            }
            for (i = 0; i < u.length; ++i)
                l = u[i], N(x.processDatapoints, [l, l.datapoints]);
            for (i = 0; i < u.length; ++i) {
                l = u[i], h = l.datapoints.points, p = l.datapoints.pointsize;
                var C = t, k = t, L = n, A = n;
                for (s = 0; s < h.length; s += p) {
                    if (h[s] == null)
                        continue;
                    for (a = 0; a < p; ++a) {
                        g = h[s + a], y = S[a];
                        if (!y || g == r || g == -r)
                            continue;
                        y.x && (g < C && (C = g), g > L && (L = g)), y.y && (g < k && (k = g), g > A && (A = g))
                    }
                }
                if (l.bars.show) {
                    var O = l.bars.align == "left" ? 0 : -l.bars.barWidth / 2;
                    l.bars.horizontal ? (k += O, A += O + l.bars.barWidth) : (C += O, L += O + l.bars.barWidth)
                }
                w(l.xaxis, C, L), w(l.yaxis, k, A)
            }
            e.each(M(), function(e, r) {
                r.datamin == t && (r.datamin = null), r.datamax == n && (r.datamax = null)
            })
        }
        function j(n, r) {
            var i = document.createElement("canvas");
            return i.className = r, i.width = b, i.height = w, n || e(i).css({position: "absolute",left: 0,top: 0}), e(i).appendTo(t), i.getContext || (i = window.G_vmlCanvasManager.initElement(i)), i.getContext("2d").save(), i
        }
        function F() {
            b = t.width(), w = t.height();
            if (b <= 0 || w <= 0)
                throw "Invalid dimensions for plot, width = " + b + ", height = " + w
        }
        function I(e) {
            e.width != b && (e.width = b), e.height != w && (e.height = w);
            var t = e.getContext("2d");
            t.restore(), t.save()
        }
        function q() {
            var n, r = t.children("canvas.base"), i = t.children("canvas.overlay");
            r.length == 0 || i == 0 ? (t.html(""), t.css({padding: 0}), t.css("position") == "static" && t.css("position", "relative"), F(), l = j(!0, "base"), h = j(!1, "overlay"), n = !1) : (l = r.get(0), h = i.get(0), n = !0), d = l.getContext("2d"), v = h.getContext("2d"), p = e([h, l]), n && (t.data("plot").shutdown(), T.resize(), v.clearRect(0, 0, b, w), p.unbind(), t.children().not([l, h]).remove()), t.data("plot", T)
        }
        function R() {
            f.grid.hoverable && (p.mousemove(pt), p.mouseleave(dt)), f.grid.clickable && p.click(vt), N(x.bindEvents, [p])
        }
        function U() {
            ct && clearTimeout(ct), p.unbind("mousemove", pt), p.unbind("mouseleave", dt), p.unbind("click", vt), N(x.shutdown, [p])
        }
        function z(e) {
            function t(e) {
                return e
            }
            var n, r, i = e.options.transform || t, s = e.options.inverseTransform;
            e.direction == "x" ? (n = e.scale = E / Math.abs(i(e.max) - i(e.min)), r = Math.min(i(e.max), i(e.min))) : (n = e.scale = S / Math.abs(i(e.max) - i(e.min)), n = -n, r = Math.max(i(e.max), i(e.min))), i == t ? e.p2c = function(e) {
                return (e - r) * n
            } : e.p2c = function(e) {
                return (i(e) - r) * n
            }, s ? e.c2p = function(e) {
                return s(r + e / n)
            } : e.c2p = function(e) {
                return r + e / n
            }
        }
        function W(n) {
            function h(r, i) {
                return e('<div style="position:absolute;top:-10000px;' + i + 'font-size:smaller"><div class="' + n.direction + "Axis " + n.direction + n.n + 'Axis">' + r.join("") + "</div></div>").appendTo(t)
            }
            var r = n.options, i, s = n.ticks || [], o = [], u, a = r.labelWidth, f = r.labelHeight, l;
            if (n.direction == "x") {
                a == null && (a = Math.floor(b / (s.length > 0 ? s.length : 1)));
                if (f == null) {
                    o = [];
                    for (i = 0; i < s.length; ++i)
                        u = s[i].label, u && o.push('<div class="tickLabel" style="float:left;width:' + a + 'px">' + u + "</div>");
                    o.length > 0 && (o.push('<div style="clear:left"></div>'), l = h(o, "width:10000px;"), f = l.height(), l.remove())
                }
            } else if (a == null || f == null) {
                for (i = 0; i < s.length; ++i)
                    u = s[i].label, u && o.push('<div class="tickLabel">' + u + "</div>");
                o.length > 0 && (l = h(o, ""), a == null && (a = l.children().width()), f == null && (f = l.find("div.tickLabel").height()), l.remove())
            }
            a == null && (a = 0), f == null && (f = 0), n.labelWidth = a, n.labelHeight = f
        }
        function X(t) {
            var n = t.labelWidth, r = t.labelHeight, i = t.options.position, s = t.options.tickLength, o = f.grid.axisMargin, u = f.grid.labelMargin, a = t.direction == "x" ? m : g, l, h = e.grep(a, function(e) {
                return e && e.options.position == i && e.reserveSpace
            });
            e.inArray(t, h) == h.length - 1 && (o = 0), s == null && (s = "full");
            var p = e.grep(a, function(e) {
                return e && e.reserveSpace
            }), d = e.inArray(t, p) == 0;
            !d && s == "full" && (s = 5), isNaN(+s) || (u += +s), t.direction == "x" ? (r += u, i == "bottom" ? (y.bottom += r + o, t.box = {top: w - y.bottom,height: r}) : (t.box = {top: y.top + o,height: r}, y.top += r + o)) : (n += u, i == "left" ? (t.box = {left: y.left + o,width: n}, y.left += n + o) : (y.right += n + o, t.box = {left: b - y.right,width: n})), t.position = i, t.tickLength = s, t.box.padding = u, t.innermost = d
        }
        function V(e) {
            e.direction == "x" ? (e.box.left = y.left, e.box.width = E) : (e.box.top = y.top, e.box.height = S)
        }
        function $() {
            var t, n = M();
            e.each(n, function(e, t) {
                t.show = t.options.show, t.show == null && (t.show = t.used), t.reserveSpace = t.show || t.options.reserveSpace, J(t)
            }), allocatedAxes = e.grep(n, function(e) {
                return e.reserveSpace
            }), y.left = y.right = y.top = y.bottom = 0;
            if (f.grid.show) {
                e.each(allocatedAxes, function(e, t) {
                    K(t), Q(t), G(t, t.ticks), W(t)
                });
                for (t = allocatedAxes.length - 1; t >= 0; --t)
                    X(allocatedAxes[t]);
                var r = f.grid.minBorderMargin;
                if (r == null) {
                    r = 0;
                    for (t = 0; t < u.length; ++t)
                        r = Math.max(r, u[t].points.radius + u[t].points.lineWidth / 2)
                }
                for (var i in y)
                    y[i] += f.grid.borderWidth, y[i] = Math.max(r, y[i])
            }
            E = b - y.left - y.right, S = w - y.bottom - y.top, e.each(n, function(e, t) {
                z(t)
            }), f.grid.show && (e.each(allocatedAxes, function(e, t) {
                V(t)
            }), nt()), ft()
        }
        function J(e) {
            var t = e.options, n = +(t.min != null ? t.min : e.datamin), r = +(t.max != null ? t.max : e.datamax), i = r - n;
            if (i == 0) {
                var s = r == 0 ? 1 : .01;
                t.min == null && (n -= s);
                if (t.max == null || t.min != null)
                    r += s
            } else {
                var o = t.autoscaleMargin;
                o != null && (t.min == null && (n -= i * o, n < 0 && e.datamin != null && e.datamin >= 0 && (n = 0)), t.max == null && (r += i * o, r > 0 && e.datamax != null && e.datamax <= 0 && (r = 0)))
            }
            e.min = n, e.max = r
        }
        function K(t) {
            var r = t.options, i;
            typeof r.ticks == "number" && r.ticks > 0 ? i = r.ticks : i = .3 * Math.sqrt(t.direction == "x" ? b : w);
            var s = (t.max - t.min) / i, o, u, f, l, h, p, d;
            if (r.mode == "time") {
                var v = {second: 1e3,minute: 6e4,hour: 36e5,day: 864e5,month: 2592e6,year: 525949.2 * 60 * 1e3}, y = [[1, "second"], [2, "second"], [5, "second"], [10, "second"], [30, "second"], [1, "minute"], [2, "minute"], [5, "minute"], [10, "minute"], [30, "minute"], [1, "hour"], [2, "hour"], [4, "hour"], [8, "hour"], [12, "hour"], [1, "day"], [2, "day"], [3, "day"], [.25, "month"], [.5, "month"], [1, "month"], [2, "month"], [3, "month"], [6, "month"], [1, "year"]], E = 0;
                r.minTickSize != null && (typeof r.tickSize == "number" ? E = r.tickSize : E = r.minTickSize[0] * v[r.minTickSize[1]]);
                for (var h = 0; h < y.length - 1; ++h)
                    if (s < (y[h][0] * v[y[h][1]] + y[h + 1][0] * v[y[h + 1][1]]) / 2 && y[h][0] * v[y[h][1]] >= E)
                        break;
                o = y[h][0], f = y[h][1], f == "year" && (p = Math.pow(10, Math.floor(Math.log(s / v.year) / Math.LN10)), d = s / v.year / p, d < 1.5 ? o = 1 : d < 3 ? o = 2 : d < 7.5 ? o = 5 : o = 10, o *= p), t.tickSize = r.tickSize || [o, f], u = function(e) {
                    var t = [], r = e.tickSize[0], i = e.tickSize[1], s = new Date(e.min), o = r * v[i];
                    i == "second" && s.setUTCSeconds(n(s.getUTCSeconds(), r)), i == "minute" && s.setUTCMinutes(n(s.getUTCMinutes(), r)), i == "hour" && s.setUTCHours(n(s.getUTCHours(), r)), i == "month" && s.setUTCMonth(n(s.getUTCMonth(), r)), i == "year" && s.setUTCFullYear(n(s.getUTCFullYear(), r)), s.setUTCMilliseconds(0), o >= v.minute && s.setUTCSeconds(0), o >= v.hour && s.setUTCMinutes(0), o >= v.day && s.setUTCHours(0), o >= v.day * 4 && s.setUTCDate(1), o >= v.year && s.setUTCMonth(0);
                    var u = 0, f = Number.NaN, l;
                    do {
                        l = f, f = s.getTime(), t.push(f);
                        if (i == "month")
                            if (r < 1) {
                                s.setUTCDate(1);
                                var c = s.getTime();
                                s.setUTCMonth(s.getUTCMonth() + 1);
                                var h = s.getTime();
                                s.setTime(f + u * v.hour + (h - c) * r), u = s.getUTCHours(), s.setUTCHours(0)
                            } else
                                s.setUTCMonth(s.getUTCMonth() + r);
                        else
                            i == "year" ? s.setUTCFullYear(s.getUTCFullYear() + r) : s.setTime(f + o)
                    } while (f < e.max && f != l);
                    return t
                }, l = function(t, n) {
                    var i = new Date(t);
                    if (r.timeformat != null)
                        return e.plot.formatDate(i, r.timeformat, r.monthNames);
                    var s = n.tickSize[0] * v[n.tickSize[1]], o = n.max - n.min, u = r.twelveHourClock ? " %p" : "";
                    return s < v.minute ? fmt = "%h:%M:%S" + u : s < v.day ? o < 2 * v.day ? fmt = "%h:%M" + u : fmt = "%b %d %h:%M" + u : s < v.month ? fmt = "%b %d" : s < v.year ? o < v.year ? fmt = "%b" : fmt = "%b %y" : fmt = "%y", e.plot.formatDate(i, fmt, r.monthNames)
                }
            } else {
                var S = r.tickDecimals, x = -Math.floor(Math.log(s) / Math.LN10);
                S != null && x > S && (x = S), p = Math.pow(10, -x), d = s / p, d < 1.5 ? o = 1 : d < 3 ? (o = 2, d > 2.25 && (S == null || x + 1 <= S) && (o = 2.5, ++x)) : d < 7.5 ? o = 5 : o = 10, o *= p, r.minTickSize != null && o < r.minTickSize && (o = r.minTickSize), t.tickDecimals = Math.max(0, S != null ? S : x), t.tickSize = r.tickSize || o, u = function(e) {
                    var t = [], r = n(e.min, e.tickSize), i = 0, s = Number.NaN, o;
                    do
                        o = s, s = r + i * e.tickSize, t.push(s), ++i;
                    while (s < e.max && s != o);
                    return t
                }, l = function(e, t) {
                    return e.toFixed(t.tickDecimals)
                }
            }
            if (r.alignTicksWithAxis != null) {
                var T = (t.direction == "x" ? m : g)[r.alignTicksWithAxis - 1];
                if (T && T.used && T != t) {
                    var N = u(t);
                    N.length > 0 && (r.min == null && (t.min = Math.min(t.min, N[0])), r.max == null && N.length > 1 && (t.max = Math.max(t.max, N[N.length - 1]))), u = function(e) {
                        var t = [], n, r;
                        for (r = 0; r < T.ticks.length; ++r)
                            n = (T.ticks[r].v - T.min) / (T.max - T.min), n = e.min + n * (e.max - e.min), t.push(n);
                        return t
                    };
                    if (t.mode != "time" && r.tickDecimals == null) {
                        var C = Math.max(0, -Math.floor(Math.log(s) / Math.LN10) + 1), k = u(t);
                        k.length > 1 && /\..*0$/.test((k[1] - k[0]).toFixed(C)) || (t.tickDecimals = C)
                    }
                }
            }
            t.tickGenerator = u, e.isFunction(r.tickFormatter) ? t.tickFormatter = function(e, t) {
                return "" + r.tickFormatter(e, t)
            } : t.tickFormatter = l
        }
        function Q(t) {
            var n = t.options.ticks, r = [];
            n == null || typeof n == "number" && n > 0 ? r = t.tickGenerator(t) : n && (e.isFunction(n) ? r = n({min: t.min,max: t.max}) : r = n);
            var i, s;
            t.ticks = [];
            for (i = 0; i < r.length; ++i) {
                var o = null, u = r[i];
                typeof u == "object" ? (s = +u[0], u.length > 1 && (o = u[1])) : s = +u, o == null && (o = t.tickFormatter(s, t)), isNaN(s) || t.ticks.push({v: s,label: o})
            }
        }
        function G(e, t) {
            e.options.autoscaleMargin && t.length > 0 && (e.options.min == null && (e.min = Math.min(e.min, t[0].v)), e.options.max == null && t.length > 1 && (e.max = Math.max(e.max, t[t.length - 1].v)))
        }
        function Y() {
            d.clearRect(0, 0, b, w);
            var e = f.grid;
            e.show && e.backgroundColor && et(), e.show && !e.aboveData && tt();
            for (var t = 0; t < u.length; ++t)
                N(x.drawSeries, [d, u[t]]), rt(u[t]);
            N(x.draw, [d]), e.show && e.aboveData && tt()
        }
        function Z(e, t) {
            var n, r, s, o, u = M();
            for (i = 0; i < u.length; ++i) {
                n = u[i];
                if (n.direction == t) {
                    o = t + n.n + "axis", !e[o] && n.n == 1 && (o = t + "axis");
                    if (e[o]) {
                        r = e[o].from, s = e[o].to;
                        break
                    }
                }
            }
            e[o] || (n = t == "x" ? m[0] : g[0], r = e[t + "1"], s = e[t + "2"]);
            if (r != null && s != null && r > s) {
                var a = r;
                r = s, s = a
            }
            return {from: r,to: s,axis: n}
        }
        function et() {
            d.save(), d.translate(y.left, y.top), d.fillStyle = Tt(f.grid.backgroundColor, S, 0, "rgba(255, 255, 255, 0)"), d.fillRect(0, 0, E, S), d.restore()
        }
        function tt() {
            var t;
            d.save(), d.translate(y.left, y.top);
            var n = f.grid.markings;
            if (n) {
                if (e.isFunction(n)) {
                    var r = T.getAxes();
                    r.xmin = r.xaxis.min, r.xmax = r.xaxis.max, r.ymin = r.yaxis.min, r.ymax = r.yaxis.max, n = n(r)
                }
                for (t = 0; t < n.length; ++t) {
                    var i = n[t], s = Z(i, "x"), o = Z(i, "y");
                    s.from == null && (s.from = s.axis.min), s.to == null && (s.to = s.axis.max), o.from == null && (o.from = o.axis.min), o.to == null && (o.to = o.axis.max);
                    if (s.to < s.axis.min || s.from > s.axis.max || o.to < o.axis.min || o.from > o.axis.max)
                        continue;
                    s.from = Math.max(s.from, s.axis.min), s.to = Math.min(s.to, s.axis.max), o.from = Math.max(o.from, o.axis.min), o.to = Math.min(o.to, o.axis.max);
                    if (s.from == s.to && o.from == o.to)
                        continue;
                    s.from = s.axis.p2c(s.from), s.to = s.axis.p2c(s.to), o.from = o.axis.p2c(o.from), o.to = o.axis.p2c(o.to), s.from == s.to || o.from == o.to ? (d.beginPath(), d.strokeStyle = i.color || f.grid.markingsColor, d.lineWidth = i.lineWidth || f.grid.markingsLineWidth, d.moveTo(s.from, o.from), d.lineTo(s.to, o.to), d.stroke()) : (d.fillStyle = i.color || f.grid.markingsColor, d.fillRect(s.from, o.to, s.to - s.from, o.from - o.to))
                }
            }
            var r = M(), u = f.grid.borderWidth;
            for (var a = 0; a < r.length; ++a) {
                var l = r[a], h = l.box, p = l.tickLength, v, m, g, b;
                if (!l.show || l.ticks.length == 0)
                    continue;
                d.strokeStyle = l.options.tickColor || e.color.parse(l.options.color).scale("a", .22).toString(), d.lineWidth = 1, l.direction == "x" ? (v = 0, p == "full" ? m = l.position == "top" ? 0 : S : m = h.top - y.top + (l.position == "top" ? h.height : 0)) : (m = 0, p == "full" ? v = l.position == "left" ? 0 : E : v = h.left - y.left + (l.position == "left" ? h.width : 0)), l.innermost || (d.beginPath(), g = b = 0, l.direction == "x" ? g = E : b = S, d.lineWidth == 1 && (v = Math.floor(v) + .5, m = Math.floor(m) + .5), d.moveTo(v, m), d.lineTo(v + g, m + b), d.stroke()), d.beginPath();
                for (t = 0; t < l.ticks.length; ++t) {
                    var w = l.ticks[t].v;
                    g = b = 0;
                    if (w < l.min || w > l.max || p == "full" && u > 0 && (w == l.min || w == l.max))
                        continue;
                    l.direction == "x" ? (v = l.p2c(w), b = p == "full" ? -S : p, l.position == "top" && (b = -b)) : (m = l.p2c(w), g = p == "full" ? -E : p, l.position == "left" && (g = -g)), d.lineWidth == 1 && (l.direction == "x" ? v = Math.floor(v) + .5 : m = Math.floor(m) + .5), d.moveTo(v, m), d.lineTo(v + g, m + b)
                }
                d.stroke()
            }
            u && (d.lineWidth = u, d.strokeStyle = f.grid.borderColor, d.strokeRect(-u / 2, -u / 2, E + u, S + u)), d.restore()
        }
        function nt() {
            t.find(".tickLabels").remove();
            var e = ['<div class="tickLabels" style="font-size:smaller">'], n = M();
            for (var r = 0; r < n.length; ++r) {
                var i = n[r], s = i.box;
                if (!i.show)
                    continue;
                e.push('<div class="' + i.direction + "Axis " + i.direction + i.n + 'Axis" style="color:' + i.options.color + '">');
                for (var o = 0; o < i.ticks.length; ++o) {
                    var u = i.ticks[o];
                    if (!u.label || u.v < i.min || u.v > i.max)
                        continue;
                    var a = {}, f;
                    i.direction == "x" ? (f = "center", a.left = Math.round(y.left + i.p2c(u.v) - i.labelWidth / 2), i.position == "bottom" ? a.top = s.top + s.padding : a.bottom = w - (s.top + s.height - s.padding)) : (a.top = Math.round(y.top + i.p2c(u.v) - i.labelHeight / 2), i.position == "left" ? (a.right = b - (s.left + s.width - s.padding), f = "right") : (a.left = s.left + s.padding, f = "left")), a.width = i.labelWidth;
                    var l = ["position:absolute", "text-align:" + f];
                    for (var c in a)
                        l.push(c + ":" + a[c] + "px");
                    e.push('<div class="tickLabel" style="' + l.join(";") + '">' + u.label + "</div>")
                }
                e.push("</div>")
            }
            e.push("</div>"), t.append(e.join(""))
        }
        function rt(e) {
            e.lines.show && it(e), e.bars.show && ut(e), e.points.show && st(e)
        }
        function it(e) {
            function t(e, t, n, r, i) {
                var s = e.points, o = e.pointsize, u = null, a = null;
                d.beginPath();
                for (var f = o; f < s.length; f += o) {
                    var l = s[f - o], c = s[f - o + 1], h = s[f], p = s[f + 1];
                    if (l == null || h == null)
                        continue;
                    if (c <= p && c < i.min) {
                        if (p < i.min)
                            continue;
                        l = (i.min - c) / (p - c) * (h - l) + l, c = i.min
                    } else if (p <= c && p < i.min) {
                        if (c < i.min)
                            continue;
                        h = (i.min - c) / (p - c) * (h - l) + l, p = i.min
                    }
                    if (c >= p && c > i.max) {
                        if (p > i.max)
                            continue;
                        l = (i.max - c) / (p - c) * (h - l) + l, c = i.max
                    } else if (p >= c && p > i.max) {
                        if (c > i.max)
                            continue;
                        h = (i.max - c) / (p - c) * (h - l) + l, p = i.max
                    }
                    if (l <= h && l < r.min) {
                        if (h < r.min)
                            continue;
                        c = (r.min - l) / (h - l) * (p - c) + c, l = r.min
                    } else if (h <= l && h < r.min) {
                        if (l < r.min)
                            continue;
                        p = (r.min - l) / (h - l) * (p - c) + c, h = r.min
                    }
                    if (l >= h && l > r.max) {
                        if (h > r.max)
                            continue;
                        c = (r.max - l) / (h - l) * (p - c) + c, l = r.max
                    } else if (h >= l && h > r.max) {
                        if (l > r.max)
                            continue;
                        p = (r.max - l) / (h - l) * (p - c) + c, h = r.max
                    }
                    (l != u || c != a) && d.moveTo(r.p2c(l) + t, i.p2c(c) + n), u = h, a = p, d.lineTo(r.p2c(h) + t, i.p2c(p) + n)
                }
                d.stroke()
            }
            function n(e, t, n) {
                var r = e.points, i = e.pointsize, s = Math.min(Math.max(0, n.min), n.max), o = 0, u, a = !1, f = 1, l = 0, c = 0;
                for (; ; ) {
                    if (i > 0 && o > r.length + i)
                        break;
                    o += i;
                    var h = r[o - i], p = r[o - i + f], v = r[o], m = r[o + f];
                    if (a) {
                        if (i > 0 && h != null && v == null) {
                            c = o, i = -i, f = 2;
                            continue
                        }
                        if (i < 0 && o == l + i) {
                            d.fill(), a = !1, i = -i, f = 1, o = l = c + i;
                            continue
                        }
                    }
                    if (h == null || v == null)
                        continue;
                    if (h <= v && h < t.min) {
                        if (v < t.min)
                            continue;
                        p = (t.min - h) / (v - h) * (m - p) + p, h = t.min
                    } else if (v <= h && v < t.min) {
                        if (h < t.min)
                            continue;
                        m = (t.min - h) / (v - h) * (m - p) + p, v = t.min
                    }
                    if (h >= v && h > t.max) {
                        if (v > t.max)
                            continue;
                        p = (t.max - h) / (v - h) * (m - p) + p, h = t.max
                    } else if (v >= h && v > t.max) {
                        if (h > t.max)
                            continue;
                        m = (t.max - h) / (v - h) * (m - p) + p, v = t.max
                    }
                    a || (d.beginPath(), d.moveTo(t.p2c(h), n.p2c(s)), a = !0);
                    if (p >= n.max && m >= n.max) {
                        d.lineTo(t.p2c(h), n.p2c(n.max)), d.lineTo(t.p2c(v), n.p2c(n.max));
                        continue
                    }
                    if (p <= n.min && m <= n.min) {
                        d.lineTo(t.p2c(h), n.p2c(n.min)), d.lineTo(t.p2c(v), n.p2c(n.min));
                        continue
                    }
                    var g = h, y = v;
                    p <= m && p < n.min && m >= n.min ? (h = (n.min - p) / (m - p) * (v - h) + h, p = n.min) : m <= p && m < n.min && p >= n.min && (v = (n.min - p) / (m - p) * (v - h) + h, m = n.min), p >= m && p > n.max && m <= n.max ? (h = (n.max - p) / (m - p) * (v - h) + h, p = n.max) : m >= p && m > n.max && p <= n.max && (v = (n.max - p) / (m - p) * (v - h) + h, m = n.max), h != g && d.lineTo(t.p2c(g), n.p2c(p)), d.lineTo(t.p2c(h), n.p2c(p)), d.lineTo(t.p2c(v), n.p2c(m)), v != y && (d.lineTo(t.p2c(v), n.p2c(m)), d.lineTo(t.p2c(y), n.p2c(m)))
                }
            }
            d.save(), d.translate(y.left, y.top), d.lineJoin = "round";
            var r = e.lines.lineWidth, i = e.shadowSize;
            if (r > 0 && i > 0) {
                d.lineWidth = i, d.strokeStyle = "rgba(0,0,0,0.1)";
                var s = Math.PI / 18;
                t(e.datapoints, Math.sin(s) * (r / 2 + i / 2), Math.cos(s) * (r / 2 + i / 2), e.xaxis, e.yaxis), d.lineWidth = i / 2, t(e.datapoints, Math.sin(s) * (r / 2 + i / 4), Math.cos(s) * (r / 2 + i / 4), e.xaxis, e.yaxis)
            }
            d.lineWidth = r, d.strokeStyle = e.color;
            var o = at(e.lines, e.color, 0, S);
            o && (d.fillStyle = o, n(e.datapoints, e.xaxis, e.yaxis)), r > 0 && t(e.datapoints, 0, 0, e.xaxis, e.yaxis), d.restore()
        }
        function st(e) {
            function t(e, t, n, r, i, s, o, u) {
                var a = e.points, f = e.pointsize;
                for (var l = 0; l < a.length; l += f) {
                    var c = a[l], h = a[l + 1];
                    if (c == null || c < s.min || c > s.max || h < o.min || h > o.max)
                        continue;
                    d.beginPath(), c = s.p2c(c), h = o.p2c(h) + r, u == "circle" ? d.arc(c, h, t, 0, i ? Math.PI : Math.PI * 2, !1) : u(d, c, h, t, i), d.closePath(), n && (d.fillStyle = n, d.fill()), d.stroke()
                }
            }
            d.save(), d.translate(y.left, y.top);
            var n = e.points.lineWidth, r = e.shadowSize, i = e.points.radius, s = e.points.symbol;
            if (n > 0 && r > 0) {
                var o = r / 2;
                d.lineWidth = o, d.strokeStyle = "rgba(0,0,0,0.1)", t(e.datapoints, i, null, o + o / 2, !0, e.xaxis, e.yaxis, s), d.strokeStyle = "rgba(0,0,0,0.2)", t(e.datapoints, i, null, o / 2, !0, e.xaxis, e.yaxis, s)
            }
            d.lineWidth = n, d.strokeStyle = e.color, t(e.datapoints, i, at(e.points, e.color), 0, !1, e.xaxis, e.yaxis, s), d.restore()
        }
        function ot(e, t, n, r, i, s, o, u, a, f, l, c) {
            var h, p, d, v, m, g, y, b, w;
            l ? (b = g = y = !0, m = !1, h = n, p = e, v = t + r, d = t + i, p < h && (w = p, p = h, h = w, m = !0, g = !1)) : (m = g = y = !0, b = !1, h = e + r, p = e + i, d = n, v = t, v < d && (w = v, v = d, d = w, b = !0, y = !1));
            if (p < u.min || h > u.max || v < a.min || d > a.max)
                return;
            h < u.min && (h = u.min, m = !1), p > u.max && (p = u.max, g = !1), d < a.min && (d = a.min, b = !1), v > a.max && (v = a.max, y = !1), h = u.p2c(h), d = a.p2c(d), p = u.p2c(p), v = a.p2c(v), o && (f.beginPath(), f.moveTo(h, d), f.lineTo(h, v), f.lineTo(p, v), f.lineTo(p, d), f.fillStyle = o(d, v), f.fill()), c > 0 && (m || g || y || b) && (f.beginPath(), f.moveTo(h, d + s), m ? f.lineTo(h, v + s) : f.moveTo(h, v + s), y ? f.lineTo(p, v + s) : f.moveTo(p, v + s), g ? f.lineTo(p, d + s) : f.moveTo(p, d + s), b ? f.lineTo(h, d + s) : f.moveTo(h, d + s), f.stroke())
        }
        function ut(e) {
            function t(t, n, r, i, s, o, u) {
                var a = t.points, f = t.pointsize;
                for (var l = 0; l < a.length; l += f) {
                    if (a[l] == null)
                        continue;
                    ot(a[l], a[l + 1], a[l + 2], n, r, i, s, o, u, d, e.bars.horizontal, e.bars.lineWidth)
                }
            }
            d.save(), d.translate(y.left, y.top), d.lineWidth = e.bars.lineWidth, d.strokeStyle = e.color;
            var n = e.bars.align == "left" ? 0 : -e.bars.barWidth / 2, r = e.bars.fill ? function(t, n) {
                return at(e.bars, e.color, t, n)
            } : null;
            t(e.datapoints, n, n + e.bars.barWidth, 0, r, e.xaxis, e.yaxis), d.restore()
        }
        function at(t, n, r, i) {
            var s = t.fill;
            if (!s)
                return null;
            if (t.fillColor)
                return Tt(t.fillColor, r, i, n);
            var o = e.color.parse(n);
            return o.a = typeof s == "number" ? s : .4, o.normalize(), o.toString()
        }
        function ft() {
            t.find(".legend").remove();
            if (!f.legend.show)
                return;
            var n = [], r = !1, i = f.legend.labelFormatter, s, o;
            for (var a = 0; a < u.length; ++a) {
                s = u[a], o = s.label;
                if (!o)
                    continue;
                a % f.legend.noColumns == 0 && (r && n.push("</tr>"), n.push("<tr>"), r = !0), i && (o = i(o, s)), n.push('<td class="legendColorBox"><div style="border:1px solid ' + f.legend.labelBoxBorderColor + ';padding:1px"><div style="width:4px;height:0;border:5px solid ' + s.color + ';overflow:hidden"></div></div></td><td class="legendLabel">' + o + "</td>")
            }
            r && n.push("</tr>");
            if (n.length == 0)
                return;
            var l = '<table style="font-size:smaller;color:' + f.grid.color + '">' + n.join("") + "</table>";
            if (f.legend.container != null)
                e(f.legend.container).html(l);
            else {
                var h = "", p = f.legend.position, d = f.legend.margin;
                d[0] == null && (d = [d, d]), p.charAt(0) == "n" ? h += "top:" + (d[1] + y.top) + "px;" : p.charAt(0) == "s" && (h += "bottom:" + (d[1] + y.bottom) + "px;"), p.charAt(1) == "e" ? h += "right:" + (d[0] + y.right) + "px;" : p.charAt(1) == "w" && (h += "left:" + (d[0] + y.left) + "px;");
                var v = e('<div class="legend">' + l.replace('style="', 'style="position:absolute;' + h + ";") + "</div>").appendTo(t);
                if (f.legend.backgroundOpacity != 0) {
                    var m = f.legend.backgroundColor;
                    m == null && (m = f.grid.backgroundColor, m && typeof m == "string" ? m = e.color.parse(m) : m = e.color.extract(v, "background-color"), m.a = 1, m = m.toString());
                    var g = v.children();
                    e('<div style="position:absolute;width:' + g.width() + "px;height:" + g.height() + "px;" + h + "background-color:" + m + ';"> </div>').prependTo(v).css("opacity", f.legend.backgroundOpacity)
                }
            }
        }
        function ht(e, t, n) {
            var r = f.grid.mouseActiveRadius, i = r * r + 1, s = null, o = !1, a, l;
            for (a = u.length - 1; a >= 0; --a) {
                if (!n(u[a]))
                    continue;
                var c = u[a], h = c.xaxis, p = c.yaxis, d = c.datapoints.points, v = c.datapoints.pointsize, m = h.c2p(e), g = p.c2p(t), y = r / h.scale, b = r / p.scale;
                h.options.inverseTransform && (y = Number.MAX_VALUE), p.options.inverseTransform && (b = Number.MAX_VALUE);
                if (c.lines.show || c.points.show)
                    for (l = 0; l < d.length; l += v) {
                        var w = d[l], E = d[l + 1];
                        if (w == null)
                            continue;
                        if (w - m > y || w - m < -y || E - g > b || E - g < -b)
                            continue;
                        var S = Math.abs(h.p2c(w) - e), x = Math.abs(p.p2c(E) - t), T = S * S + x * x;
                        T < i && (i = T, s = [a, l / v])
                    }
                if (c.bars.show && !s) {
                    var N = c.bars.align == "left" ? 0 : -c.bars.barWidth / 2, C = N + c.bars.barWidth;
                    for (l = 0; l < d.length; l += v) {
                        var w = d[l], E = d[l + 1], k = d[l + 2];
                        if (w == null)
                            continue;
                        if (u[a].bars.horizontal ? m <= Math.max(k, w) && m >= Math.min(k, w) && g >= E + N && g <= E + C : m >= w + N && m <= w + C && g >= Math.min(k, E) && g <= Math.max(k, E))
                            s = [a, l / v]
                    }
                }
            }
            return s ? (a = s[0], l = s[1], v = u[a].datapoints.pointsize, {datapoint: u[a].datapoints.points.slice(l * v, (l + 1) * v),dataIndex: l,series: u[a],seriesIndex: a}) : null
        }
        function pt(e) {
            f.grid.hoverable && mt("plothover", e, function(e) {
                return e.hoverable != 0
            })
        }
        function dt(e) {
            f.grid.hoverable && mt("plothover", e, function(e) {
                return !1
            })
        }
        function vt(e) {
            mt("plotclick", e, function(e) {
                return e.clickable != 0
            })
        }
        function mt(e, n, r) {
            var i = p.offset(), s = n.pageX - i.left - y.left, o = n.pageY - i.top - y.top, u = _({left: s,top: o});
            u.pageX = n.pageX, u.pageY = n.pageY;
            var a = ht(s, o, r);
            a && (a.pageX = parseInt(a.series.xaxis.p2c(a.datapoint[0]) + i.left + y.left), a.pageY = parseInt(a.series.yaxis.p2c(a.datapoint[1]) + i.top + y.top));
            if (f.grid.autoHighlight) {
                for (var l = 0; l < lt.length; ++l) {
                    var c = lt[l];
                    c.auto == e && (!a || c.series != a.series || c.point[0] != a.datapoint[0] || c.point[1] != a.datapoint[1]) && wt(c.series, c.point)
                }
                a && bt(a.series, a.datapoint, e)
            }
            t.trigger(e, [u, a])
        }
        function gt() {
            ct || (ct = setTimeout(yt, 30))
        }
        function yt() {
            ct = null, v.save(), v.clearRect(0, 0, b, w), v.translate(y.left, y.top);
            var e, t;
            for (e = 0; e < lt.length; ++e)
                t = lt[e], t.series.bars.show ? xt(t.series, t.point) : St(t.series, t.point);
            v.restore(), N(x.drawOverlay, [v])
        }
        function bt(e, t, n) {
            typeof e == "number" && (e = u[e]);
            if (typeof t == "number") {
                var r = e.datapoints.pointsize;
                t = e.datapoints.points.slice(r * t, r * (t + 1))
            }
            var i = Et(e, t);
            i == -1 ? (lt.push({series: e,point: t,auto: n}), gt()) : n || (lt[i].auto = !1)
        }
        function wt(e, t) {
            e == null && t == null && (lt = [], gt()), typeof e == "number" && (e = u[e]), typeof t == "number" && (t = e.data[t]);
            var n = Et(e, t);
            n != -1 && (lt.splice(n, 1), gt())
        }
        function Et(e, t) {
            for (var n = 0; n < lt.length; ++n) {
                var r = lt[n];
                if (r.series == e && r.point[0] == t[0] && r.point[1] == t[1])
                    return n
            }
            return -1
        }
        function St(t, n) {
            var r = n[0], i = n[1], s = t.xaxis, o = t.yaxis;
            if (r < s.min || r > s.max || i < o.min || i > o.max)
                return;
            var u = t.points.radius + t.points.lineWidth / 2;
            v.lineWidth = u, v.strokeStyle = e.color.parse(t.color).scale("a", .5).toString();
            var a = 1.5 * u, r = s.p2c(r), i = o.p2c(i);
            v.beginPath(), t.points.symbol == "circle" ? v.arc(r, i, a, 0, 2 * Math.PI, !1) : t.points.symbol(v, r, i, a, !1), v.closePath(), v.stroke()
        }
        function xt(t, n) {
            v.lineWidth = t.bars.lineWidth, v.strokeStyle = e.color.parse(t.color).scale("a", .5).toString();
            var r = e.color.parse(t.color).scale("a", .5).toString(), i = t.bars.align == "left" ? 0 : -t.bars.barWidth / 2;
            ot(n[0], n[1], n[2] || 0, i, i + t.bars.barWidth, 0, function() {
                return r
            }, t.xaxis, t.yaxis, v, t.bars.horizontal, t.bars.lineWidth)
        }
        function Tt(t, n, r, i) {
            if (typeof t == "string")
                return t;
            var s = d.createLinearGradient(0, r, 0, n);
            for (var o = 0, u = t.colors.length; o < u; ++o) {
                var a = t.colors[o];
                if (typeof a != "string") {
                    var f = e.color.parse(i);
                    a.brightness != null && (f = f.scale("rgb", a.brightness)), a.opacity != null && (f.a *= a.opacity), a = f.toString()
                }
                s.addColorStop(o / (u - 1), a)
            }
            return s
        }
        var u = [], f = {colors: ["#edc240", "#afd8f8", "#cb4b4b", "#4da74d", "#9440ed"],legend: {show: !0,noColumns: 1,labelFormatter: null,labelBoxBorderColor: "#ccc",container: null,position: "ne",margin: 5,backgroundColor: null,backgroundOpacity: .85},xaxis: {show: null,position: "bottom",mode: null,color: null,tickColor: null,transform: null,inverseTransform: null,min: null,max: null,autoscaleMargin: null,ticks: null,tickFormatter: null,labelWidth: null,labelHeight: null,reserveSpace: null,tickLength: null,alignTicksWithAxis: null,tickDecimals: null,tickSize: null,minTickSize: null,monthNames: null,timeformat: null,twelveHourClock: !1},yaxis: {autoscaleMargin: .02,position: "left"},xaxes: [],yaxes: [],series: {points: {show: !1,radius: 3,lineWidth: 2,fill: !0,fillColor: "#ffffff",symbol: "circle"},lines: {lineWidth: 2,fill: !1,fillColor: null,steps: !1},bars: {show: !1,lineWidth: 2,barWidth: 1,fill: !0,fillColor: null,align: "left",horizontal: !1},shadowSize: 3},grid: {show: !0,aboveData: !1,color: "#545454",backgroundColor: null,borderColor: null,tickColor: null,labelMargin: 5,axisMargin: 8,borderWidth: 2,minBorderMargin: null,markings: null,markingsColor: "#f4f4f4",markingsLineWidth: 2,clickable: !1,hoverable: !1,autoHighlight: !0,mouseActiveRadius: 10},hooks: {}}, l = null, h = null, p = null, d = null, v = null, m = [], g = [], y = {left: 0,right: 0,top: 0,bottom: 0}, b = 0, w = 0, E = 0, S = 0, x = {processOptions: [],processRawData: [],processDatapoints: [],drawSeries: [],draw: [],bindEvents: [],drawOverlay: [],shutdown: []}, T = this;
        T.setData = L, T.setupGrid = $, T.draw = Y, T.getPlaceholder = function() {
            return t
        }, T.getCanvas = function() {
            return l
        }, T.getPlotOffset = function() {
            return y
        }, T.width = function() {
            return E
        }, T.height = function() {
            return S
        }, T.offset = function() {
            var e = p.offset();
            return e.left += y.left, e.top += y.top, e
        }, T.getData = function() {
            return u
        }, T.getAxes = function() {
            var t = {}, n;
            return e.each(m.concat(g), function(e, n) {
                n && (t[n.direction + (n.n != 1 ? n.n : "") + "axis"] = n)
            }), t
        }, T.getXAxes = function() {
            return m
        }, T.getYAxes = function() {
            return g
        }, T.c2p = _, T.p2c = D, T.getOptions = function() {
            return f
        }, T.highlight = bt, T.unhighlight = wt, T.triggerRedrawOverlay = gt, T.pointOffset = function(e) {
            return {left: parseInt(m[O(e, "x") - 1].p2c(+e.x) + y.left),top: parseInt(g[O(e, "y") - 1].p2c(+e.y) + y.top)}
        }, T.shutdown = U, T.resize = function() {
            F(), I(l), I(h)
        }, T.hooks = x, C(T), k(s), q(), L(r), $(), Y(), R();
        var lt = [], ct = null
    }
    function n(e, t) {
        return t * Math.floor(e / t)
    }
    e.plot = function(n, r, i) {
        var s = new t(e(n), r, i, e.plot.plugins);
        return s
    }, e.plot.version = "0.7", e.plot.plugins = [], e.plot.formatDate = function(e, t, n) {
        var r = function(e) {
            return e = "" + e, e.length == 1 ? "0" + e : e
        }, i = [], s = !1, o = !1, u = e.getUTCHours(), a = u < 12;
        n == null && (n = ["Jan", "Feb", "Mar", "Apr", "May", "Jun", "Jul", "Aug", "Sep", "Oct", "Nov", "Dec"]), t.search(/%p|%P/) != -1 && (u > 12 ? u -= 12 : u == 0 && (u = 12));
        for (var f = 0; f < t.length; ++f) {
            var l = t.charAt(f);
            if (s) {
                switch (l) {
                    case "h":
                        l = "" + u;
                        break;
                    case "H":
                        l = r(u);
                        break;
                    case "M":
                        l = r(e.getUTCMinutes());
                        break;
                    case "S":
                        l = r(e.getUTCSeconds());
                        break;
                    case "d":
                        l = "" + e.getUTCDate();
                        break;
                    case "m":
                        l = "" + (e.getUTCMonth() + 1);
                        break;
                    case "y":
                        l = "" + e.getUTCFullYear();
                        break;
                    case "b":
                        l = "" + n[e.getUTCMonth()];
                        break;
                    case "p":
                        l = a ? "am" : "pm";
                        break;
                    case "P":
                        l = a ? "AM" : "PM";
                        break;
                    case "0":
                        l = "", o = !0
                }
                l && o && (l = r(l), o = !1), i.push(l), o || (s = !1)
            } else
                l == "%" ? s = !0 : i.push(l)
        }
        return i.join("")
    }
}(jQuery), define("jquery.flot", function() {
}), function(e) {
    function n(e) {
        function n(n) {
            if (t.locked)
                return;
            t.x != -1 && (t.x = -1, e.triggerRedrawOverlay())
        }
        function r(n) {
            if (t.locked)
                return;
            if (e.getSelection && e.getSelection()) {
                t.x = -1;
                return
            }
            var r = e.offset();
            t.x = Math.max(0, Math.min(n.pageX - r.left, e.width())), t.y = Math.max(0, Math.min(n.pageY - r.top, e.height())), e.triggerRedrawOverlay()
        }
        var t = {x: -1,y: -1,locked: !1};
        e.setCrosshair = function(r) {
            if (!r)
                t.x = -1;
            else {
                var i = e.p2c(r);
                t.x = Math.max(0, Math.min(i.left, e.width())), t.y = Math.max(0, Math.min(i.top, e.height()))
            }
            e.triggerRedrawOverlay()
        }, e.clearCrosshair = e.setCrosshair, e.lockCrosshair = function(r) {
            r && e.setCrosshair(r), t.locked = !0
        }, e.unlockCrosshair = function() {
            t.locked = !1
        }, e.hooks.bindEvents.push(function(e, t) {
            if (!e.getOptions().crosshair.mode)
                return;
            t.mouseout(n), t.mousemove(r)
        }), e.hooks.drawOverlay.push(function(e, n) {
            var r = e.getOptions().crosshair;
            if (!r.mode)
                return;
            var i = e.getPlotOffset();
            n.save(), n.translate(i.left, i.top), t.x != -1 && (n.strokeStyle = r.color, n.lineWidth = r.lineWidth, n.lineJoin = "round", n.beginPath(), r.mode.indexOf("x") != -1 && (n.moveTo(t.x, 0), n.lineTo(t.x, e.height())), r.mode.indexOf("y") != -1 && (n.moveTo(0, t.y), n.lineTo(e.width(), t.y)), n.stroke()), n.restore()
        }), e.hooks.shutdown.push(function(e, t) {
            t.unbind("mouseout", n), t.unbind("mousemove", r)
        })
    }
    var t = {crosshair: {mode: null,color: "rgba(170, 0, 0, 0.80)",lineWidth: 1}};
    e.plot.plugins.push({init: n,options: t,name: "crosshair",version: "1.0"})
}(jQuery), define("jquery.crosshair", function() {
}), define("adobe_am/trait_builder/views/createPageAdjustReachAccuracyView", ["backbone", "backbone.marionette", "adobe.templates", "adobe", "adobe_am/vent", "aui", "globals", "jquery.flot", "jquery.crosshair"], function(e, t, n, r, i, s, o) {
    return e.Marionette.ItemView.extend({widgets: {graph: null,crosshairs: null,slider: null},selected_reach_accuracy_model: null,className: "panel",template: _.template(n.algo_trait.adjust_reach_accuracy),initialize: function(e) {
            var t = this;
            _.bindAll(this, "handleAccuracyChange"), this.selected_reach_accuracy_model = e.selected_reach_accuracy_model, this.bindTo(this.selected_reach_accuracy_model, "change", this.handleAccuracyChange, this)
        },onClose: function() {
            this.widgets.slider.purge("change:value"), this.widgets.slider.destroy()
        },handleAccuracyChange: function() {
            var e = this, t = e.selected_reach_accuracy_model.getAccuracy(), n = e.selected_reach_accuracy_model.getReach();
            t == -1 && (t = e.collection.getEstimatedAccuracy(n)), e.displaySlider(t), e.displayCrossHairs(t)
        },displayCrossHairs: function(e) {
            this.widgets.graph.setCrosshair({x: e,y: 0})
        },displayGraph: function(e) {
            var e = this.formatReachAccuracyNumbers(), t = function() {
                var e = [1], t = 1, n = 1, r = n;
                while (r < o.max_reach_audience_size)
                    e.push(r), r = Math.pow(10, t++);
                return e.push(r), e
            }(), n = $.plot("#reach_accuracy_graph", [{label: "Reach",data: e}], {yaxis: {ticks: t,transform: function(e) {
                        return e < 1 && (e = 1), Math.log(e)
                    },inverseTransform: function(e) {
                        return Math.exp(e)
                    },alignTicksWithAxis: 0,tickFormatter: function(e, t) {
                        return r.AM.UTILS.HELPERS.formatNumber(e)
                    },labelWidth: 63},crosshair: {mode: "x"},series: {lines: {show: !0},points: {show: !1}}}), i = document.createElement("div");
            i.style.cssText = "opacity:1; height:440px; width:600px; position:absolute; z-index:10", this.$el.find("#reach_accuracy_graph").prepend(i);
            var s = this.$el.find("canvas > div:first-child");
            s.eq(0).height() === 0 && s.css({height: "440px",width: "595px"}), this.widgets.graph = n
        },displaySlider: function(e) {
            var t = null, n = 0, i = this.collection.getMinAccuracy(), o = this;
            if (typeof e != "undefined") {
                var u = e * 100;
                e != -1 && this.widgets.slider.get("value") != u && this.widgets.slider.set("value", u, !0);
                return
            }
            t = s.Slider({parent: "reach_accuracy_slider",min: parseInt(i * 100, 10),name: "aui_slider",max: 100,length: 520}), t.render(), t.on("change:value", function(e) {
                var i = (Math.round(e.newValue / 1) * 1).toFixed(2);
                t.set("value", i);
                if (n == i)
                    return;
                n = i;
                var s = parseFloat(i / 100).toFixed(2), u = o.collection.where({AccuracyValue: String(s)});
                if (u.length == 0) {
                    r.AM.UTILS.LOGGER.log("In displaySlider: accuracy: " + s + " not found in results");
                    return
                }
                o.selected_reach_accuracy_model.set(u[0].toJSON())
            }), n = 0, o.widgets.slider = t
        },onShow: function() {
            if (typeof this.collection == "undefined")
                return;
            this.displaySlider(), this.displayGraph(), i.bindTo("accuracy_value:change", $.proxy(this.handleAccuracyChange, this))
        },formatReachAccuracyNumbers: function() {
            var e = [];
            return this.collection.each(function(t) {
                var n = parseFloat(t.getAccuracy()).toFixed(2);
                e.push([n, t.getReach()])
            }), e
        }})
}), define("adobe_am/trait_builder/views/createPageReachAccuracyTableView", ["backbone", "backbone.marionette", "adobe.templates", "adobe", "adobe_am/vent", "globals"], function(e, t, n, r, i, s) {
    var o = e.Marionette.ItemView.extend({selected_reach_accuracy_model: null,initialize: function(e) {
            this.selected_reach_accuracy_model = e.selected_reach_accuracy_model
        },tagName: "tr",template: _.template(n.algo_trait.reach_accuracy_row),templateHelpers: {formatNumber: r.AM.UTILS.HELPERS.formatNumber},events: {click: "rowClick"},$prev_selected_row: null,rowClick: function(e) {
            var t = $(e.currentTarget);
            if (t.length == 0)
                return;
            this.selected_reach_accuracy_model.set(this.model.toJSON()), this.handleModelChange(t)
        },handleModelChange: function(e) {
            o.$prev_selected_row && o.$prev_selected_row.removeClass("selected"), o.$prev_selected_row = e, e.addClass("selected")
        }}, {$prevSelectedRow: null});
    return e.Marionette.CompositeView.extend({template: _.template(n.algo_trait.reach_accuracy),className: "content",tagName: "div",selected_reach_accuracy_model: null,initialize: function(e) {
            var t = this;
            this.selected_reach_accuracy_model = e.selected_reach_accuracy_model, _.bindAll(this, "handleModelChange"), this.bindTo(this.selected_reach_accuracy_model, "change", this.handleModelChange, this)
        },handleModelChange: function() {
            var e = this.collection.where({AccuracyValue: this.selected_reach_accuracy_model.getAccuracy()});
            if (e.length > 0) {
                var t = this.children[e[0].cid], n = t.$el;
                t.handleModelChange(n);
                return
            }
            this.$el.find("tr").removeClass("selected");
            return
        },itemView: o,itemViewOptions: function() {
            var e = this;
            return {selected_reach_accuracy_model: e.selected_reach_accuracy_model}
        },appendHtml: function(e, t) {
            e.$(".reach_accuracy_table_body").append(t.el)
        }})
}), define("adobe_am/trait_builder/routers/createPageRouter", ["backbone", "backbone.marionette"], function(e, t) {
    return e.Marionette.AppRouter.extend({appRoutes: {"new/:type": "showCreatePage","new/model/:algoModelId": "showCreatePageWithModel","clone/:sid": "showClonePage","clone/": "showClonePage",clone: "showClonePage","edit/:sid": "showEditPage"}})
}), define("adobe_am/trait_builder/controllers/createPageController", ["adobe_am/vent"], function(e) {
    return {showCreatePage: function(t) {
            e.trigger("show:createpage", t)
        },showClonePage: function(t) {
            e.trigger("show:clonepage", {sid: t})
        },showEditPage: function(t) {
            e.trigger("show:editpage", {sid: t})
        },showCreatePageWithModel: function(t) {
            e.trigger("show:createpage", "algo", t)
        }}
}), define("adobe_am/trait_builder/views/createPageCodeViewPanel", ["adobe.templates", "backbone", "adobe", "adobe_am/vent"], function(e, t, n, r) {
    return t.Marionette.ItemView.extend({template: _.template(e.trait_builder.page.create_page.exp_panel_content),render: function() {
            var e = _.extend(_.clone(this.templateHelpers), this.model.toJSON());
            return this.$el.append(this.template(e)), this
        },templateHelpers: {displayRule: function(e) {
                return e == null ? "" : e
            }},events: {"click #validateBtn": "validateRule","click #resetExp": "resetExp"},validateRule: function() {
            var e = {}, t = $("#traitRule").val();
            e.code = t, $.ajax({cache: !1,dataType: "text",contentType: "application/json",type: "POST",url: n.AM.API.TRAITS.validate.url(),data: JSON.stringify(e),processData: !1,error: function(e, t, i) {
                    var s = {};
                    if (e.status == 400) {
                        var o = JSON.parse(e.responseText);
                        s.errorMsg = n.AM.MESSAGES.getMessage("trait_expression_invalid").message, s.msg = o.message
                    } else
                        s.errorMsg = " ", s.msg = i;
                    r.trigger("modal:show", {message: s.errorMsg + " " + s.msg})
                },success: function(e, t, i) {
                    r.trigger("modal:show", {type: "success",message: n.AM.MESSAGES.getMessage("trait_expression_valid").message})
                }})
        },resetExp: function() {
            r.trigger("traitWidget:reset_and_return")
        }})
}), define("modules/Widget/Views/Tabs", ["backbone", "aui"], function(e, t) {
    return e == undefined && (e = Backbone), t == undefined && (t = AUI), e.View.extend({initialize: function(e) {
            _.extend(this, e), _.bindAll(this, "render"), _.bindAll(this, "processTabs"), _.bindAll(this, "processEvents"), this.isRendered = !1, this.events = this.aui_args.events, delete this.aui_args.events, this.processTabs(), this.processEvents()
        },processEvents: function() {
            var e = this;
            if (!this.events)
                return;
            _.each(this.events, function(t, n) {
                e.tabs.on.call(e.tabs, n, t)
            })
        },processTabs: function() {
            this.tabs = new t.Tabs(this.aui_args)
        },render: function() {
            this.tabs.render()
        }})
}), define("adobe_am/trait_builder/views/createPageTestPanel", ["backbone", "adobe.templates", "adobe", "adobe_am/vent"], function(e, t, n, r) {
    var i, s = e.Marionette.ItemView.extend({template: _.template(t.trait_builder.page.create_page.test_section),render: function() {
            return this.$el.append(this.template()), this
        },events: {"click #testUrlBtn": "testUrlBtn"},testUrlBtn: function() {
            var e = i.$el.find("#traitRule").val(), t = $.trim(this.$el.find("#testUrl").val()), s = this.$el.find("#testHeader").val(), o = {};
            r.trigger("modal:show", {type: "loading"});
            var u = s.match(/[^\s]/) === null, a = t.match(/[^\s]/) === null;
            if (a && u) {
                r.trigger("modal:show", {message: n.AM.MESSAGES.getMessage("trait_test_url_header_invalid_fields").message});
                return
            }
            if (!a && t.indexOf("http://") != 0 && t.indexOf("https://") != 0) {
                r.trigger("modal:show", {message: n.AM.MESSAGES.getMessage("trait_test_url_header_invalid_url").message});
                return
            }
            o.code = e, o.url = t, o.header = s, $.ajax({cache: !1,dataType: "text",contentType: "application/json",type: "POST",url: n.AM.API.TRAITS.test.url(),data: JSON.stringify(o),processData: !1,error: function(e, t, i) {
                    var s = {};
                    if (e.status == 400) {
                        var o = JSON.parse(e.responseText);
                        s.errorMsg = n.AM.MESSAGES.getMessage("trait_expression_invalid").message, s.msg = o.message
                    } else
                        s.errorMsg = " ", s.msg = i;
                    r.trigger("modal:show", {message: s.errorMsg + " " + s.msg})
                },success: function(e, t, i) {
                    var s = JSON.parse(e), o = n.AM.MESSAGES.getMessage("trait_test_url_header_event_test").message;
                    if (s.result) {
                        r.trigger("modal:show", {type: "success",message: o + " - " + n.AM.MESSAGES.getMessage("trait_test_url_header_event_test_would_exhibit").message});
                        return
                    }
                    r.trigger("modal:show", {type: "notice",message: o + " - " + n.AM.MESSAGES.getMessage("trait_test_url_header_event_test_would_not_exhibit").message})
                }})
        }});
    return function(e) {
        return i = e.code_panel, new s(e)
    }
}), define("adobe_am/trait_builder/create", ["backbone", "backbone.marionette", "adobe", "modules/Widget/Views/Accordion", "modules/Widget/Views/FolderTree", "modules/Trait/Models/Trait", "modules/Trait/Models/AlgoTrait", "modules/Model/Views/ModelsModal", "modules/Model/Models/RunStat", "adobe_am/trait_builder/views/createPageLayout", "adobe_am/trait_builder/views/createPageBasicInfoAccordionLayout", "adobe_am/trait_builder/views/createPageConfigAccordionLayout", "adobe_am/trait_builder/views/createPageBasicInputsView", "adobe_am/trait_builder/views/createPageTraitsStorageView", "adobe_am/trait_builder/views/createPageCategoriesView", "adobe_am/trait_builder/views/createPageAdvancedOptionsView", "adobe_am/trait_builder/views/createPageSelectModelView", "adobe_am/trait_builder/views/createPageAdjustReachAccuracyView", "adobe_am/trait_builder/views/createPageReachAccuracyTableView", "modules/DataSource/Collections/DataSourcesForTraits", "adobe_am/trait_builder/routers/createPageRouter", "adobe_am/trait_builder/controllers/createPageController", "adobe_am/vent", "globals", "adobe_am/trait_builder/views/traitRuleWidget", "adobe_am/trait_builder/views/createPageCodeViewPanel", "modules/Widget/Views/Tabs", "adobe_am/trait_builder/views/createPageTestPanel"], function(e, t, n, r, i, s, o, u, a, f, l, c, h, p, d, v, m, g, y, b, w, E, S, x, T, N, C, k) {
    var L = {}, A = null, O = null, M = new a({}), _ = null, D = null, P = null, H = null, B = null, j = "", F = new b, I = I || window.$, q = q || window._;
    M.on("change", function() {
        I("input[name=accuracy]").val(M.getAccuracy())
    }), L.type = null;
    var R = x.max_reach_audience_size, U = function() {
        var e = new r({title: 'Configuration<span class="context-help" title="Help" data-id="r_algo_trait_config_section.html">&nbsp;</span>',parent: "accordion_second",aui_args: {panel: "accordion_second"}});
        e.panel.set("expanded", !1), e.render(), O = new c, A.accordion_config.show(O), H = new m, O.select_model.show(H), j !== "create" && D.loadAlgoModel().done(function() {
            S.trigger("modal:model:selected", D.getAlgoModel())
        }).fail(function() {
            S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("trait_edit_error_loading_model").message})
        })
    }, z = function() {
        var e = new r({title: 'Advanced Option<span class="context-help" title="Help" data-id="t_tb_ttl.html">&nbsp;</span>',parent: "accordion_second",aui_args: {panel: "accordion_second"}});
        e.panel.set("expanded", !1), e.render(), A.accordion_advanced.show(new v({model: D}));
        var t = new r({title: 'Trait Expression<span class="context-help" title="Help" data-id="c_tb_rules.html">&nbsp;</span>',parent: "accordion_traitexp",aui_args: {panel: "accordion_traitexp"}});
        t.panel.set("expanded", !1), t.render(), _ = new C({aui_args: {parent: "rulesDiv",type: "secondary",color: "white",prepend: !0,panels: [{id: "rulesTab",title: n.AM.MESSAGES.getMessage("trait_tab_expression").message,content: '<div id="exp_builder"></div>'}, {id: "expTab",title: n.AM.MESSAGES.getMessage("trait_tab_code").message,content: '<div id="code_view"></div>'}],events: {renderComplete: function() {
                    },"change:currentPanel": function() {
                    }}}}), _.render();
        var i = new T({mode: "edit",model: D,expressionTree: D.get("expressionTree"),attachToElement: t.$el.find("#exp_builder").get()});
        i.render(), i.show();
        var s = (new N({el: _.tabs.el("panel_expTab"),model: D})).render();
        (new k({code_panel: s,el: "#testExp"})).render(), I(t.panel.get("panel")).css("display", "block")
    }, W = {rule: z,algo: U,onboarded: z}, X = function() {
        var e = I.Deferred(), t = I.Deferred(), s = I.Deferred();
        I.when(e, t, s).then(function() {
            S.trigger("modal:hide")
        }), (new r({title: 'Basic Information<span class="context-help" title="Help" data-id="c_tb_basics.html">&nbsp;</span>',parent: "accordion_basicinfo",aui_args: {panel: "accordion_basicinfo"}})).render(), W[L.type]();
        var o = new l;
        A.accordion_basicinfo.show(o), o.traits_storage.show(new p), o.categories.show(new d);
        var u = [], a = new i({className: "traits_folder_tree",tree_widget: n.AM.hierarchy_tree,folder_api_url: n.AM.API.TRAITS.folders.url,folder_actions: {rename: !0,remove: !0,add: !0},tree_options: {initially_open: 0,inc3rdParty: !1,foldersOnly: !0,formatData: function(e) {
                    if (j === "edit" || j === "clone") {
                        var t = D.get("folderId"), r, i = function(e, t) {
                            e.folderId == t ? (e.parentFolderId && u.unshift(e.parentFolderId), r = e) : e.subFolders && e.subFolders.length && I.each(e.subFolders, function(e, n) {
                                i(n, t)
                            })
                        };
                        i(e[0], t), r.parentFolderId && i(e[0], r.parentFolderId)
                    }
                    var s = [];
                    return I.each(e, function(e, t) {
                        var r = n.AM.UTILS.HELPERS.formatFolderHierarchy(t);
                        s.push(r)
                    }), s
                }},parentElement: "#traits_folder_tree",hookTreeLoaded: function() {
                var t = D.get("folderId");
                e.resolve();
                if (t != null) {
                    try {
                        setTimeout(function() {
                            u.length && I.each(u, function(e, t) {
                                a.openNode(t)
                            }), a.selectNode(t)
                        }, 0)
                    } catch (n) {
                    }
                    I("input[name=folderId]").val(t)
                }
            }});
        a.render();
        var f, c = new i({className: "hierarchyList",tree_widget: n.AM.hierarchy_tree,folder_api_url: function() {
                return n.AM.API.TAXONOMY.categories.url() + "?expand=true"
            },tree_options: {treeElement: "#category",initially_open: 0,inc3rdParty: !1,foldersOnly: !0,formatData: function(e) {
                    if (j === "edit" || j === "clone") {
                        var t = D.get("categoryId"), r = function(e, t) {
                            var n = function(e) {
                                e.categoryId == t ? (f = e.parentCategoryId, D.set("parentCategoryId", f)) : e.categories && e.categories.length && I.each(e.categories, function(e, n) {
                                    r(n, t)
                                })
                            };
                            e.length ? I.each(e, function(e, t) {
                                n(t)
                            }) : n(e)
                        };
                        r(e, t)
                    }
                    var i = [];
                    return I.each(e, function(e, t) {
                        var r = n.AM.UTILS.HELPERS.formatCategoryTaxonomy(t);
                        i.push(r)
                    }), i
                },folderThemeSrc: "/css/aam/style.css",two_state: !0,dots: !0,icons: !1,showCheckboxes: !1},parentElement: "#category_folder_tree",hookTreeLoaded: function() {
                var e = D.get("categoryId");
                t.resolve();
                if (e != null) {
                    try {
                        setTimeout(function() {
                            f && c.openNode(f, "_cat"), c.selectNode(e, "_cat")
                        }, 0)
                    } catch (n) {
                    }
                    I("input[name=categoryId]").val(e)
                }
            }});
        c.render();
        var v = F.fetch(), m = D.getType(!0);
        I.when(v, m).done(function(e, t) {
            if (e && e[0] && e[0].length) {
                var r = (new b(e[0])).getFirstParty(x.pid);
                if (r && r.length) {
                    j === "edit" ? r = q.filter(r, function(e) {
                        return P.GateKeeper.checkPermissions([e.relational.permissions, P.user.permissions], "can_use_dataprovider_to_edit_trait")
                    }) : r = q.filter(r, function(e) {
                        return P.GateKeeper.checkPermissions([e.relational.permissions], "can_use_dataprovider_to_create_trait")
                    });
                    var i = q.extend(D.toJSON(), {dataSources: q.map(r, function(e) {
                            return e.toJSON()
                        }),pixelTypes: t[0]});
                    o.basic_inputs.show(new h(i)), s.resolve()
                } else
                    S.trigger("modal:show", {type: "notice",message: n.AM.MESSAGES.getMessage("no_datasources_to_create_trait").message,buttons: [{text: "OK",className: "primary",onClick: function() {
                                    S.trigger("show:listpage"), S.trigger("modal:hide")
                                }}]})
            }
            return
        }).fail(function() {
            S.trigger("modal:show", {type: "notice",message: n.AM.MESSAGES.getMessage("generic_404").message})
        })
    }, V = function(e, t) {
        D = null, S.trigger("modal:show", {type: "loading"});
        if (t)
            j = "createWithModel", D = new o({traitType: s.AlgoTraitType,algoModelId: t}), S.trigger("title:change", {title: "Test"});
        else {
            j = "create";
            switch (e) {
                case "rule":
                    D = new s({traitType: s.RuleBasedTraitType}), S.trigger("title:change", {title: "Create Rule Based Trait"});
                    break;
                case "algo":
                    D = new o({traitType: s.AlgoTraitType}), S.trigger("title:change", {title: "Create Algorithmic Trait"});
                    break;
                case "onboarded":
                    D = new o({traitType: s.OnBoardedTraitType}), S.trigger("title:change", {title: "Create onboarded Trait"})
            }
        }
        if (D === null) {
            S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("trait_type_not_found").message}), S.trigger("show:listpage");
            return
        }
        n.AM.UTILS.HELPERS.switchPage("create"), L.type = e, A = new f({type: e,selected_reach_accuracy_model: M,newTrait: D}), P.main.show(A), X(), n.AM.UTILS.HELPERS.bindContextHelp()
    }, $ = function(e) {
        j = "edit", n.AM.UTILS.HELPERS.switchPage("edit"), D = new s({sid: e}), S.trigger("modal:show", {type: "loading"});
        var t = function(e) {
            var t = "";
            if (D.isAlgoTrait())
                t = "algo", D = new o(e);
            else if (D.isRuleBasedTrait())
                t = "rule";
            else {
                if (!D.isOnboardedTrait()) {
                    S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("trait_edit_page_cannot_edit").message}), S.trigger("show:listpage");
                    return
                }
                t = "onboarded"
            }
            L.type = t, A = new f({type: t}), P.main.show(A), X()
        };
        D.fetch({data: {includeExprTree: !0}}).done(t).fail(function() {
            return S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("generic_error")}), !1
        })
    }, J = function(e) {
        j = "clone", n.AM.UTILS.HELPERS.switchPage("clone"), D = new s({sid: e}), S.trigger("modal:show", {type: "loading"});
        var t = function(e) {
            var t = "";
            if (D.isAlgoTrait())
                t = "algo", D = new o(e);
            else {
                if (!D.isRuleBasedTrait()) {
                    S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("trait_edit_page_cannot_edit").message}), S.trigger("show:listpage");
                    return
                }
                t = "rule"
            }
            L.type = t;
            var r = D.get("name");
            D.set("name", n.AM.MESSAGES.getMessage("clone_copy_of").message + " " + r), D.unset("id"), D.unset("sid"), A = new f({type: t}), P.main.show(A), X()
        };
        D.fetch({data: {includeExprTree: !0}}).done(t).fail(function() {
            return S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("generic_error")}), !1
        })
    };
    return L.begin = function(e) {
        P = e, new w({controller: E})
    }, S.on("show:createpage", function(e, t) {
        V(e, t)
    }), S.on("trait:save", function() {
        var t = null, r = null;
        t = I("input, select, textarea").filter(function(e, t) {
            return q.indexOf(D.getValidProperties(), t.name) >= 0
        });
        if (t.length === 0)
            return S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("generic_error").message}), !1;
        r = t.serializeJSON(), r.validator = {required: {name: ["notEmpty", "Name"],folderId: ["notEmpty", "Folder"],dataSourceId: ["notEmpty", "Data Source"],traitType: ["notEmpty", "Trait Type"]}}, L.type === "algo" && (q.extend(r.validator.required, {algoModelId: ["notEmpty", "AlgoModel"],accuracy: ["notEmpty", "Accuracy Value"]}), D.set("thresholdType", M.constructor.AccuracyThresholdName)), D.set(r, {silent: !0});
        if (!D.isValid())
            return S.trigger("modal:show", {type: "error",message: D.validationErrors.join("<br />")}), n.AM.UTILS.HELPERS.tempFixForChrome(), !1;
        if (L.type === "algo") {
            var i = B.getRunStats().getReachFromAccuracy(r.accuracy);
            if (R && parseInt(i, 10) > R)
                return S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("max_reach_audience_size").makeMessage(R)}), !1
        }
        var s = {cached_value: {}}, o = I("#" + D.get("folderId") + "_folder").parents("li:first").attr("id");
        o && (s.cached_value.folder = {parent: parseInt(o, 10)}), o = I("#" + D.get("categoryId") + "_cat").parents("li:first").attr("id"), o && (s.cached_value.category = {parent: parseInt(o, 10)}), n.AM.UTILS.HELPERS.cookieHandler.save("create_page_prefs", s), S.trigger("modal:show", {type: "loading"}), D.save().done(function() {
            e.history.navigate("#view/" + D.get("sid"), !0)
        }).fail(function(e) {
            var t = "";
            try {
                t = n.AM.MESSAGES.getAPIErrorMessage(e)
            } catch (r) {
                t = "An unexpected error occurred.  Please try again."
            }
            S.trigger("modal:show", {type: "error",message: t})
        })
    }), S.on("traitWidget:reset_and_return", function() {
        S.trigger("traitWidget:reset");
        try {
            I(_.tabs.get("els").get("container").el).find(".AUI_Tabs_tab").eq(0).trigger("click")
        } catch (e) {
        }
    }), S.on("show:editpage", function(e) {
        $(e.sid)
    }), S.on("show:clonepage", function(e) {
        J(e.sid)
    }), S.on("modal:model:selected", function(e) {
        I("body").removeClass("disableMainScroll");
        var t;
        B = e, t = e.loadRunStats(), t.done(function() {
            var t = D, r = t.get("accuracy") || "0.00", i = e.getRunStats(), s = function(e) {
                return String(parseFloat(e).toFixed(2))
            }, o = null;
            if (!e.runStatsAreValid())
                return S.trigger("modal:show", {type: "error",message: n.AM.MESSAGES.getMessage("no_valid_model_run_values").makeMessage(x.max_reach_audience_size)}), !1;
            try {
                o = i.where({AccuracyValue: s(r)})[0]
            } catch (u) {
                o = !1
            }
            O.adjust_reach_accuracy.show(new g({collection: e.getRunStats(),selected_reach_accuracy_model: M})), O.reach_accuracy.show(new y({collection: e.getRunStats(),selected_reach_accuracy_model: M})), o && (M.set(o.toJSON()), M.change()), M.unset("AccuracyValue", {silent: !0}), M.unset("ReachValue", {silent: !0}), H.render({name: e.get("name")}), I("#reach_accuracy_group").slideDown("slow"), S.trigger("modal:models:hide"), I("input[name=algoModelId]").val(e.get("id")), D.selected_model = e, S.trigger("modal:hide")
        }).fail(function() {
            S.trigger("modal:show", {message: "Sorry, there was an error loading the model stats.  Please try again."})
        })
    }), L
}), define("modules/User/Models/UserPermission", ["modules/Permission/Models/Permission"], function(e) {
    return e == undefined && (e = ADOBE.AM.Permission.Models.Permission), e.extend({name: "UserPermission"})
}), define("adobe_am/trait_builder/app", ["backbone", "backbone.marionette", "adobe_am/trait_builder/view", "adobe_am/trait_builder/list", "adobe_am/trait_builder/create", "globals", "modules/User/Models/UserPermission", "modules/Permission/Models/Permission", "adobe", "adobe_am/vent", "modules/Model/Collections/RunStats", "modules/DataSource/Collections/DataSourcesForTraits"], function(e, t, n, r, i, s, o, u, a, f, l, c) {
    var h = new e.Marionette.Application, p = e.Marionette.AppRouter.extend({}), d = new o({permissions: s.permissions.permissions}), v = window._globalDataSourcesForTraits;
    h.tmplCache = {}, h.trait_dpids_for_model_creation = [], l.MAX_REACH_AUDIENCE_SIZE = s.max_reach_audience_size, h.TraitRouter = p, h.addRegions({main: "#mainContent"}), h.on("initialize:after", function() {
        e.history && e.history.start()
    }), h.begin = function() {
        n.begin(h), r.begin(h), i.begin(h), h.start()
    }, h.user = {permissions: d,checked_perms: {can_create_trait: !1,can_create_model_with_trait: !1,can_show_delete_toolbar_button_in_traitbuilder: !1,can_show_add_segment_toolbar_button_in_traitbuilder: !1,can_view_segments: !1}};
    var m = h.user.checked_perms;
    h.GateKeeper = new a.AM.UTILS.GATEKEEPER, h.GateKeeper.setPermissionClass(u), h.GateKeeper.setErrorTypes(a.AM.UTILS.ERRORS.TYPES), h.GateKeeper.setSchemes(a.AM.PERMS.permission_schemes);
    var g = new c(v), y = g.filter(function(e) {
        return parseInt(e.get("pid"), 10) === parseInt(a.AM.pid, 10)
    }), b = new c(y), w = g.chain().filter(function(e) {
        return h.GateKeeper.checkPermissions([h.user.permissions, e.relational.permissions], "can_create_model_with_selected")
    }).map(function(e) {
        return e.get("dataSourceId")
    }).value();
    return h.trait_dpids_for_model_creation = w, w.length && (m.can_create_model_with_trait = !0), m.can_create_trait = b.some(function(e) {
        return h.GateKeeper.checkPermissions([h.user.permissions, e.relational.permissions], "can_create_trait_in_traitbuilder")
    }), m.can_show_delete_toolbar_button_in_traitbuilder = h.GateKeeper.checkPermissions([h.user.permissions], "can_show_delete_toolbar_button_in_traitbuilder"), m.can_show_add_segment_toolbar_button_in_traitbuilder = h.GateKeeper.checkPermissions([h.user.permissions], "can_show_add_segment_toolbar_button_in_traitbuilder"), h.modal = null, f.on("modal:show", function(e) {
        h.modal = a.AM.AlertModal(e), h.modal_type = e.type
    }), f.on("modal:hide", function() {
        h.modal && h.modal.hide(), h.modal_type = null
    }), f.on("title:change", window.navHelper.changeTitle), h
});
