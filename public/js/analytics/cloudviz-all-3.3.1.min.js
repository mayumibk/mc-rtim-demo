/*
 * ************************************************************************
 *
 *  ADOBE CONFIDENTIAL
 *  ___________________
 *
 *   (c) Copyright 2014 Adobe Systems, Inc.
 *   All Rights Reserved.
 *
 *  NOTICE:  All information contained herein is, and remains
 *  the property of Adobe Systems Incorporated and its suppliers,
 *  if any.  The intellectual and technical concepts contained
 *  herein are proprietary to Adobe Systems Incorporated and its
 *  suppliers and may be covered by U.S. and Foreign Patents,
 *  patents in process, and are protected by trade secret or copyright law.
 *  Dissemination of this information or reproduction of this material
 *  is strictly forbidden unless prior written permission is obtained
 *  from Adobe Systems Incorporated.
 * ************************************************************************
 */

/*
 * CloudViz - v3.3.0 - 2014-09-02
 * Copyright (c) 2014 Adobe Systems, Inc. All Rights Reserved.
 */

d3=function(){function t(t){return null!=t&&!isNaN(t)}function e(t){return t.length}function n(t){for(var e=1;t*e%1;)e*=10;return e}function i(t,e){try{for(var n in e)Object.defineProperty(t.prototype,n,{value:e[n],enumerable:!1})}catch(i){t.prototype=e}}function r(){}function a(){}function s(t,e,n){return function(){var i=n.apply(e,arguments);return i===e?t:i}}function o(t,e){if(e in t)return e;e=e.charAt(0).toUpperCase()+e.substring(1);for(var n=0,i=ho.length;i>n;++n){var r=ho[n]+e;if(r in t)return r}}function l(){}function c(){}function u(t){function e(){for(var e,i=n,r=-1,a=i.length;a>++r;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new r;return e.on=function(e,r){var a,s=i.get(e);return 2>arguments.length?s&&s.on:(s&&(s.on=null,n=n.slice(0,a=n.indexOf(s)).concat(n.slice(a+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function d(){Xs.event.preventDefault()}function h(){for(var t,e=Xs.event;t=e.sourceEvent;)e=t;return e}function p(t){for(var e=new c,n=0,i=arguments.length;i>++n;)e[arguments[n]]=u(e);return e.of=function(n,i){return function(r){try{var a=r.sourceEvent=Xs.event;r.target=t,Xs.event=r,e[r.type].apply(n,i)}finally{Xs.event=a}}},e}function f(t){return fo(t,yo),t}function g(t){return"function"==typeof t?t:function(){return go(t,this)}}function _(t){return"function"==typeof t?t:function(){return _o(t,this)}}function m(t,e){function n(){this.removeAttribute(t)}function i(){this.removeAttributeNS(t.space,t.local)}function r(){this.setAttribute(t,e)}function a(){this.setAttributeNS(t.space,t.local,e)}function s(){var n=e.apply(this,arguments);null==n?this.removeAttribute(t):this.setAttribute(t,n)}function o(){var n=e.apply(this,arguments);null==n?this.removeAttributeNS(t.space,t.local):this.setAttributeNS(t.space,t.local,n)}return t=Xs.ns.qualify(t),null==e?t.local?i:n:"function"==typeof e?t.local?o:s:t.local?a:r}function v(t){return t.trim().replace(/\s+/g," ")}function y(t){return RegExp("(?:^|\\s+)"+Xs.requote(t)+"(?:\\s+|$)","g")}function x(t){return t.trim().split(/^|\s+/)}function b(t,e){function n(){for(var n=-1;r>++n;)t[n](this,e)}function i(){for(var n=-1,i=e.apply(this,arguments);r>++n;)t[n](this,i)}t=x(t).map(A);var r=t.length;return"function"==typeof e?i:n}function A(t){var e=y(t);return function(n,i){if(r=n.classList)return i?r.add(t):r.remove(t);var r=n.getAttribute("class")||"";i?(e.lastIndex=0,e.test(r)||n.setAttribute("class",v(r+" "+t))):n.setAttribute("class",v(r.replace(e," ")))}}function k(t,e,n){function i(){this.style.removeProperty(t)}function r(){this.style.setProperty(t,e,n)}function a(){var i=e.apply(this,arguments);null==i?this.style.removeProperty(t):this.style.setProperty(t,i,n)}return null==e?i:"function"==typeof e?a:r}function S(t,e){function n(){delete this[t]}function i(){this[t]=e}function r(){var n=e.apply(this,arguments);null==n?delete this[t]:this[t]=n}return null==e?n:"function"==typeof e?r:i}function M(t){return"function"==typeof t?t:(t=Xs.ns.qualify(t)).local?function(){return this.ownerDocument.createElementNS(t.space,t.local)}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,t)}}function P(t){return{__data__:t}}function w(t){return function(){return vo(this,t)}}function O(t){return arguments.length||(t=Xs.ascending),function(e,n){return e&&n?t(e.__data__,n.__data__):!e-!n}}function T(t,e){for(var n=0,i=t.length;i>n;n++)for(var r,a=t[n],s=0,o=a.length;o>s;s++)(r=a[s])&&e(r,s,n);return t}function z(t){return fo(t,bo),t}function C(t){var e,n;return function(i,r,a){var s,o=t[a].update,l=o.length;for(a!=n&&(n=a,e=0),r>=e&&(e=r+1);!(s=o[e])&&l>++e;);return s}}function E(){var t=this.__transition__;t&&++t.active}function N(t,e,n){function i(){var e=this[s];e&&(this.removeEventListener(t,e,e.$),delete this[s])}function r(){var r=c(e,Js(arguments));i.call(this),this.addEventListener(t,this[s]=r,r.$=n),r._=e}function a(){var e,n=RegExp("^__on([^.]+)"+Xs.requote(t)+"$");for(var i in this)if(e=i.match(n)){var r=this[i];this.removeEventListener(e[1],r,r.$),delete this[i]}}var s="__on"+t,o=t.indexOf("."),c=D;o>0&&(t=t.substring(0,o));var u=ko.get(t);return u&&(t=u,c=F),o?e?r:i:e?l:a}function D(t,e){return function(n){var i=Xs.event;Xs.event=n,e[0]=this.__data__;try{t.apply(this,e)}finally{Xs.event=i}}}function F(t,e){var n=D(t,e);return function(t){var e=this,i=t.relatedTarget;i&&(i===e||8&i.compareDocumentPosition(e))||n.call(e,t)}}function L(){var t=".dragsuppress-"+ ++Mo,e="click"+t,n=Xs.select(Qs).on("touchmove"+t,d).on("dragstart"+t,d).on("selectstart"+t,d);if(So){var i=$s.style,r=i[So];i[So]="none"}return function(a){function s(){n.on(e,null)}n.on(t,null),So&&(i[So]=r),a&&(n.on(e,function(){d(),s()},!0),setTimeout(s,0))}}function I(t,e){e.changedTouches&&(e=e.changedTouches[0]);var n=t.ownerSVGElement||t;if(n.createSVGPoint){var i=n.createSVGPoint();if(0>Po&&(Qs.scrollX||Qs.scrollY)){n=Xs.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var r=n[0][0].getScreenCTM();Po=!(r.f||r.e),n.remove()}return Po?(i.x=e.pageX,i.y=e.pageY):(i.x=e.clientX,i.y=e.clientY),i=i.matrixTransform(t.getScreenCTM().inverse()),[i.x,i.y]}var a=t.getBoundingClientRect();return[e.clientX-a.left-t.clientLeft,e.clientY-a.top-t.clientTop]}function V(t){return t>0?1:0>t?-1:0}function B(t){return t>1?0:-1>t?wo:Math.acos(t)}function R(t){return t>1?To:-1>t?-To:Math.asin(t)}function j(t){return((t=Math.exp(t))-1/t)/2}function H(t){return((t=Math.exp(t))+1/t)/2}function q(t){return((t=Math.exp(2*t))-1)/(t+1)}function G(t){return(t=Math.sin(t/2))*t}function Y(){}function W(t,e,n){return new U(t,e,n)}function U(t,e,n){this.h=t,this.s=e,this.l=n}function X(t,e,n){function i(t){return t>360?t-=360:0>t&&(t+=360),60>t?a+(s-a)*t/60:180>t?s:240>t?a+(s-a)*(240-t)/60:a}function r(t){return Math.round(255*i(t))}var a,s;return t=isNaN(t)?0:0>(t%=360)?t+360:t,e=isNaN(e)?0:0>e?0:e>1?1:e,n=0>n?0:n>1?1:n,s=.5>=n?n*(1+e):n+e-n*e,a=2*n-s,oe(r(t+120),r(t),r(t-120))}function Z(t,e,n){return new J(t,e,n)}function J(t,e,n){this.h=t,this.c=e,this.l=n}function K(t,e,n){return isNaN(t)&&(t=0),isNaN(e)&&(e=0),$(n,Math.cos(t*=Eo)*e,Math.sin(t)*e)}function $(t,e,n){return new Q(t,e,n)}function Q(t,e,n){this.l=t,this.a=e,this.b=n}function te(t,e,n){var i=(t+16)/116,r=i+e/500,a=i-n/200;return r=ne(r)*qo,i=ne(i)*Go,a=ne(a)*Yo,oe(re(3.2404542*r-1.5371385*i-.4985314*a),re(-.969266*r+1.8760108*i+.041556*a),re(.0556434*r-.2040259*i+1.0572252*a))}function ee(t,e,n){return t>0?Z(Math.atan2(n,e)*No,Math.sqrt(e*e+n*n),t):Z(0/0,0/0,t)}function ne(t){return t>.206893034?t*t*t:(t-4/29)/7.787037}function ie(t){return t>.008856?Math.pow(t,1/3):7.787037*t+4/29}function re(t){return Math.round(255*(.00304>=t?12.92*t:1.055*Math.pow(t,1/2.4)-.055))}function ae(t){return oe(t>>16,255&t>>8,255&t)}function se(t){return ae(t)+""}function oe(t,e,n){return new le(t,e,n)}function le(t,e,n){this.r=t,this.g=e,this.b=n}function ce(t){return 16>t?"0"+Math.max(0,t).toString(16):Math.min(255,t).toString(16)}function ue(t,e,n){var i,r,a,s=0,o=0,l=0;if(i=/([a-z]+)\((.*)\)/i.exec(t))switch(r=i[2].split(","),i[1]){case"hsl":return n(parseFloat(r[0]),parseFloat(r[1])/100,parseFloat(r[2])/100);case"rgb":return e(fe(r[0]),fe(r[1]),fe(r[2]))}return(a=Xo.get(t))?e(a.r,a.g,a.b):(null!=t&&"#"===t.charAt(0)&&(4===t.length?(s=t.charAt(1),s+=s,o=t.charAt(2),o+=o,l=t.charAt(3),l+=l):7===t.length&&(s=t.substring(1,3),o=t.substring(3,5),l=t.substring(5,7)),s=parseInt(s,16),o=parseInt(o,16),l=parseInt(l,16)),e(s,o,l))}function de(t,e,n){var i,r,a=Math.min(t/=255,e/=255,n/=255),s=Math.max(t,e,n),o=s-a,l=(s+a)/2;return o?(r=.5>l?o/(s+a):o/(2-s-a),i=t==s?(e-n)/o+(n>e?6:0):e==s?(n-t)/o+2:(t-e)/o+4,i*=60):(i=0/0,r=l>0&&1>l?0:i),W(i,r,l)}function he(t,e,n){t=pe(t),e=pe(e),n=pe(n);var i=ie((.4124564*t+.3575761*e+.1804375*n)/qo),r=ie((.2126729*t+.7151522*e+.072175*n)/Go),a=ie((.0193339*t+.119192*e+.9503041*n)/Yo);return $(116*r-16,500*(i-r),200*(r-a))}function pe(t){return.04045>=(t/=255)?t/12.92:Math.pow((t+.055)/1.055,2.4)}function fe(t){var e=parseFloat(t);return"%"===t.charAt(t.length-1)?Math.round(2.55*e):e}function ge(t){return"function"==typeof t?t:function(){return t}}function _e(t){return t}function me(t){return function(e,n,i){return 2===arguments.length&&"function"==typeof n&&(i=n,n=null),ve(e,n,t,i)}}function ve(t,e,n,i){function r(){var t,e=l.status;if(!e&&l.responseText||e>=200&&300>e||304===e){try{t=n.call(a,l)}catch(i){return s.error.call(a,i),void 0}s.load.call(a,t)}else s.error.call(a,l)}var a={},s=Xs.dispatch("beforesend","progress","load","error"),o={},l=new XMLHttpRequest,c=null;return!Qs.XDomainRequest||"withCredentials"in l||!/^(http(s)?:)?\/\//.test(t)||(l=new XDomainRequest),"onload"in l?l.onload=l.onerror=r:l.onreadystatechange=function(){l.readyState>3&&r()},l.onprogress=function(t){var e=Xs.event;Xs.event=t;try{s.progress.call(a,l)}finally{Xs.event=e}},a.header=function(t,e){return t=(t+"").toLowerCase(),2>arguments.length?o[t]:(null==e?delete o[t]:o[t]=e+"",a)},a.mimeType=function(t){return arguments.length?(e=null==t?null:t+"",a):e},a.responseType=function(t){return arguments.length?(c=t,a):c},a.response=function(t){return n=t,a},["get","post"].forEach(function(t){a[t]=function(){return a.send.apply(a,[t].concat(Js(arguments)))}}),a.send=function(n,i,r){if(2===arguments.length&&"function"==typeof i&&(r=i,i=null),l.open(n,t,!0),null==e||"accept"in o||(o.accept=e+",*/*"),l.setRequestHeader)for(var u in o)l.setRequestHeader(u,o[u]);return null!=e&&l.overrideMimeType&&l.overrideMimeType(e),null!=c&&(l.responseType=c),null!=r&&a.on("error",r).on("load",function(t){r(null,t)}),s.beforesend.call(a,l),l.send(null==i?null:i),a},a.abort=function(){return l.abort(),a},Xs.rebind(a,s,"on"),null==i?a:a.get(ye(i))}function ye(t){return 1===t.length?function(e,n){t(null==e?n:null)}:t}function xe(){var t=be(),e=Ae()-t;e>24?(isFinite(e)&&(clearTimeout($o),$o=setTimeout(xe,e)),Ko=0):(Ko=1,tl(xe))}function be(){var t=Date.now();for(Qo=Zo;Qo;)t>=Qo.t&&(Qo.f=Qo.c(t-Qo.t)),Qo=Qo.n;return t}function Ae(){for(var t,e=Zo,n=1/0;e;)e.f?e=t?t.n=e.n:Zo=e.n:(n>e.t&&(n=e.t),e=(t=e).n);return Jo=t,n}function ke(t,e){var n=Math.pow(10,3*lo(8-e));return{scale:e>8?function(t){return t/n}:function(t){return t*n},symbol:t}}function Se(t,e){return e-(t?Math.ceil(Math.log(t)/Math.LN10):1)}function Me(t){return t+""}function Pe(){}function we(t,e,n){var i=n.s=t+e,r=i-t,a=i-r;n.t=t-a+(e-r)}function Oe(t,e){t&&hl.hasOwnProperty(t.type)&&hl[t.type](t,e)}function Te(t,e,n){var i,r=-1,a=t.length-n;for(e.lineStart();a>++r;)i=t[r],e.point(i[0],i[1],i[2]);e.lineEnd()}function ze(t,e){var n=-1,i=t.length;for(e.polygonStart();i>++n;)Te(t[n],e,1);e.polygonEnd()}function Ce(){function t(t,e){t*=Eo,e=e*Eo/2+wo/4;var n=t-i,s=Math.cos(e),o=Math.sin(e),l=a*o,c=r*s+l*Math.cos(n),u=l*Math.sin(n);fl.add(Math.atan2(u,c)),i=t,r=s,a=o}var e,n,i,r,a;gl.point=function(s,o){gl.point=t,i=(e=s)*Eo,r=Math.cos(o=(n=o)*Eo/2+wo/4),a=Math.sin(o)},gl.lineEnd=function(){t(e,n)}}function Ee(t){var e=t[0],n=t[1],i=Math.cos(n);return[i*Math.cos(e),i*Math.sin(e),Math.sin(n)]}function Ne(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]}function De(t,e){return[t[1]*e[2]-t[2]*e[1],t[2]*e[0]-t[0]*e[2],t[0]*e[1]-t[1]*e[0]]}function Fe(t,e){t[0]+=e[0],t[1]+=e[1],t[2]+=e[2]}function Le(t,e){return[t[0]*e,t[1]*e,t[2]*e]}function Ie(t){var e=Math.sqrt(t[0]*t[0]+t[1]*t[1]+t[2]*t[2]);t[0]/=e,t[1]/=e,t[2]/=e}function Ve(t){return[Math.atan2(t[1],t[0]),R(t[2])]}function Be(t,e){return zo>lo(t[0]-e[0])&&zo>lo(t[1]-e[1])}function Re(t,e){t*=Eo;var n=Math.cos(e*=Eo);je(n*Math.cos(t),n*Math.sin(t),Math.sin(e))}function je(t,e,n){++_l,vl+=(t-vl)/_l,yl+=(e-yl)/_l,xl+=(n-xl)/_l}function He(){function t(t,r){t*=Eo;var a=Math.cos(r*=Eo),s=a*Math.cos(t),o=a*Math.sin(t),l=Math.sin(r),c=Math.atan2(Math.sqrt((c=n*l-i*o)*c+(c=i*s-e*l)*c+(c=e*o-n*s)*c),e*s+n*o+i*l);ml+=c,bl+=c*(e+(e=s)),Al+=c*(n+(n=o)),kl+=c*(i+(i=l)),je(e,n,i)}var e,n,i;wl.point=function(r,a){r*=Eo;var s=Math.cos(a*=Eo);e=s*Math.cos(r),n=s*Math.sin(r),i=Math.sin(a),wl.point=t,je(e,n,i)}}function qe(){wl.point=Re}function Ge(){function t(t,e){t*=Eo;var n=Math.cos(e*=Eo),s=n*Math.cos(t),o=n*Math.sin(t),l=Math.sin(e),c=r*l-a*o,u=a*s-i*l,d=i*o-r*s,h=Math.sqrt(c*c+u*u+d*d),p=i*s+r*o+a*l,f=h&&-B(p)/h,g=Math.atan2(h,p);Sl+=f*c,Ml+=f*u,Pl+=f*d,ml+=g,bl+=g*(i+(i=s)),Al+=g*(r+(r=o)),kl+=g*(a+(a=l)),je(i,r,a)}var e,n,i,r,a;wl.point=function(s,o){e=s,n=o,wl.point=t,s*=Eo;var l=Math.cos(o*=Eo);i=l*Math.cos(s),r=l*Math.sin(s),a=Math.sin(o),je(i,r,a)},wl.lineEnd=function(){t(e,n),wl.lineEnd=qe,wl.point=Re}}function Ye(){return!0}function We(t,e,n,i,r){var a=[],s=[];if(t.forEach(function(t){if(!(0>=(e=t.length-1))){var e,n=t[0],i=t[e];if(Be(n,i)){r.lineStart();for(var o=0;e>o;++o)r.point((n=t[o])[0],n[1]);return r.lineEnd(),void 0}var l=new Xe(n,t,null,!0),c=new Xe(n,null,l,!1);l.o=c,a.push(l),s.push(c),l=new Xe(i,t,null,!1),c=new Xe(i,null,l,!0),l.o=c,a.push(l),s.push(c)}}),s.sort(e),Ue(a),Ue(s),a.length){for(var o=0,l=n,c=s.length;c>o;++o)s[o].e=l=!l;for(var u,d,h=a[0];;){for(var p=h,f=!0;p.v;)if((p=p.n)===h)return;u=p.z,r.lineStart();do{if(p.v=p.o.v=!0,p.e){if(f)for(var o=0,c=u.length;c>o;++o)r.point((d=u[o])[0],d[1]);else i(p.x,p.n.x,1,r);p=p.n}else{if(f){u=p.p.z;for(var o=u.length-1;o>=0;--o)r.point((d=u[o])[0],d[1])}else i(p.x,p.p.x,-1,r);p=p.p}p=p.o,u=p.z,f=!f}while(!p.v);r.lineEnd()}}}function Ue(t){if(e=t.length){for(var e,n,i=0,r=t[0];e>++i;)r.n=n=t[i],n.p=r,r=n;r.n=n=t[0],n.p=r}}function Xe(t,e,n,i){this.x=t,this.z=e,this.o=n,this.e=i,this.v=!1,this.n=this.p=null}function Ze(t,e,n,i){return function(r,a){function s(e,n){var i=r(e,n);t(e=i[0],n=i[1])&&a.point(e,n)}function o(t,e){var n=r(t,e);_.point(n[0],n[1])}function l(){v.point=o,_.lineStart()}function c(){v.point=s,_.lineEnd()}function u(t,e){g.push([t,e]);var n=r(t,e);x.point(n[0],n[1])}function d(){x.lineStart(),g=[]}function h(){u(g[0][0],g[0][1]),x.lineEnd();var t,e=x.clean(),n=y.buffer(),i=n.length;if(g.pop(),f.push(g),g=null,i){if(1&e){t=n[0];var r,i=t.length-1,s=-1;for(a.lineStart();i>++s;)a.point((r=t[s])[0],r[1]);return a.lineEnd(),void 0}i>1&&2&e&&n.push(n.pop().concat(n.shift())),p.push(n.filter(Je))}}var p,f,g,_=e(a),m=r.invert(i[0],i[1]),v={point:s,lineStart:l,lineEnd:c,polygonStart:function(){v.point=u,v.lineStart=d,v.lineEnd=h,p=[],f=[],a.polygonStart()},polygonEnd:function(){v.point=s,v.lineStart=l,v.lineEnd=c,p=Xs.merge(p);var t=Qe(m,f);p.length?We(p,$e,t,n,a):t&&(a.lineStart(),n(null,null,1,a),a.lineEnd()),a.polygonEnd(),p=f=null},sphere:function(){a.polygonStart(),a.lineStart(),n(null,null,1,a),a.lineEnd(),a.polygonEnd()}},y=Ke(),x=e(y);return v}}function Je(t){return t.length>1}function Ke(){var t,e=[];return{lineStart:function(){e.push(t=[])},point:function(e,n){t.push([e,n])},lineEnd:l,buffer:function(){var n=e;return e=[],t=null,n},rejoin:function(){e.length>1&&e.push(e.pop().concat(e.shift()))}}}function $e(t,e){return(0>(t=t.x)[0]?t[1]-To-zo:To-t[1])-(0>(e=e.x)[0]?e[1]-To-zo:To-e[1])}function Qe(t,e){var n=t[0],i=t[1],r=[Math.sin(n),-Math.cos(n),0],a=0,s=0;fl.reset();for(var o=0,l=e.length;l>o;++o){var c=e[o],u=c.length;if(u)for(var d=c[0],h=d[0],p=d[1]/2+wo/4,f=Math.sin(p),g=Math.cos(p),_=1;;){_===u&&(_=0),t=c[_];var m=t[0],v=t[1]/2+wo/4,y=Math.sin(v),x=Math.cos(v),b=m-h,A=lo(b)>wo,k=f*y;if(fl.add(Math.atan2(k*Math.sin(b),g*x+k*Math.cos(b))),a+=A?b+(b>=0?Oo:-Oo):b,A^h>=n^m>=n){var S=De(Ee(d),Ee(t));Ie(S);var M=De(r,S);Ie(M);var P=(A^b>=0?-1:1)*R(M[2]);(i>P||i===P&&(S[0]||S[1]))&&(s+=A^b>=0?1:-1)}if(!_++)break;h=m,f=y,g=x,d=t}}return(-zo>a||zo>a&&0>fl)^1&s}function tn(t){var e,n=0/0,i=0/0,r=0/0;return{lineStart:function(){t.lineStart(),e=1},point:function(a,s){var o=a>0?wo:-wo,l=lo(a-n);zo>lo(l-wo)?(t.point(n,i=(i+s)/2>0?To:-To),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),t.point(a,i),e=0):r!==o&&l>=wo&&(zo>lo(n-r)&&(n-=r*zo),zo>lo(a-o)&&(a-=o*zo),i=en(n,i,a,s),t.point(r,i),t.lineEnd(),t.lineStart(),t.point(o,i),e=0),t.point(n=a,i=s),r=o},lineEnd:function(){t.lineEnd(),n=i=0/0},clean:function(){return 2-e}}}function en(t,e,n,i){var r,a,s=Math.sin(t-n);return lo(s)>zo?Math.atan((Math.sin(e)*(a=Math.cos(i))*Math.sin(n)-Math.sin(i)*(r=Math.cos(e))*Math.sin(t))/(r*a*s)):(e+i)/2}function nn(t,e,n,i){var r;if(null==t)r=n*To,i.point(-wo,r),i.point(0,r),i.point(wo,r),i.point(wo,0),i.point(wo,-r),i.point(0,-r),i.point(-wo,-r),i.point(-wo,0),i.point(-wo,r);else if(lo(t[0]-e[0])>zo){var a=t[0]<e[0]?wo:-wo;r=n*a/2,i.point(-a,r),i.point(0,r),i.point(a,r)}else i.point(e[0],e[1])}function rn(t){function e(t,e){return Math.cos(t)*Math.cos(e)>a}function n(t){var n,a,l,c,u;return{lineStart:function(){c=l=!1,u=1},point:function(d,h){var p,f=[d,h],g=e(d,h),_=s?g?0:r(d,h):g?r(d+(0>d?wo:-wo),h):0;if(!n&&(c=l=g)&&t.lineStart(),g!==l&&(p=i(n,f),(Be(n,p)||Be(f,p))&&(f[0]+=zo,f[1]+=zo,g=e(f[0],f[1]))),g!==l)u=0,g?(t.lineStart(),p=i(f,n),t.point(p[0],p[1])):(p=i(n,f),t.point(p[0],p[1]),t.lineEnd()),n=p;else if(o&&n&&s^g){var m;_&a||!(m=i(f,n,!0))||(u=0,s?(t.lineStart(),t.point(m[0][0],m[0][1]),t.point(m[1][0],m[1][1]),t.lineEnd()):(t.point(m[1][0],m[1][1]),t.lineEnd(),t.lineStart(),t.point(m[0][0],m[0][1])))}!g||n&&Be(n,f)||t.point(f[0],f[1]),n=f,l=g,a=_},lineEnd:function(){l&&t.lineEnd(),n=null},clean:function(){return u|(c&&l)<<1}}}function i(t,e,n){var i=Ee(t),r=Ee(e),s=[1,0,0],o=De(i,r),l=Ne(o,o),c=o[0],u=l-c*c;if(!u)return!n&&t;var d=a*l/u,h=-a*c/u,p=De(s,o),f=Le(s,d),g=Le(o,h);Fe(f,g);var _=p,m=Ne(f,_),v=Ne(_,_),y=m*m-v*(Ne(f,f)-1);if(!(0>y)){var x=Math.sqrt(y),b=Le(_,(-m-x)/v);if(Fe(b,f),b=Ve(b),!n)return b;var A,k=t[0],S=e[0],M=t[1],P=e[1];k>S&&(A=k,k=S,S=A);var w=S-k,O=zo>lo(w-wo),T=O||zo>w;if(!O&&M>P&&(A=M,M=P,P=A),T?O?M+P>0^b[1]<(zo>lo(b[0]-k)?M:P):b[1]>=M&&P>=b[1]:w>wo^(b[0]>=k&&S>=b[0])){var z=Le(_,(-m+x)/v);return Fe(z,f),[b,Ve(z)]}}}function r(e,n){var i=s?t:wo-t,r=0;return-i>e?r|=1:e>i&&(r|=2),-i>n?r|=4:n>i&&(r|=8),r}var a=Math.cos(t),s=a>0,o=lo(a)>zo,l=En(t,6*Eo);return Ze(e,n,l,s?[0,-t]:[-wo,t-wo])}function an(t,e,n,i){return function(r){var a,s=r.a,o=r.b,l=s.x,c=s.y,u=o.x,d=o.y,h=0,p=1,f=u-l,g=d-c;if(a=t-l,f||!(a>0)){if(a/=f,0>f){if(h>a)return;p>a&&(p=a)}else if(f>0){if(a>p)return;a>h&&(h=a)}if(a=n-l,f||!(0>a)){if(a/=f,0>f){if(a>p)return;a>h&&(h=a)}else if(f>0){if(h>a)return;p>a&&(p=a)}if(a=e-c,g||!(a>0)){if(a/=g,0>g){if(h>a)return;p>a&&(p=a)}else if(g>0){if(a>p)return;a>h&&(h=a)}if(a=i-c,g||!(0>a)){if(a/=g,0>g){if(a>p)return;a>h&&(h=a)}else if(g>0){if(h>a)return;p>a&&(p=a)}return h>0&&(r.a={x:l+h*f,y:c+h*g}),1>p&&(r.b={x:l+p*f,y:c+p*g}),r}}}}}}function sn(t,e,n,i){function r(i,r){return zo>lo(i[0]-t)?r>0?0:3:zo>lo(i[0]-n)?r>0?2:1:zo>lo(i[1]-e)?r>0?1:0:r>0?3:2}function a(t,e){return s(t.x,e.x)}function s(t,e){var n=r(t,1),i=r(e,1);return n!==i?n-i:0===n?e[1]-t[1]:1===n?t[0]-e[0]:2===n?t[1]-e[1]:e[0]-t[0]}return function(o){function l(t){for(var e=0,n=m.length,i=t[1],r=0;n>r;++r)for(var a,s=1,o=m[r],l=o.length,u=o[0];l>s;++s)a=o[s],i>=u[1]?a[1]>i&&c(u,a,t)>0&&++e:i>=a[1]&&0>c(u,a,t)&&--e,u=a;return 0!==e}function c(t,e,n){return(e[0]-t[0])*(n[1]-t[1])-(n[0]-t[0])*(e[1]-t[1])}function u(a,o,l,c){var u=0,d=0;if(null==a||(u=r(a,l))!==(d=r(o,l))||0>s(a,o)^l>0){do c.point(0===u||3===u?t:n,u>1?i:e);while((u=(u+l+4)%4)!==d)}else c.point(o[0],o[1])}function d(r,a){return r>=t&&n>=r&&a>=e&&i>=a}function h(t,e){d(t,e)&&o.point(t,e)}function p(){z.point=g,m&&m.push(v=[]),M=!0,S=!1,A=k=0/0}function f(){_&&(g(y,x),b&&S&&O.rejoin(),_.push(O.buffer())),z.point=h,S&&o.lineEnd()}function g(t,e){t=Math.max(-Tl,Math.min(Tl,t)),e=Math.max(-Tl,Math.min(Tl,e));var n=d(t,e);if(m&&v.push([t,e]),M)y=t,x=e,b=n,M=!1,n&&(o.lineStart(),o.point(t,e));else if(n&&S)o.point(t,e);else{var i={a:{x:A,y:k},b:{x:t,y:e}};T(i)?(S||(o.lineStart(),o.point(i.a.x,i.a.y)),o.point(i.b.x,i.b.y),n||o.lineEnd(),P=!1):n&&(o.lineStart(),o.point(t,e),P=!1)}A=t,k=e,S=n}var _,m,v,y,x,b,A,k,S,M,P,w=o,O=Ke(),T=an(t,e,n,i),z={point:h,lineStart:p,lineEnd:f,polygonStart:function(){o=O,_=[],m=[],P=!0},polygonEnd:function(){o=w,_=Xs.merge(_);var e=l([t,i]),n=P&&e,r=_.length;(n||r)&&(o.polygonStart(),n&&(o.lineStart(),u(null,null,1,o),o.lineEnd()),r&&We(_,a,e,u,o),o.polygonEnd()),_=m=v=null}};return z}}function on(t,e){function n(n,i){return n=t(n,i),e(n[0],n[1])}return t.invert&&e.invert&&(n.invert=function(n,i){return n=e.invert(n,i),n&&t.invert(n[0],n[1])}),n}function ln(t){var e=0,n=wo/3,i=Sn(t),r=i(e,n);return r.parallels=function(t){return arguments.length?i(e=t[0]*wo/180,n=t[1]*wo/180):[180*(e/wo),180*(n/wo)]},r}function cn(t,e){function n(t,e){var n=Math.sqrt(a-2*r*Math.sin(e))/r;return[n*Math.sin(t*=r),s-n*Math.cos(t)]}var i=Math.sin(t),r=(i+Math.sin(e))/2,a=1+i*(2*r-i),s=Math.sqrt(a)/r;return n.invert=function(t,e){var n=s-e;return[Math.atan2(t,n)/r,R((a-(t*t+n*n)*r*r)/(2*r))]},n}function un(){function t(t,e){Cl+=r*t-i*e,i=t,r=e}var e,n,i,r;Ll.point=function(a,s){Ll.point=t,e=i=a,n=r=s},Ll.lineEnd=function(){t(e,n)}}function dn(t,e){El>t&&(El=t),t>Dl&&(Dl=t),Nl>e&&(Nl=e),e>Fl&&(Fl=e)}function hn(){function t(t,e){s.push("M",t,",",e,a)}function e(t,e){s.push("M",t,",",e),o.point=n}function n(t,e){s.push("L",t,",",e)}function i(){o.point=t}function r(){s.push("Z")}var a=pn(4.5),s=[],o={point:t,lineStart:function(){o.point=e},lineEnd:i,polygonStart:function(){o.lineEnd=r},polygonEnd:function(){o.lineEnd=i,o.point=t},pointRadius:function(t){return a=pn(t),o},result:function(){if(s.length){var t=s.join("");return s=[],t}}};return o}function pn(t){return"m0,"+t+"a"+t+","+t+" 0 1,1 0,"+-2*t+"a"+t+","+t+" 0 1,1 0,"+2*t+"z"}function fn(t,e){vl+=t,yl+=e,++xl}function gn(){function t(t,i){var r=t-e,a=i-n,s=Math.sqrt(r*r+a*a);bl+=s*(e+t)/2,Al+=s*(n+i)/2,kl+=s,fn(e=t,n=i)}var e,n;Vl.point=function(i,r){Vl.point=t,fn(e=i,n=r)}}function _n(){Vl.point=fn}function mn(){function t(t,e){var n=t-i,a=e-r,s=Math.sqrt(n*n+a*a);bl+=s*(i+t)/2,Al+=s*(r+e)/2,kl+=s,s=r*t-i*e,Sl+=s*(i+t),Ml+=s*(r+e),Pl+=3*s,fn(i=t,r=e)}var e,n,i,r;Vl.point=function(a,s){Vl.point=t,fn(e=i=a,n=r=s)},Vl.lineEnd=function(){t(e,n)}}function vn(t){function e(e,n){t.moveTo(e,n),t.arc(e,n,s,0,Oo)}function n(e,n){t.moveTo(e,n),o.point=i}function i(e,n){t.lineTo(e,n)}function r(){o.point=e}function a(){t.closePath()}var s=4.5,o={point:e,lineStart:function(){o.point=n},lineEnd:r,polygonStart:function(){o.lineEnd=a},polygonEnd:function(){o.lineEnd=r,o.point=e},pointRadius:function(t){return s=t,o},result:l};return o}function yn(t){function e(t){return(o?i:n)(t)}function n(e){return An(e,function(n,i){n=t(n,i),e.point(n[0],n[1])})}function i(e){function n(n,i){n=t(n,i),e.point(n[0],n[1])}function i(){y=0/0,S.point=a,e.lineStart()}function a(n,i){var a=Ee([n,i]),s=t(n,i);r(y,x,v,b,A,k,y=s[0],x=s[1],v=n,b=a[0],A=a[1],k=a[2],o,e),e.point(y,x)}function s(){S.point=n,e.lineEnd()}function l(){i(),S.point=c,S.lineEnd=u}function c(t,e){a(d=t,h=e),p=y,f=x,g=b,_=A,m=k,S.point=a}function u(){r(y,x,v,b,A,k,p,f,d,g,_,m,o,e),S.lineEnd=s,s()}var d,h,p,f,g,_,m,v,y,x,b,A,k,S={point:n,lineStart:i,lineEnd:s,polygonStart:function(){e.polygonStart(),S.lineStart=l},polygonEnd:function(){e.polygonEnd(),S.lineStart=i}};return S}function r(e,n,i,o,l,c,u,d,h,p,f,g,_,m){var v=u-e,y=d-n,x=v*v+y*y;if(x>4*a&&_--){var b=o+p,A=l+f,k=c+g,S=Math.sqrt(b*b+A*A+k*k),M=Math.asin(k/=S),P=zo>lo(lo(k)-1)||zo>lo(i-h)?(i+h)/2:Math.atan2(A,b),w=t(P,M),O=w[0],T=w[1],z=O-e,C=T-n,E=y*z-v*C;(E*E/x>a||lo((v*z+y*C)/x-.5)>.3||s>o*p+l*f+c*g)&&(r(e,n,i,o,l,c,O,T,P,b/=S,A/=S,k,_,m),m.point(O,T),r(O,T,P,b,A,k,u,d,h,p,f,g,_,m))}}var a=.5,s=Math.cos(30*Eo),o=16;return e.precision=function(t){return arguments.length?(o=(a=t*t)>0&&16,e):Math.sqrt(a)},e}function xn(t){var e=yn(function(e,n){return t([e*No,n*No])});return function(t){return Mn(e(t))}}function bn(t){this.stream=t}function An(t,e){return{point:e,sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function kn(t){return Sn(function(){return t})()}function Sn(t){function e(t){return t=o(t[0]*Eo,t[1]*Eo),[t[0]*h+l,c-t[1]*h]}function n(t){return t=o.invert((t[0]-l)/h,(c-t[1])/h),t&&[t[0]*No,t[1]*No]}function i(){o=on(s=On(m,v,y),a);var t=a(g,_);return l=p-t[0]*h,c=f+t[1]*h,r()}function r(){return u&&(u.valid=!1,u=null),e}var a,s,o,l,c,u,d=yn(function(t,e){return t=a(t,e),[t[0]*h+l,c-t[1]*h]}),h=150,p=480,f=250,g=0,_=0,m=0,v=0,y=0,x=Ol,b=_e,A=null,k=null;return e.stream=function(t){return u&&(u.valid=!1),u=Mn(x(s,d(b(t)))),u.valid=!0,u},e.clipAngle=function(t){return arguments.length?(x=null==t?(A=t,Ol):rn((A=+t)*Eo),r()):A},e.clipExtent=function(t){return arguments.length?(k=t,b=t?sn(t[0][0],t[0][1],t[1][0],t[1][1]):_e,r()):k},e.scale=function(t){return arguments.length?(h=+t,i()):h},e.translate=function(t){return arguments.length?(p=+t[0],f=+t[1],i()):[p,f]},e.center=function(t){return arguments.length?(g=t[0]%360*Eo,_=t[1]%360*Eo,i()):[g*No,_*No]},e.rotate=function(t){return arguments.length?(m=t[0]%360*Eo,v=t[1]%360*Eo,y=t.length>2?t[2]%360*Eo:0,i()):[m*No,v*No,y*No]},Xs.rebind(e,d,"precision"),function(){return a=t.apply(this,arguments),e.invert=a.invert&&n,i()}}function Mn(t){return An(t,function(e,n){t.point(e*Eo,n*Eo)})}function Pn(t,e){return[t,e]}function wn(t,e){return[t>wo?t-Oo:-wo>t?t+Oo:t,e]}function On(t,e,n){return t?e||n?on(zn(t),Cn(e,n)):zn(t):e||n?Cn(e,n):wn}function Tn(t){return function(e,n){return e+=t,[e>wo?e-Oo:-wo>e?e+Oo:e,n]}}function zn(t){var e=Tn(t);return e.invert=Tn(-t),e}function Cn(t,e){function n(t,e){var n=Math.cos(e),o=Math.cos(t)*n,l=Math.sin(t)*n,c=Math.sin(e),u=c*i+o*r;return[Math.atan2(l*a-u*s,o*i-c*r),R(u*a+l*s)]}var i=Math.cos(t),r=Math.sin(t),a=Math.cos(e),s=Math.sin(e);return n.invert=function(t,e){var n=Math.cos(e),o=Math.cos(t)*n,l=Math.sin(t)*n,c=Math.sin(e),u=c*a-l*s;return[Math.atan2(l*a+c*s,o*i+u*r),R(u*i-o*r)]},n}function En(t,e){var n=Math.cos(t),i=Math.sin(t);return function(r,a,s,o){var l=s*e;null!=r?(r=Nn(n,r),a=Nn(n,a),(s>0?a>r:r>a)&&(r+=s*Oo)):(r=t+s*Oo,a=t-.5*l);for(var c,u=r;s>0?u>a:a>u;u-=l)o.point((c=Ve([n,-i*Math.cos(u),-i*Math.sin(u)]))[0],c[1])}}function Nn(t,e){var n=Ee(e);n[0]-=t,Ie(n);var i=B(-n[1]);return((0>-n[2]?-i:i)+2*Math.PI-zo)%(2*Math.PI)}function Dn(t,e,n){var i=Xs.range(t,e-zo,n).concat(e);return function(t){return i.map(function(e){return[t,e]})}}function Fn(t,e,n){var i=Xs.range(t,e-zo,n).concat(e);return function(t){return i.map(function(e){return[e,t]})}}function Ln(t){return t.source}function In(t){return t.target}function Vn(t,e,n,i){var r=Math.cos(e),a=Math.sin(e),s=Math.cos(i),o=Math.sin(i),l=r*Math.cos(t),c=r*Math.sin(t),u=s*Math.cos(n),d=s*Math.sin(n),h=2*Math.asin(Math.sqrt(G(i-e)+r*s*G(n-t))),p=1/Math.sin(h),f=h?function(t){var e=Math.sin(t*=h)*p,n=Math.sin(h-t)*p,i=n*l+e*u,r=n*c+e*d,s=n*a+e*o;return[Math.atan2(r,i)*No,Math.atan2(s,Math.sqrt(i*i+r*r))*No]}:function(){return[t*No,e*No]};return f.distance=h,f}function Bn(){function t(t,r){var a=Math.sin(r*=Eo),s=Math.cos(r),o=lo((t*=Eo)-e),l=Math.cos(o);Bl+=Math.atan2(Math.sqrt((o=s*Math.sin(o))*o+(o=i*a-n*s*l)*o),n*a+i*s*l),e=t,n=a,i=s}var e,n,i;Rl.point=function(r,a){e=r*Eo,n=Math.sin(a*=Eo),i=Math.cos(a),Rl.point=t},Rl.lineEnd=function(){Rl.point=Rl.lineEnd=l}}function Rn(t,e){function n(e,n){var i=Math.cos(e),r=Math.cos(n),a=t(i*r);return[a*r*Math.sin(e),a*Math.sin(n)]}return n.invert=function(t,n){var i=Math.sqrt(t*t+n*n),r=e(i),a=Math.sin(r),s=Math.cos(r);return[Math.atan2(t*a,i*s),Math.asin(i&&n*a/i)]},n}function jn(t,e){function n(t,e){var n=zo>lo(lo(e)-To)?0:s/Math.pow(r(e),a);return[n*Math.sin(a*t),s-n*Math.cos(a*t)]}var i=Math.cos(t),r=function(t){return Math.tan(wo/4+t/2)},a=t===e?Math.sin(t):Math.log(i/Math.cos(e))/Math.log(r(e)/r(t)),s=i*Math.pow(r(t),a)/a;return a?(n.invert=function(t,e){var n=s-e,i=V(a)*Math.sqrt(t*t+n*n);return[Math.atan2(t,n)/a,2*Math.atan(Math.pow(s/i,1/a))-To]},n):qn}function Hn(t,e){function n(t,e){var n=a-e;return[n*Math.sin(r*t),a-n*Math.cos(r*t)]}var i=Math.cos(t),r=t===e?Math.sin(t):(i-Math.cos(e))/(e-t),a=i/r+t;return zo>lo(r)?Pn:(n.invert=function(t,e){var n=a-e;return[Math.atan2(t,n)/r,a-V(r)*Math.sqrt(t*t+n*n)]},n)}function qn(t,e){return[t,Math.log(Math.tan(wo/4+e/2))]}function Gn(t){var e,n=kn(t),i=n.scale,r=n.translate,a=n.clipExtent;return n.scale=function(){var t=i.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.translate=function(){var t=r.apply(n,arguments);return t===n?e?n.clipExtent(null):n:t},n.clipExtent=function(t){var s=a.apply(n,arguments);if(s===n){if(e=null==t){var o=wo*i(),l=r();a([[l[0]-o,l[1]-o],[l[0]+o,l[1]+o]])}}else e&&(s=null);return s},n.clipExtent(null)}function Yn(t,e){return[Math.log(Math.tan(wo/4+e/2)),-t]}function Wn(t){return t[0]}function Un(t){return t[1]}function Xn(t,e,n,i){var r,a,s,o,l,c,u;return r=i[t],a=r[0],s=r[1],r=i[e],o=r[0],l=r[1],r=i[n],c=r[0],u=r[1],(u-s)*(o-a)-(l-s)*(c-a)>0}function Zn(t,e,n){return(n[0]-e[0])*(t[1]-e[1])<(n[1]-e[1])*(t[0]-e[0])}function Jn(t,e,n,i){var r=t[0],a=n[0],s=e[0]-r,o=i[0]-a,l=t[1],c=n[1],u=e[1]-l,d=i[1]-c,h=(o*(l-c)-d*(r-a))/(d*s-o*u);return[r+h*s,l+h*u]}function Kn(t){var e=t[0],n=t[t.length-1];return!(e[0]-n[0]||e[1]-n[1])}function $n(){yi(this),this.edge=this.site=this.circle=null}function Qn(t){var e=$l.pop()||new $n;return e.site=t,e}function ti(t){ui(t),Zl.remove(t),$l.push(t),yi(t)}function ei(t){var e=t.circle,n=e.x,i=e.cy,r={x:n,y:i},a=t.P,s=t.N,o=[t];ti(t);for(var l=a;l.circle&&zo>lo(n-l.circle.x)&&zo>lo(i-l.circle.cy);)a=l.P,o.unshift(l),ti(l),l=a;o.unshift(l),ui(l);for(var c=s;c.circle&&zo>lo(n-c.circle.x)&&zo>lo(i-c.circle.cy);)s=c.N,o.push(c),ti(c),c=s;o.push(c),ui(c);var u,d=o.length;for(u=1;d>u;++u)c=o[u],l=o[u-1],_i(c.edge,l.site,c.site,r);l=o[0],c=o[d-1],c.edge=fi(l.site,c.site,null,r),ci(l),ci(c)}function ni(t){for(var e,n,i,r,a=t.x,s=t.y,o=Zl._;o;)if(i=ii(o,s)-a,i>zo)o=o.L;else{if(r=a-ri(o,s),!(r>zo)){i>-zo?(e=o.P,n=o):r>-zo?(e=o,n=o.N):e=n=o;break}if(!o.R){e=o;break}o=o.R}var l=Qn(t);if(Zl.insert(e,l),e||n){if(e===n)return ui(e),n=Qn(e.site),Zl.insert(l,n),l.edge=n.edge=fi(e.site,l.site),ci(e),ci(n),void 0;if(!n)return l.edge=fi(e.site,l.site),void 0;ui(e),ui(n);var c=e.site,u=c.x,d=c.y,h=t.x-u,p=t.y-d,f=n.site,g=f.x-u,_=f.y-d,m=2*(h*_-p*g),v=h*h+p*p,y=g*g+_*_,x={x:(_*v-p*y)/m+u,y:(h*y-g*v)/m+d};_i(n.edge,c,f,x),l.edge=fi(c,t,null,x),n.edge=fi(t,f,null,x),ci(e),ci(n)}}function ii(t,e){var n=t.site,i=n.x,r=n.y,a=r-e;if(!a)return i;var s=t.P;if(!s)return-1/0;n=s.site;var o=n.x,l=n.y,c=l-e;if(!c)return o;var u=o-i,d=1/a-1/c,h=u/c;return d?(-h+Math.sqrt(h*h-2*d*(u*u/(-2*c)-l+c/2+r-a/2)))/d+i:(i+o)/2}function ri(t,e){var n=t.N;if(n)return ii(n,e);var i=t.site;return i.y===e?i.x:1/0}function ai(t){this.site=t,this.edges=[]}function si(t){for(var e,n,i,r,a,s,o,l,c,u,d=t[0][0],h=t[1][0],p=t[0][1],f=t[1][1],g=Xl,_=g.length;_--;)if(a=g[_],a&&a.prepare())for(o=a.edges,l=o.length,s=0;l>s;)u=o[s].end(),i=u.x,r=u.y,c=o[++s%l].start(),e=c.x,n=c.y,(lo(i-e)>zo||lo(r-n)>zo)&&(o.splice(s,0,new mi(gi(a.site,u,zo>lo(i-d)&&f-r>zo?{x:d,y:zo>lo(e-d)?n:f}:zo>lo(r-f)&&h-i>zo?{x:zo>lo(n-f)?e:h,y:f}:zo>lo(i-h)&&r-p>zo?{x:h,y:zo>lo(e-h)?n:p}:zo>lo(r-p)&&i-d>zo?{x:zo>lo(n-p)?e:d,y:p}:null),a.site,null)),++l)}function oi(t,e){return e.angle-t.angle}function li(){yi(this),this.x=this.y=this.arc=this.site=this.cy=null}function ci(t){var e=t.P,n=t.N;if(e&&n){var i=e.site,r=t.site,a=n.site;if(i!==a){var s=r.x,o=r.y,l=i.x-s,c=i.y-o,u=a.x-s,d=a.y-o,h=2*(l*d-c*u);if(!(h>=-Co)){var p=l*l+c*c,f=u*u+d*d,g=(d*p-c*f)/h,_=(l*f-u*p)/h,d=_+o,m=Ql.pop()||new li;m.arc=t,m.site=r,m.x=g+s,m.y=d+Math.sqrt(g*g+_*_),m.cy=d,t.circle=m;for(var v=null,y=Kl._;y;)if(m.y<y.y||m.y===y.y&&m.x<=y.x){if(!y.L){v=y.P;break}y=y.L}else{if(!y.R){v=y;break}y=y.R}Kl.insert(v,m),v||(Jl=m)}}}}function ui(t){var e=t.circle;e&&(e.P||(Jl=e.N),Kl.remove(e),Ql.push(e),yi(e),t.circle=null)}function di(t){for(var e,n=Ul,i=an(t[0][0],t[0][1],t[1][0],t[1][1]),r=n.length;r--;)e=n[r],(!hi(e,t)||!i(e)||zo>lo(e.a.x-e.b.x)&&zo>lo(e.a.y-e.b.y))&&(e.a=e.b=null,n.splice(r,1))}function hi(t,e){var n=t.b;if(n)return!0;var i,r,a=t.a,s=e[0][0],o=e[1][0],l=e[0][1],c=e[1][1],u=t.l,d=t.r,h=u.x,p=u.y,f=d.x,g=d.y,_=(h+f)/2,m=(p+g)/2;
if(g===p){if(s>_||_>=o)return;if(h>f){if(a){if(a.y>=c)return}else a={x:_,y:l};n={x:_,y:c}}else{if(a){if(l>a.y)return}else a={x:_,y:c};n={x:_,y:l}}}else if(i=(h-f)/(g-p),r=m-i*_,-1>i||i>1)if(h>f){if(a){if(a.y>=c)return}else a={x:(l-r)/i,y:l};n={x:(c-r)/i,y:c}}else{if(a){if(l>a.y)return}else a={x:(c-r)/i,y:c};n={x:(l-r)/i,y:l}}else if(g>p){if(a){if(a.x>=o)return}else a={x:s,y:i*s+r};n={x:o,y:i*o+r}}else{if(a){if(s>a.x)return}else a={x:o,y:i*o+r};n={x:s,y:i*s+r}}return t.a=a,t.b=n,!0}function pi(t,e){this.l=t,this.r=e,this.a=this.b=null}function fi(t,e,n,i){var r=new pi(t,e);return Ul.push(r),n&&_i(r,t,e,n),i&&_i(r,e,t,i),Xl[t.i].edges.push(new mi(r,t,e)),Xl[e.i].edges.push(new mi(r,e,t)),r}function gi(t,e,n){var i=new pi(t,null);return i.a=e,i.b=n,Ul.push(i),i}function _i(t,e,n,i){t.a||t.b?t.l===n?t.b=i:t.a=i:(t.a=i,t.l=e,t.r=n)}function mi(t,e,n){var i=t.a,r=t.b;this.edge=t,this.site=e,this.angle=n?Math.atan2(n.y-e.y,n.x-e.x):t.l===e?Math.atan2(r.x-i.x,i.y-r.y):Math.atan2(i.x-r.x,r.y-i.y)}function vi(){this._=null}function yi(t){t.U=t.C=t.L=t.R=t.P=t.N=null}function xi(t,e){var n=e,i=e.R,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.R=i.L,n.R&&(n.R.U=n),i.L=n}function bi(t,e){var n=e,i=e.L,r=n.U;r?r.L===n?r.L=i:r.R=i:t._=i,i.U=r,n.U=i,n.L=i.R,n.L&&(n.L.U=n),i.R=n}function Ai(t){for(;t.L;)t=t.L;return t}function ki(t,e){var n,i,r,a=t.sort(Si).pop();for(Ul=[],Xl=Array(t.length),Zl=new vi,Kl=new vi;;)if(r=Jl,a&&(!r||a.y<r.y||a.y===r.y&&a.x<r.x))(a.x!==n||a.y!==i)&&(Xl[a.i]=new ai(a),ni(a),n=a.x,i=a.y),a=t.pop();else{if(!r)break;ei(r.arc)}e&&(di(e),si(e));var s={cells:Xl,edges:Ul};return Zl=Kl=Ul=Xl=null,s}function Si(t,e){return e.y-t.y||e.x-t.x}function Mi(t,e,n){return(t.x-n.x)*(e.y-t.y)-(t.x-e.x)*(n.y-t.y)}function Pi(t){return t.x}function wi(t){return t.y}function Oi(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function Ti(t,e,n,i,r,a){if(!t(e,n,i,r,a)){var s=.5*(n+r),o=.5*(i+a),l=e.nodes;l[0]&&Ti(t,l[0],n,i,s,o),l[1]&&Ti(t,l[1],s,i,r,o),l[2]&&Ti(t,l[2],n,o,s,a),l[3]&&Ti(t,l[3],s,o,r,a)}}function zi(t,e){t=Xs.rgb(t),e=Xs.rgb(e);var n=t.r,i=t.g,r=t.b,a=e.r-n,s=e.g-i,o=e.b-r;return function(t){return"#"+ce(Math.round(n+a*t))+ce(Math.round(i+s*t))+ce(Math.round(r+o*t))}}function Ci(t,e){var n,i={},r={};for(n in t)n in e?i[n]=Di(t[n],e[n]):r[n]=t[n];for(n in e)n in t||(r[n]=e[n]);return function(t){for(n in i)r[n]=i[n](t);return r}}function Ei(t,e){return e-=t=+t,function(n){return t+e*n}}function Ni(t,e){var n,i,r,a,s,o=0,l=0,c=[],u=[];for(t+="",e+="",ec.lastIndex=0,i=0;n=ec.exec(e);++i)n.index&&c.push(e.substring(o,l=n.index)),u.push({i:c.length,x:n[0]}),c.push(null),o=ec.lastIndex;for(e.length>o&&c.push(e.substring(o)),i=0,a=u.length;(n=ec.exec(t))&&a>i;++i)if(s=u[i],s.x==n[0]){if(s.i)if(null==c[s.i+1])for(c[s.i-1]+=s.x,c.splice(s.i,1),r=i+1;a>r;++r)u[r].i--;else for(c[s.i-1]+=s.x+c[s.i+1],c.splice(s.i,2),r=i+1;a>r;++r)u[r].i-=2;else if(null==c[s.i+1])c[s.i]=s.x;else for(c[s.i]=s.x+c[s.i+1],c.splice(s.i+1,1),r=i+1;a>r;++r)u[r].i--;u.splice(i,1),a--,i--}else s.x=Ei(parseFloat(n[0]),parseFloat(s.x));for(;a>i;)s=u.pop(),null==c[s.i+1]?c[s.i]=s.x:(c[s.i]=s.x+c[s.i+1],c.splice(s.i+1,1)),a--;return 1===c.length?null==c[0]?(s=u[0].x,function(t){return s(t)+""}):function(){return e}:function(t){for(i=0;a>i;++i)c[(s=u[i]).i]=s.x(t);return c.join("")}}function Di(t,e){for(var n,i=Xs.interpolators.length;--i>=0&&!(n=Xs.interpolators[i](t,e)););return n}function Fi(t,e){var n,i=[],r=[],a=t.length,s=e.length,o=Math.min(t.length,e.length);for(n=0;o>n;++n)i.push(Di(t[n],e[n]));for(;a>n;++n)r[n]=t[n];for(;s>n;++n)r[n]=e[n];return function(t){for(n=0;o>n;++n)r[n]=i[n](t);return r}}function Li(t){return function(e){return 0>=e?0:e>=1?1:t(e)}}function Ii(t){return function(e){return 1-t(1-e)}}function Vi(t){return function(e){return.5*(.5>e?t(2*e):2-t(2-2*e))}}function Bi(t){return t*t}function Ri(t){return t*t*t}function ji(t){if(0>=t)return 0;if(t>=1)return 1;var e=t*t,n=e*t;return 4*(.5>t?n:3*(t-e)+n-.75)}function Hi(t){return function(e){return Math.pow(e,t)}}function qi(t){return 1-Math.cos(t*To)}function Gi(t){return Math.pow(2,10*(t-1))}function Yi(t){return 1-Math.sqrt(1-t*t)}function Wi(t,e){var n;return 2>arguments.length&&(e=.45),arguments.length?n=e/Oo*Math.asin(1/t):(t=1,n=e/4),function(i){return 1+t*Math.pow(2,-10*i)*Math.sin((i-n)*Oo/e)}}function Ui(t){return t||(t=1.70158),function(e){return e*e*((t+1)*e-t)}}function Xi(t){return 1/2.75>t?7.5625*t*t:2/2.75>t?7.5625*(t-=1.5/2.75)*t+.75:2.5/2.75>t?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375}function Zi(t,e){t=Xs.hcl(t),e=Xs.hcl(e);var n=t.h,i=t.c,r=t.l,a=e.h-n,s=e.c-i,o=e.l-r;return isNaN(s)&&(s=0,i=isNaN(i)?e.c:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:-180>a&&(a+=360),function(t){return K(n+a*t,i+s*t,r+o*t)+""}}function Ji(t,e){t=Xs.hsl(t),e=Xs.hsl(e);var n=t.h,i=t.s,r=t.l,a=e.h-n,s=e.s-i,o=e.l-r;return isNaN(s)&&(s=0,i=isNaN(i)?e.s:i),isNaN(a)?(a=0,n=isNaN(n)?e.h:n):a>180?a-=360:-180>a&&(a+=360),function(t){return X(n+a*t,i+s*t,r+o*t)+""}}function Ki(t,e){t=Xs.lab(t),e=Xs.lab(e);var n=t.l,i=t.a,r=t.b,a=e.l-n,s=e.a-i,o=e.b-r;return function(t){return te(n+a*t,i+s*t,r+o*t)+""}}function $i(t,e){return e-=t,function(n){return Math.round(t+e*n)}}function Qi(t){var e=[t.a,t.b],n=[t.c,t.d],i=er(e),r=tr(e,n),a=er(nr(n,e,-r))||0;e[0]*n[1]<n[0]*e[1]&&(e[0]*=-1,e[1]*=-1,i*=-1,r*=-1),this.rotate=(i?Math.atan2(e[1],e[0]):Math.atan2(-n[0],n[1]))*No,this.translate=[t.e,t.f],this.scale=[i,a],this.skew=a?Math.atan2(r,a)*No:0}function tr(t,e){return t[0]*e[0]+t[1]*e[1]}function er(t){var e=Math.sqrt(tr(t,t));return e&&(t[0]/=e,t[1]/=e),e}function nr(t,e,n){return t[0]+=n*e[0],t[1]+=n*e[1],t}function ir(t,e){var n,i=[],r=[],a=Xs.transform(t),s=Xs.transform(e),o=a.translate,l=s.translate,c=a.rotate,u=s.rotate,d=a.skew,h=s.skew,p=a.scale,f=s.scale;return o[0]!=l[0]||o[1]!=l[1]?(i.push("translate(",null,",",null,")"),r.push({i:1,x:Ei(o[0],l[0])},{i:3,x:Ei(o[1],l[1])})):l[0]||l[1]?i.push("translate("+l+")"):i.push(""),c!=u?(c-u>180?u+=360:u-c>180&&(c+=360),r.push({i:i.push(i.pop()+"rotate(",null,")")-2,x:Ei(c,u)})):u&&i.push(i.pop()+"rotate("+u+")"),d!=h?r.push({i:i.push(i.pop()+"skewX(",null,")")-2,x:Ei(d,h)}):h&&i.push(i.pop()+"skewX("+h+")"),p[0]!=f[0]||p[1]!=f[1]?(n=i.push(i.pop()+"scale(",null,",",null,")"),r.push({i:n-4,x:Ei(p[0],f[0])},{i:n-2,x:Ei(p[1],f[1])})):(1!=f[0]||1!=f[1])&&i.push(i.pop()+"scale("+f+")"),n=r.length,function(t){for(var e,a=-1;n>++a;)i[(e=r[a]).i]=e.x(t);return i.join("")}}function rr(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return(n-t)*e}}function ar(t,e){return e=e-(t=+t)?1/(e-t):0,function(n){return Math.max(0,Math.min(1,(n-t)*e))}}function sr(t){for(var e=t.source,n=t.target,i=lr(e,n),r=[e];e!==i;)e=e.parent,r.push(e);for(var a=r.length;n!==i;)r.splice(a,0,n),n=n.parent;return r}function or(t){for(var e=[],n=t.parent;null!=n;)e.push(t),t=n,n=n.parent;return e.push(t),e}function lr(t,e){if(t===e)return t;for(var n=or(t),i=or(e),r=n.pop(),a=i.pop(),s=null;r===a;)s=r,r=n.pop(),a=i.pop();return s}function cr(t){t.fixed|=2}function ur(t){t.fixed&=-7}function dr(t){t.fixed|=4,t.px=t.x,t.py=t.y}function hr(t){t.fixed&=-5}function pr(t,e,n){var i=0,r=0;if(t.charge=0,!t.leaf)for(var a,s=t.nodes,o=s.length,l=-1;o>++l;)a=s[l],null!=a&&(pr(a,e,n),t.charge+=a.charge,i+=a.charge*a.cx,r+=a.charge*a.cy);if(t.point){t.leaf||(t.point.x+=Math.random()-.5,t.point.y+=Math.random()-.5);var c=e*n[t.point.index];t.charge+=t.pointCharge=c,i+=c*t.point.x,r+=c*t.point.y}t.cx=i/t.charge,t.cy=r/t.charge}function fr(t,e){return Xs.rebind(t,e,"sort","children","value"),t.nodes=t,t.links=vr,t}function gr(t){return t.children}function _r(t){return t.value}function mr(t,e){return e.value-t.value}function vr(t){return Xs.merge(t.map(function(t){return(t.children||[]).map(function(e){return{source:t,target:e}})}))}function yr(t){return t.x}function xr(t){return t.y}function br(t,e,n){t.y0=e,t.y=n}function Ar(t){return Xs.range(t.length)}function kr(t){for(var e=-1,n=t[0].length,i=[];n>++e;)i[e]=0;return i}function Sr(t){for(var e,n=1,i=0,r=t[0][1],a=t.length;a>n;++n)(e=t[n][1])>r&&(i=n,r=e);return i}function Mr(t){return t.reduce(Pr,0)}function Pr(t,e){return t+e[1]}function wr(t,e){return Or(t,Math.ceil(Math.log(e.length)/Math.LN2+1))}function Or(t,e){for(var n=-1,i=+t[0],r=(t[1]-i)/e,a=[];e>=++n;)a[n]=r*n+i;return a}function Tr(t){return[Xs.min(t),Xs.max(t)]}function zr(t,e){return t.parent==e.parent?1:2}function Cr(t){var e=t.children;return e&&e.length?e[0]:t._tree.thread}function Er(t){var e,n=t.children;return n&&(e=n.length)?n[e-1]:t._tree.thread}function Nr(t,e){var n=t.children;if(n&&(r=n.length))for(var i,r,a=-1;r>++a;)e(i=Nr(n[a],e),t)>0&&(t=i);return t}function Dr(t,e){return t.x-e.x}function Fr(t,e){return e.x-t.x}function Lr(t,e){return t.depth-e.depth}function Ir(t,e){function n(t,i){var r=t.children;if(r&&(s=r.length))for(var a,s,o=null,l=-1;s>++l;)a=r[l],n(a,o),o=a;e(t,i)}n(t,null)}function Vr(t){for(var e,n=0,i=0,r=t.children,a=r.length;--a>=0;)e=r[a]._tree,e.prelim+=n,e.mod+=n,n+=e.shift+(i+=e.change)}function Br(t,e,n){t=t._tree,e=e._tree;var i=n/(e.number-t.number);t.change+=i,e.change-=i,e.shift+=n,e.prelim+=n,e.mod+=n}function Rr(t,e,n){return t._tree.ancestor.parent==e.parent?t._tree.ancestor:n}function jr(t,e){return t.value-e.value}function Hr(t,e){var n=t._pack_next;t._pack_next=e,e._pack_prev=t,e._pack_next=n,n._pack_prev=e}function qr(t,e){t._pack_next=e,e._pack_prev=t}function Gr(t,e){var n=e.x-t.x,i=e.y-t.y,r=t.r+e.r;return.999*r*r>n*n+i*i}function Yr(t){function e(t){u=Math.min(t.x-t.r,u),d=Math.max(t.x+t.r,d),h=Math.min(t.y-t.r,h),p=Math.max(t.y+t.r,p)}if((n=t.children)&&(c=n.length)){var n,i,r,a,s,o,l,c,u=1/0,d=-1/0,h=1/0,p=-1/0;if(n.forEach(Wr),i=n[0],i.x=-i.r,i.y=0,e(i),c>1&&(r=n[1],r.x=r.r,r.y=0,e(r),c>2))for(a=n[2],Zr(i,r,a),e(a),Hr(i,a),i._pack_prev=a,Hr(a,r),r=i._pack_next,s=3;c>s;s++){Zr(i,r,a=n[s]);var f=0,g=1,_=1;for(o=r._pack_next;o!==r;o=o._pack_next,g++)if(Gr(o,a)){f=1;break}if(1==f)for(l=i._pack_prev;l!==o._pack_prev&&!Gr(l,a);l=l._pack_prev,_++);f?(_>g||g==_&&r.r<i.r?qr(i,r=o):qr(i=l,r),s--):(Hr(i,a),r=a,e(a))}var m=(u+d)/2,v=(h+p)/2,y=0;for(s=0;c>s;s++)a=n[s],a.x-=m,a.y-=v,y=Math.max(y,a.r+Math.sqrt(a.x*a.x+a.y*a.y));t.r=y,n.forEach(Ur)}}function Wr(t){t._pack_next=t._pack_prev=t}function Ur(t){delete t._pack_next,delete t._pack_prev}function Xr(t,e,n,i){var r=t.children;if(t.x=e+=i*t.x,t.y=n+=i*t.y,t.r*=i,r)for(var a=-1,s=r.length;s>++a;)Xr(r[a],e,n,i)}function Zr(t,e,n){var i=t.r+n.r,r=e.x-t.x,a=e.y-t.y;if(i&&(r||a)){var s=e.r+n.r,o=r*r+a*a;s*=s,i*=i;var l=.5+(i-s)/(2*o),c=Math.sqrt(Math.max(0,2*s*(i+o)-(i-=o)*i-s*s))/(2*o);n.x=t.x+l*r+c*a,n.y=t.y+l*a-c*r}else n.x=t.x+i,n.y=t.y}function Jr(t){return 1+Xs.max(t,function(t){return t.y})}function Kr(t){return t.reduce(function(t,e){return t+e.x},0)/t.length}function $r(t){var e=t.children;return e&&e.length?$r(e[0]):t}function Qr(t){var e,n=t.children;return n&&(e=n.length)?Qr(n[e-1]):t}function ta(t){return{x:t.x,y:t.y,dx:t.dx,dy:t.dy}}function ea(t,e){var n=t.x+e[3],i=t.y+e[0],r=t.dx-e[1]-e[3],a=t.dy-e[0]-e[2];return 0>r&&(n+=r/2,r=0),0>a&&(i+=a/2,a=0),{x:n,y:i,dx:r,dy:a}}function na(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}function ia(t){return t.rangeExtent?t.rangeExtent():na(t.range())}function ra(t,e,n,i){var r=n(t[0],t[1]),a=i(e[0],e[1]);return function(t){return a(r(t))}}function aa(t,e){var n,i=0,r=t.length-1,a=t[i],s=t[r];return a>s&&(n=i,i=r,r=n,n=a,a=s,s=n),t[i]=e.floor(a),t[r]=e.ceil(s),t}function sa(t){return t?{floor:function(e){return Math.floor(e/t)*t},ceil:function(e){return Math.ceil(e/t)*t}}:dc}function oa(t,e,n,i){var r=[],a=[],s=0,o=Math.min(t.length,e.length)-1;for(t[o]<t[0]&&(t=t.slice().reverse(),e=e.slice().reverse());o>=++s;)r.push(n(t[s-1],t[s])),a.push(i(e[s-1],e[s]));return function(e){var n=Xs.bisect(t,e,1,o)-1;return a[n](r[n](e))}}function la(t,e,n,i){function r(){var r=Math.min(t.length,e.length)>2?oa:ra,l=i?ar:rr;return s=r(t,e,l,n),o=r(e,t,l,Di),a}function a(t){return s(t)}var s,o;return a.invert=function(t){return o(t)},a.domain=function(e){return arguments.length?(t=e.map(Number),r()):t},a.range=function(t){return arguments.length?(e=t,r()):e},a.rangeRound=function(t){return a.range(t).interpolate($i)},a.clamp=function(t){return arguments.length?(i=t,r()):i},a.interpolate=function(t){return arguments.length?(n=t,r()):n},a.ticks=function(e){return ha(t,e)},a.tickFormat=function(e,n){return pa(t,e,n)},a.nice=function(e){return ua(t,e),r()},a.copy=function(){return la(t,e,n,i)},r()}function ca(t,e){return Xs.rebind(t,e,"range","rangeRound","interpolate","clamp")}function ua(t,e){return aa(t,sa(da(t,e)[2]))}function da(t,e){null==e&&(e=10);var n=na(t),i=n[1]-n[0],r=Math.pow(10,Math.floor(Math.log(i/e)/Math.LN10)),a=e/i*r;return.15>=a?r*=10:.35>=a?r*=5:.75>=a&&(r*=2),n[0]=Math.ceil(n[0]/r)*r,n[1]=Math.floor(n[1]/r)*r+.5*r,n[2]=r,n}function ha(t,e){return Xs.range.apply(Xs,da(t,e))}function pa(t,e,n){var i=da(t,e);return Xs.format(n?n.replace(sl,function(t,e,n,r,a,s,o,l,c,u){return[e,n,r,a,s,o,l,c||"."+ga(u,i),u].join("")}):",."+fa(i[2])+"f")}function fa(t){return-Math.floor(Math.log(t)/Math.LN10+.01)}function ga(t,e){var n=fa(e[2]);return t in hc?Math.abs(n-fa(Math.max(Math.abs(e[0]),Math.abs(e[1]))))+ +("e"!==t):n-2*("%"===t)}function _a(t,e,n,i){function r(t){return(n?Math.log(0>t?0:t):-Math.log(t>0?0:-t))/Math.log(e)}function a(t){return n?Math.pow(e,t):-Math.pow(e,-t)}function s(e){return t(r(e))}return s.invert=function(e){return a(t.invert(e))},s.domain=function(e){return arguments.length?(n=e[0]>=0,t.domain((i=e.map(Number)).map(r)),s):i},s.base=function(n){return arguments.length?(e=+n,t.domain(i.map(r)),s):e},s.nice=function(){var e=aa(i.map(r),n?Math:fc);return t.domain(e),i=e.map(a),s},s.ticks=function(){var t=na(i),s=[],o=t[0],l=t[1],c=Math.floor(r(o)),u=Math.ceil(r(l)),d=e%1?2:e;if(isFinite(u-c)){if(n){for(;u>c;c++)for(var h=1;d>h;h++)s.push(a(c)*h);s.push(a(c))}else for(s.push(a(c));u>c++;)for(var h=d-1;h>0;h--)s.push(a(c)*h);for(c=0;o>s[c];c++);for(u=s.length;s[u-1]>l;u--);s=s.slice(c,u)}return s},s.tickFormat=function(t,e){if(!arguments.length)return pc;2>arguments.length?e=pc:"function"!=typeof e&&(e=Xs.format(e));var i,o=Math.max(.1,t/s.ticks().length),l=n?(i=1e-12,Math.ceil):(i=-1e-12,Math.floor);return function(t){return o>=t/a(l(r(t)+i))?e(t):""}},s.copy=function(){return _a(t.copy(),e,n,i)},ca(s,t)}function ma(t,e,n){function i(e){return t(r(e))}var r=va(e),a=va(1/e);return i.invert=function(e){return a(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain((n=e.map(Number)).map(r)),i):n},i.ticks=function(t){return ha(n,t)},i.tickFormat=function(t,e){return pa(n,t,e)},i.nice=function(t){return i.domain(ua(n,t))},i.exponent=function(s){return arguments.length?(r=va(e=s),a=va(1/e),t.domain(n.map(r)),i):e},i.copy=function(){return ma(t.copy(),e,n)},ca(i,t)}function va(t){return function(e){return 0>e?-Math.pow(-e,t):Math.pow(e,t)}}function ya(t,e){function n(n){return s[((a.get(n)||"range"===e.t&&a.set(n,t.push(n)))-1)%s.length]}function i(e,n){return Xs.range(t.length).map(function(t){return e+n*t})}var a,s,o;return n.domain=function(i){if(!arguments.length)return t;t=[],a=new r;for(var s,o=-1,l=i.length;l>++o;)a.has(s=i[o])||a.set(s,t.push(s));return n[e.t].apply(n,e.a)},n.range=function(t){return arguments.length?(s=t,o=0,e={t:"range",a:arguments},n):s},n.rangePoints=function(r,a){2>arguments.length&&(a=0);var l=r[0],c=r[1],u=(c-l)/(Math.max(1,t.length-1)+a);return s=i(2>t.length?(l+c)/2:l+u*a/2,u),o=0,e={t:"rangePoints",a:arguments},n},n.rangeBands=function(r,a,l){2>arguments.length&&(a=0),3>arguments.length&&(l=a);var c=r[1]<r[0],u=r[c-0],d=r[1-c],h=(d-u)/(t.length-a+2*l);return s=i(u+h*l,h),c&&s.reverse(),o=h*(1-a),e={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(r,a,l){2>arguments.length&&(a=0),3>arguments.length&&(l=a);var c=r[1]<r[0],u=r[c-0],d=r[1-c],h=Math.floor((d-u)/(t.length-a+2*l)),p=d-u-(t.length-a)*h;return s=i(u+Math.round(p/2),h),c&&s.reverse(),o=Math.round(h*(1-a)),e={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return o},n.rangeExtent=function(){return na(e.a[0])},n.copy=function(){return ya(t,e)},n.domain(t)}function xa(t,e){function n(){var n=0,a=e.length;for(r=[];a>++n;)r[n-1]=Xs.quantile(t,n/a);return i}function i(t){return isNaN(t=+t)?void 0:e[Xs.bisect(r,t)]}var r;return i.domain=function(e){return arguments.length?(t=e.filter(function(t){return!isNaN(t)}).sort(Xs.ascending),n()):t},i.range=function(t){return arguments.length?(e=t,n()):e},i.quantiles=function(){return r},i.invertExtent=function(n){return n=e.indexOf(n),0>n?[0/0,0/0]:[n>0?r[n-1]:t[0],r.length>n?r[n]:t[t.length-1]]},i.copy=function(){return xa(t,e)},n()}function ba(t,e,n){function i(e){return n[Math.max(0,Math.min(s,Math.floor(a*(e-t))))]}function r(){return a=n.length/(e-t),s=n.length-1,i}var a,s;return i.domain=function(n){return arguments.length?(t=+n[0],e=+n[n.length-1],r()):[t,e]},i.range=function(t){return arguments.length?(n=t,r()):n},i.invertExtent=function(e){return e=n.indexOf(e),e=0>e?0/0:e/a+t,[e,e+1/a]},i.copy=function(){return ba(t,e,n)},r()}function Aa(t,e){function n(n){return n>=n?e[Xs.bisect(t,n)]:void 0}return n.domain=function(e){return arguments.length?(t=e,n):t},n.range=function(t){return arguments.length?(e=t,n):e},n.invertExtent=function(n){return n=e.indexOf(n),[t[n-1],t[n]]},n.copy=function(){return Aa(t,e)},n}function ka(t){function e(t){return+t}return e.invert=e,e.domain=e.range=function(n){return arguments.length?(t=n.map(e),e):t},e.ticks=function(e){return ha(t,e)},e.tickFormat=function(e,n){return pa(t,e,n)},e.copy=function(){return ka(t)},e}function Sa(t){return t.innerRadius}function Ma(t){return t.outerRadius}function Pa(t){return t.startAngle}function wa(t){return t.endAngle}function Oa(t){function e(e){function s(){c.push("M",a(t(u),o))}for(var l,c=[],u=[],d=-1,h=e.length,p=ge(n),f=ge(i);h>++d;)r.call(this,l=e[d],d)?u.push([+p.call(this,l,d),+f.call(this,l,d)]):u.length&&(s(),u=[]);return u.length&&s(),c.length?c.join(""):null}var n=Wn,i=Un,r=Ye,a=Ta,s=a.key,o=.7;return e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e.defined=function(t){return arguments.length?(r=t,e):r},e.interpolate=function(t){return arguments.length?(s="function"==typeof t?a=t:(a=bc.get(t)||Ta).key,e):s},e.tension=function(t){return arguments.length?(o=t,e):o},e}function Ta(t){return t.join("L")}function za(t){return Ta(t)+"Z"}function Ca(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("H",(i[0]+(i=t[e])[0])/2,"V",i[1]);return n>1&&r.push("H",i[0]),r.join("")}function Ea(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("V",(i=t[e])[1],"H",i[0]);return r.join("")}function Na(t){for(var e=0,n=t.length,i=t[0],r=[i[0],",",i[1]];n>++e;)r.push("H",(i=t[e])[0],"V",i[1]);return r.join("")}function Da(t,e){return 4>t.length?Ta(t):t[1]+Ia(t.slice(1,t.length-1),Va(t,e))}function Fa(t,e){return 3>t.length?Ta(t):t[0]+Ia((t.push(t[0]),t),Va([t[t.length-2]].concat(t,[t[1]]),e))}function La(t,e){return 3>t.length?Ta(t):t[0]+Ia(t,Va(t,e))}function Ia(t,e){if(1>e.length||t.length!=e.length&&t.length!=e.length+2)return Ta(t);var n=t.length!=e.length,i="",r=t[0],a=t[1],s=e[0],o=s,l=1;if(n&&(i+="Q"+(a[0]-2*s[0]/3)+","+(a[1]-2*s[1]/3)+","+a[0]+","+a[1],r=t[1],l=2),e.length>1){o=e[1],a=t[l],l++,i+="C"+(r[0]+s[0])+","+(r[1]+s[1])+","+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1];for(var c=2;e.length>c;c++,l++)a=t[l],o=e[c],i+="S"+(a[0]-o[0])+","+(a[1]-o[1])+","+a[0]+","+a[1]}if(n){var u=t[l];i+="Q"+(a[0]+2*o[0]/3)+","+(a[1]+2*o[1]/3)+","+u[0]+","+u[1]}return i}function Va(t,e){for(var n,i=[],r=(1-e)/2,a=t[0],s=t[1],o=1,l=t.length;l>++o;)n=a,a=s,s=t[o],i.push([r*(s[0]-n[0]),r*(s[1]-n[1])]);return i}function Ba(t){if(3>t.length)return Ta(t);var e=1,n=t.length,i=t[0],r=i[0],a=i[1],s=[r,r,r,(i=t[1])[0]],o=[a,a,a,i[1]],l=[r,",",a,"L",qa(Sc,s),",",qa(Sc,o)];for(t.push(t[n-1]);n>=++e;)i=t[e],s.shift(),s.push(i[0]),o.shift(),o.push(i[1]),Ga(l,s,o);return t.pop(),l.push("L",i),l.join("")}function Ra(t){if(4>t.length)return Ta(t);for(var e,n=[],i=-1,r=t.length,a=[0],s=[0];3>++i;)e=t[i],a.push(e[0]),s.push(e[1]);for(n.push(qa(Sc,a)+","+qa(Sc,s)),--i;r>++i;)e=t[i],a.shift(),a.push(e[0]),s.shift(),s.push(e[1]),Ga(n,a,s);return n.join("")}function ja(t){for(var e,n,i=-1,r=t.length,a=r+4,s=[],o=[];4>++i;)n=t[i%r],s.push(n[0]),o.push(n[1]);for(e=[qa(Sc,s),",",qa(Sc,o)],--i;a>++i;)n=t[i%r],s.shift(),s.push(n[0]),o.shift(),o.push(n[1]),Ga(e,s,o);return e.join("")}function Ha(t,e){var n=t.length-1;if(n)for(var i,r,a=t[0][0],s=t[0][1],o=t[n][0]-a,l=t[n][1]-s,c=-1;n>=++c;)i=t[c],r=c/n,i[0]=e*i[0]+(1-e)*(a+r*o),i[1]=e*i[1]+(1-e)*(s+r*l);return Ba(t)}function qa(t,e){return t[0]*e[0]+t[1]*e[1]+t[2]*e[2]+t[3]*e[3]}function Ga(t,e,n){t.push("C",qa(Ac,e),",",qa(Ac,n),",",qa(kc,e),",",qa(kc,n),",",qa(Sc,e),",",qa(Sc,n))}function Ya(t,e){return(e[1]-t[1])/(e[0]-t[0])}function Wa(t){for(var e=0,n=t.length-1,i=[],r=t[0],a=t[1],s=i[0]=Ya(r,a);n>++e;)i[e]=(s+(s=Ya(r=a,a=t[e+1])))/2;return i[e]=s,i}function Ua(t){for(var e,n,i,r,a=[],s=Wa(t),o=-1,l=t.length-1;l>++o;)e=Ya(t[o],t[o+1]),zo>lo(e)?s[o]=s[o+1]=0:(n=s[o]/e,i=s[o+1]/e,r=n*n+i*i,r>9&&(r=3*e/Math.sqrt(r),s[o]=r*n,s[o+1]=r*i));for(o=-1;l>=++o;)r=(t[Math.min(l,o+1)][0]-t[Math.max(0,o-1)][0])/(6*(1+s[o]*s[o])),a.push([r||0,s[o]*r||0]);return a}function Xa(t){return 3>t.length?Ta(t):t[0]+Ia(t,Ua(t))}function Za(t){for(var e,n,i,r=-1,a=t.length;a>++r;)e=t[r],n=e[0],i=e[1]+yc,e[0]=n*Math.cos(i),e[1]=n*Math.sin(i);return t}function Ja(t){function e(e){function l(){g.push("M",o(t(m),d),u,c(t(_.reverse()),d),"Z")}for(var h,p,f,g=[],_=[],m=[],v=-1,y=e.length,x=ge(n),b=ge(r),A=n===i?function(){return p}:ge(i),k=r===a?function(){return f}:ge(a);y>++v;)s.call(this,h=e[v],v)?(_.push([p=+x.call(this,h,v),f=+b.call(this,h,v)]),m.push([+A.call(this,h,v),+k.call(this,h,v)])):_.length&&(l(),_=[],m=[]);return _.length&&l(),g.length?g.join(""):null}var n=Wn,i=Wn,r=0,a=Un,s=Ye,o=Ta,l=o.key,c=o,u="L",d=.7;return e.x=function(t){return arguments.length?(n=i=t,e):i},e.x0=function(t){return arguments.length?(n=t,e):n},e.x1=function(t){return arguments.length?(i=t,e):i},e.y=function(t){return arguments.length?(r=a=t,e):a},e.y0=function(t){return arguments.length?(r=t,e):r},e.y1=function(t){return arguments.length?(a=t,e):a},e.defined=function(t){return arguments.length?(s=t,e):s},e.interpolate=function(t){return arguments.length?(l="function"==typeof t?o=t:(o=bc.get(t)||Ta).key,c=o.reverse||o,u=o.closed?"M":"L",e):l},e.tension=function(t){return arguments.length?(d=t,e):d},e}function Ka(t){return t.radius}function $a(t){return[t.x,t.y]}function Qa(t){return function(){var e=t.apply(this,arguments),n=e[0],i=e[1]+yc;return[n*Math.cos(i),n*Math.sin(i)]}}function ts(){return 64}function es(){return"circle"}function ns(t){var e=Math.sqrt(t/wo);return"M0,"+e+"A"+e+","+e+" 0 1,1 0,"+-e+"A"+e+","+e+" 0 1,1 0,"+e+"Z"}function is(t,e){return fo(t,zc),t.id=e,t}function rs(t,e,n,i){var r=t.id;return T(t,"function"==typeof n?function(t,a,s){t.__transition__[r].tween.set(e,i(n.call(t,t.__data__,a,s)))}:(n=i(n),function(t){t.__transition__[r].tween.set(e,n)}))}function as(t){return null==t&&(t=""),function(){this.textContent=t}}function ss(t,e,n,i){var a=t.__transition__||(t.__transition__={active:0,count:0}),s=a[n];if(!s){var o=i.time;s=a[n]={tween:new r,time:o,ease:i.ease,delay:i.delay,duration:i.duration},++a.count,Xs.timer(function(i){function r(i){return a.active>n?c():(a.active=n,s.event&&s.event.start.call(t,u,e),s.tween.forEach(function(n,i){(i=i.call(t,u,e))&&g.push(i)}),Xs.timer(function(){return f.c=l(i||1)?Ye:l,1},0,o),void 0)}function l(i){if(a.active!==n)return c();for(var r=i/p,o=d(r),l=g.length;l>0;)g[--l].call(t,o);return r>=1?(s.event&&s.event.end.call(t,u,e),c()):void 0}function c(){return--a.count?delete a[n]:delete t.__transition__,1}var u=t.__data__,d=s.ease,h=s.delay,p=s.duration,f=Qo,g=[];return f.t=h+o,i>=h?r(i-h):(f.c=r,void 0)},0,o)}}function os(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function ls(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function cs(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function us(t,e,n){function i(e){var n=t(e),i=a(n,1);return i-e>e-n?n:i}function r(n){return e(n=t(new Ic(n-1)),1),n}function a(t,n){return e(t=new Ic(+t),n),t}function s(t,i,a){var s=r(t),o=[];if(a>1)for(;i>s;)n(s)%a||o.push(new Date(+s)),e(s,1);else for(;i>s;)o.push(new Date(+s)),e(s,1);return o}function o(t,e,n){try{Ic=cs;var i=new cs;return i._=t,s(i,e,n)}finally{Ic=Date}}t.floor=t,t.round=i,t.ceil=r,t.offset=a,t.range=s;var l=t.utc=ds(t);return l.floor=l,l.round=ds(i),l.ceil=ds(r),l.offset=ds(a),l.range=o,t}function ds(t){return function(e,n){try{Ic=cs;var i=new cs;return i._=e,t(i,n)._}finally{Ic=Date}}}function hs(t){function e(e){for(var i,r,a,s=[],o=-1,l=0;n>++o;)37===t.charCodeAt(o)&&(s.push(t.substring(l,o)),null!=(r=nu[i=t.charAt(++o)])&&(i=t.charAt(++o)),(a=iu[i])&&(i=a(e,null==r?"e"===i?" ":"0":r)),s.push(i),l=o+1);return s.push(t.substring(l,o)),s.join("")}var n=t.length;return e.parse=function(e){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},i=ps(n,t,e,0);if(i!=e.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var r=null!=n.Z&&Ic!==cs,a=new(r?cs:Ic);return"j"in n?a.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(a.setFullYear(n.y,0,1),a.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(a.getDay()+5)%7:n.w+7*n.U-(a.getDay()+6)%7)):a.setFullYear(n.y,n.m,n.d),a.setHours(n.H+Math.floor(n.Z/100),n.M+n.Z%100,n.S,n.L),r?a._:a},e.toString=function(){return t},e}function ps(t,e,n,i){for(var r,a,s,o=0,l=e.length,c=n.length;l>o;){if(i>=c)return-1;if(r=e.charCodeAt(o++),37===r){if(s=e.charAt(o++),a=ru[s in nu?e.charAt(o++):s],!a||0>(i=a(t,n,i)))return-1}else if(r!=n.charCodeAt(i++))return-1}return i}function fs(t){return RegExp("^(?:"+t.map(Xs.requote).join("|")+")","i")}function gs(t){for(var e=new r,n=-1,i=t.length;i>++n;)e.set(t[n].toLowerCase(),n);return e}function _s(t,e,n){var i=0>t?"-":"",r=(i?-t:t)+"",a=r.length;return i+(n>a?Array(n-a+1).join(e)+r:r)}function ms(t,e,n){Zc.lastIndex=0;var i=Zc.exec(e.substring(n));return i?(t.w=Jc.get(i[0].toLowerCase()),n+i[0].length):-1}function vs(t,e,n){Uc.lastIndex=0;var i=Uc.exec(e.substring(n));return i?(t.w=Xc.get(i[0].toLowerCase()),n+i[0].length):-1}function ys(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+1));return i?(t.w=+i[0],n+i[0].length):-1}function xs(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n));return i?(t.U=+i[0],n+i[0].length):-1}function bs(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n));return i?(t.W=+i[0],n+i[0].length):-1}function As(t,e,n){Qc.lastIndex=0;var i=Qc.exec(e.substring(n));return i?(t.m=tu.get(i[0].toLowerCase()),n+i[0].length):-1}function ks(t,e,n){Kc.lastIndex=0;var i=Kc.exec(e.substring(n));return i?(t.m=$c.get(i[0].toLowerCase()),n+i[0].length):-1}function Ss(t,e,n){return ps(t,""+iu.c,e,n)}function Ms(t,e,n){return ps(t,""+iu.x,e,n)}function Ps(t,e,n){return ps(t,""+iu.X,e,n)}function ws(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+4));return i?(t.y=+i[0],n+i[0].length):-1}function Os(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+2));return i?(t.y=zs(+i[0]),n+i[0].length):-1}function Ts(t,e,n){return/^[+-]\d{4}$/.test(e=e.substring(n,n+5))?(t.Z=+e,n+5):-1}function zs(t){return t+(t>68?1900:2e3)}function Cs(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+2));return i?(t.m=i[0]-1,n+i[0].length):-1}function Es(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+2));return i?(t.d=+i[0],n+i[0].length):-1}function Ns(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+3));return i?(t.j=+i[0],n+i[0].length):-1}function Ds(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+2));return i?(t.H=+i[0],n+i[0].length):-1}function Fs(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+2));return i?(t.M=+i[0],n+i[0].length):-1}function Ls(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+2));return i?(t.S=+i[0],n+i[0].length):-1}function Is(t,e,n){au.lastIndex=0;var i=au.exec(e.substring(n,n+3));return i?(t.L=+i[0],n+i[0].length):-1}function Vs(t,e,n){var i=su.get(e.substring(n,n+=2).toLowerCase());return null==i?-1:(t.p=i,n)}function Bs(t){var e=t.getTimezoneOffset(),n=e>0?"-":"+",i=~~(lo(e)/60),r=lo(e)%60;return n+_s(i,"0",2)+_s(r,"0",2)}function Rs(t,e,n){eu.lastIndex=0;var i=eu.exec(e.substring(n,n+1));return i?n+i[0].length:-1}function js(t){function e(t){try{Ic=cs;var e=new Ic;return e._=t,n(e)}finally{Ic=Date}}var n=hs(t);return e.parse=function(t){try{Ic=cs;var e=n.parse(t);return e&&e._}finally{Ic=Date}},e.toString=n.toString,e}function Hs(t){return t.toISOString()}function qs(t,e,n){function i(e){return t(e)}function r(t,n){var i=t[1]-t[0],r=i/n,a=Xs.bisect(lu,r);return a==lu.length?[e.year,da(t.map(function(t){return t/31536e6}),n)[2]]:a?e[r/lu[a-1]<lu[a]/r?a-1:a]:[hu,da(t,n)[2]]}return i.invert=function(e){return Gs(t.invert(e))},i.domain=function(e){return arguments.length?(t.domain(e),i):t.domain().map(Gs)},i.nice=function(t,e){function n(n){return!isNaN(n)&&!t.range(n,Gs(+n+1),e).length}var a=i.domain(),s=na(a),o=null==t?r(s,10):"number"==typeof t&&r(s,t);return o&&(t=o[0],e=o[1]),i.domain(aa(a,e>1?{floor:function(e){for(;n(e=t.floor(e));)e=Gs(e-1);return e},ceil:function(e){for(;n(e=t.ceil(e));)e=Gs(+e+1);return e}}:t))},i.ticks=function(t,e){var n=na(i.domain()),a=null==t?r(n,10):"number"==typeof t?r(n,t):!t.range&&[{range:t},e];return a&&(t=a[0],e=a[1]),t.range(n[0],Gs(+n[1]+1),1>e?1:e)},i.tickFormat=function(){return n},i.copy=function(){return qs(t.copy(),e,n)},ca(i,t)}function Gs(t){return new Date(t)}function Ys(t){return function(e){for(var n=t.length-1,i=t[n];!i[1](e);)i=t[--n];return i[0](e)}}function Ws(t){return JSON.parse(t.responseText)}function Us(t){var e=Ks.createRange();return e.selectNode(Ks.body),e.createContextualFragment(t.responseText)}var Xs={version:"3.3.13"};Date.now||(Date.now=function(){return+new Date});var Zs=[].slice,Js=function(t){return Zs.call(t)},Ks=document,$s=Ks.documentElement,Qs=window;try{Js($s.childNodes)[0].nodeType}catch(to){Js=function(t){for(var e=t.length,n=Array(e);e--;)n[e]=t[e];return n}}try{Ks.createElement("div").style.setProperty("opacity",0,"")}catch(eo){var no=Qs.Element.prototype,io=no.setAttribute,ro=no.setAttributeNS,ao=Qs.CSSStyleDeclaration.prototype,so=ao.setProperty;no.setAttribute=function(t,e){io.call(this,t,e+"")},no.setAttributeNS=function(t,e,n){ro.call(this,t,e,n+"")},ao.setProperty=function(t,e,n){so.call(this,t,e+"",n)}}Xs.ascending=function(t,e){return e>t?-1:t>e?1:t>=e?0:0/0},Xs.descending=function(t,e){return t>e?-1:e>t?1:e>=t?0:0/0},Xs.min=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;a>++r&&!(null!=(n=t[r])&&n>=n);)n=void 0;for(;a>++r;)null!=(i=t[r])&&n>i&&(n=i)}else{for(;a>++r&&!(null!=(n=e.call(t,t[r],r))&&n>=n);)n=void 0;for(;a>++r;)null!=(i=e.call(t,t[r],r))&&n>i&&(n=i)}return n},Xs.max=function(t,e){var n,i,r=-1,a=t.length;if(1===arguments.length){for(;a>++r&&!(null!=(n=t[r])&&n>=n);)n=void 0;for(;a>++r;)null!=(i=t[r])&&i>n&&(n=i)}else{for(;a>++r&&!(null!=(n=e.call(t,t[r],r))&&n>=n);)n=void 0;for(;a>++r;)null!=(i=e.call(t,t[r],r))&&i>n&&(n=i)}return n},Xs.extent=function(t,e){var n,i,r,a=-1,s=t.length;if(1===arguments.length){for(;s>++a&&!(null!=(n=r=t[a])&&n>=n);)n=r=void 0;for(;s>++a;)null!=(i=t[a])&&(n>i&&(n=i),i>r&&(r=i))}else{for(;s>++a&&!(null!=(n=r=e.call(t,t[a],a))&&n>=n);)n=void 0;for(;s>++a;)null!=(i=e.call(t,t[a],a))&&(n>i&&(n=i),i>r&&(r=i))}return[n,r]},Xs.sum=function(t,e){var n,i=0,r=t.length,a=-1;if(1===arguments.length)for(;r>++a;)isNaN(n=+t[a])||(i+=n);else for(;r>++a;)isNaN(n=+e.call(t,t[a],a))||(i+=n);return i},Xs.mean=function(e,n){var i,r=e.length,a=0,s=-1,o=0;if(1===arguments.length)for(;r>++s;)t(i=e[s])&&(a+=(i-a)/++o);else for(;r>++s;)t(i=n.call(e,e[s],s))&&(a+=(i-a)/++o);return o?a:void 0},Xs.quantile=function(t,e){var n=(t.length-1)*e+1,i=Math.floor(n),r=+t[i-1],a=n-i;
return a?r+a*(t[i]-r):r},Xs.median=function(e,n){return arguments.length>1&&(e=e.map(n)),e=e.filter(t),e.length?Xs.quantile(e.sort(Xs.ascending),.5):void 0},Xs.bisector=function(t){return{left:function(e,n,i,r){for(3>arguments.length&&(i=0),4>arguments.length&&(r=e.length);r>i;){var a=i+r>>>1;n>t.call(e,e[a],a)?i=a+1:r=a}return i},right:function(e,n,i,r){for(3>arguments.length&&(i=0),4>arguments.length&&(r=e.length);r>i;){var a=i+r>>>1;t.call(e,e[a],a)>n?r=a:i=a+1}return i}}};var oo=Xs.bisector(function(t){return t});Xs.bisectLeft=oo.left,Xs.bisect=Xs.bisectRight=oo.right,Xs.shuffle=function(t){for(var e,n,i=t.length;i;)n=0|Math.random()*i--,e=t[i],t[i]=t[n],t[n]=e;return t},Xs.permute=function(t,e){for(var n=e.length,i=Array(n);n--;)i[n]=t[e[n]];return i},Xs.pairs=function(t){for(var e,n=0,i=t.length-1,r=t[0],a=Array(0>i?0:i);i>n;)a[n]=[e=r,r=t[++n]];return a},Xs.zip=function(){if(!(r=arguments.length))return[];for(var t=-1,n=Xs.min(arguments,e),i=Array(n);n>++t;)for(var r,a=-1,s=i[t]=Array(r);r>++a;)s[a]=arguments[a][t];return i},Xs.transpose=function(t){return Xs.zip.apply(Xs,t)},Xs.keys=function(t){var e=[];for(var n in t)e.push(n);return e},Xs.values=function(t){var e=[];for(var n in t)e.push(t[n]);return e},Xs.entries=function(t){var e=[];for(var n in t)e.push({key:n,value:t[n]});return e},Xs.merge=function(t){for(var e,n,i,r=t.length,a=-1,s=0;r>++a;)s+=t[a].length;for(n=Array(s);--r>=0;)for(i=t[r],e=i.length;--e>=0;)n[--s]=i[e];return n};var lo=Math.abs;Xs.range=function(t,e,i){if(3>arguments.length&&(i=1,2>arguments.length&&(e=t,t=0)),1/0===(e-t)/i)throw Error("infinite range");var r,a=[],s=n(lo(i)),o=-1;if(t*=s,e*=s,i*=s,0>i)for(;(r=t+i*++o)>e;)a.push(r/s);else for(;e>(r=t+i*++o);)a.push(r/s);return a},Xs.map=function(t){var e=new r;if(t instanceof r)t.forEach(function(t,n){e.set(t,n)});else for(var n in t)e.set(n,t[n]);return e},i(r,{has:function(t){return co+t in this},get:function(t){return this[co+t]},set:function(t,e){return this[co+t]=e},remove:function(t){return t=co+t,t in this&&delete this[t]},keys:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},values:function(){var t=[];return this.forEach(function(e,n){t.push(n)}),t},entries:function(){var t=[];return this.forEach(function(e,n){t.push({key:e,value:n})}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===uo&&t.call(this,e.substring(1),this[e])}});var co="\0",uo=co.charCodeAt(0);Xs.nest=function(){function t(e,o,l){if(l>=s.length)return i?i.call(a,o):n?o.sort(n):o;for(var c,u,d,h,p=-1,f=o.length,g=s[l++],_=new r;f>++p;)(h=_.get(c=g(u=o[p])))?h.push(u):_.set(c,[u]);return e?(u=e(),d=function(n,i){u.set(n,t(e,i,l))}):(u={},d=function(n,i){u[n]=t(e,i,l)}),_.forEach(d),u}function e(t,n){if(n>=s.length)return t;var i=[],r=o[n++];return t.forEach(function(t,r){i.push({key:t,values:e(r,n)})}),r?i.sort(function(t,e){return r(t.key,e.key)}):i}var n,i,a={},s=[],o=[];return a.map=function(e,n){return t(n,e,0)},a.entries=function(n){return e(t(Xs.map,n,0),0)},a.key=function(t){return s.push(t),a},a.sortKeys=function(t){return o[s.length-1]=t,a},a.sortValues=function(t){return n=t,a},a.rollup=function(t){return i=t,a},a},Xs.set=function(t){var e=new a;if(t)for(var n=0,i=t.length;i>n;++n)e.add(t[n]);return e},i(a,{has:function(t){return co+t in this},add:function(t){return this[co+t]=!0,t},remove:function(t){return t=co+t,t in this&&delete this[t]},values:function(){var t=[];return this.forEach(function(e){t.push(e)}),t},forEach:function(t){for(var e in this)e.charCodeAt(0)===uo&&t.call(this,e.substring(1))}}),Xs.behavior={},Xs.rebind=function(t,e){for(var n,i=1,r=arguments.length;r>++i;)t[n=arguments[i]]=s(t,e,e[n]);return t};var ho=["webkit","ms","moz","Moz","o","O"];Xs.dispatch=function(){for(var t=new c,e=-1,n=arguments.length;n>++e;)t[arguments[e]]=u(t);return t},c.prototype.on=function(t,e){var n=t.indexOf("."),i="";if(n>=0&&(i=t.substring(n+1),t=t.substring(0,n)),t)return 2>arguments.length?this[t].on(i):this[t].on(i,e);if(2===arguments.length){if(null==e)for(t in this)this.hasOwnProperty(t)&&this[t].on(i,null);return this}},Xs.event=null,Xs.requote=function(t){return t.replace(po,"\\$&")};var po=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,fo={}.__proto__?function(t,e){t.__proto__=e}:function(t,e){for(var n in e)t[n]=e[n]},go=function(t,e){return e.querySelector(t)},_o=function(t,e){return e.querySelectorAll(t)},mo=$s[o($s,"matchesSelector")],vo=function(t,e){return mo.call(t,e)};"function"==typeof Sizzle&&(go=function(t,e){return Sizzle(t,e)[0]||null},_o=function(t,e){return Sizzle.uniqueSort(Sizzle(t,e))},vo=Sizzle.matchesSelector),Xs.selection=function(){return Ao};var yo=Xs.selection.prototype=[];yo.select=function(t){var e,n,i,r,a=[];t=g(t);for(var s=-1,o=this.length;o>++s;){a.push(e=[]),e.parentNode=(i=this[s]).parentNode;for(var l=-1,c=i.length;c>++l;)(r=i[l])?(e.push(n=t.call(r,r.__data__,l,s)),n&&"__data__"in r&&(n.__data__=r.__data__)):e.push(null)}return f(a)},yo.selectAll=function(t){var e,n,i=[];t=_(t);for(var r=-1,a=this.length;a>++r;)for(var s=this[r],o=-1,l=s.length;l>++o;)(n=s[o])&&(i.push(e=Js(t.call(n,n.__data__,o,r))),e.parentNode=n);return f(i)};var xo={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};Xs.ns={prefix:xo,qualify:function(t){var e=t.indexOf(":"),n=t;return e>=0&&(n=t.substring(0,e),t=t.substring(e+1)),xo.hasOwnProperty(n)?{space:xo[n],local:t}:t}},yo.attr=function(t,e){if(2>arguments.length){if("string"==typeof t){var n=this.node();return t=Xs.ns.qualify(t),t.local?n.getAttributeNS(t.space,t.local):n.getAttribute(t)}for(e in t)this.each(m(e,t[e]));return this}return this.each(m(t,e))},yo.classed=function(t,e){if(2>arguments.length){if("string"==typeof t){var n=this.node(),i=(t=x(t)).length,r=-1;if(e=n.classList){for(;i>++r;)if(!e.contains(t[r]))return!1}else for(e=n.getAttribute("class");i>++r;)if(!y(t[r]).test(e))return!1;return!0}for(e in t)this.each(b(e,t[e]));return this}return this.each(b(t,e))},yo.style=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e="");for(n in t)this.each(k(n,t[n],e));return this}if(2>i)return Qs.getComputedStyle(this.node(),null).getPropertyValue(t);n=""}return this.each(k(t,e,n))},yo.property=function(t,e){if(2>arguments.length){if("string"==typeof t)return this.node()[t];for(e in t)this.each(S(e,t[e]));return this}return this.each(S(t,e))},yo.text=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.textContent=null==e?"":e}:null==t?function(){this.textContent=""}:function(){this.textContent=t}):this.node().textContent},yo.html=function(t){return arguments.length?this.each("function"==typeof t?function(){var e=t.apply(this,arguments);this.innerHTML=null==e?"":e}:null==t?function(){this.innerHTML=""}:function(){this.innerHTML=t}):this.node().innerHTML},yo.append=function(t){return t=M(t),this.select(function(){return this.appendChild(t.apply(this,arguments))})},yo.insert=function(t,e){return t=M(t),e=g(e),this.select(function(){return this.insertBefore(t.apply(this,arguments),e.apply(this,arguments)||null)})},yo.remove=function(){return this.each(function(){var t=this.parentNode;t&&t.removeChild(this)})},yo.data=function(t,e){function n(t,n){var i,a,s,o=t.length,d=n.length,h=Math.min(o,d),p=Array(d),f=Array(d),g=Array(o);if(e){var _,m=new r,v=new r,y=[];for(i=-1;o>++i;)_=e.call(a=t[i],a.__data__,i),m.has(_)?g[i]=a:m.set(_,a),y.push(_);for(i=-1;d>++i;)_=e.call(n,s=n[i],i),(a=m.get(_))?(p[i]=a,a.__data__=s):v.has(_)||(f[i]=P(s)),v.set(_,s),m.remove(_);for(i=-1;o>++i;)m.has(y[i])&&(g[i]=t[i])}else{for(i=-1;h>++i;)a=t[i],s=n[i],a?(a.__data__=s,p[i]=a):f[i]=P(s);for(;d>i;++i)f[i]=P(n[i]);for(;o>i;++i)g[i]=t[i]}f.update=p,f.parentNode=p.parentNode=g.parentNode=t.parentNode,l.push(f),c.push(p),u.push(g)}var i,a,s=-1,o=this.length;if(!arguments.length){for(t=Array(o=(i=this[0]).length);o>++s;)(a=i[s])&&(t[s]=a.__data__);return t}var l=z([]),c=f([]),u=f([]);if("function"==typeof t)for(;o>++s;)n(i=this[s],t.call(i,i.parentNode.__data__,s));else for(;o>++s;)n(i=this[s],t);return c.enter=function(){return l},c.exit=function(){return u},c},yo.datum=function(t){return arguments.length?this.property("__data__",t):this.property("__data__")},yo.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=w(t));for(var a=0,s=this.length;s>a;a++){r.push(e=[]),e.parentNode=(n=this[a]).parentNode;for(var o=0,l=n.length;l>o;o++)(i=n[o])&&t.call(i,i.__data__,o,a)&&e.push(i)}return f(r)},yo.order=function(){for(var t=-1,e=this.length;e>++t;)for(var n,i=this[t],r=i.length-1,a=i[r];--r>=0;)(n=i[r])&&(a&&a!==n.nextSibling&&a.parentNode.insertBefore(n,a),a=n);return this},yo.sort=function(t){t=O.apply(this,arguments);for(var e=-1,n=this.length;n>++e;)this[e].sort(t);return this.order()},yo.each=function(t){return T(this,function(e,n,i){t.call(e,e.__data__,n,i)})},yo.call=function(t){var e=Js(arguments);return t.apply(e[0]=this,e),this},yo.empty=function(){return!this.node()},yo.node=function(){for(var t=0,e=this.length;e>t;t++)for(var n=this[t],i=0,r=n.length;r>i;i++){var a=n[i];if(a)return a}return null},yo.size=function(){var t=0;return this.each(function(){++t}),t};var bo=[];Xs.selection.enter=z,Xs.selection.enter.prototype=bo,bo.append=yo.append,bo.empty=yo.empty,bo.node=yo.node,bo.call=yo.call,bo.size=yo.size,bo.select=function(t){for(var e,n,i,r,a,s=[],o=-1,l=this.length;l>++o;){i=(r=this[o]).update,s.push(e=[]),e.parentNode=r.parentNode;for(var c=-1,u=r.length;u>++c;)(a=r[c])?(e.push(i[c]=n=t.call(r.parentNode,a.__data__,c,o)),n.__data__=a.__data__):e.push(null)}return f(s)},bo.insert=function(t,e){return 2>arguments.length&&(e=C(this)),yo.insert.call(this,t,e)},yo.transition=function(){for(var t,e,n=Pc||++Cc,i=[],r=wc||{time:Date.now(),ease:ji,delay:0,duration:250},a=-1,s=this.length;s>++a;){i.push(t=[]);for(var o=this[a],l=-1,c=o.length;c>++l;)(e=o[l])&&ss(e,l,n,r),t.push(e)}return is(i,n)},yo.interrupt=function(){return this.each(E)},Xs.select=function(t){var e=["string"==typeof t?go(t,Ks):t];return e.parentNode=$s,f([e])},Xs.selectAll=function(t){var e=Js("string"==typeof t?_o(t,Ks):t);return e.parentNode=$s,f([e])};var Ao=Xs.select($s);yo.on=function(t,e,n){var i=arguments.length;if(3>i){if("string"!=typeof t){2>i&&(e=!1);for(n in t)this.each(N(n,t[n],e));return this}if(2>i)return(i=this.node()["__on"+t])&&i._;n=!1}return this.each(N(t,e,n))};var ko=Xs.map({mouseenter:"mouseover",mouseleave:"mouseout"});ko.forEach(function(t){"on"+t in Ks&&ko.remove(t)});var So="onselectstart"in Ks?null:o($s.style,"userSelect"),Mo=0;Xs.mouse=function(t){return I(t,h())};var Po=/WebKit/.test(Qs.navigator.userAgent)?-1:0;Xs.touches=function(t,e){return 2>arguments.length&&(e=h().touches),e?Js(e).map(function(e){var n=I(t,e);return n.identifier=e.identifier,n}):[]},Xs.behavior.drag=function(){function t(){this.on("mousedown.drag",s).on("touchstart.drag",o)}function e(){return Xs.event.changedTouches[0].identifier}function n(t,e){return Xs.touches(t).filter(function(t){return t.identifier===e})[0]}function i(t,e,n,i){return function(){function s(){var t=e(u,p),n=t[0]-g[0],i=t[1]-g[1];_|=n|i,g=t,d({type:"drag",x:t[0]+l[0],y:t[1]+l[1],dx:n,dy:i})}function o(){m.on(n+"."+f,null).on(i+"."+f,null),v(_&&Xs.event.target===h),d({type:"dragend"})}var l,c=this,u=c.parentNode,d=r.of(c,arguments),h=Xs.event.target,p=t(),f=null==p?"drag":"drag-"+p,g=e(u,p),_=0,m=Xs.select(Qs).on(n+"."+f,s).on(i+"."+f,o),v=L();a?(l=a.apply(c,arguments),l=[l.x-g[0],l.y-g[1]]):l=[0,0],d({type:"dragstart"})}}var r=p(t,"drag","dragstart","dragend"),a=null,s=i(l,Xs.mouse,"mousemove","mouseup"),o=i(e,n,"touchmove","touchend");return t.origin=function(e){return arguments.length?(a=e,t):a},Xs.rebind(t,r,"on")};var wo=Math.PI,Oo=2*wo,To=wo/2,zo=1e-6,Co=zo*zo,Eo=wo/180,No=180/wo,Do=Math.SQRT2,Fo=2,Lo=4;Xs.interpolateZoom=function(t,e){function n(t){var e=t*v;if(m){var n=H(g),s=a/(Fo*h)*(n*q(Do*e+g)-j(g));return[i+s*c,r+s*u,a*n/H(Do*e+g)]}return[i+t*c,r+t*u,a*Math.exp(Do*e)]}var i=t[0],r=t[1],a=t[2],s=e[0],o=e[1],l=e[2],c=s-i,u=o-r,d=c*c+u*u,h=Math.sqrt(d),p=(l*l-a*a+Lo*d)/(2*a*Fo*h),f=(l*l-a*a-Lo*d)/(2*l*Fo*h),g=Math.log(Math.sqrt(p*p+1)-p),_=Math.log(Math.sqrt(f*f+1)-f),m=_-g,v=(m||Math.log(l/a))/Do;return n.duration=1e3*v,n},Xs.behavior.zoom=function(){function t(t){t.on(w,c).on(Bo+".zoom",h).on(O,f).on("dblclick.zoom",g).on(z,u)}function e(t){return[(t[0]-S.x)/S.k,(t[1]-S.y)/S.k]}function n(t){return[t[0]*S.k+S.x,t[1]*S.k+S.y]}function i(t){S.k=Math.max(P[0],Math.min(P[1],t))}function r(t,e){e=n(e),S.x+=t[0]-e[0],S.y+=t[1]-e[1]}function a(){b&&b.domain(x.range().map(function(t){return(t-S.x)/S.k}).map(x.invert)),k&&k.domain(A.range().map(function(t){return(t-S.y)/S.k}).map(A.invert))}function s(t){t({type:"zoomstart"})}function o(t){a(),t({type:"zoom",scale:S.k,translate:[S.x,S.y]})}function l(t){t({type:"zoomend"})}function c(){function t(){u=1,r(Xs.mouse(i),h),o(a)}function n(){d.on(O,Qs===i?f:null).on(T,null),p(u&&Xs.event.target===c),l(a)}var i=this,a=C.of(i,arguments),c=Xs.event.target,u=0,d=Xs.select(Qs).on(O,t).on(T,n),h=e(Xs.mouse(i)),p=L();E.call(i),s(a)}function u(){function t(){var t=Xs.touches(f);return p=S.k,t.forEach(function(t){t.identifier in _&&(_[t.identifier]=e(t))}),t}function n(){for(var e=Xs.event.changedTouches,n=0,a=e.length;a>n;++n)_[e[n].identifier]=null;var s=t(),l=Date.now();if(1===s.length){if(500>l-y){var c=s[0],u=_[c.identifier];i(2*S.k),r(c,u),d(),o(g)}y=l}else if(s.length>1){var c=s[0],h=s[1],p=c[0]-h[0],f=c[1]-h[1];m=p*p+f*f}}function a(){for(var t,e,n,a,s=Xs.touches(f),l=0,c=s.length;c>l;++l,a=null)if(n=s[l],a=_[n.identifier]){if(e)break;t=n,e=a}if(a){var u=(u=n[0]-t[0])*u+(u=n[1]-t[1])*u,d=m&&Math.sqrt(u/m);t=[(t[0]+n[0])/2,(t[1]+n[1])/2],e=[(e[0]+a[0])/2,(e[1]+a[1])/2],i(d*p)}y=null,r(t,e),o(g)}function h(){if(Xs.event.touches.length){for(var e=Xs.event.changedTouches,n=0,i=e.length;i>n;++n)delete _[e[n].identifier];for(var r in _)return void t()}A.on(x,null).on(b,null),k.on(w,c).on(z,u),M(),l(g)}var p,f=this,g=C.of(f,arguments),_={},m=0,v=Xs.event.changedTouches[0].identifier,x="touchmove.zoom-"+v,b="touchend.zoom-"+v,A=Xs.select(Qs).on(x,a).on(b,h),k=Xs.select(f).on(w,null).on(z,n),M=L();E.call(f),n(),s(g)}function h(){var t=C.of(this,arguments);v?clearTimeout(v):(E.call(this),s(t)),v=setTimeout(function(){v=null,l(t)},50),d();var n=m||Xs.mouse(this);_||(_=e(n)),i(Math.pow(2,.002*Io())*S.k),r(n,_),o(t)}function f(){_=null}function g(){var t=C.of(this,arguments),n=Xs.mouse(this),a=e(n),c=Math.log(S.k)/Math.LN2;s(t),i(Math.pow(2,Xs.event.shiftKey?Math.ceil(c)-1:Math.floor(c)+1)),r(n,a),o(t),l(t)}var _,m,v,y,x,b,A,k,S={x:0,y:0,k:1},M=[960,500],P=Vo,w="mousedown.zoom",O="mousemove.zoom",T="mouseup.zoom",z="touchstart.zoom",C=p(t,"zoomstart","zoom","zoomend");return t.event=function(t){t.each(function(){var t=C.of(this,arguments),e=S;Pc?Xs.select(this).transition().each("start.zoom",function(){S=this.__chart__||{x:0,y:0,k:1},s(t)}).tween("zoom:zoom",function(){var n=M[0],i=M[1],r=n/2,a=i/2,s=Xs.interpolateZoom([(r-S.x)/S.k,(a-S.y)/S.k,n/S.k],[(r-e.x)/e.k,(a-e.y)/e.k,n/e.k]);return function(e){var i=s(e),l=n/i[2];this.__chart__=S={x:r-i[0]*l,y:a-i[1]*l,k:l},o(t)}}).each("end.zoom",function(){l(t)}):(this.__chart__=S,s(t),o(t),l(t))})},t.translate=function(e){return arguments.length?(S={x:+e[0],y:+e[1],k:S.k},a(),t):[S.x,S.y]},t.scale=function(e){return arguments.length?(S={x:S.x,y:S.y,k:+e},a(),t):S.k},t.scaleExtent=function(e){return arguments.length?(P=null==e?Vo:[+e[0],+e[1]],t):P},t.center=function(e){return arguments.length?(m=e&&[+e[0],+e[1]],t):m},t.size=function(e){return arguments.length?(M=e&&[+e[0],+e[1]],t):M},t.x=function(e){return arguments.length?(b=e,x=e.copy(),S={x:0,y:0,k:1},t):b},t.y=function(e){return arguments.length?(k=e,A=e.copy(),S={x:0,y:0,k:1},t):k},Xs.rebind(t,C,"on")};var Io,Vo=[0,1/0],Bo="onwheel"in Ks?(Io=function(){return-Xs.event.deltaY*(Xs.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Ks?(Io=function(){return Xs.event.wheelDelta},"mousewheel"):(Io=function(){return-Xs.event.detail},"MozMousePixelScroll");Y.prototype.toString=function(){return this.rgb()+""},Xs.hsl=function(t,e,n){return 1===arguments.length?t instanceof U?W(t.h,t.s,t.l):ue(""+t,de,W):W(+t,+e,+n)};var Ro=U.prototype=new Y;Ro.brighter=function(t){return t=Math.pow(.7,arguments.length?t:1),W(this.h,this.s,this.l/t)},Ro.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),W(this.h,this.s,t*this.l)},Ro.rgb=function(){return X(this.h,this.s,this.l)},Xs.hcl=function(t,e,n){return 1===arguments.length?t instanceof J?Z(t.h,t.c,t.l):t instanceof Q?ee(t.l,t.a,t.b):ee((t=he((t=Xs.rgb(t)).r,t.g,t.b)).l,t.a,t.b):Z(+t,+e,+n)};var jo=J.prototype=new Y;jo.brighter=function(t){return Z(this.h,this.c,Math.min(100,this.l+Ho*(arguments.length?t:1)))},jo.darker=function(t){return Z(this.h,this.c,Math.max(0,this.l-Ho*(arguments.length?t:1)))},jo.rgb=function(){return K(this.h,this.c,this.l).rgb()},Xs.lab=function(t,e,n){return 1===arguments.length?t instanceof Q?$(t.l,t.a,t.b):t instanceof J?K(t.l,t.c,t.h):he((t=Xs.rgb(t)).r,t.g,t.b):$(+t,+e,+n)};var Ho=18,qo=.95047,Go=1,Yo=1.08883,Wo=Q.prototype=new Y;Wo.brighter=function(t){return $(Math.min(100,this.l+Ho*(arguments.length?t:1)),this.a,this.b)},Wo.darker=function(t){return $(Math.max(0,this.l-Ho*(arguments.length?t:1)),this.a,this.b)},Wo.rgb=function(){return te(this.l,this.a,this.b)},Xs.rgb=function(t,e,n){return 1===arguments.length?t instanceof le?oe(t.r,t.g,t.b):ue(""+t,oe,X):oe(~~t,~~e,~~n)};var Uo=le.prototype=new Y;Uo.brighter=function(t){t=Math.pow(.7,arguments.length?t:1);var e=this.r,n=this.g,i=this.b,r=30;return e||n||i?(e&&r>e&&(e=r),n&&r>n&&(n=r),i&&r>i&&(i=r),oe(Math.min(255,~~(e/t)),Math.min(255,~~(n/t)),Math.min(255,~~(i/t)))):oe(r,r,r)},Uo.darker=function(t){return t=Math.pow(.7,arguments.length?t:1),oe(~~(t*this.r),~~(t*this.g),~~(t*this.b))},Uo.hsl=function(){return de(this.r,this.g,this.b)},Uo.toString=function(){return"#"+ce(this.r)+ce(this.g)+ce(this.b)};var Xo=Xs.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});Xo.forEach(function(t,e){Xo.set(t,ae(e))}),Xs.functor=ge,Xs.xhr=me(_e),Xs.dsv=function(t,e){function n(t,n,a){3>arguments.length&&(a=n,n=null);var s=ve(t,e,null==n?i:r(n),a);return s.row=function(t){return arguments.length?s.response(null==(n=t)?i:r(t)):n},s}function i(t){return n.parse(t.responseText)}function r(t){return function(e){return n.parse(e.responseText,t)}}function s(e){return e.map(o).join(t)}function o(t){return l.test(t)?'"'+t.replace(/\"/g,'""')+'"':t}var l=RegExp('["'+t+"\n]"),c=t.charCodeAt(0);return n.parse=function(t,e){var i;return n.parseRows(t,function(t,n){if(i)return i(t,n-1);var r=Function("d","return {"+t.map(function(t,e){return JSON.stringify(t)+": d["+e+"]"}).join(",")+"}");i=e?function(t,n){return e(r(t),n)}:r})},n.parseRows=function(t,e){function n(){if(u>=l)return s;if(r)return r=!1,a;var e=u;if(34===t.charCodeAt(e)){for(var n=e;l>n++;)if(34===t.charCodeAt(n)){if(34!==t.charCodeAt(n+1))break;++n}u=n+2;var i=t.charCodeAt(n+1);return 13===i?(r=!0,10===t.charCodeAt(n+2)&&++u):10===i&&(r=!0),t.substring(e+1,n).replace(/""/g,'"')}for(;l>u;){var i=t.charCodeAt(u++),o=1;if(10===i)r=!0;else if(13===i)r=!0,10===t.charCodeAt(u)&&(++u,++o);else if(i!==c)continue;return t.substring(e,u-o)}return t.substring(e)}for(var i,r,a={},s={},o=[],l=t.length,u=0,d=0;(i=n())!==s;){for(var h=[];i!==a&&i!==s;)h.push(i),i=n();(!e||(h=e(h,d++)))&&o.push(h)}return o},n.format=function(e){if(Array.isArray(e[0]))return n.formatRows(e);var i=new a,r=[];return e.forEach(function(t){for(var e in t)i.has(e)||r.push(i.add(e))}),[r.map(o).join(t)].concat(e.map(function(e){return r.map(function(t){return o(e[t])}).join(t)})).join("\n")},n.formatRows=function(t){return t.map(s).join("\n")},n},Xs.csv=Xs.dsv(",","text/csv"),Xs.tsv=Xs.dsv("	","text/tab-separated-values");var Zo,Jo,Ko,$o,Qo,tl=Qs[o(Qs,"requestAnimationFrame")]||function(t){setTimeout(t,17)};Xs.timer=function(t,e,n){var i=arguments.length;2>i&&(e=0),3>i&&(n=Date.now());var r=n+e,a={c:t,t:r,f:!1,n:null};Jo?Jo.n=a:Zo=a,Jo=a,Ko||($o=clearTimeout($o),Ko=1,tl(xe))},Xs.timer.flush=function(){be(),Ae()};var el=".",nl=",",il=[3,3],rl="$",al=["y","z","a","f","p","n","","m","","k","M","G","T","P","E","Z","Y"].map(ke);Xs.formatPrefix=function(t,e){var n=0;return t&&(0>t&&(t*=-1),e&&(t=Xs.round(t,Se(t,e))),n=1+Math.floor(1e-12+Math.log(t)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((0>=n?n+1:n-1)/3)))),al[8+n/3]},Xs.round=function(t,e){return e?Math.round(t*(e=Math.pow(10,e)))/e:Math.round(t)},Xs.format=function(t){var e=sl.exec(t),n=e[1]||" ",i=e[2]||">",r=e[3]||"",a=e[4]||"",s=e[5],o=+e[6],l=e[7],c=e[8],u=e[9],d=1,h="",p=!1;switch(c&&(c=+c.substring(1)),(s||"0"===n&&"="===i)&&(s=n="0",i="=",l&&(o-=Math.floor((o-1)/4))),u){case"n":l=!0,u="g";break;case"%":d=100,h="%",u="f";break;case"p":d=100,h="%",u="r";break;case"b":case"o":case"x":case"X":"#"===a&&(a="0"+u.toLowerCase());case"c":case"d":p=!0,c=0;break;case"s":d=-1,u="r"}"#"===a?a="":"$"===a&&(a=rl),"r"!=u||c||(u="g"),null!=c&&("g"==u?c=Math.max(1,Math.min(21,c)):("e"==u||"f"==u)&&(c=Math.max(0,Math.min(20,c)))),u=ol.get(u)||Me;var f=s&&l;return function(t){if(p&&t%1)return"";var e=0>t||0===t&&0>1/t?(t=-t,"-"):r;if(0>d){var g=Xs.formatPrefix(t,c);t=g.scale(t),h=g.symbol}else t*=d;t=u(t,c);var _=t.lastIndexOf("."),m=0>_?t:t.substring(0,_),v=0>_?"":el+t.substring(_+1);!s&&l&&(m=ll(m));var y=a.length+m.length+v.length+(f?0:e.length),x=o>y?Array(y=o-y+1).join(n):"";return f&&(m=ll(x+m)),e+=a,t=m+v,("<"===i?e+t+x:">"===i?x+e+t:"^"===i?x.substring(0,y>>=1)+e+t+x.substring(y):e+(f?t:x+t))+h}};var sl=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,ol=Xs.map({b:function(t){return t.toString(2)},c:function(t){return String.fromCharCode(t)},o:function(t){return t.toString(8)},x:function(t){return t.toString(16)},X:function(t){return t.toString(16).toUpperCase()},g:function(t,e){return t.toPrecision(e)},e:function(t,e){return t.toExponential(e)},f:function(t,e){return t.toFixed(e)},r:function(t,e){return(t=Xs.round(t,Se(t,e))).toFixed(Math.max(0,Math.min(20,Se(t*(1+1e-15),e))))}}),ll=_e;if(il){var cl=il.length;ll=function(t){for(var e=t.length,n=[],i=0,r=il[0];e>0&&r>0;)n.push(t.substring(e-=r,e+r)),r=il[i=(i+1)%cl];return n.reverse().join(nl)}}Xs.geo={},Pe.prototype={s:0,t:0,add:function(t){we(t,this.t,ul),we(ul.s,this.s,this),this.s?this.t+=ul.t:this.s=ul.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var ul=new Pe;Xs.geo.stream=function(t,e){t&&dl.hasOwnProperty(t.type)?dl[t.type](t,e):Oe(t,e)};var dl={Feature:function(t,e){Oe(t.geometry,e)},FeatureCollection:function(t,e){for(var n=t.features,i=-1,r=n.length;r>++i;)Oe(n[i].geometry,e)}},hl={Sphere:function(t,e){e.sphere()},Point:function(t,e){t=t.coordinates,e.point(t[0],t[1],t[2])},MultiPoint:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;r>++i;)t=n[i],e.point(t[0],t[1],t[2])},LineString:function(t,e){Te(t.coordinates,e,0)},MultiLineString:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;r>++i;)Te(n[i],e,0)},Polygon:function(t,e){ze(t.coordinates,e)},MultiPolygon:function(t,e){for(var n=t.coordinates,i=-1,r=n.length;r>++i;)ze(n[i],e)},GeometryCollection:function(t,e){for(var n=t.geometries,i=-1,r=n.length;r>++i;)Oe(n[i],e)}};Xs.geo.area=function(t){return pl=0,Xs.geo.stream(t,gl),pl};var pl,fl=new Pe,gl={sphere:function(){pl+=4*wo},point:l,lineStart:l,lineEnd:l,polygonStart:function(){fl.reset(),gl.lineStart=Ce},polygonEnd:function(){var t=2*fl;pl+=0>t?4*wo+t:t,gl.lineStart=gl.lineEnd=gl.point=l}};Xs.geo.bounds=function(){function t(t,e){y.push(x=[u=t,h=t]),d>e&&(d=e),e>p&&(p=e)}function e(e,n){var i=Ee([e*Eo,n*Eo]);if(m){var r=De(m,i),a=[r[1],-r[0],0],s=De(a,r);Ie(s),s=Ve(s);var l=e-f,c=l>0?1:-1,g=s[0]*No*c,_=lo(l)>180;if(_^(g>c*f&&c*e>g)){var v=s[1]*No;v>p&&(p=v)}else if(g=(g+360)%360-180,_^(g>c*f&&c*e>g)){var v=-s[1]*No;d>v&&(d=v)}else d>n&&(d=n),n>p&&(p=n);_?f>e?o(u,e)>o(u,h)&&(h=e):o(e,h)>o(u,h)&&(u=e):h>=u?(u>e&&(u=e),e>h&&(h=e)):e>f?o(u,e)>o(u,h)&&(h=e):o(e,h)>o(u,h)&&(u=e)}else t(e,n);m=i,f=e}function n(){b.point=e}function i(){x[0]=u,x[1]=h,b.point=t,m=null}function r(t,n){if(m){var i=t-f;v+=lo(i)>180?i+(i>0?360:-360):i}else g=t,_=n;gl.point(t,n),e(t,n)}function a(){gl.lineStart()}function s(){r(g,_),gl.lineEnd(),lo(v)>zo&&(u=-(h=180)),x[0]=u,x[1]=h,m=null}function o(t,e){return 0>(e-=t)?e+360:e}function l(t,e){return t[0]-e[0]}function c(t,e){return e[0]<=e[1]?t>=e[0]&&e[1]>=t:e[0]>t||t>e[1]}var u,d,h,p,f,g,_,m,v,y,x,b={point:t,lineStart:n,lineEnd:i,polygonStart:function(){b.point=r,b.lineStart=a,b.lineEnd=s,v=0,gl.polygonStart()},polygonEnd:function(){gl.polygonEnd(),b.point=t,b.lineStart=n,b.lineEnd=i,0>fl?(u=-(h=180),d=-(p=90)):v>zo?p=90:-zo>v&&(d=-90),x[0]=u,x[1]=h}};return function(t){p=h=-(u=d=1/0),y=[],Xs.geo.stream(t,b);var e=y.length;if(e){y.sort(l);for(var n,i=1,r=y[0],a=[r];e>i;++i)n=y[i],c(n[0],r)||c(n[1],r)?(o(r[0],n[1])>o(r[0],r[1])&&(r[1]=n[1]),o(n[0],r[1])>o(r[0],r[1])&&(r[0]=n[0])):a.push(r=n);for(var s,n,f=-1/0,e=a.length-1,i=0,r=a[e];e>=i;r=n,++i)n=a[i],(s=o(r[1],n[0]))>f&&(f=s,u=n[0],h=r[1])}return y=x=null,1/0===u||1/0===d?[[0/0,0/0],[0/0,0/0]]:[[u,d],[h,p]]}}(),Xs.geo.centroid=function(t){_l=ml=vl=yl=xl=bl=Al=kl=Sl=Ml=Pl=0,Xs.geo.stream(t,wl);var e=Sl,n=Ml,i=Pl,r=e*e+n*n+i*i;return Co>r&&(e=bl,n=Al,i=kl,zo>ml&&(e=vl,n=yl,i=xl),r=e*e+n*n+i*i,Co>r)?[0/0,0/0]:[Math.atan2(n,e)*No,R(i/Math.sqrt(r))*No]};var _l,ml,vl,yl,xl,bl,Al,kl,Sl,Ml,Pl,wl={sphere:l,point:Re,lineStart:He,lineEnd:qe,polygonStart:function(){wl.lineStart=Ge},polygonEnd:function(){wl.lineStart=He}},Ol=Ze(Ye,tn,nn,[-wo,-wo/2]),Tl=1e9;Xs.geo.clipExtent=function(){var t,e,n,i,r,a,s={stream:function(t){return r&&(r.valid=!1),r=a(t),r.valid=!0,r},extent:function(o){return arguments.length?(a=sn(t=+o[0][0],e=+o[0][1],n=+o[1][0],i=+o[1][1]),r&&(r.valid=!1,r=null),s):[[t,e],[n,i]]}};return s.extent([[0,0],[960,500]])},(Xs.geo.conicEqualArea=function(){return ln(cn)}).raw=cn,Xs.geo.albers=function(){return Xs.geo.conicEqualArea().rotate([96,0]).center([-.6,38.7]).parallels([29.5,45.5]).scale(1070)},Xs.geo.albersUsa=function(){function t(t){var a=t[0],s=t[1];return e=null,n(a,s),e||(i(a,s),e)||r(a,s),e}var e,n,i,r,a=Xs.geo.albers(),s=Xs.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),o=Xs.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),l={point:function(t,n){e=[t,n]}};return t.invert=function(t){var e=a.scale(),n=a.translate(),i=(t[0]-n[0])/e,r=(t[1]-n[1])/e;return(r>=.12&&.234>r&&i>=-.425&&-.214>i?s:r>=.166&&.234>r&&i>=-.214&&-.115>i?o:a).invert(t)},t.stream=function(t){var e=a.stream(t),n=s.stream(t),i=o.stream(t);return{point:function(t,r){e.point(t,r),n.point(t,r),i.point(t,r)},sphere:function(){e.sphere(),n.sphere(),i.sphere()},lineStart:function(){e.lineStart(),n.lineStart(),i.lineStart()},lineEnd:function(){e.lineEnd(),n.lineEnd(),i.lineEnd()},polygonStart:function(){e.polygonStart(),n.polygonStart(),i.polygonStart()},polygonEnd:function(){e.polygonEnd(),n.polygonEnd(),i.polygonEnd()}}},t.precision=function(e){return arguments.length?(a.precision(e),s.precision(e),o.precision(e),t):a.precision()},t.scale=function(e){return arguments.length?(a.scale(e),s.scale(.35*e),o.scale(e),t.translate(a.translate())):a.scale()},t.translate=function(e){if(!arguments.length)return a.translate();var c=a.scale(),u=+e[0],d=+e[1];return n=a.translate(e).clipExtent([[u-.455*c,d-.238*c],[u+.455*c,d+.238*c]]).stream(l).point,i=s.translate([u-.307*c,d+.201*c]).clipExtent([[u-.425*c+zo,d+.12*c+zo],[u-.214*c-zo,d+.234*c-zo]]).stream(l).point,r=o.translate([u-.205*c,d+.212*c]).clipExtent([[u-.214*c+zo,d+.166*c+zo],[u-.115*c-zo,d+.234*c-zo]]).stream(l).point,t},t.scale(1070)};var zl,Cl,El,Nl,Dl,Fl,Ll={point:l,lineStart:l,lineEnd:l,polygonStart:function(){Cl=0,Ll.lineStart=un},polygonEnd:function(){Ll.lineStart=Ll.lineEnd=Ll.point=l,zl+=lo(Cl/2)}},Il={point:dn,lineStart:l,lineEnd:l,polygonStart:l,polygonEnd:l},Vl={point:fn,lineStart:gn,lineEnd:_n,polygonStart:function(){Vl.lineStart=mn},polygonEnd:function(){Vl.point=fn,Vl.lineStart=gn,Vl.lineEnd=_n}};Xs.geo.path=function(){function t(t){return t&&("function"==typeof o&&a.pointRadius(+o.apply(this,arguments)),s&&s.valid||(s=r(a)),Xs.geo.stream(t,s)),a.result()}function e(){return s=null,t}var n,i,r,a,s,o=4.5;return t.area=function(t){return zl=0,Xs.geo.stream(t,r(Ll)),zl},t.centroid=function(t){return vl=yl=xl=bl=Al=kl=Sl=Ml=Pl=0,Xs.geo.stream(t,r(Vl)),Pl?[Sl/Pl,Ml/Pl]:kl?[bl/kl,Al/kl]:xl?[vl/xl,yl/xl]:[0/0,0/0]},t.bounds=function(t){return Dl=Fl=-(El=Nl=1/0),Xs.geo.stream(t,r(Il)),[[El,Nl],[Dl,Fl]]},t.projection=function(t){return arguments.length?(r=(n=t)?t.stream||xn(t):_e,e()):n},t.context=function(t){return arguments.length?(a=null==(i=t)?new hn:new vn(t),"function"!=typeof o&&a.pointRadius(o),e()):i},t.pointRadius=function(e){return arguments.length?(o="function"==typeof e?e:(a.pointRadius(+e),+e),t):o},t.projection(Xs.geo.albersUsa()).context(null)},Xs.geo.transform=function(t){return{stream:function(e){var n=new bn(e);for(var i in t)n[i]=t[i];return n}}},bn.prototype={point:function(t,e){this.stream.point(t,e)},sphere:function(){this.stream.sphere()},lineStart:function(){this.stream.lineStart()},lineEnd:function(){this.stream.lineEnd()
},polygonStart:function(){this.stream.polygonStart()},polygonEnd:function(){this.stream.polygonEnd()}},Xs.geo.projection=kn,Xs.geo.projectionMutator=Sn,(Xs.geo.equirectangular=function(){return kn(Pn)}).raw=Pn.invert=Pn,Xs.geo.rotation=function(t){function e(e){return e=t(e[0]*Eo,e[1]*Eo),e[0]*=No,e[1]*=No,e}return t=On(t[0]%360*Eo,t[1]*Eo,t.length>2?t[2]*Eo:0),e.invert=function(e){return e=t.invert(e[0]*Eo,e[1]*Eo),e[0]*=No,e[1]*=No,e},e},wn.invert=Pn,Xs.geo.circle=function(){function t(){var t="function"==typeof i?i.apply(this,arguments):i,e=On(-t[0]*Eo,-t[1]*Eo,0).invert,r=[];return n(null,null,1,{point:function(t,n){r.push(t=e(t,n)),t[0]*=No,t[1]*=No}}),{type:"Polygon",coordinates:[r]}}var e,n,i=[0,0],r=6;return t.origin=function(e){return arguments.length?(i=e,t):i},t.angle=function(i){return arguments.length?(n=En((e=+i)*Eo,r*Eo),t):e},t.precision=function(i){return arguments.length?(n=En(e*Eo,(r=+i)*Eo),t):r},t.angle(90)},Xs.geo.distance=function(t,e){var n,i=(e[0]-t[0])*Eo,r=t[1]*Eo,a=e[1]*Eo,s=Math.sin(i),o=Math.cos(i),l=Math.sin(r),c=Math.cos(r),u=Math.sin(a),d=Math.cos(a);return Math.atan2(Math.sqrt((n=d*s)*n+(n=c*u-l*d*o)*n),l*u+c*d*o)},Xs.geo.graticule=function(){function t(){return{type:"MultiLineString",coordinates:e()}}function e(){return Xs.range(Math.ceil(a/_)*_,r,_).map(h).concat(Xs.range(Math.ceil(c/m)*m,l,m).map(p)).concat(Xs.range(Math.ceil(i/f)*f,n,f).filter(function(t){return lo(t%_)>zo}).map(u)).concat(Xs.range(Math.ceil(o/g)*g,s,g).filter(function(t){return lo(t%m)>zo}).map(d))}var n,i,r,a,s,o,l,c,u,d,h,p,f=10,g=f,_=90,m=360,v=2.5;return t.lines=function(){return e().map(function(t){return{type:"LineString",coordinates:t}})},t.outline=function(){return{type:"Polygon",coordinates:[h(a).concat(p(l).slice(1),h(r).reverse().slice(1),p(c).reverse().slice(1))]}},t.extent=function(e){return arguments.length?t.majorExtent(e).minorExtent(e):t.minorExtent()},t.majorExtent=function(e){return arguments.length?(a=+e[0][0],r=+e[1][0],c=+e[0][1],l=+e[1][1],a>r&&(e=a,a=r,r=e),c>l&&(e=c,c=l,l=e),t.precision(v)):[[a,c],[r,l]]},t.minorExtent=function(e){return arguments.length?(i=+e[0][0],n=+e[1][0],o=+e[0][1],s=+e[1][1],i>n&&(e=i,i=n,n=e),o>s&&(e=o,o=s,s=e),t.precision(v)):[[i,o],[n,s]]},t.step=function(e){return arguments.length?t.majorStep(e).minorStep(e):t.minorStep()},t.majorStep=function(e){return arguments.length?(_=+e[0],m=+e[1],t):[_,m]},t.minorStep=function(e){return arguments.length?(f=+e[0],g=+e[1],t):[f,g]},t.precision=function(e){return arguments.length?(v=+e,u=Dn(o,s,90),d=Fn(i,n,v),h=Dn(c,l,90),p=Fn(a,r,v),t):v},t.majorExtent([[-180,-90+zo],[180,90-zo]]).minorExtent([[-180,-80-zo],[180,80+zo]])},Xs.geo.greatArc=function(){function t(){return{type:"LineString",coordinates:[e||i.apply(this,arguments),n||r.apply(this,arguments)]}}var e,n,i=Ln,r=In;return t.distance=function(){return Xs.geo.distance(e||i.apply(this,arguments),n||r.apply(this,arguments))},t.source=function(n){return arguments.length?(i=n,e="function"==typeof n?null:n,t):i},t.target=function(e){return arguments.length?(r=e,n="function"==typeof e?null:e,t):r},t.precision=function(){return arguments.length?t:0},t},Xs.geo.interpolate=function(t,e){return Vn(t[0]*Eo,t[1]*Eo,e[0]*Eo,e[1]*Eo)},Xs.geo.length=function(t){return Bl=0,Xs.geo.stream(t,Rl),Bl};var Bl,Rl={sphere:l,point:l,lineStart:Bn,lineEnd:l,polygonStart:l,polygonEnd:l},jl=Rn(function(t){return Math.sqrt(2/(1+t))},function(t){return 2*Math.asin(t/2)});(Xs.geo.azimuthalEqualArea=function(){return kn(jl)}).raw=jl;var Hl=Rn(function(t){var e=Math.acos(t);return e&&e/Math.sin(e)},_e);(Xs.geo.azimuthalEquidistant=function(){return kn(Hl)}).raw=Hl,(Xs.geo.conicConformal=function(){return ln(jn)}).raw=jn,(Xs.geo.conicEquidistant=function(){return ln(Hn)}).raw=Hn;var ql=Rn(function(t){return 1/t},Math.atan);(Xs.geo.gnomonic=function(){return kn(ql)}).raw=ql,qn.invert=function(t,e){return[t,2*Math.atan(Math.exp(e))-To]},(Xs.geo.mercator=function(){return Gn(qn)}).raw=qn;var Gl=Rn(function(){return 1},Math.asin);(Xs.geo.orthographic=function(){return kn(Gl)}).raw=Gl;var Yl=Rn(function(t){return 1/(1+t)},function(t){return 2*Math.atan(t)});(Xs.geo.stereographic=function(){return kn(Yl)}).raw=Yl,Yn.invert=function(t,e){return[-e,2*Math.atan(Math.exp(t))-To]},(Xs.geo.transverseMercator=function(){var t=Gn(Yn),e=t.center,n=t.rotate;return t.center=function(t){return t?e([-t[1],t[0]]):(t=e(),[-t[1],t[0]])},t.rotate=function(t){return t?n([t[0],t[1],t.length>2?t[2]+90:90]):(t=n(),[t[0],t[1],t[2]-90])},t.rotate([0,0])}).raw=Yn,Xs.geom={},Xs.geom.hull=function(t){function e(t){if(3>t.length)return[];var e,r,a,s,o,l,c,u,d,h,p,f,g=ge(n),_=ge(i),m=t.length,v=m-1,y=[],x=[],b=0;if(g===Wn&&i===Un)e=t;else for(a=0,e=[];m>a;++a)e.push([+g.call(this,r=t[a],a),+_.call(this,r,a)]);for(a=1;m>a;++a)(e[a][1]<e[b][1]||e[a][1]==e[b][1]&&e[a][0]<e[b][0])&&(b=a);for(a=0;m>a;++a)a!==b&&(l=e[a][1]-e[b][1],o=e[a][0]-e[b][0],y.push({angle:Math.atan2(l,o),index:a}));for(y.sort(function(t,e){return t.angle-e.angle}),p=y[0].angle,h=y[0].index,d=0,a=1;v>a;++a){if(s=y[a].index,p==y[a].angle){if(o=e[h][0]-e[b][0],l=e[h][1]-e[b][1],c=e[s][0]-e[b][0],u=e[s][1]-e[b][1],o*o+l*l>=c*c+u*u){y[a].index=-1;continue}y[d].index=-1}p=y[a].angle,d=a,h=s}for(x.push(b),a=0,s=0;2>a;++s)y[s].index>-1&&(x.push(y[s].index),a++);for(f=x.length;v>s;++s)if(!(0>y[s].index)){for(;!Xn(x[f-2],x[f-1],y[s].index,e);)--f;x[f++]=y[s].index}var A=[];for(a=f-1;a>=0;--a)A.push(t[x[a]]);return A}var n=Wn,i=Un;return arguments.length?e(t):(e.x=function(t){return arguments.length?(n=t,e):n},e.y=function(t){return arguments.length?(i=t,e):i},e)},Xs.geom.polygon=function(t){return fo(t,Wl),t};var Wl=Xs.geom.polygon.prototype=[];Wl.area=function(){for(var t,e=-1,n=this.length,i=this[n-1],r=0;n>++e;)t=i,i=this[e],r+=t[1]*i[0]-t[0]*i[1];return.5*r},Wl.centroid=function(t){var e,n,i=-1,r=this.length,a=0,s=0,o=this[r-1];for(arguments.length||(t=-1/(6*this.area()));r>++i;)e=o,o=this[i],n=e[0]*o[1]-o[0]*e[1],a+=(e[0]+o[0])*n,s+=(e[1]+o[1])*n;return[a*t,s*t]},Wl.clip=function(t){for(var e,n,i,r,a,s,o=Kn(t),l=-1,c=this.length-Kn(this),u=this[c-1];c>++l;){for(e=t.slice(),t.length=0,r=this[l],a=e[(i=e.length-o)-1],n=-1;i>++n;)s=e[n],Zn(s,u,r)?(Zn(a,u,r)||t.push(Jn(a,s,u,r)),t.push(s)):Zn(a,u,r)&&t.push(Jn(a,s,u,r)),a=s;o&&t.push(t[0]),u=r}return t};var Ul,Xl,Zl,Jl,Kl,$l=[],Ql=[];ai.prototype.prepare=function(){for(var t,e=this.edges,n=e.length;n--;)t=e[n].edge,t.b&&t.a||e.splice(n,1);return e.sort(oi),e.length},mi.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a}},vi.prototype={insert:function(t,e){var n,i,r;if(t){if(e.P=t,e.N=t.N,t.N&&(t.N.P=e),t.N=e,t.R){for(t=t.R;t.L;)t=t.L;t.L=e}else t.R=e;n=t}else this._?(t=Ai(this._),e.P=null,e.N=t,t.P=t.L=e,n=t):(e.P=e.N=null,this._=e,n=null);for(e.L=e.R=null,e.U=n,e.C=!0,t=e;n&&n.C;)i=n.U,n===i.L?(r=i.R,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.R&&(xi(this,n),t=n,n=t.U),n.C=!1,i.C=!0,bi(this,i))):(r=i.L,r&&r.C?(n.C=r.C=!1,i.C=!0,t=i):(t===n.L&&(bi(this,n),t=n,n=t.U),n.C=!1,i.C=!0,xi(this,i))),n=t.U;this._.C=!1},remove:function(t){t.N&&(t.N.P=t.P),t.P&&(t.P.N=t.N),t.N=t.P=null;var e,n,i,r=t.U,a=t.L,s=t.R;if(n=a?s?Ai(s):a:s,r?r.L===t?r.L=n:r.R=n:this._=n,a&&s?(i=n.C,n.C=t.C,n.L=a,a.U=n,n!==s?(r=n.U,n.U=t.U,t=n.R,r.L=t,n.R=s,s.U=n):(n.U=r,r=n,t=n.R)):(i=t.C,t=n),t&&(t.U=r),!i){if(t&&t.C)return t.C=!1,void 0;do{if(t===this._)break;if(t===r.L){if(e=r.R,e.C&&(e.C=!1,r.C=!0,xi(this,r),e=r.R),e.L&&e.L.C||e.R&&e.R.C){e.R&&e.R.C||(e.L.C=!1,e.C=!0,bi(this,e),e=r.R),e.C=r.C,r.C=e.R.C=!1,xi(this,r),t=this._;break}}else if(e=r.L,e.C&&(e.C=!1,r.C=!0,bi(this,r),e=r.L),e.L&&e.L.C||e.R&&e.R.C){e.L&&e.L.C||(e.R.C=!1,e.C=!0,xi(this,e),e=r.L),e.C=r.C,r.C=e.L.C=!1,bi(this,r),t=this._;break}e.C=!0,t=r,r=r.U}while(!t.C);t&&(t.C=!1)}}},Xs.geom.voronoi=function(t){function e(t){var e=Array(t.length),i=o[0][0],r=o[0][1],a=o[1][0],s=o[1][1];return ki(n(t),o).cells.forEach(function(n,o){var l=n.edges,c=n.site,u=e[o]=l.length?l.map(function(t){var e=t.start();return[e.x,e.y]}):c.x>=i&&a>=c.x&&c.y>=r&&s>=c.y?[[i,s],[a,s],[a,r],[i,r]]:[];u.point=t[o]}),e}function n(t){return t.map(function(t,e){return{x:Math.round(a(t,e)/zo)*zo,y:Math.round(s(t,e)/zo)*zo,i:e}})}var i=Wn,r=Un,a=i,s=r,o=tc;return t?e(t):(e.links=function(t){return ki(n(t)).edges.filter(function(t){return t.l&&t.r}).map(function(e){return{source:t[e.l.i],target:t[e.r.i]}})},e.triangles=function(t){var e=[];return ki(n(t)).cells.forEach(function(n,i){for(var r,a,s=n.site,o=n.edges.sort(oi),l=-1,c=o.length,u=o[c-1].edge,d=u.l===s?u.r:u.l;c>++l;)r=u,a=d,u=o[l].edge,d=u.l===s?u.r:u.l,a.i>i&&d.i>i&&0>Mi(s,a,d)&&e.push([t[i],t[a.i],t[d.i]])}),e},e.x=function(t){return arguments.length?(a=ge(i=t),e):i},e.y=function(t){return arguments.length?(s=ge(r=t),e):r},e.clipExtent=function(t){return arguments.length?(o=null==t?tc:t,e):o===tc?null:o},e.size=function(t){return arguments.length?e.clipExtent(t&&[[0,0],t]):o===tc?null:o&&o[1]},e)};var tc=[[-1e6,-1e6],[1e6,1e6]];Xs.geom.delaunay=function(t){return Xs.geom.voronoi().triangles(t)},Xs.geom.quadtree=function(t,e,n,i,r){function a(t){function a(t,e,n,i,r,a,s,o){if(!isNaN(n)&&!isNaN(i))if(t.leaf){var l=t.x,u=t.y;if(null!=l)if(.01>lo(l-n)+lo(u-i))c(t,e,n,i,r,a,s,o);else{var d=t.point;t.x=t.y=t.point=null,c(t,d,l,u,r,a,s,o),c(t,e,n,i,r,a,s,o)}else t.x=n,t.y=i,t.point=e}else c(t,e,n,i,r,a,s,o)}function c(t,e,n,i,r,s,o,l){var c=.5*(r+o),u=.5*(s+l),d=n>=c,h=i>=u,p=(h<<1)+d;t.leaf=!1,t=t.nodes[p]||(t.nodes[p]=Oi()),d?r=c:o=c,h?s=u:l=u,a(t,e,n,i,r,s,o,l)}var u,d,h,p,f,g,_,m,v,y=ge(o),x=ge(l);if(null!=e)g=e,_=n,m=i,v=r;else if(m=v=-(g=_=1/0),d=[],h=[],f=t.length,s)for(p=0;f>p;++p)u=t[p],g>u.x&&(g=u.x),_>u.y&&(_=u.y),u.x>m&&(m=u.x),u.y>v&&(v=u.y),d.push(u.x),h.push(u.y);else for(p=0;f>p;++p){var b=+y(u=t[p],p),A=+x(u,p);g>b&&(g=b),_>A&&(_=A),b>m&&(m=b),A>v&&(v=A),d.push(b),h.push(A)}var k=m-g,S=v-_;k>S?v=_+k:m=g+S;var M=Oi();if(M.add=function(t){a(M,t,+y(t,++p),+x(t,p),g,_,m,v)},M.visit=function(t){Ti(t,M,g,_,m,v)},p=-1,null==e){for(;f>++p;)a(M,t[p],d[p],h[p],g,_,m,v);--p}else t.forEach(M.add);return d=h=t=u=null,M}var s,o=Wn,l=Un;return(s=arguments.length)?(o=Pi,l=wi,3===s&&(r=n,i=e,n=e=0),a(t)):(a.x=function(t){return arguments.length?(o=t,a):o},a.y=function(t){return arguments.length?(l=t,a):l},a.extent=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=+t[0][0],n=+t[0][1],i=+t[1][0],r=+t[1][1]),a):null==e?null:[[e,n],[i,r]]},a.size=function(t){return arguments.length?(null==t?e=n=i=r=null:(e=n=0,i=+t[0],r=+t[1]),a):null==e?null:[i-e,r-n]},a)},Xs.interpolateRgb=zi,Xs.interpolateObject=Ci,Xs.interpolateNumber=Ei,Xs.interpolateString=Ni;var ec=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;Xs.interpolate=Di,Xs.interpolators=[function(t,e){var n=typeof e;return("string"===n?Xo.has(e)||/^(#|rgb\(|hsl\()/.test(e)?zi:Ni:e instanceof Y?zi:"object"===n?Array.isArray(e)?Fi:Ci:Ei)(t,e)}],Xs.interpolateArray=Fi;var nc=function(){return _e},ic=Xs.map({linear:nc,poly:Hi,quad:function(){return Bi},cubic:function(){return Ri},sin:function(){return qi},exp:function(){return Gi},circle:function(){return Yi},elastic:Wi,back:Ui,bounce:function(){return Xi}}),rc=Xs.map({"in":_e,out:Ii,"in-out":Vi,"out-in":function(t){return Vi(Ii(t))}});Xs.ease=function(t){var e=t.indexOf("-"),n=e>=0?t.substring(0,e):t,i=e>=0?t.substring(e+1):"in";return n=ic.get(n)||nc,i=rc.get(i)||_e,Li(i(n.apply(null,Zs.call(arguments,1))))},Xs.interpolateHcl=Zi,Xs.interpolateHsl=Ji,Xs.interpolateLab=Ki,Xs.interpolateRound=$i,Xs.transform=function(t){var e=Ks.createElementNS(Xs.ns.prefix.svg,"g");return(Xs.transform=function(t){if(null!=t){e.setAttribute("transform",t);var n=e.transform.baseVal.consolidate()}return new Qi(n?n.matrix:ac)})(t)},Qi.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var ac={a:1,b:0,c:0,d:1,e:0,f:0};Xs.interpolateTransform=ir,Xs.layout={},Xs.layout.bundle=function(){return function(t){for(var e=[],n=-1,i=t.length;i>++n;)e.push(sr(t[n]));return e}},Xs.layout.chord=function(){function t(){var t,c,d,h,p,f={},g=[],_=Xs.range(a),m=[];for(n=[],i=[],t=0,h=-1;a>++h;){for(c=0,p=-1;a>++p;)c+=r[h][p];g.push(c),m.push(Xs.range(a)),t+=c}for(s&&_.sort(function(t,e){return s(g[t],g[e])}),o&&m.forEach(function(t,e){t.sort(function(t,n){return o(r[e][t],r[e][n])})}),t=(Oo-u*a)/t,c=0,h=-1;a>++h;){for(d=c,p=-1;a>++p;){var v=_[h],y=m[v][p],x=r[v][y],b=c,A=c+=x*t;f[v+"-"+y]={index:v,subindex:y,startAngle:b,endAngle:A,value:x}}i[v]={index:v,startAngle:d,endAngle:c,value:(c-d)/t},c+=u}for(h=-1;a>++h;)for(p=h-1;a>++p;){var k=f[h+"-"+p],S=f[p+"-"+h];(k.value||S.value)&&n.push(k.value<S.value?{source:S,target:k}:{source:k,target:S})}l&&e()}function e(){n.sort(function(t,e){return l((t.source.value+t.target.value)/2,(e.source.value+e.target.value)/2)})}var n,i,r,a,s,o,l,c={},u=0;return c.matrix=function(t){return arguments.length?(a=(r=t)&&r.length,n=i=null,c):r},c.padding=function(t){return arguments.length?(u=t,n=i=null,c):u},c.sortGroups=function(t){return arguments.length?(s=t,n=i=null,c):s},c.sortSubgroups=function(t){return arguments.length?(o=t,n=null,c):o},c.sortChords=function(t){return arguments.length?(l=t,n&&e(),c):l},c.chords=function(){return n||t(),n},c.groups=function(){return i||t(),i},c},Xs.layout.force=function(){function t(t){return function(e,n,i,r){if(e.point!==t){var a=e.cx-t.x,s=e.cy-t.y,o=1/Math.sqrt(a*a+s*s);if(g>(r-n)*o){var l=e.charge*o*o;return t.px-=a*l,t.py-=s*l,!0}if(e.point&&isFinite(o)){var l=e.pointCharge*o*o;t.px-=a*l,t.py-=s*l}}return!e.charge}}function e(t){t.px=Xs.event.x,t.py=Xs.event.y,o.resume()}var n,i,r,a,s,o={},l=Xs.dispatch("start","tick","end"),c=[1,1],u=.9,d=sc,h=oc,p=-30,f=.1,g=.8,_=[],m=[];return o.tick=function(){if(.005>(i*=.99))return l.end({type:"end",alpha:i=0}),!0;var e,n,o,d,h,g,v,y,x,b=_.length,A=m.length;for(n=0;A>n;++n)o=m[n],d=o.source,h=o.target,y=h.x-d.x,x=h.y-d.y,(g=y*y+x*x)&&(g=i*a[n]*((g=Math.sqrt(g))-r[n])/g,y*=g,x*=g,h.x-=y*(v=d.weight/(h.weight+d.weight)),h.y-=x*v,d.x+=y*(v=1-v),d.y+=x*v);if((v=i*f)&&(y=c[0]/2,x=c[1]/2,n=-1,v))for(;b>++n;)o=_[n],o.x+=(y-o.x)*v,o.y+=(x-o.y)*v;if(p)for(pr(e=Xs.geom.quadtree(_),i,s),n=-1;b>++n;)(o=_[n]).fixed||e.visit(t(o));for(n=-1;b>++n;)o=_[n],o.fixed?(o.x=o.px,o.y=o.py):(o.x-=(o.px-(o.px=o.x))*u,o.y-=(o.py-(o.py=o.y))*u);l.tick({type:"tick",alpha:i})},o.nodes=function(t){return arguments.length?(_=t,o):_},o.links=function(t){return arguments.length?(m=t,o):m},o.size=function(t){return arguments.length?(c=t,o):c},o.linkDistance=function(t){return arguments.length?(d="function"==typeof t?t:+t,o):d},o.distance=o.linkDistance,o.linkStrength=function(t){return arguments.length?(h="function"==typeof t?t:+t,o):h},o.friction=function(t){return arguments.length?(u=+t,o):u},o.charge=function(t){return arguments.length?(p="function"==typeof t?t:+t,o):p},o.gravity=function(t){return arguments.length?(f=+t,o):f},o.theta=function(t){return arguments.length?(g=+t,o):g},o.alpha=function(t){return arguments.length?(t=+t,i?i=t>0?t:0:t>0&&(l.start({type:"start",alpha:i=t}),Xs.timer(o.tick)),o):i},o.start=function(){function t(t,i){if(!n){for(n=Array(l),o=0;l>o;++o)n[o]=[];for(o=0;c>o;++o){var r=m[o];n[r.source.index].push(r.target),n[r.target.index].push(r.source)}}for(var a,s=n[e],o=-1,c=s.length;c>++o;)if(!isNaN(a=s[o][t]))return a;return Math.random()*i}var e,n,i,l=_.length,u=m.length,f=c[0],g=c[1];for(e=0;l>e;++e)(i=_[e]).index=e,i.weight=0;for(e=0;u>e;++e)i=m[e],"number"==typeof i.source&&(i.source=_[i.source]),"number"==typeof i.target&&(i.target=_[i.target]),++i.source.weight,++i.target.weight;for(e=0;l>e;++e)i=_[e],isNaN(i.x)&&(i.x=t("x",f)),isNaN(i.y)&&(i.y=t("y",g)),isNaN(i.px)&&(i.px=i.x),isNaN(i.py)&&(i.py=i.y);if(r=[],"function"==typeof d)for(e=0;u>e;++e)r[e]=+d.call(this,m[e],e);else for(e=0;u>e;++e)r[e]=d;if(a=[],"function"==typeof h)for(e=0;u>e;++e)a[e]=+h.call(this,m[e],e);else for(e=0;u>e;++e)a[e]=h;if(s=[],"function"==typeof p)for(e=0;l>e;++e)s[e]=+p.call(this,_[e],e);else for(e=0;l>e;++e)s[e]=p;return o.resume()},o.resume=function(){return o.alpha(.1)},o.stop=function(){return o.alpha(0)},o.drag=function(){return n||(n=Xs.behavior.drag().origin(_e).on("dragstart.force",cr).on("drag.force",e).on("dragend.force",ur)),arguments.length?(this.on("mouseover.force",dr).on("mouseout.force",hr).call(n),void 0):n},Xs.rebind(o,l,"on")};var sc=20,oc=1;Xs.layout.hierarchy=function(){function t(e,s,o){var l=r.call(n,e,s);if(e.depth=s,o.push(e),l&&(c=l.length)){for(var c,u,d=-1,h=e.children=Array(c),p=0,f=s+1;c>++d;)u=h[d]=t(l[d],f,o),u.parent=e,p+=u.value;i&&h.sort(i),a&&(e.value=p)}else delete e.children,a&&(e.value=+a.call(n,e,s)||0);return e}function e(t,i){var r=t.children,s=0;if(r&&(o=r.length))for(var o,l=-1,c=i+1;o>++l;)s+=e(r[l],c);else a&&(s=+a.call(n,t,i)||0);return a&&(t.value=s),s}function n(e){var n=[];return t(e,0,n),n}var i=mr,r=gr,a=_r;return n.sort=function(t){return arguments.length?(i=t,n):i},n.children=function(t){return arguments.length?(r=t,n):r},n.value=function(t){return arguments.length?(a=t,n):a},n.revalue=function(t){return e(t,0),t},n},Xs.layout.partition=function(){function t(e,n,i,r){var a=e.children;if(e.x=n,e.y=e.depth*r,e.dx=i,e.dy=r,a&&(s=a.length)){var s,o,l,c=-1;for(i=e.value?i/e.value:0;s>++c;)t(o=a[c],n,l=o.value*i,r),n+=l}}function e(t){var n=t.children,i=0;if(n&&(r=n.length))for(var r,a=-1;r>++a;)i=Math.max(i,e(n[a]));return 1+i}function n(n,a){var s=i.call(this,n,a);return t(s[0],0,r[0],r[1]/e(s[0])),s}var i=Xs.layout.hierarchy(),r=[1,1];return n.size=function(t){return arguments.length?(r=t,n):r},fr(n,i)},Xs.layout.pie=function(){function t(a){var s=a.map(function(n,i){return+e.call(t,n,i)}),o=+("function"==typeof i?i.apply(this,arguments):i),l=(("function"==typeof r?r.apply(this,arguments):r)-o)/Xs.sum(s),c=Xs.range(a.length);null!=n&&c.sort(n===lc?function(t,e){return s[e]-s[t]}:function(t,e){return n(a[t],a[e])});var u=[];return c.forEach(function(t){var e;u[t]={data:a[t],value:e=s[t],startAngle:o,endAngle:o+=e*l}}),u}var e=Number,n=lc,i=0,r=Oo;return t.value=function(n){return arguments.length?(e=n,t):e},t.sort=function(e){return arguments.length?(n=e,t):n},t.startAngle=function(e){return arguments.length?(i=e,t):i},t.endAngle=function(e){return arguments.length?(r=e,t):r},t};var lc={};Xs.layout.stack=function(){function t(o,l){var c=o.map(function(n,i){return e.call(t,n,i)}),u=c.map(function(e){return e.map(function(e,n){return[a.call(t,e,n),s.call(t,e,n)]})}),d=n.call(t,u,l);c=Xs.permute(c,d),u=Xs.permute(u,d);var h,p,f,g=i.call(t,u,l),_=c.length,m=c[0].length;for(p=0;m>p;++p)for(r.call(t,c[0][p],f=g[p],u[0][p][1]),h=1;_>h;++h)r.call(t,c[h][p],f+=u[h-1][p][1],u[h][p][1]);return o}var e=_e,n=Ar,i=kr,r=br,a=yr,s=xr;return t.values=function(n){return arguments.length?(e=n,t):e},t.order=function(e){return arguments.length?(n="function"==typeof e?e:cc.get(e)||Ar,t):n},t.offset=function(e){return arguments.length?(i="function"==typeof e?e:uc.get(e)||kr,t):i},t.x=function(e){return arguments.length?(a=e,t):a},t.y=function(e){return arguments.length?(s=e,t):s},t.out=function(e){return arguments.length?(r=e,t):r},t};var cc=Xs.map({"inside-out":function(t){var e,n,i=t.length,r=t.map(Sr),a=t.map(Mr),s=Xs.range(i).sort(function(t,e){return r[t]-r[e]}),o=0,l=0,c=[],u=[];for(e=0;i>e;++e)n=s[e],l>o?(o+=a[n],c.push(n)):(l+=a[n],u.push(n));return u.reverse().concat(c)},reverse:function(t){return Xs.range(t.length).reverse()},"default":Ar}),uc=Xs.map({silhouette:function(t){var e,n,i,r=t.length,a=t[0].length,s=[],o=0,l=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];i>o&&(o=i),s.push(i)}for(n=0;a>n;++n)l[n]=(o-s[n])/2;return l},wiggle:function(t){var e,n,i,r,a,s,o,l,c,u=t.length,d=t[0],h=d.length,p=[];for(p[0]=l=c=0,n=1;h>n;++n){for(e=0,r=0;u>e;++e)r+=t[e][n][1];for(e=0,a=0,o=d[n][0]-d[n-1][0];u>e;++e){for(i=0,s=(t[e][n][1]-t[e][n-1][1])/(2*o);e>i;++i)s+=(t[i][n][1]-t[i][n-1][1])/o;a+=s*t[e][n][1]}p[n]=l-=r?a/r*o:0,c>l&&(c=l)}for(n=0;h>n;++n)p[n]-=c;return p},expand:function(t){var e,n,i,r=t.length,a=t[0].length,s=1/r,o=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=s}for(n=0;a>n;++n)o[n]=0;return o},zero:kr});Xs.layout.histogram=function(){function t(t,a){for(var s,o,l=[],c=t.map(n,this),u=i.call(this,c,a),d=r.call(this,u,c,a),a=-1,h=c.length,p=d.length-1,f=e?1:1/h;p>++a;)s=l[a]=[],s.dx=d[a+1]-(s.x=d[a]),s.y=0;if(p>0)for(a=-1;h>++a;)o=c[a],o>=u[0]&&u[1]>=o&&(s=l[Xs.bisect(d,o,1,p)-1],s.y+=f,s.push(t[a]));return l}var e=!0,n=Number,i=Tr,r=wr;return t.value=function(e){return arguments.length?(n=e,t):n},t.range=function(e){return arguments.length?(i=ge(e),t):i},t.bins=function(e){return arguments.length?(r="number"==typeof e?function(t){return Or(t,e)}:ge(e),t):r},t.frequency=function(n){return arguments.length?(e=!!n,t):e},t},Xs.layout.tree=function(){function t(t,a){function s(t,e){var i=t.children,r=t._tree;if(i&&(a=i.length)){for(var a,o,c,u=i[0],d=u,h=-1;a>++h;)c=i[h],s(c,o),d=l(c,o,d),o=c;Vr(t);var p=.5*(u._tree.prelim+c._tree.prelim);e?(r.prelim=e._tree.prelim+n(t,e),r.mod=r.prelim-p):r.prelim=p}else e&&(r.prelim=e._tree.prelim+n(t,e))}function o(t,e){t.x=t._tree.prelim+e;var n=t.children;if(n&&(i=n.length)){var i,r=-1;for(e+=t._tree.mod;i>++r;)o(n[r],e)}}function l(t,e,i){if(e){for(var r,a=t,s=t,o=e,l=t.parent.children[0],c=a._tree.mod,u=s._tree.mod,d=o._tree.mod,h=l._tree.mod;o=Er(o),a=Cr(a),o&&a;)l=Cr(l),s=Er(s),s._tree.ancestor=t,r=o._tree.prelim+d-a._tree.prelim-c+n(o,a),r>0&&(Br(Rr(o,t,i),t,r),c+=r,u+=r),d+=o._tree.mod,c+=a._tree.mod,h+=l._tree.mod,u+=s._tree.mod;o&&!Er(s)&&(s._tree.thread=o,s._tree.mod+=d-u),a&&!Cr(l)&&(l._tree.thread=a,l._tree.mod+=c-h,i=t)}return i}var c=e.call(this,t,a),u=c[0];Ir(u,function(t,e){t._tree={ancestor:t,prelim:0,mod:0,change:0,shift:0,number:e?e._tree.number+1:0}}),s(u),o(u,-u._tree.prelim);var d=Nr(u,Fr),h=Nr(u,Dr),p=Nr(u,Lr),f=d.x-n(d,h)/2,g=h.x+n(h,d)/2,_=p.depth||1;return Ir(u,r?function(t){t.x*=i[0],t.y=t.depth*i[1],delete t._tree}:function(t){t.x=(t.x-f)/(g-f)*i[0],t.y=t.depth/_*i[1],delete t._tree}),c}var e=Xs.layout.hierarchy().sort(null).value(null),n=zr,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},fr(t,e)},Xs.layout.pack=function(){function t(t,a){var s=n.call(this,t,a),o=s[0],l=r[0],c=r[1],u=null==e?Math.sqrt:"function"==typeof e?e:function(){return e};if(o.x=o.y=0,Ir(o,function(t){t.r=+u(t.value)}),Ir(o,Yr),i){var d=i*(e?1:Math.max(2*o.r/l,2*o.r/c))/2;Ir(o,function(t){t.r+=d}),Ir(o,Yr),Ir(o,function(t){t.r-=d})}return Xr(o,l/2,c/2,e?1:1/Math.max(2*o.r/l,2*o.r/c)),s}var e,n=Xs.layout.hierarchy().sort(jr),i=0,r=[1,1];return t.size=function(e){return arguments.length?(r=e,t):r},t.radius=function(n){return arguments.length?(e=null==n||"function"==typeof n?n:+n,t):e},t.padding=function(e){return arguments.length?(i=+e,t):i},fr(t,n)},Xs.layout.cluster=function(){function t(t,a){var s,o=e.call(this,t,a),l=o[0],c=0;Ir(l,function(t){var e=t.children;e&&e.length?(t.x=Kr(e),t.y=Jr(e)):(t.x=s?c+=n(t,s):0,t.y=0,s=t)});var u=$r(l),d=Qr(l),h=u.x-n(u,d)/2,p=d.x+n(d,u)/2;return Ir(l,r?function(t){t.x=(t.x-l.x)*i[0],t.y=(l.y-t.y)*i[1]}:function(t){t.x=(t.x-h)/(p-h)*i[0],t.y=(1-(l.y?t.y/l.y:1))*i[1]}),o}var e=Xs.layout.hierarchy().sort(null).value(null),n=zr,i=[1,1],r=!1;return t.separation=function(e){return arguments.length?(n=e,t):n},t.size=function(e){return arguments.length?(r=null==(i=e),t):r?null:i},t.nodeSize=function(e){return arguments.length?(r=null!=(i=e),t):r?i:null},fr(t,e)},Xs.layout.treemap=function(){function t(t,e){for(var n,i,r=-1,a=t.length;a>++r;)i=(n=t[r]).value*(0>e?0:e),n.area=isNaN(i)||0>=i?0:i}function e(n){var a=n.children;if(a&&a.length){var s,o,l,c=d(n),u=[],h=a.slice(),f=1/0,g="slice"===p?c.dx:"dice"===p?c.dy:"slice-dice"===p?1&n.depth?c.dy:c.dx:Math.min(c.dx,c.dy);for(t(h,c.dx*c.dy/n.value),u.area=0;(l=h.length)>0;)u.push(s=h[l-1]),u.area+=s.area,"squarify"!==p||f>=(o=i(u,g))?(h.pop(),f=o):(u.area-=u.pop().area,r(u,g,c,!1),g=Math.min(c.dx,c.dy),u.length=u.area=0,f=1/0);u.length&&(r(u,g,c,!0),u.length=u.area=0),a.forEach(e)}}function n(e){var i=e.children;if(i&&i.length){var a,s=d(e),o=i.slice(),l=[];for(t(o,s.dx*s.dy/e.value),l.area=0;a=o.pop();)l.push(a),l.area+=a.area,null!=a.z&&(r(l,a.z?s.dx:s.dy,s,!o.length),l.length=l.area=0);i.forEach(n)}}function i(t,e){for(var n,i=t.area,r=0,a=1/0,s=-1,o=t.length;o>++s;)(n=t[s].area)&&(a>n&&(a=n),n>r&&(r=n));return i*=i,e*=e,i?Math.max(e*r*f/i,i/(e*a*f)):1/0}function r(t,e,n,i){var r,a=-1,s=t.length,o=n.x,c=n.y,u=e?l(t.area/e):0;if(e==n.dx){for((i||u>n.dy)&&(u=n.dy);s>++a;)r=t[a],r.x=o,r.y=c,r.dy=u,o+=r.dx=Math.min(n.x+n.dx-o,u?l(r.area/u):0);r.z=!0,r.dx+=n.x+n.dx-o,n.y+=u,n.dy-=u}else{for((i||u>n.dx)&&(u=n.dx);s>++a;)r=t[a],r.x=o,r.y=c,r.dx=u,c+=r.dy=Math.min(n.y+n.dy-c,u?l(r.area/u):0);r.z=!1,r.dy+=n.y+n.dy-c,n.x+=u,n.dx-=u}}function a(i){var r=s||o(i),a=r[0];return a.x=0,a.y=0,a.dx=c[0],a.dy=c[1],s&&o.revalue(a),t([a],a.dx*a.dy/a.value),(s?n:e)(a),h&&(s=r),r}var s,o=Xs.layout.hierarchy(),l=Math.round,c=[1,1],u=null,d=ta,h=!1,p="squarify",f=.5*(1+Math.sqrt(5));return a.size=function(t){return arguments.length?(c=t,a):c},a.padding=function(t){function e(e){var n=t.call(a,e,e.depth);return null==n?ta(e):ea(e,"number"==typeof n?[n,n,n,n]:n)}function n(e){return ea(e,t)}if(!arguments.length)return u;var i;return d=null==(u=t)?ta:"function"==(i=typeof t)?e:"number"===i?(t=[t,t,t,t],n):n,a},a.round=function(t){return arguments.length?(l=t?Math.round:Number,a):l!=Number},a.sticky=function(t){return arguments.length?(h=t,s=null,a):h},a.ratio=function(t){return arguments.length?(f=t,a):f},a.mode=function(t){return arguments.length?(p=t+"",a):p},fr(a,o)},Xs.random={normal:function(t,e){var n=arguments.length;return 2>n&&(e=1),1>n&&(t=0),function(){var n,i,r;do n=2*Math.random()-1,i=2*Math.random()-1,r=n*n+i*i;while(!r||r>1);return t+e*n*Math.sqrt(-2*Math.log(r)/r)}},logNormal:function(){var t=Xs.random.normal.apply(Xs,arguments);return function(){return Math.exp(t())}},bates:function(t){var e=Xs.random.irwinHall(t);return function(){return e()/t}},irwinHall:function(t){return function(){for(var e=0,n=0;t>n;n++)e+=Math.random();return e}}},Xs.scale={};var dc={floor:_e,ceil:_e};Xs.scale.linear=function(){return la([0,1],[0,1],Di,!1)};var hc={s:1,g:1,p:1,r:1,e:1};Xs.scale.log=function(){return _a(Xs.scale.linear().domain([0,1]),10,!0,[1,10])};var pc=Xs.format(".0e"),fc={floor:function(t){return-Math.ceil(-t)},ceil:function(t){return-Math.floor(-t)}};Xs.scale.pow=function(){return ma(Xs.scale.linear(),1,[0,1])},Xs.scale.sqrt=function(){return Xs.scale.pow().exponent(.5)},Xs.scale.ordinal=function(){return ya([],{t:"range",a:[[]]})},Xs.scale.category10=function(){return Xs.scale.ordinal().range(gc)},Xs.scale.category20=function(){return Xs.scale.ordinal().range(_c)},Xs.scale.category20b=function(){return Xs.scale.ordinal().range(mc)},Xs.scale.category20c=function(){return Xs.scale.ordinal().range(vc)};var gc=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(se),_c=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(se),mc=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(se),vc=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(se);Xs.scale.quantile=function(){return xa([],[])},Xs.scale.quantize=function(){return ba(0,1,[0,1])},Xs.scale.threshold=function(){return Aa([.5],[0,1])},Xs.scale.identity=function(){return ka([0,1])},Xs.svg={},Xs.svg.arc=function(){function t(){var t=e.apply(this,arguments),a=n.apply(this,arguments),s=i.apply(this,arguments)+yc,o=r.apply(this,arguments)+yc,l=(s>o&&(l=s,s=o,o=l),o-s),c=wo>l?"0":"1",u=Math.cos(s),d=Math.sin(s),h=Math.cos(o),p=Math.sin(o);return l>=xc?t?"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"M0,"+t+"A"+t+","+t+" 0 1,0 0,"+-t+"A"+t+","+t+" 0 1,0 0,"+t+"Z":"M0,"+a+"A"+a+","+a+" 0 1,1 0,"+-a+"A"+a+","+a+" 0 1,1 0,"+a+"Z":t?"M"+a*u+","+a*d+"A"+a+","+a+" 0 "+c+",1 "+a*h+","+a*p+"L"+t*h+","+t*p+"A"+t+","+t+" 0 "+c+",0 "+t*u+","+t*d+"Z":"M"+a*u+","+a*d+"A"+a+","+a+" 0 "+c+",1 "+a*h+","+a*p+"L0,0"+"Z"}var e=Sa,n=Ma,i=Pa,r=wa;return t.innerRadius=function(n){return arguments.length?(e=ge(n),t):e},t.outerRadius=function(e){return arguments.length?(n=ge(e),t):n},t.startAngle=function(e){return arguments.length?(i=ge(e),t):i},t.endAngle=function(e){return arguments.length?(r=ge(e),t):r},t.centroid=function(){var t=(e.apply(this,arguments)+n.apply(this,arguments))/2,a=(i.apply(this,arguments)+r.apply(this,arguments))/2+yc;return[Math.cos(a)*t,Math.sin(a)*t]},t};var yc=-To,xc=Oo-zo;Xs.svg.line=function(){return Oa(_e)};var bc=Xs.map({linear:Ta,"linear-closed":za,step:Ca,"step-before":Ea,"step-after":Na,basis:Ba,"basis-open":Ra,"basis-closed":ja,bundle:Ha,cardinal:La,"cardinal-open":Da,"cardinal-closed":Fa,monotone:Xa});bc.forEach(function(t,e){e.key=t,e.closed=/-closed$/.test(t)});var Ac=[0,2/3,1/3,0],kc=[0,1/3,2/3,0],Sc=[0,1/6,2/3,1/6];Xs.svg.line.radial=function(){var t=Oa(Za);return t.radius=t.x,delete t.x,t.angle=t.y,delete t.y,t},Ea.reverse=Na,Na.reverse=Ea,Xs.svg.area=function(){return Ja(_e)},Xs.svg.area.radial=function(){var t=Ja(Za);return t.radius=t.x,delete t.x,t.innerRadius=t.x0,delete t.x0,t.outerRadius=t.x1,delete t.x1,t.angle=t.y,delete t.y,t.startAngle=t.y0,delete t.y0,t.endAngle=t.y1,delete t.y1,t},Xs.svg.chord=function(){function t(t,o){var l=e(this,a,t,o),c=e(this,s,t,o);return"M"+l.p0+i(l.r,l.p1,l.a1-l.a0)+(n(l,c)?r(l.r,l.p1,l.r,l.p0):r(l.r,l.p1,c.r,c.p0)+i(c.r,c.p1,c.a1-c.a0)+r(c.r,c.p1,l.r,l.p0))+"Z"}function e(t,e,n,i){var r=e.call(t,n,i),a=o.call(t,r,i),s=l.call(t,r,i)+yc,u=c.call(t,r,i)+yc;return{r:a,a0:s,a1:u,p0:[a*Math.cos(s),a*Math.sin(s)],p1:[a*Math.cos(u),a*Math.sin(u)]}}function n(t,e){return t.a0==e.a0&&t.a1==e.a1}function i(t,e,n){return"A"+t+","+t+" 0 "+ +(n>wo)+",1 "+e}function r(t,e,n,i){return"Q 0,0 "+i}var a=Ln,s=In,o=Ka,l=Pa,c=wa;return t.radius=function(e){return arguments.length?(o=ge(e),t):o},t.source=function(e){return arguments.length?(a=ge(e),t):a},t.target=function(e){return arguments.length?(s=ge(e),t):s},t.startAngle=function(e){return arguments.length?(l=ge(e),t):l},t.endAngle=function(e){return arguments.length?(c=ge(e),t):c},t},Xs.svg.diagonal=function(){function t(t,r){var a=e.call(this,t,r),s=n.call(this,t,r),o=(a.y+s.y)/2,l=[a,{x:a.x,y:o},{x:s.x,y:o},s];return l=l.map(i),"M"+l[0]+"C"+l[1]+" "+l[2]+" "+l[3]}var e=Ln,n=In,i=$a;return t.source=function(n){return arguments.length?(e=ge(n),t):e},t.target=function(e){return arguments.length?(n=ge(e),t):n},t.projection=function(e){return arguments.length?(i=e,t):i},t},Xs.svg.diagonal.radial=function(){var t=Xs.svg.diagonal(),e=$a,n=t.projection;return t.projection=function(t){return arguments.length?n(Qa(e=t)):e},t},Xs.svg.symbol=function(){function t(t,i){return(Mc.get(e.call(this,t,i))||ns)(n.call(this,t,i))}var e=es,n=ts;return t.type=function(n){return arguments.length?(e=ge(n),t):e},t.size=function(e){return arguments.length?(n=ge(e),t):n},t};var Mc=Xs.map({circle:ns,cross:function(t){var e=Math.sqrt(t/5)/2;return"M"+-3*e+","+-e+"H"+-e+"V"+-3*e+"H"+e+"V"+-e+"H"+3*e+"V"+e+"H"+e+"V"+3*e+"H"+-e+"V"+e+"H"+-3*e+"Z"},diamond:function(t){var e=Math.sqrt(t/(2*Tc)),n=e*Tc;return"M0,"+-e+"L"+n+",0"+" 0,"+e+" "+-n+",0"+"Z"},square:function(t){var e=Math.sqrt(t)/2;return"M"+-e+","+-e+"L"+e+","+-e+" "+e+","+e+" "+-e+","+e+"Z"},"triangle-down":function(t){var e=Math.sqrt(t/Oc),n=e*Oc/2;
return"M0,"+n+"L"+e+","+-n+" "+-e+","+-n+"Z"},"triangle-up":function(t){var e=Math.sqrt(t/Oc),n=e*Oc/2;return"M0,"+-n+"L"+e+","+n+" "+-e+","+n+"Z"}});Xs.svg.symbolTypes=Mc.keys();var Pc,wc,Oc=Math.sqrt(3),Tc=Math.tan(30*Eo),zc=[],Cc=0;zc.call=yo.call,zc.empty=yo.empty,zc.node=yo.node,zc.size=yo.size,Xs.transition=function(t){return arguments.length?Pc?t.transition():t:Ao.transition()},Xs.transition.prototype=zc,zc.select=function(t){var e,n,i,r=this.id,a=[];t=g(t);for(var s=-1,o=this.length;o>++s;){a.push(e=[]);for(var l=this[s],c=-1,u=l.length;u>++c;)(i=l[c])&&(n=t.call(i,i.__data__,c,s))?("__data__"in i&&(n.__data__=i.__data__),ss(n,c,r,i.__transition__[r]),e.push(n)):e.push(null)}return is(a,r)},zc.selectAll=function(t){var e,n,i,r,a,s=this.id,o=[];t=_(t);for(var l=-1,c=this.length;c>++l;)for(var u=this[l],d=-1,h=u.length;h>++d;)if(i=u[d]){a=i.__transition__[s],n=t.call(i,i.__data__,d,l),o.push(e=[]);for(var p=-1,f=n.length;f>++p;)(r=n[p])&&ss(r,p,s,a),e.push(r)}return is(o,s)},zc.filter=function(t){var e,n,i,r=[];"function"!=typeof t&&(t=w(t));for(var a=0,s=this.length;s>a;a++){r.push(e=[]);for(var n=this[a],o=0,l=n.length;l>o;o++)(i=n[o])&&t.call(i,i.__data__,o,a)&&e.push(i)}return is(r,this.id)},zc.tween=function(t,e){var n=this.id;return 2>arguments.length?this.node().__transition__[n].tween.get(t):T(this,null==e?function(e){e.__transition__[n].tween.remove(t)}:function(i){i.__transition__[n].tween.set(t,e)})},zc.attr=function(t,e){function n(){this.removeAttribute(o)}function i(){this.removeAttributeNS(o.space,o.local)}function r(t){return null==t?n:(t+="",function(){var e,n=this.getAttribute(o);return n!==t&&(e=s(n,t),function(t){this.setAttribute(o,e(t))})})}function a(t){return null==t?i:(t+="",function(){var e,n=this.getAttributeNS(o.space,o.local);return n!==t&&(e=s(n,t),function(t){this.setAttributeNS(o.space,o.local,e(t))})})}if(2>arguments.length){for(e in t)this.attr(e,t[e]);return this}var s="transform"==t?ir:Di,o=Xs.ns.qualify(t);return rs(this,"attr."+t,e,o.local?a:r)},zc.attrTween=function(t,e){function n(t,n){var i=e.call(this,t,n,this.getAttribute(r));return i&&function(t){this.setAttribute(r,i(t))}}function i(t,n){var i=e.call(this,t,n,this.getAttributeNS(r.space,r.local));return i&&function(t){this.setAttributeNS(r.space,r.local,i(t))}}var r=Xs.ns.qualify(t);return this.tween("attr."+t,r.local?i:n)},zc.style=function(t,e,n){function i(){this.style.removeProperty(t)}function r(e){return null==e?i:(e+="",function(){var i,r=Qs.getComputedStyle(this,null).getPropertyValue(t);return r!==e&&(i=Di(r,e),function(e){this.style.setProperty(t,i(e),n)})})}var a=arguments.length;if(3>a){if("string"!=typeof t){2>a&&(e="");for(n in t)this.style(n,t[n],e);return this}n=""}return rs(this,"style."+t,e,r)},zc.styleTween=function(t,e,n){function i(i,r){var a=e.call(this,i,r,Qs.getComputedStyle(this,null).getPropertyValue(t));return a&&function(e){this.style.setProperty(t,a(e),n)}}return 3>arguments.length&&(n=""),this.tween("style."+t,i)},zc.text=function(t){return rs(this,"text",t,as)},zc.remove=function(){return this.each("end.transition",function(){var t;2>this.__transition__.count&&(t=this.parentNode)&&t.removeChild(this)})},zc.ease=function(t){var e=this.id;return 1>arguments.length?this.node().__transition__[e].ease:("function"!=typeof t&&(t=Xs.ease.apply(Xs,arguments)),T(this,function(n){n.__transition__[e].ease=t}))},zc.delay=function(t){var e=this.id;return T(this,"function"==typeof t?function(n,i,r){n.__transition__[e].delay=+t.call(n,n.__data__,i,r)}:(t=+t,function(n){n.__transition__[e].delay=t}))},zc.duration=function(t){var e=this.id;return T(this,"function"==typeof t?function(n,i,r){n.__transition__[e].duration=Math.max(1,t.call(n,n.__data__,i,r))}:(t=Math.max(1,t),function(n){n.__transition__[e].duration=t}))},zc.each=function(t,e){var n=this.id;if(2>arguments.length){var i=wc,r=Pc;Pc=n,T(this,function(e,i,r){wc=e.__transition__[n],t.call(e,e.__data__,i,r)}),wc=i,Pc=r}else T(this,function(i){var r=i.__transition__[n];(r.event||(r.event=Xs.dispatch("start","end"))).on(t,e)});return this},zc.transition=function(){for(var t,e,n,i,r=this.id,a=++Cc,s=[],o=0,l=this.length;l>o;o++){s.push(t=[]);for(var e=this[o],c=0,u=e.length;u>c;c++)(n=e[c])&&(i=Object.create(n.__transition__[r]),i.delay+=i.duration,ss(n,c,a,i)),t.push(n)}return is(s,a)},Xs.svg.axis=function(){function t(t){t.each(function(){var t,c=Xs.select(this),u=this.__chart__||n,d=this.__chart__=n.copy(),h=null==l?d.ticks?d.ticks.apply(d,o):d.domain():l,p=null==e?d.tickFormat?d.tickFormat.apply(d,o):_e:e,f=c.selectAll(".tick").data(h,d),g=f.enter().insert("g",".domain").attr("class","tick").style("opacity",zo),_=Xs.transition(f.exit()).style("opacity",zo).remove(),m=Xs.transition(f).style("opacity",1),v=ia(d),y=c.selectAll(".domain").data([0]),x=(y.enter().append("path").attr("class","domain"),Xs.transition(y));g.append("line"),g.append("text");var b=g.select("line"),A=m.select("line"),k=f.select("text").text(p),S=g.select("text"),M=m.select("text");switch(i){case"bottom":t=os,b.attr("y2",r),S.attr("y",Math.max(r,0)+s),A.attr("x2",0).attr("y2",r),M.attr("x",0).attr("y",Math.max(r,0)+s),k.attr("dy",".71em").style("text-anchor","middle"),x.attr("d","M"+v[0]+","+a+"V0H"+v[1]+"V"+a);break;case"top":t=os,b.attr("y2",-r),S.attr("y",-(Math.max(r,0)+s)),A.attr("x2",0).attr("y2",-r),M.attr("x",0).attr("y",-(Math.max(r,0)+s)),k.attr("dy","0em").style("text-anchor","middle"),x.attr("d","M"+v[0]+","+-a+"V0H"+v[1]+"V"+-a);break;case"left":t=ls,b.attr("x2",-r),S.attr("x",-(Math.max(r,0)+s)),A.attr("x2",-r).attr("y2",0),M.attr("x",-(Math.max(r,0)+s)).attr("y",0),k.attr("dy",".32em").style("text-anchor","end"),x.attr("d","M"+-a+","+v[0]+"H0V"+v[1]+"H"+-a);break;case"right":t=ls,b.attr("x2",r),S.attr("x",Math.max(r,0)+s),A.attr("x2",r).attr("y2",0),M.attr("x",Math.max(r,0)+s).attr("y",0),k.attr("dy",".32em").style("text-anchor","start"),x.attr("d","M"+a+","+v[0]+"H0V"+v[1]+"H"+a)}if(d.rangeBand){var P=d,w=P.rangeBand()/2;u=d=function(t){return P(t)+w}}else u.rangeBand?u=d:_.call(t,d);g.call(t,u),m.call(t,d)})}var e,n=Xs.scale.linear(),i=Ec,r=6,a=6,s=3,o=[10],l=null;return t.scale=function(e){return arguments.length?(n=e,t):n},t.orient=function(e){return arguments.length?(i=e in Nc?e+"":Ec,t):i},t.ticks=function(){return arguments.length?(o=arguments,t):o},t.tickValues=function(e){return arguments.length?(l=e,t):l},t.tickFormat=function(n){return arguments.length?(e=n,t):e},t.tickSize=function(e){var n=arguments.length;return n?(r=+e,a=+arguments[n-1],t):r},t.innerTickSize=function(e){return arguments.length?(r=+e,t):r},t.outerTickSize=function(e){return arguments.length?(a=+e,t):a},t.tickPadding=function(e){return arguments.length?(s=+e,t):s},t.tickSubdivide=function(){return arguments.length&&t},t};var Ec="bottom",Nc={top:1,right:1,bottom:1,left:1};Xs.svg.brush=function(){function t(a){a.each(function(){var a=Xs.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",r).on("touchstart.brush",r),s=a.selectAll(".background").data([0]);s.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),a.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");var o=a.selectAll(".resize").data(_,_e);o.exit().remove(),o.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return Dc[t]}).append("rect").attr("x",function(t){return/[ew]$/.test(t)?-3:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),o.style("display",t.empty()?"none":null);var u,d=Xs.transition(a),h=Xs.transition(s);l&&(u=ia(l),h.attr("x",u[0]).attr("width",u[1]-u[0]),n(d)),c&&(u=ia(c),h.attr("y",u[0]).attr("height",u[1]-u[0]),i(d)),e(d)})}function e(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+u[+/e$/.test(t)]+","+h[+/^s/.test(t)]+")"})}function n(t){t.select(".extent").attr("x",u[0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",u[1]-u[0])}function i(t){t.select(".extent").attr("y",h[0]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",h[1]-h[0])}function r(){function r(){32==Xs.event.keyCode&&(O||(y=null,z[0]-=u[1],z[1]-=h[1],O=2),d())}function p(){32==Xs.event.keyCode&&2==O&&(z[0]+=u[1],z[1]+=h[1],O=0,d())}function _(){var t=Xs.mouse(b),r=!1;x&&(t[0]+=x[0],t[1]+=x[1]),O||(Xs.event.altKey?(y||(y=[(u[0]+u[1])/2,(h[0]+h[1])/2]),z[0]=u[+(t[0]<y[0])],z[1]=h[+(t[1]<y[1])]):y=null),P&&m(t,l,0)&&(n(S),r=!0),w&&m(t,c,1)&&(i(S),r=!0),r&&(e(S),k({type:"brush",mode:O?"move":"resize"}))}function m(t,e,n){var i,r,o=ia(e),l=o[0],c=o[1],d=z[n],p=n?h:u,_=p[1]-p[0];return O&&(l-=d,c-=_+d),i=(n?g:f)?Math.max(l,Math.min(c,t[n])):t[n],O?r=(i+=d)+_:(y&&(d=Math.max(l,Math.min(c,2*y[n]-i))),i>d?(r=i,i=d):r=d),p[0]!=i||p[1]!=r?(n?s=null:a=null,p[0]=i,p[1]=r,!0):void 0}function v(){_(),S.style("pointer-events","all").selectAll(".resize").style("display",t.empty()?"none":null),Xs.select("body").style("cursor",null),C.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),T(),k({type:"brushend"})}var y,x,b=this,A=Xs.select(Xs.event.target),k=o.of(b,arguments),S=Xs.select(b),M=A.datum(),P=!/^(n|s)$/.test(M)&&l,w=!/^(e|w)$/.test(M)&&c,O=A.classed("extent"),T=L(),z=Xs.mouse(b),C=Xs.select(Qs).on("keydown.brush",r).on("keyup.brush",p);if(Xs.event.changedTouches?C.on("touchmove.brush",_).on("touchend.brush",v):C.on("mousemove.brush",_).on("mouseup.brush",v),S.interrupt().selectAll("*").interrupt(),O)z[0]=u[0]-z[0],z[1]=h[0]-z[1];else if(M){var E=+/w$/.test(M),N=+/^n/.test(M);x=[u[1-E]-z[0],h[1-N]-z[1]],z[0]=u[E],z[1]=h[N]}else Xs.event.altKey&&(y=z.slice());S.style("pointer-events","none").selectAll(".resize").style("display",null),Xs.select("body").style("cursor",A.style("cursor")),k({type:"brushstart"}),_()}var a,s,o=p(t,"brushstart","brush","brushend"),l=null,c=null,u=[0,0],h=[0,0],f=!0,g=!0,_=Fc[0];return t.event=function(t){t.each(function(){var t=o.of(this,arguments),e={x:u,y:h,i:a,j:s},n=this.__chart__||e;this.__chart__=e,Pc?Xs.select(this).transition().each("start.brush",function(){a=n.i,s=n.j,u=n.x,h=n.y,t({type:"brushstart"})}).tween("brush:brush",function(){var n=Fi(u,e.x),i=Fi(h,e.y);return a=s=null,function(r){u=e.x=n(r),h=e.y=i(r),t({type:"brush",mode:"resize"})}}).each("end.brush",function(){a=e.i,s=e.j,t({type:"brush",mode:"resize"}),t({type:"brushend"})}):(t({type:"brushstart"}),t({type:"brush",mode:"resize"}),t({type:"brushend"}))})},t.x=function(e){return arguments.length?(l=e,_=Fc[!l<<1|!c],t):l},t.y=function(e){return arguments.length?(c=e,_=Fc[!l<<1|!c],t):c},t.clamp=function(e){return arguments.length?(l&&c?(f=!!e[0],g=!!e[1]):l?f=!!e:c&&(g=!!e),t):l&&c?[f,g]:l?f:c?g:null},t.extent=function(e){var n,i,r,o,d;return arguments.length?(l&&(n=e[0],i=e[1],c&&(n=n[0],i=i[0]),a=[n,i],l.invert&&(n=l(n),i=l(i)),n>i&&(d=n,n=i,i=d),(n!=u[0]||i!=u[1])&&(u=[n,i])),c&&(r=e[0],o=e[1],l&&(r=r[1],o=o[1]),s=[r,o],c.invert&&(r=c(r),o=c(o)),r>o&&(d=r,r=o,o=d),(r!=h[0]||o!=h[1])&&(h=[r,o])),t):(l&&(a?(n=a[0],i=a[1]):(n=u[0],i=u[1],l.invert&&(n=l.invert(n),i=l.invert(i)),n>i&&(d=n,n=i,i=d))),c&&(s?(r=s[0],o=s[1]):(r=h[0],o=h[1],c.invert&&(r=c.invert(r),o=c.invert(o)),r>o&&(d=r,r=o,o=d))),l&&c?[[n,r],[i,o]]:l?[n,i]:c&&[r,o])},t.clear=function(){return t.empty()||(u=[0,0],h=[0,0],a=s=null),t},t.empty=function(){return!!l&&u[0]==u[1]||!!c&&h[0]==h[1]},Xs.rebind(t,o,"on")};var Dc={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Fc=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]],Lc=Xs.time={},Ic=Date,Vc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];cs.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Bc.setUTCDate.apply(this._,arguments)},setDay:function(){Bc.setUTCDay.apply(this._,arguments)},setFullYear:function(){Bc.setUTCFullYear.apply(this._,arguments)},setHours:function(){Bc.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Bc.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Bc.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Bc.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Bc.setUTCSeconds.apply(this._,arguments)},setTime:function(){Bc.setTime.apply(this._,arguments)}};var Bc=Date.prototype,Rc="%a %b %e %X %Y",jc="%m/%d/%Y",Hc="%H:%M:%S",qc=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Gc=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],Yc=["January","February","March","April","May","June","July","August","September","October","November","December"],Wc=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];Lc.year=us(function(t){return t=Lc.day(t),t.setMonth(0,1),t},function(t,e){t.setFullYear(t.getFullYear()+e)},function(t){return t.getFullYear()}),Lc.years=Lc.year.range,Lc.years.utc=Lc.year.utc.range,Lc.day=us(function(t){var e=new Ic(2e3,0);return e.setFullYear(t.getFullYear(),t.getMonth(),t.getDate()),e},function(t,e){t.setDate(t.getDate()+e)},function(t){return t.getDate()-1}),Lc.days=Lc.day.range,Lc.days.utc=Lc.day.utc.range,Lc.dayOfYear=function(t){var e=Lc.year(t);return Math.floor((t-e-6e4*(t.getTimezoneOffset()-e.getTimezoneOffset()))/864e5)},Vc.forEach(function(t,e){t=t.toLowerCase(),e=7-e;var n=Lc[t]=us(function(t){return(t=Lc.day(t)).setDate(t.getDate()-(t.getDay()+e)%7),t},function(t,e){t.setDate(t.getDate()+7*Math.floor(e))},function(t){var n=Lc.year(t).getDay();return Math.floor((Lc.dayOfYear(t)+(n+e)%7)/7)-(n!==e)});Lc[t+"s"]=n.range,Lc[t+"s"].utc=n.utc.range,Lc[t+"OfYear"]=function(t){var n=Lc.year(t).getDay();return Math.floor((Lc.dayOfYear(t)+(n+e)%7)/7)}}),Lc.week=Lc.sunday,Lc.weeks=Lc.sunday.range,Lc.weeks.utc=Lc.sunday.utc.range,Lc.weekOfYear=Lc.sundayOfYear,Lc.format=hs;var Uc=fs(qc),Xc=gs(qc),Zc=fs(Gc),Jc=gs(Gc),Kc=fs(Yc),$c=gs(Yc),Qc=fs(Wc),tu=gs(Wc),eu=/^%/,nu={"-":"",_:" ",0:"0"},iu={a:function(t){return Gc[t.getDay()]},A:function(t){return qc[t.getDay()]},b:function(t){return Wc[t.getMonth()]},B:function(t){return Yc[t.getMonth()]},c:hs(Rc),d:function(t,e){return _s(t.getDate(),e,2)},e:function(t,e){return _s(t.getDate(),e,2)},H:function(t,e){return _s(t.getHours(),e,2)},I:function(t,e){return _s(t.getHours()%12||12,e,2)},j:function(t,e){return _s(1+Lc.dayOfYear(t),e,3)},L:function(t,e){return _s(t.getMilliseconds(),e,3)},m:function(t,e){return _s(t.getMonth()+1,e,2)},M:function(t,e){return _s(t.getMinutes(),e,2)},p:function(t){return t.getHours()>=12?"PM":"AM"},S:function(t,e){return _s(t.getSeconds(),e,2)},U:function(t,e){return _s(Lc.sundayOfYear(t),e,2)},w:function(t){return t.getDay()},W:function(t,e){return _s(Lc.mondayOfYear(t),e,2)},x:hs(jc),X:hs(Hc),y:function(t,e){return _s(t.getFullYear()%100,e,2)},Y:function(t,e){return _s(t.getFullYear()%1e4,e,4)},Z:Bs,"%":function(){return"%"}},ru={a:ms,A:vs,b:As,B:ks,c:Ss,d:Es,e:Es,H:Ds,I:Ds,j:Ns,L:Is,m:Cs,M:Fs,p:Vs,S:Ls,U:xs,w:ys,W:bs,x:Ms,X:Ps,y:Os,Y:ws,Z:Ts,"%":Rs},au=/^\s*\d+/,su=Xs.map({am:0,pm:1});hs.utc=js;var ou=js("%Y-%m-%dT%H:%M:%S.%LZ");hs.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?Hs:ou,Hs.parse=function(t){var e=new Date(t);return isNaN(e)?null:e},Hs.toString=ou.toString,Lc.second=us(function(t){return new Ic(1e3*Math.floor(t/1e3))},function(t,e){t.setTime(t.getTime()+1e3*Math.floor(e))},function(t){return t.getSeconds()}),Lc.seconds=Lc.second.range,Lc.seconds.utc=Lc.second.utc.range,Lc.minute=us(function(t){return new Ic(6e4*Math.floor(t/6e4))},function(t,e){t.setTime(t.getTime()+6e4*Math.floor(e))},function(t){return t.getMinutes()}),Lc.minutes=Lc.minute.range,Lc.minutes.utc=Lc.minute.utc.range,Lc.hour=us(function(t){var e=t.getTimezoneOffset()/60;return new Ic(36e5*(Math.floor(t/36e5-e)+e))},function(t,e){t.setTime(t.getTime()+36e5*Math.floor(e))},function(t){return t.getHours()}),Lc.hours=Lc.hour.range,Lc.hours.utc=Lc.hour.utc.range,Lc.month=us(function(t){return t=Lc.day(t),t.setDate(1),t},function(t,e){t.setMonth(t.getMonth()+e)},function(t){return t.getMonth()}),Lc.months=Lc.month.range,Lc.months.utc=Lc.month.utc.range;var lu=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],cu=[[Lc.second,1],[Lc.second,5],[Lc.second,15],[Lc.second,30],[Lc.minute,1],[Lc.minute,5],[Lc.minute,15],[Lc.minute,30],[Lc.hour,1],[Lc.hour,3],[Lc.hour,6],[Lc.hour,12],[Lc.day,1],[Lc.day,2],[Lc.week,1],[Lc.month,1],[Lc.month,3],[Lc.year,1]],uu=[[hs("%Y"),Ye],[hs("%B"),function(t){return t.getMonth()}],[hs("%b %d"),function(t){return 1!=t.getDate()}],[hs("%a %d"),function(t){return t.getDay()&&1!=t.getDate()}],[hs("%I %p"),function(t){return t.getHours()}],[hs("%I:%M"),function(t){return t.getMinutes()}],[hs(":%S"),function(t){return t.getSeconds()}],[hs(".%L"),function(t){return t.getMilliseconds()}]],du=Ys(uu);cu.year=Lc.year,Lc.scale=function(){return qs(Xs.scale.linear(),cu,du)};var hu={range:function(t,e,n){return Xs.range(+t,+e,n).map(Gs)},floor:_e,ceil:_e},pu=cu.map(function(t){return[t[0].utc,t[1]]}),fu=[[js("%Y"),Ye],[js("%B"),function(t){return t.getUTCMonth()}],[js("%b %d"),function(t){return 1!=t.getUTCDate()}],[js("%a %d"),function(t){return t.getUTCDay()&&1!=t.getUTCDate()}],[js("%I %p"),function(t){return t.getUTCHours()}],[js("%I:%M"),function(t){return t.getUTCMinutes()}],[js(":%S"),function(t){return t.getUTCSeconds()}],[js(".%L"),function(t){return t.getUTCMilliseconds()}]],gu=Ys(fu);return pu.year=Lc.year.utc,Lc.scale.utc=function(){return qs(Xs.scale.linear(),pu,gu)},Xs.text=me(function(t){return t.responseText}),Xs.json=function(t,e){return ve(t,"application/json",Ws,e)},Xs.html=function(t,e){return ve(t,"text/html",Us,e)},Xs.xml=me(function(t){return t.responseXML}),Xs}(),function(){function t(t){return function(){if("touchstart"===d3.event.type){V=e(d3.event),H=R=V.pageX,q=j=V.pageY,B=!0;var n=d3.event;setTimeout(function(){H!==R||B||q!==j||(d3.event=n,t.apply(this,arguments))},200)}"touchend"===d3.event.type&&B&&(B=!1),"touchmove"===d3.event.type&&B&&(V=e(d3.event),R=V.pageX,j=V.pageY)}}function e(t){return t.touches?t.touches[0]:t}function n(t){return t[0]}function i(t){return t[1]}function r(t){return t[2]}function a(){return!0}function s(){return 0}function o(t){return t[0]}function l(t){return t[1]}function c(t){return t[2]}function u(t){return t[3]}function d(){return!0}function h(t,e,n,i){return"M"+t+","+n+"L"+e+","+n+"L"+e+","+i+"L"+t+","+i+"Z"}function p(){return 64}function f(){return"circle"}function g(t){return t[0]}function _(t){return t[1]}function m(){return!0}function v(t){return t[0]}function b(t){return t[1]}function A(t){return t[2]}function k(t){return t[3]}function S(){return!1}function M(){return!0}function P(t,e,n,i,r){var a;return r?(a=n+(i-n)/2,"M"+t+","+n+"L"+t+","+i+"M"+t+","+a+"L"+e+","+a+"M"+e+","+n+"L"+e+","+i):(a=t+(e-t)/2,"M"+t+","+n+"L"+e+","+n+"M"+a+","+n+"L"+a+","+i+"M"+t+","+i+"L"+e+","+i)}function w(){return!0}function O(t){return t[0]}function T(t){return t[1]}function z(t,e){for(var n=d3.max([t.length,e.length]),i="M",r=0;n>r;r++)r>0&&(i+="L"),i+=t.length>r?t[r]:"0",i+=",",i+=e.length>r?e[r]:"0";return i+="Z"}function C(){}function E(t){function e(){for(var e,i=n,r=-1,a=i.length;a>++r;)(e=i[r].on)&&e.apply(this,arguments);return t}var n=[],i=new d3.map;return e.on=function(e,r){var a,s=i.get(e);return 2>arguments.length?s&&s.on:(s&&(s.on=null,n=n.slice(0,a=n.indexOf(s)).concat(n.slice(a+1)),i.remove(e)),r&&n.push(i.set(e,{on:r})),t)},e}function N(t){for(var e=new C,n=0,i=arguments.length;i>++n;)e[arguments[n]]=E(e);return e.of=function(n,i){return function(r){var a;try{a=r.sourceEvent=d3.event,r.target=t,d3.event=r,e[r.type].apply(n,i)}finally{d3.event=a}}},e}function D(){d3.event.stopPropagation(),d3.event.preventDefault()}var F=d3.selection.prototype,L=F.on,I={tap:[["touchstart","touchend","touchmove"],t]},V=null,B=!1,R=0,j=0,H=0,q=0;F.on=function(t,e,n){var i=t.split("."),r=i.shift(),a=I[r];if(a){var s=a[0],o=this;return e=a[1].call(null,e),s.forEach(function(t){var r=[t,i].join(".");L.call(o,r,e,n)}),L}return L.apply(this,arguments)},dv=function(){},dv.version="3.1.0",dv.ANIMATION=!0;var G=!1,Y=/xyz/.test(function(){})?/\b_super\b/:/.*/;dv.extend=function(t){function e(){if(!G){G=!0;var t=new arguments.callee;return G=!1,t.init.apply(t,arguments),t}}var n=this.prototype;G=!0;var i=new this;t=t(),t.init=t,G=!1;for(var r in t)i[r]="function"==typeof t[r]&&"function"==typeof n[r]&&Y.test(t[r])?function(t,e){return function(){var i=this._super;this._super=n[t];var r=e.apply(this,arguments);return this._super=i,r}}(r,t[r]):t[r];return e.prototype=i,e.mixin=function(t,e){dv.util.isObject(t)?dv.util.each(t,function(t,n){i[n]=e}):i[t]=e},e.extend=arguments.callee,e},dv.DEFAULT_COLORS=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"],dv.DEFAULT_CATEGORICAL_AES=["color","fill","stroke","shape","size","linetype"],dv.absoluteCoordinates=function(t,e,n){if(t.coord()instanceof dv.coord.polar){var i=t.coord().flip()?n.yOuterScale():n.xOuterScale(),r=t.coord().flip()?n.xOuterScale():n.yOuterScale(),a=dv.util.scaleRangeNoReverse(i),s=dv.util.scaleRangeNoReverse(r);e[0]+=(a[0]+a[1])/2,e[1]+=(s[0]+s[1])/2}return e},dv.showTooltip=function(t,e,n,i,r,a){var s=a.selectAll(".dv-tooltip").data([t]);t.cx=t.cx||t.x+t.width/2,t.cy=t.cy||t.y+t.height/2,t.dx=t.dx||t.x+t.width,t.dy=t.dy||t.y+t.height,e.dx=e.dy||e.x+e.width,e.dy=e.dy||e.y+e.height;var o=s.enter().append("div").classed("dv-tooltip",!0).style("top",0).style("left",0);o.append("div").classed("content",!0),o.append("b").classed("notch",!0),s.select(".content").html(n);var l=s.select(".notch"),c=s.node(),u=c.offsetWidth,d=c.offsetHeight,h=0,p=0,f=function(t,e,n){return Math.min(Math.max(e,t),n)};switch(i){case"left":p=t.x-u-r,h=t.cy-d/2,e.x>p&&(p=t.dx+r,i="right"),e.y>h&&(h=e.y),h+d>e.dy&&(h=e.dy-d),l.style("top",f(t.cy-h-5,3,d-13)+"px");break;case"right":p=t.x+t.width+r,h=t.cy-d/2,p+u>e.dx&&(p=t.x-u-r,i="left"),e.y>h&&(h=e.y),h+d>e.dy&&(h=e.dy-d),l.style("top",f(t.cy-h-5,3,d-13)+"px");break;case"top":p=t.cx-u/2,h=t.y-d-r,e.y>h&&(h=t.dy+r,i="bottom"),e.x>p&&(p=e.x),p+u>e.dx&&(p=e.dx-u),l.style("left",f(t.cx-p-5,3,u-13)+"px");break;case"bottom":p=t.cx-u/2,h=t.dy+r,h+d>e.dy&&(h=t.y-d-r,i="top"),e.x>p&&(p=e.x),p+u>e.dx&&(p=e.dx-u),l.style("left",f(t.cx-p-5,3,u-13)+"px");break;default:i=null}h=Math.round(h),p=Math.round(p),s.classed("top right left bottom hide",!1).classed(i,!0),o.style("top",h+"px").style("left",p+"px"),s.style("top",h+"px").style("left",p+"px")},dv.removeTooltip=function(t){t.selectAll(".dv-tooltip").classed("hide",!0)},dv.cancelEvent=function(t){t.stopPropagation(),t.preventDefault()},dv.windowDimensions=function(){var t={width:640,height:480};return document.body&&document.body.offsetWidth&&(t.width=document.body.offsetWidth,t.height=document.body.offsetHeight),"CSS1Compat"==document.compatMode&&document.documentElement&&document.documentElement.offsetWidth&&(t.width=document.documentElement.offsetWidth,t.height=document.documentElement.offsetHeight),window.innerWidth&&window.innerHeight&&(t.width=window.innerWidth,t.height=window.innerHeight),t},dv.addWindowResizeHandler=function(t){window.addEventListener("resize",t)},dv.removeWindowResizeHandler=function(t){window.removeEventListener("resize",t)},dv.scale=dv.extend(function(){function t(t){this._d3Scale=t,this._reverse=!1,this._parse=dv.util.identity,this._includeInDomain=function(){return!0}}return t._mapToD3Scale=function(t){return this._d3Scale(t)},t.trainingProperties=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isArray"])||dv.log.error({msg:"The supplied properties is not an array",data:{range:t}}),this._trainingProperties=t,this):this._trainingProperties?this._trainingProperties:this._property?[this._property]:void 0},t.trainDomain=function(t,e){var n=this.calculateDomain(t,e);return this.domain(n),n},t.parse=function(t){return arguments.length?(this._parse=t,this):this._parse},t.applyRangePadding=function(){},t.validateDomain=function(){},t.mapToProp=function(t){var e=t[this.property()],n=this;return dv.util.isArray(e)?dv.util.map(e,function(t){return n._mapToD3Scale.call(n,t)}):this._mapToD3Scale.call(this,e)},t.mapPropToPercent=function(t){return this.mapValueToPercent(this.mapToProp(t))},t.mapValueToPercent=function(t){var e=dv.util.scaleRange(this),n=e[1]-e[0];return dv.util.isArray(t)?dv.util.map(t,function(t){return n?(t-e[0])/n:0}):n?(t-e[0])/n:0},t.mapValue=function(t){if(dv.util.isArray(t)){var e=this;return dv.util.map(t,function(t){return e._mapToD3Scale.call(e,t)})}return this._mapToD3Scale.call(this,t)},t.invertValue=function(t){return this._d3Scale.invert(t)},t.rangeBand=function(){return 0},t.reverse=function(t){if(!arguments.length)return this._reverse;if(this._reverse!=t){this._reverse=t;var e=this._d3Scale.domain()||[];this._d3Scale.domain(e.reverse())}return this},t.property=function(t){return arguments.length?(this._property=t,this):this._property},t.mapping=function(t){return arguments.length?(this._mapping=t,this):this._mapping},t.domain=function(t){return arguments.length?this._d3Scale?(t=this._reverse?t.reverse():t,this._d3Scale.domain(t),this):this:this._d3Scale.domain()},t.hasSameDomain=function(t){var e=!0,n=this.domain();if(n.length!=t.length)e=!1;else for(var i=0;t.length>i;i++)if(t[i]!=n[i]){e=!1;break}return e},t.range=function(t){return arguments.length?this._d3Scale?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:t}}),this._d3Scale.range(t),this):this:this._d3Scale.range()},t.expand=function(t){return arguments.length?(this._expand=t,this):this._expand},t.limits=function(t){return arguments.length?(this._limits=t,this):this._limits},t.breaks=function(t){return arguments.length?(this._breaks=t,this):this._breaks},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t.includeInDomain=function(t){return arguments.length?(this._includeInDomain=t,this):this._includeInDomain},t.scaleIndex=function(t){return arguments.length?(this._scaleIndex=t,this):this._scaleIndex},t._copy=function(){dv.log.error({msg:"A copy function was not specified for the scale subclass."})},t.copy=t._copy,t.isDefault=function(t){return arguments.length?(this._isDefault=t,this):this._isDefault},t}),dv.scale.constant=dv.scale.extend(function(){function t(){this._super(null)}return t.trainDomain=function(){},t.map=function(){return this._value},t.mapToProp=function(){return this._value},t.value=function(t){return arguments.length?(this._value=t,this):this._value},t._copy=function(){var t=this.trainingProperties();return dv.util.isUndefined(t)||(t=t.slice(0)),dv.scale.constant().isDefault(this.isDefault()).value(this.value()).property(this.property()).trainingProperties(t).scaleIndex(this._scaleIndex)},t.copy=t._copy,t}),dv.scale.continuous=dv.scale.extend(function(){function t(t){this._super(t?t:d3.scale.linear()),this.to=this.range,this._parse=function(t){return null==t?void 0:parseFloat(t)}}return t.calculateDomain=function(t,e){var n,i,r=[],a=this;this.trainingProperties()||this.trainingProperties([this.property()]);var s=this.trainingProperties();e||(e={}),t||(t=[]);for(var o=0;s.length>o;o++)for(var l=s[o],c=0;t.length>c;c++)if(!e.filter||!e.filter.call(this,t[c].key))for(var u=t[c].values,d=0;u.length>d;d++){var h=u[d];if(this._includeInDomain(h,d)){0!==this.scaleIndex()&&(h[this.property()+"-index"]=this.scaleIndex());var p=e.stack?h.y0:h[l];dv.util.isArray(p)||(p=this._parse.call(this,p));var f=dv.util.isArray(p)?d3.min(p):p;if(n=dv.util.isUndefined(n)||n>f?f:n,e.stack){var g=h[l];p+=dv.util.isArray(g)?d3.max(g):a._parse.call(this,g)}var _=dv.util.isArray(p)?d3.max(p):p;i=dv.util.isUndefined(i)||_>i?_:i}}return isNaN(n)&&isNaN(i)?(r=[],this._naturalDomain=[]):(r=[n,i],this._naturalDomain=[n,i]),e.fill&&(r=[0,100]),dv.util.isUndefined(this._upperLimit)||dv.util.isFunction(this._upperLimit)||dv.util.isUndefined(this._lowerLimit)||dv.util.isFunction(this._lowerLimit)?this._reconcileLimits(r):r=this.limits(),r},t.unionDomain=function(t,e){t&&t instanceof dv.scale.continuous||dv.log.error({msg:"The supplied scale is not continuous.",data:{scale:t,isReversed:e}});var n=t.domain(),i=t.naturalDomain(),r=this.domain()?d3.extent(this.domain().concat(n)):d3.extent(n),a=this._naturalDomain?d3.extent(this._naturalDomain.concat(i)):d3.extent(i);return isNaN(r[0])&&isNaN(r[1])&&(r=[]),isNaN(a[0]&&isNaN(a[1]))&&(a=[]),this.reverse(e||this._reverse),this.domain(r),this._naturalDomain=a,this},t.validateDomain=function(){var t=this.domain();t&&t.length||this.domain([0,1])},t.unionRange=function(t){return dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:t}}),this.range(this.range()?d3.extent(this.range().concat(t)):t),this},t.applyRangePadding=function(){var t=this.domain(),e=this.range();if(this._lowerRangePadding){var n=e[0]-e[1],i=Math.min(Math.abs(n)-1,this._lowerRangePadding);t[0]=this.invertValue(n/(Math.abs(n)-i)*i+e[0])}if(this._upperRangePadding){var r=e[1]-e[0],a=Math.min(Math.abs(r)-1,this._upperRangePadding);t[1]=this.invertValue(r/(Math.abs(r)-a)*a+e[1])}return this.domain(t),this},t.upperLimit=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._upperLimit=t:dv.log.error({msg:"Invalid value, cannot set upperLimit with: "+t}),this):this._upperLimit},t.lowerLimit=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._lowerLimit=t:dv.log.error({msg:"Invalid value, cannot set lowerLimit with: "+t}),this):this._lowerLimit},t.limits=function(t){return arguments.length?(t&&2==t.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerLimit(t[0]),this.upperLimit(t[1]),this):[this._lowerLimit,this._upperLimit]},t.naturalDomain=function(){return this._naturalDomain},t.upperRangePadding=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._upperRangePadding=t:dv.log.error({msg:"Invalid value, cannot set upperRangePadding with: "+t}),this):this._upperRangePadding},t.lowerRangePadding=function(t){return arguments.length?(dv.util.isValidValue(t,["isUndefined","isFinite","isDate","isFunction"])?this._lowerRangePadding=t:dv.log.error({msg:"Invalid value, cannot set lowerRangePadding with: "+t}),this):this._lowerRangePadding},t.rangePadding=function(t){return arguments.length?(t&&2==t.length||dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"}),this.lowerRangePadding(t[0]),this.upperRangePadding(t[1]),this):[this._lowerRangePadding,this._upperRangePadding]},t.softLowerLimit=function(t){return arguments.length?(this._softLowerLimit=t,this):this._softLowerLimit},t._reconcileLimits=function(t){t.length&&(dv.util.isUndefined(this._softLowerLimit)||(t[0]=Math.min(t[0],this._softLowerLimit),t[1]=Math.max(t[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(t[0]=dv.util.isFunction(this._lowerLimit)?this._lowerLimit(t[0],t[1]):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(t[1]=dv.util.isFunction(this._upperLimit)?this._upperLimit(t[0],t[1]):this._upperLimit))
},t.labels=function(t){return arguments.length?(this._labels=t,this):this._labels},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.continuous().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).reverse(this.reverse()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.invert=function(t){return this._d3Scale.invert(t[this.mapping()])},t.invertFromProp=function(t){return this._d3Scale.invert(t[this.property()])},t.copy=t._copy,t}),dv.scale.linear=dv.scale.continuous.extend(function(){function t(){this._super(d3.scale.linear())}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.linear().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t}),dv.scale.gradient=dv.scale.continuous.extend(function(){function t(){this._super(d3.scale.linear()),this._innerScale=d3.scale.linear().range([0,1]),this.colors=this.range,this._controlPoints=["0%","50%","100%"],this.colors(["#FA5A50","#E1E1E1","#5FAF69"])}return t._adjustOuterDomain=function(){var t=this;this._d3Scale.domain(dv.util.map(this._controlPoints,function(e){return dv.util.isPercentString(e)?t._innerScale.invert(parseInt(e,10)/100):e}))},t.controlPoints=function(t){return arguments.length?(this._controlPoints=t,this._adjustOuterDomain(),this):this._controlPoints},t.domain=function(t){return arguments.length?this._innerScale?(t=this._reverse?t.reverse():t,this._innerScale.domain(t),this._adjustOuterDomain(),this):this:this._innerScale.domain()},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.gradient().property(this.property()).mapping(this.mapping()).domain(t).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).includeInDomain(this.includeInDomain()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).controlPoints(this.controlPoints()).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t}),dv.scale.time=dv.scale.continuous.extend(function(){function t(){this._super(d3.time.scale()),this._parse=function(t){return t instanceof Date?t:new Date(Date.parse(t))}}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.time().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t._reconcileLimits=function(t,e,n){dv.util.isUndefined(this._softLowerLimit)||(t[0]=Math.min(t[0],this._softLowerLimit),t[1]=Math.max(t[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(t[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(e),new Date(n))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(t[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(e),new Date(n))):this._upperLimit)},t}),dv.scale.time.utc=dv.scale.continuous.extend(function(){function t(){this._super(d3.time.scale.utc()),this._parse=function(t){return t instanceof Date?t:new Date(Date.parse(t))}}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.time.utc().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t._reconcileLimits=function(t,e,n){dv.util.isUndefined(this._softLowerLimit)||(t[0]=Math.min(t[0],this._softLowerLimit),t[1]=Math.max(t[1],this._softLowerLimit)),dv.util.isUndefined(this._lowerLimit)||(t[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(e),new Date(n))):this._lowerLimit),dv.util.isUndefined(this._upperLimit)||(t[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(e),new Date(n))):this._upperLimit)},t}),dv.scale.ordinal=dv.scale.extend(function(){function t(){this._super(d3.scale.ordinal()),this._defaultPadding=.1,this._defaultOuterPadding=0,this._rangeExtent=[],this._rangeBandsSet=!1}return t._mapToD3Scale=function(t){for(var e=this.domain(),n=-1,i=e.length,r=-1;i>++n;){var a=e[n];if(a===t||dv.util.isDate(a)&&a.getTime()===t.getTime()){r=n;break}}return 0>r?void 0:this._d3Scale(t)},t.calculateDomain=function(t,e){var n={},i=[],r=this.trainingProperties();e=e||{};for(var a=0;r.length>a;a++)for(var s=r[a],o=0;t.length>o;o++){var l=t[o].values;if(!e.filter||!e.filter.call(this,t[o].key))for(var c=0;l.length>c;c++){var u=l[c];if(this._includeInDomain(u,c)){0!==this.scaleIndex()&&(u[this.property()+"-index"]=this.scaleIndex());var d=this._parse.call(this,u[s]);dv.util.isUndefined(d)||n.hasOwnProperty(d)||(n[d]=d,i.push(d))}}}return i.length?i:[]},t.unionDomain=function(t,e){t&&t instanceof dv.scale.ordinal||dv.log.error({msg:"The supplied scale is not ordinal.",data:{scale:t,isReversed:e}});var n=t.domain();if(n&&!dv.util.isArray(n))throw Error("The supplied domain is not an array");return n&&(this.reverse(e||this._reverse),this.domain(this.domain()?dv.util.union(this.domain(),n):n)),this},t.unionRange=function(t){if(t&&!dv.util.isArray(t))throw Error("The supplied range is not an array");return t&&this.range(this.range()?dv.util.union(this.range(),t):t),this},t.invertValue=function(t){var e=this.range().indexOf(t),n=this.domain();if(0>e)throw Error("The supplied value does not exist in the specified range.");return n[e%n.length]},t.reverse=function(t){if(!arguments.length)return this._reverse;if(this._reverse!=t){this._reverse=t;var e=this._d3Scale.domain()||[];this._d3Scale.domain(e.reverse())}return this},t.padding=function(t){return arguments.length?(this._padding=t,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this._padding,this.outerPadding()),this):dv.util.isUndefined(this._padding)?this._defaultPadding:this._padding},t.outerPadding=function(t){return arguments.length?(this._outerPadding=t,this._rangeBandsSet&&this._d3Scale.rangeBands(this.rangeExtent(),this.padding(),this._outerPadding),this):dv.util.isUndefined(this._outerPadding)?dv.util.isUndefined(this._padding)?this._defaultOuterPadding:this.padding():this._outerPadding},t.rangeBands=function(t){return arguments.length?(this._rangeBandsSet=!0,this._d3Scale.rangeBands(t,this.padding(),this.outerPadding()),this.rangeExtent(t),this):this._d3Scale.range()},t.rangeBand=function(){return this._d3Scale.rangeBand()},t.range=function(t){return arguments.length?this._d3Scale?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range is not an array",data:{range:t}}),this._d3Scale.range(t),this.rangeExtent([t[0],t[t.length-1]]),this):this:this._d3Scale.range()},t.rangeExtent=function(t){return arguments.length?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied range extent is not an array",data:{range:t}}),this._rangeExtent=t,this):this._rangeExtent},t.values=function(t){return arguments.length?(dv.util.isValidValue(t,["isArray"])||dv.log.error({msg:"The supplied values is not an array",data:{range:t}}),this.range(t)):this._d3Scale.range()},t.drop=function(t){return arguments.length?(this._drop=t,this):this._drop},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)),n},t.copy=t._copy,t}),dv.scale.color=dv.scale.ordinal.extend(function(){function t(){this._super(),this.range(e)}var e=["#8CC350","#5A6EAA","#D755A5","#1EBED7","#F0A01E","#9B8CE6","#3CB5A0","#3287D2","#F0557D","#C3D250","#EB782D","#78B4F5","#5FAF69","#AA5FA5","#FA5A50","#F5C841"];return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).range(this.range()).rangeExtent(this.rangeExtent()).includeInDomain(this.includeInDomain()).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),n},t.copy=t._copy,t}),dv.scale.shape=dv.scale.ordinal.extend(function(){function t(){this._super(),this.range(e)}var e=["circle","cross","diamond","square","triangle-down","triangle-up"];return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),n},t.copy=t._copy,t}),dv.scale.linetype=dv.scale.ordinal.extend(function(){function t(){this._super(),this.range(e)}var e=["solid","dashed","dotted","dotdash","longdash","twodash"];return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(e).scaleIndex(this._scaleIndex);return this._rangeBandsSet&&n.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding),n},t.copy=t._copy,t}),dv.scale.size=dv.scale.continuous.extend(function(){function t(){this._super(),this.to([2,10])}return t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0));var n=dv.scale.size().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex);return n._naturalDomain=this._naturalDomain,n},t.copy=t._copy,t}),dv.scale.identity=dv.scale.ordinal.extend(function(){function t(){this._super(d3.scale.ordinal())}return t.mapToProp=function(t){return t[this.property()]},t.domain=function(t){return arguments.length?this._d3Scale?(t=this._reverse?t.reverse():t,this._d3Scale.domain(t),this._d3Scale.range(t),this):this:this._d3Scale.domain()},t.range=function(){return arguments.length?this:this._d3Scale.range()},t.labels=function(t){return arguments.length?(this._labels=t,this):this._labels},t._copy=function(){var t=this.domain().slice(0),e=this.trainingProperties();return this.reverse()&&t.reverse(),dv.util.isUndefined(e)||(e=e.slice(0)),dv.scale.identity().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(t).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(e).scaleIndex(this._scaleIndex)},t.copy=t._copy,t}),dv.svg=dv.svg||{},dv.svg.text=function(){function t(t){return t.select(function(t,e){return c.call(this,t,e)?this:null}).attr("x",function(t,n){return e.call(this,t,n)}).attr("y",function(t,e){return o.call(this,t,e)}).text(function(t,e){return l.call(this,t,e)})}var e=n,o=i,l=r,c=a,u=s;return t.x=function(n){return arguments.length?(e=n,t):e},t.y=function(e){return arguments.length?(o=e,t):o},t.label=function(e){return arguments.length?(l=e,t):l},t.defined=function(e){return arguments.length?(c=e,t):c},t.duration=function(e){return arguments.length?(u=e,t):u},t},dv.svg.text.radial=function(){function t(t){var n=function(t,n){return e.call(this,t,n)+Z},i=function(t,e){return o.call(this,t,e)};return t.select(function(t,e){return c.call(this,t,e)?this:null}).attr("x",function(t,e){return i(t,e)*Math.cos(n(t,e))}).attr("y",function(t,e){return i(t,e)*Math.sin(n(t,e))}).text(function(t,e){return l.call(this,t,e)})}var e=n,o=i,l=r,c=a,u=s;return t.angle=function(n){return arguments.length?(e=n,t):e},t.radius=function(e){return arguments.length?(o=e,t):o},t.label=function(e){return arguments.length?(l=e,t):l},t.defined=function(e){return arguments.length?(c=e,t):c},t.duration=function(e){return arguments.length?(u=e,t):u},t},dv.svg.rect=function(){function t(t,s){return a.call(this,t,s)?h(e.call(this,t,s),n.call(this,t,s),i.call(this,t,s),r.call(this,t,s)):null}var e=o,n=l,i=c,r=u,a=d;return t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(e){return arguments.length?(n=e,t):n},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(a=e,t):a},t},dv.svg.symbol=function(){function t(t,s){return a.call(this,t,s)?(W[e.call(this,t,s)]||W.circle)(n.call(this,t,s),i.call(this,t,s),r.call(this,t,s)):null}var e=f,n=p,i=g,r=_,a=m;return t.x=function(e){return arguments.length?(i=e,t):i},t.y=function(e){return arguments.length?(r=e,t):r},t.type=function(n){return arguments.length?(e=d3.functor(n),t):e},t.size=function(e){return arguments.length?(n=d3.functor(e),t):n},t.defined=function(e){return arguments.length?(a=e,t):a},t},dv.svg.symbol.radial=function(){function t(t,s){if(a.call(this,t,s)){var o=i.call(this,t,s)+Z,l=r.call(this,t,s),c=l*Math.cos(o),u=l*Math.sin(o);return(W[e.call(this,t,s)]||W.circle)(n.call(this,t,s),c,u)}return null}var e=f,n=p,i=g,r=_,a=m;return t.angle=function(e){return arguments.length?(i=e,t):i},t.radius=function(e){return arguments.length?(r=e,t):r},t.type=function(n){return arguments.length?(e=d3.functor(n),t):e},t.size=function(e){return arguments.length?(n=d3.functor(e),t):n},t.defined=function(e){return arguments.length?(a=e,t):a},t},d3.svg.symbolTypes=d3.keys(W);var W={circle:function(t,e,n){var i=Math.sqrt(t/Math.PI);return"M"+e+","+(n+i)+"A"+i+","+i+" 0 1,1 "+e+","+(n-i)+"A"+i+","+i+" 0 1,1 "+e+","+(n+i)+"Z"},cross:function(t,e,n){var i=Math.sqrt(t/5)/2;return"M"+(e+-3*i)+","+(n-i)+"H"+(e-i)+"V"+(n+-3*i)+"H"+(e+i)+"V"+(n-i)+"H"+(e+3*i)+"V"+(n+i)+"H"+(e+i)+"V"+(n+3*i)+"H"+(e-i)+"V"+(n+i)+"H"+(e-3*i)+"Z"},diamond:function(t,e,n){var i=Math.sqrt(t/(2*X)),r=i*X;return"M"+e+","+(n-i)+"L"+(e+r)+","+n+" "+e+","+(n+i)+" "+(e-r)+","+n+"Z"},square:function(t,e,n){var i=Math.sqrt(t)/2;return"M"+(e-i)+","+(n-i)+"L"+(e+i)+","+(n-i)+" "+(e+i)+","+(n+i)+" "+(e-i)+","+(n+i)+"Z"},"triangle-down":function(t,e,n){var i=Math.sqrt(t/U),r=i*U/2;return"M"+e+","+(n+r)+"L"+(e+i)+","+(n-r)+" "+(e-i)+","+(n-r)+"Z"},"triangle-up":function(t,e,n){var i=Math.sqrt(t/U),r=i*U/2;return"M"+e+","+(n-r)+"L"+(e+i)+","+(n+r)+" "+(e-i)+","+(n+r)+"Z"}};dv.svg.errorBar=function(){function t(t,o){return s.call(this,t,o)?P(e.call(this,t,o),n.call(this,t,o),i.call(this,t,o),r.call(this,t,o),a.call(this,t,o)):null}var e=v,n=b,i=A,r=k,a=S,s=M;return t.x0=function(n){return arguments.length?(e=n,t):e},t.x1=function(e){return arguments.length?(n=e,t):n},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(r=e,t):r},t.flip=function(e){return arguments.length?(a=e,t):a},t.defined=function(e){return arguments.length?(s=e,t):s},t};var U=Math.sqrt(3),X=Math.tan(30*Math.PI/180),Z=-Math.PI/2;dv.svg.poly=function(){function t(t,r){return e.call(this,t,r)?z(n.call(this,t,r),i.call(this,t,r)):null}var e=w,n=O,i=T;return t.xs=function(e){return arguments.length?(n=e,t):n},t.ys=function(e){return arguments.length?(i=e,t):i},t.defined=function(t){return arguments.length?e=t:e},t},dv.svg.poly.radial=function(){function t(t,r){if(e.call(this,t,r)){for(var a=n.call(this,t,r),s=i.call(this,t,r),o=d3.max([a.length,s.length]),l="M",c=0;o>c;c++){c>0&&(l+="L");var u=a[c]+Z,d=s[c],h=d*Math.cos(u),p=d*Math.sin(u);l+=a.length>c?h:"0",l+=",",l+=s.length>c?p:"0"}return l+="Z"}return null}var e=w,n=O,i=T;return t.angles=function(e){return arguments.length?(n=e,t):n},t.radii=function(e){return arguments.length?(i=e,t):i},t.defined=function(t){return arguments.length?e=t:e},t},dv.util={},dv.util.filterAndZip=function(t,e,n){var i=[],r=[];if(e)i=t[e];else for(var a in t){i=t[a];break}for(var s=-1,o=i.length;o>++s;){var l=i[s];if(!n||l==n){var c={};for(var u in t)if("data"===u){c[u]={};for(var d in t[u])c[u][d]=t[u][d][s]}else c[u]=t[u][s];r.push(c)}}return r},dv.util.binaryCompare=function(t,e,n,i,r){var a=i;for(4>arguments.length&&(a=0),5>arguments.length&&(r=t.length);r>a;){var s=a+r>>1;n(t[s])>e?r=s:a=s+1}return a==i||Math.abs(n(t[a])-e)<Math.abs(n(t[a-1])-e)?a:a-1},dv.util.uniqueValues=function(t,e){var n=[];return dv.util.each(t,function(i){for(var r=-1,a=n.length,s=!1;a>++r;){var o=n[r];if(e(i,o)){s=!0;break}}s||n.push(t[r])}),n},dv.util.scaleRange=function(t,e){return 1===arguments.length?t.rangeExtent?t.rangeExtent():t.range():(t.rangeExtent?t.rangeBands(e):t.range(e),t)},dv.util.minRangeDistance=function(t,e){var n,i,r=Number.MAX_VALUE;return dv.util.each(e,function(e){dv.util.each(e.values,function(e){n=e.panel.xScale(e).mapValue(e[t]),dv.util.isUndefined(i)||(r=Math.min(r,Math.abs(n-i))),i=n})}),r},dv.util.scaleRangeNoReverse=function(t){return t.rangeExtent?t.rangeExtent():dv.util.scaleExtent(t.range())},dv.util.scaleExtent=function(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]},dv.util.merge=function(t,e){var n,i={};for(n in t)i[n]=t[n];for(n in e)i[n]=e[n];return i},dv.util.getPercentValue=function(t,e){return dv.util.isPercentString(t)?e*parseInt(t,10)/100:t},dv.util.isPercentString=function(t){return"string"==typeof t&&/^(-?[0-9]+)%$/.test(t)},dv.util.isValidValue=function(t,e){for(var n=0;e.length>n;n++)if(dv.util[e[n]](t))return!0;return!1},dv.util.identity=function(t){return t},dv.util.clamp=function(t,e,n){return Math.min(Math.max(t,e),n)},dv.util.clone=function(t){return dv.util.isObject(t)?dv.util.isArray(t)?t.slice():dv.util.extend({},t):t},dv.util.isArray=function(t){return Array.isArray?Array.isArray(t):"[object Array]"==Object.prototype.toString.call(t)},dv.util.isObject=function(t){return t===Object(t)},dv.util.isFunction=function(t){return"[object Function]"==Object.prototype.toString.call(t)},dv.util.isUndefined=function(t){return void 0===t},dv.util.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},dv.util.isDate=function(t){return t instanceof Date},dv.util.isEmpty=function(t){return 0===Object.keys(t).length},dv.util.extend=function(t){return dv.util.each(Array.prototype.slice.call(arguments,1),function(e){for(var n in e)t[n]=e[n]}),t},dv.util.each=function(t,e,n){if(null!=t)if(Array.prototype.forEach&&t.forEach===Array.prototype.forEach)t.forEach(e,n);else if(t.length===+t.length){for(var i=0,r=t.length;r>i;i++)if(e.call(n,t[i],i,t)==={})return}else for(var a in t)if(dv.util.has(t,a)&&e.call(n,t[a],a,t)==={})return},dv.util.has=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},dv.util.uniq=function(t,e,n,i){dv.util.isFunction(e)&&(i=n,n=e,e=!1);var r=n?dv.util.map(t,n,i):t,a=[],s=[];return dv.util.each(r,function(n,i){(e?i&&s[s.length-1]===n:dv.util.contains(s,n))||(s.push(n),a.push(t[i]))}),a},dv.util.union=function(){return dv.util.uniq(Array.prototype.concat.apply(Array.prototype,arguments))},dv.util.contains=function(t,e){return null==t?!1:Array.prototype.indexOf&&t.indexOf===Array.prototype.indexOf?-1!=t.indexOf(e):dv.util.any(t,function(t){return t===e})},dv.util.any=function(t,e,n){e||(e=dv.util.identity);var i=!1;return null==t?i:Array.prototype.some&&t.some===Array.prototype.some?t.some(e,n):(dv.util.each(t,function(t,r,a){return i||(i=e.call(n,t,r,a))?{}:void 0}),void 0)},dv.util.sortBy=function(t,e,n){var i=function(t){return dv.util.isFunction(t)?t:function(e){return e[t]}},r=i(e);return dv.util.pluck(dv.util.map(t,function(t,e,i){return{value:t,index:e,criteria:r.call(n,t,e,i)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index<e.index?-1:1}),"value")},dv.util.pluck=function(t,e){return dv.util.map(t,function(t){return t[e]})},dv.util.map=function(t,e,n){var i=[];return null===t?i:Array.prototype.map&&t.map===Array.prototype.map?t.map(e,n):(dv.util.each(t,function(t,r,a){i[i.length]=e.call(n,t,r,a)}),i)},dv.util.reduce=function(t,e,n,i){var r=arguments.length>2;if(null===t&&(t=[]),Array.prototype.reduce&&t.reduce===Array.prototype.reduce)return i&&(e=dv.util.bind(e,i)),r?t.reduce(e,n):t.reduce(e);if(dv.util.each(t,function(t,a,s){r?n=e.call(i,n,t,a,s):(n=t,r=!0)}),!r)throw new TypeError("Reduce of empty array with no initial value");return n},dv.util.bind=function(t,e){if(t.bind===Function.prototype.bind&&Function.prototype.bind)return Function.prototype.bind.apply(t,Array.prototype.slice.call(arguments,1));var n=Array.prototype.slice.call(arguments,2);return function(){return t.apply(e,n.concat(Array.prototype.slice.call(arguments)))}},dv.util.noop=function(){},dv.util.each(["Arguments","String","Number","RegExp"],function(t){dv.util["is"+t]=function(e){return toString.call(e)=="[object "+t+"]"}}),dv.util.validateParam=function(t,e,n,i){if("isString"===e)return dv.util.isString(t)&&dv.util.isArray(n)&&-1!==n.indexOf(t.toLowerCase())?t.toLowerCase():i;if("isNumber"===e)return dv.util.isNumber(t)&&dv.util.isArray(n)&&n[1]>=t&&t>=n[0]?t:i;if("isFunction"===e)return dv.util.isFunction(t)?t:i;if("isDimension"===e)return"x"===t||"X"===t?"x":"y"===t||"Y"===t?"y":t===["x","y"]||t===["X","y"]||t===["x","Y"]||t===["X","Y"]?["x","y"]:i;if("isRange"===e){var r=n[0],a=n[1];return dv.util.isArray(t)&&2===t.length?(dv.util.isNumber(t[0])&&dv.util.isNumber(t[1])&&(r=Math.max(Math.min(t[0],t[1]),n[0]),a=Math.min(Math.max(t[0],t[1]),n[1])),[r,a]):i}},dv.util=dv.util||{},dv.util.svg={},dv.util.svg.getDasharray=function(t){if(-1!=t.indexOf(",")||-1!=t.indexOf(" "))return t;if(J.hasOwnProperty(t))return J[t];throw Error("The dashed line format is invalid")};var J={solid:"",dashed:"7,4",dotted:"2,3",dotdash:"2,3,7,4",longdash:"11,4",twodash:"5,2,11,2"};dv.container=dv.extend(function(){function t(){this._aes={}}var e={x:dv.scale.linear,y:dv.scale.linear,yMin:dv.scale.linear,yMax:dv.scale.linear,xMin:dv.scale.linear,xMax:dv.scale.linear,color:dv.scale.color,fill:dv.scale.color,stroke:dv.scale.color,alpha:dv.scale.linear,shape:dv.scale.shape,size:dv.scale.size,radius:dv.scale.linear,group:dv.scale.ordinal,linetype:dv.scale.linetype,label:dv.scale.identity};return t.render=function(){throw Error("render() must be implemented in a subclass")},t._calculateStats=function(){throw Error("_calculateStats() must be implemented in a subclass")},t._handlePositions=function(){throw Error("_handlePositions() must be implemented in a subclass")},t.getTrainedScale=function(){throw Error("getTrainedScale() must be implemented in a subclass")},t.getExplicitScalesMap=function(){return this._aes},t._normalizeData=function(t){if(t.hasOwnProperty("data")&&!dv.util.isArray(t.data))return t;var e,n={},i=this.getExplicitScalesMap();return dv.util.each(i,function(i){for(var r in i)if(e=i[r],!(e instanceof dv.scale.constant)){var a=t[e.mapping()];if(dv.util.isArray(a)){var s=a.map(function(t){return dv.util.isArray(t)?t.map(function(t){return e._parse(t)}):e._parse(t)});n[e.property()]=s}}}),n.data=t,n},t.map=function(t,n,i,r){if(i||(i=e[t]().copy().isDefault(!0)),!i)throw Error("There is no default scale associated with this property. Either the property isn't valid or the scale default doesn't exist.");return 4>arguments.length&&(r=0),this._aes[t]||(this._aes[t]={}),this._aes[t][r]=i.property(t).mapping(n).scaleIndex(r),this},t.set=function(t,e){this._aes[t]||(this._aes[t]={});var n=this._aes[t][0]=dv.scale.constant();return dv.util.isFunction(e)?n.map=n.mapToProp=e:n.value(e),this},t.on=function(t,e,n){3>arguments.length&&(n=!1);var i=e&&dv.util.isFunction(e);return i?(this.eventMap=this.eventMap||{},this.eventMap[t]={callback:e,capture:n}):(this.eventMap&&delete this.eventMap[t],this.unregisterEventMap=this.unregisterEventMap||{},this.unregisterEventMap[t]=n),this._removeRegisteredEvents(),this._addRegisteredEvents(),this},t.position=function(t){return arguments.length?(this._position=t,this):this._chart&&!this._position?this._chart.position():this._position},t.delay=function(t){return arguments.length?(this._delay=d3.functor(t),this):this._chart&&dv.util.isUndefined(this._delay)?this._chart.delay():this._delay},t.duration=function(t){return arguments.length?(this._duration=d3.functor(t),this):this._chart&&dv.util.isUndefined(this._duration)?this._chart.duration():this._duration},t.ease=function(t){return arguments.length?(this._ease=t,this):this._chart&&dv.util.isUndefined(this._ease)?this._chart.ease():this._ease},t}),dv.coord=dv.extend(function(){function t(){this._flip=!1}return t.flip=function(t){return arguments.length?(this._flip=t,this):this._flip},t.startX=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startX/startAngle must be a number or percent string",data:{val:t}}),this._startX=t,this):this._startX},t.endX=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endX/endAngle must be a number or percent string",data:{val:t}}),this._endX=t,this):this._endX},t.startY=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, startY/innerRadius must be a number or percent string",data:{val:t}}),this._startY=t,this):this._startY},t.endY=function(t){return arguments.length?(dv.util.isValidValue(t,["isFinite","isPercentString"])||dv.log.error({msg:"Invalid value type, endY/outerRadius must be a number or percent string",data:{val:t}}),this._endY=t,this):this._endY},t}),dv.coord.cartesian=dv.coord.extend(function(){function t(){this._super(),this.startX(0),this.endX(0),this.startY(0),this.endY(0),this._type="cartesian"}return t._translatePercentToX=function(t,e){var n=dv.util.scaleRange(t),i=this._translatePercent(e,n,this.startX(),this.endX()),r=3*Math.abs(n[1]-n[0]);return dv.util.clamp(i,n[0]-r,n[1]+r)},t._translatePercentToY=function(t,e){var n=dv.util.scaleRange(t),i=this._translatePercent(e,n,this.startY(),this.endY()),r=3*Math.abs(n[1]-n[0]);return dv.util.clamp(i,n[1]-r,n[0]+r)},t._translatePercent=function(t,e,n,i){return(e[1]-e[0]-i-n)*t+n+e[0]},t._translatePercentArrToY=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToY(t,e)})},t._translatePercentArrToX=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToX(t,e)})},t._text=function(){function t(){var n=dv.svg.text();return e._flip?n.x(function(n,i){return e._translatePercentToY(n.panel.yOuterScale(),t.y()(n,i))}).y(function(n,i){return e._translatePercentToX(n.panel.xOuterScale(),t.x()(n,i))}):n.x(function(n,i){return e._translatePercentToX(n.panel.xOuterScale(),t.x()(n,i))}).y(function(n,i){return e._translatePercentToY(n.panel.yOuterScale(),t.y()(n,i))})}var e=this;return t.x=function(t){return arguments.length?(this._x=t,this):this._x},t.y=function(t){return arguments.length?(this._y=t,this):this._y},t},t._point=function(){var t=this,e={};return e.renderer=dv.svg.symbol().x(function(t){return t.bounds.x}).y(function(t){return t.bounds.y}),e.getBounds=function(n,i){return n.hasOwnProperty("y")||(n.y=0),n.hasOwnProperty("x")||(n.x=0),e._defined(n,i)?(n.bounds=t._flip?{x:t._translatePercentToY(n.panel.yOuterScale(),e.y()(n,i)),y:t._translatePercentToX(n.panel.xOuterScale(),e.x()(n,i))}:{x:t._translatePercentToX(n.panel.xOuterScale(),e.x()(n,i)),y:t._translatePercentToY(n.panel.yOuterScale(),e.y()(n,i))},n):null},e.getPath=function(t){return null===t||void 0===t.bounds?null:e.renderer(t)},e.x=function(t){return arguments.length?(this._x=t,e):this._x},e.y=function(t){return arguments.length?(this._y=t,e):this._y},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._line=function(){var t=this,e={};return e.renderer=d3.svg.line().x(function(t){return t.bounds.x}).y(function(t){return t.bounds.y}),e.getBounds=function(n){var i=[];return dv.util.each(n,function(r,a){r.hasOwnProperty("y")||(r.y=0),r.hasOwnProperty("x")||(r.x=0),e._defined(r,a)&&(r.bounds=t._flip?{x:t._translatePercentToY(r.panel.yOuterScale(),e.y()(r,a)),y:t._translatePercentToX(r.panel.xOuterScale(),e.x()(r,a))}:{x:t._translatePercentToX(r.panel.xOuterScale(),e.x()(r,a)),y:t._translatePercentToY(r.panel.yOuterScale(),e.y()(r,a))},i.push(n[a]))}),i},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.x must be a function",data:{val:t}}),this._x=t,this):this._x},e.y=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.y must be a function",data:{val:t}}),this._y=t,this):this._y},e.defined=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:t}}),this._defined=t,this):this._defined},e},t._area=function(){var t=this,e={};return e.renderer=d3.svg.area(),e.getBounds=function(n){var i=[];return e.setupRenderer(),dv.util.each(n,function(n,r){if(n.hasOwnProperty("y")||(n.y=0),n.hasOwnProperty("x")||(n.x=0),e._defined(n,r)){var a=dv.util.clone(n);
a.bounds={x:t._translatePercentToX(n.panel.xOuterScale(),e.x()(n,r)),y0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(n,r)),y1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(n,r))},i.push(a)}}),i},e.getPath=function(t){return e.setupRenderer(),null===t?null:e.renderer(t)},e.setupRenderer=function(){t._flip?e.renderer.x(null).y0(null).y1(null).y(function(t){return t.bounds.x}).x0(function(t){return t.bounds.y0}).x1(function(t){return t.bounds.y1}):e.renderer.y(null).x0(null).x1(null).x(function(t){return t.bounds.x}).y0(function(t){return t.bounds.y0}).y1(function(t){return t.bounds.y1})},e.x=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.x must be a function",data:{val:t}}),this._x=t,this):this._x},e.y0=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.y0 must be a function",data:{val:t}}),this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.y1 must be a function",data:{val:t}}),this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, area.defined must be a function",data:{val:t}}),this._defined=t,this):this._defined},e},t._rect=function(){var t=this,e={};return e.renderer=dv.svg.rect().x0(function(t){return t.bounds.x0}).x1(function(t){return t.bounds.x1}).y0(function(t){return t.bounds.y0}).y1(function(t){return t.bounds.y1}),e.getBounds=function(n,i){var r=dv.util.clone(n),a=r[n.panel.xScale(n).property()];dv.util.isArray(a)&&(r.x0=a[0],r.x1=a[1]);var s=r[n.panel.yScale(n).property()];return dv.util.isArray(s)&&(r.y0=s[0],r.y1=s[1]),e._defined(r,i)?(r.bounds=t._flip?{x0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),x1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i)),y0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),y1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i))}:{x0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),x1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i)),y0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),y1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i))},r):null},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x0=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.x0 must be a function",data:{val:t}}),this._x0=t,this):this._x0},e.x1=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.x1 must be a function",data:{val:t}}),this._x1=t,this):this._x1},e.y0=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.y0 must be a function",data:{val:t}}),this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.y1 must be a function",data:{val:t}}),this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(dv.util.isValidValue(t,["isFunction"])||dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:t}}),this._defined=t,this):this._defined},e},t._errorBar=function(){var t=this,e={};return e.renderer=dv.svg.errorBar().x0(function(t){return t.bounds.x0}).x1(function(t){return t.bounds.x1}).y0(function(t){return t.bounds.y0}).y1(function(t){return t.bounds.y1}).flip(function(){return t._flip}),e.getBounds=function(n,i){var r=dv.util.clone(n);return e._defined(r,i)?(r.bounds=t._flip?{x0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),x1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i)),y0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),y1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i))}:{x0:t._translatePercentToX(n.panel.xOuterScale(),e.x0()(r,i)),x1:t._translatePercentToX(n.panel.xOuterScale(),e.x1()(r,i)),y0:t._translatePercentToY(n.panel.yOuterScale(),e.y0()(r,i)),y1:t._translatePercentToY(n.panel.yOuterScale(),e.y1()(r,i))},r):null},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x0=function(t){return arguments.length?(this._x0=t,this):this._x0},e.x1=function(t){return arguments.length?(this._x1=t,this):this._x1},e.y0=function(t){return arguments.length?(this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._poly=function(){var t=this,e={};return e.renderer=dv.svg.poly().xs(function(t){return t.bounds.x}).ys(function(t){return t.bounds.y}),e.getBounds=function(n,i){var r=dv.util.clone(n);return e._defined(n,i)&&(r.bounds=t._flip?{x:t._translatePercentArrToY(n.panel.yOuterScale(),e.ys()(n,i)),y:t._translatePercentArrToX(n.panel.xOuterScale(),e.xs()(n,i))}:{x:t._translatePercentArrToX(n.panel.xOuterScale(),e.xs()(n,i)),y:t._translatePercentArrToY(n.panel.yOuterScale(),e.ys()(n,i))}),r},e.getPath=function(t){return null===t?null:e.renderer(t)},e.xs=function(t){return arguments.length?(this._xs=t,this):this._xs},e.ys=function(t){return arguments.length?(this._ys=t,this):this._ys},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t}),dv.coord.polar=dv.coord.extend(function(){function t(){this._super(),this.innerRadius=this.startY,this.outerRadius=this.endY,this.startAngle=this.startX,this.endAngle=this.endX,this.innerRadius(0),this.outerRadius(0),this.startAngle(0),this.endAngle(360),this._type="polar"}return t._transformAngleRadiusToXY=function(t,e){return t+=-1.570796327,[e*Math.cos(t),e*Math.sin(t)]},t._translatePercentToRadius=function(t,e){var n=Math.abs(t[1]-t[0])/2,i=dv.util.getPercentValue(this.innerRadius(),n),r=dv.util.getPercentValue(this.outerRadius(),n);return(n-r-i)*e+i},t._translatePercentToTheta=function(t,e){var n=360,i=dv.util.getPercentValue(this.startAngle(),n),r=dv.util.getPercentValue(this.endAngle(),n),a=(r-i)*e+i;return.017453293*a},t._translatePercentArrToRadius=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToRadius(t,e)})},t._translatePercentArrToTheta=function(t,e){var n=this;return dv.util.map(e,function(e){return n._translatePercentToTheta(t,e)})},t._getRadiusRange=function(t,e){var n=dv.util.scaleRange(t),i=dv.util.scaleRange(e);return[0,Math.min(Math.abs(n[1]-n[0]),Math.abs(i[1]-i[0]))]},t._text=function(){function t(){var n=dv.svg.text.radial();return e._flip?n.angle(function(n,i){return e._translatePercentToTheta(n.panel.yOuterScale(),t.y()(n,i))}).radius(function(n,i){return e._translatePercentToRadius(e._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale()),t.x()(n,i))}):n.angle(function(n,i){return e._translatePercentToTheta(n.panel.xOuterScale(),t.x()(n,i))}).radius(function(n,i){return e._translatePercentToRadius(e._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale()),t.y()(n,i))})}var e=this;return t.x=function(t){return arguments.length?(this._x=t,this):this._x},t.y=function(t){return arguments.length?(this._y=t,this):this._y},t},t._point=function(){var t=this,e={};return e.renderer=dv.svg.symbol.radial().angle(function(t){return t.bounds.x}).radius(function(t){return t.bounds.y}),e.getBounds=function(n,i){if(n.hasOwnProperty("y")||(n.y=0),n.hasOwnProperty("x")||(n.x=0),e._defined(n,i)){var r=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());n.bounds=t._flip?{x:t._translatePercentToTheta(n.panel.xOuterScale(),e.y()(n,i)),y:t._translatePercentToRadius(r,e.x()(n,i))}:{x:t._translatePercentToTheta(n.panel.xOuterScale(),e.x()(n,i)),y:t._translatePercentToRadius(r,e.y()(n,i))}}return n},e.getPath=function(t){return null===t||dv.util.isUndefined(t.bounds)?null:e.renderer(t)},e.x=function(t){return arguments.length?(this._x=t,this):this._x},e.y=function(t){return arguments.length?(this._y=t,this):this._y},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._line=function(){var t=this,e={};return e.renderer=d3.svg.line.radial().angle(function(t){return t.bounds.x}).radius(function(t){return t.bounds.y}),e.getBounds=function(n){var i=[];return dv.util.each(n,function(r,a){var s=t._getRadiusRange(r.panel.xOuterScale(),r.panel.yOuterScale());r.hasOwnProperty("y")||(r.y=0),r.hasOwnProperty("x")||(r.x=0),e._defined(r,a)&&(r.bounds=t._flip?{x:t._translatePercentToTheta(r.panel.xOuterScale(),e.y()(r,a)),y:t._translatePercentToRadius(s,e.x()(r,a))}:{x:t._translatePercentToTheta(r.panel.xOuterScale(),e.x()(r,a)),y:t._translatePercentToRadius(s,e.y()(r,a))},i.push(n[a]))}),i},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x=function(t){return arguments.length?(this._x=t,this):this._x},e.y=function(t){return arguments.length?(this._y=t,this):this._y},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._area=function(){var t=this,e={};return e.renderer=d3.svg.area.radial(),e.getBounds=function(n){var i=[];return e.setupRenderer(),dv.util.each(n,function(n,r){var a=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());if(n.hasOwnProperty("y")||(n.y=0),n.hasOwnProperty("x")||(n.x=0),e._defined(n,r)){var s=dv.util.clone(n);s.bounds=t._flip?{x:t._translatePercentToRadius(a,e.x()(n,r)),y0:t._translatePercentToTheta(n.panel.xOuterScale(),e.y0()(n,r)),y1:t._translatePercentToTheta(n.panel.xOuterScale(),e.y1()(n,r))}:{x:t._translatePercentToTheta(n.panel.xOuterScale(),e.x()(n,r)),y0:t._translatePercentToRadius(a,e.y0()(n,r)),y1:t._translatePercentToRadius(a,e.y1()(n,r))},i.push(s)}}),i},e.getPath=function(t){return e.setupRenderer(),null===t?null:e.renderer(t)},e.setupRenderer=function(){t._flip?e.renderer.angle(null).innerRadius(null).outerRadius(null).radius(function(t){return t.bounds.x}).startAngle(function(t){return t.bounds.y0}).endAngle(function(t){return t.bounds.y1}):e.renderer.radius(null).startAngle(null).endAngle(null).angle(function(t){return t.bounds.x}).innerRadius(function(t){return t.bounds.y0}).outerRadius(function(t){return t.bounds.y1})},e.x=function(t){return arguments.length?(this._x=t,this):this._x},e.y0=function(t){return arguments.length?(this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._rect=function(){var t=this,e={};return e.renderer=d3.svg.arc().startAngle(function(t){return t.bounds.x0}).endAngle(function(t){return t.bounds.x1}).innerRadius(function(t){return t.bounds.y0}).outerRadius(function(t){return t.bounds.y1}),e.getBounds=function(n,i){var r=dv.util.clone(n);if(!e._defined(r,i))return null;var a=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());return r.bounds=t._flip?{x0:t._translatePercentToTheta(n.panel.yOuterScale(),e.y0()(r,i)),x1:t._translatePercentToTheta(n.panel.yOuterScale(),e.y1()(r,i)),y0:t._translatePercentToRadius(a,e.x0()(r,i)),y1:t._translatePercentToRadius(a,e.x1()(r,i))}:{x0:t._translatePercentToTheta(n.panel.xOuterScale(),e.x0()(r,i)),x1:t._translatePercentToTheta(n.panel.xOuterScale(),e.x1()(r,i)),y0:t._translatePercentToRadius(a,e.y0()(r,i)),y1:t._translatePercentToRadius(a,e.y1()(r,i))},r},e.getPath=function(t){return null===t?null:e.renderer(t)},e.x0=function(t){return arguments.length?(this._x0=t,this):this._x0},e.x1=function(t){return arguments.length?(this._x1=t,this):this._x1},e.y0=function(t){return arguments.length?(this._y0=t,this):this._y0},e.y1=function(t){return arguments.length?(this._y1=t,this):this._y1},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t._poly=function(){var t=this,e={};return e.renderer=dv.svg.poly.radial().angles(function(t){return t.bounds.x}).radii(function(t){return t.bounds.y}),e.getBounds=function(n,i){var r=dv.util.clone(n);if(e._defined(n,i)){var a=t._getRadiusRange(n.panel.xOuterScale(),n.panel.yOuterScale());r.bounds=t._flip?{x:t._translatePercentArrToTheta(n.panel.xOuterScale(),e.ys()(n,i)),y:t._translatePercentArrToRadius(a,e.xs()(n,i))}:{x:t._translatePercentArrToTheta(n.panel.xOuterScale(),e.xs()(n,i)),y:t._translatePercentArrToRadius(a,e.ys()(n,i))}}return r},e.getPath=function(t){return null===t?null:e.renderer(t)},e.xs=function(t){return arguments.length?(this._xs=t,this):this._xs},e.ys=function(t){return arguments.length?(this._ys=t,this):this._ys},e.defined=function(t){return arguments.length?(this._defined=t,this):this._defined},e},t}),dv.guide=dv.extend(function(){function t(){this._renderer=null}return t._render=function(){dv.log.warn({msg:"dv.guide._render should not be called directly, try using dv.guide.legend.render or dv.guide.axis.render"})},t._scale=function(t){return arguments.length?(this.__scale=t,this):this.__scale},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t._parent=function(t){return arguments.length?(this.__parent=t,this):this.__parent},t.scaleIndex=function(t){return arguments.length?(this._scaleIndex=t,this):this._scaleIndex},t.title=function(t){return arguments.length?(this._title=t,this):this._title},t}),dv.guide.axes=dv.extend(function(){function t(){this._axes={},this._emptyTickFormat=function(){return""}}return t._initializeAxisRenderers=function(){this._eachAxis(function(t,e,n){if(n.hasOwnProperty("_orientation")||"x"!==t||(n._orientation="bottom"),n.hasOwnProperty("_orientation")||"y"!==t||(n._orientation="left"),this._chart._coord.flip())switch(n._orientation){case"top":n._orientation="right";break;case"right":n._orientation="top";break;case"bottom":n._orientation="left";break;case"left":n._orientation="bottom"}})},t._measure=function(t){var e=this._chart._g.select(".panels"),n=this._chart._axisLabelContainer;return this._eachAxis(function(i,r,a){var s=this._changeScaleRangeToLocal(t.getOuterScale(i));this._chart._coord instanceof dv.coord.polar||"none"===a||(a._chart(this._chart)._scale(s[r])._parent(e)._labelParent(n),t.margins(a._measure(t.margins(),t.bounds(),t)))}),this},t._getAllOrientations=function(){var t={};return this._eachAxis(function(e,n,i){t[i._orientation]=e}),t},t._render=function(t,e,n){return this._eachAxis(function(i,r,a){var s=this._changeScaleRangeToLocal(n.getOuterScale(i));this._chart._coord instanceof dv.coord.polar||"none"===a?(t.selectAll(".axis-"+i+".axis-index-"+r).transition().duration(this._chart._duration).style("opacity",0).remove(),this._chart._chartContainer.select(".axes-labels .axis-"+i+".axis-index-"+r).transition().duration(this._chart._duration).style("opacity",0).remove()):a._chart(this._chart)._parent(t)._scale(s[r])._labelParent(e)._render(t,n,n.bounds())}),this},t._measureTitles=function(t){var e=this._chart._axisLabelContainer;return this._eachAxis(function(n,i,r){if("none"!==r){var a=r._chart(this._chart)._measureAxisTitle(e,n,i,t);t.left+=a.left,t.top+=a.top,t.right-=a.right,t.bottom-=a.bottom}}),t},t._renderTitles=function(t,e){var n=this._chart._axisLabelContainer;this._eachAxis(function(i,r,a){"none"!==a&&a.title()?a._chart(this._chart)._renderAxisTitle(n,e,i,r,t):n.selectAll(".axis-title-"+i+".axis-title-index-"+r).transition().duration(this._chart._duration).style("opacity",0).remove()})},t._changeScaleRangeToLocal=function(t){var e=t.range(),n=t.innerScaleGroup();for(var i in n)dv.util.scaleRange(n[i],[e[0],e[1]]);return n},t._eachAxis=function(t){for(var e in this._axes){var n=this._axes[e];for(var i in n)t.call(this,e,+i,n[i])}},t._add=function(t,e,n){n=void 0===n?0:n;var i=this._axes[t];return i||(this._axes[t]=i={}),i[n]=e,this},t._axes=function(t){return arguments.length?(this._axes=t,this):this._axes},t._get=function(t){return this._axes[t]},t._empty=function(){for(var t in this._axes)delete this._axes[t];return this._axes={},this},t._chart=function(t){return arguments.length?(this._chart=t,this):this._chart},t}),dv.guide.axis=dv.guide.extend(function(){function t(){this._ticks=d3.functor(5),this._tickInterval=void 0,this._labelGroup=null,this._htmlLabels=!1}function e(t){return t+"%"}return t._measure=function(t,e,n){var i,r=this._getAxisOffset(e),a=dv.util.scaleRange(this._scale()),s=this._ticks.call(this,Math.abs(a[1]-a[0])),o=this,l=this._parent().append("g").classed("temp-axis",!0);this._shouldDrawAxisLabels(n)&&(i=this._constructLabelGroup(this.__labelParent,r,!0));var c=this._constructD3Axis(i,e,s,n),u=this._measureAxis(l,r,c),d={left:u.x+r[0],top:u.y+r[1],right:u.x+u.width+r[0],bottom:u.y+u.height+r[1]};i&&i.selectAll("span").each(function(){var t=this,e=d3.select(this),n=o._htmlLabels?e.html():e.text();if(n){var i="right"===o._orientation?t.offsetWidth/2:0,r="bottom"===o._orientation?t.offsetHeight/2:0,a=[t.parentNode.parentNode.offsetLeft+t.parentNode.offsetLeft+i,t.parentNode.parentNode.offsetTop+t.parentNode.offsetTop+r];d.left=Math.min(a[0],d.left),d.top=Math.min(a[1],d.top),d.right=Math.max(a[0]+i,d.right),d.bottom=Math.max(a[1]+r,d.bottom)}}),l.remove(),i&&i.remove();var h={};return h.left=Math.abs(Math.min(d.left-e.left,0)),h.top=Math.abs(Math.min(d.top-e.top,0)),h.right=Math.max(d.right-e.right,0),h.bottom=Math.max(d.bottom-e.bottom,0),this._unionAxisPadding(h,t)},t._render=function(t,e,n){if(!this._scale())throw Error("The axis does not have a scale associated with it.");var i,r=dv.util.scaleRange(this._scale()),a=this._ticks.call(this,Math.abs(r[1]-r[0])),s=this._getAxisOffset(n);this._shouldDrawAxisLabels(e)?i=this._constructLabelGroup(this.__labelParent,s):this.__labelParent.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).remove();var o=this._constructD3Axis(i,n,a,e);return this._renderAxis(this._parent(),e.bounds(),s,o,i),this},t._shouldDrawAxisLabels=function(t){var e=t.facet(),n=this._scale().property(),i=this.orientation();return e._isFree(n)&&e._showAllPanelLabelsIfFree()||t.visibleAxisLabelOrientations()[i]},t._unionAxisPadding=function(t,e){return e.left=Math.max(e.left,t.left),e.top=Math.max(e.top,t.top),e.right=Math.max(e.right,t.right),e.bottom=Math.max(e.bottom,t.bottom),e},t._constructLabelGroup=function(t,e,n){var i=".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()+(n?" .temp-axis":""),r=t.selectAll(i).data([0]);return r.enter().append("div").classed("axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).classed("temp-axis",n).style("left",e[0]+"px").style("top",e[1]+"px"),dv.ANIMATION?r.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease()).style("left",e[0]+"px").style("top",e[1]+"px"):r.style("left",e[0]+"px").style("top",e[1]+"px"),r},t._getAxisOffset=function(t){switch(this._orientation){case"bottom":return[0,t.bottom];case"left":return[t.left,0];case"top":return[0,t.top];case"right":return[t.right,0]}},t._constructD3Axis=function(t,n,i,r){var a,s=dv.util.isUndefined(this._tickSize)?this._getDefaultTickSize(n):this._tickSize,o=dv.util.isUndefined(this._minorTickSize)?this._getDefaultTickSize(n):this._minorTickSize;if("left"===this._orientation&&(a="right"),"right"===this._orientation&&(a="left"),"top"===this._orientation&&(a="bottom"),"bottom"===this._orientation&&(a="top"),"x"===this._scale().property()){var l=dv.util.scaleRange(this._scale());l[0]+=this._chart().coord().startX(),l[1]-=this._chart().coord().endX(),this._scale()instanceof dv.scale.ordinal?this._scale().rangeBands(l):this._scale().range(l)}return dv.svg.axis()._orient(a)._labelParent(t)._panel(r)._ticks(dv.util.isUndefined(i)?5:i,this._tickInterval)._tickSize(s,o,s)._tickDx(dv.util.isUndefined(this._tickDx)?this._getDefaultTickDx():this._tickDx)._tickDy(dv.util.isUndefined(this._tickDy)?this._getDefaultTickDy():this._tickDy)._tickAnchor(dv.util.isUndefined(this._tickAnchor)?this._getDefaultTickAnchor():this._tickAnchor)._tickFormat(dv.util.isUndefined(this._tickFormat)&&"fill"===this._chart().position()&&"y"===this._scale().property()?e:this._tickFormat)._tickValues(this._tickValues)._htmlLabels(this._htmlLabels)._tickSubdivide(this._tickSubdivide)._scale(this._scale()._d3Scale)},t._renderAxis=function(t,e,n,i,r){var a=t.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).data([0]);i._labelParent(r),a.enter().append("g").classed("axis axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),!0).attr("transform","translate("+n[0]+","+n[1]+")"),dv.ANIMATION&&(a=a.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease())),a.attr("transform","translate("+n[0]+","+n[1]+")").call(i)},t._measureAxis=function(t,e,n){return t.attr("transform","translate("+e[0]+","+e[1]+")").call(n),t.node().getBBox()},t._measureAxisTitle=function(t,e,n,i){var r={left:0,top:0,right:0,bottom:0};if(this._title){var a=t.append("div").classed("temp-axis-title",!0),s=this._titleOrientation||this._orientation,o="top"===s||"bottom"===s?i.right-i.left:i.bottom-i.top,l=this._createAndSizeAxisTitle(a,s,e,n,o),c=l.node().getBoundingClientRect();r[s]+="top"===s||"bottom"===s?c.height:c.width,a.remove()}return r},t._renderAxisTitle=function(t,e,n,i,r){var a,s=this._titleOrientation||this._orientation;if(this._title){var o=t.selectAll(".axis-title-"+n+".axis-title-index-"+i).empty(),l="left"===s||"right"===s,c=l?e[s][1]-r.top:e[s][0]-r.left,u=2*c,d=this._createAndSizeAxisTitle(t,s,n,i,u);dv.ANIMATION&&(a=d.transition().duration(this._chart().duration()).delay(this._chart().delay()).ease(this._chart().ease())),this._positionAxisTitle(o||!dv.ANIMATION?d:a,e[s],s),a?a.style("opacity",1):d.style("opacity",1)}},t._createAndSizeAxisTitle=function(e,n,i,r,a){var s=e.selectAll(".axis-title-"+i+".axis-title-index-"+r).data([t]);return s.enter().append("div").classed("axis-title axis-title-"+i+" axis-title-index-"+r,!0).style("opacity",dv.ANIMATION?0:1),s.text(this._title).style("width",a-10+"px").classed({top:"top"===n,bottom:"bottom"===n,left:"left"===n,right:"right"===n})},t._positionAxisTitle=function(t,e,n){t.style("left",function(){var t=0;return e[0]+t+"px"}).style("top",function(){var t=0;return"top"===n&&(t=-this.offsetHeight),e[1]+t+"px"})},t._getDefaultTickSize=function(t){return"bottom"===this._orientation?d3.functor(t.bottom-t.top):"left"===this._orientation?d3.functor(t.right-t.left):"top"===this._orientation?d3.functor(t.bottom-t.top):d3.functor(t.right-t.left)},t._getDefaultTickDx=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(0):d3.functor(-12)},t._getDefaultTickDy=function(){return"bottom"===this._orientation||"top"===this._orientation?d3.functor(-12):d3.functor(0)},t._getDefaultTickAnchor=function(){return"left"===this._orientation?d3.functor("end"):"right"===this._orientation?d3.functor("start"):d3.functor("middle")},t._labelParent=function(t){return arguments.length?(this.__labelParent=t,this):this.__labelParent},t.ticks=function(t,e){return arguments.length?(arguments.length>1?(this._ticks=function(){return t},this._tickInterval=e):(this._ticks=d3.functor(t),this._tickInterval=void 0),this):dv.util.isFinite(this._tickInterval)?[this._ticks,this._tickInterval]:this._ticks},t.tickSubdivide=function(t){return arguments.length?(this._tickSubdivide=t,this):this._tickSubdivide},t.tickSize=function(t){return arguments.length?(this._tickSize=d3.functor(t),this):this._tickSize},t.minorTickSize=function(t){return arguments.length?(this._minorTickSize=d3.functor(t),this):this._minorTickSize},t.tickDx=function(t){return arguments.length?(this._tickDx=d3.functor(t),this):this._tickDx},t.htmlLabels=function(t){return arguments.length?(this._htmlLabels=t,this):this._htmlLabels},t.tickDy=function(t){return arguments.length?(this._tickDy=d3.functor(t),this):this._tickDy},t.tickAnchor=function(t){return arguments.length?(this._tickAnchor=d3.functor(t),this):this._tickAnchor},t.tickFormat=function(t){if(!arguments.length){var e=this._scale()._d3Scale;return this._tickFormat?this._tickFormat:e.tickFormat?e.tickFormat(e):function(t){return t}}return this._tickFormat=t,this},t.tickValues=function(t){return arguments.length?(this._tickValues=t,this):this._tickValues},t.titleOrientation=function(t){return arguments.length?(this._titleOrientation=t,this):this._titleOrientation},t._chart=function(t){return arguments.length?(this.__chart=t,this):this.__chart},t}),dv.svg.axis=function(){function t(t,e){t.attr("transform",function(t){return"translate("+e(t)+",0)"})}function e(t,e){t.attr("transform",function(t){return"translate(0,"+e(t)+")"})}function n(t,e,n){var i=d3.select(t).select("span").node().offsetWidth,r="end"===n?-i:"middle"===n?-i/2:0;return e+r}function i(t,e,n){var i=d3.select(t).select("span").node().offsetHeight,r="top"===n?0:"middle"===n?-i/2:-i;return e+r}function r(t,e,n){var i=[];if(n&&e.length>1){for(var r,a,s=dv.util.scaleExtent(t.domain()),o=-1,l=e.length,c=(e[1]-e[0])/++n;l>++o;)for(r=n;--r>0;)(a=+e[o]-r*c)>=s[0]&&i.push(a);for(--o,r=0;n>++r&&(a=+e[o]+r*c)<s[1];)i.push(a)}return i}function a(a){var x=function(t,e,r,a,s){var o={};switch(s){case"top":o.top=i(t,-f.call(t,e,r),"top"),o.left=a(e)+n(t,p.call(t,e,r),g.call(t,e,r));break;case"bottom":o.top=i(t,f.call(t,e,r),"bottom"),o.left=a(e)+n(t,p.call(t,e,r),g.call(t,e,r));break;case"right":o.top=a(e)+i(t,f.call(t,e,r),"middle"),o.left=n(t,p.call(t,e,r),g.call(t,e,r));break;case"left":o.top=a(e)+i(t,f.call(t,e,r),"middle"),o.left=n(t,-p.call(t,e,r),g.call(t,e,r))}o.top=(isNaN(o.top)?0:o.top)+"px",o.left=(isNaN(o.left)?0:o.left)+"px";var l=g.call(t,e,r);return d3.select(t).classed({start:"start"===l,middle:"middle"===l,end:"end"===l}),o},b=function(t,e){["top","left"].forEach(function(n){t.style(n,function(t,i){return e[i][n]})})},A=function(t,e,n){if(o){var i,r,a,u,d=null==s?l.tickFormat?l.tickFormat.apply(l,_):String:s;o.style("position","absolute"),i=o.selectAll(".axis-label").data(t,String),r=i.enter().append("div").classed("axis-label",!0).style("opacity",1e-6).style("position","absolute"),a=d3.transition(i.exit()).style("opacity",1e-6).remove(),u=d3.transition(i).style("opacity",1),r.append("span");var h=i.selectAll("span"),p=function(t,e,n){return d.call(this,t,n)};v?h.html(p):h.text(p);var f,g=[],m=[],y=[],A=[];if(!l.ticks){var k=l.rangeBand()/2;f=function(t){return n(t)+k}}r.each(function(t,n){g[n]=x(this,t,n,f||e,c)}),u.each(function(t,i){m[i]=x(this,t,i,f||e,c),y[i]=x(this,t,i,f||n,c)}),l.ticks&&a.each(function(t,e){A[e]=x(this,t,e,n,c)}),b(r,g),b(i,m),b(u,y),l.ticks&&b(a,A)}};a.each(function(){var n,i=d3.select(this),a=null==m?l.ticks?l.ticks.apply(l,_):l.domain():m,s=r(l,a,y),o=i.selectAll(".minor").data(s,String),p=o.enter().insert("line","g").attr("class","tick minor").style("opacity",1e-6),f=d3.transition(o.exit()).style("opacity",1e-6).remove(),g=d3.transition(o).style("opacity",1),v=i.selectAll(".axis-tick").data(a,String),x=v.enter().insert("g","path").classed("axis-tick",!0).style("opacity",1e-6),b=d3.transition(v.exit()).style("opacity",1e-6).remove(),k=d3.transition(v).style("opacity",1),S=dv.util.scaleRangeNoReverse(l);path=i.selectAll(".domain").data([0]),pathEnter=path.enter().append("path").attr("class","domain"),pathUpdate=d3.transition(path);var M=l.copy(),P=this.__chart__||M;this.__chart__=M,x.append("line").attr("class","tick");var w=x.select("line"),O=k.select("line");switch(c){case"bottom":n=t,p.attr("y2",function(t,e){return d.call(this,t,e,panel)}),g.attr("x2",0).attr("y2",function(t,e){return d.call(this,t,e,panel)}),w.attr("y2",function(t,e){return u.call(this,t,e,panel)}),O.attr("x2",0).attr("y2",function(t,e){return u.call(this,t,e,panel)}),pathUpdate.attr("d",function(t,e){return"M"+S[0]+","+h.call(this,t,e,panel)+"V0H"+S[1]+"V"+h.call(this,t,e,panel)});break;case"top":n=t,p.attr("y2",function(t,e){return-d.call(this,t,e,panel)}),g.attr("x2",0).attr("y2",function(t,e){return-d.call(this,t,e,panel)}),w.attr("y2",function(t,e){return-u.call(this,t,e,panel)}),O.attr("x2",0).attr("y2",function(t,e){return-u.call(this,t,e,panel)}),pathUpdate.attr("d",function(t,e){return"M"+S[0]+","+-h.call(this,t,e,panel)+"V0H"+S[1]+"V"+-h.call(this,t,e,panel)});break;case"left":n=e,p.attr("x2",function(t,e){return-d.call(this,t,e,panel)}),g.attr("x2",function(t,e){return-d.call(this,t,e,panel)}).attr("y2",0),w.attr("x2",function(t,e){return-u.call(this,t,e,panel)}),O.attr("x2",function(t,e){return-u.call(this,t,e,panel)}).attr("y2",0),pathUpdate.attr("d",function(t,e){return"M"+-h.call(this,t,e,panel)+","+S[0]+"H0V"+S[1]+"H"+-h.call(this,t,e,panel)});break;case"right":n=e,p.attr("x2",function(t,e){return d.call(this,t,e,panel)}),g.attr("x2",function(t,e){return d.call(this,t,e,panel)}).attr("y2",0),w.attr("x2",function(t,e){return u.call(this,t,e,panel)}),O.attr("x2",function(t,e){return u.call(this,t,e,panel)}).attr("y2",0),pathUpdate.attr("d",function(t,e){return"M"+h.call(this,t,e,panel)+","+S[0]+"H0V"+S[1]+"H"+h.call(this,t,e,panel)})}if(l.ticks)x.call(n,P),k.call(n,M),b.call(n,M),p.call(n,P),g.call(n,M),f.call(n,M);else{var T=M.rangeBand()/2,z=function(t){return M(t)+T};x.call(n,z),k.call(n,z)}A(a,P,M)})}var s,o,l=d3.scale.linear(),c="bottom",u=d3.functor(6),d=d3.functor(6),h=d3.functor(6),p=d3.functor(0),f=d3.functor(0),g=d3.functor("start"),_=[10],m=null,v=!1,y=0;return a._scale=function(t){return arguments.length?(l=t,a):l},a._orient=function(t){return arguments.length?(c=t,a):c},a._ticks=function(){return arguments.length?(_=arguments,a):_},a._tickValues=function(t){return arguments.length?(m=t,a):m},a._tickFormat=function(t){return arguments.length?(s=t,a):s},a._htmlLabels=function(t){return arguments.length?(v=t,a):v},a._tickSize=function(t,e){if(!arguments.length)return u;var n=arguments.length-1;return u=d3.functor(t),d=n>1?d3.functor(e):u,h=n>0?d3.functor(arguments[n]):u,a},a._tickDx=function(t){return arguments.length?(p=t,a):p},a._tickDy=function(t){return arguments.length?(f=t,a):f},a._tickAnchor=function(t){return arguments.length?(g=t,a):g},a._tickSubdivide=function(t){return arguments.length?(y=+t,a):y},a._panel=function(t){return arguments.length?(panel=t,a):panel},a._labelParent=function(t){return arguments.length?(o=t,a):o},a},dv.guide.legends=dv.extend(function(){function t(){this._legArr=[],this.__hide=!1,this._ad={left:0,right:0,width:0,height:0}}return t._render=function(t){if(this._w=0,this._h=0,!this.__hide){var e=t.el.select(".legends"),n=this,i=e.selectAll(".legend").data(this._legArr);i.exit().transition().duration(t.duration).style("opacity",0).remove();var r=i.enter().append("g").classed("legend",!0);dv.ANIMATION&&r.style("opacity",0),i.each(function(e){for(var i={},r=(e.props[0],n._getScale(t,e.props[0])),a=r.domain(),s=0;e.props.length>s;s++){var o=e.props[s],l=n._getScale(t,e.props[s]);if(!l.hasSameDomain(a))throw Error("Can't render single legend from multiple domains");i[o]=t.scales[o]}e.guide._render(d3.select(this),i,{dims:n._ad,renderOpts:t}),n._w+=e.guide._getUsedWidth(),n._h+=e.guide._getUsedHeight(),n._ad=e.guide._getAdjustedDimensions(n._ad)})}return this},t._getScale=function(t,e){var n=t.scales[e];if(void 0===e||void 0===n||void 0===n[0])throw Error("A '"+e+"'' legend has been called for, but '"+e+" hasn't been mapped to data.");return n[0]},t._add=function(t){return this._legArr.push(t),this},t._remove=function(t){for(var e in t)for(var n=t[e],i=0;this._legArr.length>i;i++){for(var r=this._legArr[i].props,a=!0,s=0;r.length>s;s++)r[s]===n&&(r.splice(s,1),s--),0===r.length&&(a=!1);a||(this._legArr.splice(i,1),i--)}},t._legends=function(t){return arguments.length?(this._legArr=t,this):this._legArr},t._allowedDimensions=function(t){return arguments.length?(this._ad=t,this):this._ad},t._getWidth=function(){return this._w},t._getHeight=function(){return this._h},t._hide=function(t){return arguments.length?(this.__hide=t,this):this.__hide},t._empty=function(){for(var t=0;this._legArr.length>t;t++)delete this._legArr[t];return this._legArr=[],this},t}),dv.guide.legend=dv.guide.extend(function(){function t(){this._overlay=!1,this._orientation="top",this._vGap=5,this._hGap=15,this._defaultPadding=this._padding={top:10,left:10,right:10,bottom:10},this._swatchWidth=15,this._swatchHeight=10,this._innerPadding=5,this._spanPercent=.75,this._lineHeight=0,this._entriesWidth=[]
}function e(t){var e=this;return t.each(function(t,n){e._entryWidths[n]=Math.min(e._entryWidths[n],e._width),e._lineHeight=Math.max(e._lineHeight,this.getBBox().height)}),e._entryWidths}function n(t){for(var e,r=0,a=0,s=0,o=!1,l=0,c=0,u=[],d=0;this._legendWidths.length>d;d++)if(r+=(0===a?0:this._hGap)+this._legendWidths[d],t.data.length>a&&this._width>=r){if(this._legendWidths[d]<=t.data[a]+s)c+=0===a?0:this._hGap,u.push({x:c,y:l}),c+=t.data[a]+s,s=0;else{if((e=this._legendWidths[d]-t.data[a])<=t.padding)return t.padding-=e,t.data[a]=this._legendWidths[d],n.call(this,t);if(!(t.data.length>a+1&&this._legendWidths[d]>=t.data[a]+t.data[a+1]*this._spanPercent+s))return t=i.call(this,t.data.length-1),n.call(this,t);t.data.length>=a+1?(s+=(0===a?0:this._hGap)+t.data[a],r-=(0===a?0:this._hGap)+this._legendWidths[d],d--):(r=r-this._legendWidths[d]+s+t.data[a],s=0,c+=0===a?0:this._hGap,u.push({x:c,y:l}),c+=t.data[a]+s,a++)}a++}else{if(a+1===t.data.length&&t.data.length>1)return t=i.call(this,t.data.length-1),n.call(this,t);a===t.data.length&&(o=!0),l+=this._lineHeight+this._vGap,r=c=0,a=0,s=0,d--}return a===t.data.length&&(o=!0),o?{offsets:u,cols:t}:(t=i.call(this,t.data.length-1),n.call(this,t))}function i(t){var e={data:[],padding:this._width},n=0,r=0;for(this._isVAligned()&&(t=Math.ceil(this._legendWidths.length/Math.floor(this._height/(this._lineHeight+this._vGap)))),r=0;t>r;r++)n+=this._legendWidths[r]+this._hGap;return n-=this._hGap,n>this._width&&t>1?i.call(this,t-1):(e.data=this._legendWidths.slice(0,t),e.padding-=n,0>e.padding&&(e.padding=0),e)}function r(t,e,n,i){return"M"+t+","+e+"L"+(t+n)+","+e+"L"+(t+n)+","+(e+i)+"L"+t+","+(e+i)+"Z"}function a(t,e,n,i){var r=e+i>>1;return"M"+t+","+r+"L"+n+","+r}function s(){return this._scales.hasOwnProperty("fill")?r.call(this,0,0,this._swatchWidth,this._swatchHeight):a.call(this,0,0,this._swatchWidth,this._swatchHeight)}return t._render=function(t,r,a){var s=t,o=a.dims,l=this;this._renderingOptions=a.renderOpts,this._scales=r,this._transformData=[],this._width=o.width-this._padding.left-this._padding.right,this._height=o.height-this._padding.top-this._padding.bottom;var c=this._drawEntries(t);this._legendWidths=e.call(this,c);var u=i.call(this,Math.min(this._legendWidths.length,Math.floor(this._width/this._swatchWidth))),d=n.call(this,u),h=d.offsets;u=d.cols,this._width=this._width-u.padding+this._hGap*(u.data.length-1),this._height=this._lineHeight+h[h.length-1].y,c.each(function(t,e){var n=d3.select(this);dv.ANIMATION&&(n=n.transition().duration(l._renderingOptions.duration).delay(l._renderingOptions.delay).ease(l._renderingOptions.ease)),n.attr("transform","translate("+h[e].x+", "+h[e].y+")")}),this._renderingOptions.firstRender||(s=t.transition().duration(this._renderingOptions.duration).style("opacity",1));var p="right"===this._orientation?o.left+o.width-this._width-this._padding.right:o.left+this._padding.left,f="bottom"===this._orientation?o.top+o.height-this._height-this._padding.bottom:o.top+this._padding.top;s.attr("transform","translate("+p+","+f+")"),this._renderingOptions.firstRender&&s.transition().duration(this._renderingOptions.duration).style("opacity",1)},t._drawEntries=function(t){var e=this,n=[];this._entryWidths=[];for(var i in this._scales){n=this._scales[i][0].domain();break}var r=t.selectAll(".legend-entry").data(n);r.exit().transition().duration(this._renderingOptions.duration).style("opacity",0).remove();var a=r.enter().append("g").classed("legend-entry",!0);return a.append("path"),a.append("text").classed("legend-entry-label",!0),a.append("text").classed("legend-entry-value",!0),r.select("path").attr("d",function(t,n){return s.call(e,t,n)}).call(function(t){t.attr("style",""),e._scales.hasOwnProperty("fill")&&t.style("fill",function(t){return e._scales.fill[0].mapValue(t)}),e._scales.hasOwnProperty("stroke")&&t.style("stroke",function(t){return e._scales.stroke[0].mapValue(t)}).style("stroke-width",2),e._scales.hasOwnProperty("linetype")&&(t.style("stroke-dasharray",function(t){return dv.util.svg.getDasharray(e._scales.linetype[0].mapValue(t))}),e._scales.hasOwnProperty("stroke")||t.style("stroke","#000"),t.style("stroke-width",2)),e._scales.hasOwnProperty("size")&&t.style("stroke-width",function(t){return e._scales.size[0].mapValue(t)})}).each(function(t,n){e._entryWidths[n]=this.getBBox().width}),r.select("text.legend-entry-label").attr("x",this._swatchWidth+this._innerPadding).attr("y",10).text(function(t,n){return dv.util.isUndefined(e._labels)?t:e._labels[n%e._labels.length]}).each(function(t,n){e._entryWidths[n]+=e._innerPadding+this.getBBox().width}),r.select("text.legend-entry-value").attr("y",10).attr("x",function(t,n){return e._entryWidths[n]+e._innerPadding}).text(function(t,n){return dv.util.isUndefined(e._values)?"":e._values[n]}).style("fill",function(t){return dv.util.isUndefined(e._scales.stroke)?dv.util.isUndefined(e._scales.fill)?void 0:e._scales.fill[0].mapValue(t):e._scales.stroke[0].mapValue(t)}).each(function(t,n){var i=this.getBBox().width;e._entryWidths[n]+=i+(i>0?e._innerPadding:0)}),r},t._getAdjustedDimensions=function(t){if(this._overlay)return t;var e=this._padding.left+this._width+this._padding.right,n=this._padding.top+this._height+this._padding.bottom;return"left"===this._orientation?(t.left+=e,t.width-=e):"top"===this._orientation?(t.top+=n,t.height-=n):"right"===this._orientation?t.width-=e:"bottom"===this._orientation&&(t.height-=n),t},t._getUsedWidth=function(){return this._overlay?0:this._isVAligned()?this._width+this._padding.left+this._padding.right:0},t._getUsedHeight=function(){return this._overlay?0:this._isVAligned()?0:this._height+this._padding.top+this._padding.bottom},t._isVAligned=function(){return"left"===this._orientation||"right"===this._orientation},t.vGap=function(t){return arguments.length?(this._vGap=t,this):this._vGap},t.hGap=function(t){return arguments.length?(this._hGap=t,this):this._hGap},t.padding=function(t){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,t),this):this._padding},t.align=function(t){return arguments.length?(this._align=t,this):this._align},t.labels=function(t){return arguments.length?(this._labels=t,this):this._labels},t.values=function(t){return arguments.length?(this._values=t,this):this._values},t.overlay=function(t){return arguments.length?(this._overlay=t,this):this._overlay},t}),dv.guide.custom=dv.guide.extend(function(){function t(){this._render=function(){return dv.log.warn({msg:"empty render function on custom guide"}),this},this._getAdjustedDimensions=function(t){return t},this._getUsedWidth=function(){return 0},this._getUsedHeight=function(){return 0}}return t.setFunc=function(t,e){return this[t]=e,this},t}),dv.geom=dv.container.extend(function(){function t(){this._super(),this._defaultAes={},this._behaviorsLayer=null,this._dodgePadding=0,this._initializeDefaultAes()}return t._initializeDefaultAes=function(){this._defaultAes.x=1,this._defaultAes.y=1,this._defaultAes.shape="circle",this._defaultAes.linetype="solid"},t._prerender=function(t){this._trainedScales={},this._chart=t,this.normalizedData(this._normalizeData(this.data())),this._calculateStats(),this._inheritChartAesthetics(t)},t._inheritChartAesthetics=function(t){for(var e in t._aes){var n=t._aes[e];this._aes[e]||(this._aes[e]={});for(var i in n)this._aes[e][i]||(this._aes[e][i]=n[i])}},t._trainScales=function(){},t._createDefaultScales=function(){for(var t in this._defaultAes)this._aes.hasOwnProperty(t)||(this._aes[t]={},this._aes[t][0]=dv.scale.constant().value(this._defaultAes[t]).property(t)),delete this._defaultAes[t]},t._render=function(t){var e=this;this._geomGroup=d3.select(t);var n=this._geomGroup.selectAll(".series").data(this._nestData);n.exit().call(e.exitSeriesGroup,e),n.enter().append("g").classed("series",!0),n.call(e.updateGroups,e.enterPen,e.pen,e.enterPen,e).call(e.updateDataPoints,e.enterPen,e.pen,e.enterPen,e),e._renderBehaviors(e._geomGroup),e.unregisterEventMap=null},t._renderBehaviors=function(t){var e=this;this._behaviors&&this._behaviors.length&&(this._behaviorsLayer=t.select(".behavior-layer"),this._behaviorsLayer.empty()?this._behaviorsLayer=t.append("g").classed("behavior-layer",!0):this._behaviorsLayer.node().parentNode.appendChild(this._behaviorsLayer.node()),dv.util.each(this._behaviors,function(t){t._geom(e)._render(e._behaviorsLayer)}))},t.updateGroups=function(t,e,n,i,r){t.each(function(t){var e=0,n=0,i=d3.select(this),a=i.attr("transform");if(r._chart._coord instanceof dv.coord.polar){var s=t.values[0],o=dv.util.scaleRange(s.panel.xOuterScale()),l=dv.util.scaleRange(s.panel.yOuterScale()),c=(o[0]+o[1])/2,u=(l[0]+l[1])/2,d=r._chart._coord.flip();e=d?u:c,n=d?c:u}a&&dv.ANIMATION&&(i=i.transition().duration(function(t,e){return r.duration().call(this,t,e)})),i.attr("transform","translate("+e+","+n+")")})},t.updateDataPoints=function(t,e,n,i,r){var a=e.call(r),s=n.call(r),o=i.call(r),l=t.selectAll("."+r._dataPointStyleClass).data(function(t){return r.getValues(t)});l.exit().transition().delay(function(t,e,n){return r.delay().call(this,t,e,n)}).duration(function(t,e,n){return r.duration().call(this,t,e,n)}).ease(r.ease()).each(function(){this.__exiting__=!0}).attrTween("d",o.pathTween).remove(),l.enter().append("path").each(function(t,e,n){r.setPreviousState.call(this,a,o,t,e,n)}).attr("class",function(t,e,n){return"datum-"+e+" series-"+n}).call(r.attributes,r).attr("d",a.path);var c=l.call(r.attributes,r).call(r._removeRegisteredEvents,r).call(r._addRegisteredEvents,r).each(function(){this.__exiting__=!1});dv.ANIMATION?c=c.transition().delay(function(t,e,n){return r.delay().call(this,t,e,n)}).duration(function(t,e,n){return r.duration().call(this,t,e,n)}).ease(r.ease()).attrTween("d",s.pathTween):c.each(function(t,e,n){var i=s.bounds(t,e,n);i&&(t.bounds=i.bounds)}).attr("d",s.path),c.call(r.addEachFunction,r)},t.addEachFunction=function(t,e){e._each&&(dv.util.isUndefined(e._each.start)||(dv.ANIMATION?t.each("start",function(t,n,i){e._each.start.call(this,t,n,i)}):t.each(function(t,n,i){e._each.start.call(this,t,n,i)})),dv.util.isUndefined(e._each.end)||(dv.ANIMATION?t.each("end",function(t,n,i){e._each.end.call(this,t,n,i)}):t.each(function(t,n,i){e._each.end.call(this,t,n,i)})))},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.setPreviousState=function(t,e,n,i){var r=t.bounds(n,i);this.__previousBounds__=r,this.__exitTransition__=e},t.pathTween=function(t,e,n,i){var r,a=d3.select(e);return e.__exiting__?(r=e.__exitTransition__.path(n,i),e.__exiting__=!1):r=t.getPath(t.getBounds(n,i)),null===r?(a.remove(),null):d3.interpolate(a.attr("d"),r)},t._calculateStats=function(){},t._handlePositions=function(){if("stack"===this.position()||"fill"===this.position()||"dodge"===this.position()){var t=this.position(),e=this._addGroupLayerToNestedData(),n=(this._chart.coord().flip(),function(t){var e=i.getExplicitScales(t)[t],n=!1;return function(i,r){for(var a in e)if(n=e[a]._includeInDomain(i,r))break;return n?i[t]:0}}),i=this;dv.util.each(e,function(e){var i=n("x"),r=n("y");if("stack"===t)d3.layout.stack().x(i).y(r).values(function(t){return t.values})(e.values);else if("fill"===t)d3.layout.stack().x(i).y(r).offset(function(t){var e,n,i,r=t.length,a=t[0].length,s=[];for(n=0;a>n;++n){for(e=0,i=0;r>e;e++)i+=t[e][n][1];if(i)for(e=0;r>e;e++)t[e][n][1]/=i;else for(e=0;r>e;e++)t[e][n][1]=0}for(n=0;a>n;++n)s[n]=0;return s}).values(function(t){return t.values})(e.values);else if("dodge"===t){var a=e.values.length;dv.util.each(e.values,function(t,e){dv.util.each(t.values,function(t){t.dodge={groupIndex:e,numGroups:a}})})}})}},t._addGroupLayerToNestedData=function(){var t=[],e={},n={};return dv.util.each(this._nestData,function(i){var r,a,s=/(.*) ~ .*/g.exec(i.key)[1],o=/.* ~ (.*)/g.exec(i.key)[1];e.hasOwnProperty(s)||(t.push({key:s,values:[]}),e[s]=t.length-1),r=t[e[s]],n.hasOwnProperty(i.key)||(r.values.push({key:o,values:[]}),n[i.key]=r.values.length-1),a=r.values[n[i.key]],a.values=a.values.concat(i.values)}),t},t.exit=function(t){d3.select(t).selectAll(".series").call(this.exitSeriesGroup,this)},t.exitSeries=function(t,e,n){t.selectAll("."+n._dataPointStyleClass).transition().delay(function(t,e,i){return n.delay().call(this,t,e,i)}).duration(function(t,e,i){return n.duration().call(this,t,e,i)}).ease(n.ease()).each(function(){this.__exiting__=!0}).attrTween("d",e.call(n).pathTween).remove().each("end",function(){var t=this.parentNode;if(t&&t.childNodes&&!t.childNodes.length){var e=t.parentNode;e&&e.childNodes&&1>=e.childNodes.length?d3.select(e).remove():d3.select(t).remove()}})},t.coord=function(){return this.chart().coord()},t._addRegisteredEvents=function(t,e){e||(e=this),e._geomGroup&&(t=t?t:e._geomGroup.selectAll(".series").selectAll("."+this._dataPointStyleClass),e=e||this,dv.util.each(e.eventMap,function(n,i){t.on(i,function(t,n,r){e.eventMap[i].callback.call(this,t,n,r,d3.event)},n.capture)}),dv.util.each(e._chart.eventMap,function(n,i){t.on(i+".dvchart",function(){var t=d3.event,n=e._chart._interactionGroup.select(".interaction-canvas").node();e._shouldDispatchChartEvent(t,n)&&e._chart.eventMap[i].callback.call(n,t)},n.capture)}),dv.util.each(e._behaviors,function(t){t._addRegisteredEvents&&t._addRegisteredEvents()}))},t._removeRegisteredEvents=function(t,e){e||(e=this),e._geomGroup&&(t=t||e._geomGroup.selectAll("."+this._dataPointStyleClass),e=e||this,dv.util.each(e.unregisterEventMap,function(e,n){t.on(n,null,e)}),dv.util.each(e._chart.unregisterEventMap,function(e,n){t.on(n+".dvchart",null,e)}),dv.util.each(e._behaviors,function(t){t._removeRegisteredEvents&&t._removeRegisteredEvents()}))},t._shouldDispatchChartEvent=function(t,e){var n=!0;if("mouseout"===t.type||"mouseover"===t.type){var i=t.relatedTarget;i||(i="mouseout"===t.type?t.toElement:t.fromElement);var r=d3.select(i);if(r&&!r.empty()){var a=r.attr("class");n=!(r.node()===e||a&&a.indexOf("-geom")>=0)}}return n},t.getExplicitScalesMap=function(){var t=dv.util.clone(this._chart.getExplicitScalesMap());for(var e in this._aes){var n=this._aes[e],i=t[e]||{},r=dv.util.extend({},i,n);t[e]=r}return t},t.getExplicitScale=function(t,e){if("group"===t)return this._getGroup();var n=this._aes[t],i=this.chart()._aes[t];return void 0!==e&&n&&n[e]?n[e]:void 0!==e&&i&&i[e]?i[e]:n&&void 0!==n[0]?n[0]:i&&void 0!==i[0]?i[0]:null},t.getExplicitScales=function(t){dv.util.isArray(t)||(t=[t]);for(var e={},n=-1,i=t.length;i>++n;){var r=t[n],a=this._aes[r],s=this.chart()._aes[r]||{};e[r]=dv.util.extend({},s,a)}return e},t.getTrainedScale=function(t,e){return this.chart().getTrainedScale(t,e)},t.getScale=function(t,e){return this.getExplicitScale(t,e)},t.getScales=function(t){return this.getExplicitScales(t)},t.hasScale=function(t,e){return this.getExplicitScale(t,e)?!0:!1},t._dodgeAdjust=function(t){var e=t.dodge.groupIndex,n=t.dodge.numGroups,i=t.panel.xScale(t).rangeBand(),r=n>1?i/(n-1)*this._dodgePadding:0,a=(i-r*(n-1))/n;return(a+r)*e+a/2},t.applyAttributeValue=function(t,e,n,i){var r=e.getScale(i,0);t.style(n,function(t,e,n){return r?r.mapToProp(dv.util.isArray(t)?t[0]:t,e,n):null})},t._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];var t=this.chart()._getGroup();if(t&&"group"===t.property())return t;for(var e=-1,n=dv.DEFAULT_CATEGORICAL_AES.length-1;n>e++;){var i=this._aes[dv.DEFAULT_CATEGORICAL_AES[e]];if(i&&i[0]&&i[0]instanceof dv.scale.ordinal&&!dv.util.isUndefined(i[0].mapping()))return i[0]}return t},t.each=function(t,e){var n,i;return arguments.length?(this._each=this._each||{},2>arguments.length?(i=t,n="end"):(i=e,n=t),this._each[n]=i,this):this._each},t.dodgePadding=function(t){return arguments?(this._dodgePadding=t,this):this._dodgePadding},t.behaviors=function(t){return arguments.length?(this._behaviors=t,this):this._behaviors},t.stat=function(t){return arguments.length?(this._stat=t,this):this._stat},t.chart=function(t){return arguments.length?(this._chart=t,this):this._chart},t.normalizedData=function(t){return arguments.length?(this._normalizedData=t,this):this._normalizedData},t.data=function(t){return arguments.length?(this._data=t,this):this._data?this._data:this.chart().data()},t}),dv.geom.point=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.point}return t._dataPointStyleClass="point-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.shape="circle",this._defaultAes.size=7},t.getValues=function(t){return t.values},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.attributes=function(t,e){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"opacity","alpha").call(e.applyAttributeValue,e,"stroke","stroke").call(e.applyAttributeValue,e,"fill","fill")},t.getHighlightColor=function(t,e){var n=this.getScale("fill"),i=this.getScale("stroke");return!i||i instanceof dv.scale.constant?!n||n instanceof dv.scale.constant?i?i.mapToProp(t,e):"#8CC350":n.mapToProp(t,e):i.mapToProp(t,e)},t.enterPen=function(){var t,e=this,n=function(t){return t.panel.yScale(t).reverse()?1:0};return t="dodge"===this.position()?function(t,n){var i=t.panel.xScale(t);return i.mapValueToPercent(i.mapToProp(t,n)+e._dodgeAdjust(t),n)}:function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},this._decoratePen(t,n)},t.pen=function(){var t,e=this,n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};switch(this.position()){case"identity":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};break;case"stack":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"dodge":n=function(t,n){var i=t.panel.xScale(t);return i.mapValueToPercent(i.mapToProp(t,n)+e._dodgeAdjust(t),n)},t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};break;case"fill":t=function(t){return t.y+t.y0}}return this._decoratePen(n,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e){var n=this.getScale("shape"),i=this.getScale("size"),r=this,a=this.coord()._point().x(t).y(e).defined(this._defined);return a.renderer.type(function(t,e){return n.mapToProp(t,e)}).size(function(t,e){return Math.pow(i.mapToProp(t,e),2)}),{bounds:function(t,e){return a.getBounds(t,e)},pathTween:function(t,e){return r.pathTween(a,this,t,e)},path:function(t,e){return a.getPath(a.getBounds(t,e))}}},t}),dv.geom.text=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.text,this._dx=d3.functor(0),this._dy=d3.functor(0),this._textFormat=function(t){return t},this._textAnchor="start"}return t._dataPointStyleClass="text-geom",t.dx=function(t){return arguments.length?(this._dx=d3.functor(t),this):this._dx},t.dy=function(t){return arguments.length?(this._dy=d3.functor(t),this):this._dy},t.textAnchor=function(t){return arguments.length?(this._textAnchor=t,this):this._textAnchor},t.textFormat=function(t){return arguments.length?(this._textFormat=d3.functor(t),this):this._textFormat},t.getValues=function(t){return t.values},t.updateDataPoints=function(t,e,n,i,r){var a=(r.getScale("alpha"),e.call(r)),s=n.call(r),o=i.call(r),l=t.selectAll("."+r._dataPointStyleClass).data(function(t){return r.getValues(t)});l.exit().transition().delay(function(t,e,n){return r.delay().call(this,t,e,n)}).duration(function(t,e,n){return r.duration().call(this,t,e,n)}).ease(r.ease()).call(o).each("end.transition",function(){var t=this.parentNode;t&&t.removeChild(this)}),l.enter().append("text").attr("class",function(t,e,n){return"datum-"+e+" series-"+n}).call(r.attributes,r).call(a);var c=l.call(r.attributes,r).call(r._removeRegisteredEvents,r).call(r._addRegisteredEvents,r);dv.ANIMATION&&(c=c.transition().delay(function(t,e,n){return r.delay().call(this,t,e,n)}).duration(function(t,e,n){return r.duration().call(this,t,e,n)}).ease(r.ease())),c.call(s).call(r.addEachFunction,r)},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.exitSeries=function(t,e,n){t.selectAll("."+n._dataPointStyleClass).transition().delay(function(t,e,i){return n.delay().call(this,t,e,i)}).duration(function(t,e,i){return n.duration().call(this,t,e,i)}).ease(n.ease()).call(e.call(n)).remove().each("end.transition",function(){var t=this.parentNode;t.parentNode&&t.removeChild(this),t&&t.childNodes&&!t.childNodes.length&&d3.select(t).remove()})},t.attributes=function(t,e){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke").call(e.applyAttributeValue,e,"fill","fill").call(e.applyAttributeValue,e,"opacity","alpha").call(e.applyAttributeValue,e,"font-size","size").attr("text-anchor",e._textAnchor)},t.enterPen=function(){var t,e=this,n=this._dx,i=function(t){return t.panel.yScale(t).reverse()?1:0};return t="dodge"===this.position()?function(t,i,r){var a=t.panel.xScale(t);return a.mapValueToPercent(a.mapToProp(t,i)+e._dodgeAdjust(t)+n(t,i,r),i)}:function(t,e,i){var r=t.panel.xScale(t);return r.mapValueToPercent(r.mapToProp(t,e)+r.rangeBand()/2+n(t,e,i),e)},this._decoratePen(t,i)},t.pen=function(){var t,e=this,n=this._dx,i=this._dy,r=function(t,e,i){var r=t.panel.xScale(t);return r.mapValueToPercent(r.mapToProp(t,e)+r.rangeBand()/2+n(t,e,i),e)};switch(this.position()){case"identity":t=function(t,e,n){var r=t.panel.yScale(t);return r.mapValueToPercent(r.mapToProp(t,e)+i(t,e,n)+r.rangeBand()/2,e)};break;case"stack":t=function(t,e,n){var r=t.panel.yScale(t);return r.mapValueToPercent(r.mapValue(t.y0+t.y,e)+i(t,e,n),e)};break;case"dodge":r=function(t,i,r){var a=t.panel.xScale(t);return a.mapValueToPercent(a.mapToProp(t,i)+e._dodgeAdjust(t)+n(t,i,r),i)},t=function(t,e,n){var r=t.panel.yScale(t);return r.mapValueToPercent(r.mapToProp(t,e)+i(t,e,n)+r.rangeBand()/2,e)};break;case"fill":t=function(t,e,n){var r=t.panel.yScale(t);return t.y+t.y0+r.mapValueToPercent(i(t,e,n)+dv.util.scaleRange(r)[0],e)}}return this._decoratePen(r,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e){var n=this.getScale("label"),i=this,r=this.coord()._text().x(t).y(e);return r().label(function(t,e,r){return i._textFormat.call(this,n.mapToProp(t,e),e,r)}).defined(this._defined)},t}),dv.geom.line=dv.geom.extend(function(){function t(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.line}return t._dataPointStyleClass="line-geom",t.tension=function(t){return arguments.length?(this._tension=t,this):this._tension},t.interpolate=function(t){return arguments.length?(this._interpolate=t,this):this._interpolate},t._render=function(t){this._super(t);var e=this.getScale("size");e&&e.to&&!e.to()&&e.to([2,8])},t.getValues=function(t){return[t.values]},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.attributes=function(t,e){var n=e.getScale("linetype",0);t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke").call(e.applyAttributeValue,e,"opacity","alpha").call(e.applyAttributeValue,e,"stroke-width","size").style("stroke-dasharray",function(t,e,i){return n?dv.util.svg.getDasharray(n.mapToProp(t[0],e,i)):null}).style("fill","none")},t.getHighlightColor=function(t,e){var n=this.getScale("stroke",0);return n?n.mapToProp(t,e):"#8CC350"},t.enterPen=function(){var t,e=this,n=function(t){return t.panel.yScale(t).reverse()?1:0};return t="dodge"===this.position()?function(t,n){var i=t.panel.xScale(t);return i.mapValueToPercent(i.mapToProp(t,n)+e._dodgeAdjust(t),n)}:function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},this._decoratePen(t,n)},t.pen=function(){var t,e=this,n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};switch(this.position()){case"identity":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};break;case"stack":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"dodge":n=function(t,n){var i=t.panel.xScale(t);return i.mapValueToPercent(i.mapToProp(t,n)+e._dodgeAdjust(t),n)},t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)};break;case"fill":t=function(t){return t.y+t.y0}}return this._decoratePen(n,t)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e){var n=this,i=this.coord()._line().x(t).y(e).defined(this._defined);return i.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(t,e){return i.getBounds(t,e)},pathTween:function(t,e){return n.pathTween(i,this,t,e)},path:function(t,e){return i.getPath(i.getBounds(t,e))}}},t}),dv.geom.area=dv.geom.extend(function(){function t(){this._super(),this._tension=.7,this._interpolate="linear",this._rendererClass=dv.geom.area,this._baseline=0}return t._dataPointStyleClass="area-geom",t._initializeDefaultAes=function(){this._super()},t._trainScales=function(){if(void 0!==this._baseline){var t=this.getExplicitScales("y").y;for(var e in t){var n=t[e];n instanceof dv.scale.continuous&&n.softLowerLimit(this._baseline)}}this._super()},t.tension=function(t){return arguments.length?(this._tension=t,this):this._tension},t.interpolate=function(t){return arguments.length?(this._interpolate=t,this):this._interpolate},t.getValues=function(t){return[t.values]},t.pathTween=function(t,e,n,i,r){var a,s,o,l,c=e.__previousBounds__,u=[],d=this.enterPen.call(this,r),h=this.getScale("x").domain(),p=-1;for(a=t.getBounds(n,i),a.coord=this.coord(),(c&&c.coord&&a.coord._type!==c.coord._type||a.coord.flip()!=c.coord.flip())&&(c=this.enterPen.call(this,r).bounds(n,i)),s=Math.max(a.length,c.length);s>++p;)o=a.length>p?a[p]:null,l=c.length>p?c[p]:null,l?o||(o=d.bounds([l],i)[0]):(o.x=h[h.length-1],l=d.bounds([o],i)[0]),u.push(d3.interpolateObject(l.bounds,o.bounds));return e.__previousBounds__=a,function(e){1===e&&(u=u.splice(0,a.length));var n=[];return dv.util.each(u,function(t){var i={};i.bounds=t(e),n.push(i)}),t.getPath(n)}},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.attributes=function(t,e){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"opacity","alpha").call(e.applyAttributeValue,e,"fill","fill")},t.getHighlightColor=function(t,e){var n=this.getScale("fill");return n?n.mapToProp(t,e):"#8CC350"},t.getBaseline=function(t){var e=t.domain()[0];return void 0!==self._baseline?self._baseline:0>e?0:e},t.enterPen=function(){var t,e=this,n=function(t,n){var i=t.panel.yScale(t);return i.mapValueToPercent(i.mapValue(e.getBaseline(i)),n)};return t="dodge"===this.position()?function(t,n){var i=t.panel.xScale(t);return i.mapValueToPercent(i.mapToProp(t,n)+e._dodgeAdjust(t),n)}:function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},this._decoratePen(t,n,n)},t.pen=function(){var t,e,n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},i=this;switch(this.position()){case"identity":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(i.getBaseline(n)),e)},e=function(t,e){var n=t.panel.yScale(t);return n.mapPropToPercent(t,e)};break;case"stack":t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0),e)},e=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"dodge":n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+i._dodgeAdjust(t),e)},t=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(i.getBaseline(n)),e)},e=function(t,e){var n=t.panel.yScale(t);return n.mapPropToPercent(t,e)};break;case"fill":t=function(t){return t.y0},e=function(t){return t.y+t.y0}}return this._decoratePen(n,t,e)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t))},t._decoratePen=function(t,e,n){var i=this,r=this.coord()._area().x(t).y0(e).y1(n).defined(this._defined);return r.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(t,e){var n=r.getBounds(t,e);return n&&(n.coord=i.coord()),n},pathTween:function(t,e){return i.pathTween(r,this,t,e)},path:function(t,e){return r.getPath(r.getBounds(t,e))}}},t.baseline=function(t){return arguments.length?(this._baseline=t,this):this._baseline},t}),dv.geom.rect=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.rect}return t._dataPointStyleClass="bar-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,this._defaultAes.xMin=1,this._defaultAes.xMax=1,delete this._defaultAes.x,delete this._defaultAes.y},t._trainScales=function(){var t,e=this.getExplicitScales(["yMin","xMin"]),n=e.yMin,i=e.xMin;for(t in n){var r=this._aes.y;r||(this._aes.y=r={}),r[t]||(r[t]=n[t].copy().property("y").mapping("y")),r[t].trainingProperties(["yMin","yMax"])}for(t in i){var a=this._aes.x;a||(this._aes.x=a={}),a[t]||(a[t]=i[t].copy().property("x").mapping("x")),a[t].trainingProperties(["xMin","xMax"])}},t.getValues=function(t){return t.values},t._render=function(t){var e,n=this.getExplicitScales(["yMin","yMax","y","xMin","xMax","x"]);for(e in n.yMin){var i=n.yMin[e],r=n.yMax[e],a=n.y[e];a&&(r.range(a.range()).domain(a.domain()),i.range(a.range()).domain(a.domain()))}for(e in n.xMin){var s=n.xMin[e],o=n.xMax[e],l=n.x[e];l&&(o.range(l.range()).domain(l.domain()),s.range(l.range()).domain(l.domain()))}this._super(t)},t.pathTween=function(t,e,n,i){var r,a=n,s=e.__previousBounds__,o=this.coord()._type;if(r=e.__exiting__?e.__exitTransition__.bounds(n,i):t.getBounds(n,i),s&&s.coord&&o!==s.coord&&(s=e.__exitTransition__.bounds(n,i)),!r||!s)return null;r.coord=o;var l=d3.interpolateObject(s.bounds,r.bounds);return e.__previousBounds__=r,function(e){return a.bounds=l(e),t.getPath(a)}},t.attributes=function(t,e){t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"fill","fill").call(e.applyAttributeValue,e,"stroke","stroke").call(e.applyAttributeValue,e,"opacity","alpha")},t.enterPen=function(){var t=function(t){return t.panel.yScale(t).reverse()?1:0},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[0]:t.xMin,e))},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[1]:t.xMax,e))};return this._decoratePen(e,n,t,t)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[0]:t.xMin,e))},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.x)?t.x[1]:t.xMax,e))},n=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.y)?t.y[0]:t.yMin,e))},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(dv.util.isArray(t.y)?t.y[1]:t.yMax,e))};return this._decoratePen(t,e,n,i)},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapValue(dv.util.isArray(t.x)?t.x[0]:t.xMin,e))&&dv.util.isFinite(n.mapValue(dv.util.isArray(t.x)?t.x[1]:t.xMax,e))&&dv.util.isFinite(i.mapValue(dv.util.isArray(t.y)?t.y[0]:t.yMin,e))&&dv.util.isFinite(i.mapValue(dv.util.isArray(t.y)?t.y[1]:t.yMax,e))},t._decoratePen=function(t,e,n,i){var r=this,a=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=a.getBounds(t,e);return n&&(n.bounds.coord=r.coord()._type),n},pathTween:function(t,e,n){return r.pathTween(a,this,t,e,n)},path:function(t,e){return a.getPath(a.getBounds(t,e))
}}},t}),dv.geom.tile=dv.geom.rect.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.tile}return t._dataPointStyleClass="tile-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},t.getValues=function(t){return t.values},t.enterPen=function(){var t=function(t){return t.panel.yScale(t).reverse()?1:0},e=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)};return this._decoratePen(e,n,t,t)},t.pen=function(){var t=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},n=function(t,e){var n=t.panel.yScale(t);return n.mapPropToPercent(t,e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)};return this._decoratePen(t,e,n,i)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e,n,i){var r=this,a=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=a.getBounds(t,e);return n&&(n.bounds.coord=r.coord()._type),n},pathTween:function(t,e,n){return r.pathTween(a,this,t,e,n)},path:function(t,e){return a.getPath(a.getBounds(t,e))}}},t}),dv.geom.bar=dv.geom.rect.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.bar,this._baseline=0}return t._dataPointStyleClass="bar-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.y=1,this._defaultAes.x=1},t._trainScales=function(){if(void 0!==this._baseline){var t=this.getExplicitScales("y").y;for(var e in t){var n=t[e];n instanceof dv.scale.continuous&&n.softLowerLimit(this._baseline)}}},t.getValues=function(t){return t.values},t.getBaseline=function(t){var e=t.domain()[0];return void 0!==self._baseline?self._baseline:0>e?0:e},t.enterPen=function(){var t,e,n=this,i=function(t,e){var i=t.panel.yScale(t);return i.mapValueToPercent(i.mapValue(n.getBaseline(i)),e)};return"dodge"===this.position()?(t=function(t,e){var i=t.panel.xScale(t);return i.mapValueToPercent(i.mapToProp(t,e)+n._dodgeAdjust(t),e)},e=function(t,e){var i=t.panel.xScale(t);return i.mapValueToPercent(i.mapToProp(t,e)+n._dodgeAdjust(t,!0),e)}):(t=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)}),this._decoratePen(t,e,i,i)},t.pen=function(){var t,e,n,i,r=this;switch(this.position()){case"identity":t=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},n=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(r.getBaseline(n)),e)},i=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};break;case"stack":t=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},n=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0),e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.y0+t.y),e)};break;case"dodge":t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+r._dodgeAdjust(t),e)},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+r._dodgeAdjust(t,!0),e)},n=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(r.getBaseline(n)),e)},i=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};break;case"fill":t=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},n=function(t){return t.y0},i=function(t){return t.y+t.y0}}return this._decoratePen(t,e,n,i)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))&&dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t._decoratePen=function(t,e,n,i){var r=this,a=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=a.getBounds(t,e);return n&&(n.bounds.coord=r.coord()._type),n},pathTween:function(t,e,n){return r.pathTween(a,this,t,e,n)},path:function(t,e){return a.getPath(a.getBounds(t,e))}}},t._dodgeAdjust=function(t,e){var n=t.dodge.groupIndex,i=t.dodge.numGroups,r=t.panel.xScale(t).rangeBand(),a=i>1?r/(i-1)*this._dodgePadding:0,s=(r-a*(i-1))/i;return(s+a)*n+(e?s:0)},t.baseline=function(t){return arguments.length?(this._baseline=t,this):this._baseline},t}),dv.geom.barrange=dv.geom.bar.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.barrange}return t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},t._trainScales=function(){var t,e,n=this.getExplicitScales("yMin").yMin;for(var i in n)this._aes.y||(this._aes.y={}),t=this._aes.y,e=t[i],e||(t[i]=e=n[i].copy().property("y").mapping("y")),e.trainingProperties(["yMin","yMax"])},t._render=function(t){var e=this.getExplicitScales(["yMin","yMax","y"]),n=e.yMin;for(var i in n){var r=n[i],a=e.yMax[i],s=e.y[i];a.range(s.range()).domain(s.domain()),r.range(s.range()).domain(s.domain())}this._super(t)},t.enterPen=function(){var t=function(t){return t.panel.yScale(t).reverse()?1:0},e=function(t,e){var n=t.panel.xScale(t);return n.mapPropToPercent(t,e)},n=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)};return this._decoratePen(e,n,t,t)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapPropToPercent(t,e)},e=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand(),e)},n=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMin,e),e)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMax,e),e)};return this._decoratePen(t,e,n,i)},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapToProp(t,e))&&dv.util.isFinite(i.mapValue(t.yMin,e))&&dv.util.isFinite(i.mapValue(t.yMax,e))},t._decoratePen=function(t,e,n,i){var r=this,a=this.coord()._rect().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){var n=a.getBounds(t,e);return n&&(n.bounds.coord=r.coord()._type),n},pathTween:function(t,e,n){return r.pathTween(a,this,t,e,n)},path:function(t,e){return a.getPath(a.getBounds(t,e))}}},t}),dv.geom.segment=dv.geom.line.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.segment}return t.getValues=function(t){return t.values},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};return this._decoratePen(t,e)},t}),dv.geom.vline=dv.geom.segment.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.vline}return t._dataPointStyleClass="vline-geom",t._render=function(t){var e=this;dv.util.each(this._nestData,function(t,n){var i=[];dv.util.each(t.values,function(t){var e=t.panel.xScale(t),n=t.panel.yScale(t),r=(n.domain(),t[e.property()]);if(dv.util.isArray(t))t[0].x=r,t[1].x=r;else{var a=[];t.x=r,a.push(t),a.push(dv.util.clone(t)),i.push(a)}}),e._nestData[n].values=i}),this._super(t)},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(){return 0};return this._decoratePen(t,e)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t,e){return 0===e?0:1};return this._decoratePen(t,e)},t._defined=function(t,e){return dv.util.isFinite(t.panel.xScale(t).mapToProp(t,e))},t}),dv.geom.hline=dv.geom.segment.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.hline}return t._dataPointStyleClass="hline-geom",t._render=function(t){var e=this;dv.util.each(this._nestData,function(t,n){var i=[];dv.util.each(t.values,function(t){var e=t.panel.xScale(t),n=t.panel.yScale(t),r=(e.domain(),t[n.property()]);if(dv.util.isArray(t))t[0].y=r,t[1].y=r;else{var a=[];t.y=r,a.push(t),a.push(dv.util.clone(t)),i.push(a)}}),e._nestData[n].values=i}),this._super(t)},t.enterPen=function(){var t=function(t,e){return 0===e?0:1},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e)},t.pen=function(){var t=function(t,e){return 0===e?0:1},e=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};return this._decoratePen(t,e)},t._defined=function(t,e){return dv.util.isFinite(t.panel.yScale(t).mapToProp(t,e))},t}),dv.geom.ribbon=dv.geom.area.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.ribbon}return t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},t._trainScales=function(){var t,e,n=this.getExplicitScales("yMin").yMin;for(var i in n)this._aes.y||(this._aes.y={}),t=this._aes.y,e=t[i],e||(t[i]=e=n[i].copy().property("y").mapping("y")),e.trainingProperties(["yMin","yMax"])},t._render=function(t){var e=this.getExplicitScales(["yMin","yMax","y"]),n=e.yMin;for(var i in n){var r=n[i],a=e.yMax[i],s=e.y[i];a.range(s.range()).domain(s.domain()),r.range(s.range()).domain(s.domain())}this._super(t)},t.enterPen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(t,e,e)},t.pen=function(){var t=function(t,e){var n=t.panel.xScale(t);return n.mapValueToPercent(n.mapToProp(t,e)+n.rangeBand()/2,e)},e=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMin,e))},n=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMax,e))};return this._decoratePen(t,e,n)},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapToProp(t,e))&&dv.util.isFinite(i.mapValue(t.yMin,e))&&dv.util.isFinite(i.mapValue(t.yMax,e))},t._decoratePen=function(t,e,n){var i=this,r=this.coord()._area().x(t).y0(e).y1(n).defined(this._defined);return r.renderer.tension(this.tension()).interpolate(this.interpolate()),{bounds:function(t,e){var n=r.getBounds(t,e);return n&&(n.coord=i.coord()),n},pathTween:function(t,e){return i.pathTween(r,this,t,e)},path:function(t,e){return r.getPath(r.getBounds(t,e))}}},t}),dv.geom.errorbar=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.errorbar,this._width=1}return t._dataPointStyleClass="errorbar-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.yMin=1,this._defaultAes.yMax=1,delete this._defaultAes.y},t._trainScales=function(){var t,e=this.getExplicitScales("yMin").yMin;for(var n in e)this._aes.y||(this._aes.y={}),yScales=this._aes.y,t=yScales[n],t||(yScales[n]=t=e[n].copy().property("y").mapping("y")),t.trainingProperties(["yMin","yMax"])},t.getValues=function(t){return t.values},t.width=function(t){return arguments.length?(this._width=t,this):this._width},t.attributes=function(t,e){var n=e.getScale("linetype");t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke").call(e.applyAttributeValue,e,"opacity","alpha").call(e.applyAttributeValue,e,"stroke-width","size").style("stroke-dasharray",function(t,e,i){return n?dv.util.svg.getDasharray(n.mapToProp(t[0],e,i)):null}).style("fill","none")},t._render=function(t){var e=this.getScale("x");if(!(e instanceof dv.scale.ordinal)){var n,i,r=Number.MAX_VALUE;dv.util.each(this._nestData,function(t){dv.util.each(t.values,function(t){n=t.panel.xScale(t).mapValue(t.x),dv.util.isUndefined(i)||(r=Math.min(r,Math.abs(n-i))),i=n})}),this._maxWidthPixels=r}var a=this.getExplicitScales(["yMin","yMax","y"]),s=a.yMin;for(var o in s){var l=s[o],c=a.yMax[o];yScale=a.y[o],c.range(yScale.range()).domain(yScale.domain()),l.range(yScale.range()).domain(yScale.domain())}this._super(t)},t.enterPen=function(){var t=this,e=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+t._offsetX(e),n)},n=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+t._offsetX(e,!0),n)},i=function(t){return t.panel.yScale(t).reverse()?1:0};return this._decoratePen(e,n,i,i)},t.pen=function(){var t=this,e=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+t._offsetX(e),n)},n=function(e,n){var i=e.panel.xScale(e);return i.mapValueToPercent(i.mapToProp(e,n)+t._offsetX(e,!0),n)},i=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMin,e))},r=function(t,e){var n=t.panel.yScale(t);return n.mapValueToPercent(n.mapValue(t.yMax,e))};return this._decoratePen(e,n,i,r)},t._isOrdinal=function(t){return t.panel.xScale(t)instanceof dv.scale.ordinal},t._offsetX=function(t,e){var n,i=t.panel.xScale(t);return n=i instanceof dv.scale.ordinal?i.rangeBand()/2+i.rangeBand()/2*(e?this._width:-this._width):this._maxWidthPixels*(e?this._width/2:-this._width/2)},t._defined=function(t,e){var n=t.panel.xScale(t),i=t.panel.yScale(t);return dv.util.isFinite(n.mapToProp(t,e))&&dv.util.isFinite(i.mapValue(t.yMin,e))&&dv.util.isFinite(i.mapValue(t.yMax,e))},t._decoratePen=function(t,e,n,i){var r=this,a=this.coord()._errorBar().x0(t).x1(e).y0(n).y1(i).defined(this._defined);return{bounds:function(t,e){return a.getBounds(t,e)},pathTween:function(t,e){return r.pathTween(a,this,t,e)},path:function(t,e){return a.getPath(a.getBounds(t,e))}}},t}),dv.geom.poly=dv.geom.extend(function(){function t(){this._super(),this._rendererClass=dv.geom.poly}return t._dataPointStyleClass="poly-geom",t._initializeDefaultAes=function(){this._super(),this._defaultAes.size=1,delete this._defaultAes.shape,delete this._defaultAes.x,delete this._defaultAes.y},t._trainScales=function(){var t,e=this.getExplicitScales(["yMin","xMin"]);for(t in e.yMin){var n=this._aes.y;n||(this._aes.y=n={}),n[t]||(n[t]=yMinScale.copy().property("y").mapping("y")),n[t].trainingProperties(["yMin","yMax"])}for(t in e.xMin){var i=this._aes.x;i||(this._aes.x=i={}),i[t]||(i[t]=xMinScale.copy().property("x").mapping("x")),i[t].trainingProperties(["xMin","xMax"])}},t.getValues=function(t){return t.values},t.attributes=function(t,e){e.getScale("fill"),e.getScale("stroke"),e.getScale("alpha"),t.attr("style","").classed(e._dataPointStyleClass,!0).call(e.applyAttributeValue,e,"stroke","stroke").call(e.applyAttributeValue,e,"fill","fill").call(e.applyAttributeValue,e,"opacity","alpha")},t.exitSeriesGroup=function(t,e){e.exitSeries(t,e.enterPen,e)},t.getHighlightColor=function(t,e){var n=this.getScale("fill"),i=this.getScale("stroke");return i instanceof dv.scale.constant?n instanceof dv.scale.constant?i.mapToProp(t,e):n.mapToProp(t,e):i.mapToProp(t,e)},t.enterPen=function(){var t=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},e=function(t){var e=t.panel.yScale(t);return dv.util.map(t[e.property()],function(){return e.reverse()?1:0})};return this._decoratePen(t,e)},t.pen=function(){var t=function(t,e){return t.panel.xScale(t).mapPropToPercent(t,e)},e=function(t,e){return t.panel.yScale(t).mapPropToPercent(t,e)};return this._decoratePen(t,e)},t._defined=function(t,e){for(var n=t.panel.xScale(t).mapToProp(t,e),i=t.panel.yScale(t).mapToProp(t,e),r=d3.max([n.length,i.length]),a=!0,s=0;r>s&&a;s++)a=dv.util.isFinite(n[s])&&dv.util.isFinite(i[s]);return a},t._decoratePen=function(t,e){var n=this,i=this.coord()._poly().xs(t).ys(e).defined(this._defined);return{bounds:function(t,e){return i.getBounds(t,e)},pathTween:function(t,e,r){return n.pathTween(i,this,t,e,r)},path:function(t,e){return i.getPath(i.getBounds(t,e))}}},t}),dv.behavior=dv.extend(function(){function t(){}var e;return t._testAndroidChromeBug141840=function(){if(void 0===e){var t=navigator.userAgent;e=null!==/Android .* Chrome\/18+/.exec(t)||null!==/Silk\/2./.exec(t)}return e},t}),dv.behavior.inspector=dv.behavior.extend(function(){function t(){this._size=void 0,this._lastX=0/0,this._visible=!1,this._inspector=null,this._thickness=3,this._orientation="bottom",this._currentValue=null,this._gutterPadding=-7,this._calloutPadding={left:8,top:7,right:8,bottom:7},this._label=this._defaultLabel(),this._underGeoms=!1,this._dragInspect=!0,this._pressTimer=null}function e(){var t=[],e=this._chart.getTrainedScale("x"),n=!1,i=function(t,i){return t=e._parse(t),i=e._parse(i),n&&t&&i?t.getTime()===i.getTime():t===i},r=function(t){return e.mapValue(t)},a=this._chart.data(),s=-1,o=this._chart._layers.length;for(a.length&&t.concat(a[e.property()]);o>++s;){var l=this._chart._layers[s],c=l.getTrainedScale("x"),u=l.data()[c.property()];u&&u!==a&&(t=t.concat(u)),n=n||c instanceof dv.scale.time||c instanceof dv.scale.time.utc}return t.length?dv.util.sortBy(dv.util.uniqueValues(t,i),r):t}function n(){this._chart.on("mousemove.inspector",dv.util.bind(s,this)),this._chart.on("mouseout.inspector",dv.util.bind(o,this)),this._chart.on("touchstart.inspector",dv.util.bind(r,this)),this._chart.on("touchmove.inspector",dv.util.bind(s,this)),this._chart.on("touchend.inspector",dv.util.bind(a,this))}function i(t,e,n){var i=0,r=0;if(this._lastX!==n){this._inspector.attr("opacity",1),this._inspector.select(".inspector-tip-label").text(e).each(function(){var t=this.getBBox();i=Math.max(t.width,i),r=Math.max(t.height,r)});var a,s=this._chart.facet().getPanel(0).bounds();i+=this._calloutPadding.left+this._calloutPadding.right,r+=this._calloutPadding.top+this._calloutPadding.bottom,a=n-i/2,s.left+this._gutterPadding>a&&(a=s.left+this._gutterPadding),a+i>s.right-this._gutterPadding&&(a=s.right-this._gutterPadding-i),this._inspector.select(".inspector-marker").attr("transform","translate("+a+",0)"),this._inspector.select(".inspector-tip-background").attr("width",i).attr("height",r);var o=n-a;this._inspector.select(".inspector-line-container").attr("transform","translate("+o+",0)")}}function r(t){if(t){var e=this;return this._dragInspect=!1,clearTimeout(this._pressTimer),this._pressTimer=setTimeout(function(){e._dragInspect=!0,s.call(e,t)},500),!1}}function a(t){clearTimeout(this._pressTimer),this._dragInspect&&(this._dragInspect=!1),o.call(this,t)}function s(t){if(t){if(!this._dragInspect)return clearTimeout(this._pressTimer),void 0;var e=t.touches?t.touches[0]:t,n=this._chart.getTrainedScale("x"),r=this._testAndroidChromeBug141840()?e.screenX:e.clientX,a=r-e.target.getBoundingClientRect().left+e.target.getBBox().x,s=dv.util.binaryCompare(this._domain,a,function(t){return n.mapValue(t)}),o=Math.min(Math.max(s||0,0),this._domain.length-1),l=this._domain[o],c=this._label.call(this,l,o),u=n.mapValue(l);this._currentValue!=l&&(this._inspectorMove&&this._inspectorMove.call(this,c,o,u,l),i.call(this,l,c,u)),this._currentValue=l,dv.cancelEvent(t)}}function o(t){this._inspector.attr("opacity",1e-6),this._inspectorOut&&this._inspectorOut.call(this),this._currentValue=null,dv.cancelEvent(t)}return t._render=function(t){this._domain=e.call(this);var n=this._chart.facet().getPanel(0)._bounds;void 0===this._size&&(this._size=n.bottom-n.top),this._xGuide=dv.util.clone(this._chart._axes._get("x")[0]),this._selection=t,this._inspector=t.selectAll(".inspector").data([0]),this._inspector.call(this._createInspector,this._orientation,n,this._calloutPadding,this._thickness)},t._createInspector=function(t,e,n,i,r){var a=t,s=t.enter();s=s.append("g").classed("inspector",!0),a.style("pointer-events","none").attr("opacity",1e-6).attr("transform","translate(0,"+n.top+")");var o=s.append("g").classed("inspector-marker",!0),l=o.append("g").classed("inspector-line-container",!0);l.append("path").classed("inspector-callout",!0),a.select(".inspector-callout").attr("d",function(){var t=-3,i=t+5;return"bottom"===e&&(t=n.bottom-n.top+2,i=t-5),"M-5,"+t+"L5,"+t+"L0,"+i+"Z"}),l.append("line").classed("inspector-line",!0),a.select(".inspector-line").attr("y1","bottom"===e?0:4).attr("y2","bottom"===e?n.bottom-n.top-6:n.bottom-n.top).style("stroke-width",r);var c=o.append("g").classed("inspector-tip",!0);a.select(".inspector-tip").attr("transform","translate(0,"+("bottom"===e?n.bottom-n.top+2:-30)+")"),c.append("rect").classed("inspector-tip-background",!0),c.append("text").classed("inspector-tip-label",!0),a.select(".inspector-tip-label").attr("x",i.left).attr("y","1em").attr("dy",i.top)},t.moveToIndex=function(t){var e=this._chart.getTrainedScale("x"),n=this._domain[t],r=this._label.call(this,n,t),a=e.mapValue(n);i.call(this,n,r,a)},t.hide=function(){return this._inspector.attr("opacity",1e-6),this._visible=!1,this},t.show=function(){return this._inspector.attr("opacity",1),this._visible=!0,this},t._removeEvents=function(){this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),this._chart.on("touchstart.inspector",null),this._chart.on("touchmove.inspector",null),this._chart.on("touchend.inspector",null)},t.inspectorMove=function(t){return arguments.length?(this._inspectorMove=t,this):this._inspectorMove},t.inspectorOut=function(t){return arguments.length?(this._inspectorOut=t,this):this._inspectorOut},t.label=function(t){return arguments.length?(this._label=d3.functor(t),this):this._label},t.thickness=function(t){return arguments.length?(this._thickness=t,this):this._thickness},t.size=function(t){return arguments.length?(this._size=t,this):this._size},t.chart=function(t){return arguments.length?(this._chart&&this._removeEvents(),this._chart=t,this._chart&&n.call(this),this):this._chart},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t._defaultLabel=function(){var t=this;return function(e){var n=t._xGuide.tickFormat?t._xGuide.tickFormat():function(t){return t};return n(e)}},t.label=function(t){return arguments.length?(this._label=d3.functor(t),this):this._label},t.underGeoms=function(t){return arguments.length?(this._underGeoms=t,this):this._underGeoms},t.gutterPadding=function(t){return arguments.length?(this._gutterPadding=t,this):this._gutterPadding},t}),dv.behavior.brush=dv.behavior.extend(function(){function t(t){arguments.length&&!dv.util.isArray(t)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=t||["x","y"],this._snap=!1,this._resizing=!1}return t.initializeBrush=function(t){var e=this;this._brush=dv.brush(t).on("brushstart.brush",function(){e._onBrushStart.call(e),e._brushStart&&e._brushStart.call(this,"start",e._brush.extent(),e)}).on("brush.brush",function(){e._onBrushMove.call(e),e._brushMove&&e._brushMove.call(this,"move",e._brush.extent(),e)}).on("brushend.brush",function(){e._onBrushEnd.call(e),e._brushEnd&&e._brushEnd.call(this,"end",e._brush.extent(),e)})},t._removeEvents=function(){this._brush.on("brushstart.brush",null).on("brush.brush",null).on("brushend.brush",null)},t._onBrushStart=function(){!this.snap()||this._fluidDimensions.length>1||(this._startPos=d3.mouse(this._brushContainer.node()),this._moving=d3.select(d3.event.sourceEvent.target).classed("extent"))},t._onBrushMove=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var t=d3.mouse(this._brushContainer.node());(this._startPos[0]!==t[0]||this._startPos[1]!==t[1])&&this._snapToDataPoints()}},t._onBrushEnd=function(){if(this.snap()&&!(this._fluidDimensions.length>1)){var t=d3.mouse(this._brushContainer.node());this._moving||this._startPos[0]!==t[0]||this._startPos[1]!==t[1]?this._brushContainer.selectAll(".resize").style("display",null):this.clear()}},t._snapToDataPoints=function(){var t=this._brush.extent(),e=[],n=this._chart.getTrainedScale(this._fluidDimensions[0]),i=[this._snapToNearestPoint(n,t[0],0),this._snapToNearestPoint(n,t[1],1)];this._brush.extent([i[0].value,i[1].value]);var r=this._chart.plotBounds();"x"===this._fluidDimensions?(e[0]=[i[0].rangeValue,0],e[1]=[i[1].rangeValue,r.bottom-r.top]):(e[0]=[0,i[0].rangeValue],e[1]=[r.right-r.left,i[1].rangeValue]),this._adjustBounds(this._brushContainer,e)},t._snapToNearestPoint=function(t,e,n){var i,r={};if(t instanceof dv.scale.ordinal||t instanceof dv.scale.identity){var a=dv.util.scaleRangeNoReverse(t),s=a[1]-a[0];domain=t.domain(),i=Math.round(t.invertValue(e)/s-1)}else domain=dv.util.uniq(this._chart.data()[t.mapping()]),index=dv.util.binaryCompare(domain,e,function(t){return t}),i=Math.min(Math.max(index||0,0),domain.length-1);var o=domain[i];if(r.value=o,0===n)if(0===i)r.rangeValue=t.mapValue(o);else{var l=domain[i-1],c=t.mapValue(l);valueRange=t.mapValue(o),r.rangeValue=valueRange-(valueRange-c)/2}else if(i===domain.length-1)r.rangeValue=t.mapValue(o);else{var u=domain[i+1],d=t.mapValue(u);valueRange=t.mapValue(o),r.rangeValue=valueRange+(d-valueRange)/2}return r},t._adjustBounds=function(t,e){"x"===this._fluidDimensions&&this._adjustBoundsX(t,e),"y"===this._fluidDimensions&&this._adjustBoundsY(t,e),t.selectAll(".resize").attr("transform",function(t){return"translate("+e[+/e$/.test(t)][0]+","+e[+/^s/.test(t)][1]+")"})},t._adjustBoundsX=function(t,e){t.select(".extent").attr("x",e[0][0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",e[1][0]-e[0][0])},t._adjustBoundsY=function(t,e){t.select(".extent").attr("y",e[0][1]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",e[1][1]-e[0][1])},t._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var t=this._chart.getTrainedScale("x");this._brush.x(t._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var e=this._chart.getTrainedScale("y");this._brush.y(e._d3Scale)}},t._render=function(){this._brushContainer=this._chart._parent.select(".interaction-group"),this._brush.empty()&&this._brushContainer.classed("brush",!0).call(this._brush);var t=this._chart.plotBounds();if(!this._brush.y()){var e=t.bottom-t.top;this._brushContainer.selectAll(".extent").attr("height",e).attr("y",0),this._brushContainer.selectAll(".resize rect").attr("height",e).attr("y",0)}if(!this._brush.x()){var n=t.right-t.left;this._brushContainer.selectAll(".extent").attr("width",n).attr("x",0),this._brushContainer.selectAll(".resize rect").attr("width",n).attr("x",0)}},t.empty=function(){return this._brush.empty()},t.clear=function(){this._brushContainer.call(this._brush.clear())},t.extent=function(t){return arguments.length?(this._brushContainer.call(this._brush.extent(t)),this):this._brush?this._brush.extent():null},t.snap=function(t){return arguments.length?(this._snap=this._fluidDimensions.length>1?!1:t,this):this._snap},t.brushStart=function(t){return arguments.length?(this._brushStart=t,this):this._brushStart},t.brushMove=function(t){return arguments.length?(this._brushMove=t,this):this._brushMove},t.brushEnd=function(t){return arguments.length?(this._brushEnd=t,this):this._brushEnd},t.chart=function(t){return arguments.length?(this._chart=t,this.initializeBrush(this._chart),this._chart&&this._setScales(),this):this._chart},t}),dv.brush=function(t){function e(s){s.each(function(){var s,o=d3.select(this),d=o.selectAll(".background").data([0]),h=o.selectAll(".extent").data([0]),p=o.selectAll(".resize").data(u,String);t.on("mousedown.brush",a).on("touchstart.brush",a)._g.style("cursor","crosshair"),o.style("pointer-events","all"),h.enter().append("rect").attr("class","extent").style("cursor","move"),p.enter().append("g").attr("class",function(t){return"resize "+t}).style("cursor",function(t){return K[t]}).append("rect").attr("x",function(t){return/[e]$/.test(t)?-10:/[w]$/.test(t)?2:null}).attr("y",function(t){return/^[ns]/.test(t)?-3:null}).attr("width",10).attr("height",6).style("visibility","hidden"),p.style("display",e.empty()?"none":null),p.exit().remove(),l&&(s=dv.util.scaleRangeNoReverse(l),d.attr("x",s[0]).attr("width",s[1]-s[0]),i(o)),c&&(s=dv.util.scaleRangeNoReverse(c),d.attr("y",s[0]).attr("height",s[1]-s[0]),r(o)),n(o)})}function n(t){t.selectAll(".resize").attr("transform",function(t){return"translate("+d[+/e$/.test(t)][0]+","+d[+/^s/.test(t)][1]+")"})}function i(t){t.select(".extent").attr("x",d[0][0]),t.selectAll(".extent,.n>rect,.s>rect").attr("width",d[1][0]-d[0][0])}function r(t){t.select(".extent").attr("y",d[0][1]),t.selectAll(".extent,.e>rect,.w>rect").attr("height",d[1][1]-d[0][1])}function a(){function t(){var t=d3.event.changedTouches;return t?d3.touches(m,t)[0]:d3.mouse(m)}function a(){32==d3.event.keyCode&&(S||(g=null,M[0]-=d[1][0],M[1]-=d[1][1],S=2),D())}function u(){32==d3.event.keyCode&&2==S&&(M[0]+=d[1][0],M[1]+=d[1][1],S=0,D())}function h(){var e=t(),a=!1;_&&(e[0]+=_[0],e[1]+=_[1]),S||(d3.event.altKey?(g||(g=[(d[0][0]+d[1][0])/2,(d[0][1]+d[1][1])/2]),M[0]=d[+(e[0]<g[0])][0],M[1]=d[+(e[1]<g[1])][1]):g=null),A&&p(e,l,0)&&(i(x),a=!0),k&&p(e,c,1)&&(r(x),a=!0),a&&(n(x),y({type:"brush",mode:S?"move":"resize"}))}function p(t,e,n){var i,r,a=dv.util.scaleRangeNoReverse(e),o=a[0],l=a[1],c=M[n],u=d[1][n]-d[0][n];return S&&(o-=c,l-=u+c),i=Math.max(o,Math.min(l,t[n])),S?r=(i+=c)+u:(g&&(c=Math.max(o,Math.min(l,2*g[n]-i))),i>c?(r=i,i=c):r=c),d[0][n]!==i||d[1][n]!==r?(s=null,d[0][n]=i,d[1][n]=r,!0):void 0}function f(){h(),x.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),d3.select("body").style("cursor",null),P.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),y({type:"brushend"}),D()}var g,_,m=this,v=d3.select(d3.event.target),y=o.of(m,arguments),x=d3.select(m),b=v.datum(),A=!/^(n|s)$/.test(b)&&l,k=!/^(e|w)$/.test(b)&&c,S=v.classed("extent"),M=t(),P=d3.select(window).on("mousemove.brush",h).on("mouseup.brush",f).on("touchmove.brush",h).on("touchend.brush",f).on("keydown.brush",a).on("keyup.brush",u);if(S)M[0]=d[0][0]-M[0],M[1]=d[0][1]-M[1];else if(!b||"e"!==b&&"w"!==b&&"s"!==b&&"n"!==b&&"nw"!==b&&"ne"!==b&&"sw"!==b&&"se"!==b)d3.event.altKey&&(g=M.slice());else{var w=+/w$/.test(b),O=+/^n/.test(b);_=[d[1-w][0]-M[0],d[1-O][1]-M[1]],M[0]=d[w][0],M[1]=d[O][1]}x.style("pointer-events","none").selectAll(".resize").style("display",null),d3.select("body").style("cursor",v.style("cursor")),y({type:"brushstart"}),h(),D()}var s,o=N(e,"brushstart","brush","brushend"),l=null,c=null,u=$[0],d=[[0,0],[0,0]];return e.x=function(t){return arguments.length?(l=t,u=$[!l<<1|!c],e):l},e.y=function(t){return arguments.length?(c=t,u=$[!l<<1|!c],e):c},e.extent=function(t){var n,i,r,a,o;return arguments.length?(s=[[0,0],[0,0]],l&&(n=t[0],i=t[1],c&&(n=n[0],i=i[0]),s[0][0]=n,s[1][0]=i,l.invert&&(n=l(n),i=l(i)),n>i&&(o=n,n=i,i=o),d[0][0]=0|n,d[1][0]=0|i),c&&(r=t[0],a=t[1],l&&(r=r[1],a=a[1]),s[0][1]=r,s[1][1]=a,c.invert&&(r=c(r),a=c(a)),r>a&&(o=r,r=a,a=o),d[0][1]=0|r,d[1][1]=0|a),e):(t=s||d,l&&(n=t[0][0],i=t[1][0],s||(n=d[0][0],i=d[1][0],l.invert&&(n=l.invert(n),i=l.invert(i)),n>i&&(o=n,n=i,i=o))),c&&(r=t[0][1],a=t[1][1],s||(r=d[0][1],a=d[1][1],c.invert&&(r=c.invert(r),a=c.invert(a)),r>a&&(o=r,r=a,a=o))),l&&c?[[n,r],[i,a]]:l?[n,i]:c&&[r,a])},e.clear=function(){return s=null,d[0][0]=d[0][1]=d[1][0]=d[1][1]=0,e},e.empty=function(){return l&&d[0][0]===d[1][0]||c&&d[0][1]===d[1][1]},d3.rebind(e,o,"on")};var K={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},$=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];C.prototype.on=function(t,e){var n=t.indexOf("."),i="";return n>0&&(i=t.substring(n+1),t=t.substring(0,n)),2>arguments.length?this[t].on(i):this[t].on(i,e)},dv.behavior.zoom=dv.behavior.extend(function(){function t(t){arguments.length&&!dv.util.isArray(t)&&(this._dimensions=[this._dimensions]),this._fluidDimensions=t||["x","y"],this._zoom=d3.behavior.zoom(),this.scaleExtent([0,1/0]),this._underGeoms=!1
}return t.initializeZoom=function(){var t=this;this._cacheAxes(),this._zoom.on("zoomstart.zoom",function(){t._zoomStart&&t._zoomStart.call(this,"start",d3.event.scale,d3.event.translate,t)}).on("zoom.zoom",function(){t._zoomMove&&t._zoomMove.call(this,"move",d3.event.scale,d3.event.translate,t),t._refresh(d3.event.scale,d3.event.translate)}).on("zoomend.zoom",function(){t._zoomEnd&&t._zoomEnd.call(this,"end",d3.event.scale,d3.event.translate,t)})},t.underGeoms=function(t){return arguments.length?(this._underGeoms=t,this):this._underGeoms},t._cacheAxes=function(){this._axisCache={};for(var t in this._chart._axes._axes)this._axisCache[t]=this._chart._axes._axes[t]},t._removeEvents=function(){this._zoom.on("zoomstart.zoom",null).on("zoom.zoom",null).on("zoomend.zoom",null)},t._refresh=function(t,e){var n=this,i=[0,this._bounds.width-this._bounds.width*t],r=[0,this._bounds.height-this._bounds.height*t];t>=1?(e[0]=Math.min(i[0],Math.max(e[0],i[1])),e[1]=Math.min(r[0],Math.max(e[1],r[1]))):(e[0]=e[0]<i[0]?i[0]:e[0]>i[1]?i[1]:e[0],e[1]=e[1]<r[0]?r[0]:e[1]>r[1]?r[1]:e[1]),this._zoom.translate(e),setTimeout(function(){n._chart._axes._axes=n._axisCache,n._chart.duration(0),n._chart._finalizePlotBounds(),n._chart._facet._render()},0)},t._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var t=this._chart.getTrainedScale("x");this._zoom.x(t._d3Scale)}if(this._fluidDimensions.indexOf("y")>=0){var e=this._chart.getTrainedScale("y");this._zoom.y(e._d3Scale)}},t._render=function(t){this._zoomContainer=t.selectAll(".zoom-container").data([0]),this._zoomContainer.enter().append("g").classed("zoom-container");var e=this._zoomContainer.selectAll(".zoom-pane").data([0]);e.enter().append("rect").classed("zoom-pane",!0);var n=this._chart.facet().getPanel(0),i=n.bounds();e.attr("x",i.left).attr("y",i.top).attr("width",i.width).attr("height",i.height).call(this._zoom),this._bounds=i},t.scale=function(t){return arguments.length?(this._zoom.scale(t),this._refresh(t,this._zoom.translate()),this):this._zoom.scale()},t.scaleExtent=function(t){return arguments.length?(this._zoom.scaleExtent(t),this):this._zoom.scaleExtent()},t.translate=function(t){return arguments.length?(this._zoom.translate(t),this._refresh(this._zoom.scale(),t),this):this._zoom.translate()},t.zoomStart=function(t){return arguments.length?(this._zoomStart=t,this):this._zoomStart},t.zoomMove=function(t){return arguments.length?(this._zoomMove=t,this):this._zoomMove},t.zoomEnd=function(t){return arguments.length?(this._zoomEnd=t,this):this._zoomEnd},t.chart=function(t){return arguments.length?(this._chart=t,this.initializeZoom(this._chart),this._chart&&(this._setScales(),this._chart.clipPlot(!0)),this):this._chart},t}),dv.behavior.rollover=dv.behavior.extend(function(){function t(){this._selection=null,this._showTooltip=this._defaultShowTooltip,this._hideTooltip=this._defaultHideTooltip,this._orientation="right",this._tooltipPadding=10,this._content=this._defaultContent,this._lastSelectedTarget=null,this._timer=null,this._pressTimer=null,this._dragInspect=!0}return t._render=function(t){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=t,this._addEvents()},t._addEvents=function(){var t=this;this.__geom.on("mouseover.rollover",function(e,n,i){return t._onMouseOver.call(this,e,n,i,t)}).on("mouseout.rollover",function(e,n,i){return t._onMouseOut.call(this,e,n,i,t)}),this.__geom._chart.on("tap.rollover",function(){return t._onTap.call(t,d3.event)}).on("touchstart.rollover",function(){return t._onTouchStart.call(t,d3.event)}).on("touchmove.rollover",function(){return t._onTouchMove.call(t,d3.event)}).on("touchend.rollover",function(){return t._onTouchEnd.call(t,d3.event)})},t._removeEvents=function(){this.__geom.on("mouseover.rollover",null).on("mouseout.rollover",null),this.__geom._chart.on("tap.rollover",null).on("touchstart.rollover",null).on("touchmove.rollover",null).on("touchend.rollover",null)},t._getElementMetadata=function(t,e){var n={d:e.datum(),i:0,j:0};return t._geomGroup.selectAll(".series ."+t._dataPointStyleClass).each(function(t,e,i){n.d===t&&(n.i=e,n.j=i)}),n},t._defaultShowTooltip=function(t,e,n,i,r){r._darkenGeom.call(this,t,r),r._showTip.call(this,t,e,n,r)},t._defaultHideTooltip=function(t,e,n,i,r){r._brightenGeom.call(this,t,r),r._removeTip.call(this,t,e,n,r)},t._darkenGeom=function(t,e){var n=d3.select(this),i=function(t,n,i){if(n[t]){var r=e.__geom.getScale(t).mapValue(n[t]);i.style(t,""+d3.rgb(r).darker(1))}};i("fill",t,n),i("stroke",t,n)},t._brightenGeom=function(t,e){var n=d3.select(this),i=function(t,n,i){if(n[t]){var r=e.__geom.getScale(t).mapValue(n[t]);i.style(t,r)}};i("fill",t,n),i("stroke",t,n)},t._showTip=function(t,e,n,i){var r=i.__geom.chart()._chartContainer,a=this.getBBox(),s=dv.absoluteCoordinates(i.__geom.chart(),[a.x,a.y],t.panel),o={height:a.height,width:a.width,x:s[0],y:s[1]};dv.showTooltip(o,r.select(".plot").node().getBBox(),i.content().call(i,t,e,n),i._orientation,i._tooltipPadding,r)},t._removeTip=function(t,e,n,i){dv.removeTooltip(i.__geom.chart()._chartContainer)},t._defaultContent=function(t){var e=this.__geom.getExplicitScale("group"),n=t[0]?t[0]:t,i=n.panel.xScale(n),r=n.panel.yScale(n),a=this._xGuides[i.scaleIndex()],s=this._yGuides[r.scaleIndex()],o=a.__scale&&a.tickFormat()?a.tickFormat():String,l=s.__scale&&s.tickFormat()?s.tickFormat():String,c='<span class="metric-value">'+l(n.data[r.mapping()])+'</span><span class="metric-name">'+r.mapping()+"</span>"+'<span class="metric-value">'+o(n.data[i.mapping()])+'</span><span class="metric-name">'+i.mapping()+"</span>";return e&&e.mapping()&&(c='<span class="series-name">'+n.data[e.mapping()]+"</span>"+c),c},t._onMouseOver=function(t,e,n,i){i._showTooltip.call(this,t,e,n,d3.event,i),this._mouseOver&&this._mouseOver.call(this,t,e,n,d3.event)},t._onMouseOut=function(t,e,n,i){i._hideTooltip.call(this,t,e,n,d3.event,i),i._mouseOut&&i._mouseOut.call(this,t,e,n,d3.event)},t._onTap=function(t){this._dragInspect=!0,this._onTouchMove.call(this,t),this._onTouchEnd.call(this,t)},t._onTouchStart=function(t){var e=this;return this._lastSelectedTarget&&(clearTimeout(e._timer),this._onTouchEnd.call(this,t,0)),this._dragInspect=!1,clearTimeout(this._pressTimer),this._pressTimer=setTimeout(function(){e._dragInspect=!0,e._onTouchMove.call(e,t)},500),!1},t._onTouchMove=function(t){if(!this._dragInspect)return clearTimeout(this._pressTimer),void 0;var e=t.touches?t.touches[0]:t,n=d3.select(this._elementFromPoint(e)),i=this._lastSelectedTarget&&this._lastSelectedTarget.node()===n.node();if(!n.empty()&&n.classed(this.__geom._dataPointStyleClass)){if(this._lastSelectedTarget&&!i){var r=this._lastSelectedTarget.datum();this._brightenGeom.call(this._lastSelectedTarget.node(),r,this)}if(!i){var a=this._getElementMetadata(this.__geom,n);this._showTooltip.call(n.node(),a.d,a.i,a.j,t,this),this._mouseOver&&this._mouseOver.call(n.node(),a.d,a.i,a.j,t),this._lastSelectedTarget=n}}dv.cancelEvent(t)},t._onTouchEnd=function(t,e){var n=this;if(clearTimeout(this._pressTimer),this._dragInspect=!1,t.touches?t.touches[0]:t,2>arguments.length&&(e=500),this._lastSelectedTarget){var i=function(){if(n._lastSelectedTarget){var e=n._getElementMetadata(n.__geom,n._lastSelectedTarget);n._hideTooltip.call(n._lastSelectedTarget.node(),e.d,e.i,e.j,t,n),n._mouseOut&&n._mouseOut.call(n._lastSelectedTarget.node(),e.d,e.i,e.j,t),n._lastSelectedTarget=null}};e?timer=setTimeout(i,e):i.call(this)}dv.cancelEvent(t)},t._elementFromPoint=function(t){var e=[t.clientX,t.clientY];return this._testAndroidChromeBug141840()&&(e=[t.screenX,t.screenY]),document.elementFromPoint(e[0],e[1])},t.content=function(t){return arguments.length?(this._content=d3.functor(t),this):this._content},t.tooltipPadding=function(t){return arguments.length?(this._tooltipPadding=t,this):this._tooltipPadding},t.orientation=function(t){return arguments.length?(this._orientation=t,this):this._orientation},t.mouseOver=function(t){return arguments.length?(this._mouseOver=t,this):this._mouseOver},t.mouseOut=function(t){return arguments.length?(this._mouseOut=t,this):this._mouseOut},t.showTooltip=function(t){return arguments.length?(this._showTooltip=t,this):this._showTooltip},t.hideTooltip=function(t){return arguments.length?(this._hideTooltip=t,this):this._hideTooltip},t._geom=function(t){return arguments.length?(this.__geom&&this.__geom!==t&&this._removeEvents(),this.__geom=t,this):this.__geom},t}),dv.behavior.voronoiRollover=dv.behavior.rollover.extend(function(){function t(){this._super(),this._voronoiContainer=null,this._points=null,this._pointDetectionRadius=20,this._numHitAreaVertices=12,this._isPolar=!1}return t._render=function(t){this._xGuides=this.__geom._chart._axes._get("x"),this._yGuides=this.__geom._chart._axes._get("y"),this._isPolar=this.__geom.coord()instanceof dv.coord.polar,this._selection=t,this._createTooltipContainer(),this._renderPolygons(this._getPolygonData(),t),this._addEvents()},t._addEvents=function(){var t=this;this.__geom._chart.on("tap.rollover",function(){return t._onTap.call(t,d3.event)}).on("touchstart.rollover",function(){return t._onTouchStart.call(t,d3.event)}).on("touchmove.rollover",function(){return t._onTouchMove.call(t,d3.event)}).on("touchend.rollover",function(){return t._onTouchEnd.call(t,d3.event)})},t._removeEvents=function(){this.__geom._chart.on("tap.rollover",null).on("touchstart.rollover",null).on("touchmove.rollover",null).on("touchend.rollover",null)},t._createTooltipContainer=function(){this._voronoiContainer=this._selection.selectAll(".voronoiSelection-container").data([this]),this._voronoiContainer.enter().append("g").classed("voronoiSelection-container",!0)},t._getPolygonData=function(){var t=[],e=(this.__geom._nestData,this);this._points=[];var n=e.__geom.coord()._point().x(function(t){return t.x}).y(function(t){return t.y}).defined(function(){return!0});return dv.util.each(this.__geom._nestData,function(i,r){dv.util.each(i.values,function(i,a){var s={},o=i[0]?i[0]:i,l=o.panel.xScale(o),c=o.panel.yScale(o);s.x=l.mapValueToPercent(l.mapToProp(o,a)+l.rangeBand()/2,a)||0,s.y=c.mapValueToPercent(c.mapValue(o.hasOwnProperty("y0")?o.y+o.y0:o.y),a)||0,s.panel=o.panel;var u=n.getBounds(s,a);if(e._isPolar){var d=e.__geom.coord()._transformAngleRadiusToXY(u.bounds.x,u.bounds.y);range.bounds.x=d[0],range.bounds.y=d[1]}e._points.push({data:u,rawData:o,seriesIndex:r,index:a}),t.push([u.bounds.x,u.bounds.y])})}),d3.geom.voronoi(t)},t._renderPolygons=function(t,e){var n=this,i=(this.__geom._nestData.length,this.__geom._nestData[0].values.length,d3.select(e.node().parentNode),0),r=0;if(this._isPolar){var a=this.__geom._nestData[0].values[0].panel,s=dv.util.scaleRangeNoReverse(a.xOuterScale()),o=dv.util.scaleRangeNoReverse(a.yOuterScale());i=(s[0]+s[1])/2,r=(o[0]+o[1])/2}this._voronoiContainer.attr("transform","translate("+i+","+r+")");var l=this._voronoiContainer.selectAll("path").data(t);l.exit().remove(),l.enter().append("path").attr("id",function(t,e){return"path-"+e}).classed("voronoi-overlay",!0),l.attr("d",function(t,e){return n._getPolygonPath(t,e,n)}).on("mouseover.rollover",function(t,e,i){return n._onMouseOver.call(this,t.data,e,i,n)}).on("mouseout.rollover",function(t,e,i){return n._onMouseOut.call(this,t.data,e,i,n)}).call(this._removeRegisteredEvents,this).call(this._addRegisteredEvents,this),l.exit().on("mouseover.rollover",null).on("mouseout.rollover",null).remove()},t._addRegisteredEvents=function(t,e){e||(e=this),e.__geom&&(t=t||e._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(e.__geom.eventMap,function(n,i){t.on(i,function(t,n){e.__geom.eventMap[i].callback.call(this,t,n,d3.event)},n.capture)}),dv.util.each(e.__geom._chart.eventMap,function(n,i){t.on(i+".dvchart",function(){var t=d3.event,n=e.__geom._chart._interactionGroup.node();e._shouldDispatchChartEvent(t,n)&&e.__geom._chart.eventMap[i].callback.call(n,t)},n.capture)}))},t._removeRegisteredEvents=function(t,e){e||(e=this),e.__geom&&(t=t||e._voronoiContainer.selectAll(".voronoi-overlay"),dv.util.each(e.unregisterEventMap,function(e,n){t.on(n,null,e)}),dv.util.each(e.__geom._chart.unregisterEventMap,function(e,n){t.on(n+".dvchart",null,e)}))},t._shouldDispatchChartEvent=function(t,e){var n=!0;if("mouseout"===t.type||"mouseover"===t.type){var i=t.relatedTarget;i||(i="mouseout"===t.type?t.toElement:t.fromElement);var r=d3.select(i);r&&!r.empty()&&(r.attr("class"),n=!(r.node()===e||r.classed("voronoi-overlay")))}return n},t._getPolygonPath=function(t,e,n){if(!t)return null;t.data=n._points[e];var i=(dv.util.clone(t),n._points[e]),r=d3.geom.polygon(n._getPolygonPoints(i.data.bounds.x,i.data.bounds.y)),a=r.clip(t);return a.length?"M"+a.join("L")+"Z":null},t._getPolygonPoints=function(t,e){for(var n=[],i=360;i>0;i-=360/this._numHitAreaVertices){var r=i*Math.PI/180,a=Math.cos(r)*this._pointDetectionRadius+t,s=Math.sin(r)*this._pointDetectionRadius+e;n.push([a,s])}return n},t._defaultShowTooltip=function(t,e,n,i,r){r._showPoint.call(this,t,e,n,r),r._showTip.call(this,t,e,n,r)},t._defaultHideTooltip=function(t,e,n,i,r){r._removePoint.call(this,t,e,n,r),r._removeTip.call(this,t,e,n,r)},t._showPoint=function(t,e,n,i){var r=10,a=t.rawData,s=i.getGeomFromVoronoiIndex.call(i,a,e,n);if(!s.empty()){var o=s.node().getBoundingClientRect(),l={height:o.height,width:o.width,x:o.x,y:o.y};r=Math.max(l.height,l.width)/2+2.5}i._voronoiContainer.append("circle").classed("hover-point",!0).attr("id","point-"+n+"-"+e).attr("cx",t.data.bounds.x).attr("cy",t.data.bounds.y).attr("r",0).style("stroke",function(){return i.__geom.getHighlightColor(t.rawData,e)}).style("pointer-events","none").transition().duration(350).attr("r",r)},t._removePoint=function(t,e,n,i){i._voronoiContainer.selectAll("#point-"+n+"-"+e).transition().duration(350).attr("r",0).remove()},t._showTip=function(t,e,n,i){var r,a=i.__geom.chart()._chartContainer,s=t.data,o=t.rawData,l=i.getGeomFromVoronoiIndex.call(i,o,e,n);if(l.empty()){var c=dv.absoluteCoordinates(i.__geom.chart(),[s.bounds.x,s.bounds.y],o.panel),u=10,d=10;r={height:u,width:d,y:c[1]-u/2,x:c[0]-d/2}}else{var h=l.node().getBBox();r={height:h.height,width:h.width,x:h.x,y:h.y}}dv.showTooltip(r,a.select(".panels").node().getBBox(),i.content().call(i,o,e,n),i._orientation,i._tooltipPadding,a)},t.getGeomFromVoronoiIndex=function(t,e,n){return this.__geom.chart()._g.selectAll(".datum-"+e+".series-"+n).filter(function(e){return t===e})},t._onMouseOver=function(t,e,n,i){i._showTooltip.call(this,t,t.index,t.seriesIndex,d3.event,i),i._mouseOver&&i._mouseOver.call(this,t.rawData,t.index,t.seriesIndex,d3.event)},t._onMouseOut=function(t,e,n,i){i._hideTooltip.call(this,t,t.index,t.seriesIndex,d3.event,i),i._mouseOut&&i._mouseOut.call(this,t.rawData,t.index,t.seriesIndex,d3.event)},t._onTouchMove=function(t){if(!this._dragInspect)return clearTimeout(this._pressTimer),void 0;var e=t.touches?t.touches[0]:t,n=d3.select(this._elementFromPoint(e)),i=this._lastSelectedTarget&&this._lastSelectedTarget.node()===n.node();if(!n.empty()&&n.classed("voronoi-overlay")){if(this._lastSelectedTarget&&!i){var r=this._lastSelectedTarget.datum().data;this._removePoint.call(n.node(),r.rawData,r.index,r.seriesIndex,this)}if(!i){var a=n.datum().data;this._showTooltip.call(n.node(),a,a.index,a.seriesIndex,t,this),this._mouseOver&&this._mouseOver.call(n.node(),a.rawData,a.index,a.seriesIndex,t),this._lastSelectedTarget=n}}dv.cancelEvent(t)},t._onTouchEnd=function(t,e){var n=this;if(clearTimeout(this._pressTimer),this._dragInspect&&(this._dragInspect=!1),2>arguments.length&&(e=500),this._lastSelectedTarget){var i=function(){if(n._lastSelectedTarget){var e=n._lastSelectedTarget.datum().data;n._hideTooltip.call(n._lastSelectedTarget.node(),e,e.index,e.seriesIndex,t,n),n._mouseOut&&n._mouseOut.call(n._lastSelectedTarget.node(),e.rawData,e.index,e.seriesIndex,t),n._lastSelectedTarget=null}};e?timer=setTimeout(i,e):i.call(this)}dv.cancelEvent(t)},t.pointDetectionRadius=function(t){return arguments.length?(this._pointDetectionRadius=t,this):this._pointDetectionRadius},t.numHitAreaVertices=function(t){return arguments.length?(this._numHitAreaVertices=t,this):this._numHitAreaVertices},t}),dv.log=dv.log||{},dv.log.NOCONSOLE=!1,dv.log.LVL_ERROR=0,dv.log.ERROR="error",dv.log.LVL_WARN=1,dv.log.WARN="warn",dv.log.LVL_DEBUG=2,dv.log.DEBUG="debug",dv.log.LOGLEVEL=dv.log.LVL_DEBUG,dv.log.error=function(t){return dv.log._message(dv.log.ERROR,t)},dv.log.warn=function(t){return dv.log._message(dv.log.WARN,t)},dv.log.debug=function(t){return dv.log._message(dv.log.DEBUG,t)},dv.log.noConsole=function(t){dv.log.NOCONSOLE=t||!1,dv.log.console=window.console||dv.util.noop,(!dv.log.console.log||dv.log.NOCONSOLE)&&(dv.log.console.log=dv.util.noop),(!dv.log.console.error||dv.log.NOCONSOLE)&&(dv.log.console.error=dv.log.console.log),(!dv.log.console.warn||dv.log.NOCONSOLE)&&(dv.log.console.warn=dv.log.console.log),(!dv.log.console.debug||dv.log.NOCONSOLE)&&(dv.log.console.debug=dv.log.console.log)},dv.log._message=function(t,e){if(dv.log._isValidType(t)){if(dv.log.LOGLEVEL>=dv.log["LVL_"+t.toUpperCase()]&&dv.log.console[t](e.msg,e.data),t===dv.log.ERROR)throw e.msg+" Context Data: "+JSON.stringify(e.data)}else dv.log.console.log("Logging message with invalid type: "+t)},dv.log._isValidType=function(t){return t===dv.log.ERROR||t===dv.log.WARN||t===dv.log.DEBUG},dv.log.noConsole(!1),dv.panel=dv.extend(function(){function t(){this._margins={left:0,top:0,right:0,bottom:0},this._trainedScales={}}return t.getTrainedScale=function(t){return"x"===t?this.xScale():"y"===t?this.yScale():this._trainedScales[t]},t.getOuterScale=function(t){return"x"===t?this._xScale:"y"===t?this._yScale:null},t._updateRanges=function(t){var e=[t.left,t.right],n=[t.bottom,t.top];this._facet._chart.coord().flip()?(this._xScale.range(n),this._yScale.range(e)):(this._xScale.range(e),this._yScale.range(n))},t.bounds=function(t){return arguments.length?(this._bounds=t,this._updateRanges(this._bounds),this):this._bounds},t.margins=function(t){return arguments.length?(this._margins=t,this):this._margins},t.visibleAxisLabelOrientations=function(t){return arguments.length?(this._visibleAxisLabelOrientations=t,this):this._visibleAxisLabelOrientations},t.columnIndex=function(t){return arguments.length?(this._columnIndex=t,this):this._columnIndex},t.rowIndex=function(t){return arguments.length?(this._rowIndex=t,this):this._rowIndex},t.facetIndex=function(t){return arguments.length?(this._facetIndex=t,this):this._facetIndex},t.facetKey=function(t){return arguments.length?(this._facetKey=t,this):this._facetKey},t.xFacetTitle=function(t){return arguments.length?(this._xFacetTitle=t,this):this._xFacetTitle},t.yFacetTitle=function(t){return arguments.length?(this._yFacetTitle=t,this):this._yFacetTitle},t.xOuterScale=function(t){return arguments.length?(this._xScale=t,this):this._xScale},t.yOuterScale=function(t){return arguments.length?(this._yScale=t,this):this._yScale},t.xScale=function(t){var e=0;return t&&t.hasOwnProperty("x-index")&&(e=t["x-index"]),this._xScale.innerScaleGroup()[e]},t.yScale=function(t){var e=0;return t&&t.hasOwnProperty("y-index")&&(e=t["y-index"]),this._yScale.innerScaleGroup()[e]},t.facet=function(t){return arguments.length?(this._facet=t,this._trainedScales={},this):this._facet},t}),dv.facet=dv.extend(function(){function t(){this._numColumns=0,this._numRows=0,this._hGap=10,this._vGap=10}return t._prerender=function(){var t=this;this._trainedScales={},this._panels=[],this._rows=[],this._columns=[],this._panelsWithAxisLabels=[],dv.util.each(t._chart._layers,function(e){e._prerender(t._chart),t._trainFacetGroups(e)}),this._configureFacets(),dv.util.each(t._chart._layers,function(e){e._nestData=t._nestFacet(e),e._handlePositions(),e._trainScales(),e._createDefaultScales()}),this._trainScales()},t._trainScales=function(){var t,e=this,n=function(t){return function(n){return e._getFacetFromFacetKey(n)!==t.facetKey()}},i=function(){return function(t,e,n){return 2>arguments.length&&(e=0),3>arguments.length?void 0===this._globalScales[t]?null:this._globalScales[t][e]:(this._globalScales[t]||(this._globalScales[t]={}),this._globalScales[t][e]=n,n)}};this._globalScales={},this._positionScales={},dv.util.each(this._panels,function(r){dv.util.each(e._chart._layers,function(a){for(var s in a._aes){var o=a._aes[s];for(var l in o){var c=a.getScale(s,l);c instanceof dv.scale.constant||(t=e._isFree.call(e,s)?e._trainFreeScale(a,r,s,l,n(r)):e._trainScale(a,i(a),s,l),r._trainedScales[s]||(r._trainedScales[s]={}),r._trainedScales[s][l]=t,o[l].unionDomain(t,t.reverse()),o[l].range(t.range()))}}})}),dv.util.each(this._globalScales,function(t){dv.util.each(t,function(t){t.validateDomain()})})},t._isFree=function(t){var e="x"===t||"xMin"===t||"xMax"===t,n="y"===t||"yMin"===t||"yMax"===t;return e&&("free"===this._scales||"free_x"===this._scales)||n&&("free"===this._scales||"free_y"===this._scales)},t._trainScale=function(t,e,n,i,r){var a,s=e.call(this,n,i),o={stack:"stack"===t.position()&&"y"===n,fill:"fill"===t.position()&&"y"===n,filter:r};return s?(a=t._aes[n][i],a.domain(a.calculateDomain(t._nestData,o)),s.unionDomain(a,s.reverse()),s.unionRange(a.range())):(t._aes[n][i].trainDomain(t._nestData,o),s=t._aes[n][i].copy(),e.call(this,n,i,s)),s},t._render=function(){this._axes=this._chart._axes;var t=this._ensureColumnsAndRows();this._adjustPlotBounds(t[0],t[1]),this._configurePanels(t[0],t[1]),this._axes._initializeAxisRenderers(),this._axes._measureTitles(this._chart._plotBounds);var e=this._measureMargins(t[0],t[1]);this._layoutPanels(t[0],t[1],e),this._renderAxisTitles(),this._renderPanels()},t._setVisibleAxisLabelOrientations=function(t,e,n,i){var r=t.rowIndex(),a=t.columnIndex(),s={left:0===a,top:0===r,right:a===n||t.facetIndex()===i-1,bottom:r===e||a>n&&r===e-1};t.visibleAxisLabelOrientations(s)},t._changeScaleRangeToLocal=function(t){var e=t.range(),n=t.innerScaleGroup();for(var i in n)dv.util.scaleRange(n[i],[e[0],e[1]]).applyRangePadding();return n},t._measureMargins=function(t){var e=this._panels.length,n=~~((e-1)/t),i=(e-1)%t,r=this._axes._getAllOrientations(),a={rows:[],cols:[]},s=this._isFree("x"),o=this._isFree("y"),l=this._panels[0];l&&(this._changeScaleRangeToLocal(l.getOuterScale("x")),this._changeScaleRangeToLocal(l.getOuterScale("y")));for(var c=-1;e>++c;){var u=this._panels[c],d=u.columnIndex(),h=u.rowIndex();this._setVisibleAxisLabelOrientations(u,n,i,e),u.margins({left:0,top:0,right:0,bottom:0}),h>=a.rows.length&&(a.rows[h]={left:0,top:0,right:0,bottom:0}),d>=a.cols.length&&(a.cols[d]={left:0,top:0,right:0,bottom:0}),this._panelsWithAxisLabels.push(u),this._axes._measure(u);var p=u.margins();void 0!==r.right&&!o&&c===e-1&&t-1>d&&(p.right=0),void 0!==r.bottom&&!s&&d>=i&&h===n-1&&(p.bottom=0);for(var f in a){var g="rows"===f?h:d,_=a[f][g];_.left=Math.max(p.left,_.left),_.top=Math.max(p.top,_.top),_.right=Math.max(p.right,_.right),_.bottom=Math.max(p.bottom,_.bottom)}}return a},t._layoutPanels=function(t,e,n){var i,r,a,s,o=this._chart._plotBounds,l=o.right-o.left-(t-1)*this._hGap,c=o.bottom-o.top-(e-1)*this._vGap,u={x:0,y:0},d=this;for(a=-1,s=n.cols.length;s>++a;)l-=n.cols[a].left+n.cols[a].right;for(a=-1,s=n.rows.length;s>++a;)c-=n.rows[a].bottom+n.rows[a].top;i=Math.max(l/t,0),r=Math.max(c/e,0);var h=this._chart._chartContainer.select(".axes-labels"),p=h.selectAll(".panel-labels").data(this._panelsWithAxisLabels);p.enter().append("div"),p.exit().remove(),p.attr("class",function(t){return"panel-labels panel-"+t.facetIndex()});var f=this._chart._panelContainer.selectAll(".panel").data(this._panels);f.enter().append("g").classed("panel",!0),f.exit().remove(),f.each(function(a,s){d._drawPanel.call(this,d,a,s,o,n,i,r,t,e,u),d._axes._render.call(d._axes,d3.select(this),h.select(".panel-labels.panel-"+a.facetIndex()),a)})},t._renderAxisTitles=function(){var t=this.getColumn(0)[0].bounds(),e=this.getRow(0)[0].bounds(),n=this.getColumn(this._columns.length-1)[0].bounds(),i=this.getRow(this._rows.length-1)[0].bounds(),r=(i.bottom-e.top)/2+e.top,a=(n.right-t.left)/2+t.left,s=this._chart.plotBounds();this._axes._renderTitles(s,{left:[s.left,r],right:[s.right,r],top:[a,s.top],bottom:[a,s.bottom]})},t._renderPanels=function(){var t=this._chart,e=(t._plotBounds,t._g.select(".plot"));t._plotBounds;var n=function(t){t.attr("transform","translate(0,0)").each(function(t){this.__previousData__&&this.__previousData__._dataPointStyleClass!=t._dataPointStyleClass&&this.__previousData__.exit(this),t._render(this),this.__previousData__=t})},i=function(t){t.each(function(e){e.exit(this,function(){t.remove()})})},r=e.selectAll(".geom").data(t._layers);r.exit().call(i),r.enter().append("g").classed("geom",!0),r.call(n)},t._updatePanelTitle=function(t,e,n,i,r,a,s){var o={left:0,top:0,width:0,height:0},l=d3.select(this);if(dv.util.isUndefined(e))return t._removePanelTitle.call(this,n),o;var c=l.selectAll(".panel-title."+n).data([0]),u=c.enter().append("g").classed("panel-title "+n,!0).attr("transform","translate("+i+","+r+")"),d=u.append("rect").classed("panel-title-bg",!0),h=u.append("text").classed("panel-title-label",!0).attr("text-anchor","middle");dv.ANIMATION?c.transition().duration(t._chart._duration).attr("transform","translate("+i+","+r+")"):c.attr("transform","translate("+i+","+r+")");var p=c.selectAll(".panel-title-label").text(e),f=c.selectAll(".panel-title-bg"),g=p.node().getBBox(),_=0;switch(dv.ANIMATION&&(p=p.transition().duration(t._chart._duration),f=f.transition().duration(t._chart._duration)),n){case"top":x=a/2,y=g.height,o.left=0,o.top=0,o.width=a,o.height=g.height+6;break;case"right":x=s/2,y=-a+g.height,o.left=a-(g.height+6),o.top=0,o.width=g.height+6,o.height=s,_=90;break;case"bottom":x=a/2,y=s-6,o.left=0,o.top=s-(g.height+6),o.width=a,o.height=g.height+6;break;case"left":x=-s/2,y=0+g.height,o.left=0,o.top=0,o.width=g.height+6,o.height=s,_=270}return d.attr("x",o.left).attr("y",o.top).attr("width",o.width).attr("height",o.height),h.attr("transform","rotate("+_+" 0,0)").attr("x",x).attr("y",y),p.attr("transform","rotate("+_+" 0,0)").attr("x",x).attr("y",y),f.attr("x",o.left).attr("y",o.top).attr("width",o.width).attr("height",o.height),o},t._removePanelTitle=function(t){d3.select(this).selectAll(".panel-title."+t).remove()},t._updatePanelBackground=function(t,e,n,i,r){var a=d3.select(this).selectAll(".plot-bg").data([0]);a.enter().append("rect").classed("plot-bg",!0).style("opacity",1e-6).attr("x",e).attr("y",n).attr("width",i).attr("height",r),dv.ANIMATION&&(a=a.transition().duration(t._chart._duration)),a.attr("x",e).attr("width",i).attr("height",r).style("opacity",1)},t._addToCollection=function(t,e,n){t[e]||(t[e]=[]),t[e].push(n)},t.getPanel=function(t){return this._panels&&this._panels.length>t?this._panels[t]:null},t.getRow=function(t){return this._rows[t]},t.getColumn=function(t){return this._columns[t]},t.getTrainedScale=function(t){return this._panels.length>0?this.getPanel(0).getTrainedScale(t):this._trainedScales[t]},t.scales=function(t){return arguments.length?(this._scales=t,this):this._scales},t.space=function(t){return arguments.length?(this._space=t,this):this._space},t.titleFormat=function(t){return arguments.length?(this._titleFormat=d3.functor(t),this):this._titleFormat},t.hGap=function(t){return arguments.length?(this._hGap=t,this):this._hGap},t.vGap=function(t){return arguments.length?(this._vGap=t,this):this._vGap},t.chart=function(t){return arguments.length?(this._chart=t,this):this._chart},t}),dv.facet.scale=dv.extend(function(){function t(){}return t.domain=function(){return this._innerScale.domain()},t.range=function(t){return arguments.length?(this._range=t,this):this._range},t._applyPercentage=function(t,e){return this._range[0]+(this._range[1]-this._range[0])*t.apply(this._innerScale,e)},t.mapPropToPercent=function(t){return this._innerScale.mapPropToPercent(t)},t.mapValueToPercent=function(t){return this._innerScale.mapValueToPercent(t)},t.mapToProp=function(t,e){return this._applyPercentage(this._innerScale.mapPropToPercent,[t,e])},t.mapValue=function(t,e){return this._applyPercentage(this._innerScale.mapValueToPercent,[t,e])},t.rangeBand=function(){return this._applyPercentage(this._innerScale.rangeBand)},t.innerScaleGroup=function(t){return arguments.length?(this._innerScaleGroup=t,this):this._innerScaleGroup},t}),dv.facet.wrap=dv.facet.extend(function(){function t(){this._super(),this._facetScale=null,this._preferredAspectRatio=1,this._titleOrientation="top"}return t._prerender=function(){this._facetScale=dv.scale.ordinal().mapping(this._group).domain([]),this._super()},t._trainFacetGroups=function(t){var e=t.data()[this._facetScale.mapping()];e&&this._facetScale.domain(this._facetScale.domain().concat(e))},t._trainFreeScale=function(t,e,n,i,r){var a=function(t,n,i){return 2>arguments.length&&(n=0),3>arguments.length?e._trainedScales[t]?e._trainedScales[t][n]:void 0:(e._trainedScales[t]||(e._trainedScales[t]={}),e._trainedScales[t][n]=i,i)};return this._trainScale(t,a,n,i,r)},t._showAllPanelLabelsIfFree=function(){return!0},t._configureFacets=function(){this._facetKeys=this._facetScale.domain(),this._facetMap={}},t._nestFacet=function(t){var e,n,i=this,r=t.normalizedData(),a=dv.util.filterAndZip(r),s=t.getScale("group"),o=this._group,l=this._facetScale.domain();s&&(e=s.property(),n=e?r[e]:null);for(var c=-1,u=a.length;u>++c;){var d,h=0,p=a[c];p.data.hasOwnProperty(o)&&(h=l.indexOf(p.data[o]),h>=0&&(d=l[h]+""));var f=this._facetMap[h];f||(f=dv.panel().facetIndex(h).facetKey(d).xFacetTitle(d).facet(this),this._facetMap[h]=f,this._panels.push(f)),p.panel=f}return d3.nest().key(function(t){var n="";return n+=(t.data.hasOwnProperty(o)?t.data[o]:".")+" ~ ",n+=t.hasOwnProperty(e)?t[e]:"."}).sortKeys(function(t,e){var r=i._getGroupFromFacetKey(t),a=i._getGroupFromFacetKey(e),s=-1,o=-1;return"."!==r&&(s=n.indexOf(r),0>s&&(s=n.indexOf(Number(r)))),"."!==a&&(o=n.indexOf(a),0>o&&(o=n.indexOf(Number(a)))),s>o?1:-1}).entries(a)},t._getGroupFromFacetKey=function(t){return/.* ~ (.*)/g.exec(t)[1]},t._getFacetFromFacetKey=function(t){return/(.*) ~ .*/g.exec(t)[1]},t._ensureColumnsAndRows=function(){var t=this._panels.length,e=Math.min(this._numColumns,t),n=Math.min(this._numRows,t);if(1>e&&1>n){var i=this._chart._plotBounds,r=i.right-i.left,a=i.bottom-i.top,s=Math.min(t,Math.ceil(Math.sqrt(1*t*r/(a*this._preferredAspectRatio))));return s=isNaN(s)?1:s,[s,Math.ceil(t/s)]}return 1>e&&n>=1&&(e=Math.ceil(t/n)),e>=1&&1>n&&(n=Math.ceil(t/e)),[e,n]},t._adjustPlotBounds=function(){},t._configurePanels=function(t,e){for(var n=this._chart._plotBounds,i=n.right-n.left,r=n.bottom-n.top,a=(i-(t-1)*this._hGap)/t,s=(r-(e-1)*this._vGap)/e,o=-1,l=this._panels.length;l>++o;){var c=this._panels[o],u=dv.facet.scale().innerScaleGroup(c._trainedScales.x),d=dv.facet.scale().innerScaleGroup(c._trainedScales.y),h=o%t,p=~~(o/t),f={left:0,top:0,right:a,bottom:s,width:a,height:s};this._panels[o].xOuterScale(u).yOuterScale(d).columnIndex(h).rowIndex(p).bounds(f),this._addToCollection(this._rows,p,c),this._addToCollection(this._columns,h,c)}},t._drawPanel=function(t,e,n,i,r,a,s,o,l,c){var u=e.columnIndex(),d=e.rowIndex(),h=r.rows[d],p=r.cols[u],f=t._titleOrientation;0===u&&(c.x+=i.left,0===d&&(c.y+=i.top));var g=c.y+h.top,_=c.x+p.left,m=t._titleFormat?t._titleFormat.call(this,e.xFacetTitle(),n):e.xFacetTitle(),v=t._updatePanelTitle.call(this,t,m,f,_,g,a,s);e.bounds({width:a,height:s,top:g+("top"===f?v.height:0),left:_+("left"===f?v.width:0),right:_+a+("right"===f?-v.width:0),bottom:g+s+("bottom"===f?-v.height:0)}),t._updatePanelBackground.call(this,t,_,g,a,s),u===o-1?(c.x=0,c.y+=h.top+s+h.bottom+t._vGap):c.x+=p.left+a+p.right+t._hGap},t.group=function(t){return arguments.length?(this._group=t,this):this._group},t.numColumns=function(t){return arguments.length?(this._numColumns=t,this):this._numColumns},t.numRows=function(t){return arguments.length?(this._numRows=t,this):this._numRows},t.preferredAspectRatio=function(t){return arguments.length?(this._preferredAspectRatio=t,this):this._preferredAspectRatio
},t}),dv.facet.grid=dv.facet.extend(function(){function t(){this._super(),this._xFacetScale=null,this._yFacetScale=null}return t._prerender=function(){this._xFacetScale=dv.scale.ordinal().mapping(this._xGroup).domain([]),this._yFacetScale=dv.scale.ordinal().mapping(this._yGroup).domain([]),this._super()},t._trainFacetGroups=function(t){var e=t.data()[this._xFacetScale.mapping()];e&&this._xFacetScale.domain(this._xFacetScale.domain().concat(e));var n=t.data()[this._yFacetScale.mapping()];n&&this._yFacetScale.domain(this._yFacetScale.domain().concat(n))},t._trainFreeScale=function(t,e,n,i,r){var a=this,s=function(t,n,i){2>arguments.length&&(n=0),a._positionScales[t]||(a._positionScales[t]={});var r=a._positionScales[t];r[n]||(r[n]=[]);var s=r[n],o=t.indexOf("x")>=0?e.columnIndex():e.rowIndex();return 3>arguments.length?s[o][n]:(s[o][n]=i,i)};return this._trainScale(t,s,n,r)},t._showAllPanelLabelsIfFree=function(){return!1},t._configureFacets=function(){var t,e,n,i=this._xFacetScale.domain(),r=this._yFacetScale.domain();this._numColumns=Math.max(this._xFacetScale.domain().length,1),this._numRows=Math.max(this._yFacetScale.domain().length,1);for(var a=-1,s=this._numRows,o=0;s>++a;){yFacetIndex=a,r&&r.length>a&&(e=r[a]);for(var l=-1,c=this._numColumns;c>++l;){xFacetIndex=l,i&&i.length>l&&(t=i[l]),n=(r.length?e:".")+" ~ "+(i.length?t:".");var u=dv.panel().facetIndex(o++).facetKey(n).columnIndex(xFacetIndex).rowIndex(yFacetIndex).xFacetTitle(t).yFacetTitle(e).facet(this);this._panels.push(u),this._addToCollection(this._rows,yFacetIndex,u),this._addToCollection(this._columns,xFacetIndex,u)}}},t._nestFacet=function(t){var e,n,i=this,r=t.normalizedData(),a=dv.util.filterAndZip(r),s=t.getScale("group"),o=this._xFacetScale.domain(),l=this._yFacetScale.domain();s&&(e=s.property(),n=e?r[e]:null);for(var c=-1,u=a.length;u>++c;){var d=a[c],h=0,p=0;d.data.hasOwnProperty(this._xGroup)&&(p=o.indexOf(d.data[this._xGroup]),0>p&&(p=0)),d.data.hasOwnProperty(this._yGroup)&&(h=l.indexOf(d.data[this._yGroup]),0>h&&(h=0)),panelIndex=h*this._numColumns+p;var f=this._panels[panelIndex];d.panel=f}return d3.nest().key(function(t){var n="";return n+=(t.data.hasOwnProperty(i._yGroup)?t.data[i._yGroup]:".")+" ~ ",n+=(t.data.hasOwnProperty(i._xGroup)?t.data[i._xGroup]:".")+" ~ ",n+=t.hasOwnProperty(e)?t[e]:"."}).sortKeys(function(t,e){var r=i._getGroupFromFacetKey(t),a=i._getGroupFromFacetKey(e),s=-1,o=-1;return"."!==r&&(s=n.indexOf(r),0>s&&(s=n.indexOf(Number(r)))),"."!==a&&(o=n.indexOf(a),0>o&&(o=n.indexOf(Number(a)))),s>o?1:-1}).entries(a)},t._getGroupFromFacetKey=function(t){return/.* ~ .* ~ (.*)/g.exec(t)[1]},t._getFacetFromFacetKey=function(t){return/(.* ~ .*) ~ .*/g.exec(t)[1]},t._ensureColumnsAndRows=function(){return[this._numColumns,this._numRows]},t._adjustPlotBounds=function(){var t=this._measureTitles(this._xFacetScale.domain(),"temp-column-titles",this._chart._g)+3,e=this._measureTitles(this._yFacetScale.domain(),"temp-row-titles",this._chart._g)+3;this._chart._plotBounds,this._xTitleHeight=t,this._yTitleWidth=e,this._chart._plotBounds.top+=t,this._chart._plotBounds.right-=e},t._measureTitles=function(t,e){var n=this._createTitlesContainer(e,this._chart._g),i=n.selectAll(".panel-title").data(t);i.enter().append("text").text(function(t){return t});var r=n.node().getBBox();return n.remove(),r.height},t._createTitlesContainer=function(t,e){var n=e.selectAll("."+t).data([0]);return n.enter().append("g").classed(t,!0),n.exit().remove(),n},t._configurePanels=function(t,e){for(var n=this._chart._plotBounds,i=n.right-n.left,r=n.bottom-n.top,a=(i-(t-1)*this._hGap)/t,s=(r-(e-1)*this._vGap)/e,o=0,l=0,c=0,u=-1,d=this._panels.length;d>++u;){var h=this._panels[u],p=dv.facet.scale().innerScaleGroup(h._trainedScales.x),f=dv.facet.scale().innerScaleGroup(h._trainedScales.y),g={left:0,top:0,right:0+a,bottom:0+s,width:a,height:s};this._panels[u].xOuterScale(p).yOuterScale(f).bounds(g),o+=a+this._hGap,c++,c>=t&&(o=0,l+=s+this._vGap,c=0)}},t._drawPanel=function(t,e,n,i,r,a,s,o,l,c){var u=e.columnIndex(),d=e.rowIndex(),h=r.rows[d],p=r.cols[u];if(c.x+=p.left,0===u&&(c.x+=i.left),0===d){var f=t._titleFormat?t._titleFormat.call(this,e.xFacetTitle(),n):e.xFacetTitle();c.y=h.top+i.top,t._updatePanelTitle.call(this,t,f,"top",c.x,c.y-t._xTitleHeight,a,s)}else t._removePanelTitle.call(this,"top");if(u===t._numColumns-1){var g=t._titleFormat?t._titleFormat.call(this,e.yFacetTitle(),n):e.yFacetTitle();t._updatePanelTitle.call(this,t,g,"right",c.x+t._yTitleWidth,c.y,a,s)}else t._removePanelTitle.call(this,"right");e.bounds({width:a,height:s,top:c.y,left:c.x,right:c.x+a,bottom:c.y+s}),t._updatePanelBackground.call(this,t,c.x,c.y,a,s),c.x+=a+p.right+t._hGap,u===t._numColumns-1&&(c.x=0,c.y+=h.top+s+h.bottom+t._vGap)},t.xGroup=function(t){return arguments.length?(this._xGroup=t,this):this._xGroup},t.yGroup=function(t){return arguments.length?(this._yGroup=t,this):this._yGroup},t.aggregate=function(t){return arguments.length?(this._aggregate=t,this):this._aggregate},t}),dv.chart=dv.container.extend(function(){function t(){this._super(),this._firstRender=!1,this._data={},this._coord=dv.coord.cartesian(),this._facet=dv.facet.wrap().chart(this),this._layers=[],this._behaviors=[],this._legends=dv.guide.legends(),this._axes=dv.guide.axes()._chart(this),this._delay=d3.functor(0),this._duration=d3.functor(1e3),this._ease="cubic-in-out",this._parent=null,this._chartContainer=null,this._svgContainer=null,this._g=null,this._axisLabelContainer=null,this._panelContainer=null,this._interactionGroup=null,this._prerenderFunc=null,this._postrenderFunc=null,this._clipPlot=!1,this._width=0/0,this._height=0/0,this._plotWidth=0/0,this._plotHeight=0/0,this._calcWidth=0/0,this._calcHeight=0/0,this._calcPlotWidth=0/0,this._calcPlotHeight=0/0,this._defaultPadding=this._padding=this._plotBounds=this._guidesBounds={top:0,left:0,right:0,bottom:0},this._position="identity"}return t.render=function(){if(dv.util.isUndefined(this._data)||dv.util.isEmpty(this._data))for(var t=0;this._layers.length>t;t++)(dv.util.isUndefined(this._layers[t]._data)||dv.util.isEmpty(this._layers[t]._data))&&dv.log.error({msg:"Cannot render a chart with no data provided.",data:{chartData:this._data,geom:this._layers[t]}});return this._resolvePercentDimensions(),this._createChartContainer(),this._prerender(),this._renderLegends(),this._prerenderFunc&&this._prerenderFunc.call(this),this._facet._render(),this._postrenderFunc&&this._postrenderFunc.call(this),this._renderBehaviors(),this._clipGeoms(),this._cleanupGuides(),this.unregisterEventMap=null,this},t._resolvePercentDimensions=function(){this._calcWidth=dv.util.getPercentValue(this._width,this._parent.node().offsetWidth),this._calcHeight=dv.util.getPercentValue(this._height,this._parent.node().offsetHeight),dv.util.isFinite(this._calcWidth)?this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._calcWidth):(this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._parent.node().offsetWidth),dv.util.isFinite(this._calcPlotWidth)||(this._calcWidth=this._parent.node().offsetWidth)),dv.util.isFinite(this._calcHeight)?this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._calcHeight):(this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._parent.node().offsetHeight),dv.util.isFinite(this._calcPlotHeight)||(this._calcHeight=this._parent.node().offsetHeight))},t._finalizePlotBounds=function(){var t=this._legends._allowedDimensions(),e=this._legends._getWidth(),n=this._legends._getHeight(),i={left:Math.max(t.left,this._padding.left),top:Math.max(t.top,this._padding.top)};dv.util.isFinite(this._calcWidth)?dv.util.isFinite(this._calcPlotWidth)||(this._calcPlotWidth=this._calcWidth-this._padding.left-this._padding.right-e):this._calcWidth=this._calcPlotWidth+e+this._padding.left+this._padding.right,dv.util.isFinite(this._calcHeight)?dv.util.isFinite(this._calcPlotHeight)||(this._calcPlotHeight=this._calcHeight-this._padding.top-this._padding.bottom-n):this._calcHeight=this._calcPlotHeight+n+this._padding.top+this._padding.bottom,this._calcPlotWidth=Math.min(this._calcPlotWidth,this._calcWidth-this._padding.left-this._padding.right-e),this._calcPlotHeight=Math.min(this._calcPlotHeight,this._calcHeight-this._padding.top-this._padding.bottom-n),i.right=i.left+this._calcPlotWidth,i.bottom=i.top+this._calcPlotHeight,this.plotBounds(i),this._coord instanceof dv.coord.cartesian&&(this._plotBounds.right-=this._coord.endX(),this._plotBounds.left+=this._coord.startX()),this._chartContainer.style("width",this._calcWidth+"px").style("height",this._calcHeight+"px")},t._prerender=function(){this._trainedScales={},this._calculateStats(),this._facet._prerender();var t=this._normalizeData(this.data());this.data(t),this._axes._get("x")||this._axes._add("x",dv.guide.axis()),this._axes._get("y")||this._axes._add("y",dv.guide.axis())},t._createChartContainer=function(){this._chartContainer=this._parent.selectAll(".dv-chart-container").data([0]),this._chartContainer.enter().append("div").classed("dv-chart-container",!0),this._svgContainer=this._chartContainer.selectAll("svg").data([0]),this._svgContainer.enter().append("svg").style("height","100%").style("width","100%"),this._g=this._svgContainer.select(".group"),this._g.empty()&&(this._firstRender=!0,this._g=this._svgContainer.append("g").classed("group",!0),this._panelContainer=this._g.append("g").classed("panels",!0),this._interactionGroup=this._g.append("g").classed("interaction-group",!0),this._g.append("g").classed("behavior-under-geom",!0),this._g.append("g").classed("plot",!0),this._g.append("g").classed("behavior",!0),this._g.append("g").classed("legends",!0),this._interactionGroup.append("rect").classed("interaction-canvas",!0).classed("background",!0)),this._panelContainer||(this._panelContainer=this._g.select(".panels")),this._interactionGroup||(this._interactionGroup=this._g.select(".interaction-group")),this._axisLabelContainer=this._chartContainer.selectAll(".axes-labels").data([0]),this._axisLabelContainer.enter().append("div").classed("axes-labels",!0)},t._addRegisteredEvents=function(){var t=this;dv.util.each(t.eventMap,function(e,n){t._interactionGroup.on(n,function(){var e=d3.event,i=t._interactionGroup.node();t._shouldDispatchChartEvent(e,i)&&t.eventMap[n].callback.call(t._interactionGroup.node(),d3.event)},e.capture)}),dv.util.each(t._layers,function(t){t._addRegisteredEvents()})},t._removeRegisteredEvents=function(){var t=this;dv.util.each(t.unregisterEventMap,function(e,n){t._interactionGroup&&t._interactionGroup.on(n,null,e)}),dv.util.each(t._layers,function(t){t._removeRegisteredEvents()})},t._shouldDispatchChartEvent=function(t){var e=!0;if("mouseout"===t.type||"mouseover"===t.type){var n=d3.select(t.relatedTarget);if(n&&!n.empty()){var i=n.attr("class");e=!(i&&i.indexOf("-geom")>=0)}}return e},t._calculateStats=function(){},t._renderLegends=function(){var t=dv.util.isFinite(this._calcWidth)?this._calcWidth-this._padding.left-this._padding.right:this._calcPlotWidth,e=dv.util.isFinite(this._calcHeight)?this._calcHeight-this._padding.top-this._padding.bottom:this._calcPlotHeight,n={left:this._padding.left,top:this._padding.top,width:t,height:e},i={el:this._g,scales:this._facet._globalScales,firstRender:this._firstRender,duration:this._duration,delay:this._delay,ease:this._ease};this._legends._allowedDimensions(n)._render(i),this._finalizePlotBounds()},t._cleanupGuides=function(){this._legends._empty(),this._axes._empty()},t._setRanges=function(){var t=this.plotBounds(),e=this.getTrainedScale("y"),n=this.getTrainedScale("x"),i=this.coord().flip()?[t.bottom-t.top,0]:[0,t.right-t.left],r=this.coord().flip()?[0,t.right-t.left]:[t.bottom-t.top,0];dv.util.scaleRange(n,i),dv.util.scaleRange(e,r)},t.plotBounds=function(t){return arguments.length?(this._plotBounds=t,this):this._plotBounds},t._renderBehaviors=function(){var t=this._facet.getPanel(0),e=t._bounds,n=this._g.select(".behavior").attr("transform","translate(0,0)"),i=this._g.select(".behavior-under-geom").attr("transform","translate(0, 0)");this._interactionGroup.attr("transform","translate(0,0)").select(".interaction-canvas").attr("visibility","hidden").attr("width",e.right-e.left).attr("height",e.bottom-e.top).attr("x",e.left).attr("y",e.top);var r=this;dv.util.each(this._behaviors,function(t){t.underGeoms&&t.underGeoms()?t.chart(r)._render(i):t.chart(r)._render(n)})},t.guide=function(t,e,n){if(!t||""===t)throw Error("Property argument cannot be null or empty");if("all"===t){if("none"!==e)throw Error("'all' can only be used to set all guides to 'none' (e.g. turn off all guides)");this._legends._hide(!0),this._axes._add("x","none",0),this._axes._add("y","none",0)}t=dv.util.isArray(t)?t:[t],n=dv.util.isUndefined(n)?0:n;for(var i=dv.guide.legend(),r="",a=0;t.length>a;a++){var s=e,o=this._isPositionProperty(t[a]);if(r){if(o&&"axis"!=r)throw Error("Cannot mix positional and non-positional guide types")}else r=o?"axis":"legend";if(s?!this._isValidGuideType(t[a],s)&&dv.util.isObject(s)&&(s=this._buildCustomGuide(s)):s=o?dv.guide.axis():i,this._isValidGuideType(t[a],s))if("none"!==s&&s.scaleIndex(n),o)this._axes._add(t[a],s,n);else{if("none"!==s){this._legends._add({props:t,guide:s});break}this._legends._remove(t)}}return this},t._isPositionProperty=function(t){return"x"===t||"y"===t},t._isValidGuideType=function(t,e){var n=this._isPositionProperty(t);return e&&("none"===e||e instanceof dv.guide.custom)||n&&e instanceof dv.guide.axis||!n&&e instanceof dv.guide.legend},t._buildCustomGuide=function(t){var e=dv.guide.custom();for(var n in t)e.setFunc(n,t[n]);return e},t.getScale=function(t,e){return 2>arguments.length&&(e=0),"group"===t?this._getGroup():this._aes.hasOwnProperty(t)?this._aes[t][e]:void 0},t._getGroup=function(){if(this._aes.hasOwnProperty("group"))return this._aes.group[0];for(var t=-1,e=dv.DEFAULT_CATEGORICAL_AES.length-1;e>t++;){var n=this._aes[dv.DEFAULT_CATEGORICAL_AES[t]];if(n&&n[0]&&n[0]instanceof dv.scale.ordinal&&!dv.util.isUndefined(n[0].mapping()))return n[0]}return null},t._clipGeoms=function(){var t=this,e=this._parent.selectAll(".panel").selectAll("defs").data(function(e){return t._clipPlot?[e]:[]});e.enter().append("defs"),e.exit().remove();var n=e.selectAll("clipPath").data(function(t){return[t]});n.enter().append("clipPath").classed("dv-clip",!0),n.exit().remove(),n.attr("id",function(t){return"dv-clip"+t._facetIndex});var i=n.selectAll("rect").data(function(t){return[t]});if(i.enter().append("rect"),i.exit().remove(),i.attr("x",function(t){return t._bounds.left}).attr("y",function(t){return t._bounds.top}).attr("width",function(t){return t._bounds.width}).attr("height",function(t){return t._bounds.height}),t._clipPlot){var r=this._parent.selectAll(".series");r.attr("clip-path",function(t){var e=t.values[0],n=dv.util.isArray(e)?e[0].panel:e.panel;return"url(#dv-clip"+n._facetIndex+")"})}},t.getTrainedScale=function(t){return this._facet.getTrainedScale(t)},t.getExplicitScale=function(t,e){return void 0===e&&(e=0),this._aes[t][e]},t.parent=function(t){if(!arguments.length)return this._parent?this._parent.node():null;if(this._parent=d3.select(t),this._parent.empty())throw Error("The DV parent element was not found.");return this},t.layers=function(t){return arguments.length?(this._layers=t,this):this._layers},t.behaviors=function(t){return arguments.length?(this._behaviors=t,this):this._behaviors},t.data=function(t){return arguments.length?(this._data=t,this):this._data},t.coord=function(t){return arguments.length?(this._coord=t,this):this._coord},t.facet=function(t){return arguments.length?(this._facet=t,this._facet.chart(this),this):this._facet},t.getPlotBounds=function(){return this._plotBounds},t.plotWidth=function(t){return arguments.length?(this._plotWidth=t,this):this._plotWidth},t.plotHeight=function(t){return arguments.length?(this._plotHeight=t,this):this._plotHeight},t.width=function(t){return arguments.length?(this._width=t,this):this._width},t.height=function(t){return arguments.length?(this._height=t,this):this._height},t.padding=function(t){return arguments.length?(this._padding=dv.util.merge(this._defaultPadding,t),this):this._padding},t.prerender=function(t){return arguments.length?(this._prerenderFunc=t,this):this._prerenderFunc},t.postrender=function(t){return arguments.length?(this._postrenderFunc=t,this):this._postrenderFunc},t.clipPlot=function(t){return arguments.length?(this._clipPlot=t,this):this._clipPlot},t})}(),function(t){"use strict";function e(t,n){if(this instanceof e)return this;var i,r,a,s,o,l,c,u,d,h,p,f,g,_,m,v,y,x,b,A,k,S=n||{},M=0,P=S.displayCount||-1,w=S.showNone,O={},T=O.value=[],z=O.origValue=[],C=O.lowerBound=[],E=O.upperBound=[],N=O.series=[],D=O.series_name=[],F=O.metric_series=[],L=O.metric_series_name=[],I=O.date=[],V=O.category=[],B=O.label=[],R=O.groups=[],j=O.facets=[],H=O.cell=[],q=O.filter=[],G=S.showMetrics||!1,Y=O.metric=[],W=t.metrics.length>1,U=!1,X=!1;for(t.filters.length>1&&t.filters.some(function(t,e,n){return e>0&&!X&&(X=t.data_store!==n[e-1].data_store),e>0&&!U&&(U=(t.info&&t.info.name||"")!==(n[e-1].info&&n[e-1].info.name||"")),U&&X}),h=0,p=t.metrics.length;p>h;++h)for(s=t.metrics[h],c=(s.name||s.id||"")+"",i=s.filter_ref,r=s.date_ref,g=P>=0?Math.min(P,i.length):i.length,f=0;g>f;++f){for(o=t.filters[i[f]],o.facet_ref||(o.facet_ref=[]),A=[],k=[],y=0,x=o.facet_ref.length;x>y;++y)b=t.facets[o.facet_ref[y]],A.push(b),k.push(b.info&&b.info.name||"");if(!o.info||0!==o.info.id||w)for(l=(o.info&&o.info.name||"")+"",d=o.data_store_name||o.data_store&&o.data_store.replace("dms/","")||"",_=0,m=r.length;m>_;++_)u=t.dates[r[_]],a=t.data[i[f]][r[_]][h],T[M]="invalid"===a.status||"transform_error"===a.status||"calc_error"===a.status?void 0:+a.val||0,z[M]="invalid"===a.status?void 0:+a.orig_val||0,C[M]="invalid"===a.status||"transform_error"===a.status?void 0:+a.lower_bound||0,E[M]="invalid"===a.status||"transform_error"===a.status?void 0:+a.upper_bound||0,I[M]=new Date(u.val),V[M]=l,B[M]=c,L[M]=(X?d+"   ":"")+c,F[M]=L[M]+":m"+s.ref_id,v=[],X&&v.push(d),V[M].length&&v.push(V[M]),D[M]=v.join("   "),0===D[M].length?D[M]=c:(G||W||!U)&&c.length&&(D[M]+=" ("+c+")"),N[M]=D[M]+":m"+s.ref_id+"f"+o.ref_id,R[M]=k,q[M]=o,Y[M]=s,H[M]=a,j[M]=A,++M;else i.length>g&&++g}return O}var n=t.rs2dv;e.noConflict=function(){return t.rs2dv=n,this},e.prototype.convert=function(){return e.apply(null,arguments)},t.rs2dv=e,"function"==typeof define&&define.amd?define(function(){return e}):"undefined"==typeof exports?t.rs2dv=e:"object"==typeof module&&module.exports?module.exports=e:exports.rs2dv=e}(this),function(t){"use strict";var e={},n=t.dv||{},i=t.d3||{},r={};r._options=null,r._eventMap={},r._changedOptions=null,r.init=function(t){return this._initDefaultOptions(),this.setOptions(t),this},r._initDefaultOptions=function(t){var e={dataAdapter:"standard",data:null,height:null,parent:null,width:null,autoResize:!1,locale:"en_US",l10n:{}};t&&this._mergeOptions(e,t),this._options=e,this._changedOptions={};for(var n in e)this._changedOptions[n]=e[n];return this._options},r._mergeOption=function(t,e,n){switch(e){case"mappings":case"formats":t[e]=t[e]||{},this._mergeOptions(t[e],n);break;default:t[e]=n}return t},r._mergeOptions=function(t,e){for(var n in e)this._mergeOption(t,n,e[n]);return t},r._truncateLabel=function(t,e){var n=e||this.X_AXIS_LABEL_MAXLENGTH;return t.length>n?t.substring(0,n)+"...":t},r._formatNumber=function(t,e,n){var r,a,s,o,l,c="",u=this._dataAdapter.l10n.numberFormat;return"currency"==t||"percent"==t?(c=u[t].symbol,s=e>=0?u[t].positivePattern:u[t].negativePattern):s=e>=0?"{number}":u.negativePattern,"percent"==t&&(e*=100),e=Math.abs(e),l=e>=100?3:e>=10?e%1?3:2:e>=1?e%1?3:1:e%1?2:1,o=n!==void 0?i.format(",."+n+"f")(e):e>=1e3&&1e4>e?i.format(",.0f")(e):i.format("."+l+"s")(e),a=.01>e&&e>0,a&&(o="0.01"),r=s.replace(/\{number\}/i,o).replace(/\{symbol\}/i,c).replace(/,/g,u.groupSeparator).replace(/\./,u.decimalSeparator),a&&(r="<"+r),r},r._getPropMapping=function(t){return this._dataAdapter.mappings()[t]},r.setOption=function(t,e){return t in this._options?("dataAdapter"===t&&"rs2dv"===e&&(e="rs"),"clickHandler"===t&&this.on("click",e),this._mergeOption(this._options,t,e),this._changedOptions||(this._changedOptions={}),this._changedOptions[t]=e,!0):!1},r.getOption=function(t){var e=this._options;return t in e?e[t]:null},r.setOptions=function(t){for(var e in t)this.setOption(e,t[e])},r._preRender=function(){if(this._clearErrorMessage(),"autoResize"in this._changedOptions&&this._updateWindowResize(),"dataAdapter"in this._changedOptions){var t=this._changedOptions.dataAdapter;if(!this._dataAdapter||this._options.dataAdapter!==t){var n=e.dataAdapter[t];if(!n)throw Error("No data adapters were found for data adapter type "+t);var i=n[this._type]||n.base||e.dataAdapter.standard.base;this._dataAdapter=i()}}this._dataAdapter.process(this._options,this._changedOptions)},r._render=function(){},r._postRender=function(){this._changedOptions={}},r.render=function(){return this.reset(),this._preRender(),this._render(),this._postRender(),this},r.reset=function(){},r._updateWindowResize=function(){this._options.autoResize?(this._autoResizeHandler=this._autoResizeHandler||n.util.bind(this._onAutoResize,this),e.windowResize.addHandler(this._autoResizeHandler)):e.windowResize.removeHandler(this._autoResizeHandler)},r._onAutoResize=function(){},r.RESPONSIVE_WIDTH_THRESHOLD=400,r._isSmallChart=function(t){return r.RESPONSIVE_WIDTH_THRESHOLD>t},r.handleError=function(t){var e=this._dataAdapter.l10n,n=e.labels.core.erroronrender;return"invaliddata"===t.code&&(n=e.labels.core.nodata),this._setErrorMessage(n),this},r._setErrorMessage=function(t){t&&t.length?i.select(this._options.parent).html('<div class="cv-error">'+t+"</div>"):this._clearErrorMessage()},r._clearErrorMessage=function(){i.select(this._options.parent).select(".cv-error").remove()},r.destroy=function(){this.reset(),e.windowResize.removeHandler(this._autoResizeHandler)},r.on=function(t,e){var i=e&&n.util.isFunction(e);return i?(this._eventMap=this._eventMap||{},this._eventMap[t]=e):this._eventMap&&delete this._eventMap[t],this},t.cloudViz=e,e.d3=i,e.dv=n,e.rs2dv=t.rs2dv||{},e.core=r,e.localeDefinition=function(t,n,i){if(e._localeDefinitions=e._localeDefinitions||{},2===arguments.length)e._localeDefinitions[t]=n;else{if(3!==arguments.length){var r=e._localeDefinitions[t];if(!r)throw Error("Locale definition for "+t+" not found.");return r}e._localeDefinitions[t]===void 0&&(e._localeDefinitions[t]={}),e._localeDefinitions[t][i]=n}},"function"==typeof define&&define.amd?define(function(){return e}):"undefined"==typeof exports?t.cloudViz=e:"object"==typeof module&&module.exports?module.exports=e:exports.cloudViz=e}(this),function(t){"use strict";t.cloudViz.seriesState=function(){var t={},e=[],n={};return t.isSeriesEnabled=function(t,n){if(!e)return!0;var i,r,a=e.length;for(i=0;a>i;i++)if(r=e[i],r.id===t&&r.type===n)return r.enabled;return!1},t.doesSeriesStateExist=function(t,n){if(!e)return!1;var i,r,a=e.length;for(i=0;a>i;i++)if(r=e[i],r.id===t&&r.type===n)return!0;return!1},t._createStateObject=function(t,e,n,i){var r;if(3>arguments.length)throw Error("A state object requires a label and stateType.");return 4>arguments.length&&(i=!0),r={name:t,id:e,type:n,enabled:i},this.dispatch("create",r),r},t.insertState=function(){e.unshift(this._createStateObject.apply(this,arguments))},t.appendState=function(){e.push(this._createStateObject.apply(this,arguments))},t.enableStateByIndex=function(t,n){if(e.length>t){var i=e[t];i.enabled!==n&&(i.enabled=n,this.dispatch("enableChange",i))}},t.enableStateByTypeAndId=function(t,n,i){var r,a,s=e.length;for(r=0;s>r;r++)a=e[r],a.id===n&&a.type===t&&this.enableStateByIndex(r,i)},t.removeStatesByType=function(t){var n=this;e&&e.length&&(e=e.filter(function(e){return e.type===t?(n.dispatch("remove",e),!1):!0}))},t.on=function(t,e){if(1>arguments.length)throw Error("series state listeners require an eventType to be specified.");var i,r=t.indexOf("."),a="";r>0&&(a=t.substring(r+1),t=t.substring(0,r)),i=n[t]||{},e?(i[a]=e,n[t]=i):delete i[a]},t.dispatch=function(t,e){var i=n[t];if(i)for(var r in i)i[r].call(this,t,e)},t.getStateObjects=function(){return e},t.areSomeSeriesDisabled=function(){return e?0===Math.min.apply(null,e.map(function(t){return+t.enabled})):!1},t.areAllSeriesDisabled=function(){return e?0===Math.max.apply(null,e.map(function(t){return+t.enabled})):!1},t}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.util=e.util||{};n.deepExtend=function(t){for(var e=Array.prototype.slice.call(arguments,1),i=-1,r=e.length;r>++i;){var a=e[i];if(a)for(var s in a)a[s]&&a[s].constructor&&a[s].constructor===Object?(t[s]=t[s]||{},n.deepExtend(t[s],a[s])):t[s]=a[s]}return t},n.createConstructor=function(t){function e(){var e=Object.create(t);return"function"==typeof e.init&&e.init.apply(e,arguments),e}return e.prototype=t,e},n.namespace=function(e,n){var i=e.split("."),r=n||t;return i.forEach(function(t){var e=r[t];e||(e=r[t]={}),r=e}),r}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.X_AXIS_LABEL_MAXLENGTH=25,a.LEGEND_ORIENTATIONS=["top","right","left"],a._chart=null,a.clipIdCounter={count:0},a._legend=null,a._seriesState=null,a.init=function(){return Object.getPrototypeOf(a).init.apply(this,arguments),this._seriesState=e.seriesState(),this},a._initDefaultOptions=function(t){var e={aspectRatio:null,colors:["#8cc350","#5a6eaa","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841"],dateGranularity:void 0,flip:!1,interactive:!1,legendOrientation:null,legendVerticalWidth:110,legendVisible:!0,targetValues:null,targetLabel:void 0,mappings:{x:"x",y:"y",series:"series",seriesLabel:"series"},plotHeight:null,plotWidth:null,preRender:null,xAxisTitle:"",yAxisTitle:""};return t&&this._mergeOptions(e,t),Object.getPrototypeOf(a)._initDefaultOptions.call(this,e)},a.getChart=function(){return this._chart},a.enableSeriesByIndex=function(t,e){this._seriesState.enableStateByIndex(t,e)},a._highlight=function(t,e){t.classed("cv-highlight",e)},a._getYTitleFromLabels=function(t){var e=i.util.uniq(t);return e&&1===e.length?e[0]:null},a._preRender=function(){Object.getPrototypeOf(a)._preRender.call(this);try{this._createSeriesStates()}catch(t){var e=Error("The chart data is invalid");e.code="invaliddata",this.handleError(e)}},a._postRender=function(){Object.getPrototypeOf(a)._postRender.call(this);var t=this._options,e=r.select(t.parent);this._updateYAxisHitBox(e),this._colorDualYAxes(t,e)},a._removeYAxisHitBox=function(t){t.selectAll(".axis-y .cv-axis-hitbox").remove()},a._colorDualYAxes=function(t,e){!t.dualYAxis||this._isNormalized&&this._isNormalized()||"identity"!==this._options.position&&"dodge"!==this._options.position||(e.selectAll(".axis-y.axis-index-0 span").style("color",t.colors[0]),e.selectAll(".axis-y.axis-index-1 span").style("color",t.colors[1]),e.selectAll(".axis-title-y.axis-title-index-0").style("color",t.colors[0]),e.selectAll(".axis-title-y.axis-title-index-1").style("color",t.colors[1]))},a._createSeriesStates=function(){var t=this._options;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");var e=this._dataAdapter.data()[this._getPropMapping("series")],n=this._dataAdapter.data()[this._getPropMapping("seriesLabel")];if(e)for(var i=e.reduce(function(t,e,i){return 0>t.ids.indexOf(e)&&(t.ids.push(e),t.names.push(n?n[i]:e)),t},{names:[],ids:[]}),r=i.ids.length;r--;){var a=i.names[r],s=i.ids[r];this._seriesState.insertState(a||s,s,"standard")}}"targetValues"in this._changedOptions&&t.targetValues&&(this._seriesState.removeStatesByType("target"),this._seriesState.appendState(t.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target"))},a._createTargetHLines=function(){var t=this._options,e=this._chart,n=this;if(t.targetValues&&t.targetValues.length){var a,s=e.layers(),o=i.geom.hline(),l=n._seriesState.isSeriesEnabled("target","target"),c={y:[],name:[]},u=t.targetValues.length,d=[0,this._isSmallChart()?24:6];for(a=0;u>a;a++)c.y.push(t.targetValues[a]);o.data(c).position("identity").map("y","y",i.scale.linear().includeInDomain(function(){return n._valuesAreFilterable()?l:!0}).rangePadding(d)).each("start",function(){r.select(this).attr("legend-type","target")}),"line"===this._type?s.unshift(o):s.push(o),e.layers(s)}},a._updateYAxisHitBox=function(t){var e=this,n=this._options,i=this._chart.facet().getPanel(0);if(i){var r=this._isSmallChart(),a=this._isNormalized&&this._isNormalized(),s=this._chart.getTrainedScale("y"),o=s&&0>=s.naturalDomain()[0],l=i.bounds().left,c=s.range()[1],u=s.range()[0],d=t.selectAll(".axes-labels .axis-y.axis-index-0"),h=d.selectAll(".cv-axis-hitbox").data([0]);!n.interactive||r||a||o||"identity"!==n.position?this._removeYAxisHitBox(t):(h.enter().append("div").classed("cv-axis-hitbox",!0),h.on("click",function(){n.interactive&&!r&&(e._dataAdapter._forceZero=!e._dataAdapter._forceZero,e._render(!0),e._postRender())}),"none"!==this._legend&&this._legend.isVertical()&&(l-=this._legend._getUsedWidth()),h.style("width",l+"px").style("height",u-c+"px").style("top",c+"px").style("left",-l+"px"),h.exit().on("click",null))}else this._removeYAxisHitBox(t)},a._render=function(t){Object.getPrototypeOf(a)._render.apply(this,arguments);var e,n=this._options;try{if(!this._dataAdapter.isDataValid())throw e=Error("The chart data is invalid"),e.code="invaliddata",e;if(!n.parent)throw Error("The chart options did not contain a parent");return this._draw(t)}catch(i){this.handleError(i)}},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments)},a.destroy=function(){return Object.getPrototypeOf(a).destroy.apply(this,arguments),this._options&&this._options.parent&&r.select(this._options.parent).select(".cv-wrapper").remove(),this},a._isMappedAndExistsInData=function(t){var e=this._getPropMapping(t);return e&&this._options.data[e]},a._setChartCoreOptions=function(){var t=this._options,e=this._chart,n=this,i=t.aspectRatio,a=t.width,s=t.height,o=r.select(t.parent);if(e.data(this._dataAdapter.data()).width(null!==i&&null!==s?s*i:a).height(null!==i&&null!==a?a/i:s),!this._isSmallChart()){var l={left:10};t.dualYAxis&&(l.right=10),e.padding(l)}var c=o.selectAll(".cv-wrapper").data([0]);c.enter().insert("div",":first-child").classed("cv-wrapper",!0),c.classed({interactive:t.interactive,"right-overflow":this._adjustClipWidth,"cv-small-chart":this._isSmallChart()}),e.parent(c.node()),this._legend=this._buildLegend(),this._seriesState.on("enableChange.paths",function(){n._preRender(),n._render(!0),n._postRender(),setTimeout(function(){n._updatePathStates()},10)})},a._draw=function(t){var e=this._chart,n=(this._options,void 0===t?!1:t);if(!e)throw Error("DV Chart was not created");return this._setChartCoreOptions(),this._setChartTypeOptions(),this._createTargetHLines(),this._isSmallChart()?this._drawSmall():this._drawLarge(),n?e.duration(1e3):e.duration(0),this._renderChart(),this},a._drawBackground=function(){var t=this._options;if(t.interactive){var e=r.select(t.parent).select(".cv-wrapper"),n=e.selectAll(".cv-bg").data([0]);n.enter().insert("div",":first-child").classed("cv-bg",!0);var i=this._chart,a=r.select(t.parent).select(".cv-legend"),s="none"!==this._legend&&this._legend.isVertical()||!a[0][0]?0:1,o=1,l=i.padding(),c=i.facet().getPanel(i.facet()._panels.length-1).bounds(),u=i.plotBounds(),d=this._chart._legends&&this._chart._legends.hasOwnProperty("_w")?this._chart._legends._w:0,h=u.top-s-l.top,p=i._calcWidth-d,f=c.top+c.height-u.top+s+l.top;if(n.style("top",h+"px").style("left",d+"px").style("height",f+o+"px").style("width",p+"px"),"none"!==this._legend&&this._legend.isVertical()){var g=1,_=r.select(t.parent).selectAll(".cv-legend"),m=a[0][0]&&_.node().offsetHeight||0,v=m>=f-g;_.style("height",v?f-g+"px":null).classed("clipped",v)}}},a._drawClipping=function(){var t=this._chart,e=this._options,n=r.select(t._svgContainer[0][0]),i=n.selectAll("defs").data([0]);
i.enter().insert("defs",":first-child");var a="cv-clip"+this.clipIdCounter.count++,s=i.selectAll(".cv-clip").data([0]);s.enter().append("clipPath").classed("cv-clip",!0).append("rect"),s.attr("id",a);var o=s.selectAll("rect"),l=t.padding(),c=t.facet().getPanel(t.facet()._panels.length-1).bounds(),u=t.plotBounds(),d=u.left-l.left,h=u.top,p=u.right-d+l.right,f=c.top+c.height-u.top;e.interactive&&(p-=1,f-=1),this._adjustClipHeight&&(f+=this._adjustClipHeight),this._adjustClipWidth&&(p+=this._adjustClipWidth),o.attr("x",d).attr("y",h).attr("width",Math.max(p,0)).attr("height",Math.max(f,0)),n.selectAll(".geom").attr("clip-path",null),n.selectAll(".geom:not(.no-clip)").attr("clip-path","url(#"+a+")")},a._renderChart=function(){var t=this,e=this._options;"function"==typeof e.preRender&&e.preRender(this.getChart()),this._chart.render(),this._drawBackground(),this._drawClipping(),setTimeout(function(){t._updatePathStates()},10)},a._onAutoResize=function(){this._draw(!1)},a._setChartTypeOptions=function(){},a._drawSmall=function(){},a._drawLarge=function(){},a._isSmallChart=function(){return Object.getPrototypeOf(a)._isSmallChart.apply(this,[this._getChartWidth()])},a._getChartWidth=function(){var t=this._options;if(null!==t.plotWidth&&!i.util.isPercentString(t.plotWidth))return t.plotWidth;if(null!==t.width&&!i.util.isPercentString(t.width))return t.width;var e=r.select(t.parent).node().offsetWidth,n=r.select(t.parent).node().offsetHeight;return null!==t.plotWidth?parseInt(t.plotWidth,10)/100*e:null!==t.width?parseInt(t.width,10)/100*e:null!==t.aspectRatio&&null!==n?n*t.aspectRatio:e},a._getChartHeight=function(){var t=this._options;if(null!==t.plotHeight&&!i.util.isPercentString(t.plotHeight))return t.plotWidth;if(null!==t.height&&!i.util.isPercentString(t.height))return t.height;var e=r.select(t.parent).node().offsetWidth,n=r.select(t.parent).node().offsetHeight;return null!==t.plotHeight?parseInt(t.plotHeight,10)/100*n:null!==t.height?parseInt(t.height,10)/100*n:null!==t.aspectRatio&&null!==e?e/t.aspectRatio:n},a._constructScale=function(t,e){var n=e||i.scale.linear(),r=this._options;return r.interactive&&(n=this._adjustLimits(n)),"y"===t&&this._dataAdapter._forceZero&&this._applyForceZero(n),n},a._applyForceZero=function(t){return t.lowerLimit(function(t){return 0>t?t:0}),t.upperLimit(function(t,e){return e>0?e:0}),t},a._adjustLimits=function(t){var e=this;return this._options,t.includeInDomain(function(t){return e._valuesAreFilterable()?e._seriesState.isSeriesEnabled(t.data[e._legend.mapping()],"standard"):!0}),t},a._valuesAreFilterable=function(){return this._options.interactive&&this._seriesState.areSomeSeriesDisabled()&&!this._seriesState.areAllSeriesDisabled()},a._getEnabledValues=function(t){var e=this,n=(this._options,this._dataAdapter.data()[this._getPropMapping(t)]);if(!this._valuesAreFilterable())return n;var i=this._dataAdapter.data()[this._legend.mapping()];return n=n.filter(function(t,n){return i[n]&&e._seriesState.isSeriesEnabled(i[n],"standard")})},a._updatePathStates=function(){var t=this,e=this._options,n=r.select(e.parent);n.selectAll(".series [legend-group]").classed("path-inactive",function(){if(!e.interactive)return!1;var n=r.select(this),i=n.attr("legend-group");return t._seriesState.doesSeriesStateExist(i,"standard")?!t._seriesState.isSeriesEnabled(i,"standard"):n.classed("path-inactive")}),e.targetValues&&n.selectAll(".series [legend-type]").classed("path-inactive",function(){if(!e.interactive)return!1;var n=r.select(this),i=n.attr("legend-type");return t._seriesState.doesSeriesStateExist("target",i)?!t._seriesState.isSeriesEnabled("target",i):n.classed("path-inactive")})},a._buildLegend=function(t,e){var n=null,i=this._options,a=r.select(i.parent).select(".cv-wrapper"),s=this._getPropMapping(t||"series"),o=this._getPropMapping(e||"seriesLabel");if(s&&o&&s!==o){var l=this._dataAdapter.data(),c=l[s],u=l[o]||c;n=[],c.forEach(function(t,e,i){i.indexOf(t)===e&&n.push(u[e])})}return i.legendVisible?i.interactive?this._buildInteractiveLegend(n):this._buildStandardLegend(n):(a.selectAll(".cv-legend").remove(),a.selectAll(".cv-bg").remove(),"none")},a._buildStandardLegend=function(t){var e=this._options,n=r.select(e.parent).select(".cv-wrapper");this._legend=null,n.selectAll(".cv-legend").remove(),n.selectAll(".cv-bg").remove();var a,s=this.LEGEND_ORIENTATIONS.indexOf(e.legendOrientation)>-1?e.legendOrientation:"top";switch(this._calculatedLegendOrientation){case"top":case"bottom":a={top:5,bottom:5,left:0,right:0};break;case"left":case"right":a={top:0,bottom:0,left:5,right:5}}var o=i.guide.legend().orientation(s).padding(a);return t&&o.labels(t),this._isSmallChart()&&o.hGap(10).vGap(2),o},a._buildInteractiveLegend=function(t){var n=this._options,i=r.select(n.parent).select(".cv-wrapper");this._legend||(this._legend=e.interactiveLegend());var a=this._dataAdapter.data()[this._getPropMapping("series")],s=a.some(function(t,e,n){return t!==n[e-1]});return s?(this._legend.parent(i.node()).orientation(n.legendOrientation).chartWidth(this._getChartWidth()).chartHeight(this._getChartHeight()).chartPadding(this._chart.padding()).validOrientations(this.LEGEND_ORIENTATIONS).legendVerticalWidth(n.legendVerticalWidth).type(this._type).seriesState(this._seriesState),t&&this._getCategoryTotal&&this._legend.totals(t.map(function(t){return this._getCategoryTotal(t)})),this._legend):(this._legend.remove(),i.selectAll(".path-inactive").classed("path-inactive",!1),"none")},a._numXTicks=function(){return function(t){return Math.max(t/120,2)}},a._yTitleFormat=function(t,e){var n,r,a=this._dataAdapter,s=a.yAxisTitle(),o=a.l10n,l=this._getYFormatType(t);return"time"===l&&(e||(e=this._getEnabledValues("y")),n=this._yTimeGranularity(e,i.guide.axis().ticks()()),n=o.time.plural[n.gran],r=s?o.labels.dvcore.yAxisTimeWithTitle:o.labels.dvcore.yAxisTimeNoTitle,s=r.replace(/\{time\}/i,n).replace(/\{title\}/i,s)),s},a._formatYValue=function(t,e,n){return n&&n.divisor>0&&(t/=n.divisor),this._formatNumber(e,t)},a._getYFormatType=function(t){var e=this._dataAdapter.formats().y;return e?i.util.isArray(e)?e[t]?e[t]:"decimal":e:"decimal"},a._yLabelFormat=function(t){var e=this._getYFormatType(t),n=this._dataAdapter,i=this;return function(t){var r,a,s=n.l10n.time;return"time"===e&&(a=n.getTimeGranularity(t,!0),s=1!==+t?s.plural:s.singular),r=i._formatYValue(t,e,a),a&&a.gran&&(r+=" "+s[a.gran]),r}},a._yTickFormat=function(t,e){var n,r=this,a=this._getYFormatType(t);return"time"===a&&(e||(e=this._getEnabledValues("y")),n=r._yTimeGranularity(e,i.guide.axis().ticks()())),function(t){return t?r._formatYValue(t,a,n):""}},a._yTimeGranularity=function(t,e){if(t=t&&t.filter(function(t){return isFinite(t)})||[],e=e||1,!t.length)return null;var n=Math.max.apply(null,t),i=Math.min.apply(null,t),a=r.scale.linear().domain([i,n]).ticks(e),s=a.length?a.length>1?a[1]-a[0]:n-a[0]:n,o=a.length?s/a.length:s;return this._dataAdapter.getTimeGranularity(o)},a._xTickAnchor=function(t){return function(e){var n=t.getTrainedScale("x"),r=i.util.scaleRange(n),a=20,s=n.mapValue(e)+n.rangeBand()/2;return a>s-r[0]?"start":a>r[1]-s?"end":"middle"}},a._checkNormalized=function(){var t=this._chart,e=this._dataAdapter.l10n;this._isNormalized&&this._isNormalized()&&(t.guide("y","none",1),t.guide("y",i.guide.axis().ticks(0).tickFormat(function(){return""}).title(e.labels.core.normalized)),t.padding({}))},a._formatTime=function(t,e,n){for(var i=this._dataAdapter.l10n.calendar,a={a:function(t){return i.weekdayAbbreviations[t.getDay()]},A:function(t){return i.weekdays[t.getDay()]},b:function(t){return i.monthAbbreviations[t.getMonth()]},B:function(t){return i.months[t.getMonth()]},p:function(t){return i.ampm[Math.floor(t.getHours()/12)]}},s="",o=-1,l=0,c=e.length,u=function(){var n=e.substring(l,o);n.length&&(s+=r.time.format(n)(t))};c>++o;)if(37==e.charCodeAt(o)){var d=e.charAt(o+1),h=a[d];h&&(u(),s+=h(t),o++,l=o+1)}return u(),"hour"===n&&0===s.indexOf("0")&&(s=s.slice(1)),s},a._timeGranTemplate=function(t,e){var n;switch(t){case"hour":n=e.hour;break;case"day":n=e.day;break;case"week":n=e.week;break;case"month":n=e.month;break;case"quarter":n=e.quarter;break;case"year":n=e.year;break;default:n=e.fallback}return n},a._timeSmallXFormat=function(){var t=this,e=t._dataAdapter,n=e.l10n.dateFormat.fullFormat;return function(e){return t._formatTime(e,n.condensed)}},a._timeXTickFormat=function(t){var e=this,n=(e._options,this._chart,e._dataAdapter),i=new Date(0),r="",a="",s=n.l10n.dateFormat,o=s.mediumFormat,l=n?n.dateGranularity():"*",c=this._timeGranTemplate(l,s.shortFormat);return function(n,s){var u,d,h,p;return 0===s&&(i=new Date(0),r=null,a=null),t&&!t.call(this,n,s)?"":("hour"===l&&i.getDate()!==n.getDate()&&(u=o.day),"day"!==l&&"week"!==l||i.getMonth()===n.getMonth()||(u=o.month),"month"!==l&&"quarter"!==l||i.getYear()===n.getYear()||(u=o.year),i=n,d=e._formatTime(n,c,l),h=u?"<br/>"+e._formatTime(n,u):"<br/>&nbsp;",p=d!==r||h!==a&&u?h?d+h:d:"",r=d,a=h,p)}},t.cloudViz.dvcore=a}(this),function(t){"use strict";var e,n=[],i=function(t,e){var n=-1;return function(){n>-1&&window.clearTimeout(n),n=window.setTimeout(t,e)}},r=i(function(){n.forEach(function(t){t()})},30),a=function(t){-1==n.indexOf(t)&&n.push(t),e||(window.addEventListener("resize",r),e=!0)},s=function(t){var i=n.indexOf(t);i>-1&&n.splice(i,1),0===n.length&&e&&(window.removeEventListener("resize",r),e=!1)};t.cloudViz.windowResize={addHandler:a,removeHandler:s}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(){return Object.getPrototypeOf(a).init.apply(this,arguments),this._type="line",this._chart=i.chart(),this._displayPoints=null,this._adjustClipHeight=6,this._adjustClipWidth=6,this._minTrendTickSpace=135,this._showRibbons=!1,this._uniqueGroups=null,this},a._initDefaultOptions=function(){var t={filled:!1,position:"identity",forceZero:null,dualYAxis:!1,showAnomalies:!1,mappings:{upperRangeBand:"upper",lowerRangeBand:"lower",forecast:"forecast"},formats:{x:"decimal",y:"decimal"}};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments);var t=this._options,e=r.select(t.parent);e.selectAll(".behavior").text(""),e.selectAll(".behavior-under-geom").text(""),this._chart.on("mousemove.inspector",null),this._chart.on("mouseout.inspector",null),e.selectAll(".axis-y.axis-index-1").remove()},a._setChartTypeOptions=function(){var t=this._chart,e=this._options,n=this,a=[i.geom.line().each("start",function(t){r.select(this).attr("legend-group",t[0].stroke)}).map("stroke",this._getPropMapping("series"),i.scale.color().values(e.colors))];this._uniqueGroups=i.util.uniq(t.data()[this._getPropMapping("series")]),this._showRibbons=1==this._uniqueGroups.length&&this._isMappedAndExistsInData("upperRangeBand")&&this._isMappedAndExistsInData("lowerRangeBand"),this._showRibbons&&(a.unshift(i.geom.ribbon().map("yMin",this._getPropMapping("lowerRangeBand")).map("yMax",this._getPropMapping("upperRangeBand")).set("alpha",.15).interpolate("cardinal")),e.filled=!1),this._showRibbons&&this._isMappedAndExistsInData("forecast")&&a.push(i.geom.line().map("y",this._getPropMapping("forecast")).set("alpha",.5).set("linetype","dotted").interpolate("cardinal")),e.filled&&a.push(i.geom.area().baseline(void 0).each("start",function(t){r.select(this).attr("legend-group",t[0].fill)}).map("fill",this._getPropMapping("series"),i.scale.color().values(e.colors)).set("alpha",.2));var s=i.geom.point().map("stroke",this._getPropMapping("series"),i.scale.color().values(e.colors)).set("fill","#fff").set("size",7);a.push(s);var o=this._getPropMapping("group")||this._getPropMapping("series");t.layers(a).guide("stroke",this._legend).map("group",o).set("linetype",function(t){return/::incomplete::$/.test(t.data[o])?"0,4,7,0":"solid"}).position(e.position),s.each("start",function(t){r.select(this).classed("point-hidden",!n._shouldDisplayPoint.call(n,t)).attr("legend-group",t.stroke).classed("line-point",!0)}),this._addBehaviors(t,e),this._mapPositionScales(t,e)},a._shouldDisplayPoint=function(t){return this._showRibbons?this._isAnomalousDataPoint(t):this._shouldDisplayPoints()},a._shouldDisplayPoints=function(){if(null!==this._displayPoints)return this._displayPoints;var t=this._options,e=this._chart,n=e.layers()[1]._nestData,i=Math.max.apply(null,n.map(function(t){return t.values.length})),r=e.getTrainedScale("x").range();return this._displayPoints=t.showAnomalies&&this._showRibbons||(r[1]-r[0])/i>=60},a._isAnomalousDataPoint=function(t){return t.data[this._getPropMapping("y")]>t.data[this._getPropMapping("upperRangeBand")]||t.data[this._getPropMapping("y")]<t.data[this._getPropMapping("lowerRangeBand")]},a._addBehaviors=function(t,e){var n=this,a=r.select(e.parent),s=this._dataAdapter,o=s.formats().x;e.interactive&&t.behaviors([i.behavior.inspector().gutterPadding(0).orientation("bottom").thickness(2).label(function(t){if(s.isOvertime()){var e=s.dateGranularity(),i=s.l10n.dateFormat.fullFormat;return n._formatTime(t,n._timeGranTemplate(e,i),e)}return n._formatNumber(o,t)}).inspectorMove(function(e,i,s,o){var l=t.getTrainedScale("stroke")[0];n._highlightHoveredPoints.call(n,a,o,l),a.selectAll(".axis-x .axis-label").style("opacity",0),a.selectAll(".axis-x-title").style("opacity",0),a.selectAll(".text-geom").style("opacity",0),n._eventMap.mouseover&&n._eventMap.mouseover.call(this,e,i,s,o,r.event)}).inspectorOut(function(){var e=t.getTrainedScale("stroke")[0];n._highlightHoveredPoints.call(n,a,null,e),a.selectAll(".axis-x .axis-label").style("opacity",1),a.selectAll(".axis-x-title").style("opacity",1),a.selectAll(".text-geom").style("opacity",1),n._eventMap.mouseout&&n._eventMap.mouseout.call(this,r.event)}).underGeoms(!0)])},a._highlightHoveredPoints=function(t,e,n){var a={},s=this,o=n.domain();t.selectAll(".line-point").each(function(t){var i=r.select(this),l=n.mapValue(t.stroke),c=s._dataValuesEqual.call(s,t.x,e),u=i.datum();i.classed("point-hidden",c?!1:!s._shouldDisplayPoint.call(s,t)),i.style("fill",c?l:"#FFF").style("opacity",c?1:""),c&&(a[i.attr("legend-group")]={yVal:u.y,scaleIndex:o.indexOf(t.stroke)})}),t.selectAll(".cv-legend-entry").each(function(t){var e=t.id,n=a[e],o=r.select(this).select(".cv-legend-num");if(!n)return o.text("");var l,c=s._getYFormatType(n.scaleIndex),u=n.yVal;if("time"===c){var d=s._dataAdapter.l10n,h=s._yTimeGranularity(s._dataAdapter.getUniqueStrokeExtentByStroke(e),i.guide.axis().ticks()()),p=d.time.plural[h.gran],f=d.labels.dvcore.legendTime;h&&h.divisor>0&&(u/=h.divisor),l=f.replace(/\{time\}/i,p).replace(/\{value\}/i,s._formatNumber(c,u))}else l=s._formatNumber(c,u);o.text(l)})},a._dataValuesEqual=function(t,e){return t&&e?this._dataAdapter.isOvertime()&&t.getTime()===e.getTime()?!0:t===e:!1},a._mapPositionScales=function(t,e){var n=[0,this._isSmallChart()?24:6],r=this._constructScale("y").rangePadding(n),a=this._getPropMapping("series"),s=this._getPropMapping("y"),o=this._getPropMapping("x"),l=this;if(null===l._dataAdapter._forceZero&&e.filled&&(l._dataAdapter._forceZero=!0,this._applyForceZero(r)),!e.dualYAxis||"identity"!==e.position&&"dodge"!==e.position){var c=t.getExplicitScalesMap().y;c&&delete c[1]}else{var u=l._dataAdapter.uniqueStrokeValues();u.forEach(function(e,n){var i=0===n?r:r.copy();i.includeInDomain(function(t){return t.data[a]===l._dataAdapter.uniqueStrokeValues()[n]}),n>0&&t.map("y",s,i,n)})}var d=this._dataAdapter.isOvertime()?i.scale.time():i.scale.linear();d.rangePadding([10,10]),t.map("y",s,r,0),t.map("x",o,this._constructScale("x",d))},a._xTickFormat=function(){var t=this,e=this._dataAdapter,n=e.formats().x;return function(e){return t._formatNumber(n,e)}},a._drawSmall=function(){var t=this._options,e=this._chart,n=this,a=this._computeExtents(),s=r.extent(this._getEnabledValues("x")),o=this._getYFormatType(0),l=i.guide.axis().tickSize(0).title(this._dataAdapter.xAxisTitle()).tickDy(a.y.length>1?-26:-14).tickAnchor(function(t,e){return e>0?"end":"start"}),c=i.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()),u=t.dualYAxis||"stack"===t.position&&this._uniqueGroups.length>1;if(!u){var d=[i.geom.point().data(a).set("stroke","none").map("y","y",i.scale.linear()).map("x","x",this._dataAdapter.isOvertime()?i.scale.time():i.scale.linear()).each("start",function(t){var e=t.panel.getTrainedScale("fill")[0],n=r.select(this);n.style("fill",e.mapValue(t.data.fill)).attr("legend-group",t.data.fill)}).map("group","fill").set("size",6),i.geom.text().data(a).set("stroke","none").map("y","y",i.scale.linear()).map("x","x",this._dataAdapter.isOvertime()?i.scale.time():i.scale.linear()).each("start",function(t){var e=t.panel.getTrainedScale("fill")[0],n=r.select(this);n.style("fill",e.mapValue(t.data.fill)).attr("legend-group",t.data.fill),this.parentNode&&r.select(this.parentNode.parentNode).classed("no-clip",!0).attr("clip-path",null)}).map("group","fill").set("size","11px").set("label",function(t){var e=t.panel.getTrainedScale("fill")[0].domain(),r=e.indexOf(t.data.fill),a=n._yTickFormat(r)(t.y);if("time"===o){var s=n._yTimeGranularity(n._getEnabledValues("y"),i.guide.axis().ticks()());a+=" "+n._dataAdapter.l10n.time.plural[s.gran]}return a}).textAnchor(function(t){return t.data&&t.data.anchor||"middle"}).dy(function(t){return 1===a.y.length||t.y===a.y[1]?-8:15}).dx(function(t){return t.data&&"end"==t.data.anchor?3:0})];e.layers(e.layers().concat(d))}if(e.map("fill",this._getPropMapping("series"),i.scale.color().values(t.colors)),this._dataAdapter.isOvertime())l.tickValues(s).tickFormat(n._timeSmallXFormat()),u?c.tickFormat(this._yTickFormat(0)):c.tickFormat(function(){return""});else if(t.dualYAxis){var h=i.guide.axis().tickFormat(this._yTickFormat(1)).orientation("right").tickSize(15).tickDy(-8).tickAnchor("end").tickDx(4).ticks(3);c.tickSize(15).tickDy(-8).tickAnchor("start").tickDx(4).ticks(3),e.guide("y",h,1)}else{var p=r.extent(this._dataAdapter.data()[this._getPropMapping("x")]);l.tickValues(p).tickFormat(this._xTickFormat()),c.tickFormat(this._yTickFormat(0)),e.guide("y","none",1)}e.guide("x",l).guide("y",c),this._checkNormalized()},a._numXTicks=function(){var t=this;if(this._dataAdapter.isOvertime()){var e=this._chart._data[this._getPropMapping("x")].length;return function(n){var i=Math.max(n/e,t._minTrendTickSpace);return Math.max(Math.min(Math.floor(n/i),e),2)}}return Object.getPrototypeOf(a)._numXTicks.call(this)},a._drawLarge=function(){var t,e=this._options,n=this._chart,a=(r.select(e.parent),!1),s=this._dataAdapter.getUniqueStrokeExtent(0),o=this._dataAdapter.getUniqueStrokeExtent(1),l=i.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickDy(-8).tickAnchor(this._xTickAnchor(n)),c=i.guide.axis().htmlLabels(!0);if(this._dataAdapter.isOvertime()?l.tickFormat(this._timeXTickFormat()).htmlLabels(!0):l.tickFormat(this._xTickFormat()),!e.dualYAxis||"identity"!==e.position&&"dodge"!==e.position)t=this._yTickFormat(0),c.title(this._yTitleFormat(0)),n.guide("y","none",1);else{t=this._yTickFormat(0,s),c.title(this._yTitleFormat(0,s));var u=i.guide.axis().tickFormat(this._yTickFormat(1,o)).title(this._yTitleFormat(1,o)).orientation("right").tickSize(15);c.tickSize(15),n.guide("y",u,1)}c.tickFormat(function(n,s){var o=r.select(this),l=c._scale();if(l instanceof i.scale.linear&&n>0&&(0===s||1===s&&a)){if(!(l.mapValue(n)<l.range()[0]-10)&&e.interactive)return a=!0,o.classed("arrow-container",!1),"";o.classed("arrow-container",!0)}else o.classed("arrow-container",!1);return t.call(this,n,s)}),n.guide("x",l).guide("y",c),this._checkNormalized()},a._preRender=function(){Object.getPrototypeOf(a)._preRender.call(this),this._displayPoints=null},a._computeExtents=function(){var t=-1,e=this._options,n=this._getEnabledValues("y"),i=this._getEnabledValues("x"),r=this._getEnabledValues("series"),a=n.length,s={x:[void 0,void 0],y:[void 0,void 0],fill:[void 0,void 0],anchor:[void 0,void 0]},o=null,l=null;for(i.forEach(function(t){o=null===o||o>t?t:o,l=null===l||t>l?t:l});a>++t;){var c=n[t],u=i[t],d=r?r[t]:e.colors[0];(void 0===s.y[0]||s.y[0]>c)&&(s.y[0]=c,s.x[0]=u,s.fill[0]=d,s.anchor[0]=+u==+o?"start":+u==+l?"end":"middle"),(void 0===s.y[1]||c>s.y[1])&&(s.y[1]=c,s.x[1]=u,s.fill[1]=d,s.anchor[1]=+u==+o?"start":+u==+l?"end":"middle")}return 0===s.y[0]&&(s.y.splice(0,1),s.x.splice(0,1),s.fill.splice(0,1),s.anchor.splice(0,1)),s},a._isNormalized=function(){var t=this._options,e=this._isSmallChart()?1:2;return t.dualYAxis&&this._dataAdapter.uniqueStrokeValues().length>e&&("identity"===t.position||"dodge"===t.position)},t.cloudViz.line=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(){return Object.getPrototypeOf(a).init.apply(this,arguments),this._type="point",this._chart=i.chart(),this._selectedIds=[],this},a.getSelected=function(){return this._selectedIds},a.setSelected=function(t){var e=this;return this._selectedIds=[],r.select(this._options.parent).selectAll(".point-geom").each(function(n){var i=n.data.id;t.indexOf(i)>=0?(e._selectedIds.push(i),e._highlight(r.select(this),!0)):e._highlight(r.select(this),!1)}),e},a._initDefaultOptions=function(){var t={mappings:{size:"size"},sizeTitle:"",formats:{x:"decimal",y:"decimal",size:"decimal"},selectionEnabled:!1,tooltipContent:null};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a._setChartTypeOptions=function(){var t=this._chart,e=this._options,n=[];n[0]=i.geom.point().each("start",function(t){r.select(this).attr("legend-group",t.fill)}),t.layers(n).map("x",this._getPropMapping("x"),this._constructScale("x").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("y",this._getPropMapping("y"),this._constructScale("y").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("fill",this._getPropMapping("series"),i.scale.color().values(e.colors)).guide("fill",this._legend).padding({left:10}),this._dataAdapter.isBubble()?n[0].map("size",this._getPropMapping("size"),i.scale.linear().to([9,60])):n[0].set("size",10).set("alpha",.6),this._addBehaviors(t,n[0],e)},a._addBehaviors=function(t,e,n){var a,s=r.select(n.parent),o=this,l=this._getYFormatType(),c=function(t,e,n,i){return t.data.hasOwnProperty(e.mapping())?'<span class="metric-value">'+n(t.data[e.mapping()])+'</span><span class="metric-name">'+i+"</span>":""},u=function(t,e){var i=[];r.select(n.parent).selectAll(".point-geom").each(function(t){if(e[0][0]<=t.data.x&&e[1][0]>=t.data.x&&e[0][1]<=t.data.y&&e[1][1]>=t.data.y&&o._seriesState.isSeriesEnabled(t.data.series,"standard")){if(void 0===t.data.id)throw Error("undefined id for selected data point "+JSON.stringify(t.data));i.push(t.data.id)}}),o.setSelected(i),o._eventMap.selectionStart&&"start"===t&&o._eventMap.selectionStart.call(o,i),o._eventMap.selectionEnd&&"end"===t&&o._eventMap.selectionEnd.call(o,i)};n.selectionEnabled?t.behaviors([i.behavior.brush().brushStart(u).brushMove(u).brushEnd(u)]):t.behaviors([]),!this._isSmallChart()&&n.interactive&&e.behaviors([i.behavior.voronoiRollover().pointDetectionRadius(25).content(function(t,e,i){if(n.tooltipContent)return n.tooltipContent.call(this,t,e,i);var r=this.__geom.getExplicitScale("group"),a=t.panel.xScale(t),s=t.panel.yScale(t),u=this._xGuides[a.scaleIndex()],d=(this._yGuides[s.scaleIndex()],o._dataAdapter.l10n),h=u.__scale&&u.tickFormat()?u.tickFormat():String,p=function(t){return o._formatNumber(l,t)},f=c(t,s,p,o._dataAdapter.yAxisTitle()||d.labels.point.yScale)+c(t,a,h,o._dataAdapter.xAxisTitle()||d.labels.point.xScale);if(o._dataAdapter.isBubble()){var g=t.panel.getTrainedScale("size")[0];f+=c(t,g,String,o._dataAdapter.sizeMetricName()||d.labels.point.sizeScale)}return r&&r.mapping()&&(f='<span class="series-name">'+t.data[r.mapping()]+"</span>"+f),f}).mouseOver(function(t,e,n,i){clearTimeout(a),s.selectAll(".point-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t!==e}),s.selectAll(".cv-legend-marker").classed("unselected",function(e){return e!==t.fill}).classed("cv-medium-duration",!1),o._eventMap.mouseover&&o._eventMap.mouseover.call(this,t,e,n,i)}).mouseOut(function(t,e,n,i){a=setTimeout(function(){s.selectAll(".point-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),s.selectAll(".cv-legend-marker").classed("unselected",!1).classed("cv-medium-duration",!0),o._eventMap.mouseout&&o._eventMap.mouseout.call(this,t,e,n,i)},400)})])},a._drawSmall=function(){var t=this._chart,e=r.extent(this._getEnabledValues("x")),n=this,a=this._dataAdapter,s=a.formats().x,o=this._getYFormatType();t.guide("x",i.guide.axis().tickSize(0).tickValues(e).title(this._dataAdapter.xAxisTitle()).tickFormat(function(t){return n._formatNumber(s,t)}).tickAnchor(function(t,e){return e>0?"end":"start"})).guide("y",i.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(t){return t?n._formatNumber(o,t):""}))},a._drawLarge=function(){var t=this._chart,e=function(t){return Math.max(2,Math.min(5,t/70))},n=this,r=this._dataAdapter,a=r.formats().x,s=this._getYFormatType();t.guide("x",i.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickFormat(function(t){return n._formatNumber(a,t)})).guide("y",i.guide.axis().ticks(e).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(t){return t?n._formatNumber(s,t):""}))},a._postRender=function(){Object.getPrototypeOf(a)._postRender.call(this);var t=this._options,e=this._chart,n=5,i=r.select(t.parent).select(".cv-wrapper"),s=i.selectAll(".cv-bubble-size-metric").data([0]);this._dataAdapter.sizeMetricName()?(s.enter().append("div").classed("cv-bubble-size-metric",!0).html("<span>"+this._dataAdapter.sizeMetricName()+"</span>  <i></i> &ndash; <i></i>"),setTimeout(function(){var t=e.padding(),i=e.facet().getPanel(e.facet()._panels.length-1).bounds(),r=e.plotBounds(),a=(s.selectAll("span"),r.right+t.right),o=i.top+i.height,l=a-s.node().offsetWidth-n,c=o-s.node().offsetHeight;s.style("top",c+"px").style("left",l+"px")},300)):s.remove()},t.cloudViz.point=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(){return Object.getPrototypeOf(a).init.apply(this,arguments),this._type="bar",this._chart=i.chart(),this._minTickSpace=60,this},a._initDefaultOptions=function(){var t={position:"dodge",dualYAxis:!1,clickHandler:null,formats:{x:"decimal",y:"decimal"},tooltipContent:null};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments);var t=this._options,e=r.select(t.parent);e.selectAll(".axis-y.axis-index-1").remove()},a._setChartTypeOptions=function(){var t=this._chart,e=this._options;t.layers([i.geom.bar().each("start",function(t){r.select(this).attr("legend-group",t.fill)})]).map("fill",this._getPropMapping("series"),i.scale.color().values(e.colors)).guide("fill",this._legend).position(e.position).coord(i.coord.cartesian().flip(e.flip)),t._layers[0].on("click",this._eventMap.click?this._eventMap.click:null),this._addBehaviors(t.layers()[0],e),this._mapPositionScales(t,e)},a._mapPositionScales=function(t,e){var n=this._isSmallChart(),r=[0,n?10:15],a=this._applyForceZero(this._constructScale("y")).rangePadding(r),s=this._getPropMapping("series"),o=this._getPropMapping("y"),l=(this._getPropMapping("x"),n?.8:Math.min(.6,Math.max(.05,this._getChartWidth()/4e3))),c=n?0:.5,u=this;if(!e.dualYAxis||"identity"!==this._options.position&&"dodge"!==this._options.position){var d=t.getExplicitScalesMap().y;d&&delete d[1]}else{var h=u._dataAdapter.uniqueFillValues();h.forEach(function(e,n){var i=0===n?a:a.copy();i.includeInDomain(function(t){return t.data[s]===u._dataAdapter.uniqueFillValues()[n]}),n>0&&t.map("y",o,i,n)})}t.map("y",o,a,0),t.map("x",this._getPropMapping("x"),i.scale.ordinal().padding(l).outerPadding(c).reverse(e.flip))},a._addBehaviors=function(t,e){var n,a=r.select(e.parent),s=this._dataAdapter,o=this;!this._isSmallChart()&&e.interactive&&t.behaviors([i.behavior.rollover().orientation(e.flip?"top":"right").content(function(t,n,r){if(e.tooltipContent)return e.tooltipContent.call(this,t,n,r);var a=this.__geom.getExplicitScale("group"),l=t.panel.yScale(t),c=o._yLabelFormat(l.scaleIndex()),u='<span class="metric-value">'+c(t.y)+'</span><span class="metric-name">'+t.data[o._getPropMapping("seriesLabel")]+"</span>",d=s.dateGranularity(),h=s.l10n.dateFormat.fullFormat,p=i.util.isDate(t.x)?o._formatTime(t.x,o._timeGranTemplate(d,h),d):t.x;return a&&a.mapping()&&(u='<span class="series-name">'+p+"</span>"+u),u}).showTooltip(function(t,e,i,s,l){var c=r.select(this);c.classed("path-inactive")||(l._showTip.call(this,t,e,i,l),clearTimeout(n),a.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t!==e}),a.selectAll(".cv-legend-marker").classed("unselected",function(e){return e!==t.fill}).classed("cv-medium-duration",!1),o._eventMap.mouseover&&o._eventMap.mouseover.call(this,t,e,i,s))}).hideTooltip(function(t,e,i,s,l){var c=r.select(this);c.classed("path-inactive")||(l._removeTip.call(this,t,e,i,l),n=setTimeout(function(){a.selectAll(".bar-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),a.selectAll(".cv-legend-marker").classed("unselected",!1).classed("cv-medium-duration",!0),o._eventMap.mouseout&&o._eventMap.mouseout.call(this,t,e,i,s)},400))})])},a._drawSmall=function(){var t,e=this._chart,n=this._options,a=n.flip?void 0:10,s=this;t=n.flip?i.guide.axis().tickDx(function(){return r.select(this).select("span").node().offsetWidth}).tickDy(function(){return-r.select(this).select("span").node().offsetHeight}).tickSize(0):i.guide.axis().tickSize(0).tickDy(function(t,e){return 0===e%2?-8:-26}),this._dataAdapter.isOvertime()?t.tickValues(r.extent(this._dataAdapter.data()[this._getPropMapping("x")])).tickFormat(s._timeSmallXFormat()).tickAnchor(function(t,e){return e>0?"end":"start"}).tickDy(-8):t.tickFormat(function(t){return s._truncateLabel(t,a)}),e.guide("x",t.title(this._dataAdapter.xAxisTitle())).guide("y",i.guide.axis().ticks(0).tickSize(0).tickFormat(function(){return""}).title(this._dataAdapter.yAxisTitle())),this._checkNormalized()},a._drawLarge=function(){var t,e=this._chart,n=this._options,r=this,a=function(t){return Math.max(2,Math.min(5,t/75))},s=i.guide.axis().tickSize(0),o=i.guide.axis().ticks(a);if(!n.dualYAxis||"identity"!==this._options.position&&"dodge"!==this._options.position)o.tickFormat(this._yTickFormat(0)).title(this._yTitleFormat(0)),e.guide("y","none",1);else{var l=r._dataAdapter.getUniqueFillExtent(0),c=r._dataAdapter.getUniqueFillExtent(1);o.tickSize(15).tickFormat(this._yTickFormat(0,l)).title(this._yTitleFormat(0,l)),t=i.guide.axis().ticks(a).tickFormat(this._yTickFormat(1,c)).title(this._yTitleFormat(1,c)).orientation("right").tickSize(15),e.guide("y",t,1)}if(n.flip?s.tickDx(-10):(s.tickDy(function(t,e){return 0===e%2?-8:-26}),o.tickDx(-10),t&&t.tickDx(-10)),this._dataAdapter.isOvertime()){var u={},d=0;e._data[this._getPropMapping("x")].forEach(function(t){u[+t]||(d++,u[+t]=1)}),s.tickDy(-8).tickFormat(this._timeXTickFormat(d)).htmlLabels(!0)}else s.tickFormat(function(t){return r._truncateLabel(t)});e.guide("x",s.title(this._dataAdapter.xAxisTitle())).guide("y",o),this._checkNormalized()},a._timeXTickValidator=function(t){var e=this;return function(n,r){var a=e._chart.getTrainedScale("x"),s=i.util.scaleRange(a),o=s[1]-s[0],l=Math.ceil(e._minTickSpace/(o/t));return 0===r%l}},a._timeXTickFormat=function(t){return Object.getPrototypeOf(a)._timeXTickFormat.call(this,this._timeXTickValidator(t))},a._isNormalized=function(){var t=this._options,e=this._isSmallChart()?1:2;return t.dualYAxis&&this._dataAdapter.uniqueFillValues().length>e&&("identity"===t.position||"dodge"===t.position)},t.cloudViz.bar=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.dvcore||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);
a.init=function(){return Object.getPrototypeOf(a).init.apply(this,arguments),this._type="donut",this._chart=i.chart(),this},a._initDefaultOptions=function(){var t={maxSlices:6,innerRadius:"45%",outerRadius:"35%",clickHandler:null,formats:{x:"decimal",y:"decimal"},tooltipContent:null};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a._buildLegend=function(){var t=this,e=this._options,n=Object.getPrototypeOf(a)._buildLegend.call(this,"x","x");if(this._dataAdapter.processLabelData(n),"none"!==n){if(1==this._dataAdapter.numberOfFacets()){var i=this._dataAdapter.labelData().cvtextvallabel.map(function(e){return t._yLabelFormat(0)(e)});n.values(i)}e.interactive||e.legendOrientation&&"top"!==e.legendOrientation||n.padding({bottom:20})}return n},a._getSeriesTotal=function(t){var e,n=this._dataAdapter,i=n.data(),r=i[this._getPropMapping("y")],a=i[this._getPropMapping("series")],s=a.length,o=0;for(e=0;s>e;++e)a[e]+""==t+""&&(o+=r[e]);return o},a._createSeriesStates=function(){var t=this._options;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");for(var e=i.util.uniq(this._dataAdapter.data()[this._getPropMapping("x")]),n=e.length;n--;){var r=e[n];this._seriesState.insertState(r,r,"standard")}}"targetValues"in this._changedOptions&&t.targetValues&&(this._seriesState.removeStatesByType("target"),this._seriesState.appendState(t.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target"))},a._getCategoryTotal=function(t){if(1!==this._dataAdapter.numberOfFacets())return"";var e,n=this._dataAdapter.data(),i=n[this._getPropMapping("y")],r=n[this._getPropMapping("x")],a=r.length,s=0;for(e=0;a>e;++e)r[e]+""==t+""&&(s+=i[e]);return s},a._shouldHideLabels=function(t){var e=t.panel.bounds();return.05>=t.y||80>Math.min(e.width,e.height)/2},a._setChartTypeOptions=function(){var t=this._chart,e=this._dataAdapter,n=this._options,a=(r.select(n.parent),this),s=n.colors.slice(0);n.interactive&&t.padding({top:10}),e.showOtherCategory()&&s.splice(n.maxSlices-1,0,"#ccc");var o=[i.geom.bar().position("fill").set("stroke","#fff").each("start",function(t){r.select(this).attr("legend-group",t.fill)})];o[0].on("click",this._eventMap.click?this._eventMap.click:null);var l=a._dataAdapter.labelData();o.push(i.geom.text().data(l).map("label","cvtextperclabel").set("stroke","none").position("fill").textAnchor(function(t){var e=100*(t.y0+t.y/2);return 50>e?"start":e>50?"end":"middle"}).each("start",function(t){r.select(this).classed("slice-label",!0).classed("hidden",a._shouldHideLabels.call(a,t)).attr("dy",".35em").attr("legend-group",t.fill)}).set("alpha",function(t){return a._shouldHideLabels.call(a,t)?0:1}).dx(function(t){var e=t.panel.xOuterScale().range(),r=e[1]-e[0],a=r?r/2:0,s=i.util.getPercentValue(n.outerRadius,a),o=30;return 100*(t.y0+t.y/2),a+s-o}).dy(function(t){var e=-t.panel._bounds.width/2*t.y,n=100*(t.y0+t.y/2);return 10>n&&(e-=(10-n)/2),n>90&&(e+=(10-(100-n))/2),50>=n&&n>40&&(e+=(10-(50-n))/2),n>50&&60>n&&(e-=(10-(n-50))/2),e})),t.layers(o).map("group","cvdonutorder").map("x",this._getPropMapping("series"),i.scale.ordinal()).map("y",this._getPropMapping("y"),this._constructScale("y")).map("fill",this._getPropMapping("x"),i.scale.color().values(s)).guide("fill",this._legend).guide(["x","y"],"none").coord(i.coord.polar().flip(!0).innerRadius(n.innerRadius).outerRadius(n.outerRadius)).postrender(function(){var t=r.select(n.parent).select(".cv-wrapper"),e=t.selectAll(".cv-donut-facet-labels").data([0]),s=a._dataAdapter;e.enter().append("div").classed("cv-donut-facet-labels",!0),e.exit().remove();var o=e.selectAll(".cv-donut-facet-label").data(this.facet()._panels);o.enter().append("div").classed("cv-donut-facet-label",!0),o.each(function(t){var e=t.bounds(),o=r.select(this),l=Math.min(e.width,e.height)/2,c=e.height/2-l,u=i.util.getPercentValue(n.innerRadius,l),d=25>u?"small":u>50?"large":"medium",h="large"===d?2*u:e.width,p="large"===d?e.left+e.width/2-h/2:e.left,f="large"===d?e.top+e.height/2-27:e.top+c-10;o.style("top",f+"px").style("width",h+"px").style("left",p+"px").classed("cv-donut-small-facet cv-donut-medium-facet cv-donut-large-facet",!1).classed("cv-donut-"+d+"-facet",!0);var g=o.selectAll(".cv-donut-label-number").data([0]);g.enter().append("div").classed("cv-donut-label-number",!0);var _=a._getSeriesTotal(t.xFacetTitle());g.text(a._yLabelFormat(t._facetIndex)(_));var m=o.selectAll(".cv-donut-label-title").data([0]);m.enter().append("div").classed("cv-donut-label-title",!0),m.text(s.yAxisTitle(t._facetIndex)),"medium"===d&&g.style("top",e.height/2-c+"px")}),o.exit().remove()}),this._addBehaviors(o[0],n)},a._addBehaviors=function(t,e){var n,a=r.select(e.parent),s=this._dataAdapter,o=this;!this._isSmallChart()&&e.interactive&&t.behaviors([i.behavior.rollover().content(function(t,n,r){if(e.tooltipContent)return e.tooltipContent.call(this,t,n,r);var a=this.__geom.getExplicitScale("group"),l=t.panel.yScale(t),c=o._yLabelFormat(l.scaleIndex()),u='<span class="metric-value">'+c(t.data[o._getPropMapping("y")])+'</span><span class="metric-name">'+t.data[o._getPropMapping("seriesLabel")]+"</span>",d=o._dataAdapter.dateGranularity(),h=s.l10n.dateFormat.fullFormat,p=i.util.isDate(t.fill)?o._formatTime(t.fill,o._timeGranTemplate(d,h),d):t.fill;return a&&a.mapping()&&(u='<span class="series-name">'+p+"</span>"+u),u}).showTooltip(function(t,e,i,s,l){var c=r.select(this);c.classed("path-inactive")||(l._showTip.call(this,t,e,i,l),clearTimeout(n),a.selectAll(".bar-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t!==e}),a.selectAll(".text-geom").classed("cv-medium-duration",!1).classed("cv-unselected",function(e){return t.group!==e.group}).classed("cv-selected",function(e){return t.group===e.group}),a.selectAll(".cv-legend-marker").classed("unselected",function(e){return e!==t.fill}).classed("cv-medium-duration",!1),o._eventMap.mouseover&&o._eventMap.mouseover.call(this,t,e,i,s))}).hideTooltip(function(t,e,i,s,l){var c=r.select(this);c.classed("path-inactive")||(l._removeTip.call(this,t,e,i,l),n=setTimeout(function(){a.selectAll(".bar-geom").classed("cv-unselected",!1).classed("cv-medium-duration",!0),a.selectAll(".text-geom").classed("cv-unselected cv-selected",!1).classed("cv-medium-duration",!0),a.selectAll(".cv-legend-marker").classed("unselected",!1).classed("cv-medium-duration",!0),o._eventMap.mouseout&&o._eventMap.mouseout.call(this,t,e,i,s)},400))})])},a._drawSmall=function(){var t=this._chart;this._options,t.facet(i.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(1).titleFormat(void 0))},a._drawLarge=function(){var t=this._chart;t.facet(i.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(3).titleFormat(void 0))},t.cloudViz.donut=e.util.createConstructor(a)}(this),function(t){"use strict";t.cloudViz.interactiveLegend=function(){var e,n,i,r,a,s,o,l,c,u,d,h,p,f=10,g=110,_=250,m=110,v=["top","right","left"],y=!0,x={};return x._render=function(t,e){this._initSVG(e),this._sizeAndPositionLegendEntries(),this._positionLegend()},x._initSVG=function(r){h=d3.select(e).selectAll(".cv-legend").data([0]),h.enter().append("div").classed("cv-legend",!0),d=this._createLegendEntries(h,r),u=Math.min(Math.floor(this._getLegendContainingWidth()/d[0].length),_),this._calculatedLegendOrientation=v.indexOf(n)>-1?n:"top";var a=t.cloudViz.core._isSmallChart(i);switch(g>u&&!a&&("top"==this._calculatedLegendOrientation||"bottom"==this._calculatedLegendOrientation)&&(this._calculatedLegendOrientation="left"),this._calculatedLegendOrientation){case"top":case"bottom":u=Math.max(u,g),h.style("height",null),s=!1;break;case"left":case"right":u=m,s=!0}v.forEach(dv.util.bind(function(t){h.classed(t,this._calculatedLegendOrientation===t)},this))},x._getAdjustedDimensions=function(t){switch(h.node(),this._calculatedLegendOrientation){case"top":t.top+=this._getUsedHeight();break;case"right":t.width-=this._getUsedWidth();break;case"left":t.left+=this._getUsedWidth();break;case"bottom":t.height-=this._getUsedHeight()}return t},x._createLegendEntries=function(t,e){var n,i,r,a,s=c.getStateObjects();for(r in e)a=e[r][0],p=a._mapping;n=t.selectAll(".cv-legend-entry").data(s),i=n.enter().append("div").attr("class",function(t){return"cv-legend-entry cv-legend-"+t.type+"-entry"}),i.append("div").classed("cv-legend-title",!0);var u=i.append("div").classed("cv-legend-details",!0);return u.append("div").classed("cv-legend-marker",!0),u.append("div").classed("cv-legend-num",!0),n.exit().on("click",null).remove(),n.each(function(t,e){var n=d3.select(this);n.select(".cv-legend-title").text(t.name),n.select(".cv-legend-num").text(o&&o.length>e?o[e]:""),n.select(".cv-legend-marker").attr("class","cv-legend-marker "+l).style("background-color",function(t){var e=a.mapValue(t.id);return e?e:null})}),n.classed("inactive",function(t){return y&&!t.enabled}),n.on("click",function(t,e){y&&c.enableStateByIndex(e,!t.enabled)}),n},x._onSeriesEnableChange=function(t,e){y&&d.filter(function(t){return t.id===e.id&&t.type===e.type}).classed("inactive",!e.enabled)},x._positionLegend=function(){var t={top:0,left:0};switch(this._calculatedLegendOrientation){case"bottom":t.top=r-h.node().offsetHeight;break;case"right":t.left=i-m}h.style("top",t.top+"px").style("left",t.left+"px")},x._sizeAndPositionLegendEntries=function(){if(s)d.each(function(){d3.select(this).style("width",u+"px")});else{var t,e,n=0,i=!1,r=d[0].length,a=r*u,o=this._getLegendContainingWidth(),l=0;o>a&&a+r>o&&(l=o-a),h.style("width",a>o&&!s?o+"px":""),d.each(function(){t=d3.select(this);var r=u;l>0&&(r+=1,l-=1),t.style("width",r+"px"),e=t.select(".cv-legend-title").style("height",null).node().offsetHeight,e!==n&&(i=!0,n=Math.max(e,n))}),i&&d.selectAll(".cv-legend-title").style("height",n+"px")}},x._getLegendContainingWidth=function(){return i-a.right},x._getUsedWidth=function(){return s?m+f:0},x._getUsedHeight=function(){return s?0:h.node().offsetHeight||0},x.destroy=function(){h.remove()},x.parent=function(t){return arguments.length?(e=t,x):e},x.minLegendEntryWidth=function(t){return arguments.length?(g=t,x):g},x.maxLegendEntryWidth=function(t){return arguments.length?(_=t,x):_},x.legendVerticalWidth=function(t){return arguments.length?(m=+t,x):m},x.values=function(t){return arguments.length?(o=t,x):o},x.type=function(t){return arguments.length?(l=t,x):l},x.chartWidth=function(t){return arguments.length?(i=t,x):i},x.chartHeight=function(t){return arguments.length?(r=t,x):r},x.chartPadding=function(t){return arguments.length?(a=t,x):a},x.seriesState=function(t){return arguments.length?(c=t,c.on("enableChange.legend",this._onSeriesEnableChange),x):c},x.validOrientations=function(t){return arguments.length?(v=t,x):v},x.orientation=function(t){return arguments.length?(n=t,x):n},x.interactive=function(t){return arguments.length?(y=t,x):y},x.mapping=function(){return p},x.isVertical=function(){return s},x}}(this),function(){"use strict";d3.anomaly=function(){function t(t,e){for(var n in e)t[n]=e[n];return t}function e(){var t=X.append("g").classed("temp-axis",!0);y(t,$[0],$[1]),C=n(t),B=$[0]-C.left-C.right,V=$[1]-C.top-C.bottom,t.remove()}function n(t){var e=t.node().getBBox(),n=Math.abs(e.x),i=Math.abs(e.y);return{left:n,top:i,right:e.width-$[0]-n,bottom:e.height-$[1]-i}}function i(){var t=r(z,function(t){return Date.parse(t[Y])},[L,F]),e=r(z,function(t){return t[W]});ae.domain(t);var n=ae.ticks(ie,D),i=+n[1]-+n[0];t[1]=i+ +n[n.length-1],t[0]=+n[0]>t[0]?+n[0]-i:t[0],ae.domain(t),G=ae.ticks(ie,D);var a=Math.max(Math.abs(e[0]),Math.abs(e[1]));ee?(se.domain([0,a]),I=d3.scale.linear().domain([-a,a])):(se.domain([-a,a]),I=d3.scale.linear().domain(se.domain())),I.domain([0,.1,.2,.3,.4,.5,.6,.7,.8,.9,1].map(I.invert)),I.range(["#3C476F","#485485","#53659C","#6C7CAF","#99A2BC","#C5C5C5","#ACC997","#90C867","#7CBC4B","#6FA744","#64913E"])}function r(t,e,n){var i=[];return 3>arguments.length||void 0===n[0]&&void 0===n[1]?i=d3.extent(t,e):(i[0]=void 0===n[0]?d3.min(t,e):n[0],i[1]=void 0===n[1]?d3.max(t,e):n[1]),i}function a(){q=d3.svg.brush().x(ae).y(se).on("brushstart",s).on("brush",o).on("brushend",l)}function s(){c()}function o(){X.selectAll(".extent").style("opacity",1),c()}function l(){X.selectAll(".extent").style("opacity",0),c()}function c(){var t=q.extent(),e={left:Math.min(ae(t[0][0]),ae(t[1][0])),right:Math.max(ae(t[0][0]),ae(t[1][0])),top:Math.min(se(t[0][1]),se(t[1][1])),bottom:Math.max(se(t[0][1]),se(t[1][1]))},n=X.selectAll(".anom-anomaly").filter(function(t){return d({left:t.bounds.x,right:t.bounds.x+t.bounds.width,top:t.bounds.y,bottom:t.bounds.y+t.bounds.height},e)});Z&&u(n[0],Z[0])||(Z=n,re.select(n))}function u(t,e){if(t.length!=e.length)return!1;for(var n=0,i=t.length;i>n;n++)if(-1===e.indexOf(t[n]))return!1;return!0}function d(t,e){return!(e.left>t.right||e.right<t.left||e.top>t.bottom||e.bottom<t.top)}function h(){U=d3.select(ne);var t=U.selectAll("svg").data([z]);t.enter().append("svg"),t.exit().remove(),t.attr("width",$[0]).attr("height",$[1]);var e=t.selectAll(".anom-container").data([0]);return e.enter().append("g").classed("anom-container",!0),e}function p(){H=se.ticks(te);var t=H[1]-H[0];H.push(t+H[H.length-1]),ee||H.unshift(H[0]-t),z=f(z),g(z);var e=_(z);return m(H,e),e}function f(t){var e=ae.domain();return t.filter(function(t){var n=new Date(t[Y]);return n>=e[0]&&e[1]>n})}function g(t){t.sort(function(t,e){return t=new Date(t[Y]),e=new Date(e[Y]),e>t?-1:t>e?1:0})}function _(t){return d3.nest().key(function(t){for(var e=Date.parse(t[Y]),n=0,i=-1,r=G.length;r>++i&&!(+G[i]>+e);)n=i;return+G[n]}).entries(t)}function m(t,e){e.forEach(function(e){e.values=d3.layout.histogram().bins(t).value(function(t){return ee?Math.abs(t[W]):t[W]})(e.values),j=e.values[0].dx})}function v(t){var e=new Date(0),n=G.length,i=Math.max(Math.ceil((G.length-1)/(t/70)),1),r=d3.time.format("%b %e, %Y"),a=d3.time.format("%b %e"),s=d3.time.format("%a %e"),o=d3.time.format("%I:%M %p");return function(t,l){var c="";return l===n-1||0!==l%i?"":(0===l||e.getYear()!==t.getYear()?c=r(t):e.getMonth()!==t.getMonth()?c=a(t):e.getDate()!==t.getDate()?c=s(t):e.getHours()!==t.getHours()&&(c=o(t)),e=t,c)}}function y(t,e,n){var i=G.length,r=G.length>1&&ce>=+G[1]-+G[0];ae.rangeRound([0,e]),se.rangeRound([n,0]);var a=t.selectAll(".anom-axes").data([0]);a.enter().append("g").classed("anom-axes",!0);var s=a.selectAll(".anom-axis").data(["x","y"]);s.enter().append("g").attr("class",function(t){return"anom-"+t+" anom-axis"});var o=a.selectAll(".anom-x").attr("transform","translate(0,"+n+")").call(d3.svg.axis().scale(ae).ticks(ie,D).orient("bottom").tickSize(-n).tickPadding(20).tickFormat(v(e)));o.selectAll("text").style("text-anchor","start"),o.selectAll("line").style("opacity",function(t,e){return e===i-1?0:r&&(6===t.getDay()||1===t.getDay())&&0===t.getHours()&&i-1>e?.3:null});var l=a.selectAll(".anom-y").call(d3.svg.axis().scale(se).tickValues(H).orient("left").tickSize(-e).tickPadding(10).tickFormat(function(t,e){return 0===e||e===Math.floor(H.length/2)||e===H.length-1?Math.round(1e5*t)/1e5+"%":""}));ee||l.selectAll("line").filter(function(t){return 0===t}).style("stroke-dasharray","4 4").style("opacity",.7)}function x(){var t=Math.round(H.length>1?se(H[0])-se(H[1]):V)-1,e=Math.round(S(t))-1,n=X.selectAll(".anom-plot").data([R]);n.enter().append("g").classed("anom-plot",!0),n.exit().remove();var i=n.selectAll(".anom-column").data(function(t){return t});i.enter().append("g").classed("anom-column",!0),i.exit().remove(),i.attr("transform",function(t){return"translate("+ae(+t.key)+",0)"});var r=i.selectAll(".anom-row").data(function(t){return t.values});r.enter().append("g").classed("anom-row",!0),r.exit().remove(),r.attr("transform",function(e,n){return"translate(0,"+(se(H[n])-t)+")"});var a=r.selectAll(".anom-anomaly").data(function(t){return t}),s=a.enter().append("g").classed("anom-anomaly",!0);a.attr("transform",function(n,i){var r=k(ee?Math.abs(n[W]):n[W]);return n[W]>=0&&(r+=j),n.bounds={x:ae(Date.parse(n[Y]))+(i*(e+le)+le),y:se(r),width:e,height:t},"translate("+(i*(e+le)+le)+",0)"}),a.exit().remove(),s.append("rect").classed("anom-cell",!0).attr("x",e/2).attr("y",t/2).attr("width",0).attr("height",0),a.selectAll(".anom-cell").attr("fill",function(t){var e=k(ee?Math.abs(t[W]):t[W]);return ee&&0>t[W]&&(e*=-1),I(e)}).transition().duration(500).attr("x",0).attr("y",0).attr("width",e).attr("height",t);var o=s.append("g").classed("anom-select",!0);o.append("path").classed("outer-border",!0),o.append("path").classed("inner-border",!0);var l=a.selectAll(".anom-select");l.select(".outer-border").attr("d",A(0,0,e+.5,t+.5,1)),e>3&&l.select(".inner-border").attr("d",A(0,0,e+1,t+1,2));var c=s.append("rect").classed("anom-hit-area",!0);c.on("mouseover",function(t,e){re.mouseover(this,t,e)}).on("mouseout",function(t,e){re.mouseout(this,t,e)}).on("mousedown",function(){q.clear();var t=d3.mouse(X.node()),e=ae.invert(t[0]),n=se.invert(t[1]);q.extent([[e,n],[e,n]])}).on("click",function(){re.select(d3.select(this))}).style("cursor","crosshair").style("opacity",0).attr("x",0).attr("y",0).attr("width",e).attr("height",t)}function b(){var t=X.selectAll(".anom-plot").data([0]);t.enter().append("g").classed("anom-plot",!0),t.exit().remove(),t.call(q)}function A(t,e,n,i,r){return"M"+r+","+r+"L"+(n-2*r)+","+r+"L"+(n-2*r)+","+(i-2*r)+"L"+r+","+(i-2*r)+"z"}function k(t){for(var e=-1,n=H.length;n>++e;){if(t>=0&&H[e]+j>t)return H[e];if(0>t&&H[e]+j>t)return H[e]+j}return H[0]}function S(t){var e=(G.length>1?ae(G[1])-ae(G[0]):B)-oe,n=M();return E=e/n,E>t?t:E}function M(){var t=0;return R.forEach(function(e){e.values.forEach(function(e){t=Math.max(e.length,t)})}),t}function P(t){if(void 0===K[t])throw new w(t);return K[t]}function w(t){this.type="MappingNotDefinedException",this.message="The mapping for property "+t+" was not defined.",this.toString=function(){return this.type+" - "+this.message}}function O(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function T(){this.type="ParentNotSpecifiedException",this.message="A p was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var z,C,E,N,D,F,L,I,V,B,R,j,H,q,G,Y,W,U,X,Z,J={},K={x:"date",y:"deviation"},$=[50,25],Q=!0,te=6,ee=!1,ne=null,ie=7,re=d3.dispatch("select","mouseover","mouseout"),ae=d3.time.scale(),se=d3.scale.linear(),oe=8,le=1,ce=864e5;return d3.rebind(J,re,"on"),J.data=function(t){return arguments.length?(z=t,Z=null,J):z},J.mappings=function(e){return arguments.length?(K=t(K,e),J):K},J.xUpperLimit=function(t){return arguments.length?(F=t,J):F},J.xLowerLimit=function(t){return arguments.length?(L=t,J):L},J.normalizePositive=function(t){return arguments.length?(ee=t,J):ee},J.xTicks=function(t,e){if(!arguments.length)return void 0!==e?[ie,D]:this.xTicks;var n=!!(t&&t.constructor&&t.call&&t.apply);return ie=n?d3.functor(t):t,D=n?e:void 0,this},J.bins=function(t){return arguments.length?(te=t,J):te},J.size=function(t){return arguments.length?($=t,J):$},J.interactive=function(t){return arguments.length?(Q=t,J):Q},J.parent=function(t){return arguments.length?(ne=t,J):ne},J.anomalyWidth=function(){return E},J.anomalyHeight=function(){return N},J.layout=function(){if(!J.data()||!J.data().length)throw new O;if(!J.parent())throw new T;return Y=P("x"),W=P("y"),i(),a(),X=h(),R=p(),se.domain([H[0],H[H.length-1]]),e(),X.attr("transform","translate("+C.left+","+C.top+")"),y(X,B,V),b(),x(),J},J.nodes=function(t){if(!U)throw Error("layout must be called before nodes may be requested.");U.selectAll(".anom-anomaly").each(t)},J}}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=t.dv||{},r=t.d3||{},a=Object.create(n),s=400;a.init=function(t){return this._type="pathing",this._initDefaultOptions(),this.setOptions(t),this._pathLocked=null,this._pathedObj=null,this._activePaths=[],this._lineLocked=null,this._lastSide=0,this},a._initDefaultOptions=function(){var t="Visits",e={mappings:{},colors:["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],nodeWidth:100,minNodeHeight:1,avgNodeHeight:30,padding:{top:80,left:30,right:30,bottom:20},metricName:t,minNodeHorzPadding:80,nodeVertPadding:34,iterations:32,pivotNode:null,collapseNode:null,expandNode:null,pathSelected:null};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,e)},a._onAutoResize=function(){this.render()},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments)},a._preRender=function(){Object.getPrototypeOf(a)._preRender.apply(this);var t=this._options,e=r.select(t.parent),n=t.padding,i=e.selectAll(".pathing-cv-info-wrapper").data([0]);i.enter().insert("div",":first-child").classed("pathing-cv-info-wrapper",!0);var s=i.selectAll(".pathing-cv-wrapper").data([0]);s.enter().insert("div",":first-child").classed("pathing-cv-wrapper",!0);var o=s.selectAll(".pathing-cv-container").data([0]);o.enter().insert("div",":first-child").classed("pathing-cv-container",!0);var l=o.selectAll(".pathing-svg").data([0]);l.enter().append("svg").classed("pathing-svg",!0);var c=l.selectAll(".pathing-svg-container").data([0]);c.enter().append("g").classed("pathing-svg-container",!0),c.attr("transform","translate("+n.left+","+n.top+")");var u=i.selectAll(".pathing-cv-info-pane").data([0]);u.enter().append("div").classed("pathing-cv-info-pane",!0),u.exit().remove();var d=u.selectAll(".info-pane-content").data([0]);d.enter().append("div").classed("info-pane-content",!0),d.exit().remove();var h=d.selectAll(".pathing-cv-info-title").data([0]);h.enter().append("div").classed("pathing-cv-info-title",!0),h.exit().remove();var p=d.selectAll(".pathing-cv-info-value").data([0]);p.enter().append("div").classed("pathing-cv-info-value",!0),p.exit().remove();var f=d.selectAll(".pathing-cv-info-paths").data([0]);f.enter().append("div").classed("pathing-cv-info-paths",!0),f.exit().remove(),this._sizeChart(),this._createGradients(l);var g=this._pathedObj;this._changedOptions&&this._changedOptions.data&&g?this._isDataObjNode(g.data)?this._unlockNode(g.data,g.elem)():this._unlockLink(g.data,g.elem)():(o.on("mousemove.node",null).on("click.node",null).on("click.link",null),this._removePathOverlays(o),this._removeNodeOptions(!0),this._defaultInformation())},a._render=function(){if(Object.getPrototypeOf(a)._render.apply(this),this._dataAdapter.isValidPathingData()){this._createDiagram();var t=this._pathedObj;this._activePaths.length&&t&&(this._isDataObjNode(t.data)?(this._renderNodePaths(t.data,t.elem,!0),this._showNodeOptions(t.data,t.elem)):this._renderLinkPaths(t.data,t.elem,!0))}},a._postRender=function(){Object.getPrototypeOf(a)._postRender.apply(this)},a._sizeChart=function(){clearTimeout(this._wrapperAnimation),clearTimeout(this._scrollAnimation);var t=this._options,e=this._dataAdapter.data(),n=r.select(t.parent),a=n.selectAll(".pathing-cv-info-wrapper"),s=a.selectAll(".pathing-cv-wrapper"),o=s.selectAll(".pathing-cv-container"),l=a.selectAll(".pathing-cv-info-pane"),c=t.parent.offsetWidth,u=t.parent.offsetHeight,d=i.util.getPercentValue(t.width,c),h=i.util.getPercentValue(t.height,u),p=d-parseInt(l.style("width"),10),f=t.padding,g=e&&e.nodes||[],_=this._numColumns=g.length&&Math.max.apply(null,g.map(function(t){return t.column}))+1||1,m=[],v=0;e.nodes.forEach(function(t){m[t.column]?m[t.column]++:m[t.column]=1}),v=m.length&&Math.max.apply(null,m)||0;var y=p-2,x=h-2,b=_*t.nodeWidth+(_-1)*t.minNodeHorzPadding+f.left+f.right,A=v*t.avgNodeHeight+v*t.nodeVertPadding+f.top+f.bottom,k=b>p,S=A>h;s.classed("is-wider",k),k&&(y=b,x-=20),s.classed("is-taller",S),S&&(x=A,y-=20),a.style("width",d+"px").style("height",h+"px"),s.style("width",p+"px").style("height",h+"px"),o.style("width",y+"px").style("height",x+"px")},a._getInnerDimensions=function(){var t=this._options,e=t.padding,n=r.select(t.parent).select(".pathing-cv-container"),i=parseInt(n.style("width"),10),a=parseInt(n.style("height"),10);return[i-e.right-e.left,a-e.top-e.bottom]},a._createDiagram=function(){var t=this._options,e=this._dataAdapter.data(),n=r.select(t.parent).selectAll(".pathing-cv-container"),i=parseInt(n.style("width"),10),a=parseInt(n.style("height"),10),s=this._path=r.pathing().nodeWidth(t.nodeWidth).nodePadding(t.nodeVertPadding).size(this._getInnerDimensions()).nodes(e.nodes).links(e.links).minNodeHeight(t.minNodeHeight).layout(t.interations);if(!e.nodes.some(function(t){return 0!==t.column})){var o=s.nodeWidth(),l=t.padding;e.nodes.forEach(function(t){t.x+=(i-l.left-l.right)/2-o/2})}var c=this._updateLinks(s,e.links);this._updateNodes(s,e.nodes,c,a);var u=r.select(t.parent).select(".pathing-svg").node();u.style.display="none",u.offsetHeight,u.style.display=""},a._updateNodes=function(t,e,n,i){var a=this,o=this._options,l=r.select(o.parent).select(".pathing-svg-container"),c=(this._options.onNodeSelect,this._options.padding,!this._changedOptions||!this._changedOptions.data),u=c?0:s,d=l.selectAll(".node-container").data([0]);d.enter().append("g").classed("node-container",!0),d.exit().remove();var h=d.selectAll(".node").data(e,this._dataAdapter.nodeKey()),p=t.nodeWidth();h.enter().append("g").classed("hide-node",!0).attr("transform",function(t){return"translate("+t.x+",0)"}),h.on("mouseover.node",function(t){a._showNodePaths(t,this)}).on("mouseout.node",function(){a._hideNodePaths()}).on("click.node",function(t){a._activateNode(t,this)});var f=h.exit();f.classed("hide-node",!0).on("mouseover.node",null).on("mouseout.node",null).on("click.node",null).transition().duration(u).style("opacity",0).attr("transform",function(t){return"translate("+t.x+",0)"}),setTimeout(function(){f.remove()},u),h.transition().duration(u).attr("transform",function(t){return"translate("+t.x+","+t.y+")"});var g=this._numColumns;h.each(function(e){function n(t){var e=!0,n=!1,i=!1;g>1&&(n=0===t.column,i=g-1===t.column,e=!(n||i)),r.select(this).attr("x",e?p/2:n?2:p-4).attr("text-anchor",e?"middle":n?"start":"end")}function i(t){var e=20,n=10,i="";return e>t.length?t:t.slice(0,e-n)+i+t.slice(t.length-n)}var a=r.select(this),s=a.classed("hide-node");a.attr("class","node"),a.classed("hide-node",s),a.classed("filter","E_0"===e.id),a.classed("exit-filter","X_0"===e.id),e.classname&&a.classed(e.classname,!0);var o=a.selectAll(".node-bg").data([e]);o.enter().append("rect").classed("node-bg",!0),o.exit().remove(),o.attr("width",p),o.transition().duration(u).attr("height",function(t){return t.dy});var l=a.selectAll(".node-title").data([e]);l.enter().append("text").classed("node-title",!0).attr("y",-5).attr("transform",null),l.exit().remove(),l.each(n),l.text(function(t){return i(t.label)});var c=a.selectAll(".node-total").data([e]);c.enter().append("text").classed("node-total",!0).attr("y",15).attr("transform",null),c.exit().remove(),c.each(n),c.text(function(t){return r.format(",.0f")(t.value)});var d=a.selectAll(".node-hit-area").data([e]);d.enter().append("rect").classed("node-hit-area",!0),d.exit().remove(),d.attr("height",function(t){return t.dy+4}).attr("y",-4).attr("width",t.nodeWidth()).style("opacity",0),setTimeout(function(){a.classed("hide-node",!1)},u)})},a.gradientCounter={count:0},a._updateLinks=function(t,e){var n=this._options,i=this,a=r.select(n.parent).select(".pathing-svg-container"),o=r.select(n.parent).selectAll("svg"),l=o.selectAll("defs").data([0]),c=!this._changedOptions||!this._changedOptions.data,u=c?0:s;l.enter().append("defs");var d=l.selectAll(".path-fills").data([0]);d.enter().append("g").classed("path-fills",!0);var h=a.selectAll(".link-container").data([0]);h.enter().append("g").classed("link-container",!0),h.exit().remove();var p=a.selectAll(".path-overlay-container").data([0]);p.enter().append("g").classed("path-overlay-container",!0),p.exit().remove();var f=h.selectAll("path").data(e,this._dataAdapter.linkKey());f.enter().append("path").classed("hide-link",!0),f.on("mouseover.link",function(t){i._showLinkPaths(t,this)}).on("mouseout.link",function(){i._hideLinkPaths()}).on("click.link",function(t){i._activateLink(t,this)});var g=f.exit();return g.classed("hide-link",!0).on("click.link",null).on("mouseover.link",null).on("mouseout.link",null),setTimeout(function(){g.remove()},u),f.each(function(e){var n=r.select(this),i=n.classed("hide-link");n.attr("class",function(t){return t.source?t.target?"link":"exit":"entry"}),n.classed("hide-link",i),n.classed("hide-link")?(n.attr("d",t.link()(e)),setTimeout(function(){n.classed("hide-link",!1)},u)):n.transition().duration(u).attr("d",t.link()(e)),e.source&&"E_0"===e.source.id?n.classed("entry-path",!0):e.target&&"X_0"===e.target.id&&n.classed("exit-path",!0);var a=e.source&&"E_0"===e.source.id,s=e.target&&"X_0"===e.target.id;n.classed("filter",a),n.classed("exit-filter",s)}),f},a._createGradients=function(t){var e=t.selectAll("style").data([0]);e.enter().append("style"),e.text(function(){var t=".pathing-svg .exit { fill: url(#exitFill); } \n";return t+=".pathing-svg .entry { fill: url(#entryFill); } \n",t+=".pathing-svg .exit:hover { fill: url(#exitHighlightFill); } \n",t+=".pathing-svg .entry:hover { fill: url(#entryHighlightFill); } \n",t+=".pathing-svg .pivot-entry { mask: url(#pivotEnterMask); } \n",t+=".pathing-svg .pivot-exit { mask: url(#pivotExitMask); } \n",t+=".pathing-svg .link-container .entry-path { fill: url(#entryGradient); } \n",t+=".pathing-svg .link-container .exit-path { fill: url(#exitGradient); } \n"});var n=t.selectAll("defs").data([0]);n.enter().append("defs");var i=n.selectAll(".bounce-fills").data([0]),r=i.enter().append("g").classed("bounce-fills",!0),a=r.append("linearGradient").attr("id","pivotEnterGrad");a.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),a.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),a.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),a.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);var s=r.append("mask").attr("id","pivotEnterMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");s.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotEnterGrad)");var o=r.append("linearGradient").attr("id","pivotExitGrad").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%");o.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0),o.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0),o.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",.5),o.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);var l=r.append("mask").attr("id","pivotExitMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");l.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotExitGrad)");var c=r.append("linearGradient").attr("id","entryGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");c.append("stop").attr("offset","0%").style("stop-color","#8cc350"),c.append("stop").attr("offset","100%").style("stop-color","#3287D2");var u=r.append("linearGradient").attr("id","exitGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");u.append("stop").attr("offset","0%").style("stop-color","#3287D2"),u.append("stop").attr("offset","100%").style("stop-color","#cc2539");var d=r.append("linearGradient").attr("id","exitFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");
d.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",.5),d.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",.5),d.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var h=r.append("linearGradient").attr("id","exitHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");h.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",1),h.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",1),h.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",.1);var p=r.append("linearGradient").attr("id","entryFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");p.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),p.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",.5),p.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",.5);var f=r.append("linearGradient").attr("id","entryHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");f.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",.1),f.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",1),f.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",1)},a._setOptionContainerContent=function(t,e){var n,i=this._options,r="",a=0,s=t.classed("is-last-column"),o=this._dataAdapter,l=o.l10n.labels.pathing,c=[{id:"expand",label:l.expand,valid:i.expandNode&&o.canExpandNode(e)},{id:"pivot",label:l.focus,valid:i.pivotNode&&o.canPivotNode(e)},{id:"collapse",label:l.collapse,valid:i.collapseNode&&o.canCollapseNode(e)}];if(s&&c.reverse(),c=c.filter(function(t){return t.valid}),i.expandNode||i.collapseNode||i.pivotNode)for(var u=0,d=c.length;d>u;++u)n=c[u],r+='<a class="cv-node-option cv-node-option'+(s?d-a-1:a)+" cv-node-"+n.id+'"><i class="'+n.id+'"></i><span>'+n.label+"</span></a>",++a;r='<div class="cv-node-options num-options-'+a+'">'+r+"</div>",t.html(r)},a._activateNode=function(t,e){var n=this;if(this._pathLocked&&t===this._pathLocked.data){n._unlockNode(t,e)();var i=r.mouse(e)[0]>=n._options.nodeWidth/2?1:-1;if(!t.isPivot||i===n._lastSide)return}this._setPathLocked({data:t,elem:e}),r.select(n._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null),r.selectAll(".cv-node-active").classed("cv-node-active",!1),r.selectAll(".cv-link-active").classed("cv-link-active",!1),r.select(e).classed("cv-node-active",!0),this._renderNodePaths(t,e),this._showNodeOptions(t,e),this._showInformation(t,e),this._scrollToElem(e),setTimeout(function(){r.select(n._options.parent).select(".pathing-cv-container").on("click.node",n._unlockNode(t,e))},10)},a._showNodePaths=function(t,e){this._pathLocked||this._renderNodePaths(t,e)},a._renderNodePaths=function(t,e,n){function i(){l=u._activePaths=d.filter(function(e){var n=e.nodes.indexOf(t._pid);return c>0&&e.nodes.length>n+1||0>c&&n>0}),o=u._dataAdapter.nodePathData(l,t,c),u._createPathOverlays(o)}function a(){var t=0;try{t=r.mouse(e)[0]}catch(n){}var a=t>=u._options.nodeWidth/2?1:-1;a!==c&&(u._lastSide=c=a,i())}var s=r.select(this._options.parent).select(".pathing-cv-container");if(clearTimeout(this._hidePathOverlaysTimer),s.on("mousemove.node",null),!this._pathedObj||this._pathedObj.data!==t||n){this._setPathedObj({data:t,elem:e});var o,l,c=0,u=this,d=this._dataAdapter.nodePaths(t);t.isPivot?n?(c=u._lastSide,i()):(a(),u._pathLocked||s.on("mousemove.node",function(){a()})):(u._lastSide=0,u._activePaths=d,o=this._dataAdapter.nodePathData(d,t,c),u._createPathOverlays(o)),setTimeout(function(){s.classed("path-overlays",!0)},1)}},a._showNodeOptions=function(t,e){var n=this._numColumns,i=r.select(this._options.parent).select(".pathing-cv-container"),a=i.node(),s=this._options,o=50,l=r.select(e).select(".node-bg").node(),c=a.getBoundingClientRect(),u=l.getBoundingClientRect(),d=u.top-c.top,h=u.left-c.left+s.nodeWidth/2,p=i.select(".cv-path-node-options");p.empty()?p=i.append("div").classed("cv-path-node-options",!0).attr("node",t._pid):p.attr("node")==t._pid&&p.classed("is-open")||(this._removeNodeOptions(),o=300,p=i.append("div").classed("cv-path-node-options",!0).attr("node",t._pid)),p.classed("is-last-column",n>1&&n-1===t.column).style("top",d+"px").style("left",h+"px"),this._setOptionContainerContent(p,t),setTimeout(function(){p.classed("is-open",!0)},o)},a._formatMetricValue=function(t){return this._formatNumber("decimal",t.value)+" "+this._options.metricName},a._formatPathInformation=function(t){var e=this._options,n=this,i=e.colors;return function(e,r){var a=n._dataAdapter.getPathEnd(e),s=a?a.value?a.value:t:t,o="",l=e.values[0],c=l/s;return r%=i.length,o+='<span class="pathing-path-marker" style="background-color: '+i[r]+'"></span>',o+='<span class="pathing-path-value"><span class="pathing-path-num">'+n._formatNumber("decimal",l)+'</span> <span class="pathing-path-perc">'+n._formatNumber("percent",c)+"</span></span>"}},a._highlightPath=function(t,e,n){var i=this._options,a=i.parent,s=r.event,o=!s||s&&"click"===s.type,l=r.select(a).selectAll(".path-overlay-container"),c=r.select(a).selectAll(".pathing-cv-info-pane"),u=l.selectAll(".link.path"+e),d=l.selectAll(".link:not(.path"+e+")");if(o){if(this._lineLocked===t)return this._setLineLock(null),this._removeHightlightPath();this._setLineLock(t),c.selectAll(".locked").classed("locked",!1),r.select(n).classed("locked",!0)}else if(this._lineLocked)return;l.selectAll(".link.inactive").classed("inactive",!1),d.classed("inactive",!0),u.classed("active",!0)},a._setLineLock=function(t){this._options,this._lineLocked!==t&&(this._lineLocked=t,this._callPathSelected(t))},a._setPathedObj=function(t){this._pathedObj=t},a._setPathLocked=function(t){this._options,this._pathLocked!==t&&(this._pathLocked=t,this._callPathSelected())},a._callPathSelected=function(t){var e={},n=this._options,i=this._pathLocked&&this._pathLocked.data||{};t&&(e.path=t.nodes+""),i._pid!==void 0&&(e.node=i._pid,e.side=this._lastSide),(i.source!==void 0||i.target!==void 0)&&(e.source=i.source?i.source._pid:null,e.target=i.target?i.target._pid:null),"function"==typeof n.pathSelected&&n.pathSelected(e,this._pathLocked,t)},a._removeHightlightPath=function(){if(!this._lineLocked){var t=this._options,e=t.parent,n=r.select(e).selectAll(".pathing-cv-info-pane"),i=r.select(e).selectAll(".path-overlay-container").selectAll(".link");i.classed("inactive",!1).classed("active",!1),n.selectAll(".locked").classed("locked",!1)}},a._showInformation=function(t){var e=this,n=(this._options,this._isDataObjNode(t)),i=this._dataAdapter.l10n.labels.pathing,a=r.select(this._options.parent).select(".pathing-cv-info-pane"),s=a.selectAll(".pathing-cv-info-title"),o=a.selectAll(".pathing-cv-info-value"),l=a.selectAll(".pathing-cv-info-paths");this._setLineLock(null),this._removeHightlightPath();var c,u=this._formatMetricValue(t),d=!1;if(n)c=t.label,u=this._formatMetricValue(t),d=t.column==this._numColumns-1;else{var h=i.percOfNode;if(t.source)if(t.target){var p=this._dataAdapter,f=p.getPathDirection(p.data().paths[t.paths[0]]),g=0>f?t.target:t.source;c=i.nodeToNode.replace(/\{source\}/i,t.source.label).replace(/\{target\}/i,t.target.label),u=this._formatMetricValue(t)+'<span class="perc">'+h.replace(/\{perc\}/i,this._formatNumber("percent",t.value/g.value)).replace(/\{label\}/i,g.label)+"</span>"}else c=i.nodeExits.replace(/\{label\}/i,t.source.label),u=this._formatMetricValue(t)+'<span class="perc">'+h.replace(/\{perc\}/i,this._formatNumber("percent",t.value/t.source.value)).replace(/\{label\}/i,t.source.label)+"</span>";else c=i.nodeEntries.replace(/\{label\}/i,t.target.label),u=this._formatMetricValue(t)+'<span class="perc">'+h.replace(/\{perc\}/i,this._formatNumber("percent",t.value/t.target.value)).replace(/\{label\}/i,t.target.label)+"</span>"}a.classed("is-last-column",d),s.html(c),o.html(u);var _=l.selectAll(".pathing-cv-path-title").data([0]);_.enter().append("span").classed("pathing-cv-path-title",!0),_.html(this._dataAdapter.activePathsTitle(this._activePaths));var m=l.selectAll(".pathing-cv-path-info").data(this._activePaths);m.enter().append("span").classed("pathing-cv-path-info",!0),m.on("click.line",function(t,n){e._highlightPath(t,n,this)}).on("mouseover.line",function(t,n){e._highlightPath(t,n,this)}).on("mouseout.line",function(){e._removeHightlightPath()}).html(this._formatPathInformation(t.value)),m.exit().on("click.line",null).on("mouseover.line",null).on("mouseout.line",null).remove()},a._defaultInformation=function(){this._setLineLock(null),this._removeHightlightPath();var t=r.select(this._options.parent).select(".pathing-cv-info-pane"),e=t.selectAll(".pathing-cv-info-title"),n=t.selectAll(".pathing-cv-info-value"),i=t.selectAll(".pathing-cv-info-paths"),a=this._dataAdapter.l10n.labels.pathing,s="<p>"+a.help1+"</p>";s+="<p>"+a.help2+"</p>",s+="<p>"+a.help3+"</p>",s+='<p><span class="cv-node-option"><i class="pivot"></i></span><span class="cv-option-title">'+a.focus+"</span></p>",s+="<p>"+a.focusHelp+"</p>",s+='<p><span class="cv-node-option"><i class="expand"></i></span><span class="cv-option-title">'+a.expand+"</span></p>",s+="<p>"+a.expandHelp+"</p>",s+='<p><span class="cv-node-option"><i class="collapse"></i></span><span class="cv-option-title">'+a.collapse+"</span></p>",s+="<p>"+a.collapseHelp+"</p>",e.html(a.title),n.html('<div class="help">'+s+"</div>"),i.html("")},a._scrollToElem=function(t){function e(t,e){return function(){var n=null!==t?r.interpolateNumber(s.node().scrollLeft,t):null,i=null!==e?r.interpolateNumber(s.node().scrollTop,e):null;return function(t){null!==n&&(s.node().scrollLeft=n(t)),null!==i&&(s.node().scrollTop=i(t))}}}var n=this._options,i=r.select(this._options.parent).select(".pathing-cv-container"),a=i.node(),s=r.select(n.parent).select(".pathing-cv-wrapper"),o=r.select(t),l=o.selectAll(".node-bg").empty()?o.node():o.select(".node-bg").node(),c=a.getBoundingClientRect(),u=l.getBoundingClientRect(),d=u.top-c.top,h=u.left-c.left+n.nodeWidth/2;if(s.classed("is-wider")||s.classed("is-taller")){var p=null,f=null;if(s.classed("is-wider")){var g=parseInt(s.style("width"),10),_=parseInt(i.style("width"),10);p=Math.min(_-g,Math.max(0,h-g/2))}if(s.classed("is-taller")){var m=parseInt(s.style("height"),10),v=parseInt(i.style("height"),10);f=Math.min(v-m,Math.max(0,d+40-m/2))}r.transition().duration(300).tween("scroll",e(p,f))}},a._unlockNode=function(t,e){var n=this;return function(){n._setPathLocked(null),r.select(n._options.parent).select(".pathing-cv-container").on("click.node",null),n._deactivateNode(r.event,t,e)}},a._deactivateNode=function(t,e,n){var i=r.select(t.target),a=this._options,s=e||{};r.select(n).classed("cv-node-active",!1),this._removeNodeOptions(!1),this._defaultInformation(),this._hideNodePaths(),"click"===t.type&&(i.classed("cv-node-option")||(i=r.select(i.node().parentNode)),i.classed("cv-node-expand")&&"function"==typeof a.expandNode&&a.expandNode(s),i.classed("cv-node-collapse")&&"function"==typeof a.collapseNode&&a.collapseNode(s),i.classed("cv-node-pivot")&&"function"==typeof a.pivotNode&&a.pivotNode(s))},a._removeNodeOptions=function(t){var e=r.selectAll(".cv-path-node-options");e.classed("is-open",!1),setTimeout(function(){e.remove()},t?0:300)},a._hideNodePaths=function(){var t=r.select(this._options.parent).select(".pathing-cv-container");t.on("mousemove.node",null),this._pathLocked||this._removePathOverlays(t)},a._activateLink=function(t,e){var n=this;return this._pathLocked&&t===this._pathLocked.data?(n._unlockLink(t,e),void 0):(this._setPathLocked({data:t,elem:e}),r.select(n._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null),r.selectAll(".cv-node-active").classed("cv-node-active",!1),r.selectAll(".cv-link-active").classed("cv-link-active",!1),r.select(e).classed("cv-link-active",!0),this._removeNodeOptions(),this._renderLinkPaths(t,e),this._showInformation(t,e),this._scrollToElem(e),setTimeout(function(){r.select(n._options.parent).select(".pathing-cv-container").on("click.link",n._unlockLink(t,e))},10),void 0)},a._showLinkPaths=function(t,e){this._pathLocked||this._renderLinkPaths(t,e)},a._renderLinkPaths=function(t,e,n){if(clearTimeout(this._hidePathOverlaysTimer),!this._pathedObj||this._pathedObj.data!==t||n){this._setPathedObj({data:t,elem:e});var i=this._dataAdapter;this._activePaths=i.linkSortActivePaths(t),this._createPathOverlays(i.linkPathData(this._activePaths));var a=r.select(this._options.parent).select(".pathing-cv-container");setTimeout(function(){a.classed("path-overlays",!0)},1)}},a._unlockLink=function(t,e){var n=this;return function(){n._setPathLocked(null),r.select(n._options.parent).select(".pathing-cv-container").on("click.link",null),n._deactivateLink(r.event,t,e)}},a._deactivateLink=function(t,e,n){r.select(this._options.parent).select(".pathing-cv-container"),r.select(n).classed("cv-link-active",!1),this._defaultInformation(),this._hideLinkPaths()},a._hideLinkPaths=function(){var t=r.select(this._options.parent).select(".pathing-cv-container");this._pathLocked||this._removePathOverlays(t)},a._createPathOverlays=function(t){var e=this._options,n=this._path,i=r.select(e.parent).select(".path-overlay-container"),a=i.selectAll("path").data(t);a.enter().append("path"),a.exit().remove(),a.attr("class",function(t){var e=t.pivotStart?" pivot-entry":t.pivotEnd?" pivot-exit":"";return"link path"+t.path+e}).attr("d",n.link()).attr("style",function(t){var n=t.path%e.colors.length;return"fill: "+e.colors[n]+";"}).sort(function(t,e){return t||e?t?e?e.dy-t.dy:-1:1:0})},a._removePathOverlays=function(t){clearTimeout(this._hidePathOverlaysTimer),this._setPathedObj(null),this._hidePathOverlaysTimer=setTimeout(function(){t.classed("path-overlays",!1)},20)},a._isDataObjNode=function(t){return t._pid!==void 0},a.setActivePath=function(t){var e=this._options,n=this,i=this._dataAdapter.data();t=t||{};var a,s,o=t.node!==void 0;if(o?a=i.nodesById[t.node]:(a=i.links.filter(function(e){return(!e.source&&!t.source||e.source&&t.source&&e.source._pid+""===t.source)&&(!e.target&&!t.target||e.target&&t.target&&e.target._pid+""===t.target)}),a=a.length&&a[0]||null),s=o?".node":".link",a){var l,c=!1;c=i.paths.some(function(e){return l=e.nodes,""+e.nodes===t.path}),r.select(e.parent).selectAll(s).each(function(t){if(t===a){if(o?n._activateNode(t,this):n._activateLink(t,this),!c)return;r.select(e.parent).selectAll(".pathing-cv-path-info").filter(function(t,e){""+t.nodes==""+l&&n._highlightPath(t,e,this)})}})}},t.cloudViz.pathing=e.util.createConstructor(a)}(this),function(){"use strict";d3.pathing=function(){function t(){h.forEach(function(t){t.sourceLinks=[],t.targetLinks=[],t.entryLinks=[],t.exitLinks=[]}),p.forEach(function(t){var e=t.source,n=t.target;null!==e&&"number"==typeof e&&(e=t.source=h[t.source]),null!==n&&"number"==typeof n&&(n=t.target=h[t.target]),null!==e&&null!==n?(e.sourceLinks.push(t),n.targetLinks.push(t)):null===e?n.entryLinks.push(t):e.exitLinks.push(t)})}function e(){function t(t){return t.sourceLinks&&t.sourceLinks.length||t.targetLinks&&t.targetLinks.length||t.exitLinks&&t.exitLinks.length||t.entryLinks&&t.entryLinks.length}h.forEach(function(t){t.value=t.hasOwnProperty("total")?t.total:Math.max(d3.sum(t.sourceLinks,o)+d3.sum(t.exitLinks,o),d3.sum(t.targetLinks,o)+d3.sum(t.entryLinks,o))}),h.sort(function(e,n){var i=t(e),r=t(n);return i&&!r?-1:r&&!i?1:n.value-e.value})}function n(){var t=[],e=d[0]-c;h.forEach(function(e){e.x=e.column,e.dx=c,0>t.indexOf(e.column)?(t.push(e.column),e.columnIndex=t.length-1):e.columnIndex=t.indexOf(e.column)}),f=t.length,i(f>1?e/(f-1):e)}function i(t){h.forEach(function(e){e.x*=t})}function r(t){function e(){var t=d3.min(l,function(t){var e=d3.sum(t,o)||1;return(d[1]-(t.length-1)*u)/e});l.forEach(function(e){e.forEach(function(e,n){e.y=n,e.dy=Math.max(g,e.value*t)})}),p.forEach(function(e){e.dy=e.value*t})}function n(t){function e(t){return s(t.source)*t.value}l.forEach(function(n){n.forEach(function(n){if(n.targetLinks.length){var i=d3.sum(n.targetLinks,e)/d3.sum(n.targetLinks,o);n.y+=(i-s(n))*t}})})}function i(t){function e(t){return s(t.target)*t.value}l.slice().reverse().forEach(function(n){n.forEach(function(n){if(n.sourceLinks.length){var i=d3.sum(n.sourceLinks,e)/d3.sum(n.sourceLinks,o);n.y+=(i-s(n))*t}})})}function r(){l.forEach(function(t){var e,n,i,r=0,s=t.length;for(t.sort(a),i=0;s>i;++i)e=t[i],n=r-e.y,n>0&&(e.y+=n),r=e.y+e.dy+u;if(n=r-u-d[1],n>0)for(r=e.y-=n,i=s-2;i>=0;--i)e=t[i],n=e.y+e.dy+u-r,n>0&&(e.y-=n),r=e.y})}function a(t,e){return t.y-e.y}var l=d3.nest().key(function(t){return t.x}).sortKeys(d3.ascending).entries(h).map(function(t){return t.values});e(),r();for(var c=1;t>0;--t)i(c*=.99),r(),n(c),r()}function a(){function t(t,e){return t.source.y-e.source.y}function e(t,e){return t.target.y-e.target.y}h.forEach(function(n){n.sourceLinks.sort(e),n.targetLinks.sort(t)}),h.forEach(function(t){var e=0,n=0;t.entryLinks.forEach(function(t){t.ty=n,n+=t.dy}),t.sourceLinks.forEach(function(t){t.sy=e,e+=t.dy}),t.targetLinks.forEach(function(t){t.ty=n,n+=t.dy}),t.exitLinks.forEach(function(t){t.sy=e,e+=t.dy})})}function s(t){return t.y+t.dy/2}function o(t){return t.value}var l={},c=24,u=8,d=[1,1],h=[],p=[],f=0/0,g=0;return l.nodeWidth=function(t){return arguments.length?(c=+t,l):c},l.nodePadding=function(t){return arguments.length?(u=+t,l):u},l.nodes=function(t){return arguments.length?(h=t,l):h},l.links=function(t){return arguments.length?(p=t,l):p},l.size=function(t){return arguments.length?(d=t,l):d},l.numColumns=function(){return f},l.minNodeHeight=function(t){return arguments.length?(g=t,l):g},l.layout=function(i){return t(),e(),n(),r(i),a(),l},l.relayout=function(){return a(),l},l.link=function(){function t(t){var n,i,r,a,s,o,l,c,u,d,h,p,f,g=5,_=15;return p=f=Math.min(t.dy+g,_),null===t.source?(n=t.target.x-p,i=t.target.x,c=t.target.y-g,u=t.target.y+t.dy,"M"+n+","+c+"h"+p+"v"+(u-c)+"c-"+p+",0"+",-"+p+",-"+f/2+",-"+p+",-"+f+"z"):null===t.target?(n=t.source.x+t.source.dx,i=t.source.x+t.source.dx+p,c=t.source.y+t.source.dy-t.dy,u=t.source.y+t.source.dy+g,"M"+i+","+u+"h-"+p+"v-"+(u-c)+"c"+p+",0"+","+p+","+f/2+","+p+","+f+"V"+u+"z"):(n=t.source.x+t.source.dx,i=t.target.x,r=d3.interpolateNumber(n,i),a=r(e),s=r(1-e),o=s+(15>t.dy?t.source.y<t.target.y?-1*t.dy:t.dy:0),l=a+(15>t.dy?t.source.y<t.target.y?-1*t.dy:t.dy:0),c=t.source.y+t.sy,u=t.target.y+t.ty,d=u+t.dy,h=c+t.dy,"M"+n+","+c+"C"+a+","+c+" "+s+","+u+" "+i+","+u+"v"+t.dy+"C"+o+","+d+" "+l+","+h+" "+n+","+h+"Z")}var e=.5;return t.curvature=function(n){return arguments.length?(e=+n,t):e},t},l}}(this),function(t){"use strict";function e(t){var e=[],n=!0;for(var i in t){for(var r=t[i],a=-1,s=r.length;s>++a;){var o,l=r[a];n?(o={},e.push(o)):o=e[a],o[i]=l}n=!1}return e}var n=t.cloudViz||{},i=n.core||{},r=t.dv||{},a=t.d3||{},s=Object.create(i);s.init=function(t){return this._type="anomaly",t=t||{},this._initDefaultOptions(),this.setOptions(t),this._initializeAnomaly(),this},s._initDefaultOptions=function(){var t={mappings:{x:"date",y:"deviation",category:"metric"},bins:12,xTicks:7,xTickInterval:void 0,xUpperLimit:void 0,xLowerLimit:void 0,normalizePositive:!1,onMouseOverAnomaly:null,onMouseOutAnomaly:null,onSelectAnomalies:null};return Object.getPrototypeOf(s)._initDefaultOptions.call(this,t)},s._render=function(){this._configureAnomaly(),this._anom.layout()},s._initializeAnomaly=function(){var t=this._options,e=t.mappings,n=this;this._anom=a.anomaly().on("mouseover",function(i,r,s){n._anom.nodes(function(t){a.select(this).transition().duration(750).style("opacity",t[e.category]===r[e.category]?.8:.2)}),t.onMouseOverAnomaly&&t.onMouseOverAnomaly.call(i,r,s)}).on("mouseout",function(e,i,r){n._anom.nodes(function(){a.select(this).transition().duration(750).style("opacity",1)}),t.onMouseOutAnomaly&&t.onMouseOutAnomaly.call(e,i,r)}).on("select",function(e){n._anom.nodes(function(){a.select(this).classed("selected",!1)}),e.classed("selected",!0),t.onSelectAnomalies&&t.onSelectAnomalies.call(e)})},s._configureAnomaly=function(){var t=this._options,n=r.util.getPercentValue(t.width,t.parent.offsetWidth),i=r.util.getPercentValue(t.height,t.parent.offsetHeight);this._anom.data(e(t.data)).parent(t.parent).mappings(t.mappings).bins(t.bins).size([n,i]).xUpperLimit(t.xUpperLimit).xLowerLimit(t.xLowerLimit).normalizePositive(t.normalizePositive).xTicks(t.xTicks,t.xTickInterval)},s._onAutoResize=function(){this.render()},s.chart=function(){return this._anom},t.cloudViz.anomaly=n.util.createConstructor(s)}(this),function(){"use strict";d3.choropleth=function(){function t(){this.type="EmptyDataException",this.message="The data is empty or null",this.toString=function(){return this.type+" - "+this.message}}function e(){this.type="ParentNotSpecifiedException",this.message="A parent was not specified for this visualization",this.toString=function(){return this.type+" - "+this.message}}var n,i,r,a,s,o,l,c,u,d,h,p,f=["#fae6be","#eb782d","#dc283c","#640046"],g=["#c7b797","#b85e23","#a81e2e","#300022"],_=["#faf0c8","#d2dc73","#5faf69","#00505A"],m=["#c7bf9f","#a0a858","#437d4a","#002226"],v={},y=[],x=[0,1],b=(h-p)*x[0],A=(h-p)*x[1],k=!1,S={top:0,left:0,right:0,bottom:40};return v.layout=function(){var n=this;if(!v.data())throw new t;if(!v.parent())throw new e;y=v.determineSize(c),v.calcRange(),s=v.createSVGContainer(),"string"==typeof c.geoJson?d3.json(c.geoJson,function(t){n._layoutWithData.call(n,t)}):this._layoutWithData(c.geoJson)},v._layoutWithData=function(t){v.drawGeos(t),c.interactive&&v.drawTooltip(),v.drawLegend(c.theme,t)},v.determineSize=function(t){var e=t.parent,n=t.width?t.width:e.offsetWidth,i=t.height?t.height:e.offsetHeight;return n=n?n:700,i=i?i:450,[n,i]},v.calcRange=function(){for(var t in c.data.values)h===void 0&&(h=c.data.values[t],p=c.data.values[t]),c.data.values[t]>h&&(h=c.data.values[t]),p>c.data.values[t]&&(p=c.data.values[t])},v.drawLegend=function(t,e){var i=9,r=12,s=35,l=Math.min(y[0]-S.left,630)-25,u=(y[0]-S.left-l)/2,d=l-2*s-2*r,b=[],A=[];t!==void 0&&"salmonRun"==t?(b=f,A=g):(b=_,A=m);var M=o.selectAll(".legend").data([n]);M.enter().append("g").classed("legend",!0),M.attr("transform","translate("+u+","+(y[1]-24)+")");var P=M.selectAll("defs").data([t]);P.enter().append("defs"),P.exit().remove();var w=P.selectAll("#defaultGradient-"+t).data([t]);w.enter().append("linearGradient").attr("id","defaultGradient-"+t),w.exit().remove();var O=P.selectAll("#darkGradient-"+t).data([t]);O.enter().append("linearGradient").attr("id","darkGradient-"+t),O.exit().remove();var T=["0%","33%","67%","100%"],z=function(t,e,n){var i=t.selectAll("stop").data(e);i.enter().append("stop").attr("class",function(t,e){return"stop"+e}),i.attr("offset",function(t){return t}).attr("stop-color",function(t,e){return n[e]})};z(w,T,b),z(O,T,A);var C=M.selectAll(".grad-bg").data([n]);C.enter().append("rect").classed("grad-bg",!0),C.attr("x",s+r).attr("y",0).attr("rx",i/2).attr("ry",i/2).attr("width",d).attr("height",i);var E=M.selectAll(".grad-rect").data([n]);E.enter().append("rect").classed("grad-rect",!0),E.classed("grad-rect",!0).attr("x",s+r).attr("y",0).style("stroke","url(#darkGradient-"+t+")").style("fill","url(#defaultGradient-"+t+")").attr("width",d).attr("height",i);var N=a.selectAll(".legend-label").data([p,h]);if(N.enter().append("div").attr("class",function(t,e){return"legend-label "+(e?"max":"min")}),N.style("left",function(t,e){return e?null:u+"px"}).style("right",function(t,e){return e?u+"px":null}).text(function(t,e){return c.formatFunction(e?h:p)}),c.interactive){var D=d3.svg.brush().x(d3.scale.linear().range([0,d])).extent(x).on("brushstart",function(){k=!0}).on("brushend",function(){k=!1}).on("brush",function(){x=D.extent(),o.selectAll(".grad-rect").attr("width",(x[1]-x[0])*d).attr("x",d*x[0]+s+r),v.drawGeos(e)}),F=9,L=26,I=M.selectAll(".brush").data([n]);I.enter().append("g").classed("brush",!0),I.attr("transform","translate("+(s+r)+",0)").call(D);var V=I.selectAll(".resize"),B=V.selectAll(".handle").data(function(t){return t});B.enter().append("rect").classed("handle",!0),B.attr("transform","translate("+-(F/2)+","+-F+")").attr("rx",F/3).attr("ry",F/3).attr("width",F).attr("height",L)}},v.drawTooltip=function(t){var e=null==t||null==t.value;d=a.selectAll(".tooltip").data(e?[]:[t]),d.enter().append("div").classed("tooltip",!0),d.exit().classed("visible",!1),setTimeout(function(){d.classed("visible",!0)},10);var n=d.selectAll(".tooltip-back").data([t]);n.enter().append("div").classed("tooltip-back",!0);var i=n.selectAll(".tt-name").data(function(t){return[t.name]});i.enter().append("p").classed("tt-name",!0),i.text(function(t){return t});var r=n.selectAll(".tt-value").data(function(t){return[t.value]});r.enter().append("p").classed("tt-value",!0),r.text(function(t){return c.formatFunction(t)});var s=n.selectAll(".tt-metric").data(c.metric!==void 0?[c.metric]:[]);s.enter().append("p").classed("tt-metric",!0),s.text(function(t){return t}),s.exit().remove()},v.hideTooltip=function(){v.drawTooltip({})},v.showTooltip=function(t){"value"in t&&t.value?v.drawTooltip(t):v.hideTooltip()},v.drawGeos=function(t){var e,i=null,a=(Math.min(y[0],y[1]),y[0]-S.left-S.right),d=y[1]-S.top-S.bottom,g=1,m=[0,0];u=c.projection?d3.geo[c.projection]():d3.geo.equirectangular(),u.scale(g).translate(m);var M=d3.geo.path().projection(u),P=M.bounds(t);g=.95/Math.max((P[1][0]-P[0][0])/a,(P[1][1]-P[0][1])/d),m=[(a-g*(P[1][0]+P[0][0]))/2,(d-g*(P[1][1]+P[0][1]))/2];var w=g*((P[1][1]-P[0][1])/d)*d,O=g*((P[1][0]-P[0][0])/a)*a;if(u.scale(g).translate(m),M=M.projection(u),c.interactive){var T=d3.behavior.zoom(),z=4;l.call(T.scaleExtent([1,z]).translate([a/2,d/2]).scale(1).on("zoom",function(){if(d3.event){var t=d3.event.translate,e=d3.event.scale,n=a/2*e,i=d/2*e,r=t[0]-n,o=t[1]-i,l=O/6,c=w/6,u=-n-l,h=a-n+l,p=-i-c,f=d-i+c;r=Math.min(r,h),r=Math.max(r,u),o=Math.min(o,f),o=Math.max(o,p),t[0]=r+n,t[1]=o+i,T.translate(t),s.attr("transform","translate("+r+","+o+") scale("+e+")")}}))}b=(h-p)*x[0]+p,A=(h-p)*x[1]+p,e=[b,(A-b)/3+b,2*((A-b)/3)+b,A],r.selectAll(".legend-label.min").text(function(){return c.formatFunction(b)}),r.selectAll(".legend-label.max").text(function(){return c.formatFunction(A)}),i="salmonRun"==c.theme?d3.scale.linear().domain(e).range(f):d3.scale.linear().domain(e).range(_);var C=function(t){return n.values[t.properties.GEO_ID]===void 0||b>n.values[t.properties.GEO_ID]||n.values[t.properties.GEO_ID]>A?"#ddd":i(n.values[t.properties.GEO_ID])},E=function(t){if(!k){var e=t.properties.GEO_ID,i=o.selectAll("#"+e),r=i.node();r.parentNode.appendChild(r),i.classed("selected",!0),v.showTooltip({name:t.properties.name,id:t.properties.GEO_ID,value:n.values[t.properties.GEO_ID]})}},N=function(t){if(!k){var e=t.properties.GEO_ID,n=o.selectAll("#"+e),i=n.node();i.parentNode,n.classed("selected",!1),v.hideTooltip()}},D=s.selectAll(".geo").data(t.features,function(t){return t.properties.GEO_ID});D.enter().append("path").classed("geo",!0).attr("id",function(t){return t.properties.GEO_ID}).attr("vector-effect","non-scaling-stroke").on("mouseover.choro",c.interactive?E:null).on("mouseout.choro",c.interactive?N:null),D.exit().on("mouseover.choro",null).on("mouseout.choro",null),D.attr("d",M).style("fill",C)},v.createSVGContainer=function(){r=d3.select(i),a=r.selectAll(".cv-choropleth").data([n]),a.enter().append("div").classed("cv-choropleth",!0),a.style("width",y[0]+"px").style("height",y[1]+"px"),o=a.selectAll("svg").data([n]),o.enter().append("svg").attr("width","100%").attr("height","100%"),o.exit().remove();var t=o.selectAll("#plotClip").data([0]);t.enter().append("clipPath").attr("id","plotClip").append("rect"),t.select("rect").attr("x",S.left).attr("y",S.top).attr("width",y[0]-S.left-S.right).attr("height",y[1]-S.top-S.bottom);var e=o.selectAll(".container-bg").data([n]);e.enter().append("rect").classed("container-bg",!0).attr("width","100%").attr("height","100%"),l=o.selectAll(".zoom-container").data([n]),l.enter().append("g").classed("zoom-container",!0).attr("clip-path","url(#plotClip)");var s=l.selectAll(".zoom-container-plot-bg").data([n]);s.enter().append("rect").classed("zoom-container-plot-bg",!0),s.attr("x",S.left).attr("y",S.top).attr("width",y[0]-S.left-S.right).attr("height",y[1]-S.top-S.bottom);var c=l.selectAll(".choro-container").data([n]);return c.enter().append("g").classed("choro-container",!0),c},v.data=function(t){return arguments.length?(n=t,v):n},v.parent=function(t){return arguments.length?(i=t,v):i},v.options=function(t){return arguments.length?(c=t,v):c},v},d3.choropleth.gradIdCounter=0}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=(t.dv||{},t.d3||{}),r=Object.create(n);r.init=function(t){return this._type="choropleth",t=t||{},this._initDefaultOptions(),this.setOptions(t),this._initChoropleth(),this},r._initDefaultOptions=function(){var t={geoJson:null,theme:"sunnyDay",metric:"",projection:"equirectangular",format:"decimal",interactive:!0};return Object.getPrototypeOf(r)._initDefaultOptions.call(this,t)},r._render=function(){this._configure(),this._choro.layout()},r._initChoropleth=function(){this._choro=i.choropleth()},r._configure=function(){var t=this,e=this._options,n=this._dataAdapter;e.formatFunction=function(n){return t._formatNumber(e.format,n)},e.metric=n.metric(),e.format=n.format(),e.data=n.data(),this._choro.data(this._options.data).parent(this._options.parent).options(this._options)},t.cloudViz.choropleth=e.util.createConstructor(r)}(this),function(t){"use strict";function e(t,e){for(var n=Array(t[1].length||0),i=0;n.length>i;++i)n[i]=t[0]*t[1][i]+e[0]*e[1][i];return n}t.venn=function(e,n,i){i=i||{},i.distance=i.distance||0,i.maxIterations=i.maxIterations||500;var r=i.lossFunction||t.lossFunction,a=i.layoutFunction||t.greedyLayout;e=a(e,n,i.distance);for(var s=Array(2*e.length),o=0;e.length>o;++o)s[2*o]=e[o].x,s[2*o+1]=e[o].y;var l=0,c=t.fmin(function(t){l+=1;for(var i=Array(e.length),a=0;e.length>a;++a)i[a]={x:t[2*a],y:t[2*a+1],radius:e[a].radius,size:e[a].size};return r(i,n)},s,i),u=c.solution;for(o=0;e.length>o;++o)e[o].x=u[2*o],e[o].y=u[2*o+1];return e},t.distanceFromIntersectArea=function(e,n,i){return i>Math.min(e,n)*Math.min(e,n)*Math.PI?Math.abs(e-n):t.bisect(function(t){return window.circleIntersection.circleOverlap(e,n,t)-i},0,e+n)},t.getDistanceMatrix=function(e,n,i){var r,a=[];for(r=0;e.length>r;++r){a.push([]);for(var s=0;e.length>s;++s)a[r].push(0)}for(r=0;n.length>r;++r){var o=n[r];if(2===o.sets.length){var l=o.sets[0],c=o.sets[1],u=Math.sqrt(e[l].size/Math.PI),d=Math.sqrt(e[c].size/Math.PI),h=t.distanceFromIntersectArea(u,d,o.size)+i;a[l][c]=a[c][l]=h}}return a},t.greedyLayout=function(e,n,i){function r(t,e){return e.size-t.size}function a(t){return t.set in _}function s(t,n){e[n].x=t.x,e[n].y=t.y,_[n]=!0}var o,l,c,u={};for(l=0;e.length>l;++l)u[l]=[],e[l].radius=Math.sqrt(e[l].size/Math.PI),e[l].x=e[l].y=0;for(l=0;n.length>l;++l){var d=n[l];if(2===d.sets.length){var h=d.sets[0],p=d.sets[1];u[h]&&u[p]&&(u[h].push({set:p,size:d.size}),u[p].push({set:h,size:d.size}))}}var f=[];for(o in u)if(u.hasOwnProperty(o)){var g=0;for(l=0;u[o].length>l;++l)g+=u[o][l].size;f.push({set:o,size:g})}if(!f.length)return e;f.sort(r);var _={};s({x:0,y:0},f[0].set);var m=t.getDistanceMatrix(e,n,i);for(l=1;f.length>l;++l){var v=f[l].set,y=u[v].filter(a);if(o=e[v],y.sort(r),0===y.length)throw"Need overlap information for set "+o;var x=[];for(c=0;y.length>c;++c){var b=e[y[c].set],A=m[v][y[c].set];x.push({x:b.x+A,y:b.y}),x.push({x:b.x-A,y:b.y}),x.push({y:b.y+A,x:b.x}),x.push({y:b.y-A,x:b.x});for(var k=c+1;y.length>k;++k)for(var S=e[y[k].set],M=m[v][y[k].set],P=window.circleIntersection.circleCircleIntersection({x:b.x,y:b.y,radius:A},{x:S.x,y:S.y,radius:M}),w=0;P.length>w;++w)x.push(P[w])}var O=1e50,T=x[0];for(c=0;x.length>c;++c){e[v].x=x[c].x,e[v].y=x[c].y;
var z=t.lossFunction(e,n);O>z&&(O=z,T=x[c])}s(T,v)}return e},t.classicMDSLayout=function(e,n){for(var i=t.getDistanceMatrix(e,n,0),r=window.mds.classic(i),a=0;e.length>a;++a)e[a].x=r[a][0],e[a].y=r[a][1],e[a].radius=Math.sqrt(e[a].size/Math.PI);return e},t.lossFunction=function(t,e){function n(e){return e.map(function(e){return t[e]})}for(var i=0,r=0;e.length>r;++r){var a,s=e[r];if(2==s.sets.length){var o=t[s.sets[0]],l=t[s.sets[1]];a=null==o||null==l?0:window.circleIntersection.circleOverlap(o.radius,l.radius,window.circleIntersection.distance(o,l))}else a=window.circleIntersection.intersectionArea(n(s.sets));var c=null==s.weight?1:s.weight;i+=c*(a-s.size)*(a-s.size)}return i},t.scaleSolution=function(t,e,n,i){var r=function(e){var n=Math.max.apply(null,t.map(function(t){return t[e]+t.radius})),i=Math.min.apply(null,t.map(function(t){return t[e]-t.radius}));return{max:n,min:i}};e-=2*i,n-=2*i;for(var a=r("x"),s=r("y"),o=a.max-a.min,l=s.max-s.min,c=o?e/o:0,u=l?n/l:0,d=Math.min(u,c),h=0;t.length>h;++h){var p=t[h];p.radius=d*p.radius,p.x=i+(p.x-a.min)*d,p.y=i+(p.y-s.min)*d}return t.scaling=d,t},t.bisect=function(t,e,n,i){i=i||{};var r=i.maxIterations||100,a=i.tolerance||1e-10,s=t(e),o=t(n),l=n-e;if(s*o>0)throw"initial bisect points must have opposite signs";if(0===s)return e;if(0===o)return n;for(var c=0;r>c;++c){l/=2;var u=e+l,d=t(u);if(d*s>=0&&(e=u),a>Math.abs(l)||0===d)return u}return e+l},t.fmin=function(t,n,i){i=i||{};var r=i.maxIterations||200*n.length,a=i.nonZeroDelta||1.1,s=i.zeroDelta||.001,o=i.minErrorDelta||1e-5,l=i.rho||1,c=i.chi||2,u=i.psi||-.5,d=i.sigma||.5,h=i.callback,p=n.length,f=Array(p+1);f[0]=n,f[0].fx=t(n);for(var g=0;p>g;++g){var _=n.slice();_[g]=_[g]?_[g]*a:s,f[g+1]=_,f[g+1].fx=t(_)}for(var m=function(t,e){return t.fx-e.fx},v=0;r>v&&(f.sort(m),h&&h(f),!(o>Math.abs(f[0].fx-f[p].fx)));++v){var y=Array(p);for(g=0;p>g;++g){y[g]=0;for(var x=0;p>x;++x)y[g]+=f[x][g];y[g]/=p}var b=f[p],A=e([1+l,y],[-l,b]);A.fx=t(A);var k=A;if(A.fx<=f[0].fx){var S=e([1+c,y],[-c,b]);S.fx=t(S),S.fx<A.fx&&(k=S)}else if(A.fx>=f[p-1].fx){var M,P=!1;if(A.fx<=b.fx?(M=e([1+u,y],[-u,b]),M.fx=t(M),M.fx<b.fx?k=M:P=!0):(M=e([1-u*l,y],[u*l,b]),M.fx=t(M),M.fx<=A.fx?k=M:P=!0),P)for(g=1;f.length>g;++g)f[g]=e([1-d,f[0]],[d-1,f[g]]),f[g].fx=t(f[g])}f[p]=k}return f.sort(m),{f:f[0].fx,solution:f[0]}},t.drawD3Diagram=function(e,n,i,r,a){a=a||{};var s=d3.scale.category10(),o=a.circleFillColours||s,l=a.circleStrokeColours||o,c=a.circleStrokeWidth||function(){return 0},u=a.textFillColours||s,d=a.textStrokeColours||u,h=a.opacity||.3,p=a.padding||6;n=t.scaleSolution(n,i,r,p);var f=e.append("svg").attr("width",i).attr("height",r),g=f.selectAll("circle").data(n).enter().append("g"),_=g.append("circle").attr("r",function(t){return t.radius}).style("fill-opacity",h).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).style("stroke",function(t,e){return l(e)}).style("stroke-width",function(t,e){return c(e)}).style("fill",function(t,e){return o(e)}),m=g.append("text").attr("x",function(t){return t.x}).attr("y",function(t){return t.y}).attr("text-anchor","middle").style("stroke",function(t,e){return d(e)}).style("fill",function(t,e){return u(e)}).text(function(t){return t.label});return{svg:f,nodes:g,circles:_,text:m}},t.updateD3Diagram=function(e,n){var i=e.select("svg"),r=parseInt(i.attr("width"),10),a=parseInt(i.attr("height"),10);n=t.scaleSolution(n,r,a,6),e.selectAll("circle").data(n).transition().duration(400).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).attr("r",function(t){return t.radius}),e.selectAll("text").data(n).transition().duration(400).attr("x",function(t){return t.x}).attr("y",function(t){return t.y})}}(window.venn=window.venn||{}),function(t){"use strict";function e(e){for(var n=[],i=0;e.length>i;++i)for(var r=i+1;e.length>r;++r)for(var a=t.circleCircleIntersection(e[i],e[r]),s=0;a.length>s;++s){var o=a[s];o.parentIndex=[i,r],n.push(o)}return n}var n=1e-10;t.intersectionArea=function(i,r){var a,s=e(i),o=s.filter(function(e){return t.containedInCircles(e,i)}),l=0,c=0,u=[];if(o.length>1){var d=t.getCenter(o);for(a=0;o.length>a;++a){var h=o[a];h.angle=Math.atan2(h.x-d.x,h.y-d.y)}o.sort(function(t,e){return e.angle-t.angle});var p=o[o.length-1];for(a=0;o.length>a;++a){var f=o[a];c+=(p.x+f.x)*(f.y-p.y);for(var g={x:(f.x+p.x)/2,y:(f.y+p.y)/2},_=null,m=0;f.parentIndex.length>m;++m)if(p.parentIndex.indexOf(f.parentIndex[m])>-1){var v=i[f.parentIndex[m]],y=Math.atan2(f.x-v.x,f.y-v.y),x=Math.atan2(p.x-v.x,p.y-v.y),b=x-y;0>b&&(b+=2*Math.PI);var A=x-b/2,k=t.distance(g,{x:v.x+v.radius*Math.sin(A),y:v.y+v.radius*Math.cos(A)});(null===_||_.width>k)&&(_={circle:v,width:k,p1:f,p2:p})}u.push(_),l+=t.circleArea(_.circle.radius,_.width),p=f}}else{var S=i[0];for(a=1;i.length>a;++a)i[a].radius<S.radius&&(S=i[a]);var M=!1;for(a=0;i.length>a;++a)if(t.distance(i[a],S)>Math.abs(S.radius-i[a].radius)){M=!0;break}M?l=c=0:(l=S.radius*S.radius*Math.PI,u.push({circle:S,p1:{x:S.x,y:S.y+S.radius},p2:{x:S.x-n,y:S.y+S.radius},width:2*S.radius}))}return c/=2,r&&(r.area=l+c,r.arcArea=l,r.polygonArea=c,r.arcs=u,r.innerPoints=o,r.intersectionPoints=s),l+c},t.containedInCircles=function(e,i){for(var r=0;i.length>r;++r)if(t.distance(e,i[r])>i[r].radius+n)return!1;return!0},t.circleIntegral=function(t,e){var n=Math.sqrt(t*t-e*e);return e*n+t*t*Math.atan2(e,n)},t.circleArea=function(e,n){return t.circleIntegral(e,n-e)-t.circleIntegral(e,-e)},t.distance=function(t,e){return Math.sqrt((t.x-e.x)*(t.x-e.x)+(t.y-e.y)*(t.y-e.y))},t.circleOverlap=function(e,n,i){if(i>=e+n)return 0;if(Math.abs(e-n)>=i)return Math.PI*Math.min(e,n)*Math.min(e,n);var r=e-(i*i-n*n+e*e)/(2*i),a=n-(i*i-e*e+n*n)/(2*i);return t.circleArea(e,r)+t.circleArea(n,a)},t.circleCircleIntersection=function(e,n){var i=t.distance(e,n),r=e.radius,a=n.radius;if(i>=r+a||Math.abs(r-a)>=i)return[];var s=(r*r-a*a+i*i)/(2*i),o=Math.sqrt(r*r-s*s),l=e.x+s*(n.x-e.x)/i,c=e.y+s*(n.y-e.y)/i,u=-(n.y-e.y)*(o/i),d=-(n.x-e.x)*(o/i);return[{x:l+u,y:c-d},{x:l-u,y:c+d}]},t.getCenter=function(t){for(var e={x:0,y:0},n=0;t.length>n;++n)e.x+=t[n].x,e.y+=t[n].y;return e.x/=t.length,e.y/=t.length,e}}(window.circleIntersection=window.circleIntersection||{}),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(t){var n=this;return this._type="venn",t=t||{},this._initDefaultOptions(),this.setOptions(t),this._cvWrapper=null,this._seriesState=e.seriesState(),this._seriesState.on("enableChange.venn",function(t,e){n._onEnableState(e)}),this._dvColorScale=i.scale.ordinal(),this},a._initDefaultOptions=function(){var t={colors:["#8cc350","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841","#5a6eaa"],legendVerticalWidth:110,duration:500,distance:0};return this._margins={top:0,left:0,right:0,bottom:0},Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a._render=function(){this._id=Math.floor(1e4*Math.random()),this._determineSize(),this._initScales(),this._draw()},a._draw=function(){var t=this._options.data;t.distance=this._options.distance,this._initSVG(),this._createStates(),this._parsedSetNotation=this._parseSetNotation(t.notation),this._overlapMap=this._createOverlapMap(t.sets,t.overlaps);var e=this._drawLegend();this._positionContainer(e);var n=this._configureSets(t),i=this._generateOverlayCombinations(n,this._parsedSetNotation);this._drawCircles(n,i)},a._onAutoResize=function(){this.render()},a._determineSize=function(){var t=this._options,e=(this._dataAdapter.data(),t.parent.offsetWidth),n=t.parent.offsetHeight,r=i.util.getPercentValue(t.width,e)||e,a=i.util.getPercentValue(t.height,n)||n;this._size=[r,a]},a._initScales=function(){this._dvColorScale.range(this._options.colors)},a._parseSetNotation=function(t){var e=[];if(!t)return e;var n,i,r=t.split("|"),a=/\d+/g,s=r.length;for(n=0;s>n;n++){i=r[n];var o,l=i.match(a),c=[],u=l.length;for(o=0;u>o;o++)c.push(+l[o]);e.push(c)}return e},a._initSVG=function(){var t=this._options,e=r.select(t.parent);this._cvWrapper=e.selectAll(".cv-wrapper.cv-venn").data([0]),this._cvWrapper.enter().append("div").classed("cv-wrapper cv-venn",!0),this._cvWrapper.style("width",this._size[0]+"px").style("height",this._size[1]+"px");var n=this._cvWrapper.selectAll(".svg-wrapper").data([0]);n.enter().append("div").classed("svg-wrapper",!0);var i=n.selectAll("svg").data([0]);i.enter().append("svg"),this._d3Container=i.selectAll("g").data([0]),this._d3Container.enter().append("g")},a._positionContainer=function(t){this._size[0]-=t.left+t.right,this._size[1]-=t.top+t.bottom,this._cvWrapper.select(".svg-wrapper").style({"margin-left":t.left+"px","margin-top":t.top+"px","margin-right":t.right+"px","margin-bottom":t.bottom+"px",height:this._size[1]+"px"}),this._cvWrapper.selectAll(".cv-legend").style("height",t.left||t.right?this._size[1]-1+"px":null)},a._configureSets=function(e){this._options,e=this._sanitizeOverlaps(e);var n,i,r=t.venn.scaleSolution(t.venn.venn(e.sets,e.overlaps,{distance:e.distance}),this._size[0],this._size[1],7),a=r.length;for(n=0;a>n;n++)i=r[n],i.index=n;return r},a._combine=function(t,e,n){3>arguments.length?n=t.length-1:n--,2>arguments.length&&(e=1);for(var i=function(t,e,n,r){if(0===t)return n.length>0&&(r[r.length]=n),void 0;for(var a=0;e.length>a;a++)i(t-1,e.slice(a+1),n.concat([e[a]]),r)},r=[],a=e;n+1>=a;a++)i(a,t,[],r);return r},a._intersect=function(t,e){for(var n=[],i=0;t.length>i;i++)for(var r=0;e.length>r;r++)if(t[i]==e[r]){n.push(t[i]);break}return n},a._union=function(t,e){for(var n={},i=t.length-1;i>=0;--i)n[t[i]]=t[i];for(var r=e.length-1;r>=0;--r)n[e[r]]=e[r];var a=[];for(var s in n)n.hasOwnProperty(s)&&a.push(n[s]);return a.sort(function(t,e){return t-e}),a},a._generateOverlayCombinations=function(e,n){var i=this,r={},a=[],s=[];n.sort(function(t,e){return e.length-t.length}),n.forEach(function(t){var e=t.join("-");a=a.concat(i._combine(t,1)),a.forEach(function(n){var a,s=n.join("-"),o=r[s]||{};o.fill||(a=i._intersect(t,n),o.fill=a.join("-")===e),r[s]=o})});for(var o in r){var l,c=o.split("-"),u=[],d=c.length;for(l=0;d>l;l++){var h=e[c[l]];h&&u.push(e[c[l]])}var p={};u.length>1&&t.circleIntersection.intersectionArea(u,p),p.area=u.length?Math.PI*Math.pow(u[0].radius,2):0,s.push({key:o,fill:r[o].fill,area:p.area})}return s.sort(function(t,e){var n=e.area-t.area;return n?n:t.key.length-e.key.length}),s},a._sanitizeOverlaps=function(t){var e,n,i,r,a,s,o,l=t.sets,c=t.overlaps,u=[],d=l.length,h=c.length,p={},f=function(t,e){return+t-+e};for(i=0;h>i;i++)s=c[i],s.sets.sort(f),p[s.sets.join("-")]=s;for(e=0;d>e;e++)for(r=l[e],n=e+1;d>n;n++)a=l[n],o=!1,p.hasOwnProperty(e+"-"+n)&&"0"!==p[e+"-"+n].size||u.push({sets:[e,n],size:0});return t.overlaps=c.concat(u),t},a._createOverlapMap=function(t,e){var n,i,r={},a=function(t,e){return t-e},s=t.length;for(n=0;s>n;n++)i=t[n],r[n]=i.size;var o,l=e.length;for(n=0;l>n;n++)o=e[n],o.sets.sort(a),r[o.sets.join("-")]=o.size;return r},a._drawCircles=function(t,e){this._drawSetHitAreas(t),this._createClipPaths(t,e),this._drawFilledRegions(e),this._drawPadding(t),this._drawSetFills(t),this._drawBorders(t),this._makePlotFit(t)},a._drawSetHitAreas=function(t){var e=this,n=this._options,i=this._d3Container.selectAll(".set-hit-areas-container").data([t]);i.enter().append("g").classed("set-hit-areas-container",!0),i.exit().remove();var r=i.selectAll("circle").data(function(t){return t});r.enter().append("circle").attr("r",0).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}).attr("tooltip",function(t){return t.tooltip}),r.exit().remove(),r.sort(function(t,e){return e.radius-t.radius}).on("mouseover",function(t){e._seriesState.enableStateByTypeAndId("standard",t.index,!0)}).on("mouseout",function(t){e._seriesState.enableStateByTypeAndId("standard",t.index,!1)}).transition().duration(n.duration).attr("r",function(t){return Math.max(t.radius-1,0)}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})},a._createClipPaths=function(t,e){var n=this,i=this._cvWrapper.select("svg").selectAll("defs").data(e.length?[0]:[]);i.enter().insert("defs",":first-child"),i.exit().remove();var r=i.selectAll("clipPath").data(e);r.enter().append("clipPath"),r.exit().remove(),r.attr("id",function(t){return"clip-"+n._id+"-"+t.key});var a=r.selectAll("circle").data(function(e){if(!e.key||!e.key.length)return[];var n=e.key.split("-"),i={circleIndex:n.shift()};return n.length&&(i.maskId=n.join("-")),t&&t[i.circleIndex]?[i]:[]});a.enter().append("circle"),a.exit().remove(),a.attr("clip-path",function(t){return t.hasOwnProperty("maskId")?"url(#clip-"+n._id+"-"+t.maskId+")":null}).attr("r",function(e){return t[e.circleIndex].radius}).attr("cx",function(e){return t[e.circleIndex].x}).attr("cy",function(e){return t[e.circleIndex].y}).style("fill","#FFF")},a._drawFilledRegions=function(t){var e=this,n=this._options,i=this._d3Container.selectAll(".filled-regions").data(t?[t]:[]);i.enter().append("g").classed("filled-regions",!0),i.exit().remove();var r=i.selectAll(".fill-region").data(function(t){return t});r.enter().append("rect").classed("fill-region",!0),r.exit().remove(),r.attr("clip-path",function(t){return"url(#clip-"+e._id+"-"+t.key+")"}).style("opacity",1e-6).attr("width",e._size[0]).attr("height",e._size[1]).classed("overlay",function(t){return t.fill}).on("mouseover",function(){e._seriesState.enableStateByTypeAndId("highlight","audience",!0)}).on("mouseout",function(){e._seriesState.enableStateByTypeAndId("highlight","audience",!1)}).transition().delay(n.duration).duration(n.duration).style("opacity",1)},a._drawPadding=function(t){var e=this._options,n=this._d3Container.selectAll(".padding-container").data([t]);n.enter().append("g").classed("padding-container",!0),n.exit().remove();var i=n.selectAll("circle").data(function(t){return t});i.enter().append("circle").attr("r",0).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),i.exit().remove(),i.transition().duration(e.duration).attr("r",function(t){return t.radius}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})},a._drawSetFills=function(t){var e=this,n=this._options,i=this._d3Container.selectAll(".set-fills-container").data([t]);i.enter().append("g").classed("set-fills-container",!0),i.exit().remove();var r=i.selectAll("circle").data(function(t){return t});r.enter().append("circle").attr("r",0).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),r.exit().remove(),r.style("fill",function(t,n){return e._dvColorScale.mapValue(n)}).transition().duration(n.duration).attr("r",function(t){return Math.max(t.radius-3,0)}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})},a._drawBorders=function(t){var e=this,n=this._options,i=this._d3Container.selectAll(".border-container").data([t]);i.enter().append("g").classed("border-container",!0),i.exit().remove();var r=i.selectAll("circle").data(function(t){return t});r.enter().append("circle").attr("r",0).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y}),r.exit().remove(),r.style("stroke",function(t,n){return e._dvColorScale.mapValue(n)}).classed("predicted",function(t){return t.predicted}).transition().duration(n.duration).attr("r",function(t){return t.radius}).attr("cx",function(t){return t.x}).attr("cy",function(t){return t.y})},a._createStates=function(){var t=this._options,e=t.data.sets;if("data"in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard"),this._seriesState.removeStatesByType("highlight"),this._seriesState.appendState(this._dataAdapter.l10n.labels.venn.definedAudience,"audience","highlight",!1);var n,i,r=e.length,a=[];for(n=0;r>n;n++)i=e[n],a.push(n),this._seriesState.appendState(i.label||n,n,"standard",!1);this._dvColorScale.domain(a)}},a._drawLegend=function(){var t=this._options,n=this;this._legend||(this._legend=e.interactiveLegend()),this._legend.parent(this._cvWrapper.node()).orientation("bottom").chartWidth(this._size[0]).chartHeight(this._size[1]).chartPadding({left:0,top:0,right:0,bottom:0}).validOrientations(["bottom","left"]).legendVerticalWidth(t.legendVerticalWidth).type("line").seriesState(this._seriesState).interactive(!1).values(this._calculateValues(this._options.data.sets,this._overlapMap,this._parsedSetNotation))._render(null,{fill:[this._dvColorScale]});var i=this._legend._getUsedWidth(),r=this._legend._getUsedHeight(),a=0!==r,s=this._cvWrapper.selectAll(".cv-legend-entry").on("mouseover",function(t){n._seriesState.enableStateByTypeAndId(t.type,t.id,!0)}).on("mouseout",function(t){n._seriesState.enableStateByTypeAndId(t.type,t.id,!1)});return a&&s.style("width",function(){return n._size[0]/(n._options.data.sets.length+1)+"px"}),{left:i,bottom:r,right:0,top:0}},a._onEnableState=function(t){this._cvWrapper.selectAll(".set-fills-container circle").style("display",function(e,n){return"standard"===t.type&&t.id===n&&t.enabled?"block":"none"}),this._cvWrapper.selectAll(".border-container circle").classed("muted",function(e,n){return t.id!==n&&t.enabled}),this._cvWrapper.selectAll(".filled-regions rect").classed("muted",function(){return"standard"===t.type&&t.enabled}),this._cvWrapper.selectAll(".padding-container circle").style("display",function(){return"highlight"===t.type&&t.enabled?"none":"block"}),this._cvWrapper.selectAll(".cv-legend-entry").classed("inactive",function(e){return t.enabled&&(e.id!==t.id||e.type!==t.type)})},a._calculateValues=function(t,e,n){var i,r,a=[this._formatNumber("decimal",this._calculateHighlightedValue(t,e,n))],s=t.length;for(i=0;s>i;i++)r=t[i],a.push(r.sizeText?r.sizeText:this._formatNumber("decimal",r.size));return a},a._calculateHighlightedValue=function(t,e,n){var i=function(t,n,r,a){var s,o,l=this._combine(n,a,a),c=l.length,u=a%2?1:-1;for(s=0;c>s;s++){o=l[s];var d,h,p,f=o.length,g=[];for(d=0;f>d;d++)h=o[d],g=this._union(t[h],g);p=g.join("-"),r+=(e.hasOwnProperty(p)?e[p]:0)*u}return a++,t.length>=a&&(r=i.call(this,t,n,r,a)),r},r=function(t){var e,n=[];for(e=0;t>e;e++)n.push(e);return n};return i.call(this,n,r(n.length),0,1)},a._makePlotFit=function(t){var e=(this._options,{x:0,y:0}),n=0,i=0,r=4;t.forEach(function(t){n=Math.max(n,t.x+t.radius),i=Math.max(i,t.y+t.radius)}),this._size[0]-n>this._size[1]-i?e.x=(this._size[0]-n)/2-r:e.y=(this._size[1]-i)/2-r,this._cvWrapper.select("g").attr("transform","translate("+e.x+","+e.y+")")},t.cloudViz.venn=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(t){return this._type="sunburst",this._hiddenNodes=[],this._outRangeNodes=[],this._invalidNodes=[],this._initDefaultOptions(),this.setOptions(t),this},a._initDefaultOptions=function(){var t={otherColor:"#ccc",otherGrayColor:"#999",outRangeColor:"#5a5a5a",metricColor:"#fff",seqColors:["#faf0c8","#d2dc73","#5faf69","#00505A"],seqColorsHeat:["#5a6eaa","#3287d2","#3cb5a0","#5faf69","#8cc350","#c3d250","#f5c841","#f0a01e","#eb782d","#fa5a50"],colors:["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],padding:{top:10,bottom:60,left:10,right:10}};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a._onAutoResize=function(){this.resize()},a.resize=function(){r.select(this._options.parent).selectAll(".sunburst-cv").node()&&(this._sizeChart(),this._render(!0))},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments)},a._preRender=function(){if(this._paths){var t,e,n=this._oldKeys=this._dataAdapter.getDataByPathKey();for(t in n)e=n[t],n[t]={xo:e.x,dxo:e.dx,yo:e.y,dyo:e.dy}}Object.getPrototypeOf(a)._preRender.apply(this);var i=this._options,s=this,o=this._dataAdapter,l=o.l10n.labels.sunburst,c=r.select(i.parent);o.getSecondaryMetricIndex()&&s._hideNode(o.data(),s._invalidNodes,function(t){return s._isInvalidNode(t)});var u=this._hiddenNodes,d=o.getDataByPathKey();this._hiddenNodes=[],u.forEach(function(t){var e=o.getPathKey(t);d[e]&&s._hideNode(d[e],s._hiddenNodes)});var h=this._zoomedPath;this._zoomedPath=null,h&&(h=d[o.getPathKey(h)],this._zoomedPath=this._oldZoomed=h);var p=this._lockedNode;if(this._lockedNode=null,p&&("path"===p.type&&(p.data=d[o.getPathKey(p.data)],p.data&&(this._oldLockedNode=p)),"category"===p.type)){var f=o.categories().some(function(t){return p.data&&p.data.name===t.name?(p.data=t,!0):!1});f&&(this._oldLockedNode=p)}var g=c.selectAll(".sunburst-cv").data([0]);g.enter().insert("div",":first-child").classed("sunburst-cv",!0);var _=g.selectAll(".sunburst-cv-wrapper").data([0]);_.enter().insert("div",":first-child").classed("sunburst-cv-wrapper",!0);var m=_.selectAll(".sunburst-cv-container").data([0]);m.enter().insert("div",":first-child").classed("sunburst-cv-container",!0);var v=m.selectAll(".sunburst-svg").data([0]);v.enter().append("svg").classed("sunburst-svg",!0);var y=v.selectAll(".sunburst-svg-container").data([0]);y.enter().append("g").classed("sunburst-svg-container",!0);var x=_.selectAll(".sunburst-cv-label").data([0]);x.enter().append("div").classed("sunburst-cv-label",!0);var b=x.selectAll(".sunburst-cv-label-wrap").data([0]);b.enter().append("div").classed("sunburst-cv-label-wrap",!0);var A=b.selectAll(".sunburst-cv-label-metric").data([0]);A.enter().append("div").classed("sunburst-cv-label-metric",!0);var k=b.selectAll(".sunburst-audiences").data([0]);k.enter().append("div").classed("sunburst-audiences",!0),k.exit().remove();var S=g.selectAll(".sunburst-cv-actions-pane").data([0]);S.enter().append("div").classed("sunburst-cv-actions-pane",!0),S.exit().remove();var M=S.selectAll(".actions-pane-zoomout").data([0]);M.enter().append("div").classed("actions-pane-zoomout",!0).classed("actions-pane-action",!0),M.html('<i class="icon zoomout"></i><span>'+l.zoomout+"</span>"),M.on("click",function(){s._zoomPath(o.data())}),M.exit().remove();var P=S.selectAll(".actions-pane-hidden").data([0]);P.enter().append("div").classed("actions-pane-hidden",!0).classed("actions-pane-action",!0),P.html('<i class="icon hide"></i><span>'+s._hideLabelText()+"</span>"),P.on("click",function(){s._unhidePaths()}),P.exit().remove();var w=_.selectAll(".sunburst-cv-sec-viz").data([0]),O=w.enter().append("div").classed("sunburst-cv-sec-viz",!0);O.append("span").classed("title",!0);var T=O.append("span").classed("bar",!0);T.append("span").classed("button",!0).classed("color",!0).append("span"),T.append("span").classed("button",!0).classed("height",!0).append("span"),T.append("span").classed("button",!0).classed("both",!0).append("span"),w.selectAll(".button.color").on("click",function(){o.setSecondaryMetricType("color"),s._secondaryMetricChanged()}).selectAll("span").html(l.color),w.selectAll(".button.height").on("click",function(){o.setSecondaryMetricType("height"),s._secondaryMetricChanged()}).selectAll("span").html(l.height),w.selectAll(".button.both").on("click",function(){o.setSecondaryMetricType("both"),s._secondaryMetricChanged()}).selectAll("span").html(l.both),w.exit().remove();var z=_.selectAll(".sunburst-cv-secondary").data([0]);z.enter().append("div").classed("sunburst-cv-secondary",!0),z.exit().remove();var C=z.selectAll(".sunburst-cv-color").data([0]);C.enter().append("div").classed("sunburst-cv-color",!0),C.exit().remove();var E=g.selectAll(".sunburst-cv-info-pane").data([0]);E.enter().append("div").classed("sunburst-cv-info-pane",!0),E.exit().remove();var N=E.selectAll(".info-pane-content").data([0]);N.enter().append("div").classed("info-pane-content",!0),N.exit().remove();var D=N.selectAll(".info-pane-categories").data([0]);D.enter().append("div").classed("info-pane-categories",!0).append("div").classed("pane-title",!0).append("span"),D.exit().remove();var F=N.selectAll(".sunburst-audiences").data([0]);F.enter().append("div").classed("sunburst-audiences",!0).append("div").classed("pane-title",!0).append("span").text(l.audience),F.exit().remove();var L=N.selectAll(".info-pane-actions").data([0]);L.enter().append("div").classed("info-pane-actions",!0),L.exit().remove();var I=N.selectAll(".info-pane-metrics").data([0]),V=I.enter().append("div").classed("info-pane-metrics",!0);V.append("div").classed("pane-title",!0).classed("pri-metric",!0).append("span"),V.append("div").classed("info-pane-metrics-labels",!0).classed("pri-metric-labels",!0),V.append("div").classed("pane-title",!0).classed("sec-metric",!0).append("span"),V.append("div").classed("info-pane-metrics-labels",!0).classed("sec-metrics-labels",!0).append("span").classed("sec-metrics-help",!0),V.append("div").classed("pane-title",!0).classed("rank-chart",!0).append("span"),V.append("div").classed("info-pane-metrics-chart",!0),I.exit().remove();var B=N.selectAll(".info-pane-extra").data([0]);B.enter().append("div").classed("info-pane-extra",!0),B.exit().remove();var R=g.selectAll(".sunburst-cv-mobile-scroll").data([0]);R.enter().append("div").classed("sunburst-cv-mobile-scroll",!0),R.html(l.mobilescroll),R.exit().remove(),this._sizeChart(),g.classed("hiddenpaths",!!this._hiddenNodes.length)},a._render=function(t){Object.getPrototypeOf(a)._render.apply(this);var e=this._options,n=this._dataAdapter,i=n.data(),s=r.select(e.parent).selectAll(".sunburst-cv"),o=s.selectAll(".sunburst-cv-container"),l=o.selectAll(".sunburst-svg-container"),c=parseInt(o.style("width"),10),u=parseInt(o.style("height"),10),d=this._radius=Math.min(c,u)/2,h=this._isMobileSize(),p=i.categories.length+1,f=this._ringDivisor=1/p,g=h?20:140,_=this._centerRadius=Math.ceil(g/2/Math.cos(Math.PI/4));l.attr("transform","translate("+c/2+","+u/2+")"),!t&&this._yScale&&(this._oldYScale=this._yScale),!t&&this._xScale&&(this._oldXScale=this._xScale);var m=this._xScale=r.scale.linear().domain(this._oldXScale?this._oldXScale.domain():[0,1]).range([0,2*Math.PI]),v=this._yScale=r.scale.linear().domain([0,f,1]).range([0,_,d]);this._arc=r.svg.arc().startAngle(function(t){return Math.max(0,Math.min(2*Math.PI,m(t.x)))}).endAngle(function(t){return Math.max(0,Math.min(2*Math.PI,m(t.x+t.dx)))}).innerRadius(function(t){return Math.max(0,v(t.y))}).outerRadius(function(t){return Math.max(0,v(t.y+t.dy))}),this._layoutPaths(t);var y=r.select(e.parent).select(".sunburst-cv-label"),x=Math.ceil(2*_*Math.cos(Math.PI/4)),b=x,A=e.padding.top+Math.floor(u/2-b/2),k=e.padding.left+Math.floor(c/2-x/2);h?y.style("top","").style("left","").style("width","").style("height",""):y.style("top",A+"px").style("left",k+"px").style("width",x+"px").style("height",b+"px"),this._updateDetails(this._lockedNode),n.isDataEmpty()?this._setErrorMessage(n.l10n.labels.core.nodata):n.isSizeEmpty()?this._setErrorMessage(n.l10n.labels.sunburst.emptyFirstMetric):this._clearErrorMessage()},a._getHiddenNodes=function(){return this._hiddenNodes.concat(this._outRangeNodes,this._invalidNodes)},a._adjustDataSize=function(t,e,n){var i=(this._options,this),a=this._dataAdapter,s=t.depth-1,o=this._zoomedPath,l=.15,c=a.getStackedMetricIndex();if(s>=0&&t.metrics&&t.metrics[c]){t.y-=e;var u=t.metrics[c].value,d=n[s],h=d.max,p=Math.min(0,d.min),f=r.scale.linear().domain([p,h]).range([l,1]),g=f(u)*t.dy;(h===p||o&&o.depth>t.depth)&&(g=t.dy),e+=t.dy-g,t.dy=g}t.children&&t.children.length&&t.children.forEach(function(t){i._adjustDataSize(t,e,n)})},a._getLevelUniqueNodes=function(t,e,n){function i(t){if(!o||o.depth!==t.depth||o===t){if(t.depth===e){if(!n&&r.indexOf(t)>=0)return;if(s.indexOf(t.name)>=0)return;return a.push(t),s.push(t.name),void 0}t.children&&t.children.length&&t.children.forEach(function(t){i(t)})}}var r=(this._dataAdapter,this._getHiddenNodes()),a=[],s=[],o=this._zoomedPath;return i(t),a||[]},a._layoutPaths=function(t){var e=this._options,n=(this._arc,this),i=this._dataAdapter,a=i.data(),s=this._getHiddenNodes(),o=r.select(e.parent).selectAll(".sunburst-svg-container"),l=r.layout.partition().value(function(t){return 0>s.indexOf(t)?t.size:0}).sort(function(t,e){return i.isOther(t)?1:i.isOther(e)?-1:e.size-t.size});t&&n._paths&&n._paths.each(function(t){t.xo=t.x,t.dxo=t.dx,t.yo=t.y,t.dyo=t.dy});var c=l.nodes(a),u=this._paths=o.selectAll("path").data(c,i.getPathKey);u.enter().insert("path",":first-child"),u.attr("data-sid",function(t){return t._sid}).on("click",function(t){n._lockNode({data:t,type:"path"})}).on("dblclick",function(t){n._zoomPath(t)}).on("mouseenter",function(t){n._lockedNode||n._isTouch()||n._highlightNode({data:t,type:"path"})});var d=u.exit().classed("removing",!0);setTimeout(function(){d.remove()},501),n.setColorScale(),this._updatePathColors(),n._buildColorSlider();var h;if(h=i.getStackedMetric()){var p,f=i.getStackedMetricIndex(),g=(this._zoomedPath,!1);if(g){var _=n.getMetricCategoryMinMax(f);p=Array.apply(null,Array(a.categories.length)).map(function(){return _})}else p=a.categories.map(function(t,e){return n.getMetricCategoryMinMax(f,e)});n._adjustDataSize(a,0,p)}if(this._oldKeys){var m,v,y=this._oldYScale,x=y.domain(),b=this._yScale,A=b.domain();n._paths.each(function(t){m=i.getPathKey(t),(v=n._oldKeys[m])&&(t.xo=v.xo,t.dxo=v.dxo,t.yo=b.invert(y(v.yo)),t.dyo=i.isRoot(t)?b.invert(y(v.dyo)):b.invert(y(x[1]+v.dyo))-A[1])}),this._oldKeys=null}u.each(function(t){i.getPathKey(t),t.xo===void 0&&(t.xo=t.x,t.dxo=t.dx,t.yo=0,t.dyo=0)}),u.transition().duration(500).attrTween("d",this._changeTween(!0)),o.on("mouseleave",function(){n._lockedNode||n._isTouch()||n._unhighlightNode()}),t||(this._oldLockedNode?this._lockNode(this._oldLockedNode):this._unlockNode(),this._oldLockedNode=null,this._updateZoomPathStyles(this._oldZoomed),this._oldZoomed=null)},a._isMobileSize=function(){var t=this._options,e=t.parent.offsetWidth,n=i.util.getPercentValue(t.width,e);return 640>n},a._isTouch=function(){return"ontouchstart"in document.documentElement},a._postRender=function(){Object.getPrototypeOf(a)._postRender.apply(this)},a._sizeChart=function(){var t=this._options,e=(this._dataAdapter.data(),r.select(t.parent)),n=e.selectAll(".sunburst-cv"),a=n.selectAll(".sunburst-cv-wrapper"),s=a.selectAll(".sunburst-cv-container"),o=(n.selectAll(".sunburst-cv-info-pane"),n.selectAll(".sunburst-cv-mobile-scroll")),l=t.parent.offsetWidth,c=t.parent.offsetHeight,u=i.util.getPercentValue(t.width,l),d=i.util.getPercentValue(t.height,c),h=this._isMobileSize(),p=u+(h?0:-250),f=h?Math.min(p,d):d,g=t.padding,_=p-2-(g.left+g.right),m=f-2-(g.top+g.bottom);n.style("width",u+"px").style("height",d+"px").classed("is-desktop",!h).classed("not-touch",!this._isTouch()),a.style("width",p+"px").style("height",f+"px"),s.style("width",_+"px").style("height",m+"px"),s.style("padding-top",g.top+"px").style("padding-left",g.left+"px"),o.style("top",d-30+"px").classed("visible",!n.node().scrollTop).classed("show",f+130>=d),n.on("scroll",function(){o.classed("visible",!n.node().scrollTop)})},a._buildColorSlider=function(){var t=this._options,e=this,n=this._dataAdapter,i=r.select(t.parent).selectAll(".sunburst-cv-color");if(!n.getColorMetric())return i.text("");var a=(n.data(),n.getColorMetric()),s=(this._colorExtent,e._colorExtentMin),o=e._colorExtentMax,l=r.select(t.parent).selectAll(".sunburst-cv-container"),c=parseInt(l.style("width"),10),u=c/2,d=n.seqColors(),h=Math.round(100/(d.length-1)),p=[],f=12,g=10,_=9,m=40,v=f+2*g+2,y=u,x=y-2*m-2*_;d.forEach(function(t,e){p.push(e*h+"%")}),i.style("width",y+"px");var b=i.selectAll(".legend-title").data([0]);b.enter().insert("div",":first-child").classed("legend-title",!0),b.text(a.name);var A=i.selectAll(".color-slider-legend").data([0]);A.enter().append("div").classed("color-slider-legend",!0),A.style("width",y+"px").style("height",v+"px");var k=A.selectAll(".color-slider").data([0]);k.enter().append("svg").classed("color-slider",!0).style("height",v+"px").style("width","100%");var S=k.selectAll("style").data([0]);S.enter().append("style"),S.text(function(){var t=".sunburst-cv .sunburst-cv-color .grad-rect { fill: url(#backGradient); \n";
return t});var M=k.selectAll("defs").data([0]);M.enter().append("defs");var P=M.selectAll("#backGradient").data([0]);P.enter().append("linearGradient").attr("id","backGradient");var w=function(t,e,n){var i=t.selectAll("stop").data(e);i.enter().append("stop").attr("class",function(t,e){return"stop"+e}),i.attr("offset",function(t){return t}).attr("stop-color",function(t,e){return n[e]})};w(P,p,d);var O=k.selectAll(".grad-rect").data([0]);O.enter().append("rect").classed("grad-rect",!0),O.attr("x",m+_).attr("y",g).attr("rx",f/2).attr("ry",f/2).attr("width",x).attr("height",f);var T=A.selectAll(".legend-label").data(["min","max"]);T.enter().append("div").attr("class",function(t){return"legend-label "+t}),T.style("left",function(t){return("min"===t?0:m+2*_+x)+"px"}).style("width",m+"px").text(function(t){var n="min"===t?s:o;return n=null===n?"min"===t?"-":"+":e._formatNumber(a.format,n)})},a._isNodeOutsideRange=function(t){var e=(this._dataAdapter,this),n=t.children||[],i=n.some(function(t){return!e._isNodeOutsideRange(t)});return!i&&this.isOutsideRange(t)},a._isInvalidNode=function(t){return this._dataAdapter.isOther(t)},a._hideLabelText=function(){var t=this._hiddenNodes.length,e=this._dataAdapter.l10n.labels.sunburst,n=1===t?e.hidden:e["hidden2+"];return n.replace(/\{value\}/i,t)},a._hideNode=function(t,e,n){var i=this;e.indexOf(t)>-1||((n&&n(t)||!n)&&e.push(t),t.children&&t.children.length&&t.children.forEach(function(t){i._hideNode(t,e,n)}))},a._hidePath=function(t,e,n){var i=this._options,a=this._dataAdapter;this._paths,this._hideNode(t,e,n),this._layoutPaths(!0),this._lockedNode&&e.indexOf(this._lockedNode.data)>-1&&this._unlockNode(),this._zoomedPath&&e.indexOf(this._zoomedPath)>-1&&this._zoomPath(a.data());var s=this._hiddenNodes.length,o=r.select(i.parent);o.selectAll(".actions-pane-hidden").selectAll("span").html(this._hideLabelText()),o.selectAll(".sunburst-cv").classed("hiddenpaths",!!s)},a._unhidePaths=function(){this._hiddenNodes=[],this._layoutPaths(!0),r.select(this._options.parent).selectAll(".sunburst-cv").classed("hiddenpaths",!1)},a._zoomPath=function(t){this._canZoomIn(t)&&(this._zoomedPath=t,this._layoutPaths(!0),this._updateZoomPathStyles(t),this._updateDetails(this._lockedNode))},a._updateZoomPathStyles=function(t){var e=this,n=r.select(this._options.parent).selectAll(".sunburst-cv");n.classed("zoomed",t&&t.depth>0),n.selectAll(".sunburst-cv-container").selectAll("path").each(function(n){r.select(this).classed("beyondzoom",n&&t&&n!==t&&n.depth>0&&(n.depth<=t.depth||!e._hasAncestorNode(n,t))),r.select(this).classed("zoomed",n===t)})},a._changeTween=function(t){var e=this._xScale,n=this._yScale,i=this._zoomedPath||this._dataAdapter.data(),a=this._arc,s=this._radius,o=this._ringDivisor,l=this._centerRadius,c=(this._dataAdapter.categories(),r.interpolate(e.domain(),[i.x,i.x+i.dx])),u=r.interpolate(n.domain(),i.y?[0,o,i.y,1]:[0,o,1]),d=r.interpolate(n.range(),i.y?[0,l,l,s]:[0,l,s]);return function(i,s){var o=r.interpolate({x:i.xo,dx:i.dxo,y:i.yo,dy:i.dyo},i);return s?function(e){return t?a(o(e)):a(i)}:function(r){return e.domain(c(r)),n.domain(u(r)).range(d(r)),t?a(o(r)):a(i)}}},a._updatePathColors=function(){var t=this,e=(this._dataAdapter,this._getHiddenNodes()),n=r.select(this._options.parent).selectAll(".sunburst-cv"),i=n.classed("node-highlighted");this._paths.style("fill",function(e){var n=r.select(this),a=i&&!n.classed("highlighted");return t.getNodeColor(e,a)}).classed("hidden",function(t){return e.indexOf(t)>=0})},a._lockNode=function(t){var e=this,n=(e._options,e._lockedNode);return n&&n.data===t.data&&n.type===t.type?e._unlockNode(t):(e._lockedNode=t,e._highlightNode(t),e._updateLockedState(t),setTimeout(function(){r.select(e._options.parent).select(".sunburst-cv-wrapper").on("click.cvpath",function(){r.event&&r.event.target&&"path"===r.event.target.nodeName||e._unlockNode()})},10),void 0)},a._unlockNode=function(t){var e=this;e._options,e._lockedNode=null,e._updateLockedState(),t&&!e._isTouch()?e._highlightNode(t):e._unhighlightNode(),r.select(e._options.parent).select(".sunburst-cv-container").on("click.cvpath",null)},a._highlightNode=function(t){var e=this,n=t&&t.type||"path",i=t&&t.data||null,a=this._getAncestorNodes(i),s={};s.category=function(t){return t.depth===i.index+1},s.item=function(t){return t&&i&&t.name===i.name},s.path=function(t){return a.indexOf(t)>=0||e._lockedNode&&t.parent===i};var o=r.select(this._options.parent).selectAll(".sunburst-cv");o.classed("node-highlighted",!0),o.selectAll(".sunburst-cv-container").selectAll("path").each(function(t){r.select(this).classed("highlighted",s[n](t))}),e._lockedNode||o.selectAll(".info-pane-category").each(function(t){r.select(this).classed("disabled","category"===n&&t!==i)}),this._updateDetails(t),this._updatePathColors()},a._unhighlightNode=function(){this._removeHighlights(),this._updateDetails()},a._removeHighlights=function(){var t=r.select(this._options.parent);t.selectAll(".sunburst-cv").classed("node-highlighted",!1).selectAll("path").classed("highlighted",!1),t.selectAll(".info-pane-category").classed("disabled",!1),this._updatePathColors()},a._secondaryMetricChanged=function(){var t=this,e=this._dataAdapter,n=e.l10n.labels.sunburst,i=e.getSecondaryMetricIndex();t._outRangeNodes=[],i?t._hidePath(e.data(),t._invalidNodes,function(e){return t._isInvalidNode(e)}):(t._invalidNodes=[],t._layoutPaths(!0));var a=r.select(this._options.parent);a.selectAll(".sunburst-cv").classed("secondary-metric",!!i);var s=a.selectAll(".sunburst-cv-sec-viz");s.selectAll(".button").classed("active",!1);var o=e.getSecondaryMetricType();o&&s.selectAll(".button."+o).classed("active",!0);var l=e.getSecondaryMetric(),c=l&&l.name||null;s.selectAll(".title").html(c?n.mapmetric.replace(/\{metric\}/i,c):""),this._updateDetails(this._lockedNode),this._updateMetricState()},a._updateDetails=function(t){t&&"item"===t.type||(this._setChartMetrics(t),this._setDetailsMetrics(t),this._setDetailsAudiences(t),this._setDetailsCategories(t),this._setDetailsActions(t))},a._setDetailsCategories=function(t){var e=this,n=this._dataAdapter,i=n.l10n.labels.sunburst,a=(n.data(),n.categories()),s=r.select(this._options.parent).select(".info-pane-categories"),o=Math.max(0,e._zoomedPath?e._zoomedPath.depth-1:0),l=t&&"path"===t.type&&e._lockedNode?[]:a.slice(o),c=l.length,u=t||{},d=s.selectAll(".info-pane-category").data(l),h=d.enter().append("div").classed("info-pane-category",!0).classed("inactive",!0);s.select(".pane-title").select("span").text(1===c.length?i.category:i["category2+"]),d.each(function(t,n){var a=r.select(this);a.text(""),e._createRingMarker(a,c,n),a.append("span").classed("name",!0).html(t&&t.name||""),a.append("span").classed("top",!0).html("("+i.topresults.replace(/\{value\}/i,t.top)+")"),"path"===u.type?a.classed("disabled",!e._lockedNode&&u.data&&u.data.depth-1!==n-o):e._lockedNode&&"category"===e._lockedNode.type&&a.classed("disabled",t!==e._lockedNode.data)}),setTimeout(function(){h.classed("inactive",!1)},1);var p=d.exit().classed("inactive",!0).on("mouseenter",null).on("mouseleave",null).on("click",null);setTimeout(function(){p.remove()},400),d.on("mouseenter",function(t){e._lockedNode||e._isTouch()||e._highlightNode({data:t,type:"category"})}),d.on("mouseleave",function(){e._lockedNode||e._isTouch()||e._unhighlightNode()}),d.on("click",function(t){e._lockNode({data:t,type:"category"})}),s.classed("empty",!l.length)},a._setDetailsAudiences=function(t){var e=this,n=this._dataAdapter,i=t&&t.type||"",a=t&&t.data||null,s="category"===i,o=n.data(),l=s?this._getLevelUniqueNodes(o,a.index+1,!1):this._getAncestorNodes(a),c=s?function(t,e){return e}:function(t){return t&&t.depth||0},u=n.categories(),d=r.select(this._options.parent).selectAll(".sunburst-audiences"),h=l&&l[0]||o,p=o===h,f=!l||p?[]:l.slice();d.each(function(){var t=r.select(this),n=f.slice(),i=r.select(t.node().parentNode).classed("sunburst-cv-label-wrap");s||i?s&&i&&(n=[]):(e._lockedNode||(n=[]),n.reverse());var a=t.selectAll(".sunburst-audience").data(n,c),o=a.enter().append("span").classed("sunburst-audience",!0).classed("inactive",!0);o.append("span").classed("marker",!0).style("background-color","#dcdcdc"),o.append("span").classed("category",!0),o.append("span").classed("name",!0),a.each(function(n){var a=r.select(this),o=u[n.depth-1];if(a.select(".marker").style("background-color",e.getNodeColor(n)),a.select(".category").classed("hidden",s||i).text(!s&&o&&o.name||""),a.select(".name").text(n.name),a.classed("to-remove",!1).attr("my-name",n.name).attr("my-depth",n.depth),a.on("mouseenter",function(t){e._isTouch()||e._highlightNode({data:t,type:"item"})}),a.on("mouseleave",function(){e._isTouch()||(e._lockedNode?e._highlightNode(e._lockedNode):e._unhighlightNode())}),!i){var l=r.select(a.node().cloneNode(!0)).style("height","").classed("test",!0).classed("inactive",!1);t.node().appendChild(l.node()),a.attr("my-height",parseInt(l.style("height"),10)),l.remove()}}),a.order(),setTimeout(function(){a.each(function(){var t=r.select(this);t.classed("inactive",!1),i||t.style("height",t.attr("my-height")+"px")})},1);var l=a.exit().classed("inactive",!0).style("height","").classed("to-remove",!0).on("mouseenter",null).on("mouseleave",null).on("click",null);setTimeout(function(){l.each(function(){var t=r.select(this);t.classed("to-remove")&&t.remove()})},400),t.classed("empty",!n.length)})},a._setDetailsActions=function(t){function e(){s._zoomPath(s._lockedNode.data)}function n(){s._zoomPath(l)}function i(){s._hidePath(s._lockedNode.data,s._hiddenNodes)}function a(){var t=s._lockedNode.data,e=s._hiddenNodes;t&&s._hidePath(l,e,function(n){return n.name===t.name||e.indexOf(n.parent)>=0})}var s=this,o=this._dataAdapter,l=o.data(),c=r.select(this._options.parent).select(".info-pane-actions"),u=c.selectAll(".info-pane-actions-chart").data([0]);u.enter().append("div").classed("info-pane-actions-chart",!0).classed("info-pane-actions-pane",!0);var d=c.selectAll(".info-pane-actions-extra").data([0]);d.enter().append("div").classed("info-pane-actions-extra",!0).classed("info-pane-actions-pane",!0);var h=[],p=o.l10n.labels.sunburst;if(t&&"path"===t.type&&s._lockedNode){var f=t.data,g=s._canZoomIn(f),_=f===l;s._lockedNode?_||(g?h.push({click:e,className:"zoomin",icon:"zoomin",label:p.zoomin}):s._canZoomOut(f)&&h.push({click:n,className:"zoomout",icon:"zoomout",label:p.zoomout}),h.push({click:i,className:"hide",icon:"hide",label:p.hide}),h.push({click:a,className:"hideallname",icon:"hide",label:p.hideall})):(_||h.push({click:!1,icon:"more",label:p.moreAction}),g&&h.push({click:!1,icon:"zoomin",label:p.zoomAction}))}var m=s._getExtraActions(t),v=!!h.length,y=!!m.length;c.classed("full-width",!v&&y||!y&&v),c.classed("empty",!v&&!y),s._buildActionsPane(u,h),s._buildActionsPane(d,m);var x=c.selectAll(".hideallname");x.on("mouseenter",function(){s._isTouch()||s._highlightNode({data:s._lockedNode.data,type:"item"})}),x.on("mouseleave",function(){s._isTouch()||(s._lockedNode?s._highlightNode(s._lockedNode):s._unhighlightNode())})},a._buildActionsPane=function(t,e){var n=t.selectAll(".info-pane-action").data(e),i=n.enter().append("a").classed("info-pane-action",!0).classed("inactive",!0);i.append("i").classed("icon",!0),i.append("span"),n.each(function(e){var n=r.select(this);n.select(".icon").attr("class","icon").classed(e.icon,!0),n.select("span").text(e.label),n.attr("class","info-pane-action"+(n.classed("inactive")?" inactive":"")+(e.click||e.href?" action":" help")),e.click?n.on("click",e.click):n.on("click",null),e.href?n.attr("href",e.href):n.attr("href",null),e.className&&n.classed(e.className,!0);var i=r.select(n.node().cloneNode(!0)).style("height","").classed("test",!0).classed("inactive",!1);t.node().appendChild(i.node()),n.attr("my-height",parseInt(i.style("height"),10)),i.remove()}),setTimeout(function(){n.each(function(){var t=r.select(this);t.style("height",t.attr("my-height")+"px").classed("inactive",!1)})},1);var a=n.exit().classed("inactive",!0).style("height","").classed("to-remove",!0).on("click",null);return setTimeout(function(){a.each(function(){var t=r.select(this);t.classed("to-remove")&&t.remove()})},400),!!e.length},a._setDetailsMetrics=function(t){var e=r.select(this._options.parent).select(".info-pane-metrics"),n=e.select(".pri-metric-labels"),i=e.select(".sec-metrics-labels"),a=e.select(".info-pane-metrics-chart"),s=this._dataAdapter,o=s.data(),l=o.metrics.slice(0,1),c=o.metrics.slice(1),u=s.categories(),d=s.l10n.labels.sunburst,h=t&&"path"===t.type?t.data:null,p=h||o,f=h&&h.children&&h.children.length&&this._lockedNode;e.classed("total",!f),e.selectAll(".pane-title").each(function(){var t=r.select(this),e=t.select("span");return t.classed("pri-metric")?e.text(d.primarymetric):t.classed("sec-metric")?(t.classed("hidden",!c.length),e.text(c.length?1===c.length?d.secondarymetric:d["secondarymetric2+"]:"")):(t.classed("rank-chart")&&e.text(f?u[h.depth]&&u[h.depth].name:""),void 0)}),e.selectAll(".sec-metrics-help").each(function(){r.select(this).text(1===c.length?d.secondarymetrichelp:d["secondarymetrichelp2+"]).classed("hidden",!c.length)}),this._setNodeMetricLabels(n,p,l,!!h),this._setNodeMetricLabels(i,p,c,!!h),this._setNodeMetricChart(a,this._lockedNode?h:null)},a._setChartMetrics=function(t){var e=r.select(this._options.parent).select(".sunburst-cv-label-wrap"),n=this._dataAdapter.data(),i=n.metrics.slice(),a=t&&"path"===t.type?t.data:n;i.length>1&&(i.length=1),this._setNodeMetricLabels(e,a,i,!1)},a._setNodeMetricLabels=function(t,e,n,i){var a=this,s=this._dataAdapter,o=s.data(),l=s.l10n.labels.sunburst,c=t.classed("pri-metric-labels")||t.classed("sunburst-cv-label-wrap"),u=t.selectAll(".sunburst-cv-label-metric").data(n);u.enter().append("div").classed("sunburst-cv-label-metric",!0),i=e&&e.children&&e.children.length&&this._lockedNode?i:!1,u.each(function(t,n){var u=r.select(this),d=a.getNodeValue(e,c?n:n+1),h=a.getNodeValue(o,c?n:n+1),p="percent"===t.format,f=s.isOther(e)&&!c||0===h,g=p?d:d/a.getNodeValue(o,c?n:n+1),_=c||n+1===s.getSecondaryMetricIndex(),m=i&&_,v=null!==d&&!p&&!f&&e!==o;u.classed("active",_);var y=u.selectAll(".sunburst-cv-label-icon").data([t]);y.enter().append("i"),y.each(function(){r.select(this).attr("class","sunburst-cv-label-icon icon").classed(t.icon||(c?"donut":"stack"),!0)});var x=u.selectAll(".sunburst-cv-label-number").data([t]);x.enter().append("span").classed("sunburst-cv-label-number",!0),x.html(f?"":a._formatValue(t,d)).classed("hidden",f);var b=u.selectAll(".sunburst-cv-label-name").data([t]);b.enter().append("span").classed("sunburst-cv-label-name",!0).append("span"),b.select("span").html(v?l.percmetric.replace(/\{percent\}/i,a._formatNumber("percent",g)).replace(/\{metric\}/i,t.name):t.name);var A=a.getMetricMaskNum(c?n:n+1),k=b.selectAll(".sunburst-cv-label-marker").data([t]);k.enter().insert("svg",":first-child").classed("sunburst-cv-label-marker",!0).append("rect").attr("width",12).attr("height",12),k.classed("hidden",!m).select("rect").attr("style",null===A?"":"mask: url(#diagmask"+A+");"),u.on("click",c?null:function(){s.setSecondaryMetricIndex(n+1),a._secondaryMetricChanged()})}),u.exit().remove()},a._formatValue=function(t,e,n){if("time"!==t.format)return this._formatNumber(t.format,e);var i=e,r=this._dataAdapter,a=n?r.l10n.time.abbreviation:1===i?r.l10n.time.singular:r.l10n.time.plural,s=r.getTimeGranularity(i,!0);return this._formatNumber(t.format,i/s.divisor)+" "+a[s.gran]},a._setNodeMetricChart=function(t,e){function n(t,e){return 0===e||e===s.getSecondaryMetricIndex()}var a=this,s=this._dataAdapter,o=s.data(),l=a._getHiddenNodes(),c=e&&e.children||[],u=c.filter(function(t){return 0>l.indexOf(t)}),d=[],h=[],p=[],f=[],g=[],_=[],m={x:d,y:h,fill:p,metric:f,format:_,node:g},v=o.metrics.slice(),y=v.filter(n),x=y.map(function(t){return t.name});u.reverse().forEach(function(t){var e;v.forEach(function(i,r){n(i,r)&&null!==(e=a.getNodeValue(t,r))&&(h.push(e),d.push(t.name),p.push(i.name),f.push(i.name),_.push(i.format),g.push(t))})});var b=!!h.length,A=t.selectAll(".info-pane-chart-svg").data([0]);if(A.enter().append("div").classed("info-pane-chart-svg",!0),A.exit().remove(),t.classed("hidden",!b),b){var k=15,S=25,M=.05,P=y.length,w=u.length,O=P*k+S,T=S/O,z=Math.ceil(P*w*k/(1-T));A.style("height",z+"px");var C=i.chart().layers([i.geom.bar().map("group","fill").set("fill",function(t){return a.getNodeColor(t.data.node)}).each("start",function(t){var e=a.getMetricMaskNum(x.indexOf(t.data.metric));r.select(this).attr("mask",null===e?"":"url(#diagmask"+e+")")}).on("click",function(t){a._selectChildFromRanked(t)}).dodgePadding(M),i.geom.text().map("label","y").map("group","fill").set("fill","#4b4b4b").textFormat(function(t){return t?a._formatValue({format:this.__data__.data.format},t,!0):""}).textAnchor("start").set("fill","#4b4b4b").dx(4).dy(5).on("click",function(t){a._selectChildFromRanked(t)})]).coord(i.coord.cartesian().flip(!0)).data(m).position("dodge").guide("x",i.guide.axis().tickDx(function(){return r.select(this).select("span").node().offsetWidth}).tickDy(function(){return-P*k/2-r.select(this).select("span").node().offsetHeight/2}).tickSize(0).tickAnchor("end")).guide("y",i.guide.axis().ticks(0).tickSize(0).tickFormat(function(){return""})).map("x","x",i.scale.ordinal().padding(T)).width("100%").height(z).duration(400).padding({top:2,right:65}).parent(A.node());x.forEach(function(t,e){var n=i.scale.linear().lowerLimit(0);n.includeInDomain(function(t){return t.data.metric===x[e]}),C.map("y","y",n,e)}),C.render();var E=A.select("svg").selectAll("defs").data([0]);E.enter().append("defs");var N=[45],D=E.selectAll("pattern").data(N),F=D.enter().append("pattern").attr("id",function(t,e){return"diag"+e}).attr("patternUnits","userSpaceOnUse").attr("width","3").attr("height","3").attr("patternTransform",function(t){return"rotate("+t+" 2 2)"});F.append("rect").attr("x","0").attr("y","0").attr("width","3").attr("height","3").attr("style","fill:#fff;"),F.append("path").attr("d","M -1,0 l 10,0").attr("style","stroke:#222; fill:none; stroke-width: 3px;");var L=E.selectAll("mask").data(N);L.enter().append("mask").attr("id",function(t,e){return"diagmask"+e}).attr("x","0").attr("y","0").append("rect").attr("x","0").attr("y","0").attr("width","100%").attr("height","1").attr("style",function(t,e){return"stroke:none; fill:url(#diag"+e+")"}),E.selectAll("mask").selectAll("rect").attr("height",z)}else A.style("height","0px")},a._selectChildFromRanked=function(t){var e=this._lockedNode.data,n=t.data.x;if(e&&e.children&&e.children.length){var i,r,a=e.children.length,s=null;for(i=0;a>i;++i)if((r=e.children[i]).name===n){s=r;break}s&&this._lockNode({data:s,type:"path"})}},a._createRingMarker=function(t,e,n){var i,a,s,o=t.append("svg").classed("category-ring",!0),l=o.append("g").attr("transform","translate(12,12)"),c=parseInt(o.style("width"),10),u=c/2,d=2,h=1,p=u-d*e-h*(e-1);for(s=0;e>s;++s)i=p+(d+h)*s,a=i+d,l.append("path").classed("active",s===n).attr("d",r.svg.arc().innerRadius(i).outerRadius(a).startAngle(0).endAngle(2*Math.PI))},a._canZoomIn=function(t){var e=this._dataAdapter.data(),n=this._zoomedPath;return t!==e&&t!==n||t===e&&e!==n&&!!n},a._canZoomOut=function(t){return t===this._zoomedPath},a._getAncestorNodes=function(t){var e=[],n=t;if(!t)return e;for(;n.parent;)e.push(n),n=n.parent;return e.length||(e=[t]),e},a._hasAncestorNode=function(t,e){if(!t||!e||t.depth<e.depth||t===e)return!1;for(var n=t;n.parent;){if(n.parent===e)return!0;n=n.parent}return!1},a._getInfoPaneHeight=function(t){var e,n=0;return r.selectAll(t.node().childNodes).each(function(){e=r.select(this),n+=parseInt(e.style("height"),10)+parseInt(e.style("padding-bottom"),10)+parseInt(e.style("padding-top"),10)}),n},a._updateLockedState=function(t){var e=this;e._eventMap["sunburst.locked"]&&e._eventMap["sunburst.locked"].call(this,t,e._dataAdapter.data())},a._updateMetricState=function(){var t=this,e=t._dataAdapter;t._eventMap["sunburst.metric"]&&t._eventMap["sunburst.metric"].call(this,e.getSecondaryMetricIndex(),e.getSecondaryMetricType(),e.data())},a._getExtraActions=function(t){var e=this;return e._eventMap["sunburst.actions"]?e._eventMap["sunburst.actions"].call(this,t,!!this._lockedNode,e._dataAdapter.data()):[]},a.getNodeValue=function(t,e){return t?t.metrics&&t.metrics.length&&t.metrics[e]&&t.metrics[e].value!==void 0?t.metrics[e].value:e>0?null:t.size!==void 0?t.size:t.value:0},a.getMetricCategoryMinMax=function(t,e){function n(s){if(!l||l.depth!==s.depth||l===s){if(e===void 0||s.depth===e+1){if(a.isOther(s))return;if(o.indexOf(s)>=0)return;var c=r.getNodeValue(s,t);if(i===void 0?i={min:c,max:c}:(i.min=Math.min(i.min,c),i.max=Math.max(i.max,c)),e)return}s.children&&s.children.length&&s.children.forEach(function(t){n(t)})}}var i,r=this,a=this._dataAdapter,s=a.data(),o=this._getHiddenNodes(),l=this._zoomedPath;return n(s),i||null},a.getNodeColor=function(t,e){var n,i=this._dataAdapter,r=this.getColorScale(t);return t.depth?(n=i.isOther(t)?i.otherColor():i.getColorMetric()?this.isOutsideRange(t)?i.outRangeColor():r(t.metrics[i.getColorMetricIndex()].value):r(t.name),e&&(n=this._grayColor(n,t)),n):i.metricColor()},a._grayColor=function(t,e){var n=this._dataAdapter;if(n.isOther(e))return n.otherGrayColor();var i=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,r=t&&t.match(i);if(!r)return t;var a=[parseInt(r[1],16),parseInt(r[2],16),parseInt(r[3],16)],s=Math.round(.21*a[0]+.71*a[1]+.07*a[2]);return"#"+((1<<24)+(s<<16)+(s<<8)+s).toString(16).slice(1)},a.getMetricMaskNum=function(t){return 0===t?null:0},a.isOutsideRange=function(t){var e=this._dataAdapter,n=e.getColorMetric(),i=e.getColorMetricIndex();if(!n||!t||!t.metrics||"percent"!==n.format)return!1;var r=t.metrics[i].value;return r>this._colorExtentMax||this._colorExtentMin>r},a.getColorScale=function(t){var e,n=this._dataAdapter;return(e=n.getColorMetric())?"percent"===e.format?this._colorScale:this._categoryColorScales[t.depth-1]:this._colorScale},a._createColorScale=function(t,e,n,i){var a=this._dataAdapter,s=a.seqColors(),o=(e-n)*t[0]+n,l=(e-n)*t[1]+n,c=l-o,u=s.length-1;i&&(this._colorExtent=t,this._colorExtentMin=o,this._colorExtentMax=l);for(var d=[o],h=1;u>h;++h)d.push(c/u*h+o);return d.push(l),r.scale.linear().domain(d).range(s).clamp(!0)},a.setColorScale=function(t){t=t||[0,1];var e,n=this,i=this._dataAdapter,a=i.data();if(!(e=i.getColorMetric()))return this._colorScale=r.scale.ordinal().domain(i.uniques()).range(i.colors()),void 0;var s,o=i.getColorMetricIndex();return"percent"===e.format?(s=n.getMetricCategoryMinMax(o),this._colorScale=this._createColorScale(t,s.max,s.min,!0),void 0):(s=a.categories.map(function(t,e){return n.getMetricCategoryMinMax(o,e)}),this._categoryColorScales=s.map(function(e,i){return n._createColorScale(t,e.max,e.min,!i)}),this._colorExtentMin=null,this._colorExtentMax=null,void 0)},t.cloudViz.sunburst=e.util.createConstructor(a)}(this),function(t){"use strict";var e=t.cloudViz||{},n=e.core||{},i=t.dv||{},r=t.d3||{},a=Object.create(n);a.init=function(t){return this._type="flower",this._initDefaultOptions(),this.setOptions(t),this.colorScale=i.scale.color()._d3Scale,this},a._initDefaultOptions=function(){var t={animationDuration:500,labelFormatter:null,clickHandler:null,onlyUseThreePetalLengths:!0,isEmotionChart:!0,mouseoverCallback:[null,null],horizontalPadding:70,verticalPadding:30,text_offset:5};return Object.getPrototypeOf(a)._initDefaultOptions.call(this,t)},a._onAutoResize=function(){this._render()},a.resize=function(){this._render()},a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments)},a._preRender=function(){Object.getPrototypeOf(a)._preRender.apply(this)},a._setUpLayer=function(t,e){this["layer"+e]=t.selectAll(".flower-cv-svg-group-layer"+e).data([0]),this["layer"+e].enter().append("g").classed("flower-cv-svg-group-layer"+e,!0)},a.sprintf=function(t,e){return t.replace(/\{([\w]+)\}/gi,function(t,n){return e[n]})},a._render=function(){Object.getPrototypeOf(a)._render.apply(this);var t=this;this._parent=r.select(this._options.parent);var e=this._parent.selectAll(".cv-wrapper.cv-flower").data([0]);e.enter().append("div").classed("cv-wrapper cv-flower",!0);var n=e.selectAll(".flower-cv-svg").data([0]);n.enter().append("svg").classed("flower-cv-svg",!0),this._svg_group=n.selectAll(".flower-cv-svg-group").data([0]),this._svg_group.enter().append("g").classed("flower-cv-svg-group",!0),this._setUpLayer(this._svg_group,1),this._setUpLayer(this._svg_group,2),this._setUpLayer(this._svg_group,3),this._setUpLayer(this._svg_group,4),this._setUpLayer(this._svg_group,5),this._setUpLayer(this._svg_group,6);var s=this._options.width||parseInt(this._parent.style("width"),10),o=this._options.height||parseInt(this._parent.style("height"),10);e.style("width",s+"px").style("height",o+"px");var l=s/2,c=o/2;this._svg_group.attr("transform",this.sprintf("translate({width},{height})",{width:l,height:c}));var u=t._dataAdapter.data(),d=l-this._options.horizontalPadding,h=c-this._options.verticalPadding,p=this._options.labelFormatter||function(e){e.append("tspan").attr("class","flower-cv-petal-label").text(function(t){return t.label+" "}),e.append("tspan").attr("class","flower-cv-petal-label-value").text(function(e){return t._formatNumber("percent",e.value/t._total,0)})},f=this._options.mouseoverCallback[0]||function(){r.select(this).attr("opacity",1)},g=this._options.mouseoverCallback[1]||function(t){r.select(this).attr("opacity",t.petal_opacity).attr("fill",t.petal_color)};this._is_single_mode=this._options.onlyUseThreePetalLengths,this._petal_size=Math.min(d,h),this._circle_size=.676*this._petal_size/2,this._arc_thickness=.027*this._petal_size,this._arc_half_angle=360/u.length/2+.5,this._petal_count=u.length;var _=r.scale.linear().domain([55,185]).range([9,12]).clamp(!0);this._font_size=_(this._petal_size);var m=[{offset_y:1,fixed_offset_y:0,offset_x:0,location:"middle"},{offset_y:1,fixed_offset_y:0,offset_x:-1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:-.8,location:"start"},{offset_y:-1,fixed_offset_y:-9,offset_x:-1.5,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:0,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:.8,location:"end"},{offset_y:1,fixed_offset_y:0,offset_x:1.5,location:"middle"}];this._total=r.sum(u,function(t){return t.value});var v=r.scale.linear().domain([0,u.length]).range([0,360]);this._getTextOffsetIndex=r.scale.linear().domain([0,360]).rangeRound([0,8]).clamp(!0),this._getSizeZeroToThree=r.scale.linear().domain([0,r.max(u,function(t){return t.value})]).rangeRound([0,3]),this._getPetalSize=r.scale.linear().domain([r.min(u,function(t){return t.value}),r.max(u,function(t){return t.value})]).rangeRound([this._circle_size+this._arc_thickness+10,this._petal_size]),i.util.each(u,function(e,n){e.angle=v(n),t._addPetalSizes(e)}),this._getTextOffsetScale=function(t){var e=this._getTextOffsetIndex(t);return 8==e&&(e=0),m[e]};var y=this.layer1.selectAll(".flower-cv-gray-petals").data(u);y.enter().append("path").attr("class","flower-cv-gray-petals").attr("transform",function(t){return"rotate("+t.angle+")"}).attr("d",t._makePetal(0,0,0,0)).attr("opacity",0),y.transition().duration(t._options.animationDuration).attr("transform",function(t){return"rotate("+t.angle+")"}).attr("d",function(e){return t._makePetal(0,0,0,e.full_petal)}).attr("opacity",function(t){return 3==t.petal_size_number?0:1}),y.exit().transition().duration(t._options.animationDuration).attr("d",t._makePetal(0,0,0,0)).attr("opacity",0).remove();var x=this.layer2.selectAll(".flower-cv-color-petals").data(u);x.enter().append("path").attr("class","flower-cv-color-petals").attr("transform",function(t){return"rotate("+t.angle+")"}).attr("opacity",function(t){return t.petal_opacity}).attr("d",t._makePetal(0,0,0,0)).attr("fill",function(t){return t.petal_color}).on("mouseover",f).on("mouseout",g).on("click",function(e){t._options.clickHandler&&t._options.clickHandler(e)}),x.transition().duration(t._options.animationDuration).attr("d",function(e){return t._makePetal(0,0,0,e.petal_size)}).attr("transform",function(t){return"rotate("+t.angle+")"}).attr("fill",function(t){return t.petal_color}).attr("opacity",function(t){return t.petal_opacity}),x.exit().transition().duration(t._options.animationDuration).attr("d",t._makePetal(0,0,0,0)).attr("opacity",0).remove();var b=this.layer3.selectAll(".flower-cv-white-arcs").data(u),A=r.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness+1).startAngle(-t._arc_half_angle*(Math.PI/180)).endAngle(t._arc_half_angle*(Math.PI/180));b.enter().append("path").attr("class","flower-cv-white-arcs").attr("transform",function(t){return"rotate("+t.angle+")"}).attr("fill","white"),b.transition().duration(t._options.animationDuration).attr("d",A).attr("transform",function(t){return"rotate("+t.angle+")"}),b.exit().remove(),A=r.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness).startAngle(-(t._arc_half_angle-1)*(Math.PI/180)).endAngle((t._arc_half_angle-1)*(Math.PI/180));var k=this.layer4.selectAll(".flower-cv-color-arcs").data(u);k.enter().append("path").attr("class","flower-cv-color-arcs").attr("d",A).attr("transform",function(t){return"rotate("+t.angle+")"}).attr("fill",function(t){return t.arc_color}),k.transition().duration(t._options.animationDuration).attr("d",A).attr("fill",function(t){return t.arc_color}).attr("transform",function(t){return"rotate("+t.angle+")"}),k.exit().remove();var S=this.layer5.selectAll(".flower-cv-petal-labels").data(u);S.enter().append("text").attr("class","flower-cv-petal-labels").attr("x",0).attr("y",0).attr("text-anchor",function(e){return t._getTextOffsetScale(e.angle).location}).attr("dx",function(e){return t._getTextOffsetScale(e.angle).offset_x*-t._options.text_offset}).attr("dy",function(e){return t._getTextOffsetScale(e.angle).offset_y*-t._options.text_offset-t._getTextOffsetScale(e.angle).fixed_offset_y}).style("font-size",t._font_size).attr("transform",function(t){return"rotate("+t.angle+") rotate("+-t.angle+", 0, "+0+")"}).attr("opacity",0),S.style("font-size",t._font_size+"px").attr("text-anchor",function(e){return t._getTextOffsetScale(e.angle).location}).attr("dx",function(e){return t._getTextOffsetScale(e.angle).offset_x*-t._options.text_offset}).attr("dy",function(e){return t._getTextOffsetScale(e.angle).offset_y*-t._options.text_offset-t._getTextOffsetScale(e.angle).fixed_offset_y}).selectAll("*").remove(),p(S),S.transition().duration(t._options.animationDuration).attr("y",function(t){return t.petal_size}).attr("transform",function(t){return"rotate("+t.angle+") rotate("+-t.angle+", 0, "+t.petal_size+")"}).attr("opacity",function(t){return 0===t.petal_number_size?0:1}),S.exit().remove();var M=this.layer6.selectAll(".flower-cv-main-circle").data([1]);M.enter().append("circle").attr("class","flower-cv-main-circle").attr("cx",0).attr("cy",0),M.transition().duration(t._options.animationDuration).attr("r",t._circle_size)},a._makePetal=function(t,e,n,i){var r=this._circle_size+this._arc_thickness+1,a=2*r*Math.PI/this._petal_count/2,s=360*(a/(2*r*Math.PI)),o=Math.cos(s*Math.PI/180)*r,l=Math.sin(s*Math.PI/180)*r;e=-o;var c=t-l,u=t+l,d=.6*-1*(i-e),h=-1*(i-e),p=.2*h,f=["M",c,e,"C",c-p,e-d,t,i,n,i,"C",n,i,u+p,e-d,u,e];return f.join(" ")},a._addPetalSizes=function(t){t.color||(t.color=this.colorScale(t.label));var e=this._getSizeZeroToThree(t.value);this._is_single_mode||0===e&&(e=1),0===t.value&&(e=0);var n=.9,i=t.color,r=i,a=this._petal_size,s=-1*a;switch(e){case 0:n=0,r="#e6e6e6",a=0,i=i;break;case 3:n=.9;break;case 2:n=.75,a=.795*a;break;case 1:n=.5,a=.6*a}this._is_single_mode||(a=this._getPetalSize(t.value)),0===t.value&&(a=0),a*=-1,t.petal_opacity=n,t.petal_size=a,t.petal_color=i,t.full_petal=s,t.petal_number_size=e,t.arc_color=r},t.cloudViz.flower=e.util.createConstructor(a)}(this),function(t){"use strict";function e(t,e,r,a){return i(n(t,e,r,a))-i(r)-i(a)-Math.PI/2}function n(t,e,n,i){return n+t(e)*(i-n)
}function i(t){return t*Math.PI/180}function r(t,e,n){return Math.max(e,Math.min(n,t))}function a(t,e,n){var i=[];if(n&&e.length>1){for(var r,a,o=s(t.domain()),l=-1,c=e.length,u=(e[1]-e[0])/++n;c>++l;)for(r=n;--r>0;)(a=+e[l]-r*u)>=o[0]&&i.push(a);for(--l,r=0;n>++r&&(a=+e[l]+r*u)<o[1];)i.push(a)}return i}function s(t){var e=t[0],n=t[t.length-1];return n>e?[e,n]:[n,e]}var o=t.cloudViz||{},l=o.core||{},c=t.dv||{},u=t.d3||{},d=Object.create(l),h=.15,p=.05,f=.09,g=1+p,_=.05,m=.025,v=2,y=14,x=.1,b=.75,A=null,k=null;d.init=function(t){return this._type="choropleth",t=t||{},this._initDefaultOptions(),this.setOptions(t),this},d._initDefaultOptions=function(){var t={duration:750,percentOpen:x,showNeedle:!0,showAxis:!0,ticks:5,tickSubdivisions:0,format:"decimal",fillColor:"#3284d4",minValue:0,maxValue:10,colors:[{color:"#ff3400",alpha:1,from:"0%",to:"33%"},{color:"#faca00",alpha:1,from:"33%",to:"66%"},{color:"#68b672",alpha:1,from:"66%",to:"100%"}],metric:"",value:0};return this._margins={top:0,left:0,right:0,bottom:0},Object.getPrototypeOf(d)._initDefaultOptions.call(this,t)},d.render=function(){return Object.getPrototypeOf(d).render.call(this,arguments),this._determineSize(),this._initScales(),this._draw(),this},d._onAutoResize=function(){this.render()},d._determineSize=function(){var t=this._options,e=t.parent,n=t.width?t.width:e.offsetWidth,i=t.height?t.height:e.offsetHeight,r=Math.max(x,Math.min(b,t.percentOpen));t.showNeedle&&(this._margins.bottom=.05*i),this._maxAngle=180*(1-r),this._minAngle=-180*(1-r),n-=this._margins.left+this._margins.right,this._size=[n,i],this._radius=Math.min(n-this._margins.left-this._margins.right,i-this._margins.top-this._margins.bottom)/2},d._initScales=function(){var t=this._options;if(t.minValue>t.maxValue)throw Error("The minimum value is greater than the maximum value.");this._scale=u.scale.linear().domain([t.minValue,t.maxValue]).range([0,1])},d._draw=function(){this._initSVG(),this._drawTrack(),this._drawAxis(),this._drawSelectedIndicator(),this._drawLabels()},d._initSVG=function(){var t=this._options,e=u.select(t.parent);A=e.selectAll(".cv-wrapper.cv-gauge").data([0]),A.enter().append("div").classed("cv-wrapper cv-gauge",!0),A.style("width",this._size[0]+"px").style("height",this._size[1]+"px");var n=A.selectAll(".chart-wrapper").data([0]);n.enter().append("div").classed("chart-wrapper",!0);var i=n.selectAll("svg").data([0]);i.enter().append("svg"),k=i.selectAll("g").data([0]),k.enter().append("g"),k.attr("transform","translate("+(this._size[0]-this._margins.left-this._margins.right)/2+","+(this._size[1]-this._margins.top-this._margins.bottom)/2+")")},d._drawTrack=function(){var t=this,e=this._options,n=u.svg.arc().innerRadius(this._radius*(1-p-h)).outerRadius(this._radius*(1-p)).startAngle(function(e){var n=c.util.isPercentString(e.from)?parseInt(e.from,10)/100:t._scale(e.from),r=(t._maxAngle-t._minAngle)*n+t._minAngle;return i(r)}).endAngle(function(e){var n=c.util.isPercentString(e.to)?parseInt(e.to,10)/100:t._scale(e.to),r=(t._maxAngle-t._minAngle)*n+t._minAngle;return i(r)}),r=k.selectAll(".arc").data([0]);r.enter().append("g").classed("arc",!0);var a=r.selectAll("path").data(e.colors);a.enter().append("path"),a.exit().remove(),a.attr("fill",function(t){return t.color}).attr("opacity",function(t){return t.hasOwnProperty("alpha")?t.alpha:1}).attr("d",n)},d._drawAxis=function(){var t=this,i=this._options,s=this._scale.ticks(i.ticks),o=function(e,i,r,a){return function(s){s.attr("x1",0).attr("y1",v).attr("x2",0).attr("y2",t._radius*a+v).attr("transform",function(a){return n(e,a,i,r),"rotate("+n(e,a,i,r)+") translate(0,"+(t._radius*(h+p)-t._radius)+")"})}},l=k.selectAll(".axis").data(i.showAxis?[0]:[]);l.enter().append("g").classed("axis",!0),l.exit().remove();var c=l.selectAll(".tick").data(s);c.enter().append("line").classed("tick",!0),c.exit().remove(),c.call(o(this._scale,this._minAngle,this._maxAngle,_));var u=a(this._scale,s,i.tickSubdivisions),d=l.selectAll(".minor-tick").data(u);d.enter().append("line").classed("minor-tick",!0),d.exit().remove(),d.call(o(this._scale,t._minAngle,t._maxAngle,m));var f=l.selectAll(".tick-label").data(s);f.enter().append("text").classed("tick-label",!0),f.exit().remove(),f.attr("transform",function(i){var r=n(t._scale,i,t._minAngle,t._maxAngle),a=e(t._scale,i,t._minAngle,t._maxAngle),s=(t._radius-y)*(1-h-p-_),o=Math.cos(a)*s,l=Math.sin(a)*s;return-10>r&&r>-170&&(o-=3),r>10&&170>r&&(o+=3),"translate("+o+","+l+")"}).attr("text-anchor",function(e){var i=n(t._scale,e,t._minAngle,t._maxAngle);return i>-10&&10>i?"middle":0>i?null:"end"}).attr("dy",".35em").style("font-size",r(.05*t._radius,8,14)+"px").text(function(e){return t._formatNumber(i.format,e)})},d._drawSelectedIndicator=function(){var t=this._options;this._drawNeedle(t.showNeedle?[t.value]:[]),this._drawProgressFill(t.showNeedle?[]:[t.value])},d._drawNeedle=function(t){var e=this,i=this._options,r=this._radius*f/2,a=this._radius*g,s=k.selectAll(".needle").data(t);s.enter().append("path").classed("needle",!0).attr("transform","rotate("+e._minAngle+")"),s.exit().remove(),s.attr("d","M"+r/2+"-"+r+"L0-"+a+"L-"+r/2+"-"+r+"C-"+.8257*r+"-"+.8212*r+"-"+1.035*r+"-"+.9448*(r/2)+"-"+1.035*r+"-1"+"C-"+1.035*r+","+.9078*(r/2)+"-"+.5796*r+","+.9314*r+",0,"+.9314*r+"S"+1.035*r+","+.9078*(r/2)+","+1.035*r+"-1"+"C"+1.035*r+"-"+.9448*(r/2)+","+.8257*r+"-"+.8212*r+","+r/2+"-"+r+"z").transition().duration(i.duration).ease("cubic-in-out").attrTween("transform",function(t){var r=this,a=Math.min(i.maxValue,Math.max(i.minValue,t)),s=n(e._scale,a,e._minAngle,e._maxAngle),o=void 0===this.__previousD__?e._minAngle:this.__previousD__,l=u.interpolate(o,s);return function(t){return r.__previousD__=l(t),"rotate("+r.__previousD__+")"}})},d._drawProgressFill=function(t){var e=this,r=this._options,a=u.svg.arc().innerRadius(this._radius*(1-p-h)).outerRadius(this._radius*(1-p)).startAngle(i(e._minAngle)).endAngle(function(t){return i(n(e._scale,t,e._minAngle,e._maxAngle))}),s=k.selectAll(".progress").data(t);s.enter().append("path").classed("progress",!0),s.exit().remove(),s.attr("fill",r.fillColor).transition().duration(r.duration).attrTween("d",function(t){var e=this,n=Math.min(r.maxValue,Math.max(r.minValue,t)),i=void 0===this.__previousD__?r.minValue:this.__previousD__,s=u.interpolate(i,n);return function(t){return e.__previousD__=s(t),a(e.__previousD__)}})},d._drawLabels=function(){var t=this,n=this._options,i=void 0===n.value?[]:[n.value],a=void 0===n.metric?[]:[n.metric],s=e(this._scale,n.minValue,this._minAngle,this._maxAngle),o=e(this._scale,n.maxValue,this._minAngle,this._maxAngle),l=this._radius*(1-h-p),c=(this._radius-y)*(1-h-p-_),u=Math.cos(s)*c+this._radius,d=Math.cos(o)*c+this._radius,f=Math.sin(s)*l+this._radius,g=A.selectAll(".label-container").data([0]);g.enter().append("div").classed("label-container",!0),g.style("left",this._size[0]/2-this._radius+"px");var m=g.selectAll(".label-title").data(a);m.enter().append("span").classed("label-title",!0),m.exit().remove(),m.style("font-size",r(.1*this._radius,11,18)+"px").classed("multiline-ellipsis",!n.showNeedle).text(String);var v=g.selectAll(".label-number").data(i),x=Math.max(f,1.1*this._radius);if(v.enter().append("span").classed("label-number",!0).style("line-height",this._radius*h+"px"),v.exit().remove(),v.style("left",u+"px").style("width",d-u+"px").style("font-size",this._radius*h+"px").text(function(e){return t._formatNumber(n.format,e)}),n.showNeedle)m.style("top",x+.2*this._radius+"px").style("left",0).style("width",2*this._radius+"px"),v.style("top",x+"px");else{var b=2.3*r(.1*this._radius,11,20),k=this._radius*(1-p);m.style("top",k+"px").style("left",this._radius*(h+p+_+.3)+"px").style("width",2*this._radius*(1-h-p-_-.3)+"px").style("height",b+"px"),v.style("top",Math.max(k+b,x)+"px")}},t.cloudViz.gauge=o.util.createConstructor(d)}(this),function(t){"use strict";var e=t.cloudViz,n=t.dv,i=e.util.namespace("cloudViz.dataAdapter.standard"),r={};r._isDataValid=null,r.process=function(t,n){this._options=t,this.l10n=e.util.deepExtend({},e.localeDefinition(t.locale),t.l10n||{}),("data"in n||"mappings"in n)&&this._validateData(t.data,t.mappings)&&this._processOptions(t,n)},r._processOptions=function(){},r._determineOvertime=function(t){var e=this.mappings(),i=t[e.x];return i&&i.length?n.util.isDate(i[0]):!1},r._calculateDateGranularity=function(t){var e=this.mappings(),n=t[e.x];if(!n||!n.length)return"*";var i=Math.min.apply(Math,n),r=Math.max.apply(Math,n),a=(r-i)/1e3,s=a/n.length;return this.getTimeGranularity(s).gran},r.getTimeGranularity=function(t,e){var n="second",i=1;return t?(e?t>=(i=31536e3)?n="year":t>=(i=2678400)?n="month":t>=(i=604800)?n="week":t>=(i=86400)?n="day":t>=(i=3600)?n="hour":t>=(i=60)?n="minute":(n="second",i=1):(i=1)>=t?n="second":(i=60)>=t?n="minute":(i=3600)>=t?n="hour":(i=86400)>=t?n="day":(i=604800)>=t?n="week":(i=2678400)>=t?n="month":(n="year",i=31536e3),{gran:n,divisor:i}):{gran:n,divisor:i}},r._getYTitleFromLabels=function(t){var e=n.util.uniq(t);return e&&1===e.length?e[0]:null},r.data=function(){return this._options.data},r.mappings=function(){return this._options.mappings},r.formats=function(){return this._options.formats},r.xAxisTitle=function(){return this._options.xAxisTitle||null},r.yAxisTitle=function(){return this._options.yAxisTitle||null},r.dateGranularity=function(){return this._processedOptions.dateGranularity},r.isDataValid=function(){return this._validateData(this._options.data,this._options.mappings)},r._validateData=function(t){if(!t)return!1;for(var e in t)if(t[e].length)return!0;return!1},i.baseObj=r,i.base=e.util.createConstructor(r)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t),r=this.data(),a=this.mappings();this._uniqueFillValues=this._processUniqueFillValues(r,a),this._uniqueFillExtents=this._processUniqueFillExtents(r,a,this._uniqueFillValues),null==n.isOvertime&&(n.isOvertime=this._determineOvertime(r),n.isOvertime&&(n.dateGranularity=n.dateGranularity||this._calculateDateGranularity(r))),Object.getPrototypeOf(i)._processOptions.call(this,n,e)},i.isOvertime=function(){return this._processedOptions.isOvertime},i.uniqueFillValues=function(){return this._uniqueFillValues||[]},i.uniqueFillExtents=function(){return this._uniqueFillExtents},i.getUniqueFillExtent=function(t){var e=this._uniqueFillValues[t];return e?this._uniqueFillExtents[e]:null},i.getUniqueFillExtentByFill=function(t){return this._uniqueFillExtents[t]},i._processUniqueFillValues=function(t,e){var n=t[e.series];return n?dv.util.uniq(n):[]},i._processUniqueFillExtents=function(t,e){var n=t[e.series],i=t[e.y],r={};return i.map(function(t,e){var i=n[e];isFinite(t)&&null!==t&&(r[i]||(r[i]=[t,t]),r[i][0]=Math.min(t,r[i][0]),r[i][1]=Math.max(t,r[i][1]))}),r},n.barObj=i,n.bar=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);t.d3||{},i._processOptions=function(){Object.getPrototypeOf(i)._processOptions.apply(this,arguments)},i._validateData=function(t){return t?!0:!1},i.data=function(){return this._options.data},i.metric=function(){return this._options.metric},i.format=function(){return this._options.format},n.choroplethObj=i,n.choropleth=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.barObj);i._processOptions=function(t,e){this._processCategories(t),Object.getPrototypeOf(i)._processOptions.call(this,this._processedOptions,e)},i._processCategories=function(t){var e,n,i,r=Object.create(t),a=Object.create(t.data),s=t.mappings,o=s.y,l=s.x,c=s.series,u=s.seriesLabel||c,d=[],h=a[o].length,p=[],f=[],g={};for(e=0;h>e;++e){d[e]={};for(n in a){if(i=a[n][e],n===c)if(p.length){if(i!==p[p.length-1]){if(p.length===this.maxFacets){h--,e--,d.pop();break}p[p.length]=i,f[f.length]=a[u][e],g[i]=p.length}}else p=[i],f=[a[u][e]],g[i]=p.length;d[e][n]=i}}this.numFacets=p.length,d.sort(function(t,e){return t[c]===e[c]?e[o]-t[o]:g[t[c]]-g[e[c]]});for(n in a)a[n]=[];a.cvdonutorder=[];var _,m,v=0,y=this._options.maxSlices;for(this.otherIncluded=!1,e=0,h=d.length;h>e;++e)if(m=d[e][c],m!==_&&(v=0,_=m),v==y-1&&h>e+1&&d[e+1][c]===m){for(n in a)a[n]||(a[n]=[]),a[n][e]=d[e][n];this.otherIncluded=!0,a[l][e]=this.l10n.labels.core.other,++v,a.cvdonutorder[e]=e}else if(v>=y)a[o][e-1]+=d[e][o],d.splice(e,1),h=d.length,--e,++v;else{++v;for(n in a)a[n][e]=d[e][n];a.cvdonutorder[e]=e}r.yAxisTitle=t.yAxisTitle||f,r.data=a,this._processedOptions=r},i.processLabelData=function(t){var e=this.data(),n=this.mappings(),i=this._labelData=Object.create(e),r={},a={},s=i[n.series],o=i[n.y],l=i[n.x];s.forEach(function(e,n){void 0===r[e]&&(r[e]=0),void 0===a[e]&&(a[e]=0),r[e]+=o[n],(!t.isSeriesEnabled||t.isSeriesEnabled(l[n]))&&(a[e]+=o[n])});var c,u,d,h,p=i.cvtextvalue=[],f=i.cvtextperclabel=[],g=i.cvtextvallabel=[],_={};o.forEach(function(e,n){c=s[n],u=100*(parseFloat(e)/r[c]),g[n]=e,f[n]=(0!==u%1?u.toFixed(1):u)+"%",h=!t.isSeriesEnabled||t.isSeriesEnabled(l[n]),d=100*(parseFloat(e)/a[c]),void 0===_[c]&&(_[c]=0),p[n]=h?_[c]+d/2:0,_[c]+=h?d:0})},i.data=function(){return this._processedOptions.data},i.labelData=function(){return this._labelData},i.yAxisTitle=function(t){var e=this._processedOptions.yAxisTitle;return e instanceof Array&&e.length>t&&(e=e[t]),e},i.showOtherCategory=function(){return this.otherIncluded},i.numberOfFacets=function(){return this.numFacets},n.donutObj=i,n.donut=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t),r=this.data(),a=this.mappings();this._forceZero=t._forceZero,this._uniqueStrokeValues=this._processUniqueStrokeValues(r,a),this._uniqueStrokeExtents=this._processUniqueStrokeExtents(r,a),null==n.isOvertime&&(n.isOvertime=this._determineOvertime(r),n.isOvertime&&(n.dateGranularity=n.dateGranularity||this._calculateDateGranularity(r))),Object.getPrototypeOf(i)._processOptions.call(this,n,e)},i.isOvertime=function(){return this._processedOptions.isOvertime},i.uniqueStrokeValues=function(){return this._uniqueStrokeValues||[]},i.uniqueStrokeExtents=function(){return this._uniqueStrokeExtents},i.getUniqueStrokeExtent=function(t){var e=this._uniqueStrokeValues[t];return e?this._uniqueStrokeExtents[e]:null},i.getUniqueStrokeExtentByStroke=function(t){return this._uniqueStrokeExtents[t]},i._processUniqueStrokeValues=function(t,e){var n=t[e.series];return n?dv.util.uniq(n):[]},i._processUniqueStrokeExtents=function(t,e){var n=t[e.series],i=t[e.y],r={};return i.map(function(t,e){var i=n[e];isFinite(t)&&null!==t&&(r[i]||(r[i]=[t,t]),r[i][0]=Math.min(t,r[i][0]),r[i][1]=Math.max(t,r[i][1]))}),r},n.lineObj=i,n.line=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i.sizeMetricName=function(){return this._options&&this._options.sizeTitle||null},i.isBubble=function(){var t=this.mappings().size;return t&&t.length},n.pointObj=i,n.point=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);i._processOptions=function(t){var e=this._processedOptions=Object.create(t),n=JSON.parse(JSON.stringify(t.data));n.nodesById=[],n.nodes.map(function(t,e){return t._pid=e,n.nodesById[e]=t,t}),n.links=[],n.linksById=[];var r,a,s,o,l,c=this;n.paths=n.paths.filter(function(t){return t.values instanceof Array||(t.values=Array.apply(null,Array(t.nodes.length-1)).map(function(){return t.values})),t.values.some(function(t){return 0>=t})?!1:(t.nodes.map(function(t){return null!==t?n.nodes[t]._pid:null}),!0)}),n.paths.forEach(function(t,e){t.nodes.forEach(function(i,u){return u?(r=t.nodes[u-1],a=i,u===t.nodes.length-1&&null!==a&&(n.nodesById[a].isPathEnd=!0,n.nodesById[a].isPathStart&&(n.nodesById[a].isPivot=!0)),s=t.values[u-1],o=c._generateLinkId(r,a),(l=n.linksById[o])?(l.value+=s,l.paths.push(e)):(l={source:r,target:a,value:s,paths:[e]},n.linksById[o]=l,n.links.push(l)),void 0):(r=t.nodes[u],null!==r&&(n.nodesById[r].isPathStart=!0,n.nodesById[r].isPathEnd&&(n.nodesById[r].isPivot=!0)),void 0)})}),e.data=n,Object.getPrototypeOf(i)._processOptions.apply(this,arguments)},i.data=function(){return this._processedOptions.data},i.nodeKey=function(){return function(t,e){return e}},i.linkKey=function(){return function(t,e){return e}},i.pathingTitle=function(){return""},i.getPathEnd=function(){return null},i.getPathDirection=function(){return 0},i.activePathsTitle=function(t){return t&&t.length?this.l10n.labels.pathing["path2+"]:""},i.isValidPathingData=function(){var t=this.data();return t?t.nodes&&t.paths?t.nodes.length?!0:!1:!1:!1},i._generateLinkId=function(t,e){return t+"-"+e},i._sortPaths=function(t,e){var n=this.data();return function(i,r){function a(t,e,s){var o=t+s,l=e+s,c=i.nodes.length>o&&o>=0?i.nodes[o]:-1,u=r.nodes.length>l&&l>=0?r.nodes[l]:-1;if(-1!==c&&null!==c&&(c=n.nodes.indexOf(n.nodesById[c])),-1!==u&&null!==u&&(u=n.nodes.indexOf(n.nodesById[u])),null===c&&null===u)return 0;if(null===c)return s>0?1:-1;if(null===u)return s>0?-1:1;if(-1===c&&-1===u)return 0;if(-1===c)return 1;if(-1===u)return-1;var d=c-u;return 0!==d?d:a(o,l,s)}var s=i.nodes.indexOf(t._pid),o=r.nodes.indexOf(t._pid),l=a(s,o,e);return 0===l&&(l=a(s,o,-e)),0!==l?l:r.nodes.length-i.nodes.length}},i._generatePathLinks=function(t,e){var n,i,r,a,s,o,l,c,u=this.data(),d=this,h=[];return t&&t.nodes?(t.nodes.forEach(function(p,f,g){f&&(n=t.nodes[f-1],i=p,r=u.nodesById[n]||null,a=u.nodesById[i]||null,s=t.values[f-1],o=null,f>1&&(o=u.linksById[d._generateLinkId(t.nodes[f-2],n)]),l=u.linksById[d._generateLinkId(n,i)],c=s/l.value*l.dy,r&&h.push({dy:c,sy:o?o.ty+o.offset-c:l.sy+l.offset,ty:a?l.sy+l.offset:r.dy-c,source:{x:r.x,y:r.y,dx:0},target:{x:r.x+r.dx,y:r.y},value:s,path:e,pivotStart:r.isPivot}),h.push({dy:c,sy:l.sy+l.offset,ty:l.ty+l.offset,source:r,target:a,value:s,path:e}),f+1===g.length&&a&&h.push({dy:c,sy:l.ty+l.offset,ty:l.ty+l.offset,source:{x:a.x,y:a.y,dx:0},target:{x:a.x+a.dx,y:a.y},value:s,path:e,pivotEnd:a.isPivot}),l.offset+=c)}),h):h},i.nodePaths=function(t){var e=this.data(),n=e.paths.filter(function(e){return-1!==e.nodes.indexOf(t._pid)});return n},i.nodePathData=function(t,e){var n=this.data(),i=this,r=[],a=n.links;return a.forEach(function(t){t.offset=0}),t.sort(i._sortPaths(e,-1)),t.forEach(function(t,n){r=r.concat(i._generatePathLinks(t,n,e))}),r},i.linkSortActivePaths=function(t){var e,n=this.data(),i=n.paths,r=t.source?t.source:t.target;return n.links.forEach(function(t){t.offset=0}),e=t.paths.map(function(t){return i[t]}),e.sort(this._sortPaths(r,-1)),e},i.linkPathData=function(t){var e=[],n=this;return t.forEach(function(t,i){e=e.concat(n._generatePathLinks(t,i))}),e},i.canExpandNode=function(){return!0},i.canCollapseNode=function(){return!0},i.canPivotNode=function(){return!0},n.pathingObj=i,n.pathing=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);t.d3||{},i._processOptions=function(t,e,n){function r(t){return t.metrics&&t.metrics.length&&t.metrics[0]&&t.metrics[0].value!==void 0?t.metrics[0].value:t.children&&t.children.length?t.children.reduce(function(t,e){return t+r(e)},0):0}function a(t,e){return r(e)-r(t)}function s(t,e){if(t.size=t.size===void 0?r(t):t.size,t.children&&t.children.length){if(u.categories.length>e){var n=u.categories[e],i=t.children.length;n.top=n.top!==void 0?Math.max(n.top,i):i}if(t.size!==void 0&&"percent"!==d.format){var o=t.children.reduce(function(t,e){return t+r(e)},0);t.size>o&&t.children.push({id:"cv-sb-other",name:h,size:t.size-o})}t.children.sort(a),t.children.forEach(function(t){s(t,e+1)})}}function o(t,e,n){var i,r,a=p[e]||(p[e]=[]),s=t.length;for(i=0;s>i;++i)r=t[i],r._sid=n+"s"+i,h!==r.name&&(r.name&&(a[a.length]=r.name),r.children&&r.children.length&&o(r.children,e+1,r._sid))}var l=n||this._processedOptions||{},c=this._processedOptions=Object.create(t),u=JSON.parse(JSON.stringify(c.data)),d=u.metrics[0]||{name:"",format:"int"},h=this.l10n.labels.core.other;s(u,0);var p=[];o([u],0,""),u.name=d.name,p.push([d.name]),u.categories.forEach(function(t,e){t.index=e}),c.uniques=p.reduce(function(t,e){var n=e.reduce(function(t,e){return 0>t.indexOf(e)?t.push(e)&&t:t},[]);return t.concat(n)},[]),c.data=u,c.categories=u.categories,c.colorMetricIndex=l.colorMetricIndex,c.stackedMetricIndex=l.stackedMetricIndex,c.secondaryMetricIndex=l.secondaryMetricIndex,c.secondaryMetricType=l.secondaryMetricType,c.seqColors=c.seqColors,Object.getPrototypeOf(i)._processOptions.apply(this,arguments)},i.data=function(){return this._processedOptions.data},i.categories=function(){return this._processedOptions.categories},i.uniques=function(){return this._processedOptions.uniques},i.colors=function(){return this._processedOptions.colors},i.seqColors=function(){return this._processedOptions.seqColors},i.metricColor=function(){return this._processedOptions.metricColor},i.otherColor=function(){return this._processedOptions.otherColor},i.otherGrayColor=function(){return this._processedOptions.otherGrayColor},i.outRangeColor=function(){return this._processedOptions.outRangeColor},i.isOther=function(t){return t.name===this.l10n.labels.core.other},i.isRoot=function(t){return!t.parent},i.isDataEmpty=function(){var t=this.data();return!(t&&t.children&&t.children.length)},i.isSizeEmpty=function(){return!this.data().size},i._validateData=function(t){return t&&t.children&&t.children.length?!0:!1},i.getPathKey=function(t,e){return t&&t._sid||e},i.getDataByPathKey=function(){function t(n){n&&(e=i.getPathKey(n,null),e&&(r[e]=n),n.children&&n.children.forEach(t))}var e,n=this.data(),i=this,r={};return t(n),r},i.getColorMetric=function(){var t=this._processedOptions.colorMetricIndex;return t?this.data().metrics[t]:null},i.getColorMetricIndex=function(){return this._processedOptions.colorMetricIndex},i.setColorMetricIndex=function(t){this._processedOptions.colorMetricIndex===t&&(t=null),this._processedOptions.secondaryMetricIndex=t,this.setSecondaryMetricType("color")},i.getStackedMetric=function(){var t=this._processedOptions.stackedMetricIndex;return t?this.data().metrics[t]:null},i.getStackedMetricIndex=function(){return this._processedOptions.stackedMetricIndex},i.setStackedMetricIndex=function(t){this._processedOptions.stackedMetricIndex===t&&(t=null),this._processedOptions.secondaryMetricIndex=t,this.setSecondaryMetricType("height")},i.getSecondaryMetricType=function(){return this._processedOptions.secondaryMetricType},i.setSecondaryMetricType=function(t){var e=this.getSecondaryMetricIndex()||1,n=this._processedOptions;switch(n.secondaryMetricIndex=e,n.secondaryMetricType=t,t){case"color":n.colorMetricIndex=e,n.stackedMetricIndex=null;break;case"height":n.colorMetricIndex=null,n.stackedMetricIndex=e;break;case"both":n.colorMetricIndex=e,n.stackedMetricIndex=e;break;default:n.colorMetricIndex=null,n.stackedMetricIndex=null,n.secondaryMetricIndex=null,n.secondaryMetricType=null}},i.getSecondaryMetric=function(){var t=this._processedOptions.secondaryMetricIndex;return t?this.data().metrics[t]:null},i.getSecondaryMetricIndex=function(){return this._processedOptions.secondaryMetricIndex},i.setSecondaryMetricIndex=function(t){this._processedOptions.secondaryMetricIndex===t&&(t=null),this._processedOptions.secondaryMetricIndex=t,this.setSecondaryMetricType(t?this.getSecondaryMetricType()||"height":null)},n.sunburstObj=i,n.sunburst=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.standard"),i=Object.create(n.baseObj);t.d3||{},i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t),r=t.data;t.isEmotionChart&&(r=this._getEmotionData(t.data)),n.data=r,Object.getPrototypeOf(i)._processOptions.call(this,n,e)},i._getEmotionData=function(t){var e=this.l10n.labels.flower,n=[{index:"joy",label:e.joy,color:"#e6b43c"},{index:"admiration",label:e.admiration,color:"#7daf4b"},{index:"fear",label:e.fear,color:"#50965a"},{index:"surprise",label:e.surprise,color:"#00a0be"},{index:"sadness",label:e.sadness,color:"#286eaf"},{index:"disgust",label:e.disgust,color:"#964196"},{index:"anger",label:e.anger,color:"#f04641"},{index:"anticipation",label:e.anticipation,color:"#dc5f00"}],i={};return dv.util.each(t,function(t){i[t.index]=t}),dv.util.each(n,function(t){t.value=i[t.index]?i[t.index].value||0:0}),n},i._validateData=function(t){return t?!0:!1},i.data=function(){return this._processedOptions.data},n.flowerObj=i,n.flower=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.baseObj);i._getYFormats=function(t,e,n){var i=[];if(!(t&&t.metric&&e&&e.series&&n))return i;for(var r=t.metric.length,a=0;r>a;a++){var s=t.metric[a],o=t[e.series],l=n.indexOf(o[a]);i[l]=s.type}return i},i.mappings=function(){return this._processedOptions.mappings},i.formats=function(){return this._processedOptions.formats},n.baseObj=i,n.base=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.barObj);i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t);n.isOvertime=this._determineOvertime(n.data),n.yAxisTitle=t.yAxisTitle||this._getYAxisTitle(n.data),n.dateGranularity=this._getTimeGranularity(n.data),this._processData(n),this._updateMappings(n),Object.getPrototypeOf(i)._processOptions.call(this,n,e),n.formats={x:t.formats.x,y:this._getYFormats(n.data,n.mappings,this.uniqueFillValues())}},i.isOvertime=function(){return this._processedOptions.isOvertime},i.xAxisTitle=function(){return null},i.yAxisTitle=function(){return this._processedOptions.yAxisTitle},i.dateGranularity=function(){return this._processedOptions.dateGranularity},i.data=function(){return this._processedOptions.data},i.mappings=function(){return this._processedOptions.mappings},i.formats=function(){return this._processedOptions.formats},i._determineOvertime=function(t){var e=t.date,n=t.metric&&t.metric.some(function(t){return t&&t.date_ref&&t.date_ref.length>1});return e&&e.length&&n},i._getYAxisTitle=function(t){return this._getYTitleFromLabels(t.label)},i._processData=function(t){if(!t.isOvertime){var e,n=Object.create(t.data),i=n.cell.length,r=null,a=null;for(n.group=[],e=0;i>e;++e)a=r,r=n.cell[e],n.group[e]=n.series[e],a&&"incomplete"===r.status&&"incomplete"!==a.status&&(n.group[e]+="::incomplete::");t.data=n}},i._updateMappings=function(t){var e=Object.create(t.mappings);t.isOvertime?(e.x="date",e.y="value",e.group="group",e.series="series",e.seriesLabel="series_name"):(e.x="category",e.y="value",e.series="metric_series",e.seriesLabel="metric_series_name"),t.mappings=e},i._getTimeGranularity=function(t){return t.metric[0].date_range.gran};var r=n.baseObj;i._getYFormats=r._getYFormats,n.bar=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.choroplethObj);t.d3||{},i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t);this._processData(n,t),Object.getPrototypeOf(i)._processOptions.call(this,n,e)},i._processData=function(t,e){for(var n,i,r,a,s=e.data,o=s.data,l=s.metrics,c=s.filters,u=(s.dates,{values:{}}),d=0,h=l.length;h>d;++d){r=l[d],n=r.filter_ref,i=r.date_ref;for(var p=0,f=n.length;f>p;++p){a=c[n[p]];for(var g=0,_=i.length;_>g;++g)u.values[(a.info||{}).geo_id]=o[n[p]][i[g]][d].val}}t.data=u,t.metric=r.name,t.format=r.type},i.data=function(){return this._processedOptions.data},i.metric=function(){return this._processedOptions.metric},i.format=function(){return this._processedOptions.format},i._validateData=function(t){return t?!0:!1},i.data=function(){return this._processedOptions.data},n.choropleth=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.donutObj);i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t);this._updateMappings(n),Object.getPrototypeOf(i)._processOptions.call(this,n,e),n.formats={x:t.formats.x,y:this._getYFormats(n.data,n.mappings,this.uniqueFillValues())}},i.mappings=function(){return this._processedOptions.mappings},i.formats=function(){return this._processedOptions.formats},i._updateMappings=function(t){var e=Object.create(t.mappings);e.x="category",e.y="value",e.series="metric_series",e.seriesLabel="metric_series_name",t.mappings=e};var r=n.baseObj;i._getYFormats=r._getYFormats,n.donut=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.lineObj);i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t);n.isOvertime=this._determineOvertime(n.data),n.yAxisTitle=t.yAxisTitle||this._getYAxisTitle(n.data),n.dateGranularity=this._getTimeGranularity(n.data),this._updateMappings(n),this._processMultiMetric(n),this._processIncompleteData(n),Object.getPrototypeOf(i)._processOptions.call(this,n,e),n.formats={x:t.formats.x,y:n.isOvertime?this._getYFormats(n.data,n.mappings,this.uniqueStrokeValues()):t.formats.y}},i.data=function(){return this._processedOptions.data},i.mappings=function(){return this._processedOptions.mappings},i.formats=function(){return this._processedOptions.formats},i.xAxisTitle=function(){return this._processedOptions.xAxisTitle},i.yAxisTitle=function(){return this._processedOptions.yAxisTitle},i.isOvertime=function(){return this._processedOptions.isOvertime},i.dateGranularity=function(){return this._processedOptions.dateGranularity},i._determineOvertime=function(t){return+t.date[0]!==+t.date[t.date.length-1]},i._getYAxisTitle=function(t){return this._getYTitleFromLabels(t.label)},i._getTimeGranularity=function(t){return this.isOvertime()?t.metric[0].date_range.gran:"*"},i._processMultiMetric=function(t){if(!t.isOvertime){var e,n,i,r=t.data,a={series:[]},s=[],o=[];for(e=0,n=r.label.length;n>e;++e)i=r.label[e],a[i]||(s.push(i),r.metric&&r.metric.length?o.push(r.metric[e].type):o.push(null),a[i]=[]),a[i].push(r.value[e]),a.series[a[i].length-1]=r.category[e];var l={x:s[0],y:s[1]},c={x:o[0],y:{0:o[1]}};if(r.groups&&r.groups.length&&r.groups[0].length){var u,d,h=r.groups.length,p=[];for(u=0;h>u;++u)d=r.groups[u],p[u]=d.join("-");a.facet_group=p,l.series="facet_group"}s.length>2&&(l.size=s[2],c.size=o[2],t.sizeMetricName=t.sizeTitle||s[2]),t.data=a,t.mappings=l,t.formats=c,t.xAxisTitle=t.xAxisTitle||s[0],t.yAxisTitle=t.yAxisTitle||s[1]}},i._updateMappings=function(t){var e=Object.create(t.mappings);e.x="date",e.y="value",e.group="series",e.series="series",e.seriesLabel="series_name",t.mappings=e},i._processIncompleteData=function(t){if(t.isOvertime&&t.data.cell&&"stack"!==t.position&&"fill"!==t.position){var e,n,i=t.data,r=t.mappings,a=i.cell.length,s=null,o=null;for(i.cv_rs_group=i.cv_rs_group||[],e=0;a>e;++e)if(o=s,s=i.cell[e],i.cv_rs_group[e]=i.cv_rs_group[e]||i.series[e],!(i.cv_rs_group[e].indexOf("::incomplete::")>=0)){if(o&&"incomplete"===s.status&&"incomplete"!==o.status){for(n in i)i[n].splice(e,0,i[n][e-1]);i.cv_rs_group[e]+="::incomplete::",++a,++e}i.cv_rs_group[e]+="incomplete"===s.status?"::incomplete::":""}r.group="cv_rs_group"}};var r=n.baseObj;i._getYFormats=r._getYFormats,n.line=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.pointObj);i._processOptions=function(t){var e,n,r,a=this._processedOptions=Object.create(t),s=t.data,o={series:[]},l=[],c=[];
for(e=0,n=s.label.length;n>e;++e)r=s.label[e],o[r]||(l.push(r),s.metric&&s.metric.length?c.push(s.metric[e].type):c.push(null),o[r]=[]),o[r].push(s.value[e]),o.series[o[r].length-1]=s.category[e];var u={x:l[0],y:l[1]},d={x:c[0],y:c[1]};if(s.groups&&s.groups.length&&s.groups[0].length){var h,p,f=s.groups.length,g=[];for(h=0;f>h;++h)p=s.groups[h],g[h]=p.join("-");o.group=g,u.series="group"}else u.series="series";l.length>2&&(u.size=l[2],d.size=c[2],a.sizeMetricName=t.sizeTitle||l[2]),a.data=o,a.mappings=u,a.formats=d,a.xAxisTitle=t.xAxisTitle||l[0],a.yAxisTitle=t.yAxisTitle||l[1],Object.getPrototypeOf(i)._processOptions.apply(this,arguments)},i.data=function(){return this._processedOptions.data},i.mappings=function(){return this._processedOptions.mappings},i.formats=function(){return this._processedOptions.formats},i.xAxisTitle=function(){return this._processedOptions.xAxisTitle},i.yAxisTitle=function(){return this._processedOptions.yAxisTitle},i.sizeMetricName=function(){return this._processedOptions.sizeMetricName},n.point=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.pathingObj),r=4;i._processOptions=function(t,e){function n(t){return"E"===t}function r(t){return"X"===t}var a,s,o,l,c,u,d,h,p,f,g,_=Object.create(t),m=_.data,v={},y=v.nodes=[],x=v.paths=[],b={},A=this.l10n.labels.pathing,k=0;for(s in m.filters)if(a=m.filters[s],o=this._getFilterId(a)){if(l=a.info&&a.info.name||"",c=this._getFilterChild(a),u=c&&c.op||null,u&&"previous"!==u&&"next"!==u&&(c=u=null),d=c&&c.val?[].concat(c.val):[],f=0,"previous"===u){if(d.some(n)){var S="E_0";b[S]||(h={label:A.entry,id:S,column:f,index:y.length,filters:[]},y[y.length]=h,b[S]=h)}f=d.length}if("next"===u){if(d.some(r)){var M="X_0";b[M]||(h={label:A.exit,id:M,column:f,index:y.length,filters:[]},y[y.length]=h,b[M]=h)}f=0-d.length}if(p=o+"_"+f,b[p]){b[p].filters.push(a);continue}if(g="0"==o+""&&(A.exit===l+""||A.entry===l+""))continue;if("0"==o+"")continue;h={label:l,id:p,column:f,index:y.length,filters:[a]},y[y.length]=h,k=Math.min(k,f),b[p]=h}if(0!==k)for(var P in y)h=y[P],h.column-=k;var w,O,T,z,C,E,N,D,F,L,I,V,B;for(C=0,E=m.metrics.length;E>C;++C)for(w=m.metrics[C],O=w.filter_ref,T=w.date_ref,N=0,D=O.length;D>N;++N)for(s=O[N],a=m.filters[s],F=0,L=T.length;L>F;++F)z=T[F],I=m.dates[z],V=m.data[s][z][C],"invalid"!==V.status&&((h=this._getSingleNode(a,b))?h.total=+V.val:(B=this._createPath(a,b),B&&B.length&&(x[x.length]={nodes:B,values:+V.val||0})));x.sort(function(t,e){return e.nodes.length-t.nodes.length});var R,j,H,q,G,Y;for(R=0,j=x.length;j>R;++R)for(G=x[R],H=0,q=x.length;q>H;++H)R!==H&&(Y=x[H],Y.nodes.length!==G.nodes.length&&-1!==this._getPathString(G.nodes).indexOf(this._getPathString(Y.nodes))&&(Y.values-=G.values));v.paths=x=x.filter(function(t){return t.values}),_.data=v;var W=t.data.metrics;_.pathingTitle=W&&W.length&&W[0].name,Object.getPrototypeOf(i)._processOptions.call(this,_,e)},i.nodeKey=function(){return function(t){return t.id}},i.linkKey=function(){return function(t){return(t.source?t.source.id:"null")+"-"+(t.target?t.target.id:"null")}},i.pathingTitle=function(){return this._processedOptions.pathingTitle},i.getPathEnd=function(t){function e(t){return t&&(t.isPivot||"E_0"===t.id||"X_0"===t.id)}if(!t||!t.nodes||!t.nodes.length)return null;if(1===t.nodes.length)return t.nodes[0];var n=t.nodes,i=this._processedOptions.data,r=i.nodesById,a=r[n[0]],s=r[n[n.length-1]];return e(a)?a:e(s)?s:null},i.getPathDirection=function(t){var e=this.getPathEnd(t);return e?e._pid===t.nodes[0]?1:-1:0},i.activePathsTitle=function(t){if(!t||!t.length)return"";var e=this.getPathEnd(t[0]),n=this.l10n.labels.pathing;if(!e)return n["path2+"];var i=1===this.getPathDirection(t[0])?n.pathFromNode:n.pathToNode;return i.replace(/\{path\}/i,t.length>1?n["path2+"]:n.path).replace(/\{label\}/i,e.label)},i._getSingleNode=function(t,e){var n=this._getFilterId(t),i=t.filter_def&&t.filter_def.length&&t.filter_def[0]||null,r=i&&i.op||null,a=this._getFilterChild(t),s=a&&a.op||null;return"select"!==r&&"equals"!==r&&"id"!==r||"previous"===s||"next"===s?!1:e[n+"_0"]},i._getPathString=function(t){return""+t.map(function(t){return null===t?"null":t})},i._createPath=function(t,e){var n=this._getFilterId(t),i=this._getFilterChild(t),r=i&&i.op||null;if(r&&"previous"!==r&&"next"!==r)return[];var a=i&&i.val?[].concat(i.val):[];if(!a.length)return a;var s="previous"===i.op,o="0"===n,l=s?0:o?0-a.length+1:0-a.length;return s?a.push(n):a.unshift(n),this._mapNodeIds(l,a,e)},i._mapNodeIds=function(t,e,n){if(!isFinite(t)||!n)return[];t=+t;var i,r=!1,a=!1,s=e&&e.map&&e.map(function(e){return"0"===e?null:(i=e+"_"+t,n[i]?(++t,r=!0,+n[i].index):(a=!0,null))});return r&&!a?s:[]},i._getFilterId=function(t){return t.info&&(t.info.id||0===t.info.id)?t.info.id+"":null},i._getFilterChild=function(t){var e=t.filter_def&&t.filter_def.length&&t.filter_def[0]||null;return e&&e.child&&e.child.length&&e.child[0]||null},i.canExpandNode=function(t){var e=t.entryLinks.length+t.targetLinks.length,n=t.exitLinks.length+t.sourceLinks.length,i=Math.abs(parseInt(t.id.split("_")[1],10));return i>=r?!1:n&&"E_0"===t.id?!1:e&&"X_0"===t.id?!1:e&&n?!1:!0},i.canCollapseNode=function(t){var e=t.entryLinks.length+t.targetLinks.length,n=t.exitLinks.length+t.sourceLinks.length,i=parseInt(t.id.split("_")[1],10);return"E_0"===t.id||"X_0"===t.id?!1:0===i&&(n||e)||i>0&&n||0>i&&e},i.canPivotNode=function(t){var e=(t.entryLinks.length+t.targetLinks.length,t.exitLinks.length+t.sourceLinks.length,Math.abs(parseInt(t.id.split("_")[1],10)));if(0!==e)return!0;var n=this.data(),i=n.nodes.map(function(t){return parseInt(t.id.split("_")[1],10)}),r=0;return i.some(function(t){return 0===t&&r++,r>1?!0:!1})?!0:!1},n.pathingObj=i,n.pathing=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.sunburstObj);i._processOptions=function(t,e){function n(t){var e=t&&"id"===t.op?[t.val]:[];return t&&t.child&&t.child[0]?n(t.child[0]).concat(e):e}function r(t){return t&&t.child&&t.child[0]?r(t.child[0])+1:0}function a(t){var e=t&&t.filter_def&&t.filter_def[0]||null;return r(e)}function s(t,e){var n=a(t.filter),i=a(e.filter);return n===i?e.cell[0].val-t.cell[0].val:n-i}var o,l,c,u,d,h,p,f,g,_,m,v,y,x=this._processedOptions,b=this._processedOptions=Object.create(t),A=t.data,k={children:[],categories:[],metrics:A.metrics.map(function(t){return{id:t.id,icon:t.icon,name:t.name||t.id,format:t.type,categories:[]}})};if(o=A.metrics[0]){for(g=[],l=o.filter_ref,c=o.date_ref,d=0,h=l.length;h>d;++d)for(y=l[d],v=A.filters[y],p=0,f=c.length;f>p;++p)u=c[p],_=A.dates[u],m=A.data[y][u],m[0]&&"invalid"!==m[0].status&&(v.info&&0===v.info.id||g.push({filter:v,cell:m}));g.sort(s);var S,M,P,w,O,T={};g.forEach(function(t){if(v=t.filter,m=t.cell,P=v&&v.filter_def&&v.filter_def[0]||null,w=n(P),O=w.length,S=w.join("-"),!S.length&&!v.info)return m.forEach(function(t,e){k.metrics[e].value=+t.val}),void 0;if(t={id:v.info.id,pid:S?S+"-"+v.info.id:v.info.id,name:v.info.name,metrics:m.map(function(t){return{value:+t.val}}),category:v.info.category||P&&P["var"]||void 0,filtervar:P&&P["var"]||void 0,children:[]},v.info.orig_name&&(t.orig_name=v.info.orig_name),m.forEach(function(t,e){var n=k.metrics[e];n.min=n.min!==void 0?Math.min(n.min,+t.val):+t.val,n.max=n.max!==void 0?Math.max(n.max,+t.val):+t.val;var i;(i=n.categories[O])?(i.min=Math.min(i.min,+t.val),i.max=Math.max(i.max,+t.val)):n.categories[O]={min:+t.val,max:+t.val}}),S&&(M=T[S]))M.children.push(t);else{if(w.length)return;k.children.push(t)}T[t.pid]=t,k.categories[O]={name:v.info.category||P&&P["var"]||k.categories[O]}})}b.data=k,Object.getPrototypeOf(i)._processOptions.call(this,b,e,x)},i._validateData=function(t){if(!t)return!1;for(var e in t)if(t[e].length)return!0;return!1},i.getPathKey=function(t){return t&&t._sid?t.pid?t.pid:t._sid:0},n.sunburst=e.util.createConstructor(i)}(this),function(t){"use strict";var e=t.cloudViz,n=e.util.namespace("cloudViz.dataAdapter.rs"),i=Object.create(e.dataAdapter.standard.flowerObj);i._processOptions=function(t,e){var n=this._processedOptions=Object.create(t);n.data=this._parseData(t.data),Object.getPrototypeOf(i)._processOptions.call(this,n,e)},i._parseData=function(t){if(!t.metric.length)return[];var e=[],n=t.metric[0].id;return dv.util.each(t.metric,function(i,r){if(i.id==n){var a=t.filter[r].info.name,s=t.value[r];e.push({index:a.toLowerCase(),label:a,value:s})}}),e},i.formats=function(){return this._processedOptions.formats},n.flower=e.util.createConstructor(i)}(this),function(t){"use strict";t.cloudViz.localeDefinition("de_DE",{monthAbbreviations:["Jan","Feb","Mrz","Apr","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"],months:["Januar","Februar","Mrz","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekdayAbbreviations:["So","Mo","Di","Mi","Do","Fr","Sa"],weekdays:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("de_DE",{core:{nodata:"Das Diagramm enthlt keine Daten.",erroronrender:"Hoppla! Ein Fehler ist aufgetreten und das Diagramm konnte nicht gerendert werden.",other:"Sonstige",normalized:"Normalisiert"},dvcore:{target:"Zielgruppe",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Gre"},pathing:{entry:"Einstieg",exit:"Ausstieg","entry2+":"Einstiege","exit2+":"Ausstiege",path:"Pfad","path2+":"Pfade",expand:"Erweitern",focus:"Fokus",collapse:"Reduzieren",title:"Pfaderstellungs-diagramm",nodeEntries:"Einstiege fr {label}",nodeExits:"Ausstiege fr {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} von {label}",pathToNode:"{path} zu {label}",pathFromNode:"{path} aus {label}",help1:"Dieses Diagramm stellt Pfade dar, die von einem Status in einen anderen bernommen wurden.",help2:"Jeder Knoten in Form eines Feldes reprsentiert einen Status im Pfad.",help3:"Durch Tippen oder Klicken auf einen Knoten werden zustzliche Optionen zum ndern des Diagramms angezeigt:",focusHelp:"Zeigt Pfade an, die am Knoten ein- oder ausgehen.",expandHelp:"Zeigt zustzliche Pfade an, die am Knoten ein- oder ausgehen.",collapseHelp:"Entfernt Pfade, die am Knoten ein- oder ausgehen."},sunburst:{audience:"Zielgruppe","audience2+":"Zielgruppen",category:"Kategorie","category2+":"Kategorien",metric:"Metrik","metric2+":"Metriken",primarymetric:"Primre Metrik",secondarymetric:"Sekundre Metrik","secondarymetric2+":"Sekundre Metriken",secondarymetrichelp:"Klicken Sie auf die Metrik, um die Hhe zu ndern.","secondarymetrichelp2+":"Klicken Sie auf die Metriken, um die Hhe zu ndern.",emptyFirstMetric:"Die erste Metrik enthlt keine Werte. Whlen Sie eine andere Metrik.",total:"Gesamt",zoomAction:"Doppelklicken, um zu vergrern.",moreAction:"Klicken Sie hier fr weitere Optionen.",zoomin:"Nahansicht",zoomout:"Weitansicht",hide:"Ausblenden",hideall:"Alles ausblenden",hideother:"Sonstige ausblenden",hidden:"{value} verborgenes Element","hidden2+":"{value} verborgene Elemente",topresults:"Top {value}",color:"Farbe",height:"Hhe",both:"Beide",none:"Keine",mapmetric:"{metric} anzeigen als:",percmetric:"{percent} der {metric}",mobilescroll:"&#x25BC  scrollen Sie, um Details anzuzeigen."},flower:{joy:"Freude",admiration:"Bewunderung",fear:"Angst",surprise:"berraschung",sadness:"Traurigkeit",disgust:"Emprung",anger:"Wut",anticipation:"Vorausschtzung"},venn:{definedAudience:"Definierte Zielgruppe"}},"labels"),t.cloudViz.localeDefinition("de_DE",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H Uhr %a %e"},fullFormat:{hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y"}},"dateFormat"),t.cloudViz.localeDefinition("de_DE",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("de_DE",{singular:{second:"Sekunde",minute:"Minute",hour:"Stunde",day:"Tag",week:"Woche",month:"Monat",year:"Jahr"},plural:{second:"Sekunden",minute:"Minuten",hour:"Stunden",day:"Tagen",week:"Wochen",month:"Monate",year:"Jahre"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("en_US",{monthAbbreviations:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdayAbbreviations:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("en_US",{core:{nodata:"The chart has no data",erroronrender:"Oops! There was an error and the chart could not be rendered.",other:"Other",normalized:"Normalized"},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"Entry",exit:"Exit","entry2+":"Entries","exit2+":"Exits",path:"Path","path2+":"Paths",expand:"Expand",focus:"Focus",collapse:"Collapse",title:"Pathing Chart",nodeEntries:"{label} Entries",nodeExits:"{label} Exits",nodeToNode:"{source}  {target}",percOfNode:"{perc} of {label}",pathToNode:"{path} to {label}",pathFromNode:"{path} from {label}",help1:"This chart represents paths taken from one state to another.",help2:"Each node, shaped as a box, represents a state in the path.",help3:"Tapping or clicking a node will provide additional options to modify the chart:",focusHelp:"Shows paths coming into and going out of node",expandHelp:"Shows additional paths coming or going from the node",collapseHelp:"Removes paths coming or going from the node"},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Category","category2+":"Categories",metric:"Metric","metric2+":"Metrics",primarymetric:"Primary Metric",secondarymetric:"Secondary Metric","secondarymetric2+":"Secondary Metrics",secondarymetrichelp:"Click metric to toggle height","secondarymetrichelp2+":"Click metrics to toggle height",emptyFirstMetric:"The first metric has no values. Please pick a different metric.",total:"Total",zoomAction:"Double-click to Zoom in.",moreAction:"Click for more options.",zoomin:"Zoom In",zoomout:"Zoom Out",hide:"Hide",hideall:"Hide All",hideother:"Hide Other",hidden:"{value} Hidden Item","hidden2+":"{value} Hidden Items",topresults:"top {value}",color:"Color",height:"Height",both:"Both",none:"None",mapmetric:"Show {metric} as:",percmetric:"{percent} of {metric}",mobilescroll:"&#x25BC scroll for details"},flower:{joy:"Joy",admiration:"Admiration",fear:"Fear",surprise:"Surprise",sadness:"Sadness",disgust:"Disgust",anger:"Anger",anticipation:"Anticipation"},venn:{definedAudience:"Defined Audience"}},"labels"),t.cloudViz.localeDefinition("en_US",{shortFormat:{hour:"%I %p",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%I %p",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%I %p %a %e"},fullFormat:{hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%b %e, %Y",condensed:"%m/%d/%Y"}},"dateFormat"),t.cloudViz.localeDefinition("en_US",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("en_US",{singular:{second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month",year:"year"},plural:{second:"seconds",minute:"minutes",hour:"hours",day:"days",week:"weeks",month:"months",year:"years"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("es_ES",{monthAbbreviations:["en.","febr.","mzo.","abr.","my.","jun.","jul.","ag.","sept.","oct.","nov.","dic."],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],weekdayAbbreviations:["dom.","lun.","mart.","mirc.","juev.","vier.","sb."],weekdays:["domingo","lunes","martes","mircoles","jueves","viernes","sbado"],ampm:["a. m.","p. m."]},"calendar"),t.cloudViz.localeDefinition("es_ES",{core:{nodata:"El grfico no contiene datos",erroronrender:"Se ha producido un error y no se ha podido procesar el grfico.",other:"Otro",normalized:"Normalizado"},dvcore:{target:"Destino",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamao"},pathing:{entry:"Entrada",exit:"Salida","entry2+":"Entradas","exit2+":"Salidas",path:"Ruta","path2+":"Rutas",expand:"Expandir",focus:"Enfoque",collapse:"Contraer",title:"Grfico de ruta",nodeEntries:"Entradas de {label}",nodeExits:"Salidas de {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} a {label}",pathFromNode:"{path} de {label}",help1:"Este grfico representa las rutas que se pueden tomar para ir de un estado a otro.",help2:"Los nodos, con forma de caja, representan un estado en la ruta.",help3:"Al hacer clic o tocar un nodo, se mostrarn opciones adicionales para modificar el grfico:",focusHelp:"Muestra las rutas de ida al nodo o de vuelta",expandHelp:"Muestra rutas adicionales de ida al nodo o de vuelta",collapseHelp:"Suprime las rutas de ida al nodo o de vuelta"},sunburst:{audience:"Audiencia","audience2+":"Audiencias",category:"Categora","category2+":"Categoras",metric:"Mtrica","metric2+":"Mtrica",primarymetric:"Mtrica principal",secondarymetric:"Mtrica secundaria","secondarymetric2+":"Mtricas secundarias",secondarymetrichelp:"Haga clic en la mtrica para alternar la altura","secondarymetrichelp2+":"Haga clic en las mtricas para alternar la altura",emptyFirstMetric:"La primera mtrica no contiene ningn valor. Elija otra mtrica.",total:"Total",zoomAction:"Doble clic para aumentar.",moreAction:"Haga clic para ver ms opciones.",zoomin:"Acercar",zoomout:"Alejar",hide:"Ocultar",hideall:"Ocultar todo",hideother:"Ocultar otro",hidden:"{value} elemento oculto","hidden2+":"{value} elementos ocultos",topresults:"{value} principales",color:"Color",height:"Altura",both:"Ambos",none:"Ninguno",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC desplcese para ms detalles"},flower:{joy:"Alegra",admiration:"Admiracin",fear:"Miedo",surprise:"Sorpresa",sadness:"Tristeza",disgust:"Desagrado",anger:"Enfado",anticipation:"Expectacin"},venn:{definedAudience:"Audiencia definida"}},"labels"),t.cloudViz.localeDefinition("es_ES",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %I %p",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y"}},"dateFormat"),t.cloudViz.localeDefinition("es_ES",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("es_ES",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"da",week:"semana",month:"mes",year:"ao"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"das",week:"semanas",month:"meses",year:"aos"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("fr_FR",{monthAbbreviations:["Janv.","Fvr.","Mars","Avr.","Mai","Juin","Juill.","Aot","Sept.","Oct.","Nov.","Dc."],months:["Janvier","Fvrier","Mars","Avril","Mai","Juin","Juillet","Aot","Septembre","Octobre","Novembre","Dcembre"],weekdayAbbreviations:["Dim.","Lun.","Mar.","Mer.","Jeu.","Ven.","Sam."],weekdays:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("fr_FR",{core:{nodata:"Le graphique ne contient aucune donne",erroronrender:"Une erreur sest produite, impossible de restituer le graphique.",other:"Autre",normalized:"Normalis"},dvcore:{target:"Cible",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Taille"},pathing:{entry:"Entre",exit:"Sortie","entry2+":"Entres de","exit2+":"Sorties de",path:"Chemin daccs","path2+":"Chemins daccs",expand:"Dvelopper",focus:"Mise au point",collapse:"Rduire",title:"Graphique du cheminement",nodeEntries:"Entres {label}",nodeExits:"Sorties {label}",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path}  {label}",pathFromNode:"{path} de {label}",help1:"Ce graphique reprsente les chemins daccs rcuprs dun tat  un autre.",help2:"Chaque nud, en forme de cadre, reprsente un tat dans le chemin daccs.",help3:"Le fait dappuyer ou de cliquer sur un nud fournit dautres options pour modifier le graphique:",focusHelp:"Prsente les chemins daccs issus du nud ou y parvenant",expandHelp:"Prsente des chemins daccs supplmentaires issus du nud ou y parvenant.",collapseHelp:"Supprime les chemins daccs supplmentaires issus du nud ou y parvenant."},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Catgorie","category2+":"Catgories",metric:"Mesure","metric2+":"Mesures",primarymetric:"Mesure principale",secondarymetric:"Mesure secondaire","secondarymetric2+":"Mesures secondaires",secondarymetrichelp:"Cliquer sur une mesure pour activer/dsactiver la hauteur","secondarymetrichelp2+":"Cliquer sur des mesures pour activer/dsactiver la hauteur",emptyFirstMetric:"La premire mesure na aucune valeur. Slectionnez une autre mesure.",total:"Total",zoomAction:"Double-cliquez pour effectuer un zoom avant.",moreAction:"Cliquez pour plus doptions.",zoomin:"Zoom avant",zoomout:"Zoom arrire",hide:"Masquer",hideall:"Tout masquer",hideother:"Masquer autres",hidden:"{value} lment masqu","hidden2+":"{value} lments masqus",topresults:"{value} premiers",color:"Couleur",height:"Hauteur",both:"Les deux",none:"Nant",mapmetric:"Afficher {metric} comme:",percmetric:"{percent} des {metric}",mobilescroll:"Dfilement &#x25BC pour plus de dtails"},flower:{joy:"Joie",admiration:"Admiration",fear:"Peur",surprise:"Surprise",sadness:"Tristesse",disgust:"Dgot",anger:"Colre",anticipation:"Anticipation"},venn:{definedAudience:"Audience dfinie"}},"labels"),t.cloudViz.localeDefinition("fr_FR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H h %a %e"},fullFormat:{hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b %Y",condensed:"%d/%m/%Y"}},"dateFormat"),t.cloudViz.localeDefinition("fr_FR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("fr_FR",{singular:{second:"seconde",minute:"minute",hour:"heure",day:"jour",week:"semaine",month:"mois",year:"anne"},plural:{second:"secondes",minute:"minutes",hour:"heures",day:"jours",week:"semaines",month:"mois",year:"annes"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("ja_JP",{monthAbbreviations:["1","2","3","4","5","6","7","8","9","10","11","12"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("ja_JP",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{label}{perc}",pathToNode:"{label}{path}",pathFromNode:"{label}{path}",help1:"",help2:"",help3:"",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:"{value}",color:"",height:"",both:"",none:"",mapmetric:"{metric}:",percmetric:"{metric}{percent}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""}},"labels"),t.cloudViz.localeDefinition("ja_JP",{shortFormat:{hour:"%p %I ",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%b",quarter:"%b",year:"%Y",fallback:"%e  (%a)"},longFormat:{hour:"%e  (%a) %p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  (%a) %p %I "},fullFormat:{hour:"%e  (%a) %p %I ",day:"%e  (%a)",week:"%e  (%a)",month:"%Y  %B",quarter:"%Y  %B",year:"%Y",fallback:"%Y  %b %e ",condensed:"%Y/%m/%d"}},"dateFormat"),t.cloudViz.localeDefinition("ja_JP",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("ja_JP",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("ko_KR",{monthAbbreviations:["1","2","3","4","5","6","7","8","9","10","11","12"],months:["1","2","3","4","5","6","7","8","9","10","11","12"],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("ko_KR",{core:{nodata:"  .",erroronrender:"     .",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}({time})",legendTime:"{value}{time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"  ",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{label} {perc}",pathToNode:"{label}  {path}",pathFromNode:"{label}  {path}",help1:"        .",help2:"       .",help3:"         .",focusHelp:"    ",expandHelp:"     ",collapseHelp:"    "},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:" ",secondarymetric:" ","secondarymetric2+":" ",secondarymetrichelp:"   ","secondarymetrichelp2+":"   ",emptyFirstMetric:"    .   .",total:"",zoomAction:"   .",moreAction:"   .",zoomin:"",zoomout:"",hide:"",hideall:" ",hideother:" ",hidden:"{value}  ","hidden2+":"{value}  ",topresults:" {value}",color:"",height:"",both:" ",none:"",mapmetric:"{metric}  :",percmetric:"{metric}  {percent} ",mobilescroll:"&#x25BC    ."},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:" "}},"labels"),t.cloudViz.localeDefinition("ko_KR",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e %a %p %I"},fullFormat:{hour:"%e %a %p %I",day:"%A %e",week:"%A %e",month:"%Y  %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e",condensed:"%Y/%m/%d"}},"dateFormat"),t.cloudViz.localeDefinition("ko_KR",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("ko_KR",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("pt_BR",{monthAbbreviations:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],months:["Janeiro","Fevereiro","Maro","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],weekdayAbbreviations:["Dom","Seg","Ter","Qua","Qui","Sex","Sb"],weekdays:["Domingo","Segunda-feira","Tera-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sbado"],ampm:["AM","PM"]},"calendar"),t.cloudViz.localeDefinition("pt_BR",{core:{nodata:"O grfico no possui dados",erroronrender:"Ops! Houve um erro e o grfico no pde ser processado.",other:"Outro",normalized:"Normalizado"},dvcore:{target:"Meta",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (em {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamanho"},pathing:{entry:"Entrada",exit:"Sair","entry2+":"Entradas","exit2+":"Sadas",path:"Caminho","path2+":"Caminhos",expand:"Expandir",focus:"Foco",collapse:"Recolher",title:"Grfico de criao de caminho",nodeEntries:"{label} Entradas",nodeExits:"{label} Sadas",nodeToNode:"{source}  {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} para {label}",pathFromNode:"{path} de {label}",help1:"Esse grfico representa os caminhos tomados de um estado para outro.",help2:"Cada n, formado como uma caixa representa um estado no caminho.",help3:"Tocar ou clicar em um n fornecer opes adicionais para modificar o grfico:",focusHelp:"Mostra os caminhos entrando ou saindo do n",expandHelp:"Mostra caminhos adicionais entrando ou saindo do n",collapseHelp:"Remove os caminhos saindo ou entrando no n"},sunburst:{audience:"Pblico-alvo","audience2+":"Pblicos-alvos",category:"Categoria","category2+":"Categorias",metric:"Mtrica","metric2+":"Mtricas",primarymetric:"Mtrica principal",secondarymetric:"Mtrica secundria","secondarymetric2+":"Mtricas secundrias",secondarymetrichelp:"Clique na mtrica para alternar a altura","secondarymetrichelp2+":"Clique nas mtricas para alternar a altura",emptyFirstMetric:"A primeira mtrica no tem valores. Esolha uma mtrica diferente.",total:"Total",zoomAction:"Clique duas vezes para aumentar o zoom.",moreAction:"Clique para ver mais opes.",zoomin:"Ampliar",zoomout:"Reduzir",hide:"Ocultar",hideall:"Ocultar tudo",hideother:"Ocultar outro",hidden:"{value} Item oculto","hidden2+":"{value} itens ocultos",topresults:"principais {value}",color:"Cor",height:"Altura",both:"Ambos",none:"Nenhum",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC role para ver os detalhes"},flower:{joy:"Alegria",admiration:"Admirao",fear:"Medo",surprise:"Problemas",sadness:"Tristeza",disgust:"Repulsa",anger:"Raiva",anticipation:"Antecipao"},venn:{definedAudience:"Pblico-alvo definido"}},"labels"),t.cloudViz.localeDefinition("pt_BR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%Y/%m/%d"}},"dateFormat"),t.cloudViz.localeDefinition("pt_BR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"R$",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat"),t.cloudViz.localeDefinition("pt_BR",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"da",week:"semana",month:"ms",year:"ano"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"dias",week:"semanas",month:"meses",year:"anos"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")
}(this),function(t){"use strict";t.cloudViz.localeDefinition("zh_CN",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("zh_CN",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}{time}",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{perc}  {label}",pathToNode:" {label}  {path}",pathFromNode:" {label}  {path}",help1:"",help2:"",help3:"",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:" {value}",color:"",height:"",both:"",none:"",mapmetric:"{metric} :",percmetric:"{percent}  {metric}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""}},"labels"),t.cloudViz.localeDefinition("zh_CN",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%Y %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e ",condensed:"%Y/%m/%d"}},"dateFormat"),t.cloudViz.localeDefinition("zh_CN",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("zh_CN",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("zh_TW",{monthAbbreviations:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],months:["1 ","2 ","3 ","4 ","5 ","6 ","7 ","8 ","9 ","10 ","11 ","12 "],weekdayAbbreviations:["","","","","","",""],weekdays:["","","","","","",""],ampm:["",""]},"calendar"),t.cloudViz.localeDefinition("zh_TW",{core:{nodata:"",erroronrender:"",other:"",normalized:""},dvcore:{target:"",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:""},pathing:{entry:"",exit:"","entry2+":"","exit2+":"",path:"","path2+":"",expand:"",focus:"",collapse:"",title:"",nodeEntries:"{label} ",nodeExits:"{label} ",nodeToNode:"{source}  {target}",percOfNode:"{perc}  {label}",pathToNode:" {label}  {path}",pathFromNode:" {label}  {path}",help1:"",help2:"",help3:":",focusHelp:"",expandHelp:"",collapseHelp:""},sunburst:{audience:"","audience2+":"",category:"","category2+":"",metric:"","metric2+":"",primarymetric:"",secondarymetric:"","secondarymetric2+":"",secondarymetrichelp:"","secondarymetrichelp2+":"",emptyFirstMetric:"",total:"",zoomAction:"",moreAction:"",zoomin:"",zoomout:"",hide:"",hideall:"",hideother:"",hidden:"{value} ","hidden2+":"{value} ",topresults:" {value} ",color:"",height:"",both:"",none:"",mapmetric:" {metric} :",percmetric:"{percent}  {metric}",mobilescroll:"&#x25BC "},flower:{joy:"",admiration:"",fear:"",surprise:"",sadness:"",disgust:"",anger:"",anticipation:""},venn:{definedAudience:""}},"labels"),t.cloudViz.localeDefinition("zh_TW",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e  %a %p %I"},fullFormat:{hour:"%e  %a %p %I",day:"%A %e",week:"%A %e",month:"%Y  %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e ",condensed:"%Y/%m/%d"}},"dateFormat"),t.cloudViz.localeDefinition("zh_TW",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"NT$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat"),t.cloudViz.localeDefinition("zh_TW",{singular:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},plural:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""},abbreviation:{second:"",minute:"",hour:"",day:"",week:"",month:"",year:""}},"time")}(this),function(t){"use strict";t.cloudViz.localeDefinition("zz_ZZ",{monthAbbreviations:["[g] _Jan_","[q] _Feb_","[r] _Mar_","[n] _Apr_","[p] _May_","[k] _Jun_","[l] _Jul_","[i] _Aug_","[j] _Sep_","[h] _Oct_","[o] _Nov_","[m] _Dec_"],months:["[1] _January_","[2] _February_","[3] _March_","[x] _April_","[y] _May_","[z] _June_","[0] _July_","[s] _August_","[t] _September_","[u] _October_","[v] _November_","[w] _December_"],weekdayAbbreviations:["[+] _Sun_","[4] _Mon_","[5] _Tue_","[6] _Wed_","[7] _Thu_","[8] _Fri_","[9] _Sat_"],weekdays:["[BB] _Sunday_","[BA] _Monday_","[/] _Tuesday_","[BC] _Wednesday_","[BD] _Thursday_","[BE] _Friday_","[BF] _Saturday_"],ampm:["[e] _AM_","[f] _PM_"]},"calendar"),t.cloudViz.localeDefinition("zz_ZZ",{core:{nodata:"[BH] _The chart has no data_",erroronrender:"[BG] _Oops! There was an error and the chart could not be rendered._",other:"[BJ] _Other_",normalized:"[BI] _Normalized_"},dvcore:{target:"[BL] _Target_",yAxisTimeNoTitle:"[BK] _{time}_",yAxisTimeWithTitle:"[BN] _{title} (in {time})_",legendTime:"[BM] _{value} {time}_"},point:{xScale:"[Bp] _X_",yScale:"[Br] _Y_",sizeScale:"[Bq] _Size_"},pathing:{entry:"[Be] _Entry_",exit:"[Bg] _Exit_","entry2+":"[Bn] _Entries_","exit2+":"[Bb] _Exits_",path:"[BZ] _Path_","path2+":"[Bf] _Paths_",expand:"[BX] _Expand_",focus:"[BW] _Focus_",collapse:"[Bj] _Collapse_",title:"[Bc] _Pathing Chart_",nodeEntries:"[Cz] _{label} Entries_",nodeExits:"[C0] _{label} Exits_",nodeToNode:"[Cy] _{source}  {target}_",percOfNode:"[Ba] _{perc} of {label}_",pathToNode:"[Bo] _{path} to {label}_",pathFromNode:"[Bd] _{path} from {label}_",help1:"[BY] _This chart represents paths taken from one state to another._",help2:"[Bh] _Each node, shaped as a box, represents a state in the path._",help3:"[Bk] _Tapping or clicking a node will provide additional options to modify the chart:_",focusHelp:"[Bm] _Shows paths coming into and going out of node_",expandHelp:"[Bi] _Shows additional paths coming or going from the node_",collapseHelp:"[Bl] _Removes paths coming or going from the node_"},sunburst:{audience:"[Ci] _Audience_","audience2+":"[Ce] _Audiences_",category:"[Ch] _Category_","category2+":"[Cf] _Categories_",metric:"[Cd] _Metric_","metric2+":"[Cg] _Metrics_",primarymetric:"[Cj] _Primary Metric_",secondarymetric:"[Cl] _Secondary Metric_","secondarymetric2+":"[Ck] _Secondary Metrics_",secondarymetrichelp:"[Cm] _Click metric to toggle height_","secondarymetrichelp2+":"[Cn] _Click metrics to toggle height_",emptyFirstMetric:"[B2] _The first metric has no values. Please pick a different metric._",total:"[B7] _Total_",zoomAction:"[By] _Double-click to Zoom in._",moreAction:"[B5] _Click for more options._",zoomin:"[Bz] _Zoom In_",zoomout:"[Bs] _Zoom Out_",hide:"[Bt] _Hide_",hideall:"[Bw] _Hide All_",hideother:"[Bu] _Hide Other_",hidden:"[B4] _{value} Hidden Item_","hidden2+":"[B0] _{value} Hidden Items_",topresults:"[B8] _top {value}_",color:"[Bx] _Color_",height:"[Bv] _Height_",both:"[B6] _Both_",none:"[B3] _None_",mapmetric:"[B9] _Show {metric} as:_",percmetric:"[B1] _{percent} of {metric}_",mobilescroll:"[Co] _&#x25BC scroll for details_"},flower:{joy:"[BU] _Joy_",admiration:"[BT] _Admiration_",fear:"[BQ] _Fear_",surprise:"[BR] _Surprise_",sadness:"[BO] _Sadness_",disgust:"[BP] _Disgust_",anger:"[BV] _Anger_",anticipation:"[BS] _Anticipation_"},venn:{definedAudience:"[B+] _Defined Audience_"}},"labels"),t.cloudViz.localeDefinition("zz_ZZ",{shortFormat:{hour:"[Z] _%I %p_",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"[d] _%Y_",fallback:"%e"},mediumFormat:{hour:"[S] _%I %p_",day:"[Q] _%a %e_",week:"[T] _%a %e_",month:"%b",quarter:"%b",year:"[U] _%Y_",fallback:"[V] _%a %e_"},longFormat:{hour:"[P] _%I %p %a %e_",day:"[M] _%A %e_",week:"[O] _%A %e_",month:"[L] _%B_",quarter:"[K] _%B_",year:"[J] _%Y_",fallback:"[N] _%I %p %a %e_"},fullFormat:{hour:"[D] _%I %p %a %e_",day:"[C] _%A %e_",week:"[B] _%A %e_",month:"[G] _%B %Y_",quarter:"[E] _%B %Y_",year:"[I] _%Y_",fallback:"[F] _%b %e, %Y_",condensed:"[H] _%m/%d/%Y_"}},"dateFormat"),t.cloudViz.localeDefinition("zz_ZZ",{decimalSeparator:"[CC] _._",groupSeparator:"[CD] _,_",negativePattern:"[CE] _-{number}_",percent:{symbol:"[CF] _%_",positivePattern:"[CG] _{number}{symbol}_",negativePattern:"[CH] _-{number}{symbol}_"},currency:{symbol:"[B/] _$_",positivePattern:"[CA] _{symbol}{number}_",negativePattern:"[CB] _-{symbol}{number}_"}},"numberFormat"),t.cloudViz.localeDefinition("zz_ZZ",{singular:{second:"[CX] _second_",minute:"[CY] _minute_",hour:"[CZ] _hour_",day:"[CV] _day_",week:"[Ca] _week_",month:"[Cb] _month_",year:"[CW] _year_"},plural:{second:"[CS] _seconds_",minute:"[CP] _minutes_",hour:"[Cc] _hours_",day:"[CR] _days_",week:"[CQ] _weeks_",month:"[CT] _months_",year:"[CU] _years_"},abbreviation:{second:"[CJ] _s_",minute:"[CO] _min_",hour:"[CK] _h_",day:"[CI] _d_",week:"[CL] _w_",month:"[CM] _mon_",year:"[CN] _y_"}},"time")}(this);