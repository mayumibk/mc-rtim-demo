!function(){"use strict";function e(e,t){e.state("gwt-landing",{url:"/gwt-landing",templateUrl:"components/shared/html/just-loading.html"}).state("home-overview",{url:"/home-overview",templateUrl:"components/shared/html/just-loading.html",controller:"OverviewController",controllerAs:"overviewController"}).state("home-alerts",{url:"/home-alerts",templateUrl:"components/shared/html/just-loading.html",controller:"AlertsController",controllerAs:"alertsController"}).state("portfolios-home",{url:"/portfolios-home",templateUrl:"components/shared/html/just-loading.html",controller:"PortfoliosHomeController",controllerAs:"portfoliosHomeController"}).state("portfolios-cards",{url:"/portfolios-cards",templateUrl:"components/shared/html/just-loading.html",controller:"PortfoliosCardsController",controllerAs:"portfoliosCardsController"}).state("portfolios-objectives",{url:"/portfolios-objectives",templateUrl:"components/shared/html/just-loading.html",controller:"PortfoliosObjectivesController",controllerAs:"portfoliosObjectivesController"}).state("portfolios-spend-recommendation",{url:"/portfolios-spend-recommendation",templateUrl:"components/shared/html/just-loading.html",controller:"PortfoliosSpendRecommendationController",controllerAs:"portfoliosSpendRecommendationController"}).state("search-engines",{url:"/search/search-engines",templateUrl:"components/shared/html/just-loading.html",controller:"SearchEnginesController",controllerAs:"searchEnginesController"}).state("search-bulksheets",{url:"/search/bulksheets",templateUrl:"components/shared/html/just-loading.html",controller:"SearchBulksheetsController",controllerAs:"searchBulksheetsController"}).state("search-bid-rules",{url:"/search/bid-rules",templateUrl:"components/shared/html/just-loading.html",controller:"SearchBidRulesController",controllerAs:"searchBidRulesController"}).state("search-advanced",{url:"/search/advanced",templateUrl:"components/shared/html/just-loading.html",controller:"SearchAdvancedController",controllerAs:"searchAdvancedController"}).state("search-products",{url:"/search/products",templateUrl:"components/shared/html/just-loading.html",controller:"SearchProductsController",controllerAs:"searchProductsController"}).state("social-advanced",{url:"/social/advanced",templateUrl:"components/shared/html/just-loading.html",controller:"SocialAdvancedController",controllerAs:"socialAdvancedController"}).state("social-audience",{url:"/social/audience",templateUrl:"components/shared/html/just-loading.html",controller:"SocialAudienceController",controllerAs:"socialAudienceController"}).state("social-bulksheets",{url:"/social/bulksheets",templateUrl:"components/shared/html/just-loading.html",controller:"SocialBulksheetsController",controllerAs:"socialBulksheetsController"}).state("social-facebook",{url:"/social/facebook",templateUrl:"components/shared/html/just-loading.html",controller:"SocialFacebookController",controllerAs:"socialFacebookController"}).state("social-creative-assets",{url:"/social/creative-assets",templateUrl:"components/shared/html/just-loading.html",controller:"SocialCreativeAssetsController",controllerAs:"socialCreativeAssetsController"}).state("reports-home",{url:"/reports/home",templateUrl:"components/shared/html/just-loading.html",controller:"ReportsHomeController",controllerAs:"reportsHomeController"}).state("reports-spreadsheet-feeds",{url:"/reports/spreadsheet-feeds",templateUrl:"components/shared/html/just-loading.html",controller:"ReportsSpreadsheetFeedsController",controllerAs:"reportsSpreadsheetFeedsController"}).state("reports-change-history",{url:"/reports/change-history",templateUrl:"components/shared/html/just-loading.html",controller:"ReportsChangeHistoryController",controllerAs:"reportsChangeHistoryController"}).state("tools-conversion-tags",{url:"/tools/conversion-tags",templateUrl:"components/shared/html/just-loading.html",controller:"ToolsConversionTagsController",controllerAs:"toolsConversionTagsController"}).state("tools-tracking-urls",{url:"/tools/tracking-urls",templateUrl:"components/shared/html/just-loading.html",controller:"ToolsTrackingUrlsController",controllerAs:"toolsTrackingUrlsController"}).state("tools-decode-tracking-urls",{url:"/tools/decode-tracking-urls",templateUrl:"components/shared/html/just-loading.html",controller:"ToolsDecodeTrackingUrlsController",controllerAs:"toolsDecodeTrackingUrlsController"}).state("tools-change-password",{url:"/tools/change-password",templateUrl:"components/shared/html/just-loading.html",controller:"ToolsChangePasswordController",controllerAs:"toolsChangePasswordController"}).state("tools-adwords-conversion-tags",{url:"/tools/adwords-conversion-tags",templateUrl:"components/shared/html/just-loading.html",controller:"ToolsAdwordsConversionTagsController",controllerAs:"toolsAdwordsConversionTagsController"}).state("admin-manage-client",{url:"/admin/manage-client",templateUrl:"components/shared/html/just-loading.html",controller:"AdminManageClientController",controllerAs:"adminManageClientController"}).state("admin-manage-agency",{url:"/admin/manage-agency",templateUrl:"components/shared/html/just-loading.html",controller:"AdminManageAgencyController",controllerAs:"adminManageAgencyController"}).state("admin-manage-roles",{url:"/admin/manage-roles",templateUrl:"components/shared/html/just-loading.html",controller:"AdminManageRolesController",controllerAs:"adminManageRolesController"}).state("admin-manage-login",{url:"/admin/manage-login",templateUrl:"components/shared/html/just-loading.html",controller:"AdminManageLoginController",controllerAs:"adminManageLoginController"}).state("admin-transaction-properties",{url:"/admin/transaction-properties",templateUrl:"components/shared/html/just-loading.html",controller:"AdminTransactionPropertiesController",controllerAs:"adminTransactionPropertiesController"}).state("admin-ui-monitor",{url:"/admin/ui-monitor",templateUrl:"components/shared/html/just-loading.html",controller:"AdminUiMonitorController",controllerAs:"adminUiMonitorController"}).state("admin-access-token",{url:"/admin/access-token",templateUrl:"components/shared/html/just-loading.html",controller:"AdminAccessTokenController",controllerAs:"adminAccessTokenController"}),t.otherwise("/")}angular.module("amoApp",["ui.router","ngCoral","amoController","amoHomeControllers","amoPortfoliosControllers","amoSearchControllers","amoDisplayRouting","amoSocialControllers","amoReportsControllers","amoToolsControllers","amoAdminControllers"]).config(e),e.$inject=["$stateProvider","$urlRouterProvider"]}(),function(){function e(e,t,r,a,n){function i(){t.$emit("$messageOutgoing",angular.toJson({Message:"closeNewDisplay"}))}function o(){return window!==window.parent}function s(){m.userId++}function l(e){m.outerRail=e,m.navigationView=new CUI.NavigationView({element:$('<div id="nav-view-id"></div>').appendTo(e.$element),jsonData:m.menuData})}function c(e){e.setTitle(r.defaultBlackBarTitle);var t=e.$element;m.jQueryBackButton=t.find(".endor-BlackBar-back.js-endor-BlackBar-back"),m.jQueryBackButton.off(),m.jQueryBackButton.bind("click",function(){var e=""+document.location,t=e.indexOf("?");-1==t&&(t=e.length);var r=e.substr(0,t);"http://localhost:3000/amo/#/"==r||"http://localhost:3000/amo/#/display"==r?m.closeNewDisplay():window.history.back()})}function u(t,r){var i=angular.fromJson(r);i.userInfo&&(n.debug("Got user info from GWT."),m.userId=a.userId(i.userInfo.userId),m.webUserId=a.webUserId(i.userInfo.webUserId),$("#nav-view-id").remove(),m.outerRail.$element.remove("nav-view-id"),m.menuData=jQuery.extend(!0,{},d()),m.navigationView=new CUI.NavigationView({element:$('<div id="nav-view-id"></div>').appendTo(m.outerRail.$element),jsonData:m.menuData}),n.debug("Navigating to Campaign Grid by default."),e.go("display"))}function d(){return{name:"main",children:[{name:"Home",children:[{name:"Overview",url:e.href("home-overview")},{name:"Alerts",url:e.href("home-alerts")}]},{name:"Portfolios",children:[{name:"Portfolios Home",url:e.href("portfolios-home")},{name:"Portfolio Cards",url:e.href("portfolios-cards")},{name:"Objectives",url:e.href("portfolios-objectives")},{name:"Spend Recommendation",url:e.href("portfolios-spend-recommendation")}]},{name:"Search",children:[{name:"Search Engines",url:e.href("search-engines")},{name:"Bulksheets",url:e.href("search-bulksheets")},{name:"Bid Rules",url:e.href("search-bid-rules")},{name:"Advanced",url:e.href("search-advanced")},{name:"Products",url:e.href("search-products")}]},{name:"Display",children:[{name:"Managed Campaigns",url:e.href("display")},{name:"Tracking Campaigns",url:e.href("display-tracking-campaigns")},{name:"Creative Library",url:e.href("display-creative")},{name:"Product Library",url:e.href("display-product-libraries")},{name:"Audience",url:e.href("display-audiences")}]},{name:"Social",children:[{name:"Facebook",url:e.href("social-facebook")},{name:"Bulksheets",url:e.href("social-bulksheets")},{name:"Creative Assets",url:e.href("social-creative-assets")},{name:"Audience",url:e.href("social-audience")},{name:"Advanced",url:e.href("social-advanced")}]},{name:"Reports",children:[{name:"Reports Home",url:e.href("reports-home")},{name:"Spreadsheet Feeds",url:e.href("reports-spreadsheet-feeds")},{name:"Change History",url:e.href("reports-change-history")}]},{name:"Tools",children:[{name:"Conversion Tags",url:e.href("tools-conversion-tags")},{name:"Tracking URLs",url:e.href("tools-tracking-urls")},{name:"Decode Tracking URLs",url:e.href("tools-decode-tracking-urls")},{name:"Change Password",url:e.href("tools-change-password")},{name:"AdWords Conversion Tags",url:e.href("tools-adwords-conversion-tags")}]},{name:"Admin",children:[{name:"Manage Client",url:e.href("admin-manage-client")},{name:"Manage Agency",url:e.href("admin-manage-agency")},{name:"Manage Roles",url:e.href("admin-manage-roles")},{name:"Manage Login",url:e.href("admin-manage-login")},{name:"Transaction Properties",url:e.href("admin-transaction-properties")},{name:"UI Monitor",url:e.href("admin-ui-monitor")},{name:"Access Token",url:e.href("admin-access-token")}]}]}}var m=this;m.Shell=r,m.loadFrame=!0,m.incrementUserId=s,m.title="Adobe Media Optimizer",m.isInFrame=o,m.closeNewDisplay=i,m.onOuterRailResolved=l,m.userId=0,m.webUserId=0,m.menuData=jQuery.extend(!0,{},d()),m.onOuterRailResolved=l,r.resolveOuterRail(l),r.resolveBlackBar(c),r.defaultBlackBarTitle="Display",o()||(n.debug("Running outside of iframe. Setting default test user."),m.userId=a.userId(1180),a.webUserId(29)),t.$on("$messageIncoming",u)}angular.module("amoController",["ui.router","ngPostMessage","amoShellService","amoUserInfoService"]).controller("AMOCtrl",e),e.$inject=["$state","$scope","Shell","userInfoService","$log"]}(),function(){function e(e){e.selectSubModule("Admin|Manage Client")}function t(e){e.selectSubModule("Admin|Manage Agency")}function r(e){e.selectSubModule("Admin|Manage Roles")}function a(e){e.selectSubModule("Admin|Manage Login")}function n(e){e.selectSubModule("Admin|Transaction Properties")}function i(e){e.selectSubModule("Admin|UI Monitor")}function o(e){e.selectSubModule("Admin|Access Token")}angular.module("amoAdminControllers",["amoGwtInterfaceService"]).controller("AdminManageClientController",e).controller("AdminManageAgencyController",t).controller("AdminManageRolesController",r).controller("AdminManageLoginController",a).controller("AdminTransactionPropertiesController",n).controller("AdminUiMonitorController",i).controller("AdminAccessTokenController",o),e.$inject=["gwtInterfaceService"],t.$inject=["gwtInterfaceService"],r.$inject=["gwtInterfaceService"],a.$inject=["gwtInterfaceService"],n.$inject=["gwtInterfaceService"],i.$inject=["gwtInterfaceService"],o.$inject=["gwtInterfaceService"]}(),function(){"use strict";function e(e,t,r,a,n,i,o,s,l,c,u){function d(e){return D.createNewPopover=!1,D.campaignActionsState=!1,e.action()}function m(){D.campaignActionsState=!D.campaignActionsState}function g(e){return function(t,r){var a=r&&r.range||void 0;n.query(function(t){var n={x:[],y:[],series:[]},c=[];D.metrics[e].forEach(function(e){if(e.selected){var r="percent"!=e.format?i:o;a?t.reduce(r(e.id,a[0],a[1]),[]).forEach(s(n,e.name,l(a[0]))):t.reduce(r(e.id),[]).forEach(s(n,e.name,l())),c.push(e.format)}}),D.cvOptions[e].data=n,D.cvOptions[e].formats.y=c,D.cvOptions[e].dualYAxis=c.length>1,D.selectedDateRange[e]=r})}}function p(e){D.labelClickFunctionBuilder(e.id)()}function f(e){a.go("display-campaign",{campaignId:e.id})}function v(e,t){var r=angular.element(e.target).scope();D.columns[r.$index].width=t.size.width+"px"}function h(){return angular.toJson(D.campaignsDatasource.params)}function y(e,t){return function(r){var a=t||r.id,n=e?a:a+"Desc";D.campaignsDatasource.params.sort===n?delete D.campaignsDatasource.params.sort:D.campaignsDatasource.params.sort=n,delete D.campaignsDatasource.params.idsOnTop}}function C(){D.filters.length?D.campaignsDatasource.params.filters=c(D.filters):delete D.campaignsDatasource.params.filters,delete D.campaignsDatasource.params.idsOnTop}function S(e){return e.reduce(function(e,t){return e+t},0)}function b(e){return k[e]=k[e]||$,function(t){return angular.isDefined(t)&&(t||($=!1),k[e]=t),k[e]}}function A(e){if(angular.isDefined(e)){for(var t in k)k[t]=e;$=e}return $}function w(){var e=[];for(var t in k)k[t]&&e.push(t);n["delete"]({ids:e.join()},function(){D.campaignsDatasource.params.idsOnTop=e.join()})}function T(e){return function(){var t=[];for(var r in k)k[r]&&t.push(r);if(t.length)var a=0,i=n.query({ids:t.join()},function(){i.forEach(function(r){function n(){++a===i.length&&(D.campaignsDatasource.params.idsOnTop=t.join())}angular.extend(r,e),r.$save({campaignId:r.id},n)})})}}function I(e){D.filters.splice(e,1),C()}var D=this,k={},$=!1;D.showOnlyActiveOnLoad=a.params.idsOnTop?!1:!0,D.removeFilter=I,D.Shell=r,D.campaignsDatasource=t,D.campaignsDatasource.revision=h,D.selected=b,D.allSelected=A,D.sum=S,D.resizeColumnOptions={containment:"parent",stop:v},D.metrics=[[{id:"eCPM",name:"eCPM",selected:!1,format:"currency"},{id:"wins",name:"Wins",selected:!1,format:"percent"},{id:"cost",name:"Cost",selected:!0,format:"currency"},{id:"impressions",name:"Impressions",selected:!0,format:"decimal"},{id:"clicks",name:"Clicks",selected:!1,format:"decimal"}],[{id:"eCPM",name:"eCPM",selected:!0,format:"currency"},{id:"wins",name:"Wins",selected:!0,format:"percent"},{id:"cost",name:"Cost",selected:!0,format:"currency"},{id:"impressions",name:"Impressions",selected:!0,format:"decimal"},{id:"clicks",name:"Clicks",selected:!0,format:"decimal"}]],D.filter=C,D.filterOperators=u,D.filters=[],D.dateRangeOptions=[[{id:"today",name:"Today",action:g(0),range:[0,1]},{id:"yesterday",name:"Yesterday",action:g(0),range:[0,2]},{id:"2days",name:"2 days ago",action:g(0),range:[0,3]},{id:"7days",name:"Last 7 days",action:g(0),range:[0,7]},{id:"week",name:"Last week",action:g(0),range:[7,14]},{id:"campaign",name:"Campaign start to today",action:g(0)}],[{id:"weekly",name:"Weekly",action:g(1)}]],D.selectedDateRange=[],D.setupChart=g,D.viewCampaignStrategies=p,D.columns=[{id:"status",name:"Status",width:"20px",minWidth:"20px",maxWidth:"20px",format:{type:"status"},alignCenter:!0,contextMenu:[{name:"Sort Ascending",iconCls:"arrowUp",action:y(!0)},{name:"Sort Descending",iconCls:"arrowDown",action:y(!1)}]},{id:"campaignName",name:"Campaign",width:"60px",minWidth:"60px",flexGrow:5,alignLeft:!0,format:{type:"campaignUrl"},contextMenu:[{name:"Sort Ascending",iconCls:"arrowUp",action:y(!0)},{name:"Sort Descending",iconCls:"arrowDown",action:y(!1)}]},{id:"activeAds",name:"Active Ads",width:"30px",minWidth:"30px",maxWidth:"40px",format:{type:"integer"}},{id:"portfolioName",name:"Portfolio",width:"50px",minWidth:"50px",flexGrow:4,format:{type:"string"},alignLeft:!0},{id:"endDate",name:"End Date",width:"50px",minWidth:"50px",flexGrow:1,format:{type:"dateFilter",format:"shortDate"},alignCenter:!0,contextMenu:[{name:"Sort Ascending",iconCls:"arrowUp",action:y(!0)},{name:"Sort Descending",iconCls:"arrowDown",action:y(!1)}]},{id:"spark",name:"7 Day",width:"40px",minWidth:"40px",maxWidth:"60px",alignCenter:!0,flexGrow:1,format:{type:"sparkline"}},{id:"maxBudget",name:"Budget",width:"50px",minWidth:"50px",flexGrow:2,format:{type:"budget"},contextMenu:[{name:"Sort Ascending",iconCls:"arrowUp",action:y(!0,"budget")},{name:"Sort Descending",iconCls:"arrowDown",action:y(!1,"budget")},{name:"Add Filter",iconCls:"filterAdd",format:"filter",alias:"budget"}]},{id:"cost",name:"Cost",width:"50px",minWidth:"50px",flexGrow:2,format:{type:"currencySum"}},{id:"impressions",name:"Impressions",width:"65px",minWidth:"65px",flexGrow:3,format:{type:"integerSum"}},{id:"clicks",name:"Clicks",width:"30px",minWidth:"30px",flexGrow:3,format:{type:"integerSum"}},{id:"eCPM",name:"eCPM",width:"30px",minWidth:"30px",maxWidth:"70px",format:{type:"currency"}},{id:"cpc",name:"CPC",width:"30px",minWidth:"30px",maxWidth:"70px",format:{type:"currency"}},{id:"wins",name:"Win Rate",width:"30px",minWidth:"30px",maxWidth:"70px",format:{type:"percentage"}}],D.contextMenu=[{name:"Edit",iconCls:"edit",action:f},{name:"View Ads",iconCls:"viewOn",action:p}],D.cvOptions=[{dualYAxis:!0,autoResize:!0,interactive:!0,formats:{x:"time",y:[]}},{dualYAxis:!0,autoResize:!0,interactive:!0,formats:{x:"time",y:[]}}],D.dateRangeOptions.forEach(function(t,r){D.selectedDateRange[r]=t[t.length-1],D.setupChart(r)(null,D.selectedDateRange[r]),e.$watch(function(){return angular.toJson(D.metrics[r])},function(){D.setupChart(r)(null,D.selectedDateRange[r])})}),D.campaignActionItems=[{name:"Edit",iconCls:"edit",action:angular.noop},{name:"Activate",iconCls:"playCircle",action:new T({status:"active"})},{name:"Pause",iconCls:"pauseCircle",action:new T({status:"paused"})},{name:"Delete",iconCls:"delete",action:w},{name:"Report",iconCls:"revenue",action:angular.noop}],D.campaignActionsState=!1,D.executeMenuItem=d,angular.isDefined(a.params.idsOnTop)&&(D.campaignsDatasource.params.idsOnTop=a.params.idsOnTop),D.toggleActionsState=m,D.labelClickFunctionBuilder=function(e){return function(){a.go("display-ad-strategies-grid",{campaignIds:e})}},D.showOnlyActiveOnLoad&&(D.filters.push({property:"status",operator:"EQUALS",value:"active"}),D.filter())}angular.module("amoDisplayController",["amoCampaignService","amoCurrencyService","ui.router","amoCloudVizDirective","amoShellService","ui.scroll","ngDragDrop","amoResizableColumnHeaderDirective","amoGridFilters","amoPlaceValueFilter"]).controller("DisplayCtrl",e),e.$inject=["$scope","CampaignDataSource","Shell","$state","Campaign","byAccumulatingArrayProperty","byAveragingArrayProperty","pushAsDataPointIntoDataArray","turnIndexIntoDateByDaysAgo","gridFilterUrlParamFilter","gridFilterOperators"]}(),function(){"use strict";function e(e){e.state("display",{url:"/display?idsOnTop",templateUrl:"components/display/display.html",controller:"DisplayCtrl",controllerAs:"displayController"}).state("display-campaign",{url:"/display/campaign/:campaignId",templateUrl:"components/display/campaign-details/campaign-details.html",controller:"CampaignDetailController",controllerAs:"campaignDetails"}).state("display-ad-details",{url:"/display/ad?campaignId",templateUrl:"components/display/ad-details/ad-detail.html",controller:"AdDetailController",controllerAs:"adDetails"}).state("display-tracking-campaigns",{url:"/display/tracking-campaigns",templateUrl:"components/display/tracking-campaigns/tracking-campaigns.html",controller:"TrackingCampaignsController",controllerAs:"trackingCampaigns"}).state("display-audiences",{url:"/display/audiences",templateUrl:"components/display/audiences/audiences.html",controller:"AudiencesController",controllerAs:"audienceInfo"}).state("display-product-libraries",{url:"/display/product-libraries",templateUrl:"components/display/product-libraries/product-libraries.html",controller:"ProductLibrariesController",controllerAs:"productLibrariesController"}).state("display-creative",{url:"/display/creative/:creativeId",templateUrl:"components/display/creative/creative.html",controller:"CreativeController",controllerAs:"creativeInfo"}).state("display-ad-strategies-grid",{url:"/display/ad-strategies?campaignIds",templateUrl:"components/display/grids/ad-strategies/display-ad-strategies.html",controller:"DisplayAdStrategiesController",controllerAs:"adStrategyController"}).state("display-ad-theme-creatives-grid",{url:"/display-ad-strategies/creatives?adStrategyIds",templateUrl:"components/display/grids/ad-theme-creatives/display-ad-theme-creatives.html",controller:"DisplayAdThemeCreativesGridController",controllerAs:"displayAdThemeCreativeGridController"}).state("display-campaigns-grid",{url:"/display/campaigns-grid",templateUrl:"components/display/grids/java-report-service/campaign-grids/display-campaign-grid.html",controller:"DisplayCampaignGridController",controllerAs:"displayCampaignGridCtrl"})}angular.module("amoDisplayRouting",["amoDisplayController","ui.router","amoAdDetailController","amoTrackingCampaignsController","amoProductLibrariesController","amoAudiencesController","amoCreativeController","amoCampaignDetailController","amoDisplayAdStrategiesGridController","amoDisplayAdThemeCreativesGridController","amoDisplayCampaignGridController"]).config(e),e.$inject=["$stateProvider"]}(),function(){function e(e){e.selectSubModule("snapshot|Alerts")}function t(e){e.selectSubModule("snapshot|Overview")}angular.module("amoHomeControllers",["amoGwtInterfaceService"]).controller("AlertsController",e).controller("OverviewController",t),e.$inject=["gwtInterfaceService"],t.$inject=["gwtInterfaceService"]}(),function(){function e(e){e.selectSubModule("portfolio|Portfolios Home")}function t(e){e.selectSubModule("portfolio|Portfolio Cards<sup style=&quot;color:blue;font-size:8px;&quot;>Beta</sup>")}function r(e){e.selectSubModule("portfolio|Objectives")}function a(e){e.selectSubModule("portfolio|Spend Recommendation")}angular.module("amoPortfoliosControllers",["amoGwtInterfaceService"]).controller("PortfoliosHomeController",e).controller("PortfoliosCardsController",t).controller("PortfoliosObjectivesController",r).controller("PortfoliosSpendRecommendationController",a),e.$inject=["gwtInterfaceService"],t.$inject=["gwtInterfaceService"],r.$inject=["gwtInterfaceService"],a.$inject=["gwtInterfaceService"]}(),function(){function e(e){e.selectSubModule("Reports|Home")}function t(e){e.selectSubModule("Reports|Spreadsheet Feeds")}function r(e){e.selectSubModule("Reports|Change History")}angular.module("amoReportsControllers",["amoGwtInterfaceService"]).controller("ReportsHomeController",e).controller("ReportsSpreadsheetFeedsController",t).controller("ReportsChangeHistoryController",r),e.$inject=["gwtInterfaceService"],t.$inject=["gwtInterfaceService"],r.$inject=["gwtInterfaceService"]}(),function(){function e(e){e.selectSubModule("campaignManager|Search Engines")}function t(e){e.selectSubModule("campaignManager|Bulksheets")}function r(e){e.selectSubModule("campaignManager|Bid Rules")}function a(e){e.selectSubModule("campaignManager|Advanced")}function n(e){e.selectSubModule("campaignManager|Products")}angular.module("amoSearchControllers",["amoGwtInterfaceService"]).controller("SearchEnginesController",e).controller("SearchBulksheetsController",t).controller("SearchBidRulesController",r).controller("SearchAdvancedController",a).controller("SearchProductsController",n),e.$inject=["gwtInterfaceService"],t.$inject=["gwtInterfaceService"],r.$inject=["gwtInterfaceService"],a.$inject=["gwtInterfaceService"],n.$inject=["gwtInterfaceService"]}(),function(){"use strict";function e(e){e.selectSubModule("socialMediaManager|Facebook")}function t(e){e.selectSubModule("socialMediaManager|Bulksheets")}function r(e){e.selectSubModule("socialMediaManager|Creative Assets")}function a(e){e.selectSubModule("socialMediaManager|Audience")}function n(e){e.selectSubModule("socialMediaManager|Advanced (Beta)")}angular.module("amoSocialControllers",["amoGwtInterfaceService"]).controller("SocialFacebookController",e).controller("SocialBulksheetsController",t).controller("SocialCreativeAssetsController",r).controller("SocialAudienceController",a).controller("SocialAdvancedController",n),e.$inject=["gwtInterfaceService"],t.$inject=["gwtInterfaceService"],r.$inject=["gwtInterfaceService"],a.$inject=["gwtInterfaceService"],n.$inject=["gwtInterfaceService"]}(),function(){function e(e){e.selectSubModule("Tools|Conversion Tags")}function t(e){e.selectSubModule("Tools|Tracking URLs")}function r(e){e.selectSubModule("Tools|Decode Tracking URLs")}function a(e){e.selectSubModule("Tools|Change Password")}function n(e){e.selectSubModule("Tools|AdWords Conversion Tags")}angular.module("amoToolsControllers",["amoGwtInterfaceService"]).controller("ToolsConversionTagsController",e).controller("ToolsTrackingUrlsController",t).controller("ToolsDecodeTrackingUrlsController",r).controller("ToolsChangePasswordController",a).controller("ToolsAdwordsConversionTagsController",n),e.$inject=["gwtInterfaceService"],t.$inject=["gwtInterfaceService"],r.$inject=["gwtInterfaceService"],a.$inject=["gwtInterfaceService"],n.$inject=["gwtInterfaceService"]}(),function(){"use strict";function e(e,t,r,a,n,i,o,s,l,c,u,d,m,g,p){function f(e,t){e&&e.length>2&&n.query({searchQuery:e},t)}function v(e){var t=[],r=[];return Vt()||r.push(zt.name),_t()||r.push(Ht.name),T()||r.push(Wt.name),e&&e.length>2&&r.length>0&&(t=o.query({searchQuery:e,types:r.join()})),t}function h(e,t){switch(e.geoType){case"REGION":n.regionCities({id:e.id,pageSize:2e3},t);break;case"COUNTRY":n.countryRegions({id:e.id},t);break;case"COUNTRIES":n.countries({pageSize:400},t);break;case"METROS":n.metros({pageSize:400},t);break;case"ROOT":t([{id:-1,name:"Countries",geoType:"COUNTRIES",$$notSelectable:!0},{id:-2,name:"Metros",geoType:"METROS",$$notSelectable:!0}]);break;default:t()}}function y(e,t){e===er.languages?i.query(t):t()}function C(e){var t=[];return e&&e.length>2&&(t=s.query({search:e})),t}function S(e){er.showFbxPopover=e}function b(){er.toggleFbxPopover(!1),er.isFbxBudgetLocked=!0}function A(){er.showFbxPopover=!1,er.isFbxBudgetLocked=!1}function w(e,t){function r(t){return function(r){e.type===Wt.name&&0===e.id&&(r.push({type:zt.name,name:zt.name,$$notSelectable:!0}),r.push({type:Ht.name,name:Ht.name,$$notSelectable:!0})),t(r)}}function a(e){return function(t){t.forEach(function(e){switch(e.type){case zt.name:e.$$hide=Vt;break;case Ht.name:e.$$hide=_t;break;default:e.$$hide=T}}),e(t)}}"type"in e&&"id"in e&&0!==e.id?o.query({type:e.type,id:e.id},a(t)):o.query({type:e.type},r(a(t)))}function T(){return!(angular.isDefined(er.activeAdgroup)&&angular.isArray(er.activeAdgroup.adSources)&&er.activeAdgroup.adSources.some(function(e){return 9!=e&&4!=e}))}function I(e){return function(){return!Mt(e)}}function D(e,t){"ROOT"===e.type?s.get(function(e){e.forEach(function(e){e.$$notSelectable=!0}),t(e)}):"type"in e&&"id"in e?s.get({type:e.type,id:e.id},t):s.get({type:e.type},t)}function k(e,t){e===er.devices?l.query(t):t()}function x(e){var t=e?{name:"AND",value:!0}:{name:"AND NOT",value:!1};er.activeAdgroup.targets.segment.push({inclusion:t,items:[]})}function P(e){er.activeAdgroup.targets.segment.splice(e,1),er.activeAdgroup.targets.segment.length||x(er.segmentTargetingInclusionMode)}function F(){er.activeAdgroup.targets.segment=[],x(!0),er.segmentTargetingInclusionMode=!0}function R(){er.activeAdgroup.targets.segment=[],x(!1),er.segmentTargetingInclusionMode=!1}function E(e){er.activeIndex=e,er.activeAdgroup=er.adGroups[e],er.setAdStrategyTypeName(),er.isAdStrategyNew=angular.isUndefined(er.activeAdgroup.id),er.positionAdgroupPointer(),angular.forEach(er.activeAdgroup.adThemes,function(e){e.rotation=er.getRotationOption(e.rotationType),er.validateWeight(e.id),er.validateSequence(e.id)}),a.adGroupForm&&(er.activeAdgroup.$dirty?a.adGroupForm.$setDirty():a.adGroupForm.$setPristine()),er.estimatedReach&&(er.setEstimatedReach(Math.random()*er.estimatedReach.populationSize),er.updateSuggestedBidRange())}function O(){er.adGroups.push(B()),E(er.adGroups.length-1),a.adGroupForm&&a.adGroupForm.$setPristine()}function M(e){var t=er.adGroups[e],r=angular.copy(t);t.adStrategyName&&(r.adStrategyName="Copy of "+t.adStrategyName),r.id=void 0,er.adGroups.push(r)}function U(e){er.adGroups.splice(e,1),er.activeIndex===e?E(er.adGroups.length-1):er.activeIndex=er.activeIndex-1}function N(){er.adGroupPointerPosition={left:er.activeIndex*(Qt+Xt+Yt+Kt)+30+"px"}}function B(){return{$invalid:!0,$dirty:!1,adType:"RTB",frequencyCap:{timeFrequency:"per day"},adSources:Ot(),campaignId:er.campaign.id,status:"Active",sitesToInclude:"",sitesToExclude:"",bidAdjustments:[],targets:{geoTargets:{included:[],excluded:[]},languages:[],categoryTargets:{included:[],excluded:[]},siteTargets:{excluded:[],included:[]},devices:[],segment:[{inclusion:{name:"AND",value:!0},items:[]}]},labels:[],adThemes:[]}}function L(e){er.activeAdgroup.$invalidAdSources&&(e=!0),er.activeAdgroup.$invalid=e}function q(e){er.activeAdgroup.$dirty=e}function j(){er.availableCreativesFilter={search:"",size:{id:"all",name:"All Sizes"},creativeType:{id:"all",name:"All Types"}},er.availableCreativesAllSelected=!1,er.showBrowseCreativesModal=!0,er.getAvailableCreatives()}function G(){er.showNewImageCreativePopup=!0,er.addCreativesPopover=!1}function z(){er.showNewFlashCreativePopup=!0,er.addCreativesPopover=!1}function W(e){var t=0;return angular.forEach(angular.isDefined(e)&&e.adThemes||er.activeAdgroup.adThemes,function(e){t+=e.creatives.length}),t}function H(e){for(var t=0,r=0;r<e.creatives.length;r++)e.creatives[r].selected&&t++;return t}function V(e,t){t.selected=!0,e.stopPropagation(),er.selectedCreatives=_(),er.showCreativeDetailModal=!0,g.hideAll()}function _(){var e=[];return angular.forEach(er.activeAdgroup.adThemes,function(t){angular.forEach(t.creatives,function(r){if(r.selected){var a=r.creative;a.$$dimensionsLabel=t.name,e.push(a)}})}),e}function Q(){if(er.creativeDetailsLandingPage)for(var e=_(),t=0;t<e.length;t++)e[t].landingPage=er.creativeDetailsLandingPage;er.creativeDetailsLandingPage=null,er.showCreativeDetailModal=!1}function J(e){var t=H(e),r={"max-width":400,"max-height":200};return 1===t?r["max-height"]=300:r["max-width"]=Math.floor(400/t-5),r}function Y(){var e=[];return angular.forEach(er.activeAdgroup.adThemes,function(t){e=e.concat(t.creatives)}),e}function Z(){for(var e=Y(),t=0;t<e.length;t++)if(e[t].selected)return e[t].selected=!1,t===e.length-1?e[0].selected=!0:e[t+1].selected=!0,void(er.selectedCreatives=_())}function X(){for(var e=Y(),t=0;t<e.length;t++)if(e[t].selected)return e[t].selected=!1,0===t?e[e.length-1].selected=!0:e[t-1].selected=!0,void(er.selectedCreatives=_())}function K(e,t,r){var a=er.getAdTheme(t);a.creatives.splice(r,1),e.stopPropagation()}function et(e){e.isEditing=!0}function tt(e){e.isEditing=!1}function rt(e){er.estimatedReach.target=e}function at(){return er.estimatedReach.max-er.estimatedReach.min}function nt(){return er.estimatedReach.targetRatio=er.estimatedReach.max*er.estimatedReach.target/er.estimatedReach.populationSize,er.estimatedReach.targetRatio}function it(){var e=er.calculateTargetRatio()-30;return er.estimatedReach.targetRatio>er.estimatedReach.max-30?{"background-position":"90% 90%","text-align":"right",right:"0",left:""}:e<er.estimatedReach.min?{"background-position":"10% 90%","text-align":"left",right:"",left:"0"}:{"background-position":"50% 90%","text-align":"center",right:"",left:Math.round(e)+"px"}}function ot(){er.estimatedReach.minBid=1.75*Math.random(),er.estimatedReach.maxBid=2.1*Math.random()+1.75}function st(e){return er.activeAdgroup.budget?e>=er.activeAdgroup.budget.min:!0}function lt(e){var t=[];e.target.checked&&(t=er.adSources.map(function(e){return e.id.toString()})),er.activeAdgroup.adSources=t,Bt()}function ct(e,t){if(t.target.checked)Mt(e.id)||er.activeAdgroup.adSources.push(e.id.toString());else{var r=er.activeAdgroup.adSources.indexOf(e.id.toString());-1!=r&&er.activeAdgroup.adSources.splice(r,1)}Bt()}function ut(e){var t,r,a=0,n=er.getAdTheme(e),i=n.creatives;
if("WEIGHTED"===n.rotationType){for(t=0;t<i.length;t++)r=i[t],"weightNumber"in r&&null!==r.weightNumber&&(a+=parseInt(r.weightNumber));n.validWeight=100==a}}function dt(e){var t=er.getAdTheme(e),r=!0;return"WEIGHTED"!==t.rotationType?r:("validWeight"in t&&(r=t.validWeight),r)}function mt(e){var t=er.getAdTheme(e);if("SEQUENCE"!=t.rotationType)er.sequenceOptions[e]=[];else if(!(e in er.sequenceOptions)||er.sequenceOptions[e].length!=t.creatives.length){er.sequenceOptions[e]=[];for(var r=0;r<t.creatives.length;r++)er.sequenceOptions[e].push(r+1)}return er.sequenceOptions[e]}function gt(){pt(er.availableCreatives,!0,!0)}function pt(e,t,r){var n,i,o,s={};angular.forEach(e,function(e){("selected"in e&&e.selected||!t)&&(e.size.id in s||(s[e.size.id]=[]),s[e.size.id].push(angular.copy(e)))}),angular.forEach(s,function(e,t){n=er.getAdTheme(t),null===n&&(n={id:t,name:er.getAdSizeName(t),rotationType:"RANDOM",rotation:er.getRotationOption("RANDOM"),creatives:[]},er.activeAdgroup.adThemes.push(n)),o=n.creatives.length+e.length,i=Math.floor(100/o),angular.forEach(e,function(e){e.selected=!1,n.creatives.push({id:e.id,creative:e,weightNumber:i,sequenceNumber:n.creatives.length+1})})}),r&&a.$apply("adDetails.showBrowseCreativesModal = false")}function ft(e){for(var t="",r=0,a=er.sizeOptions.length;a>r;r++)if(er.sizeOptions[r].id==e){t=er.sizeOptions[r].name;break}return t}function vt(){var e={sort:"creationTimeDesc"};""!==er.availableCreativesFilter.search&&(e.filters="name:CONTAINS:"+er.availableCreativesFilter.search),"all"!=er.availableCreativesFilter.size.id&&(e.sizeIds=er.availableCreativesFilter.size.id),"all"!=er.availableCreativesFilter.creativeType.id&&(e.types=er.availableCreativesFilter.creativeType.id),er.availableCreatives=c.query(e)}function ht(){er.availableCreativesFilter.search="",er.getAvailableCreatives()}function yt(){for(var e=0;e<er.availableCreatives.length;e++)er.availableCreatives[e].selected=er.availableCreativesAllSelected}function Ct(){if(er.labelSearchField){for(var e=er.labelSearchField,t=0;t<er.activeAdgroup.labels.length;t++)if(er.activeAdgroup.labels[t]===e)return void(er.labelSearchField=null);er.activeAdgroup.labels.push(e),er.labelSearchField=null}}function St(e){er.activeAdgroup.labels.splice(e,1)}function bt(){u.go("display-ad-strategies-grid")}function At(){return er.activeAdgroup.bidAdjustments=[],$t(),angular.isFunction(er.activeAdgroup.$save)||(er.activeAdgroup=new m(er.activeAdgroup)),er.activeAdgroup.$save({id:er.activeAdgroup.id},bt),er.activeAdgroup}function wt(){var e=angular.copy(er.activeAdgroup.targets.geoTargets.included),t=angular.copy(er.activeAdgroup.targets.languages),r=angular.copy(er.activeAdgroup.targets.devices);angular.forEach(t,function(e){e.languageId=e.id,delete e.id}),angular.forEach(r,function(e){e.deviceId=e.id,delete e.id}),e=e.concat(t,angular.copy(er.activeAdgroup.targets.categoryTargets.included),r);for(var a=0;a<e.length;a++)e[a].bidAdjustment||(e[a].bidAdjustment=0);er.activeAdgroup.bidAdjustments=e}function Tt(){er.showAdvancedTargeting=!er.showAdvancedTargeting,er.showAdvancedTargeting&&(wt(),g.hideAll())}function It(e,t){for(var r=0;r<e.length;r++)if(e[r].sizeId===t)return!0;return!1}function Dt(e){angular.forEach(er.activeAdgroup.adThemes,function(t){var r={rtbSourceId:e.id,sizeId:t.id};It(e.bidOverrides,t.id)||e.bidOverrides.push(r)})}function kt(e){var t=null;if(!("bidOverrides"in er.activeAdgroup))return t;for(var r=0;r<er.activeAdgroup.bidOverrides.length;r++)if(er.activeAdgroup.bidOverrides[r].id==e){t=er.activeAdgroup.bidOverrides[r];break}return t}function $t(){var e,t=[];angular.forEach(er.activeAdgroup.adSources,function(r){e=kt(r),null===e&&(e={id:r,name:Ut(r),bidOverrides:[]}),Dt(e),t.push(e)}),er.activeAdgroup.bidOverrides=t}function xt(){er.showAdvancedCreatives=!er.showAdvancedCreatives,er.showAdvancedCreatives&&($t(),g.hideAll())}function Pt(e){return"FLASH"===e.creativeType?er.flashWidth:e.size.width}function Ft(e){er.activeAdgroup.targets=e.targets,er.activeAdgroup.sitesToInclude=e.sitesToInclude,er.activeAdgroup.sitesToExclude=e.sitesToExclude}function Rt(e){e.rotationType=e.rotation.id}function Et(e){for(var t=null,r=0;r<er.activeAdgroup.adThemes.length;r++)if(er.activeAdgroup.adThemes[r].id==e){t=er.activeAdgroup.adThemes[r];break}return t}function Ot(){var e=[];return 0===er.adSources.length?["1","2","3","4","5","6","7","8","10"]:e=er.adSources.map(function(e){return e.id.toString()})}function Mt(e){var t=!1,r=e.toString();if(!("adSources"in er.activeAdgroup))return t;for(var a=0;a<er.activeAdgroup.adSources.length;a++)if(er.activeAdgroup.adSources[a]==r){t=!0;break}return t}function Ut(e){for(var t=e.toString(),r="",a=0;a<er.adSources.length;a++)if(er.adSources[a].id==t){r=er.adSources[a].name;break}return r}function Nt(){er.adStrategyTypeName=er.adStrategyTypeNames[er.activeAdgroup.adType]}function Bt(){er.activeAdgroup.$dirty=!0,"RTB"==er.activeAdgroup.adType&&er.activeAdgroup.adSources.length<1?(er.activeAdgroup.$invalidAdSources=!0,er.activeAdgroup.$invalid=!0):(er.activeAdgroup.$invalidAdSources=!1,a.adGroupForm.$invalid||(er.activeAdgroup.$invalid=!1))}function Lt(){er.setAdStrategyTypeName(),Bt()}function qt(e){for(var t,r=0;r<er.rotationOptions.length;r++)if(er.rotationOptions[r].id==e){t=er.rotationOptions[r];break}return t}function jt(e){var t=er.getAdTheme(e),r=!0,a={};"SEQUENCE"===t.rotationType&&($.each(t.creatives,function(e,t){return"sequenceNumber"in t&&t.sequenceNumber?t.sequenceNumber in a?(r=!1,!1):void(a[t.sequenceNumber]=!0):(r=!1,!1)}),t.validSequence=r)}function Gt(e){var t=er.getAdTheme(e),r=!0;return"SEQUENCE"!==t.rotationType?r:("validSequence"in t&&(r=t.validSequence),r)}var zt={name:"FBX",id:9},Wt={name:"IAB"},Ht={name:"Microsoft",id:4},Vt=new I(zt.id),_t=new I(Ht.id),Qt=200,Jt=10,Yt=10,Zt=10,Xt=40,Kt=5,er=this;er.currencySymbols={},er.currencies=r.get(function(e){e.items.forEach(function(e){er.currencySymbols[e.code]=e.symbol})}),er.campaign=e.get(t),er.adSources=d.get(),er.adGroups=m.query({campaignId:null,campaignIds:t.campaignId,includeAdThemes:!0},function(e){e.length<1?er.addNewAdgroup():E(0)}),er.adGroupStyles={width:Qt,marginRight:Kt,padding:Jt+"px "+Yt+"px "+Zt+"px "+Xt+"px"},er.activeIndex=0,er.activeAdgroup={},er.selectedCreatives=[],er.creativesGroupBy="size",er.creativesViewRow=!0,er.selectAllSourcesCheckbox=!1,er.showBrowseCreativesModal=!1,er.availableCreatives=[],er.availableCreativesAllSelected=!1,er.showAdvancedTargeting=!1,er.showAdvancedCreatives=!1,er.showBrowseTargetingPopup=!1,er.adStrategyTypeName="None",er.isAdStrategyNew=!1,er.flashWidth=300,er.selectAdgroup=E,er.addNewAdgroup=O,er.copyAdgroup=M,er.deleteAdgroup=U,er.positionAdgroupPointer=N,er.browseCreatives=j,er.getCreativesCount=W,er.previewCreatives=V,er.deleteCreative=K,er.editCreativeInGrid=et,er.finishCreativeInGridEdit=tt,er.validateGreaterThan=st,er.toggleAllSources=lt,er.selectSourceCheckbox=ct,er.calculateTargetRatio=nt,er.getEstimatedReachRange=at,er.setEstimatedReach=rt,er.updateSuggestedBidRange=ot,er.estimatedReachTargetPosition=it,er.validateWeight=ut,er.hasValidWeight=dt,er.getSelectedCount=H,er.calculateCreativeImageStyle=J,er.updateLandingPageUrlForSelected=Q,er.moveToNextCreative=Z,er.moveToPreviousCreative=X,er.getSequenceOptions=mt,er.validateSequence=jt,er.hasValidSequence=Gt,er.getAvailableCreatives=vt,er.selectCreatives=pt,er.doSelectCreatives=gt,er.onClearSearchClick=ht,er.selectAllAvailableCreatives=yt,er.addNewLabel=Ct,er.removeLabel=St,er.cancelForm=bt,er.saveForm=At,er.toggleAdvancedTargetingPopover=Tt,er.toggleAdvancedCreativesPopover=xt,er.getCreativeWidth=Pt,er.onBrowseTargetingCallback=Ft,er.setRotationType=Rt,er.getAdTheme=Et,er.isAdSourceSelected=Mt,er.setAdStrategyTypeName=Nt,er.onAdStrategyTypeChange=Lt,er.getRotationOption=qt,er.getAdSizeName=ft,er.segmentTargetingInclusionMode=!0,er.createNewSegmentGroup=function(){x(!0)},er.removeSegmentGroup=P,er.segmentInclude=F,er.segmentExclude=R,a.$watch("adGroupForm.$invalid",L),a.$watch("adGroupForm.$dirty",q),er.addCreativesMenuItems=[{name:"Image",action:G},{name:"Flash",action:z}],er.timeFrequencies=["per day"],er.status=["Active","Paused"],er.statusOptions=[{id:"all",name:"All Statuses"},{id:"a",name:"Active"},{id:"p",name:"Paused"}],er.rotationOptions=[{id:"RANDOM",name:"Random"},{id:"SEQUENCE",name:"Sequence"},{id:"WEIGHTED",name:"Weighted"}],er.sequenceOptions={},er.sizeOptions=p.query(function(e){angular.forEach(e,function(e){e.name=e.width+" x "+e.height}),e.unshift({id:"all",name:"All Sizes"})}),er.creativeTypeOptions=[{id:"all",name:"All Types"},{id:"IMAGE",name:"Image"},{id:"FLASH",name:"Flash"},{id:"THIRD_PARTY",name:"3rd Party"}],er.showFbxPopover=!1,er.isFbxBudgetLocked=!0,er.showFbxOptions=!1,er.fbxBudget=1e3,er.fbxAccounts=["AdobeTest","AdobeTest2"],er.toggleFbxPopover=S,er.lockFbxBudget=b,er.handleFbxSubmit=A,er.estimatedReach={min:0,max:253,target:975e5,minBid:1.75,maxBid:2.1,populationSize:3e8,notation:1e6},er.locations={geoType:"ROOT",id:0,name:"root"},er.geoSearch=f,er.favoriteLocations=[],er.getLocationChildren=h,er.locationOptions={headers:{height:"35px",columnData:[{name:"LOCATION"},{name:"OPTIONS"}]},body:{height:"300px",maxColumns:3}},er.languages={name:"root"},er.favoriteLanguages=[],er.languageOptions={headers:{height:"35px",columnData:[{name:"LANGUAGE"}]},body:{height:"300px"}},er.getLanguageChildren=y,er.categories={id:0,type:Wt.name,name:Wt.name,$$notSelectable:!0},er.favoriteCategories=[],er.getCategoryChildren=w,er.categorySearch=v,er.categoryOptions={headers:{height:"35px",columnData:[{name:"CATEGORY"},{name:"OPTIONS"}]},body:{height:"300px"}},er.segments={id:0,name:"root segment",type:"ROOT"},er.getSegmentChildren=D,er.segmentSearch=C,er.segmentOptions={headers:{height:"35px",columnData:[{name:"SEGMENT"},{name:"OPTIONS"},{name:""}]},body:{height:"300px"}},er.browseCreativesModalButtons=[{label:"Cancel",className:"coral-Button coral-Button--quiet",click:"hide"},{label:"Select",className:"coral-Button coral-Button--primary",click:er.doSelectCreatives}],er.availableCreativesFilter={search:"",size:{id:"all",name:"All Sizes"},creativeType:{id:"all",name:"All Types"}},er.devices={name:"root"},er.favoriteDevices=[],er.deviceOptions={headers:{height:"35px",columnData:[{name:"DEVICE"}]},body:{height:"300px"}},er.getDeviceChildren=k,er.adStrategyTypeNames={RTB:"RTB",FBX:"FBX",RTB_DIRECT:"RTB (Direct)"},er.rtbDirectSources={adX:"",casale:""}}angular.module("amoAdDetailController",["ngCoral","amoQuietFormDirective","amoCampaignService","amoCurrencyService","ui.router","amoRtbSourceService","amoAdStrategyService","ui.keypress","ui.validate","amoMillerColumnDirective","amoMillerColumnExpressionDirective","amoOverflowScrollDirective","amoSetFocusDirective","amoGeodataService","amoLanguageService","amoCategoryService","amoSegmentService","amoDeviceService","amoMultipleFilter","ngAnimate","amoCreativesService","amoBrowseTargetingDirective","amoAdSizeService","amoSiteTargetingDirective","amoPopoverWrapperDirective"]).controller("AdDetailController",e),e.$inject=["Campaign","$stateParams","Currency","$scope","Geodata","Language","Category","Segment","Device","Creatives","$state","RtbSource","AdStrategy","QuietFormService","AdSize"]}(),function(){function e(){function e(){function e(e,t){e.bind("scroll",function(){t.scrollTop(e.scrollTop())})}var t=angular.element("#amoad-siteTargeting-includedSites"),r=angular.element("#amoad-siteTargeting-includedSitesOverlay");e(t,r);var a=angular.element("#amoad-siteTargeting-excludedSites"),n=angular.element("#amoad-siteTargeting-excludedSitesOverlay");e(a,n)}function t(e,t){function r(){this.value=null,this.parsed=[],this.validated=[],this.count=0,this.errorCount=0}var a=this;a.includedSites=new r,a.excludedSites=new r,t.$watch(function(){return a.targets},function(e){e&&(e.siteTargets&&(a.includedSites.value=e.siteTargets.included.join("\n"),a.excludedSites.value=e.siteTargets.excluded.join("\n"),a.includedSites.onValueChanged(),a.excludedSites.onValueChanged()),e.siteTargets={included:a.includedSites.validated,excluded:a.excludedSites.validated})}),r.prototype.reset=function(){this.value=null,this.parsed=[],this.validated=[],this.count=0,this.errorCount=0},r.prototype.onValueChanged=function(){this.parsed.length=0,this.validated.length=0,this.errorCount=0;for(var t=this.value.split("\n"),r=0;r<t.length;r++){var a=t[r],n={value:a};e.isValid(a)?this.validated.push(a):(n.$$urlValidationError=!0,this.errorCount++),this.parsed.push(n)}this.count=this.parsed.length,1!==this.parsed.length||this.parsed[0].value||this.reset()}}return{restrict:"E",templateUrl:"components/display/ad-details/siteTargetingDirective.html",controllerAs:"vm",bindToController:!0,controller:["AmoUrlService","$scope",t],link:e,scope:{targets:"="}}}angular.module("amoSiteTargetingDirective",["amoUrlService"]).directive("amoSiteTargeting",e)}(),function(){function e(e){function t(t){o.segments=t||e.get({type:o.type})}function r(t){t&&t.length>3&&e.get({search:t},o.populateSegments),t.length<o.queryLength&&3===t.length?o.populateSegments():0===t.length&&o.populateSegments(),o.queryLength=t.length}function a(e){return $.inArray(e,o.rightAlignValues)>-1}function n(t,r){t.$$childrenLoaded||"folder"!==t.status||t.$$loading||(t.$$loading=!0,t.$$levels=t.$$levels||[],e.get({type:o.type,id:t.id},function(e){o.populateChildren(e,t,r)}))}function i(e,t,r){t.$$childrenLoaded=!0,t.$$loading=!1;var a=t.$$levels.concat([r+1]);angular.forEach(e,function(e){e.$$levels=a}),o.segments=o.segments.slice(0,r+1).concat(e).concat(o.segments.slice(r+1))}var o=this;o.segments=[],o.type="aam",o.queryValue="",o.queryLength=0,o.searchSegments=r,o.populateSegments=t,o.isRightAligned=a,o.loadChildren=n,o.populateChildren=i,o.gridColumns=[{name:"Segment Name",dataIndex:"name"},{name:"Description",dataIndex:"description"},{name:"Unique Visitors",dataIndex:"reach"}],o.rightAlignValues=["Unique Visitors"],o.populateSegments()}angular.module("amoAudiencesController",["amoSegmentService"]).controller("AudiencesController",e),e.$inject=["Segment"]}(),function(){"use strict";function e(e){e.clientConstructs={},e.clientConstructs.maxBudget={},e.clientConstructs.maxBudget.currencyOptions=[],e.clientConstructs.frequencyCap={},e.clientConstructs.frequencyCap.timeOptions=i,e.clientConstructs.frequencyCap.selectedTimeFrequency=i[0],e.clientConstructs.statusOptions=e.isNewCampaign?a:n,e.clientConstructs.selectedStatus=a[0]}function t(t,n,i,o,s,l,c){function u(){w.campaign.portfolioId=w.portfolio.id}function d(){w.campaign.$resolved&&w.portfolios.$resolved&&(w.portfolio=w.portfolios.reduce(function(e,t){return e||(t.id===w.campaign.portfolioId?t:null)},null))}function m(e){w.portfolios=s("orderBy")(e.items,"name"),w.portfolios.$resolved=!0,d()}function g(){w.campaign.$resolved?(w.startDate=f(w.campaign.startDate),w.endDate=f(w.campaign.endDate),w.clientConstructs.statusOptions.forEach(function(e){e.id===w.campaign.status&&(w.clientConstructs.selectedStatus=e)}),w.clientConstructs.frequencyCap.viewAmount=w.campaign.frequencyCap.viewAmount,w.clientConstructs.frequencyCap.timeOptions.forEach(function(e){e.id==w.campaign.frequencyCap.timeFrequency&&(w.clientConstructs.frequencyCap.selectedTimeFrequency=e)}),w.campaign.labels=w.campaign.labels||[],w.campaign.note=w.campaign.note||""):c.error("Unexpected error, campaign.$resolved is unresolved.",w),b(),d()}function p(e,t){return function(r){w.campaign[e]=t(r||w[e]),"endDate"===e&&""===w.campaign[e]&&(w.campaign[e]=null)}}function f(e){return e?s("date")(new Date(e),"M/d/y"):""}function v(){w.campaign.frequencyCap.viewAmount=w.clientConstructs.frequencyCap.viewAmount,delete w.campaign.adStrategies}function h(){function e(e){l.go("display",{idsOnTop:e.id})}v(),w.campaign.$save(e,C("We were unable to save your campaign."))}function y(){function e(){o.campaignId=w.campaign.id,l.go("display-ad-details",o)}v(),w.campaign.$save(e,C("We were unable to save your campaign."))}function C(e){return function(t){w.showServerErrors||(w.serverErrors=[]),t.statusText=e,w.serverErrors.push(t),w.showServerErrors||(w.showServerErrors=!0)}}function S(){w.currencies.$resolved?(w.currencies.items.forEach(function(e){var t={};t.id=e.id,t.name=e.code,t.symbol=e.symbol,w.clientConstructs.maxBudget.currencyOptions.push(t)}),w.isNewCampaign&&(w.currency=w.clientConstructs.maxBudget.currencyOptions[0],w.selectBudgetCurrency(),w.campaign.$resolved=!0),b()):c.error("Unexpected error, currencies.$resolved is unresolved.",w)}function b(){w.campaign.$resolved&&w.currencies.$resolved&&w.clientConstructs.maxBudget.currencyOptions.forEach(function(e){e.name===w.campaign.maxBudget.currency&&(w.clientConstructs.maxBudget.symbol=e.symbol)})}var A=new Date,w=this;w.isNewCampaign=""===o.campaignId,w.title=w.isNewCampaign?"Create New Campaign":"Edit Campaign",w.campaignServiceSuccess=g,w.resolveCurrencyValues=S,w.campaign=w.isNewCampaign?new i({status:a[0].id,startDate:A,insertionOrderId:0,endDate:null,portfolioId:null,note:"",adStrategies:[{status:"",labels:[""],trackingUrl:"",targets:{languages:[{name:"",id:0}],devices:[{name:"",id:0}],siteTargets:{excludedSites:[""],includedSites:[""]},segmentExpression:"",categoryTargets:{},geoTargets:[{geoType:"",cityId:0,countryId:0,metroId:0,regionId:0,name:""}]},campaignId:0,adStrategyName:"",adType:"",baseBid:0,frequencyCap:{viewAmount:0,timeFrequency:""},adSources:[""],maxBudget:0,minBudget:0,evenPacing:!1,id:0}],campaignName:"",labels:[],frequencyCap:{viewAmount:0,timeFrequency:"per_day"},maxBudget:{currency:"",budgetType:"daily",amount:void 0},evenPacing:!1,id:0}):i.get(g,C("We were unable to retrieve your campaign.")),w.startDate=f(A),w.endDate=w.campaign.endDate,w.portfolios=[],w.currencies=n.get(S,C("We were unable to retrieve your currencies.")),w.setStartDate=p("startDate",r),w.setEndDate=p("endDate",r),w.saveCampaign=h,w.saveAndCreateAds=y,w.selectPortfolio=u,w.currency={},w.serverErrors=[],w.showServerErrors=!1,t.get(m,C("We were unable to retrieve your portfolios.")),w.selectBudgetCurrency=function(){w.campaign.maxBudget.currency=w.currency.name,b()},w.selectStatus=function(){w.campaign.status=w.clientConstructs.selectedStatus.id},w.selectTimeFrequency=function(){w.campaign.frequencyCap.timeFrequency=w.clientConstructs.frequencyCap.selectedTimeFrequency.id},e(w)}function r(e){return e?new Date(e).toISOString():""}angular.module("amoCampaignDetailController",["ngCoral","amoPortfolioService","amoCurrencyService","amoCampaignService","amoQuietFormDirective","ui.router","amoOnOffFilter","amoBudgetFilter","amoCampaignDetailFilters","amoHttpStatusCodeFilter","amoGwtLoggerDecorator","amoLabelFieldDirective"]).controller("CampaignDetailController",t),t.$inject=["Portfolio","Currency","Campaign","$stateParams","$filter","$state","$log"];var a=[{id:"active",name:"Active"},{id:"paused",name:"Paused"}],n=[{id:"active",name:"Active"},{id:"paused",name:"Paused"},{id:"deleted",name:"Deleted"}],i=[{id:"per_day",name:"per day"}]}(),function(){"use strict";function e(){return function(e){return e.name}}function t(){return function(e){var t="Undefined";return e.timeOptions.forEach(function(r){r.id===e.selectedTimeFrequency.id&&(t=r.name)}),e.viewAmount+" "+t}}angular.module("amoCampaignDetailFilters",[]).filter("amoSelection",e).filter("frequencyCapSummary",t)}(),function(){"use strict";function e(e,t,r,a,n,i){function o(e){return _.createNewPopover=!1,_.creativeActionsState=!1,_.showBulkUploadMenu=!1,_.selectedCreatives=_.getSelection(),e.action()}function s(){_.createNewPopover=!_.createNewPopover}function l(){_.creativeFilterState=!_.creativeFilterState}function c(){_.creativeActionsState=!_.creativeActionsState}function u(e){e.selected=!1}function d(){for(var e=_.getFilterSelection(),t=0;t<e.length;t++)e[t].selected=!1}function m(){for(var e=0;e<_.creatives.length;e++)_.creatives[e].selected=_.selectAll}function g(){for(var e=!0,t=0;t<_.creatives.length;t++)if(!_.creatives[t].selected){e=!1;break}_.selectAll=e}function p(){return $.grep(_.creatives,function(e){return e.selected})}function f(e){for(var t=[],r=0;r<_.creativeFilters.length;r++){var a=_.creativeFilters[r];if((!e||e===a.type)&&a.items)for(var n=0;n<a.items.length;n++){var i=a.items[n];i.selected&&t.push(i)}}return t}function v(){for(var t=0;t<_.creativeFilters.length;t++){var r=_.creativeFilters[t];switch(r.type){case J:var a=f(J);a.length&&(_.filterQuery.sizeIds=h(a,"id"));break;case Q:var n=f(Q);n.length&&(_.filterQuery.types=h(n,"name"));break;case Y:var i=f(Y);i.length&&(_.filterQuery.labels=h(i,"name"));break;case Z:var o=f(Z);o.length&&(_.filterQuery.filters=h(o,"value"))}}_.creatives=e.query(_.filterQuery)}function h(e,t){return $.map(e,function(e){return e[t]}).join(",")}function y(){return[{name:"Labels",type:Y,showSearch:!0,items:_.countUnique("labels")},{name:"Creative Types",type:Q,items:_.countUnique("creativeType")},{name:"Size",type:J,items:_.countUnique("size")},{name:"Date Added",type:Z,subType:"dateRange",items:_.countDateAdded()},{name:"Advanced",type:Z,subType:"advancedSearch"}]}function C(e){for(var t={},r=[],a=$.map(_.creatives,function(t){return"size"===e?t.size.width+" x "+t.size.height+":"+t.size.id:t[e]}).sort(),n=0;n<a.length;n++)t[a[n]]=1+(t[a[n]]||0);for(var i in t)r.push("size"===e?{name:i.split(":")[0],total:t[i],id:i.split(":")[1]}:{name:i,total:t[i]});return r}function S(){for(var e=0,t=0,r=0,a=0,n=0,i=new Date,o=(new Date).setHours(0,0,0,0),s=new Date((new Date).setHours(0,0,0,0)).setDate(i.getDate()-1),l=(new Date).setDate(i.getDate()-i.getDay()),c=(new Date).setDate(i.getDate()-i.getDay()-7),u=0;u<_.creatives.length;u++){var d=_.creatives[u],m=new Date(d.creationTime);m.getTime()>o&&e++,m.getTime()>=s&&m.getTime()<o&&t++,m.getTime()>=l&&r++,m.getTime()<=l&&m.getTime()>=c&&a++,m.getMonth()===i.getMonth()&&m.getFullYear()===i.getFullYear()&&n++}return[{name:"Today",value:"creationTime:GREATER_OR_EQUAL:"+new Date(o).toISOString(),total:e},{name:"Yesterday",value:"creationTime:GREATER_OR_EQUAL:"+new Date(s).toISOString()+",creationTime:LESS_OR_EQUAL:"+new Date(o).toISOString(),total:t},{name:"This week",value:"creationTime:GREATER_OR_EQUAL:"+new Date(l).toISOString(),total:r},{name:"Last week",value:"creationTime:LESS_OR_EQUAL:"+new Date(l).toISOString()+",creationTime:GREATER_OR_EQUAL:"+new Date(c).toISOString(),total:a},{name:"This month",value:"creationTime:GREATER_OR_EQUAL:"+new Date(i.getFullYear(),i.getMonth()).toISOString(),total:n},{name:"Date range:",showDateRange:!0}]}function b(){_.showCreateNewImagePopup=!0}function A(){_.showCreateNewFlashPopup=!0}function w(){_.showCreateNewFBXPopup=!0}function T(){return"This function need to be implemented"}function I(e){_.statusBar.show=!0,_.statusBar.title="success",_.statusBar.message=e.length+" creative(s) uploaded successfully.",_.statusBar.type="success",_.creatives=e.concat(_.creatives),NProgress.done()}function D(t){_.statusBar.show=!0,_.statusBar.title="success",_.statusBar.message=t.length+" creative(s) updated successfully.",_.statusBar.type="success",_.selectAll=!1,_.creatives=e.query(_.filterQuery),NProgress.done()}function k(e){_.showPreview=!0,_.showEditCreativesPopup=!1,_.updatePreview(e)}function x(e,t){var r=_.getSelection().length?_.getSelection():_.creatives,a=r.indexOf(_.currentCreative),n=r.length-1;_.currentCreative="prev"===t?r[0===a?n:a-1]:"next"===t?r[a===n?0:a+1]:e}function P(e){37===e.keyCode&&x(null,"prev"),39===e.keyCode&&x(null,"next"),27===e.keyCode&&(_.showPreview=!1)}function F(){_.isPreviewInfoVisible=!_.isPreviewInfoVisible}function R(e){_.associatedAdsPopupStatusFilter=!0,_.currentCreative=e,_.showAssociatedAdsPopup=!0,_.getAssociatedAds(e)}function E(e){var r={creativeId:e.id};_.associatedAdsPopupStatusFilter&&(r.filters="status:EQUALS:active",r.filterType="ALL"),_.associatedAds=t.query(r,function(e){var t={},r={};angular.forEach(e,function(e){t[e.campaignName]=!0,r[e.adStrategyName]=!0}),_.associatedCampaignCount=Object.keys(t).length,_.associatedAdCount=Object.keys(r).length})}function O(){_.showBulkUploadMenu=!_.showBulkUploadMenu}function M(){_.showBulkUpload=!_.showBulkUpload,_.bulkUploadCreativeType="IMAGE"}function U(){_.showBulkUpload=!_.showBulkUpload,_.bulkUploadCreativeType="FLASH"}function N(e){if(e){for(var t=_.getSelection(),a=0;a<t.length;a++)t[a].selected=!1;_.selectAll=!1,e.selected=!0}_.showEditCreativesPopup=!0,r.hideAll()}function B(e){_.showDelete=!0,_.creativeToDelete=e}function L(){var e=_.getSelection();if(NProgress.configure({parent:"#creatives-toolbar"}),!e.length||_.creativeToDelete||_.showPreview)n["delete"]({ids:_.creativeToDelete.id},_.deleteSuccess,j),_.updatePreview(null,"next");else{var t=$.map(e,function(e){return e.id}).join(",");n["delete"]({ids:t},_.deleteSuccess,j)}NProgress.start()}function q(){_.statusBar.show=!0,_.statusBar.title="success",_.statusBar.message=(_.getSelection().length||"1")+" creative(s) deleted successfully.",_.statusBar.type="success",NProgress.done(),_.creatives=e.query(_.filterQuery)}function j(){_.statusBar.show=!0,_.statusBar.title="Error",_.statusBar.message="Unable to delete creative(s)",_.statusBar.type="error",NProgress.done()}function G(){_.assignLabelsVisible=!0}function z(){return _.filterQuery.sort}function W(e){_.filterQuery.sort=e}function H(t,r){var a="";if(_.filterQuery.sort){var n=_.filterQuery.sort.indexOf("Desc",_.filterQuery.sort.length-"Desc".length),i=-1!=n,o=i?_.filterQuery.sort.substring(0,n):_.filterQuery.sort;t.dataIndex===o&&(a=i?"":"Desc")}r&&(a="desc"===r?"Desc":""),_.setSorter(t.dataIndex+a),_.creatives=e.query(_.filterQuery)}function V(e){e.action&&e.action(e)}var _=this,Q="types",J="sizeIds",Y="labels",Z="search";_.filterQuery={sort:"creationTimeDesc"},_.creatives=e.query(_.filterQuery,function(e){_.creatives=e,_.creativeFilters=_.getCreativeFilters()}),_.offerTypes=a.query(),_.createNewPopover=!1,_.showCreateNewImagePopup=!1,_.showCreateNewFBXPopup=!1,_.showEditCreativesPopup=!1,_.showDelete=!1,_.executeMenuItem=o,_.toggleCreateNewPopoverState=s,_.toggleCreativeFilters=l,_.toggleActionsState=c,_.removeGridFilter=u,_.removeFilters=d,_.onNewCreativeFormSave=I,_.onEditCreativeFormSave=D,_.previewCreative=k,_.creativePreviewKeyup=P,_.showPreviewInfo=F,_.editCreatives=N,_.deleteCreative=L,_.deleteSuccess=q,_.showDeleteWarning=B,_.updatePreview=x,_.getFilterSelection=f,_.selectAllChange=m,_.selectRowChange=g,_.getSelection=p,_.getCreativeFilters=y,_.filtersChanged=v,_.countUnique=C,_.countDateAdded=S,_.showAssignLabels=G,_.getSorter=z,_.setSorter=W,_.sortColumn=H,_.headerClick=V,_.editCreativeForm={},_.currentCreative={},_.creativeFilters=[],_.statusBar={},_.creativeFilterState=!1,_.selectAll=!1,_.assignLabelsVisible=!1,_.createNewMenuItems=[{name:"Image",action:b},{name:"Flash",action:A},{name:"Third-Party",action:T},{name:"FBX",action:w},{name:"Product Retargeting",action:T}],_.creativeActionItems=[{name:"Edit",iconCls:"edit",action:N},{name:"Duplicate",iconCls:"copy",action:T},{name:"Delete",iconCls:"delete",action:B},{name:"Assign Labels",iconCls:"tag",action:G}],_.bulkUploadMenuItems=[{name:"Images",action:M},{name:"Flash",action:U}],_.gridColumns=[{name:"Creative Name",dataIndex:"name",action:H},{name:"Size",dataIndex:"size",action:H},{name:"Type",dataIndex:"creativeType",action:H},{name:"Created",dataIndex:"creationTime",action:H},{name:"Active Ads",dataIndex:"activeAds",action:H},{name:"Landing Page URL",dataIndex:"landingPage"},{name:"Offer Type",dataIndex:"offerType",action:H},{name:"Backup Landing Page",dataIndex:"backupLandingPage"}],_.associatedAdsPopupButtons=[{label:"Close",className:"coral-Button coral-Button--primary",click:"hide"}],_.contextMenu=[{name:"Edit",iconCls:"edit",action:N},{name:"Preview",iconCls:"viewOn",action:k},{name:"Associated Ads",iconCls:"link",action:R},{name:"Duplicate",iconCls:"copy"},{name:"Delete",iconCls:"delete",action:B}],_.showAssociatedAdsPopup=!1,_.associatedAdsPopupStatusFilter=!0,_.showAssociatedAds=R,_.getAssociatedAds=E,_.associatedAds=[],_.associatedCampaignCount=0,_.associatedAdCount=0,_.currentCreative=null,_.showBulkUpload=!1,_.bulkUploadCreativeType="IMAGE",_.showBulkCreativeUpload=M,_.showFlashBulkCreativeUpload=U,_.showBulkCreativeUploadMenu=O,_.showBulkUploadMenu=!1,i.$watchCollection("creativeInfo.getFilterSelection()",_.filtersChanged)}angular.module("amoCreativeController",["amoCreativesService","amoMultipleFilter","amoAccordionChecklistDirective","amoContextMenuDirective","amoAdStrategyService","amoFileSizeFilter","amoNewImageCreativeDirective","amoNewFlashCreativeDirective","amoNewFbxCreativeDirective","amoStatusBarDirective","angularFileUpload","amoEnvironmentConfiguration","angularFileUpload","amoBulkUploadDirective","amoQuietFormDirective","amoFlashPreviewDirective","amoOfferTypeService","amoCreativesDeleteService","amoBulkEditDirective","amoAssignLabelsDirective"]).controller("CreativeController",e),e.$inject=["Creatives","AdStrategy","QuietFormService","OfferType","CreativesDelete","$scope"]}(),function(){function e(e){e.selectSubModule("exchangeModule|Product Groups Manager")}angular.module("amoProductLibrariesController",["amoGwtInterfaceService"]).controller("ProductLibrariesController",e),e.$inject=["gwtInterfaceService"]}(),function(){angular.module("amoTrackingCampaignsController",["amoGwtInterfaceService"]).controller("TrackingCampaignsController",["gwtInterfaceService",function(e){e.selectSubModule("exchangeModule|Tracking Campaigns")}])}(),function(){"use strict";function e(){var e=function(e){function t(){var e=$.grep(i.filters,function(e){return"advancedSearch"===e.subType})[0],t=$.grep(i.filters,function(e){return"dateRange"===e.subType})[0];e.items||(e.items=[]),i.filterDateFrom&&i.filterDateTo?(t.items.unshift({name:i.getFilterDateText(),selected:!0,value:"creationTime:GREATER_OR_EQUAL:"+i.filterDateFrom.toISOString()+",creationTime:LESS_OR_EQUAL:"+i.filterDateTo.toISOString(),dateRange:!0}),i.filterDateFrom="",i.filterDateTo=""):(i.advancedFilterText||i.advancedFilterNumber)&&(e.items.push({name:i.advancedFilterType.name+":"+i.queryTextSelection.name+' "'+i.getFilterSearchText()+'"',value:i.advancedFilterType.value+":"+i.queryTextSelection.value+":"+i.getFilterSearchText(),selected:!0}),i.advancedFilterText="",i.advancedFilterNumber="")}function r(){var e=i.filters[i.filters.length-1];e.items&&e.items.length&&delete e.items}function a(){switch(i.advancedFilterType.dataType){case"text":return i.advancedFilterText;case"number":return i.advancedFilterNumber;case"list":return i.advancedFilterList}}function n(){return e("date")(i.filterDateFrom,"M/d/yy")+" - "+e("date")(i.filterDateTo,"M/d/yy")}var i=this;if(!i.filters)throw new Error('Mandatory attribute "filters" is missing.');i.advancedFilterText="",i.advancedFilterNumber="",i.advancedFilterList=[],i.addAdvancedFilter=t,i.clearAdvancedFilter=r,i.getFilterSearchText=a,i.getFilterDateText=n,i.queryTextOptions=[{name:"Contains",value:"CONTAINS"},{name:"Does not contain",value:"NOT_CONTAINS"},{name:"Begins with",value:"BEGINS_WITH"},{name:"Ends with",value:"ENDS_WITH"}],i.queryNumberOptions=[{name:"Equal to",value:"EQUAL"},{name:"Not equal to",value:"NOT_EQUAL"},{name:"Less than",value:"LESS_THAN"},{name:"Greater than",value:"GREATER_THAN"},{name:"Less than or equal to",value:"LESS_OR_EQUAL"},{name:"Greater than or equal to",value:"GREATER_OR_EQUAL"}],i.attributeOptions=[{name:"Creative Name",value:"creativeName",dataType:"text"},{name:"Landing Page URL",value:"landingPage",dataType:"text"}],i.queryTextSelection=i.queryTextOptions[0],i.queryNumberSelection=i.queryNumberOptions[0],i.advancedFilterType=i.attributeOptions[0]};return{restrict:"E",templateUrl:"components/shared/accordion-checklist-directive/accordion-checklist-directive.html",controllerAs:"filterInfo",bindToController:!0,controller:["$filter",e],scope:{state:"=",filters:"="}}}angular.module("amoAccordionChecklistDirective",[]).directive("accordionChecklist",e)}(),function(){"use strict";function e(e,t,r,a){return e(t+a.userId()+"/display-ad-sizes/",{},{query:{method:"GET",isArray:!0,transformResponse:[angular.fromJson,r],cache:!0}})
}angular.module("amoAdSizeService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("AdSize",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService"]}(),function(){function e(e,t,r,a,n,i,o,s){return e(t+i.userId()+"/display-ad-strategies/:id",s,{save:{method:"POST",transformRequest:[n,r.baseDataToServer,r.targetingToServer,r.segmentsToServer,r.geoTargetsToServer,angular.toJson]},get:{method:"GET",transformResponse:[o,r.singleItemTransform]},query:{method:"GET",transformResponse:[o,r.arrayTransform,a],isArray:!0}})}function t(e,t,r,a){function n(e){for(var t=e.items,r=0;r<t.length;r++)t[r]=i(t[r]);return t}function i(e){return e=s(e),e=u(e),e=f(e),e=g(e)}function o(t){var r,a=angular.copy(t);return t.adType=a.adType="RTB",a.status=e(t.status,"variable"),a.frequencyCap&&a.frequencyCap.viewAmount?(a.frequencyCap.timeFrequency||(a.frequencyCap.timeFrequency="Per Day"),a.frequencyCap.timeFrequency=e(a.frequencyCap.timeFrequency,"underscore")):delete a.frequencyCap,delete a.$invalid,delete a.$dirty,delete a.$invalidAdSources,angular.forEach(a.adThemes,function(e){delete e.rotation,"validWeight"in e&&delete e.validWeight,angular.forEach(e.creatives,function(e){r=e.creative,"selected"in r&&delete r.selected})}),a}function s(t){var r=angular.copy(t);return r.status=e(t.status),t.frequencyCap&&t.frequencyCap.viewAmount&&t.frequencyCap.timeFrequency&&(r.frequencyCap.timeFrequency=e(t.frequencyCap.timeFrequency)),r.$invalid=!1,r.$dirty=!1,angular.isArray(r.adThemes)||(r.adThemes=[]),r.labels=r.labels||[],r}function l(e){for(var t=angular.copy(e),r=0;r<t.bidAdjustments.length;r++){var a=t.bidAdjustments[r];a.bidAdjustment=a.bidAdjustment/100}for(r=0;r<t.bidOverrides.length;r++)for(var n=t.bidOverrides[r],i=0;i<n.bidOverrides.length;i++){var o=n.bidOverrides[i];o.bidOverride&&t.bidAdjustments.push(o)}return delete t.bidOverrides,angular.forEach(t.bidAdjustments,function(e){"geoType"in e&&delete e.geoType,"name"in e&&delete e.name,"countryCode"in e&&delete e.countryCode,"id"in e&&delete e.id}),angular.forEach(t.targets.geoTargets.included,c),angular.forEach(t.targets.languages,c),angular.forEach(t.targets.categoryTargets.included,c),angular.forEach(t.targets.devices,c),t}function c(e){"bidAdjustment"in e&&delete e.bidAdjustment}function u(e){var t=angular.copy(e),r=t.targets||{};return r.languages=r.languages||[],r.devices=r.devices||[],r.categoryTargets=r.categoryTargets||{},r.categoryTargets.excluded=r.categoryTargets.excluded||[],r.categoryTargets.included=r.categoryTargets.included||[],r.siteTargets=r.siteTargets||{included:[],excluded:[]},t.targets=r,t}function d(e){var t=angular.copy(e);if(t.targets&&t.targets.segment){var r=[];angular.forEach(t.targets.segment,m,r),"()"!==r.join("")&&(t.targets.segmentExpression=r.join(""))}var a=t.targets;return delete a.segment,t}function m(e){this.length>0?(this.push(" "),this.push(e.inclusion.name),this.push(" ")):e.inclusion.value||this.push("NOT "),this.push("(");for(var t=0;t<e.items.length;t++){var r=e.items[t];t>0&&this.push(" OR "),this.push(r.id)}this.push(")")}function g(e){var r=angular.copy(e);r.targets.segment=[];var a=r.targets.segmentExpression||"",n=a.split("AND");return angular.forEach(n,function(e){var a={inclusion:{},items:[]};e.indexOf("NOT")>-1?(a.inclusion.value=!1,a.inclusion.name="AND NOT"):(a.inclusion.value=!0,a.inclusion.name="AND");for(var n=e.match(/\d+/g),i=0;n&&i<n.length;i++){var o=n[i];a.items.push(t.lookup({ids:[o]}))}r.targets.segment.push(a)}),r}function p(e){var t=angular.copy(e);if(t.targets&&t.targets.geoTargets&&(t.targets.geoTargets.included.length||t.targets.geoTargets.excluded.length)){for(var r={metros:{included:[],excluded:[]},countries:{included:[],excluded:[]},cities:{included:[],excluded:[]},regions:{included:[],excluded:[]}},a=t.targets.geoTargets.included,n=t.targets.geoTargets.excluded,i=0;i<a.length;i++)delete a[i].id,"METRO"===a[i].geoType?r.metros.included.push(a[i]):"COUNTRY"===a[i].geoType&&r.countries.included.push(a[i]),"CITY"===a[i].geoType&&r.cities.included.push(a[i]),"REGION"===a[i].geoType&&r.regions.included.push(a[i]);for(i=0;i<n.length;i++)delete n[i].id,"METRO"===n[i].geoType?r.metros.excluded.push(n[i]):"COUNTRY"===n[i].geoType&&r.countries.excluded.push(n[i]),"CITY"===n[i].geoType&&r.cities.excluded.push(n[i]),"REGION"===n[i].geoType&&r.regions.excluded.push(n[i]);t.targets.geoTargets=r}else{var o=t.targets;delete o.geoTargets}return t}function f(e){var t=angular.copy(e),r=t.targets.geoTargets||{},n=[].concat(v(r,"metros","included"),v(r,"cities","included"),v(r,"countries","included"),v(r,"regions","included")),i=[].concat(v(r,"metros","excluded"),v(r,"cities","excluded"),v(r,"countries","excluded"),v(r,"regions","excluded"));return n=a(n),i=a(i),t.targets.geoTargets={included:n,excluded:i},t}function v(e,t,r){var a=[];return e[t]&&e[t][r]&&angular.forEach(e[t][r],function(e){a.push(e)}),a}return{arrayTransform:n,singleItemTransform:i,baseDataToServer:o,baseDataFromServer:s,targetingToServer:l,targetingFromServer:u,segmentsToServer:d,segmentsFromServer:g,geoTargetsToServer:p,geoTargetsFromServer:f}}function r(e,t){return e(t)}angular.module("amoAdStrategyService",["ngResource","amoEnvironmentConfiguration","ui.inflector","amoSegmentService","amoRtbSourceService","amoPagedResourceService","ui.router","amoUserInfoService","amoGeodataService"]).factory("AdStrategy",e).factory("AdStrategyTransforms",t).service("AdStrategyDataSource",r),e.$inject=["$resource","API_PATH","AdStrategyTransforms","fluff","unFluff","userInfoService","fromJsonOrPassThrough","$stateParams"],t.$inject=["inflectorFilter","Segment","RtbSource","GeodataTransform"],r.$inject=["DataSourceService","AdStrategy"]}(),function(){"use strict";function e(){function e(e,t,r){t.resizable(e.amoResizableColumnHeader),t.find(".ui-resizable-s").remove(),t.find(".ui-resizable-se").remove(),t.resizable("option","alsoResize",r.amoColumnHeaderAlsoResize)}return{scope:{amoResizableColumnHeader:"="},link:e}}angular.module("amoResizableColumnHeaderDirective",[]).directive("amoResizableColumnHeader",e)}(),function(){"use strict";function e(){var e=function(e){function t(){e.isSelectListVisible=!e.isSelectListVisible}function r(t){if(e.isSelectListVisible=!1,e.multiple){if(e.selection&&e.selection.length){for(var r=0;r<e.selection.length;r++)if(e.selection[r].id===t.id)return}else e.selection=[];e.selection.push(t)}else e.selection&&(e.selection.selected=!1),e.selection=t,e.selection.selected=!0}function a(t){e.selection.splice(t,1)}e.isSelectListVisible=!1,e.showSelectList=t,e.itemClick=r,e.removeSelected=a,e.change=e.changeHandler(),e.$watchCollection("selection",function(t){t&&e.form&&e.form[e.formFieldName]&&e.form[e.formFieldName].$setDirty()})},t=function(e){if(!e.options)throw new Error('Mandatory "options" attribute missing.')};return{restrict:"E",templateUrl:"components/shared/amo-select-directive/amo-select-directive.html",link:t,controller:["$scope",e],scope:{form:"=",options:"=",multiple:"=",selection:"=",placeholder:"@",changeHandler:"&change",formFieldName:"@"}}}angular.module("amoSelectDirective",[]).directive("amoSelect",e)}(),function(){"use strict";function e(){function e(e,t){if(!e.saveCallback||!angular.isFunction(e.saveCallback))throw new Error('Mandatory attribute "save-callback" is missing.');e.bodyEl=e.bodyEl||t.find(".coral-Modal-body").get(0),e.$watch("visible",function(t){NProgress.configure({parent:t?e.bodyEl:"body",showSpinner:!1})})}function t(e,t,r){function a(){t.query({},function(t){e.labels=$.map(t,function(e){return{name:e}})})}function n(){return e.labels.length?$.grep(e.labels,function(e){return e.selected}):[]}function i(){for(var e=n(),t=0;t<e.length;t++)delete e[t].selected}function o(){NProgress.start(),r.save({creativeIds:$.map(e.selection,function(e){return e.id}),labels:$.map(n(),function(e){return e.name})},s)}function s(){e.saveCallback(e.selection),a(),e.visible=!1}function l(){if(e.query){for(var t=0;t<e.labels.length;t++)if(e.labels[t].name===e.query)return e.labels[t].selected=!0,void(e.query="");e.labels.unshift({name:e.query,newLabel:!0,selected:!0}),e.query="",u()}}function c(t){if(t.preventDefault(),(9===t.keyCode||40===t.keyCode||38===t.keyCode)&&e.filteredLabels.length){var r=e.filteredLabels.indexOf(e.focusedLabel);delete e.focusedLabel.hasFocus,e.focusedLabel=e.filteredLabels[d(r,38===t.keyCode)],e.focusedLabel.hasFocus=!0}13===t.keyCode&&(e.focusedLabel&&e.focusedLabel.hasFocus&&e.filteredLabels.length?(e.focusedLabel.selected=!0,u(),e.query=""):l())}function u(){e.focusedLabel.hasFocus=!1,delete e.focusedLabel.hasFocus,e.focusedLabel={}}function d(t,r){var a=t===e.filteredLabels.length-1?0:t+1;return r&&(a=0===t?e.filteredLabels.length-1:t-1),a}a(),e.getSelection=n,e.removeSelection=i,e.onSave=o,e.addLabel=l,e.onQueryKeydown=c,e.resetFocusedLabel=u,e.getNextLabelIndex=d,e.labels=[],e.focusedLabel={},e.$watch("visible",function(t){if(!t){e.removeSelection(),u();for(var r=0;r<e.labels.length;r++){var a=e.labels[r];a.newLabel&&e.labels.splice(r,1)}}})}return{restrict:"E",templateUrl:"components/shared/assign-labels-directive/assign-labels-directive.html",controller:["$scope","Label","CreativesUpdate",t],link:e,scope:{visible:"=",selection:"=",saveCallback:"="}}}angular.module("amoAssignLabelsDirective",["amoLabelService","amoCreativesUpdateService"]).directive("assignLabels",e)}(),function(){"use strict";function e(){function e(e,t){function r(){angular.isFunction(e.saveCallback)&&e.saveCallback(e.selected||{}),e.visible=!1}function a(){e.searchText=""}function n(t){t.$$selected=!t.$$selected,e.selected&&(e.selected.$$selected=!1),e.selected=t.$$selected?t:null}e.selected=null,e.adStrategies=t.query(),e.searchText="",e.onClearSearchClick=a,e.selectAdStrategy=n,e.onSave=r}function t(e){if(!e.saveCallback||!angular.isFunction(e.saveCallback))throw new Error('Mandatory attribute "save-callback" is missing.')}return e.$inject=["$scope","AdStrategy"],{restrict:"E",templateUrl:"components/shared/browse-targeting-directive/browse-targeting.html",controller:e,link:t,scope:{saveCallback:"=",visible:"="}}}angular.module("amoBrowseTargetingDirective",["amoAdStrategyService","amoTargetingSummaryFilter"]).directive("browseTargeting",e)}(),function(){"use strict";function e(e){return function(t,r,a){var n=[];return t&&(t.amount&&n.push(e("currency")(t.amount,r,a)),t.currency&&n.push("("+t.currency+")"),t.budgetType&&n.push(t.budgetType)),n.join(" ")}}angular.module("amoBudgetFilter",[]).filter("budget",e),e.$inject=["$filter"]}(),function(){function e(e,t,r,a,n,i,o,s){return e(r+o.userId()+"/display-campaigns/:campaignId",t,{query:{method:"GET",url:r+o.userId()+"/display-campaigns",isArray:!0,transformResponse:[s,a,n]},save:{method:"POST",cache:!0,transformRequest:[i,angular.toJson],transformResponse:[s,n]}})}function t(e,t){return e(t)}angular.module("amoCampaignService",["ngResource","ui.router","amoEnvironmentConfiguration","amoPagedResourceService","amoDataSourceService","amoUserInfoService"]).factory("Campaign",e).service("CampaignDataSource",t),e.$inject=["$resource","$stateParams","API_PATH","pagedResourceTransformResponse","fluff","unFluff","userInfoService","fromJsonOrPassThrough"],t.$inject=["DataSourceService","Campaign"]}(),function(){"use strict";function e(e,t,r,a,n){return e(t+a.userId()+"/display-categories/:type",{},{query:{method:"GET",url:t+a.userId()+"/display-categories/:type/:id",isArray:!0,transformResponse:[n,r]}})}angular.module("amoCategoryService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("Category",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(){function e(e,t){function r(t){return"right"===t?"right"===e.position:"left"===e.position}function a(){return!e.hover||e.isMenuVisible||e.hoverEdit}function n(t){e.position=t}function i(t,r){e.isMenuVisible=!1,t.action&&t.action(r,t),e.menuOverlay&&e.menuOverlay.remove()}function o(){if(e.isMenuVisible=!e.isMenuVisible,e.isMenuVisible){var r=t.find(".amo-ContextMenuDirective--label").width();e.menuOverlay=angular.element('<div id="amo-ContextMenu--overlay"></div>'),e.menuOverlay.click(s),angular.element("body").prepend(e.menuOverlay),e.contextMenuPosition.left=r+2+"px"}}function s(){e.$apply(function(){e.menuOverlay.remove(),e.isMenuVisible=!1})}function l(){e.menuOverlay&&e.menuOverlay.remove()}if(!e.hover&&void 0===e.hover)throw new Error('Mandatory attribute "hover" is missing.');if(!e.position)throw new Error('Mandatory attribute "position" is missing.');if(e.selectorIcon||(e.selectorIcon="coral-Icon--breadcrumb"),e.positionMenuButton=r,e.showSelectorIcon=a,e.setPosition=n,e.selectItem=i,e.showContextMenu=o,e.outerMenuClick=s,e.onContextMenuDestroy=l,e.isMenuVisible=!1,e.contextMenuPosition={width:e.menuWidth||"13rem"},e.labelClickHandler=e.labelClickHandlerWrapper(e),e.labelClickHandler){var c=t.find(".amo-ContextMenuDirective--label");c.click(function(){e.labelClickHandler(e.data)})}e.$on("$destroy",l)}return{restrict:"E",templateUrl:"components/shared/context-menu-directive/context-menu-directive.html",link:e,scope:{data:"=",options:"=",label:"=",hover:"=",position:"=",labelClickHandlerWrapper:"&labelClickHandler",selectorIcon:"@",menuWidth:"="}}}angular.module("amoContextMenuDirective",[]).directive("contextMenu",e)}(),function(){"use strict";function e(e,t,r,a,n){return e(t+a.userId()+"/display-creative-attributes/",{type:"STANDARD"},{query:{method:"GET",isArray:!0,transformResponse:[n,r]}})}angular.module("amoCreativeAttributesService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("CreativeAttribute",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(e,r,i,o,s,l,c,u){function d(r){t.fileTotal++,NProgress.start(),r.loading=!0;var a={url:R,fields:{creativeName:r.name},file:r},n=e.upload(a);n.progress(k),n.error(I),n.success(D)}function m(){t.files=[],u.hideAll(),t.fileCounter=0,t.fileTotal=0}function g(e){async.mapSeries(t.files,e.saveSingleAsset,function(t,r){t||e.saveCallback(r)})}function p(e){E=e}function f(e){O=e}function v(e){for(var r=0;r<e.length;r++)b(e[r],e[r].url),x(e[r]);t.files=t.files.concat(e)}function h(e){t.files.splice(e,1)}function y(e){u.hideAll();for(var t=0;t<e.length;t++)C(e[t])}function C(e){var t=new FileReader;t.onload=function(){w(e,t)},t.readAsDataURL(e)}function S(e,r){var a=r.width+"x"+r.height;A(r.width,r.height)?e.base64&&t.uploadFile(e):e.error=n,e.dimensions=a,E(t.loadingSize)}function b(e,r){var a=new Image;a.onload=function(){S(e,this)},a.src=r,t.loadingSize=!0}function A(e,r){for(var a=0;a<t.validSizes.length;a++){var n=t.validSizes[a];if(n.width===e&&n.height===r)return!0}return!1}function w(e,r){T(r.result)||(e.base64=r.result,e.title=e.name,t.files.push(e),O(t.files),d(e),b(e,r.result))}function T(e){for(var r=0;r<t.files.length;r++){var a=t.files[r];if(a.base64===e)return!0}return!1}function I(e,r,n,i){var o=i.file;o.loading=!1,o.error=a,t.checkUploadCompletion()}function D(e,r,a,n){return n.file.assetId=e.assetId,t.checkUploadCompletion(),n.file.loading=!1,e}function k(e){var t=parseInt(100*e.loaded/e.total);return NProgress.inc(),t}function $(){t.fileCounter++,NProgress.inc(),t.fileTotal===t.fileCounter&&NProgress.done()}function x(e){var t={img:e.img,path:e.path,size:e.size,title:e.title,type:e.type,url:e.url};NProgress.start(),c.save(t,function(t){F(t,e)},function(t){P(t,e)})}function P(e,t){NProgress.done(),t.error=a}function F(e,t){NProgress.done(),t.assetId=e.assetId}var R=r+i.userId()+"/display-creative-asset/upload-image";t.fileCounter=0,t.fileTotal=0,t.loadingSize=!1,t.validSizes=o.query(),t.offerTypes=s.query(),t.attributes=l.query(),t.onUploadError=I,t.onUploadSuccess=D,t.onFileUploadProgress=k,t.uploadFile=d,t.checkUploadCompletion=$,t.onDamUploadFailure=P,t.onDamUploadSuccess=F,t.saveDamAsset=x,t.onImageLoaded=S,t.files=[];var E=function(){},O=function(){};return{onNewFileUpload:y,onVisibleChanges:m,saveAllAssets:g,processDamAssets:v,removeCreative:h,setLoadingSizeCallback:p,setFileLoadedCallback:f,loadingSize:t.loadingSize,files:t.files,fileInfo:t}}angular.module("amoCreativeCreationService",["angularFileUpload","amoEnvironmentConfiguration","amoUserInfoService","amoAdSizeService","amoOfferTypeService","amoCreativeAttributesService","amoDamImageService","amoQuietFormDirective"]).factory("creativeCreationService",e),e.$inject=["$upload","API_PATH","userInfoService","AdSize","OfferType","CreativeAttribute","DamImage","QuietFormService"];var t={},r='<i class="coral-Icon coral-Icon--alert"></i>&nbsp;&nbsp;',a=r+"Failed to upload creative. Please try again",n=r+"Invalid creative size"}(),function(){"use strict";function e(){function e(e,t){if(!e.saveCallback||!angular.isFunction(e.saveCallback))throw new Error('Mandatory attribute "save-callback" is missing.');e.bodyEl=e.bodyEl||t.find(".coral-Modal-body").get(0),e.$watch("visible",function(t){NProgress.configure({parent:t?e.bodyEl:"body",showSpinner:!1})})}function t(e,t,r,a,n,i,o){function s(){var t=angular.copy(e.form);NProgress.start(),p(t),t.creativeIds=d(),o.save(t,m,g)}function l(t){t?(e.form.creativeName=e.getFieldValue("name"),e.form.landingPageUrl=e.getFieldValue("landingPage"),e.form.labels=e.getFieldValue("labels"),e.form.attributes=e.getFieldValue("attributes"),e.form.offerType=e.getFieldValue("offerType"),i.hideAll(),r(function(){e.editForm.$setPristine()})):(e.selection=[],e.form={},e.editForm.$setPristine())}function c(r){var a=t("multiple")(e.selection,r);switch(a){case"Multiple":case"None":case"":return"labels"===r||"attributes"===r?[]:"";default:return a}}function u(){var r=t("multiple")(e.selection,"size","width"),a=t("multiple")(e.selection,"size","height");return"Multiple"!==r&&"Multiple"!==a?r+" x "+a:"Multiple"}function d(){return $.map(e.selection,function(e){return e.id})}function m(){e.saveCallback(e.selection),e.visible=!1,NProgress.done()}function g(){NProgress.done()}function p(t){for(var r in t)"offerType"===r&&delete t[r].selected,e.editForm[r]&&!e.editForm[r].$dirty&&delete t[r]}function f(t,r){var a=[],n=e.form[t];if(n)for(var i=0;i<n.length;i++)a.push(r?n[i].name:n[i]);return a.join(", ")}function v(t){e.previewItem(t)}e.form={},e.editForm=e,e.offerTypes=a.query(),e.attributes=n.query(),e.onSave=s,e.onVisibleChange=l,e.getFieldValue=c,e.getImageSize=u,e.mapCreativeIds=d,e.saveSuccess=m,e.saveError=g,e.pruneRequest=p,e.resolveFormLabel=f,e.previewImage=v,e.$watch("visible",l)}return{restrict:"E",templateUrl:"components/shared/creative-modals-directive/bulk-edit-directive.html",controller:["$scope","$filter","$timeout","OfferType","CreativeAttribute","QuietFormService","CreativesUpdate",t],link:e,scope:{visible:"=",saveCallback:"=",selection:"=",previewItem:"="}}}angular.module("amoBulkEditDirective",["amoMultipleFilter","amoCreativeAttributesService","amoCreativesUpdateService","amoOfferTypeService","amoQuietFormDirective","amoSelectDirective"]).directive("bulkEdit",e)}(),function(){"use strict";function e(){var e=function(e,t,r,a){function n(){u.bulkCreativeUploadData.creativeCsvFile=null,u.bulkCreativeUploadData.assetsZipFile=null,u.bulkCreativeUploadData.assetFilenameAsCreativeName=!0,u.bulkCreativeUploadData.creativeType=u.creativeType}function i(e){".csv"==e[0].name.substr(-4)&&(u.bulkCreativeUploadData.creativeCsvFile=e[0])}function o(e){u.bulkCreativeUploadData.assetsZipFile=e[0]}function s(){if(null!==u.bulkCreativeUploadData.creativeCsvFile&&null!==u.bulkCreativeUploadData.assetsZipFile){NProgress.start();{t.upload({url:r+a.userId()+"/display-bulk-upload/"+u.bulkCreativeUploadData.creativeType.toLowerCase(),file:[u.bulkCreativeUploadData.creativeCsvFile,u.bulkCreativeUploadData.assetsZipFile],fileFormDataName:["csv","zip"],fields:{useFilename:u.bulkCreativeUploadData.assetFilenameAsCreativeName}}).success(l).error(c)}}}function l(t){NProgress.done(),angular.isFunction(e.bulkUpload.saveCallback)&&e.bulkUpload.saveCallback(t),u.visible=!1}function c(){NProgress.done()}var u=this;u.showBulkCreativeUpload=n,u.onCreativeCsvFileUpload=i,u.onAssetsZipFileUpload=o,u.onUploadBulkCreativesClick=s,u.uploadSuccess=l,u.uploadError=c,u.bulkCreativeUploadData={creativeType:"IMAGE",bulkCreativeUploadPopupButtons:[],creativeCsvFile:null,assetsZipFile:null,assetFilenameAsCreativeName:!0},u.buttons=[{label:"Cancel",className:"coral-Button coral-Button--quiet",click:"hide"},{label:"Upload",className:"coral-Button coral-Button--primary",click:s}],e.$watch("bulkUpload.visible",n)},t=function(e,t){if(!e.bulkUpload.saveCallback||!angular.isFunction(e.bulkUpload.saveCallback))throw new Error('Mandatory attribute "save-callback" is missing.');e.bodyEl=e.bodyEl||t.find(".coral-Modal-body").get(0),e.$watch("bulkUpload.visible",function(t){NProgress.configure({parent:t?e.bodyEl:"body",showSpinner:!1})})};return{restrict:"E",templateUrl:"components/shared/creative-modals-directive/bulk-upload-directive.html",controllerAs:"bulkUpload",bindToController:!0,controller:["$scope","$upload","API_PATH","userInfoService",e],link:t,scope:{visible:"=",creativeType:"=",saveCallback:"="}}}angular.module("amoBulkUploadDirective",["amoFileSizeFilter","angularFileUpload","amoEnvironmentConfiguration","amoUserInfoService"]).directive("bulkUpload",e)}(),function(){"use strict";function e(){function e(e,t){if(!e.saveCallback||!angular.isFunction(e.saveCallback))throw new Error('Mandatory attribute "save-callback" is missing.');e.bodyEl=e.bodyEl||t.find(".coral-Modal-body").get(0),e.$watch("visible",function(t){NProgress.configure({parent:t?e.bodyEl:"body",showSpinner:!1})})}function t(e,t,r){function a(t){e.$apply(function(){e.files=t})}function n(r){r&&(e.form=angular.copy(p),e.files=[],t.onVisibleChanges())}function i(t,a){var n=angular.copy(e.form);t.error=null,n.asset={assetId:t.assetId,imageHash:t.imageHash,imageCdnUrl:t.imageCdnUrl},n.offerType={name:"testoffertype",id:1},n.name||(n.name=t.name||t.title),r.save(n,function(e){a(null,e)},function(e){if(e&&e.data&&e.data.message){var r=function(t){if(t.data.fieldErrors){var r="Please correct the following:";return angular.forEach(t.data.fieldErrors,function(e){switch(e.field){case"landingPage":r+="<br><strong>Landing Page URL cannot be empty</strong>";break;case"offerType":r+="<br><strong>Offer Type cannot be empty</strong>";break;case"name":r+="<br><strong>Creative Name cannot be empty</strong>"}}),r}return e.data.message};t.error=g+r(e)}else t.error=g+"Failed to save this creative";NProgress.done(),a(e)})}function o(t){e.saveCallback(t),e.visible=!1}function s(){NProgress.start(),t.saveAllAssets({saveSingleAsset:e.saveSingleAsset,saveCallback:o})}function l(){e.$apply(function(){e.visible=!1})}function c(){e.isAssetPickerVisible=!0}function u(e){t.onNewFileUpload(e)}function d(e){t.removeCreative(e)}function m(r,a){if(e.visible){var n=angular.fromJson(a);n.config&&("close"===n.config.action?e.isAssetPickerVisible=!1:"done"===n.config.action&&(e.isAssetPickerVisible=!1,t.processDamAssets(n.data)))}}var g='<i class="coral-Icon coral-Icon--alert"></i>&nbsp;&nbsp;',p={creativeType:"IMAGE",labels:[]};e.$on("$messageIncoming",m),e.showAssetPicker=c,e.saveSingleAsset=i,e.onNewFileUpload=u,e.onSave=s,e.onCancel=l,e.removeCreative=d,e.fileLoadedCallback=a,e.files=t.files,e.form=angular.copy(p),e.buttons=[{label:"Cancel",className:"coral-Button coral-Button--quiet",click:l},{label:"Save",className:"coral-Button coral-Button--primary",click:s}],e.$watch("visible",n),t.setLoadingSizeCallback(function(){e.$apply(function(t){e.loadingSize=t})}),t.setFileLoadedCallback(e.fileLoadedCallback)}return t.$inject=["$scope","creativeCreationService","Creatives"],{restrict:"E",templateUrl:"components/shared/creative-modals-directive/new-fbx-creative-directive.html",controller:t,link:e,scope:{saveCallback:"=",visible:"="}}}angular.module("amoNewFbxCreativeDirective",["ngPostMessage","amoMultipleFilter","amoCreativeCreationService","amoCreativesService"]).directive("newFbxCreative",e)}(),function(){"use strict";function e(){function e(e,t){if(!e.saveCallback||!angular.isFunction(e.saveCallback))throw new Error('Mandatory attribute "save-callback" is missing.');e.bodyEl=e.bodyEl||t.find(".coral-Modal-body").get(0),e.$watch("visible",function(t){NProgress.configure({parent:t?e.bodyEl:"body",showSpinner:!1})})}function t(e,t,r,a,n,i,o,s,l,c){function u(){e.flashFile=null}function d(t){t&&(e.form=angular.copy(R),e.flashFile=null,e.backupImage=null,l.hideAll(),e.fileCounter=0,e.fileTotal=0)}function m(){e.flashFile.error=null;var t=angular.copy(e.form);t.asset={assetId:e.flashFile.assetId},t.backupImage={assetId:e.backupImage&&e.backupImage.assetId||null},t.name||(t.name=e.flashFile.title),n.save(t,function(t){angular.isFunction(e.saveCallback)&&e.saveCallback([t]),e.visible=!1},function(t){if(t&&t.data&&t.data.message){var r=function(e){if(e.data.fieldErrors){var r="Please correct the following:";return angular.forEach(e.data.fieldErrors,function(e){switch(e.field){case"landingPage":r+="<br><strong>Landing Page URL cannot be empty</strong>";break;case"offerType":r+="<br><strong>Offer Type cannot be empty</strong>";break;case"backupImage.assetId":r+="<br><strong>A backup image must be uploaded</strong>"}}),r}return t.data.message};e.flashFile.error=P+r(t)}else e.flashFile.error=P+"Failed to save this creative";NProgress.done()})}function g(){NProgress.start(),e.$apply(e.doSave)}function p(){e.$apply(function(){e.visible=!1})}function f(t){l.hideAll(),t&&t[0]&&(e.flashFile=t[0],e.flashFile.title=e.flashFile.name,e.uploadFile(e.flashFile,$))}function v(t){l.hideAll(),t&&t[0]&&(e.backupImage=t[0],e.backupImage.title=e.backupImage.name,e.uploadFile(e.backupImage,x))}function h(r,a){e.fileTotal++,NProgress.start(),r.loading=!0;var n={url:a,fields:{creativeName:r.name},file:r},i=t.upload(n);i.progress(S),i.error(y),i.success(C)}function y(t,r,a,n){var i=n.file;i.loading=!1,i.error=F,e.checkUploadCompletion()}function C(t,r,a,n){return n.file.assetId=t.assetId,e.checkUploadCompletion(),n.file.loading=!1,t}function S(){NProgress.inc()}function b(){e.fileCounter++,NProgress.inc(),e.fileTotal===e.fileCounter&&NProgress.done()}function A(){e.isAssetPickerVisible=!0}function w(e){var t={img:e.img,path:e.path,size:e.size,title:e.title,type:e.type,url:e.url};NProgress.start(),a.save(t,function(t){I(t,e)},function(t){T(t,e)})}function T(e,t){NProgress.done(),t.error=F,t.loading=!1}function I(e,t){NProgress.done(),t.assetId=e.assetId,t.loading=!1}function D(t){"application/x-shockwave-flash"===t[0].type?e.flashFile=t[0]:e.backupImage=t[0],t[0].loading=!0,w(t[0])}function k(t,r){if(e.visible){var a=angular.fromJson(r);a.config&&("close"===a.config.action?(e.isAssetPickerVisible=!1,e.isBackupAssetPickerVisible=!1):"done"===a.config.action&&(e.isAssetPickerVisible=!1,e.isBackupAssetPickerVisible=!1,D(a.data)))}}var $=r+c.userId()+"/display-creative-asset/upload-flash",x=r+c.userId()+"/display-creative-asset/upload-image",P='<i class="coral-Icon coral-Icon--alert"></i>&nbsp;&nbsp;',F=P+"Failed to upload creative. Please try again",R={creativeType:"FLASH",labels:[]};e.validSizes=o.query(),e.offerTypes=i.query(),e.attributes=s.query(),e.onSave=g,e.doSave=m,e.onCancel=p,e.onNewFlashFileUpload=f,e.onNewImageFileUpload=v,e.showAssetPicker=A,e.onUploadError=y,e.onUploadSuccess=C,e.onFileUploadProgress=S,e.uploadFile=h,e.checkUploadCompletion=b,e.removeFlashFile=u,e.onDamUploadFailure=T,e.saveDamAsset=w,e.$on("$messageIncoming",k),e.flashFile=null,e.backupImage=null,e.form=angular.copy(R),e.fileCounter=0,e.fileTotal=0,e.buttons=[{label:"Cancel",className:"coral-Button coral-Button--quiet",click:p},{label:"Save",className:"coral-Button coral-Button--primary",click:g}],e.$watch("visible",d)}return t.$inject=["$scope","$upload","API_PATH","DamImage","Creatives","OfferType","AdSize","CreativeAttribute","QuietFormService","userInfoService","$timeout"],{restrict:"E",templateUrl:"components/shared/creative-modals-directive/new-flash-creative-directive.html",controller:t,link:e,scope:{saveCallback:"=",visible:"="}}}angular.module("amoNewFlashCreativeDirective",["angularFileUpload","ngPostMessage","amoMultipleFilter","amoCreativeAttributesService","amoOnOffFilter","amoEnvironmentConfiguration","amoDamImageService","amoCreativesService","amoOfferTypeService","amoAdSizeService","amoQuietFormDirective","amoUserInfoService"]).directive("newFlashCreative",e)}(),function(){"use strict";function e(){function e(e,t){if(!e.saveCallback||!angular.isFunction(e.saveCallback))throw new Error('Mandatory attribute "save-callback" is missing.');e.bodyEl=e.bodyEl||t.find(".coral-Modal-body").get(0),e.$watch("visible",function(t){NProgress.configure({parent:t?e.bodyEl:"body",showSpinner:!1})})}function t(e,t,r,a,n,i,o,s,l,c){function u(t){e.files.splice(t,1)}function d(t){t&&(e.form=angular.copy(B),e.files=[],l.hideAll(),e.fileCounter=0,e.fileTotal=0)}function m(t,r){var a=angular.copy(e.form);t.error=null,a.asset={assetId:t.assetId},a.name||(a.name=t.name||t.title),n.save(a,function(e){r(null,e)},function(e){if(e&&e.data&&e.data.message){var a=function(t){if(t.data.fieldErrors){var r="Please correct the following:";return angular.forEach(t.data.fieldErrors,function(e){switch(e.field){case"landingPage":r+="<br><strong>Landing Page URL cannot be empty</strong>";break;case"offerType":r+="<br><strong>Offer Type cannot be empty</strong>";break;case"name":r+="<br><strong>Creative Name cannot be empty</strong>"}}),r}return e.data.message};t.error=M+a(e)}else t.error=M+"Failed to save this creative";NProgress.done(),r(e)})}function g(){async.mapSeries(e.files,e.saveSingleAsset,function(t,r){t||(angular.isFunction(e.saveCallback)&&e.saveCallback(r),e.visible=!1)})}function p(){NProgress.start(),g()}function f(){e.$apply(function(){e.visible=!1})}function v(e){l.hideAll();for(var t=0;t<e.length;t++)S(e[t])}function h(t,r){var a=r.width+"x"+r.height;C(r.width,r.height)?t.base64&&e.uploadFile(t):t.error=N,e.$apply(function(){t.dimensions=a,e.loadingSize=!1})}function y(t,r){var a=new Image;a.onload=function(){h(t,this)},a.src=r,e.loadingSize=!0}function C(t,r){for(var a=0;a<e.validSizes.length;a++){var n=e.validSizes[a];if(n.width===t&&n.height===r)return!0}return!1}function S(e){var t=new FileReader;t.onload=function(){b(e,t)},t.readAsDataURL(e)}function b(t,r){A(r.result)||(e.$apply(function(){t.base64=r.result,t.title=t.name,e.files.push(t),w(t)}),y(t,r.result))}function A(t){for(var r=0;r<e.files.length;r++){var a=e.files[r];if(a.base64===t)return!0}return!1}function w(r){e.fileTotal++,NProgress.start(),r.loading=!0;var a={url:O,fields:{creativeName:r.name},file:r},n=t.upload(a);n.progress(D),n.error(T),n.success(I)}function T(t,r,a,n){var i=n.file;i.loading=!1,i.error=U,e.checkUploadCompletion()}function I(t,r,a,n){return n.file.assetId=t.assetId,e.checkUploadCompletion(),n.file.loading=!1,t}function D(e){var t=parseInt(100*e.loaded/e.total);return NProgress.inc(),t}function k(){e.fileCounter++,NProgress.inc(),e.fileTotal===e.fileCounter&&NProgress.done()}function $(){e.isAssetPickerVisible=!0}function x(e){var t={img:e.img,path:e.path,size:e.size,title:e.title,type:e.type,url:e.url};NProgress.start(),a.save(t,function(t){F(t,e)},function(t){P(t,e)})}function P(e,t){NProgress.done(),t.error=U}function F(e,t){NProgress.done(),t.assetId=e.assetId}function R(t){for(var r=0;r<t.length;r++)y(t[r],t[r].url),x(t[r]);e.files=e.files.concat(t)}function E(t,r){if(e.visible){var a=angular.fromJson(r);a.config&&("close"===a.config.action?e.isAssetPickerVisible=!1:"done"===a.config.action&&(e.isAssetPickerVisible=!1,R(a.data)))}}var O=r+c.userId()+"/display-creative-asset/upload-image",M='<i class="coral-Icon coral-Icon--alert"></i>&nbsp;&nbsp;',U=M+"Failed to upload creative. Please try again",N=M+"Invalid creative size",B={creativeType:"IMAGE",labels:[]};
e.fileCounter=0,e.fileTotal=0,e.validSizes=o.query(),e.offerTypes=i.query(),e.attributes=s.query(),e.onSave=p,e.onCancel=f,e.onNewFileUpload=v,e.showAssetPicker=$,e.onUploadError=T,e.onUploadSuccess=I,e.onFileUploadProgress=D,e.saveSingleAsset=m,e.uploadFile=w,e.checkUploadCompletion=k,e.removeCreative=u,e.onDamUploadFailure=P,e.saveDamAsset=x,e.onImageLoaded=h,e.$on("$messageIncoming",E),e.files=[],e.form=angular.copy(B),e.buttons=[{label:"Cancel",className:"coral-Button coral-Button--quiet",click:f},{label:"Save",className:"coral-Button coral-Button--primary",click:p}],e.$watch("visible",d)}return t.$inject=["$scope","$upload","API_PATH","DamImage","Creatives","OfferType","AdSize","CreativeAttribute","QuietFormService","userInfoService"],{restrict:"E",templateUrl:"components/shared/creative-modals-directive/new-image-creative-directive.html",controller:t,link:e,scope:{saveCallback:"=",visible:"="}}}angular.module("amoNewImageCreativeDirective",["angularFileUpload","ngPostMessage","amoMultipleFilter","amoCreativeAttributesService","amoEnvironmentConfiguration","amoDamImageService","amoCreativesService","amoOfferTypeService","amoAdSizeService","amoQuietFormDirective","amoUserInfoService"]).directive("newImageCreative",e)}(),function(){"use strict";function e(e,t,r){return e(t+r.userId()+"/display-creatives",{ids:"@ids"},{"delete":{method:"DELETE"}})}angular.module("amoCreativesDeleteService",["ngResource","amoEnvironmentConfiguration","amoUserInfoService"]).factory("CreativesDelete",e),e.$inject=["$resource","API_PATH","userInfoService"]}(),function(){"use strict";function e(e,t,r,a,n,i,o){return e(t+a.userId()+"/display-ad-strategies/creatives/:id",o,{query:{method:"GET",isArray:!0,transformResponse:[n,r,i]}})}function t(e,t){return e(t)}angular.module("amoAdThemeCreativesService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("AdThemeCreativesService",e).service("AdThemeCreativesDataSource",t),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough","fluff","$stateParams"],t.$inject=["DataSourceService","AdThemeCreativesService"]}(),function(){"use strict";function e(e,t,r,a,n){return e(t+a.userId()+"/display-creatives/",{},{query:{method:"GET",isArray:!0,transformResponse:[n,r]}})}angular.module("amoCreativesService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("Creatives",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(e,t,r){return e(t+r.userId()+"/display-creatives/edit",{},{save:{method:"POST"}})}angular.module("amoCreativesUpdateService",["ngResource","amoEnvironmentConfiguration","amoUserInfoService"]).factory("CreativesUpdate",e),e.$inject=["$resource","API_PATH","userInfoService"]}(),function(){function e(e,t,r){return e(t+r.userId()+"/display-currencies/:currencyId")}angular.module("amoCurrencyService",["ngResource","amoEnvironmentConfiguration","amoUserInfoService"]).factory("Currency",e),e.$inject=["$resource","API_PATH","userInfoService"]}(),function(){"use strict";function e(e,t,r){return e(t+r.userId()+"/display-creative-asset/upload-dam-image")}angular.module("amoDamImageService",["ngResource","amoEnvironmentConfiguration","amoUserInfoService"]).factory("DamImage",e),e.$inject=["$resource","API_PATH","userInfoService"]}(),function(){"use strict";function e(){return function(e){if(!("query"in e)||"function"!=typeof e.query)throw new Error("Service must implement function 'query'");return{params:{},get:function(t,r,a){function n(){s.page=u+1,e.query(s,function(e){e.forEach(i),a(l.slice(c-u*r,r+c-u*r))},o)}function i(e){l.push(e)}function o(){a(l)}var s=angular.copy(this.params),l=[],c=t-1,u=Math.floor(c/r);s.pageSize=r,t>0?(s.page=u,e.query(s,function(e){e.forEach(i),n()},n)):(s.page=0,e.query(s,function(e){for(var t=0;c+r>t&&t<e.length;t++)l.push(e[t]);a(l)},o))}}}}angular.module("amoDataSourceService",[]).service("DataSourceService",e)}(),function(){"use strict";function e(e,t,r,a,n){return e(t+a.userId()+"/display-devices",{},{query:{method:"GET",isArray:!0,transformResponse:[n,r]}})}angular.module("amoDeviceService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("Device",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(){return function(e){var t="";return t=e>999999999?Math.round(e/1e9)+" GB":e>999999?Math.round(e/1e6)+" MB":e>999?Math.round(e/1e3)+" KB":e+" B"}}angular.module("amoFileSizeFilter",[]).filter("fileSize",e)}(),function(){"use strict";function e(){function e(e){function t(t){t.thumbnailUrl&&(e.src=t.thumbnailUrl),t&&t.size&&(e.style={width:e.creative.size.width+"px",height:e.creative.size.height+"px"})}e.$watch("creative",function(e){t(e)})}return{restrict:"E",template:'<object data="{{src}}" type="application/x-shockwave-flash" ng-style=style><param name="allowscriptaccess" value="always" /><param name="allowfullscreen" value="true" /><param name="wmode" value="transparent" /></object>',link:e,scope:{src:"=?",creative:"="}}}angular.module("amoFlashPreviewDirective",[]).directive("flashPreview",e)}(),function(){"use strict";function e(e,r,a,n,i){return e(r+n.userId()+"/display-geodata",{},{query:{method:"GET",url:r+n.userId()+"/display-geodata",isArray:!0,transformResponse:[i,a,t]},get:{method:"GET",url:r+n.userId()+"/display-geodata/countries",isArray:!0,transformResponse:[i,a,t]},countries:{method:"GET",url:r+n.userId()+"/display-geodata/countries",isArray:!0,transformResponse:[i,a,t]},metros:{method:"GET",url:r+n.userId()+"/display-geodata/metros",isArray:!0,transformResponse:[i,a,t]},countryRegions:{method:"GET",url:r+n.userId()+"/display-geodata/countries/:id",isArray:!0,transformResponse:[i,a,t]},regionCities:{method:"GET",url:r+n.userId()+"/display-geodata/regions/:id",isArray:!0,transformResponse:[i,a,t]}})}function t(e){return angular.isArray(e)&&e.forEach(function(e){switch(e.geoType){case"COUNTRY":e.id=e.countryId;break;case"REGION":e.id=e.regionId;break;case"METRO":e.id=e.metroId;break;case"CITY":e.id=e.cityId}}),e}angular.module("amoGeodataService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("Geodata",e).value("GeodataTransform",t),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(){function e(e,t,r,a){var n="",i=!0;if(angular.isDefined(a)&&a&&e in a&&(i=!1),i){var o=angular.isArray(r)?r.join("|"):r;n=[e,t,encodeURIComponent(o)].join(":")}return n}return function(t,r){var a=[];return t.forEach(function(t){a.push(e(t.property,t.operator,t.value,r))}),a.join(",")}}function t(){return function(e,t){var a=[];if(angular.isDefined(e)){var n=!0;angular.isDefined(t)&&t&&e.property in t&&("property"in t[e.property]&&a.push(t[e.property].property.toUpperCase()),"operator"in t[e.property]&&a.push(t[e.property].operator.toUpperCase()),"value"in t[e.property]&&a.push(t[e.property].value),n=!1),n&&("property"in e&&a.push(e.property.toUpperCase()),"operator"in e&&a.push(r[e.operator].symbol),"value"in e&&a.push(e.value))}return a.join(" ")}}var r={EQUALS:{name:"EQUALS",symbol:"="},NOT_EQUALS:{name:"NOT_EQUALS",symbol:"!="},LESS_THAN:{name:"LESS_THAN",symbol:"<"},GREATER_THAN:{name:"GREATER_THAN",symbol:">"},LESS_OR_EQUAL:{name:"LESS_OR_EQUAL",symbol:"<="},GREATER_OR_EQUAL:{name:"GREATER_OR_EQUAL",symbol:">="}};angular.module("amoGridFilters",[]).filter("gridFilterUrlParam",e).filter("gridFilterLabel",t).value("gridFilterOperators",r)}(),function(){function e(e){return{selectModule:function(t){e.sendMessage('{"Message" : "selectModule" , "moduleId" : "'+t+'"}')},selectSubModule:function(t){e.sendMessage('{"Message" : "selectSubModule" , "moduleIdSubModule" : "'+t+'"}')}}}angular.module("amoGwtInterfaceService",["amoGwtSendMessageService"]).factory("gwtInterfaceService",e),e.$inject=["gwtSendMessageService"]}(),function(){function e(e){function t(e,t){var r=e.info,a=e.error;return e.info=function(){var e=[].slice.call(arguments);t.sendMessage('{"Message" : "logInfoToGwt" , "MessageString" : "'+e.join()+'"}'),r.apply(null,e)},e.info.logs=[],e.error=function(){var e=[].slice.call(arguments);t.sendMessage('{"Message" : "logErrorToGwt" , "MessageString" : "'+e.join()+'"}'),a.apply(null,e)},e.error.logs=[],e}e.decorator("$log",t),t.$inject=["$delegate","gwtSendMessageService"]}angular.module("amoGwtLoggerDecorator",["amoGwtSendMessageService"]).config(e),e.$inject=["$provide"]}(),function(){function e(){return{sendMessage:function(e){window.parent!=window&&window.parent.postMessage(e,"*")}}}angular.module("amoGwtSendMessageService",[]).factory("gwtSendMessageService",e)}(),function(){"use strict";function e(){var e={0:"Server Unavailable",100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Large",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"},t={1:"Informational",2:"Successful",3:"Redirection",4:"Client Error",5:"Server Error"};return function(r){return e[r]||t[Math.floor(r/100)]||r}}angular.module("amoHttpStatusCodeFilter",[]).filter("httpStatusCode",e)}(),function(){"use strict";function e(e,o,s,l,c,u){function d(){g.$emit("updateCampaignGridData","reload")}function m(e){e.maxBudget.amount=r,e.$save({campaignId:a},d)}var g=null;t=u;var p=function(e){var o=e.data;n=o.row,r=e.currentTarget.value,n[5]=r,a=n[i],t.get({campaignId:a},m)};return{setScope:function(e){g=e},setDataSource:function(t,r,a,n){var i=r.getMap();i.setReporttype(t),i.setChanneltype(a),i.setUserid(e.userId()),i.setWebuserid(e.webUserId()),i.setLimit(n);var u=new o.ReportRequest(l,s,r,/https/.test(c));return u},getStatusHtml:function(e,t){"active"==t.cell&&(t.formattedCell='<img class="amo-CampaignTable--statusImageStyle" src="components/shared/images/status-active.svg" alt=""/>'),"paused"==t.cell&&(t.formattedCell='<img class="amo-CampaignTable--statusImageStyle" src="components/shared/images/status-paused.svg" alt=""/>')},getCampaignNameGridBodyContextMenu:function(e,t,r){t.scope.labelClickFunctionBuilder=r.labelClickFunctionBuilder,t.scope.contextMenu=r.contextMenu,t.formattedCell='<context-menu label-click-handler="labelClickFunctionBuilder('+t.row[r.clickTextDataColumnPosition]+')" data="\''+t.row[r.contextMenuClickDataColumnPosition]+'\'" options="contextMenu" label="\''+t.cell+'\'" hover="true" position="\'right\'" style="overflow: visible;"></context-menu>'},getBudgetEditControl:function(e,t,r,o){if(i=r.idPosition,o){var s=r.inlineEditBudgetModelName;n=t.row,a=n[r.idPosition];var l=t.row[r.maxBudgetColumnPosition],c='<div class="coral-Form-fieldwrapper amosc-Control amosc-TextControl" quiet-form="'+a+'" quiet-role="wrapper">';return c+='<span class="amosc-Control--quiet amosc-Control--defaultText" quiet-form="'+a+'" quiet-role="label" style="display:inline;">',c+=l?'<i class="coral-Icon coral-Icon--edit coral-Icon--sizeXS"></i>'+l:'<span class="u-amo-required">(required)</span>',c+="</span>",c+='<span class="amosc-Control--active" quiet-form="'+a+'" quiet-role="controlWrapper" style="display:inline;"><input class="coral-Form-field coral-Textfield shorterInput" type="number" step="0.01" placeholder="Required" name="'+a+'" aria-required="true" quiet-form="'+a+'" quiet-role="control" ng-model="'+s+'" required></span></div>'}e.find("input").blur(t,p)}}}angular.module("amoJavaReportServiceLocatorService",["amoUserInfoService","DataSourcesModule","amoEnvironmentConfiguration","amoCampaignService"]).factory("JavaReportServiceLocator",e);var t=null,r=0,a=0,n=null,i=0;e.$inject=["userInfoService","ReportServiceFactory","JAVA_REPORT_SERVER_PORT","JAVA_REPORT_SERVER_HOSTNAME","JAVA_REPORT_SERVER_PROTOCOL","Campaign"]}(),function(){function e(e,t){function r(e){n.selection.splice(e,1)}function a(e){if(n.searchField||e){for(var t=e||n.searchField,r=0;r<n.selection.length;r++)if(n.selection[r]===t)return void(n.searchField=null);n.selection.push(t),n.searchField=null}}var n=this;n.labels=e.query(),n.searchField=null,n.selection=n.selection||[],n.addNewLabel=a,n.removeLabel=r,t.$watchCollection("labelCtrl.selection",function(e){e&&n.form&&n.form[n.formFieldName]&&n.form[n.formFieldName].$setDirty()})}angular.module("amoLabelFieldController",["amoLabelService"]).controller("LabelFieldController",e),e.$inject=["Label","$scope"]}(),function(){function e(){return{restrict:"E",templateUrl:"components/shared/label-field-directive/label-field-directive.html",scope:{selection:"=",quietFormName:"="},controller:"LabelFieldController",controllerAs:"labelCtrl",bindToController:!0}}function t(){return{restrict:"E",templateUrl:"components/shared/label-field-directive/creative-popup-label-field-directive.html",scope:{selection:"=",quietFormName:"=",showModifiers:"=",formFieldName:"@",form:"="},controller:"LabelFieldController",controllerAs:"labelCtrl",bindToController:!0}}angular.module("amoLabelFieldDirective",["amoLabelFieldController"]).directive("labelField",e).directive("creativePopupLabelField",t)}(),function(){"use strict";function e(e,t,r,a,n){return e(t+a.userId()+"/display-labels",{pageSize:1e4},{query:{method:"GET",transformResponse:[n,r],isArray:!0},add:{method:"POST"}})}angular.module("amoLabelService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("Label",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(e,t,r,a,n){return e(t+a.userId()+"/display-languages",{},{query:{method:"GET",isArray:!0,transformResponse:[n,r]}})}angular.module("amoLanguageService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("Language",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(){function e(e,t,r){function l(t){function r(t){e.searchResults=t||[]}e.searchResults=e.loadSearchResults({query:t,cb:r})||e.searchResults}function m(){var t=[],r=g();return t=r.$$children&&r.$$children.length?e.path:e.path.slice(0,e.path.length-1)}function g(){return e.path[e.path.length-1]}function p(){var t=e.options.headers.columnData,r=m();return r.length<t.length?t.slice(0,r.length):t}function f(t){return i(g(),t,e.trackByFn)||e.path.some(function(r){return i(t,r,e.trackByFn)})}function v(t){var r;return r=C(t)?x:s(t,e)?y(t)?F:P:y(t)?x:P}function h(t){var r=P;return C(t)?r=x:s(t,e)&&(r=F),r}function y(t){for(var r=!1,a=t.$$ancestry.length-2;a>-1;a--){if(C(t.$$ancestry[a])){r=!0;break}if(s(t.$$ancestry[a],e)){r=!1;break}}return r}function C(t){return angular.isUndefined(e.selected)?!1:e.selected.some(u(t,e.trackByFn))}function S(t){return angular.isUndefined(e.favorites)?!1:e.favorites.some(u(t,e.trackByFn))}function b(e){return!S(e)}function A(t,r){r.stopPropagation(),y(t)?(o(t,e),s(t,e)?D(t):e.deselected.push(t)):(D(t),C(t)?o(t,e):e.selected.push(t))}function w(t,r){r.stopPropagation(),C(t)?(o(t,e),e.deselected.push(t)):s(t,e)?D(t):e.selected.push(t)}function T(t,r){r.stopPropagation(),S(t)?e.favorites=e.favorites.filter(d(t,e.trackByFn)):e.favorites.push(t)}function I(t){e.path=t.$$ancestry,e.loadChildren(t)}function D(t){e.deselected=e.deselected.filter(d(t,e.trackByFn))}function k(){var r=m(),a=t.find(".amosc-MillerColumn--directive"),n="auto";return r.length>e.maxColumns&&a.find(".amosc-MillerColumn--wrapper.isVisible").length&&!e.query&&(n=a.width()/e.maxColumns*(r.length-.33)+"px",a.scrollLeft(a[0].scrollWidth)),{width:n}}function $(t){var r=e.options.headers.columnData,a=m();if(a.length>r.length&&t===r.length-1){var n=(a.length-r.length+1).toString();return{flex:n,"-ms-flex":n,"-webkit-flex":n}}}var x="coral-Icon--checkCircle",P="coral-Icon--circle",F="coral-Icon--minusCircle";if(!e.root)throw new Error('Mandatory Miller Column attribute "data" is missing.');if(!e.options)throw new Error('Mandatory Miller Column attribute "options" is missing.');c(e.root,function(){a(e.root)}),e.loadChildren=function(t){n(e,t)},e.loadChildren(e.root),e.path=e.root.$$ancestry||[e.root],e.nodeMap={},e.expand=I,e.selectClick=A,e.selectTristateClick=w,e.favoriteClick=T,e.selectedByInheritanceClass=v,e.selectedClass=h,e.isFavorite=S,e.isNotFavorite=b,e.isExpandedParent=f,e.getPath=m,e.getColumnHeader=p,e.configureWrapper=k,e.styleHeader=$,e.selected=e.selected||[],e.deselected=e.deselected||[],e.favorites=e.favorites||[],e.maxColumns=e.options.body.maxColumns||3,e.searchResults=[],e.doSearch=l,e.trackByFn=r.trackBy?e.trackBy:null,e.enableSearch=r.search}return{restrict:"E",templateUrl:"components/shared/miller-column-directive/miller-column-directive.html",link:e,scope:{options:"=",root:"=data",path:"=?",trackBy:"&",orderBy:"&",selected:"=?",deselected:"=?",favorites:"=?",loadNodeChildren:"&children",getNodeLabel:"&label",loadSearchResults:"&search"}}}function t(){function e(e,t,r){function a(t,r){r.stopPropagation(),o(t,e)}e.trackByFn=r.trackBy?e.trackBy:null,e.selected=e.selected||[],e.deselected=e.deselected||[],e.removeFromSelected=a,e.getExcludedChildren=l(e)}return{restrict:"E",templateUrl:"components/shared/miller-column-directive/miller-column-summary-directive.html",link:e,scope:{trackBy:"&",selected:"=?",deselected:"=?",loadNodeChildren:"&children",getNodeLabel:"&label"}}}function r(){function e(e,t,r){e.trackByFn=r.trackBy?e.trackBy:null,e.getExcludedChildren=l(e)}return{restrict:"E",template:'<span ng-if="!selected.length && !deselected.length">All</span>\n<span ng-repeat="selectedItem in selected"><span ng-if="!$first">; </span>{{getNodeLabel(selectedItem)}}<span class="u-amo-required"><span ng-repeat="deselectedItem in getExcludedChildren(selectedItem)"><span ng-if="$first"> (Exclude: </span><span ng-if="!$first">, </span>{{getNodeLabel(deselectedItem)}}<span ng-if="$last">)</span></span></span></span>',link:e,scope:{trackBy:"&",selected:"=?",deselected:"=?",loadNodeChildren:"&children",getNodeLabel:"&label"}}}function a(e,t){e.$$ancestry=t&&t.$$ancestry?t.$$ancestry.concat(e):[e]}function n(e,t){function r(){t.$$children||(t.$$children=[],e.loadNodeChildren({node:t,cb:n}))}function n(e){t.$$children=e||[],c(t.$$children,i)}function i(){t.$$children.forEach(function(e){a(e,t)})}c(t,r)}function i(e,t,r){return r?angular.equals(r(e),r(t)):angular.equals(e,t)}function o(e,t){t.selected=t.selected.filter(d(e,t.trackByFn))}function s(e,t){return angular.isUndefined(t.deselected)?!1:t.deselected.some(u(e,t.trackByFn))}function l(e){return function(t){return n(e,t),t.$$children.filter(function(t){return s(t,e)})}}function c(e,t){e.$promise?e.$promise.then(t):t()}angular.module("amoMillerColumnDirective",[]).directive("millerColumn",e).directive("millerColumnSummary",t).directive("millerColumnQuietLabel",r);var u=function(e,t){return function(r){return i(r,e,t)}},d=function(e,t){return function(r){return!i(e,r,t)}}}(),function(){"use strict";function e(){function e(e,t,r){function c(t){function r(t){e.searchResults=t||[]}e.searchResults=e.loadSearchResults({query:t,cb:r})||e.searchResults}function u(){var t=[],r=d();return t=r.$$children&&r.$$children.length?e.path:e.path.slice(0,e.path.length-1)}function d(){return e.path[e.path.length-1]}function m(){var t=e.options.headers.columnData,r=u();return r.length<t.length?t.slice(0,r.length):t}function g(t){return i(d(),t,e.trackByFn)||e.path.some(function(r){return i(t,r,e.trackByFn)})}function p(t){var r,a="coral-Icon--checkCircle",n="coral-Icon--apps amosc-MillerColumnExpression--gripIcon",i="coral-Icon--minusCircle";return r=h(t)?a:y(t,e)?i:n}function f(e,t){return t.inclusion.value?e.concat(t.items):e}function v(e,t){return t.inclusion.value?e:e.concat(t.items)}function h(t){var r=e.expression.reduce(f,[]);return r.some(s(t,e.trackByFn))}function y(t){return e.expression.reduce(v,[]).some(s(t,e.trackByFn))}function C(t){return e.favorites.some(s(t,e.trackByFn))}function S(e){return!C(e)}function b(t,r){r.stopPropagation(),C(t)?e.favorites=e.favorites.filter(l(t,e.trackByFn)):e.favorites.push(t)}function A(t){e.path=t.$$ancestry,e.loadChildren(t)}function w(){var r=u(),a=t.find(".amosc-MillerColumnExpression--directive"),n="auto";return r.length>e.maxColumns&&a.find(".amosc-MillerColumnExpression--wrapper.isVisible").length&&(n=a.width()/e.maxColumns*(r.length-.33)+"px",a.scrollLeft(a[0].scrollWidth)),{width:n}}function T(t){var r=e.options.headers.columnData,a=u();if(a.length>r.length&&t===r.length-1){var n=(a.length-r.length+1).toString();return{flex:n,"-ms-flex":n,"-webkit-flex":n}}}if(!e.root)throw new Error('Mandatory Miller Column Expression attribute "data" is missing.');if(!e.options)throw new Error('Mandatory Miller Column Expression attribute "options" is missing.');o(e.root,function(){a(e.root)}),e.loadChildren=function(t){n(e,t)},e.loadChildren(e.root),e.path=e.root.$$ancestry||[e.root],e.expand=A,e.favoriteClick=b,e.selectedClass=p,e.isFavorite=C,e.isNotFavorite=S,e.isExpandedParent=g,e.getPath=u,e.getColumnHeader=m,e.configureWrapper=w,e.styleHeader=T,e.expression=e.expression||[],e.favorites=e.favorites||[],e.maxColumns=e.options.body.maxColumns||3,e.searchResults=[],e.doSearch=c,e.trackByFn=r.trackBy?e.trackBy:null,e.enableSearch=r.search}return{restrict:"E",templateUrl:"components/shared/miller-column-expression-directive/miller-column-expression-directive.html",link:e,scope:{options:"=",root:"=data",path:"=?",trackBy:"&",expression:"=?",favorites:"=?",loadNodeChildren:"&children",getNodeLabel:"&label",loadSearchResults:"&search"}}}function t(){function e(e,t,r){function a(t,r){r.stopPropagation(),e.itemGroup.items=e.itemGroup.items.filter(l(t,e.trackByFn))}e.trackByFn=r.trackBy?e.trackBy:null,e.removeFromSelected=a,e.operators=[{name:"AND",value:!0},{name:"AND NOT",value:!1}]}return{restrict:"E",templateUrl:"components/shared/miller-column-expression-directive/miller-column-expression-summary-directive.html",link:e,scope:{trackBy:"&",itemGroup:"=",closeHandler:"&closeHandler",showOperators:"=showOperators",getNodeLabel:"&label"}}}function r(){return{restrict:"E",template:'<span ng-repeat="itemGroup in expression" ng-class="!itemGroup.inclusion.value ? \'u-amo-required\' : \'\'">\n    <span ng-if="!$first"> AND </span>\n    <span ng-if="!itemGroup.inclusion.value">NOT </span>\n    <span ng-if="itemGroup.items.length>1">(</span><span ng-repeat="item in itemGroup.items"><span ng-if="!$first">, </span>{{getNodeLabel(item)}}</span><span ng-if="itemGroup.items.length>1">)</span>\n</span>',scope:{expression:"=?",getNodeLabel:"&label"}}}function a(e,t){e.$$ancestry=t&&t.$$ancestry?t.$$ancestry.concat(e):[e]}function n(e,t){function r(){t.$$children||(t.$$children=[],e.loadNodeChildren({node:t,cb:n}))}function n(e){t.$$children=e||[],o(t.$$children,i)}function i(){t.$$children.forEach(function(e){a(e,t)})}o(t,r)}function i(e,t,r){return r?angular.equals(r(e),r(t)):angular.equals(e,t)}function o(e,t){e.$promise?e.$promise.then(t):t()}angular.module("amoMillerColumnExpressionDirective",["ngDragDrop"]).directive("millerColumnExpression",e).directive("millerColumnExpressionSummary",t).directive("millerColumnExpressionQuietLabel",r);var s=function(e,t){return function(r){return i(r,e,t)}},l=function(e,t){return function(r){return!i(e,r,t)}}}(),function(){"use strict";function e(){return function(e,r,a){return angular.isArray(e)?t(e,r,a):angular.isObject(e)?i(e,r):angular.isUndefined(e)?s:e}}function t(e,t,i){return angular.isUndefined(t)?n(e):angular.isUndefined(i)?a(e,t):r(e,t,i)}function r(e,r,a){for(var n,i=0;i<e.length;i++){var l=e[i][r];if(angular.isArray(l)?l=t(l,a):l&&(l=l[a]),angular.isUndefined(n))n=l;else if(!angular.equals(n,l))return o}return angular.isUndefined(n)?s:n}function a(e,t){for(var r,a=0;a<e.length;a++)if(angular.isUndefined(r))r=e[a][t];else if(!angular.equals(r,e[a][t]))return o;return angular.isUndefined(r)?s:r}function n(e){for(var t,r=0;r<e.length;r++)if(angular.isUndefined(t))t=e[r];else if(!angular.equals(t,e[r]))return o;return angular.isUndefined(t)?s:t}function i(e,t){return angular.isUndefined(t)?e:angular.isUndefined(e[t])?s:e[t]}var o="Multiple",s="None";angular.module("amoMultipleFilter",[]).filter("multiple",e)}(),function(){"use strict";function e(e,t){function r(r,a,n,i){function o(e){return function(t,a,n,i){r.$apply(function(){e(r,{$event:i,$data:t,$dataIndex:a,$seriesIndex:n}),i.stopPropagation()})}}var s,l,c,u;if(!("ngCloudVizChartType"in n))throw new Error("ngCloudVizChart requires attribute directive ngCloudVizChartType");if(u=cloudViz[n.ngCloudVizChartType],!u||"function"!=typeof u)throw new Error('Unsupported chart type "'+n.ngCloudVizChartType+'" specified in ngCloudVizChartType. See https://git.corp.adobe.com/Coral/CloudViz/wiki#supported-chart-types');r.delegateEventTo=o,n.ngClick&&(s=e(n.ngClick)),n.ngMouseover&&(l=e(n.ngMouseover)),n.ngMouseleave&&(c=e(n.ngMouseleave)),r.$watch("model.data",function(e){var r;angular.isDefined(e)?r=angular.copy(i.$viewValue):(t.warn(n.ngCloudVizChartType+" chart options object is undefined. Defaulting to {}."),r={}),r.parent=a[0];var d=u(r);s&&d.on("click",o(s)),l&&d.on("mouseover",o(l)),c&&d.on("mouseleave",o(c)),d.render()})}return{restrict:"AE",require:"ngModel",scope:{model:"=ngModel"},link:r}}function t(){return{restrict:"A"}}function r(){function e(e){function t(t){e.defaultType=t}function r(t){function r(e){return function(t,r,a){var n=a.length;r>(n-1)/2&&(e.before=t+(e.before||0)),(n-1)/2>r&&(e.after=t+(e.after||0)),r===n-1&&(e.before=2*e.before/n,e.after=2*e.after/n,e.change=(e.after-e.before)/e.before)}}var a={};t.x.forEach(function(e,r){var n=t.series[r];n in a||(a[n]={data:[]}),a[n].data.push(t.y[r])});var n=0;for(var i in a)a[i].format=e.model.formats.y[n++],a[i].data.forEach(r(a[i]));e.tableData=a}if(e.changeChartType=t,e.chartTypeOptions=[{type:"bar",name:"Bar",icon:"coral-Icon--graphBarVertical"},{type:"line",name:"Line",icon:"coral-Icon--graphTrend"},{type:"table",name:"Table",icon:"coral-Icon--table"}],e.selectedChartOptions={chartType:e.chartTypeOptions.filter(function(t){return e.defaultType===t.type})[0]},void 0===e.showSettings)throw new Error("Default settings value is required.  Please pass either true or false for default settings");e.height=e.height?"height: "+e.height+"; ":"height: 400px; ",e.width=e.width?"width: "+e.width+"; ":"",e.dimensions=e.height+e.width,e.title||(e.title=""),e.$watch("model.data",r)}return{restrict:"AE",require:"ngModel",templateUrl:"components/shared/ngCloudViz/ng-cloud-viz-configurable-chart.html",scope:{id:"@",dateRangeOptions:"=",selectedDateRange:"=",metricOptions:"=",metrics:"=",defaultType:"@",showSettings:"=",height:"@",width:"@",title:"@",model:"=ngModel"},link:e}}function a(e,t,r){return function(a,n){if(e in n&&angular.isArray(n[e])){var i=angular.isDefined(t)?t:0,o=angular.isDefined(r)?r:n[e].length;n[e].slice(i,o).forEach(function(e,t){a[t]=e+(a[t]||0)})}return a}}function n(e,t,r){return function(a,n,i,o){if(e in n&&angular.isArray(n[e])){var s=angular.isDefined(t)?t:0,l=angular.isDefined(r)?r:n[e].length;n[e].slice(s,l).forEach(function(e,t){a[t]=e+(a[t]||0)})}var c=[];return i===o.length-1?a.forEach(function(e){c.push(e/(i+1))}):c=a,c}}function i(e,t,r){return function(a,n,i){e.x.push(r?r(a,n,i):n),e.y.push(a),e.series.push(t)}}function o(e){return function(t,r){var a=e||0;return moment().add(-(r+a),"days").seconds(0).milliseconds(0).toDate()}}angular.module("amoCloudVizDirective",[]).directive("ngCloudVizChart",e).directive("ngCloudVizChartType",t).directive("ngCloudVizConfigurableChart",r).value("byAccumulatingArrayProperty",a).value("byAveragingArrayProperty",n).value("pushAsDataPointIntoDataArray",i).value("turnIndexIntoDateByDaysAgo",o),e.$inject=["$parse","$log"]}(),function(){"use strict";function e(e,t,r,a,n){return e(t+a.userId()+"/display-offer-types/",{},{query:{method:"GET",isArray:!0,transformResponse:[n,r]}})}angular.module("amoOfferTypeService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("OfferType",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(){return function(e){return e?"On":"Off"}}angular.module("amoOnOffFilter",[]).filter("onOff",e)}(),function(){function e(){function e(e,r){function a(){var e=d.scrollLeft();d.animate({scrollLeft:e+250},300)}function n(){var e=d.scrollLeft();d.animate({scrollLeft:e-250},300)}function i(){c.removeClass(t),u.removeClass(t)}function o(){c.addClass(t),u.addClass(t)}function s(){return d[0].scrollWidth}function l(e){e>d.outerWidth()?i():o()}var c=r.find(".amosc-scrollTriangle--right"),u=r.find(".amosc-scrollTriangle--left");c.bind("click",a),u.bind("click",n);var d=r.find("[ng-transclude]").children().first();d.css("overflow-x","hidden"),e.$watch(s,l)}var t="makeInvisible";return{restrict:"A",priority:-1e3,transclude:!0,link:e,templateUrl:"components/shared/overflow-scroll-directive/overflow-scroll-template.html"}}angular.module("amoOverflowScrollDirective",[]).directive("overflowScroll",e)}(),function(){"use strict";function e(){return function(e){try{return angular.fromJson(e)}catch(t){return e}}}function t(){return function(e){var t;try{t="items"in e?e.items:e}catch(r){t=e}return t}}function r(){return function(e){function t(e){l.forEach(function(t){e[t.name]=t.generator()})}return angular.isArray(e)?e.forEach(t):t(e),e}}function a(){return function(e){return l.forEach(function(t){delete e[t.name]}),e}}function n(e,t){return Math.random()*(t-e)+e}function i(e,t){return Math.floor(Math.random()*(t-e))+e}function o(e,t){for(var r=[],a=0;e>a;a++)r.push(t());return r}angular.module("amoPagedResourceService",[]).service("fromJsonOrPassThrough",e).service("pagedResourceTransformResponse",t).service("fluff",r).service("unFluff",a);var s=14,l=[{name:"spark",generator:function(){return o(s,function(){return i(0,10)})}},{name:"eCPM",generator:function(){return o(s,function(){return n(.01,1)})}},{name:"wins",generator:function(){return o(s,function(){return n(.01,.03)})}},{name:"cost",generator:function(){return o(s,function(){return n(500/s,5e4/s)})}},{name:"impressions",generator:function(){return o(s,function(){return i(1e3/s,15e8/s)})}},{name:"clicks",generator:function(){return o(s,function(){return i(1,3e5/s)})}},{name:"active_ads",generator:function(){return i(1,10)}},{name:"active_creatives",generator:function(){return i(0,55)}},{name:"adType",generator:function(){return"RTB"}},{name:"mockStartDate",generator:function(){var e=new Date,t=e.getTime(),r=t-1e4*i(0,9999999);return new Date(r)}},{name:"cpc",generator:function(){return o(s,function(){return n(0/s,2/s)})}},{name:"mockPortfolio",generator:function(){var e=["Aggressive","Conservative"],t=i(0,e.length-1),r=e[t];return r}},{name:"mockRTBSource",generator:function(){var e=["RTB","FBX"],t=i(0,e.length-1),r=e[t];return r}},{name:"creativeApprovalStatus",generator:function(){var e=["APPROVED","REJECTED","PENDING","DELETED"],t=i(0,e.length-1),r=e[t];return r
}}]}(),function(){"use strict";function e(){var e=1e3,t=1e6;return function(r,a){var n,i=Math.pow(10,a||0);return n=r>=t?Math.round(r/(t/i))/i+"M":r>=e?Math.round(r/(e/i))/i+"K":r}}angular.module("amoPlaceValueFilter",[]).filter("placeValue",e)}(),function(){"use strict";function e(){function e(){function e(){r(!1)}function t(){r(!1),a.submitCallback()}function r(e){a.visible=e}var a=this;if(a.close=e,a.submit=t,!a.submitCallback||!angular.isFunction(a.submitCallback))throw new Error('Mandatory attribute "submit-callback" is missing.')}return{restrict:"E",templateUrl:"components/shared/popover-wrapper/popover-wrapper.html",controllerAs:"vm",bindToController:!0,controller:e,transclude:!0,scope:{visible:"=",submitCallback:"=",customStyle:"=",popoverTitle:"@",submitText:"@"}}}angular.module("amoPopoverWrapperDirective",[]).directive("amoPopoverWrapper",e)}(),function(){function e(e,t,r){return e(t+r.userId()+"/display-portfolios/:id")}angular.module("amoPortfolioService",["ngResource","amoEnvironmentConfiguration","amoUserInfoService"]).factory("Portfolio",e),e.$inject=["$resource","API_PATH","userInfoService"]}(),function(){function e(e){function t(t,r,a){var n=a.quietForm,i=a.quietRole,o=e.getControlGroup(n);if("wrapper"===i)r.bind("click",function(){e.showControlGroup(n,!0)}),t.$on("$destroy",function(){e.removeControlGroup(n)});else if("controlWrapper"===i)o.setControlWrapper(r);else if("label"===i)o.setLabel(r);else{if("control"!==i)throw"Error: A quiet form cannot be instantiated for the given role: "+i+'. A role can be one of "wrapper", "label", "controlWrapper", or "control"';var s=function(){e.hideAll(n),o.showControl()};r.bind("focus",s),r.children().bind("focus",s),o.addControl(r)}}return{restrict:"A",priority:-1e3,link:t}}function t(){function e(e,a){r(e);var n=t(e);return n.showControl(a)}function t(e){return o[e]||(o[e]=new i)}function r(e){for(var r in o)o.hasOwnProperty(r)&&r!==e&&t(r).showLabel()}function a(e){delete o[e]}function n(){return o}function i(){function e(e){this.controls.push(e)}function t(e){e&&this.controls[0]&&this.controls[0][0]&&!this.label.hasClass(s)&&this.controls[0][0].focus(),this.controlWrapper.removeClass(s),this.label.addClass(s),this.controlWrapper.has("miller-column, miller-column-expression").length&&this.controlWrapper.find(".amosc-MillerColumn--wrapper, .amosc-MillerColumnExpression--wrapper").addClass(l)}function r(){this.label.removeClass(s),this.controlWrapper.addClass(s),this.controlWrapper.has("miller-column, miller-column-expression").length&&this.controlWrapper.find(".amosc-MillerColumn--wrapper, .amosc-MillerColumnExpression--wrapper").removeClass(l)}function a(e){this.controlWrapper=e,this.controlWrapper.addClass(s)}function n(e){this.label=e}this.label={},this.controls=[],this.controlWrapper={},this.addControl=e,this.showControl=t,this.setLabel=n,this.showLabel=r,this.setControlWrapper=a}var o={},s="makeInvisible",l="isVisible";return{showControlGroup:e,getControlGroup:t,hideAll:r,removeControlGroup:a,getControlGroupStore:n}}angular.module("amoQuietFormDirective",[]).directive("quietForm",e).service("QuietFormService",t),e.$inject=["QuietFormService"]}(),function(){function e(e,t,r,a,n){return e(t+a.userId()+"/display-rtb-sources",{},{get:{method:"GET",isArray:!0,transformResponse:[n,r],cache:!0}})}angular.module("amoRtbSourceService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("RtbSource",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){"use strict";function e(e,t,r,a,n){function i(e){return e[0]}return e(t+a.userId()+"/display-segments/:type",{},{query:{method:"GET",url:t+a.userId()+"/display-segments",isArray:!0,transformResponse:[n,r]},get:{method:"GET",url:t+a.userId()+"/display-segments/:type/:id",isArray:!0,transformResponse:[n,r]},reach:{method:"GET",url:t+a.userId()+"/display-segments/:type/reach"},lookup:{method:"GET",url:t+a.userId()+"/display-segments",cache:!0,transformResponse:[n,r,i]},type:{method:"GET",url:t+a.userId()+"/display-segments"}})}angular.module("amoSegmentService",["ngResource","amoEnvironmentConfiguration","amoPagedResourceService","amoUserInfoService"]).factory("Segment",e),e.$inject=["$resource","API_PATH","pagedResourceTransformResponse","userInfoService","fromJsonOrPassThrough"]}(),function(){function e(e,t){function r(r,a,n){var i=t(n.setFocus);r.$watch(i,function(t){t&&e(function(){a[0].focus()})})}return{restrict:"A",link:r}}angular.module("amoSetFocusDirective",[]).directive("setFocus",e),e.$inject=["$timeout","$parse"]}(),function(){"use strict";function e(e){function t(){return c}function r(e){c=e}function a(t){var r="endor-Panel-content--actionBarHeight";t.toggleVisibility();var a=e.find(".js-endor-content"),n=t.toggleVisibility;t.toggleVisibility=function(){a.toggleClass(r),n.apply(t)};var i=t.show;t.show=function(){a.addClass(r),i.apply(t)};var o=t.hide;t.hide=function(){a.removeClass(r),o.apply(t)}}function n(e){var t=e.setActivePanelId;e.setActivePanelId=function(r){var a=e.getActivePanelId(),n=r;(angular.isUndefined(r)||a===r)&&(n=""),t.apply(e,[n])}}function i(e){var t=(new Date).getFullYear();e.$element[0].innerHTML=e.$element[0].innerHTML.replace(/\d{4}/,t)}var c=!0,u={defaultBlackBarTitle:"",getShowPagePadding:t,setShowPagePadding:r};return o.forEach(function(e){s.forEach(function(t){u[t+e]=function(){var r=[].slice.call(arguments);return r.splice(0,0,CUI[e]),CUI.Endor.registry[t].apply(CUI.Endor.registry,r)}}),l.forEach(function(t){u[t+e]=function(){var r=[].slice.call(arguments);return r.push(CUI[e]),CUI.Endor.registry[t].apply(CUI.Endor.registry,r)}})}),u.resolveActionBar(a),u.resolveInnerRail(n),u.resolveFooter(i),u}function t(e,t){function r(r,a,n){var i=e.getActionBar();i&&(t(n.showActionBar)()?i.show():i.hide())}return{link:r}}function r(e){function t(t,r,a,n,i){function o(){u.removeItem(c)}function s(e,t){u.addItem(e,{right:!!a.right}),c=e,l=t}var l,c,u=e.getActionBar();i(t,s),t.$on("$destroy",o)}return{transclude:"element",link:t}}function a(e){function t(t,r,a,n,i){function o(){u.removePanel(c)}function s(e,t){u.addPanel(e),c=e,l=t}var l,c,u=e.getInnerRail();i(t,s),t.$on("$destroy",o)}return{transclude:"element",link:t}}function n(e){function t(t,r,a){var n=e.getBlackBar();n.setTitle(a.shellPageTitle||e.defaultBlackBarTitle),t.$on("$destroy",function(){e.getBlackBar().setTitle(e.defaultBlackBarTitle)})}return{link:t}}function i(e){function t(t){e.setShowPagePadding(t.shellPagePadding),t.$on("$destroy",function(){e.setShowPagePadding(!0)})}return{link:t,scope:{shellPagePadding:"="}}}angular.module("amoShellService",[]).service("Shell",e).directive("showActionBar",t).directive("actionBarItem",r).directive("innerRailPanel",a).directive("shellPageTitle",n).directive("shellPagePadding",i);var o,s,l;o=["ActionBar","BlackBar","Brand","BreadcrumbBar","Crumbs","Footer","InnerRail","InnerRailToggle","NavigationView","OuterRail","OuterRailToggle"],s=["get","has","reset","resolve"],l=["register","unregister"],e.$inject=["$document"],t.$inject=["Shell","$parse"],r.$inject=["Shell"],a.$inject=["Shell"],n.$inject=["Shell"],i.$inject=["Shell"]}(),function(){"use strict";function e(){var e=function(e,t){function r(e){e&&angular.isUndefined(n.autoHide)&&n.autoHide!==!1&&t(a,1e4)}function a(){n.state=!1}var n=this;n.stateChange=r,n.timeoutHide=a,n.type="success",e.$watch("statusBarInfo.state",r)};return{restrict:"E",templateUrl:"components/shared/status-bar-directive/status-bar-directive.html",controllerAs:"statusBarInfo",bindToController:!0,controller:["$scope","$timeout",e],scope:{title:"=",message:"=",state:"=",type:"=",closeable:"=",autoHide:"="}}}angular.module("amoStatusBarDirective",[]).directive("statusBar",e)}(),function(){function e(){return t}function t(e){{var t=[],n=e.targets;n.geoTargets}return t=t.concat(r(n,"geoTargets","name")),t=t.concat(a(n.languages,"name")),t=t.concat(r(n,"categoryTargets","name")),t=t.concat(a(n.devices,"name")),t=$.grep(t,function(e){return e}),t.join(", ")}function r(e,t,r){return e[t]&&e[t].included?a(e[t].included,r):""}function a(e,t){for(var r=[],a=0;a<e.length;a++)r.push(e[a][t]);return r}angular.module("amoTargetingSummaryFilter",[]).filter("TargetingSummary",e)}(),function(){function e(){function e(e){return t.test(e)}var t=/^(https?:\/{2})?(([a-zA-Z]([a-zA-Z]|\d|[\$\-\_\@\&\+\-\!\*\"\'\(\)\,]|(%([a-fA-F]|\d){2}))*)(\.([a-zA-Z]([a-zA-Z]|\d|[\$\-\_\@\&\+\-\!\*\"\'\(\)\,]|(%([a-fA-F]|\d){2}))*)){0,2}|(\d+(\.\d+){3}))(\/([a-zA-Z]|\d|[\$\-\_\@\&\+\-\!\*\"\'\(\)\,\+\.]|(%([a-fA-F]|\d){2}))+){0,2}\/?$/;return{isValid:e}}angular.module("amoUrlService",[]).service("AmoUrlService",e)}(),function(){"use strict";function e(){function e(e){return angular.isDefined(e)&&(t.webUserId=e),t.webUserId}function r(e){return angular.isDefined(e)&&(t.userId=e),t.userId}function a(e){return angular.isDefined(e)&&(t.role=e),t.role}return{webUserId:e,userId:r,role:a}}angular.module("amoUserInfoService",[]).factory("userInfoService",e);var t={}}(),function(){"use strict";function e(e,t,r,a,n,i,o,s,l,c,u,d,m,g){function p(e){return function(o,s){var l=s&&s.range||void 0;t.query(function(t){var o={x:[],y:[],series:[]},c=[];I.metrics[e].forEach(function(e){if(e.selected){var s="percent"!=e.format?r:a;l?t.reduce(s(e.id,l[0],l[1]),[]).forEach(n(o,e.name,i(l[0]))):t.reduce(s(e.id),[]).forEach(n(o,e.name,i())),c.push(e.format)}}),I.cvOptions[e].data=o,I.cvOptions[e].formats.y=c,I.cvOptions[e].dualYAxis=c.length>1,I.selectedDateRange[e]=s})}}function f(e){s.go("display-ad-details",{campaignId:e.campaignId})}function v(e,t){var r=angular.element(e.target).scope();I.columns[r.$index].width=t.size.width+"px"}function h(e){return e.reduce(function(e,t){return e+t},0)}function y(e){I.labelClickFunctionBuilder(e.id)()}function C(){I.campaignsDatasource.params.filters="campaignName:CONTAINS:"+I.selectCampaignModal.query}function S(e){var t=!0;if(I.filters.length){var r=d(I.filters,e);r.length>0&&(t=!1,I.adStrategiesDatasource.params.filters=r)}t===!0&&delete I.adStrategiesDatasource.params.filters}function b(e){var t=I.filters[e];if(I.parentObjectRestriction=null,I.campaignIdFilterDisplayOverride)for(var r in I.campaignIdFilterDisplayOverride)r===t.property&&(I.parentObjectRestriction=r);I.filters.splice(e,1),S(I.campaignIdFilterDisplayOverride),I.parentObjectRestriction&&(delete I.$stateParams[I.parentObjectRestriction],I.$state.transitionTo("display-ad-strategies-grid",I.$stateParams,{reload:!0,inherit:!1,notify:!0}))}function A(){return angular.toJson(I.adStrategiesDatasource.params)}function w(){return I.selectCampaignModal.query}function T(e,t){return function(r){var a=t||r.id,n=e?a:a+"Desc";I.adStrategiesDatasource.params.sort===n?delete I.adStrategiesDatasource.params.sort:I.adStrategiesDatasource.params.sort=n}}var I=this;I.parentObjectRestriction=null,I.showOnlyActiveOnLoad=s.params.idsOnTop?!1:!0,I.filter=S,I.filterOperators=m,I.filters=[],I.campaignIdFilterById={property:"campaignIds",operator:"EQUALS",value:s.params.campaignIds},I.campaignIdFilterDisplayOverride=null,I.removeFilter=b,I.$stateParams=g,I.$state=s,I.sum=h,I.Shell=o,I.adStrategiesDatasource=e,I.adStrategiesDatasource.revision=A,I.campaignsDatasource=c,I.campaignsDatasource.revision=w,I.resizeColumnOptions={containment:"parent",stop:v},I.activeCampaign=l.get({campaignId:s.params.campaignIds},function(e){e.id&&(I.campaignIdFilterDisplayOverride={campaignIds:{property:"Campaign Name",operator:"=",value:I.activeCampaign.campaignName}},I.filters.push(I.campaignIdFilterById)),I.filter(I.campaignIdFilterDisplayOverride)}),I.metrics=[[{id:"eCPM",name:"eCPM",selected:!1,format:"currency"},{id:"wins",name:"Wins",selected:!1,format:"percent"},{id:"cost",name:"Cost",selected:!0,format:"currency"},{id:"impressions",name:"Impressions",selected:!0,format:"decimal"},{id:"clicks",name:"Clicks",selected:!1,format:"decimal"}],[{id:"eCPM",name:"eCPM",selected:!0,format:"currency"},{id:"wins",name:"Wins",selected:!0,format:"percent"},{id:"cost",name:"Cost",selected:!0,format:"currency"},{id:"impressions",name:"Impressions",selected:!0,format:"decimal"},{id:"clicks",name:"Clicks",selected:!0,format:"decimal"}]],I.dateRangeOptions=[[{id:"today",name:"Today",action:p(0),range:[0,1]},{id:"yesterday",name:"Yesterday",action:p(0),range:[0,2]},{id:"2days",name:"2 days ago",action:p(0),range:[0,3]},{id:"7days",name:"Last 7 days",action:p(0),range:[0,7]},{id:"week",name:"Last week",action:p(0),range:[7,14]},{id:"adStrategy",name:"Ad Strategy start to today",action:p(0)}],[{id:"weekly",name:"Weekly",action:p(1)}]],I.selectedDateRange=[],I.setupChart=p,I.cvOptions=[{dualYAxis:!0,autoResize:!0,interactive:!0,formats:{x:"time",y:[]}},{dualYAxis:!0,autoResize:!0,interactive:!0,formats:{x:"time",y:[]}}],I.dateRangeOptions.forEach(function(e,t){I.selectedDateRange[t]=e[e.length-1],I.setupChart(t)(null,I.selectedDateRange[t]),u.$watch(function(){return angular.toJson(I.metrics[t])},function(){I.setupChart(t)(null,I.selectedDateRange[t])})}),I.selectCampaignModal={visible:!1,query:"",activeCampaign:I.activeCampaign,campaigns:[],updateCampaigns:C},I.columns=[{id:"status",name:"Status",width:"40px",minWidth:"40px",alignLeft:!0,format:{type:"status"},contextMenu:[{name:"Sort Ascending",iconCls:"arrowUp",action:T(!0)},{name:"Sort Descending",iconCls:"arrowDown",action:T(!1)}]},{id:"adStrategyName",name:"Ad Name",width:"175px",minWidth:"175px",alignLeft:!0,flexGrow:5,format:{type:"adStrategyUrl"},contextMenu:[{name:"Sort Ascending",iconCls:"arrowUp",action:T(!0)},{name:"Sort Descending",iconCls:"arrowDown",action:T(!1)}]},{id:"activeCreatives",name:"Active Creatives",width:"40px",minWidth:"40px",maxWidth:"100px",alignRight:!0,flexGrow:4,format:{type:"integer"}},{id:"mockRTBSource",name:"RTB Source",width:"90px",minWidth:"90px",alignLeft:!0,format:{type:"string"}},{id:"spark",name:"7-day",width:"75px",minWidth:"75px",alignCenter:!0,format:{type:"sparkline"}},{id:"baseBid",name:"Current CPM Bid",width:"100px",minWidth:"100px",alignRight:!0,flexGrow:2,format:{type:"baseBid"},contextMenu:[{name:"Sort Ascending",iconCls:"arrowUp",action:T(!0,"bid")},{name:"Sort Descending",iconCls:"arrowDown",action:T(!1,"bid")}]},{id:"cost",name:"Cost",width:"75px",minWidth:"75px",alignRight:!0,flexGrow:2,format:{type:"currency"}},{id:"impressions",name:"Impressions",width:"100px",minWidth:"100px",alignRight:!0,flexGrow:2,format:{type:"integerSum"}},{id:"clicks",name:"Clicks",width:"75px",minWidth:"75px",alignRight:!0,flexGrow:2,format:{type:"integerSum"}},{id:"eCPM",name:"eCPM",width:"40px",minWidth:"40px",alignRight:!0,format:{type:"currency"}},{id:"cpc",name:"CPC",width:"40px",minWidth:"40px",alignRight:!0,format:{type:"currency"}},{id:"wins",name:"Win Rate",width:"75px",minWidth:"75px",alignRight:!0,format:{type:"percentage"}}],I.contextMenu=[{name:"Edit",iconCls:"edit",action:f},{name:"View Creatives",iconCls:"viewOn",action:y}],I.labelClickFunctionBuilder=function(e){return function(){s.go("display-ad-theme-creatives-grid",{adStrategyIds:e})}},I.showOnlyActiveOnLoad&&(I.filters.push({property:"status",operator:"EQUALS",value:"active"}),I.filter())}angular.module("amoDisplayAdStrategiesGridController",["amoAdStrategyService","amoCurrencyService","ui.router","amoCloudVizDirective","amoShellService","ui.scroll","ngDragDrop","amoResizableColumnHeaderDirective","amoCampaignService","amoGridFilters"]).controller("DisplayAdStrategiesController",e),e.$inject=["AdStrategyDataSource","AdStrategy","byAccumulatingArrayProperty","byAveragingArrayProperty","pushAsDataPointIntoDataArray","turnIndexIntoDateByDaysAgo","Shell","$state","Campaign","CampaignDataSource","$scope","gridFilterUrlParamFilter","gridFilterOperators","$stateParams"]}(),function(){function e(e,t,r,a,n,i,o,s,l,c,u,d,m){function g(e,t){var r=angular.element(e.target).scope();S.columns[r.$index].width=t.size.width+"px"}function p(e){return e.reduce(function(e,t){return e+t},0)}function f(e){return function(o,s){var l=s&&s.range||void 0;t.query(function(t){var o={x:[],y:[],series:[]},c=[];S.metrics[e].forEach(function(e){if(e.selected){var s="percent"!=e.format?r:a;l?t.reduce(s(e.id,l[0],l[1]),[]).forEach(n(o,e.name,i(l[0]))):t.reduce(s(e.id),[]).forEach(n(o,e.name,i())),c.push(e.format)}}),S.cvOptions[e].data=o,S.cvOptions[e].formats.y=c,S.cvOptions[e].dualYAxis=c.length>1,S.selectedDateRange[e]=s})}}function v(){S.selectAdStrategyModal.adStrategies=c.query({filter:"adStrategyName:CONTAINS:"+S.selectAdStrategyModal.query,pageSize:10})}function h(e){var t=!0;if(S.filters.length){var r=u(S.filters,e);r.length>0&&(t=!1,S.adThemeCreativesDatasource.params.filters=r)}t===!0&&delete S.adThemeCreativesDatasource.params.filters}function y(e){var t=S.filters[e];if(S.parentObjectRestriction=null,S.adStrategyIdFilterDisplayOverride)for(var r in S.adStrategyIdFilterDisplayOverride)r===t.property&&(S.parentObjectRestriction=r);S.filters.splice(e,1),h(S.adStrategyIdFilterDisplayOverride),S.parentObjectRestriction&&(delete S.$stateParams[S.parentObjectRestriction],S.$state.transitionTo("display-ad-theme-creatives-grid",S.$stateParams,{reload:!0,inherit:!1,notify:!0}))}function C(){return angular.toJson(S.adThemeCreativesDatasource.params)}var S=this;S.parentObjectRestriction=null,S.showOnlyActiveOnLoad=s.params.idsOnTop?!1:!0,S.filter=h,S.filterOperators=d,S.filters=[],S.adStrategyIdFilterById={property:"adStrategyIds",operator:"EQUALS",value:s.params.adStrategyIds},S.adStrategyIdFilterDisplayOverride=null,S.removeFilter=y,S.$stateParams=m,S.$state=s,S.sum=p,S.Shell=o,S.adThemeCreativesDatasource=e,S.adThemeCreativesDatasource.params.sort="creationTimeDesc",S.adThemeCreativesDatasource.revision=C,S.activeAdStrategy=c.get({id:s.params.adStrategyIds},function(e){e.id&&(S.adStrategyIdFilterDisplayOverride={adStrategyIds:{property:"Ad Strategy Name",operator:"=",value:S.activeAdStrategy.adStrategyName}},S.filters.push(S.adStrategyIdFilterById)),S.filter(S.adStrategyIdFilterDisplayOverride)}),S.resizeColumnOptions={containment:"parent",stop:g},S.metrics=[[{id:"eCPM",name:"eCPM",selected:!1,format:"currency"},{id:"wins",name:"Wins",selected:!1,format:"percent"},{id:"cost",name:"Cost",selected:!0,format:"currency"},{id:"impressions",name:"Impressions",selected:!0,format:"decimal"},{id:"clicks",name:"Clicks",selected:!1,format:"decimal"}],[{id:"eCPM",name:"eCPM",selected:!0,format:"currency"},{id:"wins",name:"Wins",selected:!0,format:"percent"},{id:"cost",name:"Cost",selected:!0,format:"currency"},{id:"impressions",name:"Impressions",selected:!0,format:"decimal"},{id:"clicks",name:"Clicks",selected:!0,format:"decimal"}]],S.dateRangeOptions=[[{id:"today",name:"Today",action:f(0),range:[0,1]},{id:"yesterday",name:"Yesterday",action:f(0),range:[0,2]},{id:"2days",name:"2 days ago",action:f(0),range:[0,3]},{id:"7days",name:"Last 7 days",action:f(0),range:[0,7]},{id:"week",name:"Last week",action:f(0),range:[7,14]},{id:"creative",name:"Creative start to today",action:f(0)}],[{id:"weekly",name:"Weekly",action:f(1)}]],S.selectAdStrategyModal={visible:!1,query:"",activeAdStrategy:S.activeAdStrategy,adStrategies:[],updateAdStrategies:v},S.selectedDateRange=[],S.setupChart=f,S.cvOptions=[{dualYAxis:!0,autoResize:!0,interactive:!0,formats:{x:"time",y:[]}},{dualYAxis:!0,autoResize:!0,interactive:!0,formats:{x:"time",y:[]}}],S.dateRangeOptions.forEach(function(e,t){S.selectedDateRange[t]=e[e.length-1],S.setupChart(t)(null,S.selectedDateRange[t]),l.$watch(function(){return angular.toJson(S.metrics[t])},function(){S.setupChart(t)(null,S.selectedDateRange[t])})}),S.columns=[{id:"name",name:"Creatives",width:"300px",minWidth:"300px",flexGrow:10,alignLeft:!0},{id:"creativeSize",name:"Size",width:"50px",minWidth:"50px",maxWidth:"60px",alignLeft:!0,format:{type:"creativeSize"}},{id:"creativeType",name:"Creative Type",width:"50px",minWidth:"60px",maxWidth:"80px",alignLeft:!0},{id:"status",name:"Status",width:"20px",minWidth:"20px",maxWidth:"50px",alignLeft:!0,format:{type:"status"}},{id:"creativeApprovalStatus",name:"Approval Status",width:"85px",minWidth:"85px",alignLeft:!0,format:{type:"creativeApprovalStatus"}},{id:"cost",name:"Cost",width:"75px",minWidth:"75px",alignRight:!0,flexGrow:1,format:{type:"currency"}},{id:"impressions",name:"Impressions",width:"75px",minWidth:"75px",alignRight:!0,flexGrow:1,format:{type:"integerSum"}},{id:"clicks",name:"Clicks",width:"50px",minWidth:"40px",maxWidth:"60px",alignRight:!0,format:{type:"integerSum"}},{id:"eCPM",name:"eCPM",width:"50px",minWidth:"40px",maxWidth:"60px",alignRight:!0,format:{type:"currency"}},{id:"cpc",name:"CPC",width:"50px",minWidth:"40px",maxWidth:"60px",alignRight:!0,format:{type:"currency"}}],S.showOnlyActiveOnLoad}angular.module("amoDisplayAdThemeCreativesGridController",["amoAdThemeCreativesService","amoCurrencyService","ui.router","amoCloudVizDirective","amoShellService","ui.scroll","ngDragDrop","amoResizableColumnHeaderDirective","amoAdStrategyService","amoGridFilters"]).controller("DisplayAdThemeCreativesGridController",e),e.$inject=["AdThemeCreativesDataSource","AdThemeCreativesService","byAccumulatingArrayProperty","byAveragingArrayProperty","pushAsDataPointIntoDataArray","turnIndexIntoDateByDaysAgo","Shell","$state","$scope","AdStrategy","gridFilterUrlParamFilter","gridFilterOperators","$stateParams"]}(),function(){"use strict";function e(e,t,r,a,n,i,o,s,l){function c(e){f.labelClickFunctionBuilder(e)()}function u(t){e.go("display-campaign",{campaignId:t})}function d(){for(var e,r=((new Date).getTime(),1);r<=t.campaignList.items.length;r++){var a=r-1,n=t.campaignList.items[a],i=n.maxBudget;e=Math.random(),f.rows.push([n.id,n.status,n.campaignName,n.activeAds,n.portfolioName,i.amount])}t.manageReportService=["reload"]}function m(e){return function(t){t.statusText=e,alert("Error occurred: "+t.statusText)}}function g(e,t,r,a){var n=[new a.ColumnMetadata({name:"campaignId",type:"id",visible:!1},0),new a.ColumnMetadata({name:"status",label:"Status",type:"str",width:72,visible:!0},1),new a.ColumnMetadata({name:"campaignName",label:"Campaign",type:"str",width:250,visible:!0},2),new a.ColumnMetadata({name:"activeAds",label:"Active Ads",type:"int",width:60,visible:!0},3),new a.ColumnMetadata({name:"portFolio",label:"Portfolio",type:"str",width:250,visible:!0,format:1},4),new a.ColumnMetadata({name:"maxBudget",label:"Max Budget",type:"curr",width:null,visible:!0,format:1},5)],i=new a.ColumnsConfiguration([new a.ColumnLayoutData({name:"status",width:90,alignment:"center"}),new a.ColumnLayoutData({name:"campaignName",minWidth:225}),new a.ColumnLayoutData({name:"activeAds",minWidth:55}),new a.ColumnLayoutData({name:"portFolio",minWidth:225}),new a.ColumnLayoutData({name:"maxBudget",width:80,format:3})]);e[t]=r,r.columns.metadata=n,r.columns.layout=i}function p(e,t,r){e.staticGridDataSource=r(v,h),e.staticGridSelectionState=null,g(e,"staticGridConfig",y,t)}var f=this;t.manageReportService="",n.setScope(t),f.labelClickFunctionBuilder=function(t){return function(){e.go("display-ad-strategies-grid",{campaignIds:t})}},f.campaignNameContextMenu=[{name:"Edit",iconCls:"edit",action:u},{name:"View Ads",iconCls:"viewOn",action:c}],t.numRows=null,f.campaign=s,f.rows=[],t.campaignList=null,t.inlineEditBudget=5e3;var v=({GRID:r.CONSTANTS,DATA_SOURCE:l},function(){return t.campaignList=s.get({pageSize:50},d,m("We were unable to retrieve your campaign.")),f.rows}()),h=[],y={grid:{id:"staticDataGrid",getNumberOfRows:!0,showSelectionColumn:"left",sortColumns:["a","b"]},columns:{layout:null,metadata:null},scroller:{},labels:{includeSummaryRow:!0},summary:{},body:{includeSummaryRow:!0,row:{selectionRule:"many",cell:{customHtml:{status:n.getStatusHtml,campaignName:[n.getCampaignNameGridBodyContextMenu,{labelClickFunctionBuilder:f.labelClickFunctionBuilder,contextMenu:f.campaignNameContextMenu,clickTextDataColumnPosition:0,contextMenuClickDataColumnPosition:0}],maxBudget:[n.getBudgetEditControl,{idPosition:0,maxBudgetColumnPosition:5,inlineEditBudgetModelName:"inlineEditBudget",editBudgetCallback:"editBudgetCallback()"}]}}}},footer:null};p(t,r,o),t.$on("updateCampaignGridData",function(){t.staticGridDataSource.reset(v,h),t.manageReportService=["reload"]})}angular.module("amoDisplayCampaignGridController",["ui.router","amoCloudVizDirective","UtilitiesModule","DataSourcesModule","amoDisplayCampaignGridHeaderDirective","amoJavaReportServiceLocatorService","LocalizationModule","StandardControlsModule","amoCampaignService"]).controller("DisplayCampaignGridController",e),e.$inject=["$state","$scope","CuiGridSupportClassesFactory","ReportServiceFactory","JavaReportServiceLocator","CuiGridUtilities","ArrayDataSourceFactory","Campaign","DataSourcesConstants"]}(),function(){"use strict";function e(e,t){function r(r){function a(e){return r.groupOperations.createNewPopover=!1,r.groupOperations.campaignActionsState=!1,e.action()}function n(){r.groupOperations.campaignActionsState=!r.groupOperations.campaignActionsState}function i(){--p,f===!0&&0===p&&r.$emit("updateCampaignGridData","reload")}function o(e){e.status=g,e.$save({campaignId:e.id},i)}function s(e,t,r){for(var a=0;a<e.length;a++){var n=e[a];if(n){var i=n[0];i&&t(i,n)}}r()}function l(t){p=0,f=!1,s(t,function(t,r){r[1]=g,++p,e.get({campaignId:t},o)},function(){f=!0})}function c(){var e=m[1],r=[];s(e,function(e){r.push(e)},function(){r.length>0&&(1==r.length?t.go("display-campaign",{campaignId:r[0]}):alert("Not able to multi edit yet."))})}function u(){var e=m[1];g="active",l(e)}function d(){var e=m[1];g="paused",l(e)}var m=[],g="active",p=0,f=0;r.groupOperations={},r.groupOperations.executeMenuItem=a,r.groupOperations.toggleActionsState=n,r.groupOperations.campaignActionsState=!1,r.groupOperations.activateSelectedRows=u,r.groupOperations.pauseSelectedRows=d,r.groupOperations.editSelectedRows=c,r.groupOperations.allRowsSelected=!1,r.groupOperations.campaignActionItems=[{name:"Edit",iconCls:"edit",action:c},{name:"Activate",iconCls:"playCircle",action:u},{name:"Pause",iconCls:"pauseCircle",action:d},{name:"Delete",iconCls:"delete",action:angular.noop},{name:"Report",iconCls:"revenue",action:angular.noop}];var v=function(e){m=e.getSelectedRows()};r.$on("cuiGrid-selectionStateUpdated",function(e,t){v(t)})}return r.$inject=["$scope"],{templateUrl:"components/display/grids/java-report-service/campaign-grids/display-campaign-grid-header.html",restrict:"E",controller:r,controllerAs:"campaignGridHeaderDirectiveCtrl",scope:!1}}angular.module("amoDisplayCampaignGridHeaderDirective",["amoCampaignService","ui.router"]).directive("amoCampaignGridHeader",e),e.$inject=["Campaign","$state"]}();