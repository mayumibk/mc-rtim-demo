/*!
 * jQuery JavaScript Library v1.8.1
 * http://jquery.com/
 *
 * Includes Sizzle.js
 * http://sizzlejs.com/
 *
 * Copyright 2012 jQuery Foundation and other contributors
 * Released under the MIT license
 * http://jquery.org/license
 *
 * Date: Thu Aug 30 2012 17:17:22 GMT-0400 (Eastern Daylight Time)
 */
(function(a6,aF){var A,aj,q=a6.document,aM=a6.location,f=a6.navigator,bk=a6.jQuery,M=a6.$,aq=Array.prototype.push,a8=Array.prototype.slice,aO=Array.prototype.indexOf,D=Object.prototype.toString,Z=Object.prototype.hasOwnProperty,aS=String.prototype.trim,bK=function(b3,b4){return new bK.fn.init(b3,b4,A)
},bB=/[\-+]?(?:\d*\.|)\d+(?:[eE][\-+]?\d+|)/.source,ae=/\S/,aZ=/\s+/,G=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,bs=/^(?:[^#<]*(<[\w\W]+>)[^>]*$|#([\w\-]*)$)/,a=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,bj=/^[\],:{}\s]*$/,bm=/(?:^|:|,)(?:\s*\[)+/g,bH=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,a4=/"[^"\\\r\n]*"|true|false|null|-?(?:\d\d*\.|)\d+(?:[eE][\-+]?\d+|)/g,bT=/^-ms-/,aY=/-([\da-z])/gi,R=function(b3,b4){return(b4+"").toUpperCase()
},aJ=function(){if(q.addEventListener){q.removeEventListener("DOMContentLoaded",aJ,false);
bK.ready()
}else{if(q.readyState==="complete"){q.detachEvent("onreadystatechange",aJ);
bK.ready()
}}},ad={};
bK.fn=bK.prototype={constructor:bK,init:function(b3,b7,b6){var b5,b8,b4,b9;
if(!b3){return this
}if(b3.nodeType){this.context=this[0]=b3;
this.length=1;
return this
}if(typeof b3==="string"){if(b3.charAt(0)==="<"&&b3.charAt(b3.length-1)===">"&&b3.length>=3){b5=[null,b3,null]
}else{b5=bs.exec(b3)
}if(b5&&(b5[1]||!b7)){if(b5[1]){b7=b7 instanceof bK?b7[0]:b7;
b9=(b7&&b7.nodeType?b7.ownerDocument||b7:q);
b3=bK.parseHTML(b5[1],b9,true);
if(a.test(b5[1])&&bK.isPlainObject(b7)){this.attr.call(b3,b7,true)
}return bK.merge(this,b3)
}else{b8=q.getElementById(b5[2]);
if(b8&&b8.parentNode){if(b8.id!==b5[2]){return b6.find(b3)
}this.length=1;
this[0]=b8
}this.context=q;
this.selector=b3;
return this
}}else{if(!b7||b7.jquery){return(b7||b6).find(b3)
}else{return this.constructor(b7).find(b3)
}}}else{if(bK.isFunction(b3)){return b6.ready(b3)
}}if(b3.selector!==aF){this.selector=b3.selector;
this.context=b3.context
}return bK.makeArray(b3,this)
},selector:"",jquery:"1.8.1",length:0,size:function(){return this.length
},toArray:function(){return a8.call(this)
},get:function(b3){return b3==null?this.toArray():(b3<0?this[this.length+b3]:this[b3])
},pushStack:function(b4,b6,b3){var b5=bK.merge(this.constructor(),b4);
b5.prevObject=this;
b5.context=this.context;
if(b6==="find"){b5.selector=this.selector+(this.selector?" ":"")+b3
}else{if(b6){b5.selector=this.selector+"."+b6+"("+b3+")"
}}return b5
},each:function(b4,b3){return bK.each(this,b4,b3)
},ready:function(b3){bK.ready.promise().done(b3);
return this
},eq:function(b3){b3=+b3;
return b3===-1?this.slice(b3):this.slice(b3,b3+1)
},first:function(){return this.eq(0)
},last:function(){return this.eq(-1)
},slice:function(){return this.pushStack(a8.apply(this,arguments),"slice",a8.call(arguments).join(","))
},map:function(b3){return this.pushStack(bK.map(this,function(b5,b4){return b3.call(b5,b4,b5)
}))
},end:function(){return this.prevObject||this.constructor(null)
},push:aq,sort:[].sort,splice:[].splice};
bK.fn.init.prototype=bK.fn;
bK.extend=bK.fn.extend=function(){var cc,b5,b3,b4,b9,ca,b8=arguments[0]||{},b7=1,b6=arguments.length,cb=false;
if(typeof b8==="boolean"){cb=b8;
b8=arguments[1]||{};
b7=2
}if(typeof b8!=="object"&&!bK.isFunction(b8)){b8={}
}if(b6===b7){b8=this;
--b7
}for(;
b7<b6;
b7++){if((cc=arguments[b7])!=null){for(b5 in cc){b3=b8[b5];
b4=cc[b5];
if(b8===b4){continue
}if(cb&&b4&&(bK.isPlainObject(b4)||(b9=bK.isArray(b4)))){if(b9){b9=false;
ca=b3&&bK.isArray(b3)?b3:[]
}else{ca=b3&&bK.isPlainObject(b3)?b3:{}
}b8[b5]=bK.extend(cb,ca,b4)
}else{if(b4!==aF){b8[b5]=b4
}}}}}return b8
};
bK.extend({noConflict:function(b3){if(a6.$===bK){a6.$=M
}if(b3&&a6.jQuery===bK){a6.jQuery=bk
}return bK
},isReady:false,readyWait:1,holdReady:function(b3){if(b3){bK.readyWait++
}else{bK.ready(true)
}},ready:function(b3){if(b3===true?--bK.readyWait:bK.isReady){return
}if(!q.body){return setTimeout(bK.ready,1)
}bK.isReady=true;
if(b3!==true&&--bK.readyWait>0){return
}aj.resolveWith(q,[bK]);
if(bK.fn.trigger){bK(q).trigger("ready").off("ready")
}},isFunction:function(b3){return bK.type(b3)==="function"
},isArray:Array.isArray||function(b3){return bK.type(b3)==="array"
},isWindow:function(b3){return b3!=null&&b3==b3.window
},isNumeric:function(b3){return !isNaN(parseFloat(b3))&&isFinite(b3)
},type:function(b3){return b3==null?String(b3):ad[D.call(b3)]||"object"
},isPlainObject:function(b5){if(!b5||bK.type(b5)!=="object"||b5.nodeType||bK.isWindow(b5)){return false
}try{if(b5.constructor&&!Z.call(b5,"constructor")&&!Z.call(b5.constructor.prototype,"isPrototypeOf")){return false
}}catch(b4){return false
}var b3;
for(b3 in b5){}return b3===aF||Z.call(b5,b3)
},isEmptyObject:function(b4){var b3;
for(b3 in b4){return false
}return true
},error:function(b3){throw new Error(b3)
},parseHTML:function(b6,b5,b3){var b4;
if(!b6||typeof b6!=="string"){return null
}if(typeof b5==="boolean"){b3=b5;
b5=0
}b5=b5||q;
if((b4=a.exec(b6))){return[b5.createElement(b4[1])]
}b4=bK.buildFragment([b6],b5,b3?null:[]);
return bK.merge([],(b4.cacheable?bK.clone(b4.fragment):b4.fragment).childNodes)
},parseJSON:function(b3){if(!b3||typeof b3!=="string"){return null
}b3=bK.trim(b3);
if(a6.JSON&&a6.JSON.parse){return a6.JSON.parse(b3)
}if(bj.test(b3.replace(bH,"@").replace(a4,"]").replace(bm,""))){return(new Function("return "+b3))()
}bK.error("Invalid JSON: "+b3)
},parseXML:function(b5){var b3,b4;
if(!b5||typeof b5!=="string"){return null
}try{if(a6.DOMParser){b4=new DOMParser();
b3=b4.parseFromString(b5,"text/xml")
}else{b3=new ActiveXObject("Microsoft.XMLDOM");
b3.async="false";
b3.loadXML(b5)
}}catch(b6){b3=aF
}if(!b3||!b3.documentElement||b3.getElementsByTagName("parsererror").length){bK.error("Invalid XML: "+b5)
}return b3
},noop:function(){},globalEval:function(b3){if(b3&&ae.test(b3)){(a6.execScript||function(b4){a6["eval"].call(a6,b4)
})(b3)
}},camelCase:function(b3){return b3.replace(bT,"ms-").replace(aY,R)
},nodeName:function(b4,b3){return b4.nodeName&&b4.nodeName.toUpperCase()===b3.toUpperCase()
},each:function(b8,b9,b5){var b4,b6=0,b7=b8.length,b3=b7===aF||bK.isFunction(b8);
if(b5){if(b3){for(b4 in b8){if(b9.apply(b8[b4],b5)===false){break
}}}else{for(;
b6<b7;
){if(b9.apply(b8[b6++],b5)===false){break
}}}}else{if(b3){for(b4 in b8){if(b9.call(b8[b4],b4,b8[b4])===false){break
}}}else{for(;
b6<b7;
){if(b9.call(b8[b6],b6,b8[b6++])===false){break
}}}}return b8
},trim:aS&&!aS.call("\uFEFF\xA0")?function(b3){return b3==null?"":aS.call(b3)
}:function(b3){return b3==null?"":b3.toString().replace(G,"")
},makeArray:function(b3,b5){var b6,b4=b5||[];
if(b3!=null){b6=bK.type(b3);
if(b3.length==null||b6==="string"||b6==="function"||b6==="regexp"||bK.isWindow(b3)){aq.call(b4,b3)
}else{bK.merge(b4,b3)
}}return b4
},inArray:function(b6,b4,b5){var b3;
if(b4){if(aO){return aO.call(b4,b6,b5)
}b3=b4.length;
b5=b5?b5<0?Math.max(0,b3+b5):b5:0;
for(;
b5<b3;
b5++){if(b5 in b4&&b4[b5]===b6){return b5
}}}return -1
},merge:function(b7,b5){var b3=b5.length,b6=b7.length,b4=0;
if(typeof b3==="number"){for(;
b4<b3;
b4++){b7[b6++]=b5[b4]
}}else{while(b5[b4]!==aF){b7[b6++]=b5[b4++]
}}b7.length=b6;
return b7
},grep:function(b4,b9,b3){var b8,b5=[],b6=0,b7=b4.length;
b3=!!b3;
for(;
b6<b7;
b6++){b8=!!b9(b4[b6],b6);
if(b3!==b8){b5.push(b4[b6])
}}return b5
},map:function(b3,ca,cb){var b8,b9,b7=[],b5=0,b4=b3.length,b6=b3 instanceof bK||b4!==aF&&typeof b4==="number"&&((b4>0&&b3[0]&&b3[b4-1])||b4===0||bK.isArray(b3));
if(b6){for(;
b5<b4;
b5++){b8=ca(b3[b5],b5,cb);
if(b8!=null){b7[b7.length]=b8
}}}else{for(b9 in b3){b8=ca(b3[b9],b9,cb);
if(b8!=null){b7[b7.length]=b8
}}}return b7.concat.apply([],b7)
},guid:1,proxy:function(b7,b6){var b5,b3,b4;
if(typeof b6==="string"){b5=b7[b6];
b6=b7;
b7=b5
}if(!bK.isFunction(b7)){return aF
}b3=a8.call(arguments,2);
b4=function(){return b7.apply(b6,b3.concat(a8.call(arguments)))
};
b4.guid=b7.guid=b7.guid||b4.guid||bK.guid++;
return b4
},access:function(b3,b9,cc,ca,b7,cd,cb){var b5,b8=cc==null,b6=0,b4=b3.length;
if(cc&&typeof cc==="object"){for(b6 in cc){bK.access(b3,b9,b6,cc[b6],1,cd,ca)
}b7=1
}else{if(ca!==aF){b5=cb===aF&&bK.isFunction(ca);
if(b8){if(b5){b5=b9;
b9=function(cf,ce,cg){return b5.call(bK(cf),cg)
}
}else{b9.call(b3,ca);
b9=null
}}if(b9){for(;
b6<b4;
b6++){b9(b3[b6],cc,b5?ca.call(b3[b6],b6,b9(b3[b6],cc)):ca,cb)
}}b7=1
}}return b7?b3:b8?b9.call(b3):b4?b9(b3[0],cc):cd
},now:function(){return(new Date()).getTime()
}});
bK.ready.promise=function(b6){if(!aj){aj=bK.Deferred();
if(q.readyState==="complete"){setTimeout(bK.ready,1)
}else{if(q.addEventListener){q.addEventListener("DOMContentLoaded",aJ,false);
a6.addEventListener("load",bK.ready,false)
}else{q.attachEvent("onreadystatechange",aJ);
a6.attachEvent("onload",bK.ready);
var b5=false;
try{b5=a6.frameElement==null&&q.documentElement
}catch(b4){}if(b5&&b5.doScroll){(function b3(){if(!bK.isReady){try{b5.doScroll("left")
}catch(b7){return setTimeout(b3,50)
}bK.ready()
}})()
}}}}return aj.promise(b6)
};
bK.each("Boolean Number String Function Array Date RegExp Object".split(" "),function(b4,b3){ad["[object "+b3+"]"]=b3.toLowerCase()
});
A=bK(q);
var bY={};
function ag(b4){var b3=bY[b4]={};
bK.each(b4.split(aZ),function(b6,b5){b3[b5]=true
});
return b3
}bK.Callbacks=function(cd){cd=typeof cd==="string"?(bY[cd]||ag(cd)):bK.extend({},cd);
var b6,b3,b7,b5,b8,b9,ca=[],cb=!cd.once&&[],b4=function(ce){b6=cd.memory&&ce;
b3=true;
b9=b5||0;
b5=0;
b8=ca.length;
b7=true;
for(;
ca&&b9<b8;
b9++){if(ca[b9].apply(ce[0],ce[1])===false&&cd.stopOnFalse){b6=false;
break
}}b7=false;
if(ca){if(cb){if(cb.length){b4(cb.shift())
}}else{if(b6){ca=[]
}else{cc.disable()
}}}},cc={add:function(){if(ca){var cf=ca.length;
(function ce(cg){bK.each(cg,function(ci,ch){var cj=bK.type(ch);
if(cj==="function"&&(!cd.unique||!cc.has(ch))){ca.push(ch)
}else{if(ch&&ch.length&&cj!=="string"){ce(ch)
}}})
})(arguments);
if(b7){b8=ca.length
}else{if(b6){b5=cf;
b4(b6)
}}}return this
},remove:function(){if(ca){bK.each(arguments,function(cg,ce){var cf;
while((cf=bK.inArray(ce,ca,cf))>-1){ca.splice(cf,1);
if(b7){if(cf<=b8){b8--
}if(cf<=b9){b9--
}}}})
}return this
},has:function(ce){return bK.inArray(ce,ca)>-1
},empty:function(){ca=[];
return this
},disable:function(){ca=cb=b6=aF;
return this
},disabled:function(){return !ca
},lock:function(){cb=aF;
if(!b6){cc.disable()
}return this
},locked:function(){return !cb
},fireWith:function(cf,ce){ce=ce||[];
ce=[cf,ce.slice?ce.slice():ce];
if(ca&&(!b3||cb)){if(b7){cb.push(ce)
}else{b4(ce)
}}return this
},fire:function(){cc.fireWith(this,arguments);
return this
},fired:function(){return !!b3
}};
return cc
};
bK.extend({Deferred:function(b5){var b4=[["resolve","done",bK.Callbacks("once memory"),"resolved"],["reject","fail",bK.Callbacks("once memory"),"rejected"],["notify","progress",bK.Callbacks("memory")]],b6="pending",b7={state:function(){return b6
},always:function(){b3.done(arguments).fail(arguments);
return this
},then:function(){var b8=arguments;
return bK.Deferred(function(b9){bK.each(b4,function(cb,ca){var cd=ca[0],cc=b8[cb];
b3[ca[1]](bK.isFunction(cc)?function(){var ce=cc.apply(this,arguments);
if(ce&&bK.isFunction(ce.promise)){ce.promise().done(b9.resolve).fail(b9.reject).progress(b9.notify)
}else{b9[cd+"With"](this===b3?b9:this,[ce])
}}:b9[cd])
});
b8=null
}).promise()
},promise:function(b8){return typeof b8==="object"?bK.extend(b8,b7):b7
}},b3={};
b7.pipe=b7.then;
bK.each(b4,function(b9,b8){var cb=b8[2],ca=b8[3];
b7[b8[1]]=cb.add;
if(ca){cb.add(function(){b6=ca
},b4[b9^1][2].disable,b4[2][2].lock)
}b3[b8[0]]=cb.fire;
b3[b8[0]+"With"]=cb.fireWith
});
b7.promise(b3);
if(b5){b5.call(b3,b3)
}return b3
},when:function(b7){var b5=0,b9=a8.call(arguments),b3=b9.length,b4=b3!==1||(b7&&bK.isFunction(b7.promise))?b3:0,cc=b4===1?b7:bK.Deferred(),b6=function(ce,cf,cd){return function(cg){cf[ce]=this;
cd[ce]=arguments.length>1?a8.call(arguments):cg;
if(cd===cb){cc.notifyWith(cf,cd)
}else{if(!(--b4)){cc.resolveWith(cf,cd)
}}}
},cb,b8,ca;
if(b3>1){cb=new Array(b3);
b8=new Array(b3);
ca=new Array(b3);
for(;
b5<b3;
b5++){if(b9[b5]&&bK.isFunction(b9[b5].promise)){b9[b5].promise().done(b6(b5,ca,b9)).fail(cc.reject).progress(b6(b5,b8,cb))
}else{--b4
}}}if(!b4){cc.resolveWith(ca,b9)
}return cc.promise()
}});
bK.support=(function(){var cf,ce,cc,cd,b6,cb,ca,b8,b7,b5,b3,b4=q.createElement("div");
b4.setAttribute("className","t");
b4.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>";
ce=b4.getElementsByTagName("*");
cc=b4.getElementsByTagName("a")[0];
cc.style.cssText="top:1px;float:left;opacity:.5";
if(!ce||!ce.length||!cc){return{}
}cd=q.createElement("select");
b6=cd.appendChild(q.createElement("option"));
cb=b4.getElementsByTagName("input")[0];
cf={leadingWhitespace:(b4.firstChild.nodeType===3),tbody:!b4.getElementsByTagName("tbody").length,htmlSerialize:!!b4.getElementsByTagName("link").length,style:/top/.test(cc.getAttribute("style")),hrefNormalized:(cc.getAttribute("href")==="/a"),opacity:/^0.5/.test(cc.style.opacity),cssFloat:!!cc.style.cssFloat,checkOn:(cb.value==="on"),optSelected:b6.selected,getSetAttribute:b4.className!=="t",enctype:!!q.createElement("form").enctype,html5Clone:q.createElement("nav").cloneNode(true).outerHTML!=="<:nav></:nav>",boxModel:(q.compatMode==="CSS1Compat"),submitBubbles:true,changeBubbles:true,focusinBubbles:false,deleteExpando:true,noCloneEvent:true,inlineBlockNeedsLayout:false,shrinkWrapBlocks:false,reliableMarginRight:true,boxSizingReliable:true,pixelPosition:false};
cb.checked=true;
cf.noCloneChecked=cb.cloneNode(true).checked;
cd.disabled=true;
cf.optDisabled=!b6.disabled;
try{delete b4.test
}catch(b9){cf.deleteExpando=false
}if(!b4.addEventListener&&b4.attachEvent&&b4.fireEvent){b4.attachEvent("onclick",b3=function(){cf.noCloneEvent=false
});
b4.cloneNode(true).fireEvent("onclick");
b4.detachEvent("onclick",b3)
}cb=q.createElement("input");
cb.value="t";
cb.setAttribute("type","radio");
cf.radioValue=cb.value==="t";
cb.setAttribute("checked","checked");
cb.setAttribute("name","t");
b4.appendChild(cb);
ca=q.createDocumentFragment();
ca.appendChild(b4.lastChild);
cf.checkClone=ca.cloneNode(true).cloneNode(true).lastChild.checked;
cf.appendChecked=cb.checked;
ca.removeChild(cb);
ca.appendChild(b4);
if(b4.attachEvent){for(b7 in {submit:true,change:true,focusin:true}){b8="on"+b7;
b5=(b8 in b4);
if(!b5){b4.setAttribute(b8,"return;");
b5=(typeof b4[b8]==="function")
}cf[b7+"Bubbles"]=b5
}}bK(function(){var ch,cl,cj,ck,ci="padding:0;margin:0;border:0;display:block;overflow:hidden;",cg=q.getElementsByTagName("body")[0];
if(!cg){return
}ch=q.createElement("div");
ch.style.cssText="visibility:hidden;border:0;width:0;height:0;position:static;top:0;margin-top:1px";
cg.insertBefore(ch,cg.firstChild);
cl=q.createElement("div");
ch.appendChild(cl);
cl.innerHTML="<table><tr><td></td><td>t</td></tr></table>";
cj=cl.getElementsByTagName("td");
cj[0].style.cssText="padding:0;margin:0;border:0;display:none";
b5=(cj[0].offsetHeight===0);
cj[0].style.display="";
cj[1].style.display="none";
cf.reliableHiddenOffsets=b5&&(cj[0].offsetHeight===0);
cl.innerHTML="";
cl.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;";
cf.boxSizing=(cl.offsetWidth===4);
cf.doesNotIncludeMarginInBodyOffset=(cg.offsetTop!==1);
if(a6.getComputedStyle){cf.pixelPosition=(a6.getComputedStyle(cl,null)||{}).top!=="1%";
cf.boxSizingReliable=(a6.getComputedStyle(cl,null)||{width:"4px"}).width==="4px";
ck=q.createElement("div");
ck.style.cssText=cl.style.cssText=ci;
ck.style.marginRight=ck.style.width="0";
cl.style.width="1px";
cl.appendChild(ck);
cf.reliableMarginRight=!parseFloat((a6.getComputedStyle(ck,null)||{}).marginRight)
}if(typeof cl.style.zoom!=="undefined"){cl.innerHTML="";
cl.style.cssText=ci+"width:1px;padding:1px;display:inline;zoom:1";
cf.inlineBlockNeedsLayout=(cl.offsetWidth===3);
cl.style.display="block";
cl.style.overflow="visible";
cl.innerHTML="<div></div>";
cl.firstChild.style.width="5px";
cf.shrinkWrapBlocks=(cl.offsetWidth!==3);
ch.style.zoom=1
}cg.removeChild(ch);
ch=cl=cj=ck=null
});
ca.removeChild(b4);
ce=cc=cd=b6=cb=ca=b4=null;
return cf
})();
var bx=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,aP=/([A-Z])/g;
bK.extend({cache:{},deletedIds:[],uuid:0,expando:"jQuery"+(bK.fn.jquery+Math.random()).replace(/\D/g,""),noData:{embed:true,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000",applet:true},hasData:function(b3){b3=b3.nodeType?bK.cache[b3[bK.expando]]:b3[bK.expando];
return !!b3&&!S(b3)
},data:function(b6,b4,b8,b7){if(!bK.acceptData(b6)){return
}var b9,cb,cc=bK.expando,ca=typeof b4==="string",cd=b6.nodeType,b3=cd?bK.cache:b6,b5=cd?b6[cc]:b6[cc]&&cc;
if((!b5||!b3[b5]||(!b7&&!b3[b5].data))&&ca&&b8===aF){return
}if(!b5){if(cd){b6[cc]=b5=bK.deletedIds.pop()||++bK.uuid
}else{b5=cc
}}if(!b3[b5]){b3[b5]={};
if(!cd){b3[b5].toJSON=bK.noop
}}if(typeof b4==="object"||typeof b4==="function"){if(b7){b3[b5]=bK.extend(b3[b5],b4)
}else{b3[b5].data=bK.extend(b3[b5].data,b4)
}}b9=b3[b5];
if(!b7){if(!b9.data){b9.data={}
}b9=b9.data
}if(b8!==aF){b9[bK.camelCase(b4)]=b8
}if(ca){cb=b9[b4];
if(cb==null){cb=b9[bK.camelCase(b4)]
}}else{cb=b9
}return cb
},removeData:function(b6,b4,b7){if(!bK.acceptData(b6)){return
}var ca,b9,b8,cb=b6.nodeType,b3=cb?bK.cache:b6,b5=cb?b6[bK.expando]:bK.expando;
if(!b3[b5]){return
}if(b4){ca=b7?b3[b5]:b3[b5].data;
if(ca){if(!bK.isArray(b4)){if(b4 in ca){b4=[b4]
}else{b4=bK.camelCase(b4);
if(b4 in ca){b4=[b4]
}else{b4=b4.split(" ")
}}}for(b9=0,b8=b4.length;
b9<b8;
b9++){delete ca[b4[b9]]
}if(!(b7?S:bK.isEmptyObject)(ca)){return
}}}if(!b7){delete b3[b5].data;
if(!S(b3[b5])){return
}}if(cb){bK.cleanData([b6],true)
}else{if(bK.support.deleteExpando||b3!=b3.window){delete b3[b5]
}else{b3[b5]=null
}}},_data:function(b4,b3,b5){return bK.data(b4,b3,b5,true)
},acceptData:function(b4){var b3=b4.nodeName&&bK.noData[b4.nodeName.toLowerCase()];
return !b3||b3!==true&&b4.getAttribute("classid")===b3
}});
bK.fn.extend({data:function(cc,cb){var b7,b4,ca,b3,b6,b5=this[0],b9=0,b8=null;
if(cc===aF){if(this.length){b8=bK.data(b5);
if(b5.nodeType===1&&!bK._data(b5,"parsedAttrs")){ca=b5.attributes;
for(b6=ca.length;
b9<b6;
b9++){b3=ca[b9].name;
if(b3.indexOf("data-")===0){b3=bK.camelCase(b3.substring(5));
bz(b5,b3,b8[b3])
}}bK._data(b5,"parsedAttrs",true)
}}return b8
}if(typeof cc==="object"){return this.each(function(){bK.data(this,cc)
})
}b7=cc.split(".",2);
b7[1]=b7[1]?"."+b7[1]:"";
b4=b7[1]+"!";
return bK.access(this,function(cd){if(cd===aF){b8=this.triggerHandler("getData"+b4,[b7[0]]);
if(b8===aF&&b5){b8=bK.data(b5,cc);
b8=bz(b5,cc,b8)
}return b8===aF&&b7[1]?this.data(b7[0]):b8
}b7[1]=cd;
this.each(function(){var ce=bK(this);
ce.triggerHandler("setData"+b4,b7);
bK.data(this,cc,cd);
ce.triggerHandler("changeData"+b4,b7)
})
},null,cb,arguments.length>1,null,false)
},removeData:function(b3){return this.each(function(){bK.removeData(this,b3)
})
}});
function bz(b5,b4,b6){if(b6===aF&&b5.nodeType===1){var b3="data-"+b4.replace(aP,"-$1").toLowerCase();
b6=b5.getAttribute(b3);
if(typeof b6==="string"){try{b6=b6==="true"?true:b6==="false"?false:b6==="null"?null:+b6+""===b6?+b6:bx.test(b6)?bK.parseJSON(b6):b6
}catch(b7){}bK.data(b5,b4,b6)
}else{b6=aF
}}return b6
}function S(b4){var b3;
for(b3 in b4){if(b3==="data"&&bK.isEmptyObject(b4[b3])){continue
}if(b3!=="toJSON"){return false
}}return true
}bK.extend({queue:function(b5,b4,b6){var b3;
if(b5){b4=(b4||"fx")+"queue";
b3=bK._data(b5,b4);
if(b6){if(!b3||bK.isArray(b6)){b3=bK._data(b5,b4,bK.makeArray(b6))
}else{b3.push(b6)
}}return b3||[]
}},dequeue:function(b8,b7){b7=b7||"fx";
var b4=bK.queue(b8,b7),b9=b4.length,b6=b4.shift(),b3=bK._queueHooks(b8,b7),b5=function(){bK.dequeue(b8,b7)
};
if(b6==="inprogress"){b6=b4.shift();
b9--
}if(b6){if(b7==="fx"){b4.unshift("inprogress")
}delete b3.stop;
b6.call(b8,b5,b3)
}if(!b9&&b3){b3.empty.fire()
}},_queueHooks:function(b5,b4){var b3=b4+"queueHooks";
return bK._data(b5,b3)||bK._data(b5,b3,{empty:bK.Callbacks("once memory").add(function(){bK.removeData(b5,b4+"queue",true);
bK.removeData(b5,b3,true)
})})
}});
bK.fn.extend({queue:function(b3,b4){var b5=2;
if(typeof b3!=="string"){b4=b3;
b3="fx";
b5--
}if(arguments.length<b5){return bK.queue(this[0],b3)
}return b4===aF?this:this.each(function(){var b6=bK.queue(this,b3,b4);
bK._queueHooks(this,b3);
if(b3==="fx"&&b6[0]!=="inprogress"){bK.dequeue(this,b3)
}})
},dequeue:function(b3){return this.each(function(){bK.dequeue(this,b3)
})
},delay:function(b4,b3){b4=bK.fx?bK.fx.speeds[b4]||b4:b4;
b3=b3||"fx";
return this.queue(b3,function(b6,b5){var b7=setTimeout(b6,b4);
b5.stop=function(){clearTimeout(b7)
}
})
},clearQueue:function(b3){return this.queue(b3||"fx",[])
},promise:function(b5,b9){var b4,b6=1,ca=bK.Deferred(),b8=this,b3=this.length,b7=function(){if(!(--b6)){ca.resolveWith(b8,[b8])
}};
if(typeof b5!=="string"){b9=b5;
b5=aF
}b5=b5||"fx";
while(b3--){b4=bK._data(b8[b3],b5+"queueHooks");
if(b4&&b4.empty){b6++;
b4.empty.add(b7)
}}b7();
return ca.promise(b9)
}});
var bb,bZ,p,bN=/[\t\r\n]/g,am=/\r/g,l=/^(?:button|input)$/i,aE=/^(?:button|input|object|select|textarea)$/i,H=/^a(?:rea|)$/i,Q=/^(?:autofocus|autoplay|async|checked|controls|defer|disabled|hidden|loop|multiple|open|readonly|required|scoped|selected)$/i,bP=bK.support.getSetAttribute;
bK.fn.extend({attr:function(b3,b4){return bK.access(this,bK.attr,b3,b4,arguments.length>1)
},removeAttr:function(b3){return this.each(function(){bK.removeAttr(this,b3)
})
},prop:function(b3,b4){return bK.access(this,bK.prop,b3,b4,arguments.length>1)
},removeProp:function(b3){b3=bK.propFix[b3]||b3;
return this.each(function(){try{this[b3]=aF;
delete this[b3]
}catch(b4){}})
},addClass:function(b7){var b9,b5,b4,b6,b8,ca,b3;
if(bK.isFunction(b7)){return this.each(function(cb){bK(this).addClass(b7.call(this,cb,this.className))
})
}if(b7&&typeof b7==="string"){b9=b7.split(aZ);
for(b5=0,b4=this.length;
b5<b4;
b5++){b6=this[b5];
if(b6.nodeType===1){if(!b6.className&&b9.length===1){b6.className=b7
}else{b8=" "+b6.className+" ";
for(ca=0,b3=b9.length;
ca<b3;
ca++){if(!~b8.indexOf(" "+b9[ca]+" ")){b8+=b9[ca]+" "
}}b6.className=bK.trim(b8)
}}}}return this
},removeClass:function(b9){var b6,b7,b8,ca,b4,b5,b3;
if(bK.isFunction(b9)){return this.each(function(cb){bK(this).removeClass(b9.call(this,cb,this.className))
})
}if((b9&&typeof b9==="string")||b9===aF){b6=(b9||"").split(aZ);
for(b5=0,b3=this.length;
b5<b3;
b5++){b8=this[b5];
if(b8.nodeType===1&&b8.className){b7=(" "+b8.className+" ").replace(bN," ");
for(ca=0,b4=b6.length;
ca<b4;
ca++){while(b7.indexOf(" "+b6[ca]+" ")>-1){b7=b7.replace(" "+b6[ca]+" "," ")
}}b8.className=b9?bK.trim(b7):""
}}}return this
},toggleClass:function(b6,b4){var b5=typeof b6,b3=typeof b4==="boolean";
if(bK.isFunction(b6)){return this.each(function(b7){bK(this).toggleClass(b6.call(this,b7,this.className,b4),b4)
})
}return this.each(function(){if(b5==="string"){var b9,b8=0,b7=bK(this),ca=b4,cb=b6.split(aZ);
while((b9=cb[b8++])){ca=b3?ca:!b7.hasClass(b9);
b7[ca?"addClass":"removeClass"](b9)
}}else{if(b5==="undefined"||b5==="boolean"){if(this.className){bK._data(this,"__className__",this.className)
}this.className=this.className||b6===false?"":bK._data(this,"__className__")||""
}}})
},hasClass:function(b3){var b6=" "+b3+" ",b5=0,b4=this.length;
for(;
b5<b4;
b5++){if(this[b5].nodeType===1&&(" "+this[b5].className+" ").replace(bN," ").indexOf(b6)>-1){return true
}}return false
},val:function(b6){var b3,b4,b7,b5=this[0];
if(!arguments.length){if(b5){b3=bK.valHooks[b5.type]||bK.valHooks[b5.nodeName.toLowerCase()];
if(b3&&"get" in b3&&(b4=b3.get(b5,"value"))!==aF){return b4
}b4=b5.value;
return typeof b4==="string"?b4.replace(am,""):b4==null?"":b4
}return
}b7=bK.isFunction(b6);
return this.each(function(b9){var ca,b8=bK(this);
if(this.nodeType!==1){return
}if(b7){ca=b6.call(this,b9,b8.val())
}else{ca=b6
}if(ca==null){ca=""
}else{if(typeof ca==="number"){ca+=""
}else{if(bK.isArray(ca)){ca=bK.map(ca,function(cb){return cb==null?"":cb+""
})
}}}b3=bK.valHooks[this.type]||bK.valHooks[this.nodeName.toLowerCase()];
if(!b3||!("set" in b3)||b3.set(this,ca,"value")===aF){this.value=ca
}})
}});
bK.extend({valHooks:{option:{get:function(b3){var b4=b3.attributes.value;
return !b4||b4.specified?b3.value:b3.text
}},select:{get:function(b3){var b9,b4,b8,b6,b7=b3.selectedIndex,ca=[],cb=b3.options,b5=b3.type==="select-one";
if(b7<0){return null
}b4=b5?b7:0;
b8=b5?b7+1:cb.length;
for(;
b4<b8;
b4++){b6=cb[b4];
if(b6.selected&&(bK.support.optDisabled?!b6.disabled:b6.getAttribute("disabled")===null)&&(!b6.parentNode.disabled||!bK.nodeName(b6.parentNode,"optgroup"))){b9=bK(b6).val();
if(b5){return b9
}ca.push(b9)
}}if(b5&&!ca.length&&cb.length){return bK(cb[b7]).val()
}return ca
},set:function(b4,b5){var b3=bK.makeArray(b5);
bK(b4).find("option").each(function(){this.selected=bK.inArray(bK(this).val(),b3)>=0
});
if(!b3.length){b4.selectedIndex=-1
}return b3
}}},attrFn:{},attr:function(b9,b6,ca,b8){var b5,b3,b7,b4=b9.nodeType;
if(!b9||b4===3||b4===8||b4===2){return
}if(b8&&bK.isFunction(bK.fn[b6])){return bK(b9)[b6](ca)
}if(typeof b9.getAttribute==="undefined"){return bK.prop(b9,b6,ca)
}b7=b4!==1||!bK.isXMLDoc(b9);
if(b7){b6=b6.toLowerCase();
b3=bK.attrHooks[b6]||(Q.test(b6)?bZ:bb)
}if(ca!==aF){if(ca===null){bK.removeAttr(b9,b6);
return
}else{if(b3&&"set" in b3&&b7&&(b5=b3.set(b9,ca,b6))!==aF){return b5
}else{b9.setAttribute(b6,""+ca);
return ca
}}}else{if(b3&&"get" in b3&&b7&&(b5=b3.get(b9,b6))!==null){return b5
}else{b5=b9.getAttribute(b6);
return b5===null?aF:b5
}}},removeAttr:function(b6,b8){var b7,b9,b4,b3,b5=0;
if(b8&&b6.nodeType===1){b9=b8.split(aZ);
for(;
b5<b9.length;
b5++){b4=b9[b5];
if(b4){b7=bK.propFix[b4]||b4;
b3=Q.test(b4);
if(!b3){bK.attr(b6,b4,"")
}b6.removeAttribute(bP?b4:b7);
if(b3&&b7 in b6){b6[b7]=false
}}}}},attrHooks:{type:{set:function(b3,b4){if(l.test(b3.nodeName)&&b3.parentNode){bK.error("type property can't be changed")
}else{if(!bK.support.radioValue&&b4==="radio"&&bK.nodeName(b3,"input")){var b5=b3.value;
b3.setAttribute("type",b4);
if(b5){b3.value=b5
}return b4
}}}},value:{get:function(b4,b3){if(bb&&bK.nodeName(b4,"button")){return bb.get(b4,b3)
}return b3 in b4?b4.value:null
},set:function(b4,b5,b3){if(bb&&bK.nodeName(b4,"button")){return bb.set(b4,b5,b3)
}b4.value=b5
}}},propFix:{tabindex:"tabIndex",readonly:"readOnly","for":"htmlFor","class":"className",maxlength:"maxLength",cellspacing:"cellSpacing",cellpadding:"cellPadding",rowspan:"rowSpan",colspan:"colSpan",usemap:"useMap",frameborder:"frameBorder",contenteditable:"contentEditable"},prop:function(b8,b6,b9){var b5,b3,b7,b4=b8.nodeType;
if(!b8||b4===3||b4===8||b4===2){return
}b7=b4!==1||!bK.isXMLDoc(b8);
if(b7){b6=bK.propFix[b6]||b6;
b3=bK.propHooks[b6]
}if(b9!==aF){if(b3&&"set" in b3&&(b5=b3.set(b8,b9,b6))!==aF){return b5
}else{return(b8[b6]=b9)
}}else{if(b3&&"get" in b3&&(b5=b3.get(b8,b6))!==null){return b5
}else{return b8[b6]
}}},propHooks:{tabIndex:{get:function(b4){var b3=b4.getAttributeNode("tabindex");
return b3&&b3.specified?parseInt(b3.value,10):aE.test(b4.nodeName)||H.test(b4.nodeName)&&b4.href?0:aF
}}}});
bZ={get:function(b4,b3){var b6,b5=bK.prop(b4,b3);
return b5===true||typeof b5!=="boolean"&&(b6=b4.getAttributeNode(b3))&&b6.nodeValue!==false?b3.toLowerCase():aF
},set:function(b4,b6,b3){var b5;
if(b6===false){bK.removeAttr(b4,b3)
}else{b5=bK.propFix[b3]||b3;
if(b5 in b4){b4[b5]=true
}b4.setAttribute(b3,b3.toLowerCase())
}return b3
}};
if(!bP){p={name:true,id:true,coords:true};
bb=bK.valHooks.button={get:function(b5,b4){var b3;
b3=b5.getAttributeNode(b4);
return b3&&(p[b4]?b3.value!=="":b3.specified)?b3.value:aF
},set:function(b5,b6,b4){var b3=b5.getAttributeNode(b4);
if(!b3){b3=q.createAttribute(b4);
b5.setAttributeNode(b3)
}return(b3.value=b6+"")
}};
bK.each(["width","height"],function(b4,b3){bK.attrHooks[b3]=bK.extend(bK.attrHooks[b3],{set:function(b5,b6){if(b6===""){b5.setAttribute(b3,"auto");
return b6
}}})
});
bK.attrHooks.contenteditable={get:bb.get,set:function(b4,b5,b3){if(b5===""){b5="false"
}bb.set(b4,b5,b3)
}}
}if(!bK.support.hrefNormalized){bK.each(["href","src","width","height"],function(b4,b3){bK.attrHooks[b3]=bK.extend(bK.attrHooks[b3],{get:function(b6){var b5=b6.getAttribute(b3,2);
return b5===null?aF:b5
}})
})
}if(!bK.support.style){bK.attrHooks.style={get:function(b3){return b3.style.cssText.toLowerCase()||aF
},set:function(b3,b4){return(b3.style.cssText=""+b4)
}}
}if(!bK.support.optSelected){bK.propHooks.selected=bK.extend(bK.propHooks.selected,{get:function(b4){var b3=b4.parentNode;
if(b3){b3.selectedIndex;
if(b3.parentNode){b3.parentNode.selectedIndex
}}return null
}})
}if(!bK.support.enctype){bK.propFix.enctype="encoding"
}if(!bK.support.checkOn){bK.each(["radio","checkbox"],function(){bK.valHooks[this]={get:function(b3){return b3.getAttribute("value")===null?"on":b3.value
}}
})
}bK.each(["radio","checkbox"],function(){bK.valHooks[this]=bK.extend(bK.valHooks[this],{set:function(b3,b4){if(bK.isArray(b4)){return(b3.checked=bK.inArray(bK(b3).val(),b4)>=0)
}}})
});
var bI=/^(?:textarea|input|select)$/i,bv=/^([^\.]*|)(?:\.(.+)|)$/,be=/(?:^|\s)hover(\.\S+|)\b/,a7=/^key/,bO=/^(?:mouse|contextmenu)|click/,bC=/^(?:focusinfocus|focusoutblur)$/,av=function(b3){return bK.event.special.hover?b3:b3.replace(be,"mouseenter$1 mouseleave$1")
};
bK.event={add:function(b6,ca,ch,b8,b7){var cb,b9,ci,cg,cf,cd,b3,ce,b4,b5,cc;
if(b6.nodeType===3||b6.nodeType===8||!ca||!ch||!(cb=bK._data(b6))){return
}if(ch.handler){b4=ch;
ch=b4.handler;
b7=b4.selector
}if(!ch.guid){ch.guid=bK.guid++
}ci=cb.events;
if(!ci){cb.events=ci={}
}b9=cb.handle;
if(!b9){cb.handle=b9=function(cj){return typeof bK!=="undefined"&&(!cj||bK.event.triggered!==cj.type)?bK.event.dispatch.apply(b9.elem,arguments):aF
};
b9.elem=b6
}ca=bK.trim(av(ca)).split(" ");
for(cg=0;
cg<ca.length;
cg++){cf=bv.exec(ca[cg])||[];
cd=cf[1];
b3=(cf[2]||"").split(".").sort();
cc=bK.event.special[cd]||{};
cd=(b7?cc.delegateType:cc.bindType)||cd;
cc=bK.event.special[cd]||{};
ce=bK.extend({type:cd,origType:cf[1],data:b8,handler:ch,guid:ch.guid,selector:b7,namespace:b3.join(".")},b4);
b5=ci[cd];
if(!b5){b5=ci[cd]=[];
b5.delegateCount=0;
if(!cc.setup||cc.setup.call(b6,b8,b3,b9)===false){if(b6.addEventListener){b6.addEventListener(cd,b9,false)
}else{if(b6.attachEvent){b6.attachEvent("on"+cd,b9)
}}}}if(cc.add){cc.add.call(b6,ce);
if(!ce.handler.guid){ce.handler.guid=ch.guid
}}if(b7){b5.splice(b5.delegateCount++,0,ce)
}else{b5.push(ce)
}bK.event.global[cd]=true
}b6=null
},global:{},remove:function(b6,cb,ch,b7,ca){var ci,cj,ce,b5,b4,b8,b9,cg,cd,b3,cf,cc=bK.hasData(b6)&&bK._data(b6);
if(!cc||!(cg=cc.events)){return
}cb=bK.trim(av(cb||"")).split(" ");
for(ci=0;
ci<cb.length;
ci++){cj=bv.exec(cb[ci])||[];
ce=b5=cj[1];
b4=cj[2];
if(!ce){for(ce in cg){bK.event.remove(b6,ce+cb[ci],ch,b7,true)
}continue
}cd=bK.event.special[ce]||{};
ce=(b7?cd.delegateType:cd.bindType)||ce;
b3=cg[ce]||[];
b8=b3.length;
b4=b4?new RegExp("(^|\\.)"+b4.split(".").sort().join("\\.(?:.*\\.|)")+"(\\.|$)"):null;
for(b9=0;
b9<b3.length;
b9++){cf=b3[b9];
if((ca||b5===cf.origType)&&(!ch||ch.guid===cf.guid)&&(!b4||b4.test(cf.namespace))&&(!b7||b7===cf.selector||b7==="**"&&cf.selector)){b3.splice(b9--,1);
if(cf.selector){b3.delegateCount--
}if(cd.remove){cd.remove.call(b6,cf)
}}}if(b3.length===0&&b8!==b3.length){if(!cd.teardown||cd.teardown.call(b6,b4,cc.handle)===false){bK.removeEvent(b6,ce,cc.handle)
}delete cg[ce]
}}if(bK.isEmptyObject(cg)){delete cc.handle;
bK.removeData(b6,"events",true)
}},customEvent:{getData:true,setData:true,changeData:true},trigger:function(b4,cb,b9,ci){if(b9&&(b9.nodeType===3||b9.nodeType===8)){return
}var b3,b6,cc,cg,b8,b7,ce,cd,ca,ch,cf=b4.type||b4,b5=[];
if(bC.test(cf+bK.event.triggered)){return
}if(cf.indexOf("!")>=0){cf=cf.slice(0,-1);
b6=true
}if(cf.indexOf(".")>=0){b5=cf.split(".");
cf=b5.shift();
b5.sort()
}if((!b9||bK.event.customEvent[cf])&&!bK.event.global[cf]){return
}b4=typeof b4==="object"?b4[bK.expando]?b4:new bK.Event(cf,b4):new bK.Event(cf);
b4.type=cf;
b4.isTrigger=true;
b4.exclusive=b6;
b4.namespace=b5.join(".");
b4.namespace_re=b4.namespace?new RegExp("(^|\\.)"+b5.join("\\.(?:.*\\.|)")+"(\\.|$)"):null;
b7=cf.indexOf(":")<0?"on"+cf:"";
if(!b9){b3=bK.cache;
for(cc in b3){if(b3[cc].events&&b3[cc].events[cf]){bK.event.trigger(b4,cb,b3[cc].handle.elem,true)
}}return
}b4.result=aF;
if(!b4.target){b4.target=b9
}cb=cb!=null?bK.makeArray(cb):[];
cb.unshift(b4);
ce=bK.event.special[cf]||{};
if(ce.trigger&&ce.trigger.apply(b9,cb)===false){return
}ca=[[b9,ce.bindType||cf]];
if(!ci&&!ce.noBubble&&!bK.isWindow(b9)){ch=ce.delegateType||cf;
cg=bC.test(ch+cf)?b9:b9.parentNode;
for(b8=b9;
cg;
cg=cg.parentNode){ca.push([cg,ch]);
b8=cg
}if(b8===(b9.ownerDocument||q)){ca.push([b8.defaultView||b8.parentWindow||a6,ch])
}}for(cc=0;
cc<ca.length&&!b4.isPropagationStopped();
cc++){cg=ca[cc][0];
b4.type=ca[cc][1];
cd=(bK._data(cg,"events")||{})[b4.type]&&bK._data(cg,"handle");
if(cd){cd.apply(cg,cb)
}cd=b7&&cg[b7];
if(cd&&bK.acceptData(cg)&&cd.apply(cg,cb)===false){b4.preventDefault()
}}b4.type=cf;
if(!ci&&!b4.isDefaultPrevented()){if((!ce._default||ce._default.apply(b9.ownerDocument,cb)===false)&&!(cf==="click"&&bK.nodeName(b9,"a"))&&bK.acceptData(b9)){if(b7&&b9[cf]&&((cf!=="focus"&&cf!=="blur")||b4.target.offsetWidth!==0)&&!bK.isWindow(b9)){b8=b9[b7];
if(b8){b9[b7]=null
}bK.event.triggered=cf;
b9[cf]();
bK.event.triggered=aF;
if(b8){b9[b7]=b8
}}}}return b4.result
},dispatch:function(b3){b3=bK.event.fix(b3||a6.event);
var ca,b9,cj,cd,cc,b4,cb,ch,b6,ci,b7=((bK._data(this,"events")||{})[b3.type]||[]),b8=b7.delegateCount,cf=[].slice.call(arguments),b5=!b3.exclusive&&!b3.namespace,ce=bK.event.special[b3.type]||{},cg=[];
cf[0]=b3;
b3.delegateTarget=this;
if(ce.preDispatch&&ce.preDispatch.call(this,b3)===false){return
}if(b8&&!(b3.button&&b3.type==="click")){for(cj=b3.target;
cj!=this;
cj=cj.parentNode||this){if(cj.disabled!==true||b3.type!=="click"){cc={};
cb=[];
for(ca=0;
ca<b8;
ca++){ch=b7[ca];
b6=ch.selector;
if(cc[b6]===aF){cc[b6]=bK(b6,this).index(cj)>=0
}if(cc[b6]){cb.push(ch)
}}if(cb.length){cg.push({elem:cj,matches:cb})
}}}}if(b7.length>b8){cg.push({elem:this,matches:b7.slice(b8)})
}for(ca=0;
ca<cg.length&&!b3.isPropagationStopped();
ca++){b4=cg[ca];
b3.currentTarget=b4.elem;
for(b9=0;
b9<b4.matches.length&&!b3.isImmediatePropagationStopped();
b9++){ch=b4.matches[b9];
if(b5||(!b3.namespace&&!ch.namespace)||b3.namespace_re&&b3.namespace_re.test(ch.namespace)){b3.data=ch.data;
b3.handleObj=ch;
cd=((bK.event.special[ch.origType]||{}).handle||ch.handler).apply(b4.elem,cf);
if(cd!==aF){b3.result=cd;
if(cd===false){b3.preventDefault();
b3.stopPropagation()
}}}}}if(ce.postDispatch){ce.postDispatch.call(this,b3)
}return b3.result
},props:"attrChange attrName relatedNode srcElement altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(b4,b3){if(b4.which==null){b4.which=b3.charCode!=null?b3.charCode:b3.keyCode
}return b4
}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(b6,b5){var b7,b8,b3,b4=b5.button,b9=b5.fromElement;
if(b6.pageX==null&&b5.clientX!=null){b7=b6.target.ownerDocument||q;
b8=b7.documentElement;
b3=b7.body;
b6.pageX=b5.clientX+(b8&&b8.scrollLeft||b3&&b3.scrollLeft||0)-(b8&&b8.clientLeft||b3&&b3.clientLeft||0);
b6.pageY=b5.clientY+(b8&&b8.scrollTop||b3&&b3.scrollTop||0)-(b8&&b8.clientTop||b3&&b3.clientTop||0)
}if(!b6.relatedTarget&&b9){b6.relatedTarget=b9===b6.target?b5.toElement:b9
}if(!b6.which&&b4!==aF){b6.which=(b4&1?1:(b4&2?3:(b4&4?2:0)))
}return b6
}},fix:function(b5){if(b5[bK.expando]){return b5
}var b4,b8,b3=b5,b6=bK.event.fixHooks[b5.type]||{},b7=b6.props?this.props.concat(b6.props):this.props;
b5=bK.Event(b3);
for(b4=b7.length;
b4;
){b8=b7[--b4];
b5[b8]=b3[b8]
}if(!b5.target){b5.target=b3.srcElement||q
}if(b5.target.nodeType===3){b5.target=b5.target.parentNode
}b5.metaKey=!!b5.metaKey;
return b6.filter?b6.filter(b5,b3):b5
},special:{load:{noBubble:true},focus:{delegateType:"focusin"},blur:{delegateType:"focusout"},beforeunload:{setup:function(b5,b4,b3){if(bK.isWindow(this)){this.onbeforeunload=b3
}},teardown:function(b4,b3){if(this.onbeforeunload===b3){this.onbeforeunload=null
}}}},simulate:function(b4,b6,b5,b3){var b7=bK.extend(new bK.Event(),b5,{type:b4,isSimulated:true,originalEvent:{}});
if(b3){bK.event.trigger(b7,null,b6)
}else{bK.event.dispatch.call(b6,b7)
}if(b7.isDefaultPrevented()){b5.preventDefault()
}}};
bK.event.handle=bK.event.dispatch;
bK.removeEvent=q.removeEventListener?function(b4,b3,b5){if(b4.removeEventListener){b4.removeEventListener(b3,b5,false)
}}:function(b5,b4,b6){var b3="on"+b4;
if(b5.detachEvent){if(typeof b5[b3]==="undefined"){b5[b3]=null
}b5.detachEvent(b3,b6)
}};
bK.Event=function(b4,b3){if(!(this instanceof bK.Event)){return new bK.Event(b4,b3)
}if(b4&&b4.type){this.originalEvent=b4;
this.type=b4.type;
this.isDefaultPrevented=(b4.defaultPrevented||b4.returnValue===false||b4.getPreventDefault&&b4.getPreventDefault())?V:ab
}else{this.type=b4
}if(b3){bK.extend(this,b3)
}this.timeStamp=b4&&b4.timeStamp||bK.now();
this[bK.expando]=true
};
function ab(){return false
}function V(){return true
}bK.Event.prototype={preventDefault:function(){this.isDefaultPrevented=V;
var b3=this.originalEvent;
if(!b3){return
}if(b3.preventDefault){b3.preventDefault()
}else{b3.returnValue=false
}},stopPropagation:function(){this.isPropagationStopped=V;
var b3=this.originalEvent;
if(!b3){return
}if(b3.stopPropagation){b3.stopPropagation()
}b3.cancelBubble=true
},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=V;
this.stopPropagation()
},isDefaultPrevented:ab,isPropagationStopped:ab,isImmediatePropagationStopped:ab};
bK.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(b4,b3){bK.event.special[b4]={delegateType:b3,bindType:b3,handle:function(b8){var b6,ca=this,b9=b8.relatedTarget,b7=b8.handleObj,b5=b7.selector;
if(!b9||(b9!==ca&&!bK.contains(ca,b9))){b8.type=b7.origType;
b6=b7.handler.apply(this,arguments);
b8.type=b3
}return b6
}}
});
if(!bK.support.submitBubbles){bK.event.special.submit={setup:function(){if(bK.nodeName(this,"form")){return false
}bK.event.add(this,"click._submit keypress._submit",function(b5){var b4=b5.target,b3=bK.nodeName(b4,"input")||bK.nodeName(b4,"button")?b4.form:aF;
if(b3&&!bK._data(b3,"_submit_attached")){bK.event.add(b3,"submit._submit",function(b6){b6._submit_bubble=true
});
bK._data(b3,"_submit_attached",true)
}})
},postDispatch:function(b3){if(b3._submit_bubble){delete b3._submit_bubble;
if(this.parentNode&&!b3.isTrigger){bK.event.simulate("submit",this.parentNode,b3,true)
}}},teardown:function(){if(bK.nodeName(this,"form")){return false
}bK.event.remove(this,"._submit")
}}
}if(!bK.support.changeBubbles){bK.event.special.change={setup:function(){if(bI.test(this.nodeName)){if(this.type==="checkbox"||this.type==="radio"){bK.event.add(this,"propertychange._change",function(b3){if(b3.originalEvent.propertyName==="checked"){this._just_changed=true
}});
bK.event.add(this,"click._change",function(b3){if(this._just_changed&&!b3.isTrigger){this._just_changed=false
}bK.event.simulate("change",this,b3,true)
})
}return false
}bK.event.add(this,"beforeactivate._change",function(b4){var b3=b4.target;
if(bI.test(b3.nodeName)&&!bK._data(b3,"_change_attached")){bK.event.add(b3,"change._change",function(b5){if(this.parentNode&&!b5.isSimulated&&!b5.isTrigger){bK.event.simulate("change",this.parentNode,b5,true)
}});
bK._data(b3,"_change_attached",true)
}})
},handle:function(b4){var b3=b4.target;
if(this!==b3||b4.isSimulated||b4.isTrigger||(b3.type!=="radio"&&b3.type!=="checkbox")){return b4.handleObj.handler.apply(this,arguments)
}},teardown:function(){bK.event.remove(this,"._change");
return !bI.test(this.nodeName)
}}
}if(!bK.support.focusinBubbles){bK.each({focus:"focusin",blur:"focusout"},function(b6,b3){var b4=0,b5=function(b7){bK.event.simulate(b3,b7.target,bK.event.fix(b7),true)
};
bK.event.special[b3]={setup:function(){if(b4++===0){q.addEventListener(b6,b5,true)
}},teardown:function(){if(--b4===0){q.removeEventListener(b6,b5,true)
}}}
})
}bK.fn.extend({on:function(b5,b3,b8,b7,b4){var b9,b6;
if(typeof b5==="object"){if(typeof b3!=="string"){b8=b8||b3;
b3=aF
}for(b6 in b5){this.on(b6,b3,b8,b5[b6],b4)
}return this
}if(b8==null&&b7==null){b7=b3;
b8=b3=aF
}else{if(b7==null){if(typeof b3==="string"){b7=b8;
b8=aF
}else{b7=b8;
b8=b3;
b3=aF
}}}if(b7===false){b7=ab
}else{if(!b7){return this
}}if(b4===1){b9=b7;
b7=function(ca){bK().off(ca);
return b9.apply(this,arguments)
};
b7.guid=b9.guid||(b9.guid=bK.guid++)
}return this.each(function(){bK.event.add(this,b5,b7,b8,b3)
})
},one:function(b4,b3,b6,b5){return this.on(b4,b3,b6,b5,1)
},off:function(b5,b3,b7){var b4,b6;
if(b5&&b5.preventDefault&&b5.handleObj){b4=b5.handleObj;
bK(b5.delegateTarget).off(b4.namespace?b4.origType+"."+b4.namespace:b4.origType,b4.selector,b4.handler);
return this
}if(typeof b5==="object"){for(b6 in b5){this.off(b6,b3,b5[b6])
}return this
}if(b3===false||typeof b3==="function"){b7=b3;
b3=aF
}if(b7===false){b7=ab
}return this.each(function(){bK.event.remove(this,b5,b7,b3)
})
},bind:function(b3,b5,b4){return this.on(b3,null,b5,b4)
},unbind:function(b3,b4){return this.off(b3,null,b4)
},live:function(b3,b5,b4){bK(this.context).on(b3,this.selector,b5,b4);
return this
},die:function(b3,b4){bK(this.context).off(b3,this.selector||"**",b4);
return this
},delegate:function(b3,b4,b6,b5){return this.on(b4,b3,b6,b5)
},undelegate:function(b3,b4,b5){return arguments.length==1?this.off(b3,"**"):this.off(b4,b3||"**",b5)
},trigger:function(b3,b4){return this.each(function(){bK.event.trigger(b3,b4,this)
})
},triggerHandler:function(b3,b4){if(this[0]){return bK.event.trigger(b3,b4,this[0],true)
}},toggle:function(b6){var b4=arguments,b3=b6.guid||bK.guid++,b5=0,b7=function(b8){var b9=(bK._data(this,"lastToggle"+b6.guid)||0)%b5;
bK._data(this,"lastToggle"+b6.guid,b9+1);
b8.preventDefault();
return b4[b9].apply(this,arguments)||false
};
b7.guid=b3;
while(b5<b4.length){b4[b5++].guid=b3
}return this.click(b7)
},hover:function(b3,b4){return this.mouseenter(b3).mouseleave(b4||b3)
}});
bK.each(("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu").split(" "),function(b4,b3){bK.fn[b3]=function(b6,b5){if(b5==null){b5=b6;
b6=null
}return arguments.length>0?this.on(b3,null,b6,b5):this.trigger(b3)
};
if(a7.test(b3)){bK.event.fixHooks[b3]=bK.event.keyHooks
}if(bO.test(b3)){bK.event.fixHooks[b3]=bK.event.mouseHooks
}});
/*!
 * Sizzle CSS Selector Engine
 *  Copyright 2012 jQuery Foundation and other contributors
 *  Released under the MIT license
 *  http://sizzlejs.com/
 */
(function(cQ,cj){var cr,cV,cd,cI,b4,cn,cz,cg,ci,cf,cc=true,cv="undefined",cY=("sizcache"+Math.random()).replace(".",""),cb=cQ.document,ce=cb.documentElement,ch=0,cm=[].slice,cU=[].push,c0=function(c5,c6){c5[cY]=c6||true;
return c5
},c3=function(){var c5={},c6=[];
return c0(function(c7,c8){if(c6.push(c7)>cI.cacheLength){delete c5[c6.shift()]
}return(c5[c7]=c8)
},c5)
},cS=c3(),cT=c3(),co=c3(),cy="[\\x20\\t\\r\\n\\f]",cl="(?:\\\\.|[-\\w]|[^\\x00-\\xa0])+",ck=cl.replace("w","w#"),c2="([*^$|!~]?=)",cN="\\["+cy+"*("+cl+")"+cy+"*(?:"+c2+cy+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+ck+")|)|)"+cy+"*\\]",c4=":("+cl+")(?:\\((?:(['\"])((?:\\\\.|[^\\\\])*?)\\2|([^()[\\]]*|(?:(?:"+cN+")|[^:]|\\\\.)*|.*))\\)|)",cA=":(nth|eq|gt|lt|first|last|even|odd)(?:\\(((?:-\\d)?\\d*)\\)|)(?=[^-]|$)",cW=new RegExp("^"+cy+"+|((?:^|[^\\\\])(?:\\\\.)*)"+cy+"+$","g"),b8=new RegExp("^"+cy+"*,"+cy+"*"),cF=new RegExp("^"+cy+"*([\\x20\\t\\r\\n\\f>+~])"+cy+"*"),cK=new RegExp(c4),cM=/^(?:#([\w\-]+)|(\w+)|\.([\w\-]+))$/,cD=/^:not/,cP=/[\x20\t\r\n\f]*[+~]/,cZ=/:not\($/,cs=/h\d/i,cL=/input|select|textarea|button/i,ct=/\\(?!\\)/g,cE={ID:new RegExp("^#("+cl+")"),CLASS:new RegExp("^\\.("+cl+")"),NAME:new RegExp("^\\[name=['\"]?("+cl+")['\"]?\\]"),TAG:new RegExp("^("+cl.replace("w","w*")+")"),ATTR:new RegExp("^"+cN),PSEUDO:new RegExp("^"+c4),CHILD:new RegExp("^:(only|nth|last|first)-child(?:\\("+cy+"*(even|odd|(([+-]|)(\\d*)n|)"+cy+"*(?:([+-]|)"+cy+"*(\\d+)|))"+cy+"*\\)|)","i"),POS:new RegExp(cA,"ig"),needsContext:new RegExp("^"+cy+"*[>+~]|"+cA,"i")},cH=function(c5){var c7=cb.createElement("div");
try{return c5(c7)
}catch(c6){return false
}finally{c7=null
}},ca=cH(function(c5){c5.appendChild(cb.createComment(""));
return !c5.getElementsByTagName("*").length
}),cC=cH(function(c5){c5.innerHTML="<a href='#'></a>";
return c5.firstChild&&typeof c5.firstChild.getAttribute!==cv&&c5.firstChild.getAttribute("href")==="#"
}),cq=cH(function(c6){c6.innerHTML="<select></select>";
var c5=typeof c6.lastChild.getAttribute("multiple");
return c5!=="boolean"&&c5!=="string"
}),cB=cH(function(c5){c5.innerHTML="<div class='hidden e'></div><div class='hidden'></div>";
if(!c5.getElementsByClassName||!c5.getElementsByClassName("e").length){return false
}c5.lastChild.className="e";
return c5.getElementsByClassName("e").length===2
}),b3=cH(function(c6){c6.id=cY+0;
c6.innerHTML="<a name='"+cY+"'></a><div name='"+cY+"'></div>";
ce.insertBefore(c6,ce.firstChild);
var c5=cb.getElementsByName&&cb.getElementsByName(cY).length===2+cb.getElementsByName(cY+0).length;
cd=!cb.getElementById(cY);
ce.removeChild(c6);
return c5
});
try{cm.call(ce.childNodes,0)[0].nodeType
}catch(c1){cm=function(c6){var c7,c5=[];
for(;
(c7=this[c6]);
c6++){c5.push(c7)
}return c5
}
}function cO(c8,c5,da,dd){da=da||[];
c5=c5||cb;
var db,c6,dc,c7,c9=c5.nodeType;
if(c9!==1&&c9!==9){return[]
}if(!c8||typeof c8!=="string"){return da
}dc=cn(c5);
if(!dc&&!dd){if((db=cM.exec(c8))){if((c7=db[1])){if(c9===9){c6=c5.getElementById(c7);
if(c6&&c6.parentNode){if(c6.id===c7){da.push(c6);
return da
}}else{return da
}}else{if(c5.ownerDocument&&(c6=c5.ownerDocument.getElementById(c7))&&cz(c5,c6)&&c6.id===c7){da.push(c6);
return da
}}}else{if(db[2]){cU.apply(da,cm.call(c5.getElementsByTagName(c8),0));
return da
}else{if((c7=db[3])&&cB&&c5.getElementsByClassName){cU.apply(da,cm.call(c5.getElementsByClassName(c7),0));
return da
}}}}}return cX(c8,c5,da,dd,dc)
}cO.matches=function(c6,c5){return cO(c6,null,null,c5)
};
cO.matchesSelector=function(c5,c6){return cO(c6,null,null,[c5]).length>0
};
function cG(c5){return function(c7){var c6=c7.nodeName.toLowerCase();
return c6==="input"&&c7.type===c5
}
}function b7(c5){return function(c7){var c6=c7.nodeName.toLowerCase();
return(c6==="input"||c6==="button")&&c7.type===c5
}
}b4=cO.getText=function(c9){var c8,c6="",c7=0,c5=c9.nodeType;
if(c5){if(c5===1||c5===9||c5===11){if(typeof c9.textContent==="string"){return c9.textContent
}else{for(c9=c9.firstChild;
c9;
c9=c9.nextSibling){c6+=b4(c9)
}}}else{if(c5===3||c5===4){return c9.nodeValue
}}}else{for(;
(c8=c9[c7]);
c7++){c6+=b4(c8)
}}return c6
};
cn=cO.isXML=function cn(c5){var c6=c5&&(c5.ownerDocument||c5).documentElement;
return c6?c6.nodeName!=="HTML":false
};
cz=cO.contains=ce.contains?function(c6,c5){var c8=c6.nodeType===9?c6.documentElement:c6,c7=c5&&c5.parentNode;
return c6===c7||!!(c7&&c7.nodeType===1&&c8.contains&&c8.contains(c7))
}:ce.compareDocumentPosition?function(c6,c5){return c5&&!!(c6.compareDocumentPosition(c5)&16)
}:function(c6,c5){while((c5=c5.parentNode)){if(c5===c6){return true
}}return false
};
cO.attr=function(c8,c7){var c5,c6=cn(c8);
if(!c6){c7=c7.toLowerCase()
}if(cI.attrHandle[c7]){return cI.attrHandle[c7](c8)
}if(cq||c6){return c8.getAttribute(c7)
}c5=c8.getAttributeNode(c7);
return c5?typeof c8[c7]==="boolean"?c8[c7]?c7:null:c5.specified?c5.value:null:null
};
cI=cO.selectors={cacheLength:50,createPseudo:c0,match:cE,order:new RegExp("ID|TAG"+(b3?"|NAME":"")+(cB?"|CLASS":"")),attrHandle:cC?{}:{href:function(c5){return c5.getAttribute("href",2)
},type:function(c5){return c5.getAttribute("type")
}},find:{ID:cd?function(c8,c7,c6){if(typeof c7.getElementById!==cv&&!c6){var c5=c7.getElementById(c8);
return c5&&c5.parentNode?[c5]:[]
}}:function(c8,c7,c6){if(typeof c7.getElementById!==cv&&!c6){var c5=c7.getElementById(c8);
return c5?c5.id===c8||typeof c5.getAttributeNode!==cv&&c5.getAttributeNode("id").value===c8?[c5]:cj:[]
}},TAG:ca?function(c5,c6){if(typeof c6.getElementsByTagName!==cv){return c6.getElementsByTagName(c5)
}}:function(c5,c9){var c8=c9.getElementsByTagName(c5);
if(c5==="*"){var da,c7=[],c6=0;
for(;
(da=c8[c6]);
c6++){if(da.nodeType===1){c7.push(da)
}}return c7
}return c8
},NAME:function(c5,c6){if(typeof c6.getElementsByName!==cv){return c6.getElementsByName(name)
}},CLASS:function(c7,c6,c5){if(typeof c6.getElementsByClassName!==cv&&!c5){return c6.getElementsByClassName(c7)
}}},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(c5){c5[1]=c5[1].replace(ct,"");
c5[3]=(c5[4]||c5[5]||"").replace(ct,"");
if(c5[2]==="~="){c5[3]=" "+c5[3]+" "
}return c5.slice(0,4)
},CHILD:function(c5){c5[1]=c5[1].toLowerCase();
if(c5[1]==="nth"){if(!c5[2]){cO.error(c5[0])
}c5[3]=+(c5[3]?c5[4]+(c5[5]||1):2*(c5[2]==="even"||c5[2]==="odd"));
c5[4]=+((c5[6]+c5[7])||c5[2]==="odd")
}else{if(c5[2]){cO.error(c5[0])
}}return c5
},PSEUDO:function(c7,c8,c6){var c9,c5;
if(cE.CHILD.test(c7[0])){return null
}if(c7[3]){c7[2]=c7[3]
}else{if((c9=c7[4])){if(cK.test(c9)&&(c5=b5(c9,c8,c6,true))&&(c5=c9.indexOf(")",c9.length-c5)-c9.length)){c9=c9.slice(0,c5);
c7[0]=c7[0].slice(0,c5)
}c7[2]=c9
}}return c7.slice(0,3)
}},filter:{ID:cd?function(c5){c5=c5.replace(ct,"");
return function(c6){return c6.getAttribute("id")===c5
}
}:function(c5){c5=c5.replace(ct,"");
return function(c7){var c6=typeof c7.getAttributeNode!==cv&&c7.getAttributeNode("id");
return c6&&c6.value===c5
}
},TAG:function(c5){if(c5==="*"){return function(){return true
}
}c5=c5.replace(ct,"").toLowerCase();
return function(c6){return c6.nodeName&&c6.nodeName.toLowerCase()===c5
}
},CLASS:function(c5){var c6=cS[cY][c5];
if(!c6){c6=cS(c5,new RegExp("(^|"+cy+")"+c5+"("+cy+"|$)"))
}return function(c7){return c6.test(c7.className||(typeof c7.getAttribute!==cv&&c7.getAttribute("class"))||"")
}
},ATTR:function(c7,c6,c5){if(!c6){return function(c8){return cO.attr(c8,c7)!=null
}
}return function(c9){var c8=cO.attr(c9,c7),da=c8+"";
if(c8==null){return c6==="!="
}switch(c6){case"=":return da===c5;
case"!=":return da!==c5;
case"^=":return c5&&da.indexOf(c5)===0;
case"*=":return c5&&da.indexOf(c5)>-1;
case"$=":return c5&&da.substr(da.length-c5.length)===c5;
case"~=":return(" "+da+" ").indexOf(c5)>-1;
case"|=":return da===c5||da.substr(0,c5.length+1)===c5+"-"
}}
},CHILD:function(c6,c8,c9,c7){if(c6==="nth"){var c5=ch++;
return function(dd){var da,de,dc=0,db=dd;
if(c9===1&&c7===0){return true
}da=dd.parentNode;
if(da&&(da[cY]!==c5||!dd.sizset)){for(db=da.firstChild;
db;
db=db.nextSibling){if(db.nodeType===1){db.sizset=++dc;
if(db===dd){break
}}}da[cY]=c5
}de=dd.sizset-c7;
if(c9===0){return de===0
}else{return(de%c9===0&&de/c9>=0)
}}
}return function(db){var da=db;
switch(c6){case"only":case"first":while((da=da.previousSibling)){if(da.nodeType===1){return false
}}if(c6==="first"){return true
}da=db;
case"last":while((da=da.nextSibling)){if(da.nodeType===1){return false
}}return true
}}
},PSEUDO:function(da,c9,c7,c6){var c5,c8=cI.pseudos[da]||cI.pseudos[da.toLowerCase()];
if(!c8){cO.error("unsupported pseudo: "+da)
}if(!c8[cY]){if(c8.length>1){c5=[da,da,"",c9];
return function(db){return c8(db,0,c5)
}
}return c8
}return c8(c9,c7,c6)
}},pseudos:{not:c0(function(c5,c7,c6){var c8=cg(c5.replace(cW,"$1"),c7,c6);
return function(c9){return !c8(c9)
}
}),enabled:function(c5){return c5.disabled===false
},disabled:function(c5){return c5.disabled===true
},checked:function(c5){var c6=c5.nodeName.toLowerCase();
return(c6==="input"&&!!c5.checked)||(c6==="option"&&!!c5.selected)
},selected:function(c5){if(c5.parentNode){c5.parentNode.selectedIndex
}return c5.selected===true
},parent:function(c5){return !cI.pseudos.empty(c5)
},empty:function(c6){var c5;
c6=c6.firstChild;
while(c6){if(c6.nodeName>"@"||(c5=c6.nodeType)===3||c5===4){return false
}c6=c6.nextSibling
}return true
},contains:c0(function(c5){return function(c6){return(c6.textContent||c6.innerText||b4(c6)).indexOf(c5)>-1
}
}),has:c0(function(c5){return function(c6){return cO(c5,c6).length>0
}
}),header:function(c5){return cs.test(c5.nodeName)
},text:function(c7){var c6,c5;
return c7.nodeName.toLowerCase()==="input"&&(c6=c7.type)==="text"&&((c5=c7.getAttribute("type"))==null||c5.toLowerCase()===c6)
},radio:cG("radio"),checkbox:cG("checkbox"),file:cG("file"),password:cG("password"),image:cG("image"),submit:b7("submit"),reset:b7("reset"),button:function(c6){var c5=c6.nodeName.toLowerCase();
return c5==="input"&&c6.type==="button"||c5==="button"
},input:function(c5){return cL.test(c5.nodeName)
},focus:function(c5){var c6=c5.ownerDocument;
return c5===c6.activeElement&&(!c6.hasFocus||c6.hasFocus())&&!!(c5.type||c5.href)
},active:function(c5){return c5===c5.ownerDocument.activeElement
}},setFilters:{first:function(c7,c6,c5){return c5?c7.slice(1):[c7[0]]
},last:function(c8,c7,c6){var c5=c8.pop();
return c6?c8:[c5]
},even:function(da,c9,c8){var c7=[],c6=c8?1:0,c5=da.length;
for(;
c6<c5;
c6=c6+2){c7.push(da[c6])
}return c7
},odd:function(da,c9,c8){var c7=[],c6=c8?0:1,c5=da.length;
for(;
c6<c5;
c6=c6+2){c7.push(da[c6])
}return c7
},lt:function(c7,c6,c5){return c5?c7.slice(+c6):c7.slice(0,+c6)
},gt:function(c7,c6,c5){return c5?c7.slice(0,+c6+1):c7.slice(+c6+1)
},eq:function(c8,c7,c6){var c5=c8.splice(+c7,1);
return c6?c8:c5
}}};
function b6(c6,c5,c7){if(c6===c5){return c7
}var c8=c6.nextSibling;
while(c8){if(c8===c5){return -1
}c8=c8.nextSibling
}return 1
}ci=ce.compareDocumentPosition?function(c6,c5){if(c6===c5){cf=true;
return 0
}return(!c6.compareDocumentPosition||!c5.compareDocumentPosition?c6.compareDocumentPosition:c6.compareDocumentPosition(c5)&4)?-1:1
}:function(dd,dc){if(dd===dc){cf=true;
return 0
}else{if(dd.sourceIndex&&dc.sourceIndex){return dd.sourceIndex-dc.sourceIndex
}}var da,c6,c7=[],c5=[],c9=dd.parentNode,db=dc.parentNode,de=c9;
if(c9===db){return b6(dd,dc)
}else{if(!c9){return -1
}else{if(!db){return 1
}}}while(de){c7.unshift(de);
de=de.parentNode
}de=db;
while(de){c5.unshift(de);
de=de.parentNode
}da=c7.length;
c6=c5.length;
for(var c8=0;
c8<da&&c8<c6;
c8++){if(c7[c8]!==c5[c8]){return b6(c7[c8],c5[c8])
}}return c8===da?b6(dd,c5[c8],-1):b6(c7[c8],dc,1)
};
[0,0].sort(ci);
cc=!cf;
cO.uniqueSort=function(c6){var c7,c5=1;
cf=cc;
c6.sort(ci);
if(cf){for(;
(c7=c6[c5]);
c5++){if(c7===c6[c5-1]){c6.splice(c5--,1)
}}}return c6
};
cO.error=function(c5){throw new Error("Syntax error, unrecognized expression: "+c5)
};
function b5(dc,c6,de,dl){var c7,df,dh,di,dg,c9,dk,dd,c5,c8,db=!de&&c6!==cb,dj=(db?"<s>":"")+dc.replace(cW,"$1<s>"),da=cT[cY][dj];
if(da){return dl?0:cm.call(da,0)
}dg=dc;
c9=[];
dd=0;
c5=cI.preFilter;
c8=cI.filter;
while(dg){if(!c7||(df=b8.exec(dg))){if(df){dg=dg.slice(df[0].length);
dh.selector=dk
}c9.push(dh=[]);
dk="";
if(db){dg=" "+dg
}}c7=false;
if((df=cF.exec(dg))){dk+=df[0];
dg=dg.slice(df[0].length);
c7=dh.push({part:df.pop().replace(cW," "),string:df[0],captures:df})
}for(di in c8){if((df=cE[di].exec(dg))&&(!c5[di]||(df=c5[di](df,c6,de)))){dk+=df[0];
dg=dg.slice(df[0].length);
c7=dh.push({part:di,string:df.shift(),captures:df})
}}if(!c7){break
}}if(dk){dh.selector=dk
}return dl?dg.length:dg?cO.error(dc):cm.call(cT(dj,c9),0)
}function cw(da,c9,c8,c6){var c5=c9.dir,c7=ch++;
if(!da){da=function(db){return db===c8
}
}return c9.first?function(db){while((db=db[c5])){if(db.nodeType===1){return da(db)&&db
}}}:c6?function(db){while((db=db[c5])){if(db.nodeType===1){if(da(db)){return db
}}}}:function(dc){var db,dd=c7+"."+cr,de=dd+"."+cV;
while((dc=dc[c5])){if(dc.nodeType===1){if((db=dc[cY])===de){return dc.sizset
}else{if(typeof db==="string"&&db.indexOf(dd)===0){if(dc.sizset){return dc
}}else{dc[cY]=de;
if(da(dc)){dc.sizset=true;
return dc
}dc.sizset=false
}}}}}
}function cu(c5,c6){return c5?function(c8){var c7=c6(c8);
return c7&&c5(c7===true?c8:c7)
}:c6
}function cx(da,c8,c5){var c7,c9,c6=0;
for(;
(c7=da[c6]);
c6++){if(cI.relative[c7.part]){c9=cw(c9,cI.relative[c7.part],c8,c5)
}else{c9=cu(c9,cI.filter[c7.part].apply(null,c7.captures.concat(c8,c5)))
}}return c9
}function b9(c5){return function(c7){var c8,c6=0;
for(;
(c8=c5[c6]);
c6++){if(c8(c7)){return true
}}return false
}
}cg=cO.compile=function(c6,c9,c7){var db,c8,c5,da=co[cY][c6];
if(da&&da.context===c9){return da
}db=b5(c6,c9,c7);
for(c8=0,c5=db.length;
c8<c5;
c8++){db[c8]=cx(db[c8],c9,c7)
}da=co(c6,b9(db));
da.context=c9;
da.runs=da.dirruns=0;
return da
};
function cp(c6,da,c9,c7){var c8=0,c5=da.length;
for(;
c8<c5;
c8++){cO(c6,da[c8],c9,c7)
}}function cJ(c5,c7,db,dc,c6,da){var c8,c9=cI.setFilters[c7.toLowerCase()];
if(!c9){cO.error(c7)
}if(c5||!(c8=c6)){cp(c5||"*",dc,(c8=[]),c6)
}return c8.length>0?c9(c8,db,da):[]
}function cR(dp,c5,dh,c7){var dd,di,dj,dg,da,dk,c9,df,db,de,dn,dq,c6,dl=0,dm=dp.length,c8=cE.POS,dc=new RegExp("^"+c8.source+"(?!"+cy+")","i"),dr=function(){var dt=1,ds=arguments.length-2;
for(;
dt<ds;
dt++){if(arguments[dt]===cj){db[dt]=cj
}}};
for(;
dl<dm;
dl++){dd=dp[dl];
di="";
df=c7;
for(dj=0,dg=dd.length;
dj<dg;
dj++){da=dd[dj];
dk=da.string;
if(da.part==="PSEUDO"){c8.exec("");
c9=0;
while((db=c8.exec(dk))){de=true;
dn=c8.lastIndex=db.index+db[0].length;
if(dn>c9){di+=dk.slice(c9,db.index);
c9=dn;
dq=[c5];
if(cF.test(di)){if(df){dq=df
}df=c7
}if((c6=cZ.test(di))){di=di.slice(0,-5).replace(cF,"$&*");
c9++
}if(db.length>1){db[0].replace(dc,dr)
}df=cJ(di,db[1],db[2],dq,df,c6)
}di=""
}}if(!de){di+=dk
}de=false
}if(di){if(cF.test(di)){cp(di,df||[c5],dh,c7)
}else{cO(di,c5,dh,c7?c7.concat(df):df)
}}else{cU.apply(dh,df)
}}return dm===1?dh:cO.uniqueSort(dh)
}function cX(db,c6,dd,dg,df){db=db.replace(cW,"$1");
var c5,dh,c9,c8,dc,dj,da,c7,dk,di,de=b5(db,c6,df),dl=c6.nodeType;
if(cE.POS.test(db)){return cR(de,c6,dd,dg)
}if(dg){c5=cm.call(dg,0)
}else{if(de.length===1){if((dj=cm.call(de[0],0)).length>2&&(da=dj[0]).part==="ID"&&dl===9&&!df&&cI.relative[dj[1].part]){c6=cI.find.ID(da.captures[0].replace(ct,""),c6,df)[0];
if(!c6){return dd
}db=db.slice(dj.shift().string.length)
}dk=((de=cP.exec(dj[0].string))&&!de.index&&c6.parentNode)||c6;
c7="";
for(dc=dj.length-1;
dc>=0;
dc--){da=dj[dc];
di=da.part;
c7=da.string+c7;
if(cI.relative[di]){break
}if(cI.order.test(di)){c5=cI.find[di](da.captures[0].replace(ct,""),dk,df);
if(c5==null){continue
}else{db=db.slice(0,db.length-c7.length)+c7.replace(cE[di],"");
if(!db){cU.apply(dd,cm.call(c5,0))
}break
}}}}}if(db){dh=cg(db,c6,df);
cr=dh.dirruns++;
if(c5==null){c5=cI.find.TAG("*",(cP.test(db)&&c6.parentNode)||c6)
}for(dc=0;
(c8=c5[dc]);
dc++){cV=dh.runs++;
if(dh(c8)){dd.push(c8)
}}}return dd
}if(cb.querySelectorAll){(function(){var da,db=cX,c9=/'|\\/g,c7=/\=[\x20\t\r\n\f]*([^'"\]]*)[\x20\t\r\n\f]*\]/g,c6=[],c5=[":active"],c8=ce.matchesSelector||ce.mozMatchesSelector||ce.webkitMatchesSelector||ce.oMatchesSelector||ce.msMatchesSelector;
cH(function(dc){dc.innerHTML="<select><option selected=''></option></select>";
if(!dc.querySelectorAll("[selected]").length){c6.push("\\["+cy+"*(?:checked|disabled|ismap|multiple|readonly|selected|value)")
}if(!dc.querySelectorAll(":checked").length){c6.push(":checked")
}});
cH(function(dc){dc.innerHTML="<p test=''></p>";
if(dc.querySelectorAll("[test^='']").length){c6.push("[*^$]="+cy+"*(?:\"\"|'')")
}dc.innerHTML="<input type='hidden'/>";
if(!dc.querySelectorAll(":enabled").length){c6.push(":enabled",":disabled")
}});
c6=c6.length&&new RegExp(c6.join("|"));
cX=function(di,dd,dj,dm,dl){if(!dm&&!dl&&(!c6||!c6.test(di))){if(dd.nodeType===9){try{cU.apply(dj,cm.call(dd.querySelectorAll(di),0));
return dj
}catch(dh){}}else{if(dd.nodeType===1&&dd.nodeName.toLowerCase()!=="object"){var dg,dk,dn,df=dd.getAttribute("id"),dc=df||cY,de=cP.test(di)&&dd.parentNode||dd;
if(df){dc=dc.replace(c9,"\\$&")
}else{dd.setAttribute("id",dc)
}dg=b5(di,dd,dl);
dc="[id='"+dc+"']";
for(dk=0,dn=dg.length;
dk<dn;
dk++){dg[dk]=dc+dg[dk].selector
}try{cU.apply(dj,cm.call(de.querySelectorAll(dg.join(",")),0));
return dj
}catch(dh){}finally{if(!df){dd.removeAttribute("id")
}}}}}return db(di,dd,dj,dm,dl)
};
if(c8){cH(function(dd){da=c8.call(dd,"div");
try{c8.call(dd,"[test!='']:sizzle");
c5.push(cE.PSEUDO.source,cE.POS.source,"!=")
}catch(dc){}});
c5=new RegExp(c5.join("|"));
cO.matchesSelector=function(dd,df){df=df.replace(c7,"='$1']");
if(!cn(dd)&&!c5.test(df)&&(!c6||!c6.test(df))){try{var dc=c8.call(dd,df);
if(dc||da||dd.document&&dd.document.nodeType!==11){return dc
}}catch(de){}}return cO(df,null,null,[dd]).length>0
}
}})()
}cI.setFilters.nth=cI.setFilters.eq;
cI.filters=cI.pseudos;
cO.attr=bK.attr;
bK.find=cO;
bK.expr=cO.selectors;
bK.expr[":"]=bK.expr.pseudos;
bK.unique=cO.uniqueSort;
bK.text=cO.getText;
bK.isXMLDoc=cO.isXML;
bK.contains=cO.contains
})(a6);
var ak=/Until$/,bu=/^(?:parents|prev(?:Until|All))/,ap=/^.[^:#\[\.,]*$/,C=bK.expr.match.needsContext,by={children:true,contents:true,next:true,prev:true};
bK.fn.extend({find:function(b3){var b7,b4,b9,ca,b8,b6,b5=this;
if(typeof b3!=="string"){return bK(b3).filter(function(){for(b7=0,b4=b5.length;
b7<b4;
b7++){if(bK.contains(b5[b7],this)){return true
}}})
}b6=this.pushStack("","find",b3);
for(b7=0,b4=this.length;
b7<b4;
b7++){b9=b6.length;
bK.find(b3,this[b7],b6);
if(b7>0){for(ca=b9;
ca<b6.length;
ca++){for(b8=0;
b8<b9;
b8++){if(b6[b8]===b6[ca]){b6.splice(ca--,1);
break
}}}}}return b6
},has:function(b6){var b5,b4=bK(b6,this),b3=b4.length;
return this.filter(function(){for(b5=0;
b5<b3;
b5++){if(bK.contains(this,b4[b5])){return true
}}})
},not:function(b3){return this.pushStack(aQ(this,b3,false),"not",b3)
},filter:function(b3){return this.pushStack(aQ(this,b3,true),"filter",b3)
},is:function(b3){return !!b3&&(typeof b3==="string"?C.test(b3)?bK(b3,this.context).index(this[0])>=0:bK.filter(b3,this).length>0:this.filter(b3).length>0)
},closest:function(b7,b6){var b8,b5=0,b3=this.length,b4=[],b9=C.test(b7)||typeof b7!=="string"?bK(b7,b6||this.context):0;
for(;
b5<b3;
b5++){b8=this[b5];
while(b8&&b8.ownerDocument&&b8!==b6&&b8.nodeType!==11){if(b9?b9.index(b8)>-1:bK.find.matchesSelector(b8,b7)){b4.push(b8);
break
}b8=b8.parentNode
}}b4=b4.length>1?bK.unique(b4):b4;
return this.pushStack(b4,"closest",b7)
},index:function(b3){if(!b3){return(this[0]&&this[0].parentNode)?this.prevAll().length:-1
}if(typeof b3==="string"){return bK.inArray(this[0],bK(b3))
}return bK.inArray(b3.jquery?b3[0]:b3,this)
},add:function(b3,b4){var b6=typeof b3==="string"?bK(b3,b4):bK.makeArray(b3&&b3.nodeType?[b3]:b3),b5=bK.merge(this.get(),b6);
return this.pushStack(aV(b6[0])||aV(b5[0])?b5:bK.unique(b5))
},addBack:function(b3){return this.add(b3==null?this.prevObject:this.prevObject.filter(b3))
}});
bK.fn.andSelf=bK.fn.addBack;
function aV(b3){return !b3||!b3.parentNode||b3.parentNode.nodeType===11
}function a2(b4,b3){do{b4=b4[b3]
}while(b4&&b4.nodeType!==1);
return b4
}bK.each({parent:function(b4){var b3=b4.parentNode;
return b3&&b3.nodeType!==11?b3:null
},parents:function(b3){return bK.dir(b3,"parentNode")
},parentsUntil:function(b4,b3,b5){return bK.dir(b4,"parentNode",b5)
},next:function(b3){return a2(b3,"nextSibling")
},prev:function(b3){return a2(b3,"previousSibling")
},nextAll:function(b3){return bK.dir(b3,"nextSibling")
},prevAll:function(b3){return bK.dir(b3,"previousSibling")
},nextUntil:function(b4,b3,b5){return bK.dir(b4,"nextSibling",b5)
},prevUntil:function(b4,b3,b5){return bK.dir(b4,"previousSibling",b5)
},siblings:function(b3){return bK.sibling((b3.parentNode||{}).firstChild,b3)
},children:function(b3){return bK.sibling(b3.firstChild)
},contents:function(b3){return bK.nodeName(b3,"iframe")?b3.contentDocument||b3.contentWindow.document:bK.merge([],b3.childNodes)
}},function(b3,b4){bK.fn[b3]=function(b7,b5){var b6=bK.map(this,b4,b7);
if(!ak.test(b3)){b5=b7
}if(b5&&typeof b5==="string"){b6=bK.filter(b5,b6)
}b6=this.length>1&&!by[b3]?bK.unique(b6):b6;
if(this.length>1&&bu.test(b3)){b6=b6.reverse()
}return this.pushStack(b6,b3,a8.call(arguments).join(","))
}
});
bK.extend({filter:function(b5,b3,b4){if(b4){b5=":not("+b5+")"
}return b3.length===1?bK.find.matchesSelector(b3[0],b5)?[b3[0]]:[]:bK.find.matches(b5,b3)
},dir:function(b5,b4,b7){var b3=[],b6=b5[b4];
while(b6&&b6.nodeType!==9&&(b7===aF||b6.nodeType!==1||!bK(b6).is(b7))){if(b6.nodeType===1){b3.push(b6)
}b6=b6[b4]
}return b3
},sibling:function(b5,b4){var b3=[];
for(;
b5;
b5=b5.nextSibling){if(b5.nodeType===1&&b5!==b4){b3.push(b5)
}}return b3
}});
function aQ(b6,b5,b3){b5=b5||0;
if(bK.isFunction(b5)){return bK.grep(b6,function(b8,b7){var b9=!!b5.call(b8,b7,b8);
return b9===b3
})
}else{if(b5.nodeType){return bK.grep(b6,function(b8,b7){return(b8===b5)===b3
})
}else{if(typeof b5==="string"){var b4=bK.grep(b6,function(b7){return b7.nodeType===1
});
if(ap.test(b5)){return bK.filter(b5,b4,!b3)
}else{b5=bK.filter(b5,b4)
}}}}return bK.grep(b6,function(b8,b7){return(bK.inArray(b8,b5)>=0)===b3
})
}function E(b3){var b5=d.split("|"),b4=b3.createDocumentFragment();
if(b4.createElement){while(b5.length){b4.createElement(b5.pop())
}}return b4
}var d="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",az=/ jQuery\d+="(?:null|\d+)"/g,b2=/^\s+/,aC=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,r=/<([\w:]+)/,bX=/<tbody/i,N=/<|&#?\w+;/,an=/<(?:script|style|link)/i,au=/<(?:script|object|embed|option|style)/i,O=new RegExp("<(?:"+d+")[\\s/>]","i"),aI=/^(?:checkbox|radio)$/,bV=/checked\s*(?:[^=]|=\s*.checked.)/i,bA=/\/(java|ecma)script/i,aL=/^\s*<!(?:\[CDATA\[|\-\-)|[\]\-]{2}>\s*$/g,X={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],area:[1,"<map>","</map>"],_default:[0,"",""]},aU=E(q),n=aU.appendChild(q.createElement("div"));
X.optgroup=X.option;
X.tbody=X.tfoot=X.colgroup=X.caption=X.thead;
X.th=X.td;
if(!bK.support.htmlSerialize){X._default=[1,"X<div>","</div>"]
}bK.fn.extend({text:function(b3){return bK.access(this,function(b4){return b4===aF?bK.text(this):this.empty().append((this[0]&&this[0].ownerDocument||q).createTextNode(b4))
},null,b3,arguments.length)
},wrapAll:function(b3){if(bK.isFunction(b3)){return this.each(function(b5){bK(this).wrapAll(b3.call(this,b5))
})
}if(this[0]){var b4=bK(b3,this[0].ownerDocument).eq(0).clone(true);
if(this[0].parentNode){b4.insertBefore(this[0])
}b4.map(function(){var b5=this;
while(b5.firstChild&&b5.firstChild.nodeType===1){b5=b5.firstChild
}return b5
}).append(this)
}return this
},wrapInner:function(b3){if(bK.isFunction(b3)){return this.each(function(b4){bK(this).wrapInner(b3.call(this,b4))
})
}return this.each(function(){var b4=bK(this),b5=b4.contents();
if(b5.length){b5.wrapAll(b3)
}else{b4.append(b3)
}})
},wrap:function(b3){var b4=bK.isFunction(b3);
return this.each(function(b5){bK(this).wrapAll(b4?b3.call(this,b5):b3)
})
},unwrap:function(){return this.parent().each(function(){if(!bK.nodeName(this,"body")){bK(this).replaceWith(this.childNodes)
}}).end()
},append:function(){return this.domManip(arguments,true,function(b3){if(this.nodeType===1||this.nodeType===11){this.appendChild(b3)
}})
},prepend:function(){return this.domManip(arguments,true,function(b3){if(this.nodeType===1||this.nodeType===11){this.insertBefore(b3,this.firstChild)
}})
},before:function(){if(!aV(this[0])){return this.domManip(arguments,false,function(b4){this.parentNode.insertBefore(b4,this)
})
}if(arguments.length){var b3=bK.clean(arguments);
return this.pushStack(bK.merge(b3,this),"before",this.selector)
}},after:function(){if(!aV(this[0])){return this.domManip(arguments,false,function(b4){this.parentNode.insertBefore(b4,this.nextSibling)
})
}if(arguments.length){var b3=bK.clean(arguments);
return this.pushStack(bK.merge(this,b3),"after",this.selector)
}},remove:function(b3,b6){var b5,b4=0;
for(;
(b5=this[b4])!=null;
b4++){if(!b3||bK.filter(b3,[b5]).length){if(!b6&&b5.nodeType===1){bK.cleanData(b5.getElementsByTagName("*"));
bK.cleanData([b5])
}if(b5.parentNode){b5.parentNode.removeChild(b5)
}}}return this
},empty:function(){var b4,b3=0;
for(;
(b4=this[b3])!=null;
b3++){if(b4.nodeType===1){bK.cleanData(b4.getElementsByTagName("*"))
}while(b4.firstChild){b4.removeChild(b4.firstChild)
}}return this
},clone:function(b4,b3){b4=b4==null?false:b4;
b3=b3==null?b4:b3;
return this.map(function(){return bK.clone(this,b4,b3)
})
},html:function(b3){return bK.access(this,function(b7){var b6=this[0]||{},b5=0,b4=this.length;
if(b7===aF){return b6.nodeType===1?b6.innerHTML.replace(az,""):aF
}if(typeof b7==="string"&&!an.test(b7)&&(bK.support.htmlSerialize||!O.test(b7))&&(bK.support.leadingWhitespace||!b2.test(b7))&&!X[(r.exec(b7)||["",""])[1].toLowerCase()]){b7=b7.replace(aC,"<$1></$2>");
try{for(;
b5<b4;
b5++){b6=this[b5]||{};
if(b6.nodeType===1){bK.cleanData(b6.getElementsByTagName("*"));
b6.innerHTML=b7
}}b6=0
}catch(b8){}}if(b6){this.empty().append(b7)
}},null,b3,arguments.length)
},replaceWith:function(b3){if(!aV(this[0])){if(bK.isFunction(b3)){return this.each(function(b6){var b5=bK(this),b4=b5.html();
b5.replaceWith(b3.call(this,b6,b4))
})
}if(typeof b3!=="string"){b3=bK(b3).detach()
}return this.each(function(){var b5=this.nextSibling,b4=this.parentNode;
bK(this).remove();
if(b5){bK(b5).before(b3)
}else{bK(b4).append(b3)
}})
}return this.length?this.pushStack(bK(bK.isFunction(b3)?b3():b3),"replaceWith",b3):this
},detach:function(b3){return this.remove(b3,true)
},domManip:function(b9,cd,cc){b9=[].concat.apply([],b9);
var b5,b7,b8,cb,b6=0,ca=b9[0],b4=[],b3=this.length;
if(!bK.support.checkClone&&b3>1&&typeof ca==="string"&&bV.test(ca)){return this.each(function(){bK(this).domManip(b9,cd,cc)
})
}if(bK.isFunction(ca)){return this.each(function(cf){var ce=bK(this);
b9[0]=ca.call(this,cf,cd?ce.html():aF);
ce.domManip(b9,cd,cc)
})
}if(this[0]){b5=bK.buildFragment(b9,this,b4);
b8=b5.fragment;
b7=b8.firstChild;
if(b8.childNodes.length===1){b8=b7
}if(b7){cd=cd&&bK.nodeName(b7,"tr");
for(cb=b5.cacheable||b3-1;
b6<b3;
b6++){cc.call(cd&&bK.nodeName(this[b6],"table")?B(this[b6],"tbody"):this[b6],b6===cb?b8:bK.clone(b8,true,true))
}}b8=b7=null;
if(b4.length){bK.each(b4,function(ce,cf){if(cf.src){if(bK.ajax){bK.ajax({url:cf.src,type:"GET",dataType:"script",async:false,global:false,"throws":true})
}else{bK.error("no ajax")
}}else{bK.globalEval((cf.text||cf.textContent||cf.innerHTML||"").replace(aL,""))
}if(cf.parentNode){cf.parentNode.removeChild(cf)
}})
}}return this
}});
function B(b4,b3){return b4.getElementsByTagName(b3)[0]||b4.appendChild(b4.ownerDocument.createElement(b3))
}function at(ca,b4){if(b4.nodeType!==1||!bK.hasData(ca)){return
}var b7,b6,b3,b9=bK._data(ca),b8=bK._data(b4,b9),b5=b9.events;
if(b5){delete b8.handle;
b8.events={};
for(b7 in b5){for(b6=0,b3=b5[b7].length;
b6<b3;
b6++){bK.event.add(b4,b7,b5[b7][b6])
}}}if(b8.data){b8.data=bK.extend({},b8.data)
}}function J(b4,b3){var b5;
if(b3.nodeType!==1){return
}if(b3.clearAttributes){b3.clearAttributes()
}if(b3.mergeAttributes){b3.mergeAttributes(b4)
}b5=b3.nodeName.toLowerCase();
if(b5==="object"){if(b3.parentNode){b3.outerHTML=b4.outerHTML
}if(bK.support.html5Clone&&(b4.innerHTML&&!bK.trim(b3.innerHTML))){b3.innerHTML=b4.innerHTML
}}else{if(b5==="input"&&aI.test(b4.type)){b3.defaultChecked=b3.checked=b4.checked;
if(b3.value!==b4.value){b3.value=b4.value
}}else{if(b5==="option"){b3.selected=b4.defaultSelected
}else{if(b5==="input"||b5==="textarea"){b3.defaultValue=b4.defaultValue
}else{if(b5==="script"&&b3.text!==b4.text){b3.text=b4.text
}}}}}b3.removeAttribute(bK.expando)
}bK.buildFragment=function(b6,b7,b4){var b5,b3,b8,b9=b6[0];
b7=b7||q;
b7=!b7.nodeType&&b7[0]||b7;
b7=b7.ownerDocument||b7;
if(b6.length===1&&typeof b9==="string"&&b9.length<512&&b7===q&&b9.charAt(0)==="<"&&!au.test(b9)&&(bK.support.checkClone||!bV.test(b9))&&(bK.support.html5Clone||!O.test(b9))){b3=true;
b5=bK.fragments[b9];
b8=b5!==aF
}if(!b5){b5=b7.createDocumentFragment();
bK.clean(b6,b7,b5,b4);
if(b3){bK.fragments[b9]=b8&&b5
}}return{fragment:b5,cacheable:b3}
};
bK.fragments={};
bK.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(b3,b4){bK.fn[b3]=function(b5){var b7,b9=0,b8=[],cb=bK(b5),b6=cb.length,ca=this.length===1&&this[0].parentNode;
if((ca==null||ca&&ca.nodeType===11&&ca.childNodes.length===1)&&b6===1){cb[b4](this[0]);
return this
}else{for(;
b9<b6;
b9++){b7=(b9>0?this.clone(true):this).get();
bK(cb[b9])[b4](b7);
b8=b8.concat(b7)
}return this.pushStack(b8,b3,cb.selector)
}}
});
function o(b3){if(typeof b3.getElementsByTagName!=="undefined"){return b3.getElementsByTagName("*")
}else{if(typeof b3.querySelectorAll!=="undefined"){return b3.querySelectorAll("*")
}else{return[]
}}}function bW(b3){if(aI.test(b3.type)){b3.defaultChecked=b3.checked
}}bK.extend({clone:function(b7,b9,b5){var b3,b4,b6,b8;
if(bK.support.html5Clone||bK.isXMLDoc(b7)||!O.test("<"+b7.nodeName+">")){b8=b7.cloneNode(true)
}else{n.innerHTML=b7.outerHTML;
n.removeChild(b8=n.firstChild)
}if((!bK.support.noCloneEvent||!bK.support.noCloneChecked)&&(b7.nodeType===1||b7.nodeType===11)&&!bK.isXMLDoc(b7)){J(b7,b8);
b3=o(b7);
b4=o(b8);
for(b6=0;
b3[b6];
++b6){if(b4[b6]){J(b3[b6],b4[b6])
}}}if(b9){at(b7,b8);
if(b5){b3=o(b7);
b4=o(b8);
for(b6=0;
b3[b6];
++b6){at(b3[b6],b4[b6])
}}}b3=b4=null;
return b8
},clean:function(cg,b5,b3,b6){var cd,cc,cf,ck,b9,cj,ca,b7,b4,ce,ci,cb,b8=b5===q&&aU,ch=[];
if(!b5||typeof b5.createDocumentFragment==="undefined"){b5=q
}for(cd=0;
(cf=cg[cd])!=null;
cd++){if(typeof cf==="number"){cf+=""
}if(!cf){continue
}if(typeof cf==="string"){if(!N.test(cf)){cf=b5.createTextNode(cf)
}else{b8=b8||E(b5);
ca=b5.createElement("div");
b8.appendChild(ca);
cf=cf.replace(aC,"<$1></$2>");
ck=(r.exec(cf)||["",""])[1].toLowerCase();
b9=X[ck]||X._default;
cj=b9[0];
ca.innerHTML=b9[1]+cf+b9[2];
while(cj--){ca=ca.lastChild
}if(!bK.support.tbody){b7=bX.test(cf);
b4=ck==="table"&&!b7?ca.firstChild&&ca.firstChild.childNodes:b9[1]==="<table>"&&!b7?ca.childNodes:[];
for(cc=b4.length-1;
cc>=0;
--cc){if(bK.nodeName(b4[cc],"tbody")&&!b4[cc].childNodes.length){b4[cc].parentNode.removeChild(b4[cc])
}}}if(!bK.support.leadingWhitespace&&b2.test(cf)){ca.insertBefore(b5.createTextNode(b2.exec(cf)[0]),ca.firstChild)
}cf=ca.childNodes;
ca.parentNode.removeChild(ca)
}}if(cf.nodeType){ch.push(cf)
}else{bK.merge(ch,cf)
}}if(ca){cf=ca=b8=null
}if(!bK.support.appendChecked){for(cd=0;
(cf=ch[cd])!=null;
cd++){if(bK.nodeName(cf,"input")){bW(cf)
}else{if(typeof cf.getElementsByTagName!=="undefined"){bK.grep(cf.getElementsByTagName("input"),bW)
}}}}if(b3){ci=function(cl){if(!cl.type||bA.test(cl.type)){return b6?b6.push(cl.parentNode?cl.parentNode.removeChild(cl):cl):b3.appendChild(cl)
}};
for(cd=0;
(cf=ch[cd])!=null;
cd++){if(!(bK.nodeName(cf,"script")&&ci(cf))){b3.appendChild(cf);
if(typeof cf.getElementsByTagName!=="undefined"){cb=bK.grep(bK.merge([],cf.getElementsByTagName("script")),ci);
ch.splice.apply(ch,[cd+1,0].concat(cb));
cd+=cb.length
}}}}return ch
},cleanData:function(b4,cc){var b7,b5,b6,cb,b8=0,cd=bK.expando,b3=bK.cache,b9=bK.support.deleteExpando,ca=bK.event.special;
for(;
(b6=b4[b8])!=null;
b8++){if(cc||bK.acceptData(b6)){b5=b6[cd];
b7=b5&&b3[b5];
if(b7){if(b7.events){for(cb in b7.events){if(ca[cb]){bK.event.remove(b6,cb)
}else{bK.removeEvent(b6,cb,b7.handle)
}}}if(b3[b5]){delete b3[b5];
if(b9){delete b6[cd]
}else{if(b6.removeAttribute){b6.removeAttribute(cd)
}else{b6[cd]=null
}}bK.deletedIds.push(b5)
}}}}}});
(function(){var b3,b4;
bK.uaMatch=function(b6){b6=b6.toLowerCase();
var b5=/(chrome)[ \/]([\w.]+)/.exec(b6)||/(webkit)[ \/]([\w.]+)/.exec(b6)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b6)||/(msie) ([\w.]+)/.exec(b6)||b6.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b6)||[];
return{browser:b5[1]||"",version:b5[2]||"0"}
};
b3=bK.uaMatch(f.userAgent);
b4={};
if(b3.browser){b4[b3.browser]=true;
b4.version=b3.version
}if(b4.chrome){b4.webkit=true
}else{if(b4.webkit){b4.safari=true
}}bK.browser=b4;
bK.sub=function(){function b5(b8,b9){return new b5.fn.init(b8,b9)
}bK.extend(true,b5,this);
b5.superclass=this;
b5.fn=b5.prototype=this();
b5.fn.constructor=b5;
b5.sub=this.sub;
b5.fn.init=function b7(b8,b9){if(b9&&b9 instanceof bK&&!(b9 instanceof b5)){b9=b5(b9)
}return bK.fn.init.call(this,b8,b9,b6)
};
b5.fn.init.prototype=b5.fn;
var b6=b5(q);
return b5
}
})();
var I,aD,a0,bi=/alpha\([^)]*\)/i,aW=/opacity=([^)]*)/,bo=/^(top|right|bottom|left)$/,K=/^(none|table(?!-c[ea]).+)/,a3=/^margin/,bc=new RegExp("^("+bB+")(.*)$","i"),aa=new RegExp("^("+bB+")(?!px)[a-z%]+$","i"),W=new RegExp("^([-+])=("+bB+")","i"),bl={},bd={position:"absolute",visibility:"hidden",display:"block"},bE={letterSpacing:0,fontWeight:400},bU=["Top","Right","Bottom","Left"],aw=["Webkit","O","Moz","ms"],aN=bK.fn.toggle;
function b(b6,b4){if(b4 in b6){return b4
}var b7=b4.charAt(0).toUpperCase()+b4.slice(1),b3=b4,b5=aw.length;
while(b5--){b4=aw[b5]+b7;
if(b4 in b6){return b4
}}return b3
}function U(b4,b3){b4=b3||b4;
return bK.css(b4,"display")==="none"||!bK.contains(b4.ownerDocument,b4)
}function u(b8,b3){var b7,b9,b4=[],b5=0,b6=b8.length;
for(;
b5<b6;
b5++){b7=b8[b5];
if(!b7.style){continue
}b4[b5]=bK._data(b7,"olddisplay");
if(b3){if(!b4[b5]&&b7.style.display==="none"){b7.style.display=""
}if(b7.style.display===""&&U(b7)){b4[b5]=bK._data(b7,"olddisplay",bG(b7.nodeName))
}}else{b9=I(b7,"display");
if(!b4[b5]&&b9!=="none"){bK._data(b7,"olddisplay",b9)
}}}for(b5=0;
b5<b6;
b5++){b7=b8[b5];
if(!b7.style){continue
}if(!b3||b7.style.display==="none"||b7.style.display===""){b7.style.display=b3?b4[b5]||"":"none"
}}return b8
}bK.fn.extend({css:function(b3,b4){return bK.access(this,function(b6,b5,b7){return b7!==aF?bK.style(b6,b5,b7):bK.css(b6,b5)
},b3,b4,arguments.length>1)
},show:function(){return u(this,true)
},hide:function(){return u(this)
},toggle:function(b5,b4){var b3=typeof b5==="boolean";
if(bK.isFunction(b5)&&bK.isFunction(b4)){return aN.apply(this,arguments)
}return this.each(function(){if(b3?b5:U(this)){bK(this).show()
}else{bK(this).hide()
}})
}});
bK.extend({cssHooks:{opacity:{get:function(b5,b4){if(b4){var b3=I(b5,"opacity");
return b3===""?"1":b3
}}}},cssNumber:{fillOpacity:true,fontWeight:true,lineHeight:true,opacity:true,orphans:true,widows:true,zIndex:true,zoom:true},cssProps:{"float":bK.support.cssFloat?"cssFloat":"styleFloat"},style:function(b5,b4,cb,b6){if(!b5||b5.nodeType===3||b5.nodeType===8||!b5.style){return
}var b9,ca,cc,b7=bK.camelCase(b4),b3=b5.style;
b4=bK.cssProps[b7]||(bK.cssProps[b7]=b(b3,b7));
cc=bK.cssHooks[b4]||bK.cssHooks[b7];
if(cb!==aF){ca=typeof cb;
if(ca==="string"&&(b9=W.exec(cb))){cb=(b9[1]+1)*b9[2]+parseFloat(bK.css(b5,b4));
ca="number"
}if(cb==null||ca==="number"&&isNaN(cb)){return
}if(ca==="number"&&!bK.cssNumber[b7]){cb+="px"
}if(!cc||!("set" in cc)||(cb=cc.set(b5,cb,b6))!==aF){try{b3[b4]=cb
}catch(b8){}}}else{if(cc&&"get" in cc&&(b9=cc.get(b5,false,b6))!==aF){return b9
}return b3[b4]
}},css:function(b9,b7,b8,b4){var ca,b6,b3,b5=bK.camelCase(b7);
b7=bK.cssProps[b5]||(bK.cssProps[b5]=b(b9.style,b5));
b3=bK.cssHooks[b7]||bK.cssHooks[b5];
if(b3&&"get" in b3){ca=b3.get(b9,true,b4)
}if(ca===aF){ca=I(b9,b7)
}if(ca==="normal"&&b7 in bE){ca=bE[b7]
}if(b8||b4!==aF){b6=parseFloat(ca);
return b8||bK.isNumeric(b6)?b6||0:ca
}return ca
},swap:function(b7,b6,b8){var b5,b4,b3={};
for(b4 in b6){b3[b4]=b7.style[b4];
b7.style[b4]=b6[b4]
}b5=b8.call(b7);
for(b4 in b6){b7.style[b4]=b3[b4]
}return b5
}});
if(a6.getComputedStyle){I=function(ca,b4){var b3,b7,b6,b9,b8=a6.getComputedStyle(ca,null),b5=ca.style;
if(b8){b3=b8[b4];
if(b3===""&&!bK.contains(ca.ownerDocument,ca)){b3=bK.style(ca,b4)
}if(aa.test(b3)&&a3.test(b4)){b7=b5.width;
b6=b5.minWidth;
b9=b5.maxWidth;
b5.minWidth=b5.maxWidth=b5.width=b3;
b3=b8.width;
b5.width=b7;
b5.minWidth=b6;
b5.maxWidth=b9
}}return b3
}
}else{if(q.documentElement.currentStyle){I=function(b7,b5){var b8,b3,b4=b7.currentStyle&&b7.currentStyle[b5],b6=b7.style;
if(b4==null&&b6&&b6[b5]){b4=b6[b5]
}if(aa.test(b4)&&!bo.test(b5)){b8=b6.left;
b3=b7.runtimeStyle&&b7.runtimeStyle.left;
if(b3){b7.runtimeStyle.left=b7.currentStyle.left
}b6.left=b5==="fontSize"?"1em":b4;
b4=b6.pixelLeft+"px";
b6.left=b8;
if(b3){b7.runtimeStyle.left=b3
}}return b4===""?"auto":b4
}
}}function aK(b3,b5,b6){var b4=bc.exec(b5);
return b4?Math.max(0,b4[1]-(b6||0))+(b4[2]||"px"):b5
}function ax(b6,b4,b3,b8){var b5=b3===(b8?"border":"content")?4:b4==="width"?1:0,b7=0;
for(;
b5<4;
b5+=2){if(b3==="margin"){b7+=bK.css(b6,b3+bU[b5],true)
}if(b8){if(b3==="content"){b7-=parseFloat(I(b6,"padding"+bU[b5]))||0
}if(b3!=="margin"){b7-=parseFloat(I(b6,"border"+bU[b5]+"Width"))||0
}}else{b7+=parseFloat(I(b6,"padding"+bU[b5]))||0;
if(b3!=="padding"){b7+=parseFloat(I(b6,"border"+bU[b5]+"Width"))||0
}}}return b7
}function w(b6,b4,b3){var b7=b4==="width"?b6.offsetWidth:b6.offsetHeight,b5=true,b8=bK.support.boxSizing&&bK.css(b6,"boxSizing")==="border-box";
if(b7<=0||b7==null){b7=I(b6,b4);
if(b7<0||b7==null){b7=b6.style[b4]
}if(aa.test(b7)){return b7
}b5=b8&&(bK.support.boxSizingReliable||b7===b6.style[b4]);
b7=parseFloat(b7)||0
}return(b7+ax(b6,b4,b3||(b8?"border":"content"),b5))+"px"
}function bG(b5){if(bl[b5]){return bl[b5]
}var b3=bK("<"+b5+">").appendTo(q.body),b4=b3.css("display");
b3.remove();
if(b4==="none"||b4===""){aD=q.body.appendChild(aD||bK.extend(q.createElement("iframe"),{frameBorder:0,width:0,height:0}));
if(!a0||!aD.createElement){a0=(aD.contentWindow||aD.contentDocument).document;
a0.write("<!doctype html><html><body>");
a0.close()
}b3=a0.body.appendChild(a0.createElement(b5));
b4=I(b3,"display");
q.body.removeChild(aD)
}bl[b5]=b4;
return b4
}bK.each(["height","width"],function(b4,b3){bK.cssHooks[b3]={get:function(b7,b6,b5){if(b6){if(b7.offsetWidth===0&&K.test(I(b7,"display"))){return bK.swap(b7,bd,function(){return w(b7,b3,b5)
})
}else{return w(b7,b3,b5)
}}},set:function(b6,b7,b5){return aK(b6,b7,b5?ax(b6,b3,b5,bK.support.boxSizing&&bK.css(b6,"boxSizing")==="border-box"):0)
}}
});
if(!bK.support.opacity){bK.cssHooks.opacity={get:function(b4,b3){return aW.test((b3&&b4.currentStyle?b4.currentStyle.filter:b4.style.filter)||"")?(0.01*parseFloat(RegExp.$1))+"":b3?"1":""
},set:function(b7,b8){var b6=b7.style,b4=b7.currentStyle,b3=bK.isNumeric(b8)?"alpha(opacity="+b8*100+")":"",b5=b4&&b4.filter||b6.filter||"";
b6.zoom=1;
if(b8>=1&&bK.trim(b5.replace(bi,""))===""&&b6.removeAttribute){b6.removeAttribute("filter");
if(b4&&!b4.filter){return
}}b6.filter=bi.test(b5)?b5.replace(bi,b3):b5+" "+b3
}}
}bK(function(){if(!bK.support.reliableMarginRight){bK.cssHooks.marginRight={get:function(b4,b3){return bK.swap(b4,{display:"inline-block"},function(){if(b3){return I(b4,"marginRight")
}})
}}
}if(!bK.support.pixelPosition&&bK.fn.position){bK.each(["top","left"],function(b3,b4){bK.cssHooks[b4]={get:function(b7,b6){if(b6){var b5=I(b7,b4);
return aa.test(b5)?bK(b7).position()[b4]+"px":b5
}}}
})
}});
if(bK.expr&&bK.expr.filters){bK.expr.filters.hidden=function(b3){return(b3.offsetWidth===0&&b3.offsetHeight===0)||(!bK.support.reliableHiddenOffsets&&((b3.style&&b3.style.display)||I(b3,"display"))==="none")
};
bK.expr.filters.visible=function(b3){return !bK.expr.filters.hidden(b3)
}
}bK.each({margin:"",padding:"",border:"Width"},function(b3,b4){bK.cssHooks[b3+b4]={expand:function(b7){var b6,b8=typeof b7==="string"?b7.split(" "):[b7],b5={};
for(b6=0;
b6<4;
b6++){b5[b3+bU[b6]+b4]=b8[b6]||b8[b6-2]||b8[0]
}return b5
}};
if(!a3.test(b3)){bK.cssHooks[b3+b4].set=aK
}});
var bw=/%20/g,aT=/\[\]$/,Y=/\r?\n/g,bD=/^(?:color|date|datetime|datetime-local|email|hidden|month|number|password|range|search|tel|text|time|url|week)$/i,aH=/^(?:select|textarea)/i;
bK.fn.extend({serialize:function(){return bK.param(this.serializeArray())
},serializeArray:function(){return this.map(function(){return this.elements?bK.makeArray(this.elements):this
}).filter(function(){return this.name&&!this.disabled&&(this.checked||aH.test(this.nodeName)||bD.test(this.type))
}).map(function(b3,b4){var b5=bK(this).val();
return b5==null?null:bK.isArray(b5)?bK.map(b5,function(b7,b6){return{name:b4.name,value:b7.replace(Y,"\r\n")}
}):{name:b4.name,value:b5.replace(Y,"\r\n")}
}).get()
}});
bK.param=function(b3,b5){var b6,b4=[],b7=function(b8,b9){b9=bK.isFunction(b9)?b9():(b9==null?"":b9);
b4[b4.length]=encodeURIComponent(b8)+"="+encodeURIComponent(b9)
};
if(b5===aF){b5=bK.ajaxSettings&&bK.ajaxSettings.traditional
}if(bK.isArray(b3)||(b3.jquery&&!bK.isPlainObject(b3))){bK.each(b3,function(){b7(this.name,this.value)
})
}else{for(b6 in b3){m(b6,b3[b6],b5,b7)
}}return b4.join("&").replace(bw,"+")
};
function m(b5,b7,b4,b6){var b3;
if(bK.isArray(b7)){bK.each(b7,function(b9,b8){if(b4||aT.test(b5)){b6(b5,b8)
}else{m(b5+"["+(typeof b8==="object"?b9:"")+"]",b8,b4,b6)
}})
}else{if(!b4&&bK.type(b7)==="object"){for(b3 in b7){m(b5+"["+b3+"]",b7[b3],b4,b6)
}}else{b6(b5,b7)
}}}var ac,b1,ar=/#.*$/,ah=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,F=/^(?:about|app|app\-storage|.+\-extension|file|res|widget):$/,t=/^(?:GET|HEAD)$/,aG=/^\/\//,bR=/\?/,h=/<script\b[^<]*(?:(?!<\/script>)<[^<]*)*<\/script>/gi,T=/([?&])_=[^&]*/,aX=/^([\w\+\.\-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,b0=bK.fn.load,z={},ba={},a1=["*/"]+["*"];
try{ac=aM.href
}catch(bh){ac=q.createElement("a");
ac.href="";
ac=ac.href
}b1=aX.exec(ac.toLowerCase())||[];
function bM(b3){return function(b7,b9){if(typeof b7!=="string"){b9=b7;
b7="*"
}var b4,ca,cb,b6=b7.toLowerCase().split(aZ),b5=0,b8=b6.length;
if(bK.isFunction(b9)){for(;
b5<b8;
b5++){b4=b6[b5];
cb=/^\+/.test(b4);
if(cb){b4=b4.substr(1)||"*"
}ca=b3[b4]=b3[b4]||[];
ca[cb?"unshift":"push"](b9)
}}}
}function s(b4,cd,b8,cb,ca,b6){ca=ca||cd.dataTypes[0];
b6=b6||{};
b6[ca]=true;
var cc,b9=b4[ca],b5=0,b3=b9?b9.length:0,b7=(b4===z);
for(;
b5<b3&&(b7||!cc);
b5++){cc=b9[b5](cd,b8,cb);
if(typeof cc==="string"){if(!b7||b6[cc]){cc=aF
}else{cd.dataTypes.unshift(cc);
cc=s(b4,cd,b8,cb,cc,b6)
}}}if((b7||!cc)&&!b6["*"]){cc=s(b4,cd,b8,cb,"*",b6)
}return cc
}function v(b5,b6){var b4,b3,b7=bK.ajaxSettings.flatOptions||{};
for(b4 in b6){if(b6[b4]!==aF){(b7[b4]?b5:(b3||(b3={})))[b4]=b6[b4]
}}if(b3){bK.extend(true,b5,b3)
}}bK.fn.load=function(b6,b9,ca){if(typeof b6!=="string"&&b0){return b0.apply(this,arguments)
}if(!this.length){return this
}var b3,b7,b5,b4=this,b8=b6.indexOf(" ");
if(b8>=0){b3=b6.slice(b8,b6.length);
b6=b6.slice(0,b8)
}if(bK.isFunction(b9)){ca=b9;
b9=aF
}else{if(b9&&typeof b9==="object"){b7="POST"
}}bK.ajax({url:b6,type:b7,dataType:"html",data:b9,complete:function(cc,cb){if(ca){b4.each(ca,b5||[cc.responseText,cb,cc])
}}}).done(function(cb){b5=arguments;
b4.html(b3?bK("<div>").append(cb.replace(h,"")).find(b3):cb)
});
return this
};
bK.each("ajaxStart ajaxStop ajaxComplete ajaxError ajaxSuccess ajaxSend".split(" "),function(b3,b4){bK.fn[b4]=function(b5){return this.on(b4,b5)
}
});
bK.each(["get","post"],function(b3,b4){bK[b4]=function(b5,b7,b8,b6){if(bK.isFunction(b7)){b6=b6||b8;
b8=b7;
b7=aF
}return bK.ajax({type:b4,url:b5,data:b7,success:b8,dataType:b6})
}
});
bK.extend({getScript:function(b3,b4){return bK.get(b3,aF,b4,"script")
},getJSON:function(b3,b4,b5){return bK.get(b3,b4,b5,"json")
},ajaxSetup:function(b4,b3){if(b3){v(b4,bK.ajaxSettings)
}else{b3=b4;
b4=bK.ajaxSettings
}v(b4,b3);
return b4
},ajaxSettings:{url:ac,isLocal:F.test(b1[1]),global:true,type:"GET",contentType:"application/x-www-form-urlencoded; charset=UTF-8",processData:true,async:true,accepts:{xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":a1},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText"},converters:{"* text":a6.String,"text html":true,"text json":bK.parseJSON,"text xml":bK.parseXML},flatOptions:{context:true,url:true}},ajaxPrefilter:bM(z),ajaxTransport:bM(ba),ajax:function(b8,b5){if(typeof b8==="object"){b5=b8;
b8=aF
}b5=b5||{};
var cb,cp,b6,ck,cd,ch,b4,cj,cc=bK.ajaxSetup({},b5),cr=cc.context||cc,cf=cr!==cc&&(cr.nodeType||cr instanceof bK)?bK(cr):bK.event,cq=bK.Deferred(),cm=bK.Callbacks("once memory"),b9=cc.statusCode||{},cg={},cn={},b7=0,ca="canceled",ci={readyState:0,setRequestHeader:function(ct,cu){if(!b7){var cs=ct.toLowerCase();
ct=cn[cs]=cn[cs]||ct;
cg[ct]=cu
}return this
},getAllResponseHeaders:function(){return b7===2?cp:null
},getResponseHeader:function(ct){var cs;
if(b7===2){if(!b6){b6={};
while((cs=ah.exec(cp))){b6[cs[1].toLowerCase()]=cs[2]
}}cs=b6[ct.toLowerCase()]
}return cs===aF?null:cs
},overrideMimeType:function(cs){if(!b7){cc.mimeType=cs
}return this
},abort:function(cs){cs=cs||ca;
if(ck){ck.abort(cs)
}ce(0,cs);
return this
}};
function ce(cx,ct,cy,cv){var cs,cB,cz,cw,cA,cu=ct;
if(b7===2){return
}b7=2;
if(cd){clearTimeout(cd)
}ck=aF;
cp=cv||"";
ci.readyState=cx>0?4:0;
if(cy){cw=j(cc,ci,cy)
}if(cx>=200&&cx<300||cx===304){if(cc.ifModified){cA=ci.getResponseHeader("Last-Modified");
if(cA){bK.lastModified[cb]=cA
}cA=ci.getResponseHeader("Etag");
if(cA){bK.etag[cb]=cA
}}if(cx===304){cu="notmodified";
cs=true
}else{cs=ai(cc,cw);
cu=cs.state;
cB=cs.data;
cz=cs.error;
cs=!cz
}}else{cz=cu;
if(!cu||cx){cu="error";
if(cx<0){cx=0
}}}ci.status=cx;
ci.statusText=""+(ct||cu);
if(cs){cq.resolveWith(cr,[cB,cu,ci])
}else{cq.rejectWith(cr,[ci,cu,cz])
}ci.statusCode(b9);
b9=aF;
if(b4){cf.trigger("ajax"+(cs?"Success":"Error"),[ci,cc,cs?cB:cz])
}cm.fireWith(cr,[ci,cu]);
if(b4){cf.trigger("ajaxComplete",[ci,cc]);
if(!(--bK.active)){bK.event.trigger("ajaxStop")
}}}cq.promise(ci);
ci.success=ci.done;
ci.error=ci.fail;
ci.complete=cm.add;
ci.statusCode=function(ct){if(ct){var cs;
if(b7<2){for(cs in ct){b9[cs]=[b9[cs],ct[cs]]
}}else{cs=ct[ci.status];
ci.always(cs)
}}return this
};
cc.url=((b8||cc.url)+"").replace(ar,"").replace(aG,b1[1]+"//");
cc.dataTypes=bK.trim(cc.dataType||"*").toLowerCase().split(aZ);
if(cc.crossDomain==null){ch=aX.exec(cc.url.toLowerCase());
cc.crossDomain=!!(ch&&(ch[1]!=b1[1]||ch[2]!=b1[2]||(ch[3]||(ch[1]==="http:"?80:443))!=(b1[3]||(b1[1]==="http:"?80:443))))
}if(cc.data&&cc.processData&&typeof cc.data!=="string"){cc.data=bK.param(cc.data,cc.traditional)
}s(z,cc,b5,ci);
if(b7===2){return ci
}b4=cc.global;
cc.type=cc.type.toUpperCase();
cc.hasContent=!t.test(cc.type);
if(b4&&bK.active++===0){bK.event.trigger("ajaxStart")
}if(!cc.hasContent){if(cc.data){cc.url+=(bR.test(cc.url)?"&":"?")+cc.data;
delete cc.data
}cb=cc.url;
if(cc.cache===false){var b3=bK.now(),co=cc.url.replace(T,"$1_="+b3);
cc.url=co+((co===cc.url)?(bR.test(cc.url)?"&":"?")+"_="+b3:"")
}}if(cc.data&&cc.hasContent&&cc.contentType!==false||b5.contentType){ci.setRequestHeader("Content-Type",cc.contentType)
}if(cc.ifModified){cb=cb||cc.url;
if(bK.lastModified[cb]){ci.setRequestHeader("If-Modified-Since",bK.lastModified[cb])
}if(bK.etag[cb]){ci.setRequestHeader("If-None-Match",bK.etag[cb])
}}ci.setRequestHeader("Accept",cc.dataTypes[0]&&cc.accepts[cc.dataTypes[0]]?cc.accepts[cc.dataTypes[0]]+(cc.dataTypes[0]!=="*"?", "+a1+"; q=0.01":""):cc.accepts["*"]);
for(cj in cc.headers){ci.setRequestHeader(cj,cc.headers[cj])
}if(cc.beforeSend&&(cc.beforeSend.call(cr,ci,cc)===false||b7===2)){return ci.abort()
}ca="abort";
for(cj in {success:1,error:1,complete:1}){ci[cj](cc[cj])
}ck=s(ba,cc,b5,ci);
if(!ck){ce(-1,"No Transport")
}else{ci.readyState=1;
if(b4){cf.trigger("ajaxSend",[ci,cc])
}if(cc.async&&cc.timeout>0){cd=setTimeout(function(){ci.abort("timeout")
},cc.timeout)
}try{b7=1;
ck.send(cg,ce)
}catch(cl){if(b7<2){ce(-1,cl)
}else{throw cl
}}}return ci
},active:0,lastModified:{},etag:{}});
function j(cc,cb,b8){var b7,b9,b6,b3,b4=cc.contents,ca=cc.dataTypes,b5=cc.responseFields;
for(b9 in b5){if(b9 in b8){cb[b5[b9]]=b8[b9]
}}while(ca[0]==="*"){ca.shift();
if(b7===aF){b7=cc.mimeType||cb.getResponseHeader("content-type")
}}if(b7){for(b9 in b4){if(b4[b9]&&b4[b9].test(b7)){ca.unshift(b9);
break
}}}if(ca[0] in b8){b6=ca[0]
}else{for(b9 in b8){if(!ca[0]||cc.converters[b9+" "+ca[0]]){b6=b9;
break
}if(!b3){b3=b9
}}b6=b6||b3
}if(b6){if(b6!==ca[0]){ca.unshift(b6)
}return b8[b6]
}}function ai(cd,b5){var cb,b3,b9,b7,ca=cd.dataTypes.slice(),b4=ca[0],cc={},b6=0;
if(cd.dataFilter){b5=cd.dataFilter(b5,cd.dataType)
}if(ca[1]){for(cb in cd.converters){cc[cb.toLowerCase()]=cd.converters[cb]
}}for(;
(b9=ca[++b6]);
){if(b9!=="*"){if(b4!=="*"&&b4!==b9){cb=cc[b4+" "+b9]||cc["* "+b9];
if(!cb){for(b3 in cc){b7=b3.split(" ");
if(b7[1]===b9){cb=cc[b4+" "+b7[0]]||cc["* "+b7[0]];
if(cb){if(cb===true){cb=cc[b3]
}else{if(cc[b3]!==true){b9=b7[0];
ca.splice(b6--,0,b9)
}}break
}}}}if(cb!==true){if(cb&&cd["throws"]){b5=cb(b5)
}else{try{b5=cb(b5)
}catch(b8){return{state:"parsererror",error:cb?b8:"No conversion from "+b4+" to "+b9}
}}}}b4=b9
}}return{state:"success",data:b5}
}var bt=[],aA=/\?/,a9=/(=)\?(?=&|$)|\?\?/,bp=bK.now();
bK.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var b3=bt.pop()||(bK.expando+"_"+(bp++));
this[b3]=true;
return b3
}});
bK.ajaxPrefilter("json jsonp",function(cd,b8,cc){var cb,b3,ca,b6=cd.data,b4=cd.url,b5=cd.jsonp!==false,b9=b5&&a9.test(b4),b7=b5&&!b9&&typeof b6==="string"&&!(cd.contentType||"").indexOf("application/x-www-form-urlencoded")&&a9.test(b6);
if(cd.dataTypes[0]==="jsonp"||b9||b7){cb=cd.jsonpCallback=bK.isFunction(cd.jsonpCallback)?cd.jsonpCallback():cd.jsonpCallback;
b3=a6[cb];
if(b9){cd.url=b4.replace(a9,"$1"+cb)
}else{if(b7){cd.data=b6.replace(a9,"$1"+cb)
}else{if(b5){cd.url+=(aA.test(b4)?"&":"?")+cd.jsonp+"="+cb
}}}cd.converters["script json"]=function(){if(!ca){bK.error(cb+" was not called")
}return ca[0]
};
cd.dataTypes[0]="json";
a6[cb]=function(){ca=arguments
};
cc.always(function(){a6[cb]=b3;
if(cd[cb]){cd.jsonpCallback=b8.jsonpCallback;
bt.push(cb)
}if(ca&&bK.isFunction(b3)){b3(ca[0])
}ca=b3=aF
});
return"script"
}});
bK.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/javascript|ecmascript/},converters:{"text script":function(b3){bK.globalEval(b3);
return b3
}}});
bK.ajaxPrefilter("script",function(b3){if(b3.cache===aF){b3.cache=false
}if(b3.crossDomain){b3.type="GET";
b3.global=false
}});
bK.ajaxTransport("script",function(b5){if(b5.crossDomain){var b3,b4=q.head||q.getElementsByTagName("head")[0]||q.documentElement;
return{send:function(b6,b7){b3=q.createElement("script");
b3.async="async";
if(b5.scriptCharset){b3.charset=b5.scriptCharset
}b3.src=b5.url;
b3.onload=b3.onreadystatechange=function(b9,b8){if(b8||!b3.readyState||/loaded|complete/.test(b3.readyState)){b3.onload=b3.onreadystatechange=null;
if(b4&&b3.parentNode){b4.removeChild(b3)
}b3=aF;
if(!b8){b7(200,"success")
}}};
b4.insertBefore(b3,b4.firstChild)
},abort:function(){if(b3){b3.onload(0,1)
}}}
}});
var al,aR=a6.ActiveXObject?function(){for(var b3 in al){al[b3](0,1)
}}:false,ay=0;
function bF(){try{return new a6.XMLHttpRequest()
}catch(b3){}}function bf(){try{return new a6.ActiveXObject("Microsoft.XMLHTTP")
}catch(b3){}}bK.ajaxSettings.xhr=a6.ActiveXObject?function(){return !this.isLocal&&bF()||bf()
}:bF;
(function(b3){bK.extend(bK.support,{ajax:!!b3,cors:!!b3&&("withCredentials" in b3)})
})(bK.ajaxSettings.xhr());
if(bK.support.ajax){bK.ajaxTransport(function(b3){if(!b3.crossDomain||bK.support.cors){var b4;
return{send:function(ca,b5){var b8,b7,b9=b3.xhr();
if(b3.username){b9.open(b3.type,b3.url,b3.async,b3.username,b3.password)
}else{b9.open(b3.type,b3.url,b3.async)
}if(b3.xhrFields){for(b7 in b3.xhrFields){b9[b7]=b3.xhrFields[b7]
}}if(b3.mimeType&&b9.overrideMimeType){b9.overrideMimeType(b3.mimeType)
}if(!b3.crossDomain&&!ca["X-Requested-With"]){ca["X-Requested-With"]="XMLHttpRequest"
}try{for(b7 in ca){b9.setRequestHeader(b7,ca[b7])
}}catch(b6){}b9.send((b3.hasContent&&b3.data)||null);
b4=function(cj,cd){var ce,cc,cb,ch,cg;
try{if(b4&&(cd||b9.readyState===4)){b4=aF;
if(b8){b9.onreadystatechange=bK.noop;
if(aR){delete al[b8]
}}if(cd){if(b9.readyState!==4){b9.abort()
}}else{ce=b9.status;
cb=b9.getAllResponseHeaders();
ch={};
cg=b9.responseXML;
if(cg&&cg.documentElement){ch.xml=cg
}try{ch.text=b9.responseText
}catch(cj){}try{cc=b9.statusText
}catch(ci){cc=""
}if(!ce&&b3.isLocal&&!b3.crossDomain){ce=ch.text?200:404
}else{if(ce===1223){ce=204
}}}}}catch(cf){if(!cd){b5(-1,cf)
}}if(ch){b5(ce,cc,ch,cb)
}};
if(!b3.async){b4()
}else{if(b9.readyState===4){setTimeout(b4,0)
}else{b8=++ay;
if(aR){if(!al){al={};
bK(a6).unload(aR)
}al[b8]=b4
}b9.onreadystatechange=b4
}}},abort:function(){if(b4){b4(0,1)
}}}
}})
}var P,af,bS=/^(?:toggle|show|hide)$/,bL=new RegExp("^(?:([-+])=|)("+bB+")([a-z%]*)$","i"),bQ=/queueHooks$/,aB=[k],a5={"*":[function(b4,ca){var b7,cb,b3,cc=this.createTween(b4,ca),b8=bL.exec(ca),b9=cc.cur(),b5=+b9||0,b6=1;
if(b8){b7=+b8[2];
cb=b8[3]||(bK.cssNumber[b4]?"":"px");
if(cb!=="px"&&b5){b5=bK.css(cc.elem,b4,true)||b7||1;
do{b3=b6=b6||".5";
b5=b5/b6;
bK.style(cc.elem,b4,b5+cb);
b6=cc.cur()/b9
}while(b6!==1&&b6!==b3)
}cc.unit=cb;
cc.start=b5;
cc.end=b8[1]?b5+(b8[1]+1)*b7:b7
}return cc
}]};
function bn(){setTimeout(function(){P=aF
},0);
return(P=bK.now())
}function bg(b4,b3){bK.each(b3,function(b9,b7){var b8=(a5[b9]||[]).concat(a5["*"]),b5=0,b6=b8.length;
for(;
b5<b6;
b5++){if(b8[b5].call(b4,b9,b7)){return
}}})
}function g(b5,b9,cc){var cd,b8=0,b3=0,b4=aB.length,cb=bK.Deferred().always(function(){delete b7.elem
}),b7=function(){var ci=P||bn(),cf=Math.max(0,b6.startTime+b6.duration-ci),ch=1-(cf/b6.duration||0),ce=0,cg=b6.tweens.length;
for(;
ce<cg;
ce++){b6.tweens[ce].run(ch)
}cb.notifyWith(b5,[b6,ch,cf]);
if(ch<1&&cg){return cf
}else{cb.resolveWith(b5,[b6]);
return false
}},b6=cb.promise({elem:b5,props:bK.extend({},b9),opts:bK.extend(true,{specialEasing:{}},cc),originalProperties:b9,originalOptions:cc,startTime:P||bn(),duration:cc.duration,tweens:[],createTween:function(ch,ce,cg){var cf=bK.Tween(b5,b6.opts,ch,ce,b6.opts.specialEasing[ch]||b6.opts.easing);
b6.tweens.push(cf);
return cf
},stop:function(cf){var ce=0,cg=cf?b6.tweens.length:0;
for(;
ce<cg;
ce++){b6.tweens[ce].run(1)
}if(cf){cb.resolveWith(b5,[b6,cf])
}else{cb.rejectWith(b5,[b6,cf])
}return this
}}),ca=b6.props;
ao(ca,b6.opts.specialEasing);
for(;
b8<b4;
b8++){cd=aB[b8].call(b6,b5,ca,b6.opts);
if(cd){return cd
}}bg(b6,ca);
if(bK.isFunction(b6.opts.start)){b6.opts.start.call(b5,b6)
}bK.fx.timer(bK.extend(b7,{anim:b6,queue:b6.opts.queue,elem:b5}));
return b6.progress(b6.opts.progress).done(b6.opts.done,b6.opts.complete).fail(b6.opts.fail).always(b6.opts.always)
}function ao(b6,b8){var b5,b4,b9,b7,b3;
for(b5 in b6){b4=bK.camelCase(b5);
b9=b8[b4];
b7=b6[b5];
if(bK.isArray(b7)){b9=b7[1];
b7=b6[b5]=b7[0]
}if(b5!==b4){b6[b4]=b7;
delete b6[b5]
}b3=bK.cssHooks[b4];
if(b3&&"expand" in b3){b7=b3.expand(b7);
delete b6[b4];
for(b5 in b7){if(!(b5 in b6)){b6[b5]=b7[b5];
b8[b5]=b9
}}}else{b8[b4]=b9
}}}bK.Animation=bK.extend(g,{tweener:function(b4,b7){if(bK.isFunction(b4)){b7=b4;
b4=["*"]
}else{b4=b4.split(" ")
}var b6,b3=0,b5=b4.length;
for(;
b3<b5;
b3++){b6=b4[b3];
a5[b6]=a5[b6]||[];
a5[b6].unshift(b7)
}},prefilter:function(b4,b3){if(b3){aB.unshift(b4)
}else{aB.push(b4)
}}});
function k(b7,cc,b3){var cb,b5,ce,b6,ci,ch,cg,cf,b8=this,b4=b7.style,cd={},ca=[],b9=b7.nodeType&&U(b7);
if(!b3.queue){cg=bK._queueHooks(b7,"fx");
if(cg.unqueued==null){cg.unqueued=0;
cf=cg.empty.fire;
cg.empty.fire=function(){if(!cg.unqueued){cf()
}}
}cg.unqueued++;
b8.always(function(){b8.always(function(){cg.unqueued--;
if(!bK.queue(b7,"fx").length){cg.empty.fire()
}})
})
}if(b7.nodeType===1&&("height" in cc||"width" in cc)){b3.overflow=[b4.overflow,b4.overflowX,b4.overflowY];
if(bK.css(b7,"display")==="inline"&&bK.css(b7,"float")==="none"){if(!bK.support.inlineBlockNeedsLayout||bG(b7.nodeName)==="inline"){b4.display="inline-block"
}else{b4.zoom=1
}}}if(b3.overflow){b4.overflow="hidden";
if(!bK.support.shrinkWrapBlocks){b8.done(function(){b4.overflow=b3.overflow[0];
b4.overflowX=b3.overflow[1];
b4.overflowY=b3.overflow[2]
})
}}for(cb in cc){ce=cc[cb];
if(bS.exec(ce)){delete cc[cb];
if(ce===(b9?"hide":"show")){continue
}ca.push(cb)
}}b6=ca.length;
if(b6){ci=bK._data(b7,"fxshow")||bK._data(b7,"fxshow",{});
if(b9){bK(b7).show()
}else{b8.done(function(){bK(b7).hide()
})
}b8.done(function(){var cj;
bK.removeData(b7,"fxshow",true);
for(cj in cd){bK.style(b7,cj,cd[cj])
}});
for(cb=0;
cb<b6;
cb++){b5=ca[cb];
ch=b8.createTween(b5,b9?ci[b5]:0);
cd[b5]=ci[b5]||bK.style(b7,b5);
if(!(b5 in ci)){ci[b5]=ch.start;
if(b9){ch.end=ch.start;
ch.start=b5==="width"||b5==="height"?1:0
}}}}}function L(b5,b4,b7,b3,b6){return new L.prototype.init(b5,b4,b7,b3,b6)
}bK.Tween=L;
L.prototype={constructor:L,init:function(b6,b4,b8,b3,b7,b5){this.elem=b6;
this.prop=b8;
this.easing=b7||"swing";
this.options=b4;
this.start=this.now=this.cur();
this.end=b3;
this.unit=b5||(bK.cssNumber[b8]?"":"px")
},cur:function(){var b3=L.propHooks[this.prop];
return b3&&b3.get?b3.get(this):L.propHooks._default.get(this)
},run:function(b5){var b4,b3=L.propHooks[this.prop];
if(this.options.duration){this.pos=b4=bK.easing[this.easing](b5,this.options.duration*b5,0,1,this.options.duration)
}else{this.pos=b4=b5
}this.now=(this.end-this.start)*b4+this.start;
if(this.options.step){this.options.step.call(this.elem,this.now,this)
}if(b3&&b3.set){b3.set(this)
}else{L.propHooks._default.set(this)
}return this
}};
L.prototype.init.prototype=L.prototype;
L.propHooks={_default:{get:function(b4){var b3;
if(b4.elem[b4.prop]!=null&&(!b4.elem.style||b4.elem.style[b4.prop]==null)){return b4.elem[b4.prop]
}b3=bK.css(b4.elem,b4.prop,false,"");
return !b3||b3==="auto"?0:b3
},set:function(b3){if(bK.fx.step[b3.prop]){bK.fx.step[b3.prop](b3)
}else{if(b3.elem.style&&(b3.elem.style[bK.cssProps[b3.prop]]!=null||bK.cssHooks[b3.prop])){bK.style(b3.elem,b3.prop,b3.now+b3.unit)
}else{b3.elem[b3.prop]=b3.now
}}}}};
L.propHooks.scrollTop=L.propHooks.scrollLeft={set:function(b3){if(b3.elem.nodeType&&b3.elem.parentNode){b3.elem[b3.prop]=b3.now
}}};
bK.each(["toggle","show","hide"],function(b4,b3){var b5=bK.fn[b3];
bK.fn[b3]=function(b6,b8,b7){return b6==null||typeof b6==="boolean"||(!b4&&bK.isFunction(b6)&&bK.isFunction(b8))?b5.apply(this,arguments):this.animate(bJ(b3,true),b6,b8,b7)
}
});
bK.fn.extend({fadeTo:function(b3,b6,b5,b4){return this.filter(U).css("opacity",0).show().end().animate({opacity:b6},b3,b5,b4)
},animate:function(b9,b6,b8,b7){var b5=bK.isEmptyObject(b9),b3=bK.speed(b6,b8,b7),b4=function(){var ca=g(this,bK.extend({},b9),b3);
if(b5){ca.stop(true)
}};
return b5||b3.queue===false?this.each(b4):this.queue(b3.queue,b4)
},stop:function(b5,b4,b3){var b6=function(b7){var b8=b7.stop;
delete b7.stop;
b8(b3)
};
if(typeof b5!=="string"){b3=b4;
b4=b5;
b5=aF
}if(b4&&b5!==false){this.queue(b5||"fx",[])
}return this.each(function(){var ca=true,b7=b5!=null&&b5+"queueHooks",b9=bK.timers,b8=bK._data(this);
if(b7){if(b8[b7]&&b8[b7].stop){b6(b8[b7])
}}else{for(b7 in b8){if(b8[b7]&&b8[b7].stop&&bQ.test(b7)){b6(b8[b7])
}}}for(b7=b9.length;
b7--;
){if(b9[b7].elem===this&&(b5==null||b9[b7].queue===b5)){b9[b7].anim.stop(b3);
ca=false;
b9.splice(b7,1)
}}if(ca||!b3){bK.dequeue(this,b5)
}})
}});
function bJ(b5,b7){var b6,b3={height:b5},b4=0;
b7=b7?1:0;
for(;
b4<4;
b4+=2-b7){b6=bU[b4];
b3["margin"+b6]=b3["padding"+b6]=b5
}if(b7){b3.opacity=b3.width=b5
}return b3
}bK.each({slideDown:bJ("show"),slideUp:bJ("hide"),slideToggle:bJ("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(b3,b4){bK.fn[b3]=function(b5,b7,b6){return this.animate(b4,b5,b7,b6)
}
});
bK.speed=function(b5,b6,b4){var b3=b5&&typeof b5==="object"?bK.extend({},b5):{complete:b4||!b4&&b6||bK.isFunction(b5)&&b5,duration:b5,easing:b4&&b6||b6&&!bK.isFunction(b6)&&b6};
b3.duration=bK.fx.off?0:typeof b3.duration==="number"?b3.duration:b3.duration in bK.fx.speeds?bK.fx.speeds[b3.duration]:bK.fx.speeds._default;
if(b3.queue==null||b3.queue===true){b3.queue="fx"
}b3.old=b3.complete;
b3.complete=function(){if(bK.isFunction(b3.old)){b3.old.call(this)
}if(b3.queue){bK.dequeue(this,b3.queue)
}};
return b3
};
bK.easing={linear:function(b3){return b3
},swing:function(b3){return 0.5-Math.cos(b3*Math.PI)/2
}};
bK.timers=[];
bK.fx=L.prototype.init;
bK.fx.tick=function(){var b5,b4=bK.timers,b3=0;
for(;
b3<b4.length;
b3++){b5=b4[b3];
if(!b5()&&b4[b3]===b5){b4.splice(b3--,1)
}}if(!b4.length){bK.fx.stop()
}};
bK.fx.timer=function(b3){if(b3()&&bK.timers.push(b3)&&!af){af=setInterval(bK.fx.tick,bK.fx.interval)
}};
bK.fx.interval=13;
bK.fx.stop=function(){clearInterval(af);
af=null
};
bK.fx.speeds={slow:600,fast:200,_default:400};
bK.fx.step={};
if(bK.expr&&bK.expr.filters){bK.expr.filters.animated=function(b3){return bK.grep(bK.timers,function(b4){return b3===b4.elem
}).length
}
}var bq=/^(?:body|html)$/i;
bK.fn.offset=function(cf){if(arguments.length){return cf===aF?this:this.each(function(cg){bK.offset.setOffset(this,cf,cg)
})
}var b9,b4,ca,cb,b8,cc,b3,b7,cd,b6,b5=this[0],ce=b5&&b5.ownerDocument;
if(!ce){return
}if((ca=ce.body)===b5){return bK.offset.bodyOffset(b5)
}b4=ce.documentElement;
if(!bK.contains(b4,b5)){return{top:0,left:0}
}b9=b5.getBoundingClientRect();
cb=br(ce);
b8=b4.clientTop||ca.clientTop||0;
cc=b4.clientLeft||ca.clientLeft||0;
b3=cb.pageYOffset||b4.scrollTop;
b7=cb.pageXOffset||b4.scrollLeft;
cd=b9.top+b3-b8;
b6=b9.left+b7-cc;
return{top:cd,left:b6}
};
bK.offset={bodyOffset:function(b3){var b5=b3.offsetTop,b4=b3.offsetLeft;
if(bK.support.doesNotIncludeMarginInBodyOffset){b5+=parseFloat(bK.css(b3,"marginTop"))||0;
b4+=parseFloat(bK.css(b3,"marginLeft"))||0
}return{top:b5,left:b4}
},setOffset:function(b6,cf,b9){var ca=bK.css(b6,"position");
if(ca==="static"){b6.style.position="relative"
}var b8=bK(b6),b4=b8.offset(),b3=bK.css(b6,"top"),cd=bK.css(b6,"left"),ce=(ca==="absolute"||ca==="fixed")&&bK.inArray("auto",[b3,cd])>-1,cc={},cb={},b5,b7;
if(ce){cb=b8.position();
b5=cb.top;
b7=cb.left
}else{b5=parseFloat(b3)||0;
b7=parseFloat(cd)||0
}if(bK.isFunction(cf)){cf=cf.call(b6,b9,b4)
}if(cf.top!=null){cc.top=(cf.top-b4.top)+b5
}if(cf.left!=null){cc.left=(cf.left-b4.left)+b7
}if("using" in cf){cf.using.call(b6,cc)
}else{b8.css(cc)
}}};
bK.fn.extend({position:function(){if(!this[0]){return
}var b5=this[0],b4=this.offsetParent(),b6=this.offset(),b3=bq.test(b4[0].nodeName)?{top:0,left:0}:b4.offset();
b6.top-=parseFloat(bK.css(b5,"marginTop"))||0;
b6.left-=parseFloat(bK.css(b5,"marginLeft"))||0;
b3.top+=parseFloat(bK.css(b4[0],"borderTopWidth"))||0;
b3.left+=parseFloat(bK.css(b4[0],"borderLeftWidth"))||0;
return{top:b6.top-b3.top,left:b6.left-b3.left}
},offsetParent:function(){return this.map(function(){var b3=this.offsetParent||q.body;
while(b3&&(!bq.test(b3.nodeName)&&bK.css(b3,"position")==="static")){b3=b3.offsetParent
}return b3||q.body
})
}});
bK.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(b5,b4){var b3=/Y/.test(b4);
bK.fn[b5]=function(b6){return bK.access(this,function(b7,ca,b9){var b8=br(b7);
if(b9===aF){return b8?(b4 in b8)?b8[b4]:b8.document.documentElement[ca]:b7[ca]
}if(b8){b8.scrollTo(!b3?b9:bK(b8).scrollLeft(),b3?b9:bK(b8).scrollTop())
}else{b7[ca]=b9
}},b5,b6,arguments.length,null)
}
});
function br(b3){return bK.isWindow(b3)?b3:b3.nodeType===9?b3.defaultView||b3.parentWindow:false
}bK.each({Height:"height",Width:"width"},function(b3,b4){bK.each({padding:"inner"+b3,content:b4,"":"outer"+b3},function(b5,b6){bK.fn[b6]=function(ca,b9){var b8=arguments.length&&(b5||typeof ca!=="boolean"),b7=b5||(ca===true||b9===true?"margin":"border");
return bK.access(this,function(cc,cb,cd){var ce;
if(bK.isWindow(cc)){return cc.document.documentElement["client"+b3]
}if(cc.nodeType===9){ce=cc.documentElement;
return Math.max(cc.body["scroll"+b3],ce["scroll"+b3],cc.body["offset"+b3],ce["offset"+b3],ce["client"+b3])
}return cd===aF?bK.css(cc,cb,cd,b7):bK.style(cc,cb,cd,b7)
},b4,b8?ca:aF,b8,null)
}
})
});
a6.jQuery=a6.$=bK;
if(typeof define==="function"&&define.amd&&define.amd.jQuery){define("jquery",[],function(){return bK
})
}})(window);
window.Granite=window.Granite||{};
Granite.Sling={SELECTOR_INFINITY:".infinity",CHARSET:"_charset_",STATUS:":status",STATUS_BROWSER:"browser",OPERATION:":operation",OPERATION_DELETE:"delete",OPERATION_MOVE:"move",DELETE_SUFFIX:"@Delete",TYPEHINT_SUFFIX:"@TypeHint",COPY_SUFFIX:"@CopyFrom",MOVE_SUFFIX:"@MoveFrom",ORDER:":order",REPLACE:":replace",DESTINATION:":dest",SAVE_PARAM_PREFIX:":saveParamPrefix",IGNORE_PARAM:":ignore",REQUEST_LOGIN_PARAM:"sling:authRequestLogin",LOGIN_URL:"/system/sling/login.html",LOGOUT_URL:"/system/sling/logout.html"};
(function(a,b){a.Util=(function(){var d={patchText:function(h,g){if(g){if(!b.isArray(g)){h=h.replace("{0}",g)
}else{for(var f=0;
f<g.length;
f++){h=h.replace(("{"+f+"}"),g[f])
}}}return h
},getTopWindow:function(){var g=window;
if(this.iFrameTopWindow){return this.iFrameTopWindow
}try{while(g.parent&&g!==g.parent&&g.parent.location.href){g=g.parent
}}catch(f){}return g
},setIFrameMode:function(f){this.iFrameTopWindow=f||window
},applyDefaults:function(){var h,k=arguments[0]||{};
for(var g=1;
g<arguments.length;
g++){h=arguments[g];
for(var f in h){var j=h[f];
if(h.hasOwnProperty(f)&&j){if(typeof j==="object"&&!(j instanceof Array)){k[f]=d.applyDefaults(k[f],j)
}else{if(j instanceof Array){k[f]=j.slice(0)
}else{k[f]=j
}}}}}return k
},getKeyCode:function(f){return f.keyCode?f.keyCode:f.which
}};
return d
}())
}(Granite,jQuery));
(function(Granite,util,sling,$){Granite.HTTP=(function(){var contextPath=null,SCRIPT_URL_REGEXP=/^(?:http|https):\/\/[^\/]+(\/.*)\/(?:etc|libs|apps)\/.*\.js(\?.*)?$/,ENCODE_PATH_REGEXP=/[^1\w-\.!~\*'\(\)\/%;:@&=\$,]/,loginRedirected=false,self={};
self.getSchemeAndAuthority=function(url){var end;
try{if(url.indexOf("://")==-1){return""
}end=url.indexOf("/",url.indexOf("://")+3);
return(end==-1)?url:url.substring(0,end)
}catch(e){return""
}};
self.getContextPath=function(){return contextPath
};
self.detectContextPath=function(){try{if(window.CQURLInfo){contextPath=CQURLInfo.contextPath||""
}else{var scripts=document.getElementsByTagName("script");
for(var i=0;
i<scripts.length;
i++){var result=SCRIPT_URL_REGEXP.exec(scripts[i].src);
if(result){contextPath=result[1];
return
}}contextPath=""
}}catch(e){}};
self.externalize=function(url){try{if(url.indexOf("/")==0&&contextPath&&url.indexOf(contextPath+"/")!=0){url=contextPath+url
}}catch(e){}return url
};
self.internalize=function(url,doc){if(url.charAt(0)=="/"){if(contextPath){return url.substring(contextPath.length)
}else{return url
}}if(!doc){doc=document
}var docHost=self.getSchemeAndAuthority(doc.location.href);
var urlHost=self.getSchemeAndAuthority(url);
if(docHost==urlHost){return url.substring(urlHost.length+(contextPath?contextPath.length:0))
}else{return url
}};
self.getPath=function(url){if(!url){if(window.CQURLInfo&&CQURLInfo.requestPath){return CQURLInfo.requestPath
}else{url=window.location.pathname
}}else{url=self.removeParameters(url);
url=self.removeAnchor(url)
}url=self.internalize(url);
var i=url.indexOf(".",url.lastIndexOf("/"));
if(i!=-1){url=url.substring(0,i)
}return url
};
self.removeAnchor=function(url){if(url.indexOf("#")!=-1){return url.substring(0,url.indexOf("#"))
}return url
};
self.removeParameters=function(url){if(url.indexOf("?")!=-1){return url.substring(0,url.indexOf("?"))
}return url
};
self.encodePathOfURI=function(url){var parts,delim;
if(url.indexOf("?")!=-1){parts=url.split("?");
delim="?"
}else{if(url.indexOf("#")!=-1){parts=url.split("#");
delim="#"
}else{parts=[url]
}}if(ENCODE_PATH_REGEXP.test(parts[0])){parts[0]=self.encodePath(parts[0])
}return parts.join(delim)
};
self.encodePath=function(path){path=encodeURI(path).replace(/%5B/g,"[").replace(/%5D/g,"]");
path=path.replace(/\+/g,"%2B");
path=path.replace(/\?/g,"%3F");
path=path.replace(/;/g,"%3B");
path=path.replace(/#/g,"%23");
path=path.replace(/=/g,"%3D");
path=path.replace(/\$/g,"%24");
path=path.replace(/,/g,"%2C");
path=path.replace(/'/g,"%27");
path=path.replace(/"/g,"%22");
return path
};
self.handleLoginRedirect=function(){if(!loginRedirected){loginRedirected=true;
alert(Granite.I18n.get("Your request could not be completed because you have been signed out."));
var l=util.getTopWindow().document.location;
l.href=self.externalize(sling.LOGIN_URL)+"?resource="+l.pathname+encodeURIComponent(l.search)+l.hash
}};
self.getXhrHook=function(url,method,params){method=method||"GET";
if(window.G_XHR_HOOK&&$.isFunction(G_XHR_HOOK)){var p={url:url,method:method};
if(params){p.params=params
}return G_XHR_HOOK(p)
}return null
};
self.eval=function(response){if(typeof response!="object"){response=$.ajax({url:response,type:"get",async:false})
}try{return eval("("+(response.body?response.body:response.responseText)+")")
}catch(e){}return null
};
return self
}())
}(Granite,Granite.Util,Granite.Sling,jQuery));
(function(Granite,util,http,$){Granite.I18n=(function(){var dicts={},initialized=false,urlPrefix="/libs/cq/i18n/dict.",urlSuffix=".json",currentLocale="en",pseudoTranslations=false,languages=null,self={};
self.LOCALE_DEFAULT="en";
self.PSEUDO_LANGUAGE="zz";
self.PSEUDO_PATTERN_KEY="_pseudoPattern_";
self.init=function(config){if(!config){config=new Object()
}if(config.locale){this.setLocale(config.locale)
}urlPrefix=config.urlPrefix||urlPrefix;
urlSuffix=config.urlSuffix||urlSuffix;
initialized=true
};
self.setLocale=function(locale){currentLocale=locale
};
self.getLocale=function(){if(currentLocale&&$.isFunction(currentLocale)){currentLocale=currentLocale()
}return currentLocale
};
self.setUrlPrefix=function(prefix){urlPrefix=prefix
};
self.setUrlSuffix=function(suffix){urlSuffix=suffix
};
self.getDictionary=function(locale){locale=locale||self.getLocale()||Granite.I18n.LOCALE_DEFAULT;
if(!dicts[locale]){pseudoTranslations=(locale.indexOf(self.PSEUDO_LANGUAGE)==0);
var url=urlPrefix+locale+urlSuffix;
try{var response=$.ajax(url,{async:false,dataType:"json"});
dicts[locale]=$.parseJSON(response.responseText)
}catch(e){}if(!dicts[locale]){dicts[locale]={}
}}return dicts[locale]
};
self.get=function(text,snippets,note){var dict,newText,lookupText;
if(initialized){dict=self.getDictionary()
}lookupText=pseudoTranslations?self.PSEUDO_PATTERN_KEY:note?text+" (("+note+"))":text;
if(dict){newText=dict[lookupText]
}if(!newText){newText=text
}if(pseudoTranslations){newText=newText.replace("{string}",text).replace("{comment}",note?note:"")
}return util.patchText(newText,snippets)
};
self.getVar=function(text,note){if(!text){return null
}return self.get(text,null,note)
};
self.getLanguages=function(){if(!languages){try{var json=http.eval("/libs/wcm/core/resources/languages.overlay.infinity.json");
$.each(json,function(name,lang){lang.title=self.getVar(lang.language);
if(lang.title&&lang.country&&lang.country!="*"){lang.title+=" ("+self.getVar(lang.country)+")"
}});
languages=json
}catch(e){languages={}
}}return languages
};
self.parseLocale=function(langCode){if(!langCode){return null
}var pos=langCode.indexOf("_");
if(pos<0){pos=langCode.indexOf("-")
}var language,country;
if(pos<0){language=langCode;
country=null
}else{language=langCode.substring(0,pos);
country=langCode.substring(pos+1)
}return{code:langCode,language:language,country:country}
};
return self
}())
}(Granite,Granite.Util,Granite.HTTP,jQuery));
(function(b,d){var a=function(){var g={visibility:"hidden",position:"absolute",width:"30px",height:"30px","-webkit-border-radius":"20px","border-radius":"20px",border:"5px solid orange","-webkit-user-select":"none","user-select":"none",opacity:"0.5","z-index":"2000","pointer-events":"none"};
var h={};
var f=[];
return{debugWithMouse:false,init:function(){var j=this;
d(document).on("touchstart.touchindicator touchmove.touchindicator touchend.touchindicator",function(l){var k=l.originalEvent.touches;
j.update(k);
return true
});
if(this.debugWithMouse){d(document).on("mousemove.touchindicator",function(k){k.identifer="fake";
j.update([k]);
return true
})
}},update:function(m){var k={};
for(var l=0;
l<m.length;
l++){var o=m[l];
var n=o.identifier;
var j=h[n];
if(!j){j=f.pop();
if(!j){j=d("<div></div>").css(g);
d("body").append(j)
}}k[n]=j;
j.offset({left:o.pageX-20,top:o.pageY-20});
j.css("visibility","visible")
}for(n in h){if(h.hasOwnProperty(n)&&!k[n]){j=h[n];
j.css("visibility","hidden");
f.push(j)
}}h=k
}}
};
b.TouchIndicator=new a()
}(Granite,jQuery));
(function(d,a,b,f){d.OptOutUtil=(function(){var g={};
var h=[];
var j=[];
g.init=function(k){if(k){h=k.cookieNames?k.cookieNames:h;
j=k.whitelistCookieNames?k.whitelistCookieNames:j
}};
g.getCookieNames=function(){return h
};
g.getWhitelistCookieNames=function(){return j
};
g.isOptedOut=function(){var m=document.cookie.split(";");
for(var l=0;
l<m.length;
l++){var k=m[l];
var n=f.trim(k.split("=")[0]);
if(f.inArray(n,g.getCookieNames())>-1){return true
}}return false
};
g.maySetCookie=function(k){return !(g.isOptedOut()&&f.inArray(k,g.getWhitelistCookieNames())===-1)
};
return g
}())
}(Granite,Granite.Util,Granite.HTTP,jQuery));
Granite.OptOutUtil.init(window.GraniteOptOutConfig);
Granite.HTTP.detectContextPath();
Granite.I18n.init();
(function(d,b,f){var a;
b.Granite=b.Granite||{};
b.Granite.$=b.Granite.$||d;
b._g=b._g||{};
b._g.$=b._g.$||d;
a=Granite.HTTP;
d.ajaxSetup({externalize:true,encodePath:true,hook:true,beforeSend:function(h,g){if(typeof G_IS_HOOKED=="undefined"||!G_IS_HOOKED(g.url)){if(g.externalize){g.url=a.externalize(g.url)
}if(g.encodePath){g.url=a.encodePathOfURI(g.url)
}}if(g.hook){var j=a.getXhrHook(g.url,g.type,g.data);
if(j){g.url=j.url;
if(j.params){if(g.type.toUpperCase()=="GET"){g.url+="?"+d.param(j.params)
}else{g.data=d.param(j.params)
}}}}},statusCode:{403:function(g){if(g.getResponseHeader("X-Reason")==="Authentication Failed"){a.handleLoginRedirect()
}}}});
d.ajaxSettings.traditional=true
}(jQuery,this));
var Handlebars={};
(function(f,d){f.VERSION="1.0.0";
f.COMPILER_REVISION=4;
f.REVISION_CHANGES={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};
f.helpers={};
f.partials={};
var p=Object.prototype.toString,b="[object Function]",k="[object Object]";
f.registerHelper=function(w,z,l){if(p.call(w)===k){if(l||z){throw new f.Exception("Arg not supported with multiple helpers")
}f.Utils.extend(this.helpers,w)
}else{if(l){z.not=l
}this.helpers[w]=z
}};
f.registerPartial=function(l,w){if(p.call(l)===k){f.Utils.extend(this.partials,l)
}else{this.partials[l]=w
}};
f.registerHelper("helperMissing",function(l){if(arguments.length===2){return d
}else{throw new Error("Missing helper: '"+l+"'")
}});
f.registerHelper("blockHelperMissing",function(z,w){var l=w.inverse||function(){},B=w.fn;
var A=p.call(z);
if(A===b){z=z.call(this)
}if(z===true){return B(this)
}else{if(z===false||z==null){return l(this)
}else{if(A==="[object Array]"){if(z.length>0){return f.helpers.each(z,w)
}else{return l(this)
}}else{return B(z)
}}}});
f.K=function(){};
f.createFrame=Object.create||function(l){f.K.prototype=l;
var w=new f.K();
f.K.prototype=null;
return w
};
f.logger={DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,methodMap:{0:"debug",1:"info",2:"warn",3:"error"},log:function(z,l){if(f.logger.level<=z){var w=f.logger.methodMap[z];
if(typeof console!=="undefined"&&console[w]){console[w].call(console,l)
}}}};
f.log=function(w,l){f.logger.log(w,l)
};
f.registerHelper("each",function(l,G){var E=G.fn,z=G.inverse;
var B=0,C="",A;
var D=p.call(l);
if(D===b){l=l.call(this)
}if(G.data){A=f.createFrame(G.data)
}if(l&&typeof l==="object"){if(l instanceof Array){for(var w=l.length;
B<w;
B++){if(A){A.index=B
}C=C+E(l[B],{data:A})
}}else{for(var F in l){if(l.hasOwnProperty(F)){if(A){A.key=F
}C=C+E(l[F],{data:A});
B++
}}}}if(B===0){C=z(this)
}return C
});
f.registerHelper("if",function(w,l){var z=p.call(w);
if(z===b){w=w.call(this)
}if(!w||f.Utils.isEmpty(w)){return l.inverse(this)
}else{return l.fn(this)
}});
f.registerHelper("unless",function(w,l){return f.helpers["if"].call(this,w,{fn:l.inverse,inverse:l.fn})
});
f.registerHelper("with",function(w,l){var z=p.call(w);
if(z===b){w=w.call(this)
}if(!f.Utils.isEmpty(w)){return l.fn(w)
}});
f.registerHelper("log",function(w,l){var z=l.data&&l.data.level!=null?parseInt(l.data.level,10):1;
f.log(z,w)
});
var t=(function(){var D={trace:function z(){},yy:{},symbols_:{error:2,root:3,program:4,EOF:5,simpleInverse:6,statements:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,inMustache:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,params:27,hash:28,dataName:29,param:30,STRING:31,INTEGER:32,BOOLEAN:33,hashSegments:34,hashSegment:35,ID:36,EQUALS:37,DATA:38,pathSegments:39,SEP:40,"$accept":0,"$end":1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",31:"STRING",32:"INTEGER",33:"BOOLEAN",36:"ID",37:"EQUALS",38:"DATA",40:"SEP"},productions_:[0,[3,2],[4,2],[4,3],[4,2],[4,1],[4,1],[4,0],[7,1],[7,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,3],[13,4],[6,2],[17,3],[17,2],[17,2],[17,1],[17,1],[27,2],[27,1],[30,1],[30,1],[30,1],[30,1],[30,1],[28,1],[34,2],[34,1],[35,3],[35,3],[35,3],[35,3],[35,3],[26,1],[26,1],[26,1],[29,2],[21,1],[39,3],[39,1]],performAction:function w(E,H,I,L,K,G,J){var F=G.length-1;
switch(K){case 1:return G[F-1];
break;
case 2:this.$=new L.ProgramNode([],G[F]);
break;
case 3:this.$=new L.ProgramNode(G[F-2],G[F]);
break;
case 4:this.$=new L.ProgramNode(G[F-1],[]);
break;
case 5:this.$=new L.ProgramNode(G[F]);
break;
case 6:this.$=new L.ProgramNode([],[]);
break;
case 7:this.$=new L.ProgramNode([]);
break;
case 8:this.$=[G[F]];
break;
case 9:G[F-1].push(G[F]);
this.$=G[F-1];
break;
case 10:this.$=new L.BlockNode(G[F-2],G[F-1].inverse,G[F-1],G[F]);
break;
case 11:this.$=new L.BlockNode(G[F-2],G[F-1],G[F-1].inverse,G[F]);
break;
case 12:this.$=G[F];
break;
case 13:this.$=G[F];
break;
case 14:this.$=new L.ContentNode(G[F]);
break;
case 15:this.$=new L.CommentNode(G[F]);
break;
case 16:this.$=new L.MustacheNode(G[F-1][0],G[F-1][1]);
break;
case 17:this.$=new L.MustacheNode(G[F-1][0],G[F-1][1]);
break;
case 18:this.$=G[F-1];
break;
case 19:this.$=new L.MustacheNode(G[F-1][0],G[F-1][1],G[F-2][2]==="&");
break;
case 20:this.$=new L.MustacheNode(G[F-1][0],G[F-1][1],true);
break;
case 21:this.$=new L.PartialNode(G[F-1]);
break;
case 22:this.$=new L.PartialNode(G[F-2],G[F-1]);
break;
case 23:break;
case 24:this.$=[[G[F-2]].concat(G[F-1]),G[F]];
break;
case 25:this.$=[[G[F-1]].concat(G[F]),null];
break;
case 26:this.$=[[G[F-1]],G[F]];
break;
case 27:this.$=[[G[F]],null];
break;
case 28:this.$=[[G[F]],null];
break;
case 29:G[F-1].push(G[F]);
this.$=G[F-1];
break;
case 30:this.$=[G[F]];
break;
case 31:this.$=G[F];
break;
case 32:this.$=new L.StringNode(G[F]);
break;
case 33:this.$=new L.IntegerNode(G[F]);
break;
case 34:this.$=new L.BooleanNode(G[F]);
break;
case 35:this.$=G[F];
break;
case 36:this.$=new L.HashNode(G[F]);
break;
case 37:G[F-1].push(G[F]);
this.$=G[F-1];
break;
case 38:this.$=[G[F]];
break;
case 39:this.$=[G[F-2],G[F]];
break;
case 40:this.$=[G[F-2],new L.StringNode(G[F])];
break;
case 41:this.$=[G[F-2],new L.IntegerNode(G[F])];
break;
case 42:this.$=[G[F-2],new L.BooleanNode(G[F])];
break;
case 43:this.$=[G[F-2],G[F]];
break;
case 44:this.$=new L.PartialNameNode(G[F]);
break;
case 45:this.$=new L.PartialNameNode(new L.StringNode(G[F]));
break;
case 46:this.$=new L.PartialNameNode(new L.IntegerNode(G[F]));
break;
case 47:this.$=new L.DataNode(G[F]);
break;
case 48:this.$=new L.IdNode(G[F]);
break;
case 49:G[F-2].push({part:G[F],separator:G[F-1]});
this.$=G[F-2];
break;
case 50:this.$=[{part:G[F]}];
break
}},table:[{3:1,4:2,5:[2,7],6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],22:[1,14],23:[1,15],25:[1,16]},{1:[3]},{5:[1,17]},{5:[2,6],7:18,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,6],22:[1,14],23:[1,15],25:[1,16]},{5:[2,5],6:20,8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,5],22:[1,14],23:[1,15],25:[1,16]},{17:23,18:[1,22],21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,8],14:[2,8],15:[2,8],16:[2,8],19:[2,8],20:[2,8],22:[2,8],23:[2,8],25:[2,8]},{4:29,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{4:30,6:3,7:4,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,5],20:[2,7],22:[1,14],23:[1,15],25:[1,16]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{17:31,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:32,21:24,29:25,36:[1,28],38:[1,27],39:26},{17:33,21:24,29:25,36:[1,28],38:[1,27],39:26},{21:35,26:34,31:[1,36],32:[1,37],36:[1,28],39:26},{1:[2,1]},{5:[2,2],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,2],22:[1,14],23:[1,15],25:[1,16]},{17:23,21:24,29:25,36:[1,28],38:[1,27],39:26},{5:[2,4],7:38,8:6,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,4],22:[1,14],23:[1,15],25:[1,16]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{5:[2,23],14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{18:[1,39]},{18:[2,27],21:44,24:[2,27],27:40,28:41,29:48,30:42,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,28],24:[2,28]},{18:[2,48],24:[2,48],31:[2,48],32:[2,48],33:[2,48],36:[2,48],38:[2,48],40:[1,51]},{21:52,36:[1,28],39:26},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],38:[2,50],40:[2,50]},{10:53,20:[1,54]},{10:55,20:[1,54]},{18:[1,56]},{18:[1,57]},{24:[1,58]},{18:[1,59],21:60,36:[1,28],39:26},{18:[2,44],36:[2,44]},{18:[2,45],36:[2,45]},{18:[2,46],36:[2,46]},{5:[2,3],8:21,9:7,11:8,12:9,13:10,14:[1,11],15:[1,12],16:[1,13],19:[1,19],20:[2,3],22:[1,14],23:[1,15],25:[1,16]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{18:[2,25],21:44,24:[2,25],28:61,29:48,30:62,31:[1,45],32:[1,46],33:[1,47],34:43,35:49,36:[1,50],38:[1,27],39:26},{18:[2,26],24:[2,26]},{18:[2,30],24:[2,30],31:[2,30],32:[2,30],33:[2,30],36:[2,30],38:[2,30]},{18:[2,36],24:[2,36],35:63,36:[1,64]},{18:[2,31],24:[2,31],31:[2,31],32:[2,31],33:[2,31],36:[2,31],38:[2,31]},{18:[2,32],24:[2,32],31:[2,32],32:[2,32],33:[2,32],36:[2,32],38:[2,32]},{18:[2,33],24:[2,33],31:[2,33],32:[2,33],33:[2,33],36:[2,33],38:[2,33]},{18:[2,34],24:[2,34],31:[2,34],32:[2,34],33:[2,34],36:[2,34],38:[2,34]},{18:[2,35],24:[2,35],31:[2,35],32:[2,35],33:[2,35],36:[2,35],38:[2,35]},{18:[2,38],24:[2,38],36:[2,38]},{18:[2,50],24:[2,50],31:[2,50],32:[2,50],33:[2,50],36:[2,50],37:[1,65],38:[2,50],40:[2,50]},{36:[1,66]},{18:[2,47],24:[2,47],31:[2,47],32:[2,47],33:[2,47],36:[2,47],38:[2,47]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{21:67,36:[1,28],39:26},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,68]},{18:[2,24],24:[2,24]},{18:[2,29],24:[2,29],31:[2,29],32:[2,29],33:[2,29],36:[2,29],38:[2,29]},{18:[2,37],24:[2,37],36:[2,37]},{37:[1,65]},{21:69,29:73,31:[1,70],32:[1,71],33:[1,72],36:[1,28],38:[1,27],39:26},{18:[2,49],24:[2,49],31:[2,49],32:[2,49],33:[2,49],36:[2,49],38:[2,49],40:[2,49]},{18:[1,74]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{18:[2,39],24:[2,39],36:[2,39]},{18:[2,40],24:[2,40],36:[2,40]},{18:[2,41],24:[2,41],36:[2,41]},{18:[2,42],24:[2,42],36:[2,42]},{18:[2,43],24:[2,43],36:[2,43]},{5:[2,18],14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]}],defaultActions:{17:[2,1]},parseError:function A(F,E){throw new Error(F)
},parse:function C(N){var U=this,K=[0],ad=[null],P=[],ae=this.table,F="",O=0,ab=0,H=0,M=2,R=1;
this.lexer.setInput(N);
this.lexer.yy=this.yy;
this.yy.lexer=this.lexer;
this.yy.parser=this;
if(typeof this.lexer.yylloc=="undefined"){this.lexer.yylloc={}
}var G=this.lexer.yylloc;
P.push(G);
var I=this.lexer.options&&this.lexer.options.ranges;
if(typeof this.yy.parseError==="function"){this.parseError=this.yy.parseError
}function T(ag){K.length=K.length-2*ag;
ad.length=ad.length-ag;
P.length=P.length-ag
}function S(){var ag;
ag=U.lexer.lex()||1;
if(typeof ag!=="number"){ag=U.symbols_[ag]||ag
}return ag
}var aa,W,J,Z,af,Q,Y={},V,ac,E,L;
while(true){J=K[K.length-1];
if(this.defaultActions[J]){Z=this.defaultActions[J]
}else{if(aa===null||typeof aa=="undefined"){aa=S()
}Z=ae[J]&&ae[J][aa]
}if(typeof Z==="undefined"||!Z.length||!Z[0]){var X="";
if(!H){L=[];
for(V in ae[J]){if(this.terminals_[V]&&V>2){L.push("'"+this.terminals_[V]+"'")
}}if(this.lexer.showPosition){X="Parse error on line "+(O+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+L.join(", ")+", got '"+(this.terminals_[aa]||aa)+"'"
}else{X="Parse error on line "+(O+1)+": Unexpected "+(aa==1?"end of input":"'"+(this.terminals_[aa]||aa)+"'")
}this.parseError(X,{text:this.lexer.match,token:this.terminals_[aa]||aa,line:this.lexer.yylineno,loc:G,expected:L})
}}if(Z[0] instanceof Array&&Z.length>1){throw new Error("Parse Error: multiple actions possible at state: "+J+", token: "+aa)
}switch(Z[0]){case 1:K.push(aa);
ad.push(this.lexer.yytext);
P.push(this.lexer.yylloc);
K.push(Z[1]);
aa=null;
if(!W){ab=this.lexer.yyleng;
F=this.lexer.yytext;
O=this.lexer.yylineno;
G=this.lexer.yylloc;
if(H>0){H--
}}else{aa=W;
W=null
}break;
case 2:ac=this.productions_[Z[1]][1];
Y.$=ad[ad.length-ac];
Y._$={first_line:P[P.length-(ac||1)].first_line,last_line:P[P.length-1].last_line,first_column:P[P.length-(ac||1)].first_column,last_column:P[P.length-1].last_column};
if(I){Y._$.range=[P[P.length-(ac||1)].range[0],P[P.length-1].range[1]]
}Q=this.performAction.call(Y,F,ab,O,this.yy,Z[1],ad,P);
if(typeof Q!=="undefined"){return Q
}if(ac){K=K.slice(0,-1*ac*2);
ad=ad.slice(0,-1*ac);
P=P.slice(0,-1*ac)
}K.push(this.productions_[Z[1]][0]);
ad.push(Y.$);
P.push(Y._$);
E=ae[K[K.length-2]][K[K.length-1]];
K.push(E);
break;
case 3:return true
}}return true
}};
var l=(function(){var H=({EOF:1,parseError:function J(M,L){if(this.yy.parser){this.yy.parser.parseError(M,L)
}else{throw new Error(M)
}},setInput:function(L){this._input=L;
this._more=this._less=this.done=false;
this.yylineno=this.yyleng=0;
this.yytext=this.matched=this.match="";
this.conditionStack=["INITIAL"];
this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0};
if(this.options.ranges){this.yylloc.range=[0,0]
}this.offset=0;
return this
},input:function(){var M=this._input[0];
this.yytext+=M;
this.yyleng++;
this.offset++;
this.match+=M;
this.matched+=M;
var L=M.match(/(?:\r\n?|\n).*/g);
if(L){this.yylineno++;
this.yylloc.last_line++
}else{this.yylloc.last_column++
}if(this.options.ranges){this.yylloc.range[1]++
}this._input=this._input.slice(1);
return M
},unput:function(N){var L=N.length;
var M=N.split(/(?:\r\n?|\n)/g);
this._input=N+this._input;
this.yytext=this.yytext.substr(0,this.yytext.length-L-1);
this.offset-=L;
var P=this.match.split(/(?:\r\n?|\n)/g);
this.match=this.match.substr(0,this.match.length-1);
this.matched=this.matched.substr(0,this.matched.length-1);
if(M.length-1){this.yylineno-=M.length-1
}var O=this.yylloc.range;
this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:M?(M.length===P.length?this.yylloc.first_column:0)+P[P.length-M.length].length-M[0].length:this.yylloc.first_column-L};
if(this.options.ranges){this.yylloc.range=[O[0],O[0]+this.yyleng-L]
}return this
},more:function(){this._more=true;
return this
},less:function(L){this.unput(this.match.slice(L))
},pastInput:function(){var L=this.matched.substr(0,this.matched.length-this.match.length);
return(L.length>20?"...":"")+L.substr(-20).replace(/\n/g,"")
},upcomingInput:function(){var L=this.match;
if(L.length<20){L+=this._input.substr(0,20-L.length)
}return(L.substr(0,20)+(L.length>20?"...":"")).replace(/\n/g,"")
},showPosition:function(){var L=this.pastInput();
var M=new Array(L.length+1).join("-");
return L+this.upcomingInput()+"\n"+M+"^"
},next:function(){if(this.done){return this.EOF
}if(!this._input){this.done=true
}var R,P,M,O,N,L;
if(!this._more){this.yytext="";
this.match=""
}var S=this._currentRules();
for(var Q=0;
Q<S.length;
Q++){M=this._input.match(this.rules[S[Q]]);
if(M&&(!P||M[0].length>P[0].length)){P=M;
O=Q;
if(!this.options.flex){break
}}}if(P){L=P[0].match(/(?:\r\n?|\n).*/g);
if(L){this.yylineno+=L.length
}this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:L?L[L.length-1].length-L[L.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+P[0].length};
this.yytext+=P[0];
this.match+=P[0];
this.matches=P;
this.yyleng=this.yytext.length;
if(this.options.ranges){this.yylloc.range=[this.offset,this.offset+=this.yyleng]
}this._more=false;
this._input=this._input.slice(P[0].length);
this.matched+=P[0];
R=this.performAction.call(this,this.yy,this,S[O],this.conditionStack[this.conditionStack.length-1]);
if(this.done&&this._input){this.done=false
}if(R){return R
}else{return
}}if(this._input===""){return this.EOF
}else{return this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})
}},lex:function E(){var L=this.next();
if(typeof L!=="undefined"){return L
}else{return this.lex()
}},begin:function F(L){this.conditionStack.push(L)
},popState:function K(){return this.conditionStack.pop()
},_currentRules:function I(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules
},topState:function(){return this.conditionStack[this.conditionStack.length-2]
},pushState:function F(L){this.begin(L)
}});
H.options={};
H.performAction=function G(P,M,O,L){var N=L;
switch(O){case 0:M.yytext="\\";
return 14;
break;
case 1:if(M.yytext.slice(-1)!=="\\"){this.begin("mu")
}if(M.yytext.slice(-1)==="\\"){M.yytext=M.yytext.substr(0,M.yyleng-1),this.begin("emu")
}if(M.yytext){return 14
}break;
case 2:return 14;
break;
case 3:if(M.yytext.slice(-1)!=="\\"){this.popState()
}if(M.yytext.slice(-1)==="\\"){M.yytext=M.yytext.substr(0,M.yyleng-1)
}return 14;
break;
case 4:M.yytext=M.yytext.substr(0,M.yyleng-4);
this.popState();
return 15;
break;
case 5:return 25;
break;
case 6:return 16;
break;
case 7:return 20;
break;
case 8:return 19;
break;
case 9:return 19;
break;
case 10:return 23;
break;
case 11:return 22;
break;
case 12:this.popState();
this.begin("com");
break;
case 13:M.yytext=M.yytext.substr(3,M.yyleng-5);
this.popState();
return 15;
break;
case 14:return 22;
break;
case 15:return 37;
break;
case 16:return 36;
break;
case 17:return 36;
break;
case 18:return 40;
break;
case 19:break;
case 20:this.popState();
return 24;
break;
case 21:this.popState();
return 18;
break;
case 22:M.yytext=M.yytext.substr(1,M.yyleng-2).replace(/\\"/g,'"');
return 31;
break;
case 23:M.yytext=M.yytext.substr(1,M.yyleng-2).replace(/\\'/g,"'");
return 31;
break;
case 24:return 38;
break;
case 25:return 33;
break;
case 26:return 33;
break;
case 27:return 32;
break;
case 28:return 36;
break;
case 29:M.yytext=M.yytext.substr(1,M.yyleng-2);
return 36;
break;
case 30:return"INVALID";
break;
case 31:return 5;
break
}};
H.rules=[/^(?:\\\\(?=(\{\{)))/,/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\{\{>)/,/^(?:\{\{#)/,/^(?:\{\{\/)/,/^(?:\{\{\^)/,/^(?:\{\{\s*else\b)/,/^(?:\{\{\{)/,/^(?:\{\{&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{)/,/^(?:=)/,/^(?:\.(?=[}\/ ]))/,/^(?:\.\.)/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}\}\})/,/^(?:\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=[}\s]))/,/^(?:false(?=[}\s]))/,/^(?:-?[0-9]+(?=[}\s]))/,/^(?:[^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=[=}\s\/.]))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/];
H.conditions={mu:{rules:[5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31],inclusive:false},emu:{rules:[3],inclusive:false},com:{rules:[4],inclusive:false},INITIAL:{rules:[0,1,2,31],inclusive:true}};
return H
})();
D.lexer=l;
function B(){this.yy={}
}B.prototype=D;
D.Parser=B;
return new B
})();
f.Parser=t;
f.parse=function(l){if(l.constructor===f.AST.ProgramNode){return l
}f.Parser.yy=f.AST;
return f.Parser.parse(l)
};
f.AST={};
f.AST.ProgramNode=function(w,l){this.type="program";
this.statements=w;
if(l){this.inverse=new f.AST.ProgramNode(l)
}};
f.AST.MustacheNode=function(C,z,w){this.type="mustache";
this.escaped=!w;
this.hash=z;
var B=this.id=C[0];
var A=this.params=C.slice(1);
var l=this.eligibleHelper=B.isSimple;
this.isHelper=l&&(A.length||z)
};
f.AST.PartialNode=function(l,w){this.type="partial";
this.partialName=l;
this.context=w
};
f.AST.BlockNode=function(z,w,l,B){var A=function(C,D){if(C.original!==D.original){throw new f.Exception(C.original+" doesn't match "+D.original)
}};
A(z.id,B);
this.type="block";
this.mustache=z;
this.program=w;
this.inverse=l;
if(this.inverse&&!this.program){this.isInverse=true
}};
f.AST.ContentNode=function(l){this.type="content";
this.string=l
};
f.AST.HashNode=function(l){this.type="hash";
this.pairs=l
};
f.AST.IdNode=function(D){this.type="ID";
var C="",A=[],E=0;
for(var B=0,w=D.length;
B<w;
B++){var z=D[B].part;
C+=(D[B].separator||"")+z;
if(z===".."||z==="."||z==="this"){if(A.length>0){throw new f.Exception("Invalid path: "+C)
}else{if(z===".."){E++
}else{this.isScoped=true
}}}else{A.push(z)
}}this.original=C;
this.parts=A;
this.string=A.join(".");
this.depth=E;
this.isSimple=D.length===1&&!this.isScoped&&E===0;
this.stringModeValue=this.string
};
f.AST.PartialNameNode=function(l){this.type="PARTIAL_NAME";
this.name=l.original
};
f.AST.DataNode=function(l){this.type="DATA";
this.id=l
};
f.AST.StringNode=function(l){this.type="STRING";
this.original=this.string=this.stringModeValue=l
};
f.AST.IntegerNode=function(l){this.type="INTEGER";
this.original=this.integer=l;
this.stringModeValue=Number(l)
};
f.AST.BooleanNode=function(l){this.type="BOOLEAN";
this.bool=l;
this.stringModeValue=l==="true"
};
f.AST.CommentNode=function(l){this.type="comment";
this.comment=l
};
var s=["description","fileName","lineNumber","message","name","number","stack"];
f.Exception=function(z){var w=Error.prototype.constructor.apply(this,arguments);
for(var l=0;
l<s.length;
l++){this[s[l]]=w[s[l]]
}};
f.Exception.prototype=new Error();
f.SafeString=function(l){this.string=l
};
f.SafeString.prototype.toString=function(){return this.string.toString()
};
var n={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"};
var g=/[&<>"'`]/g;
var r=/[&<>"'`]/;
var v=function(l){return n[l]||"&amp;"
};
f.Utils={extend:function(z,w){for(var l in w){if(w.hasOwnProperty(l)){z[l]=w[l]
}}},escapeExpression:function(l){if(l instanceof f.SafeString){return l.toString()
}else{if(l==null||l===false){return""
}}l=l.toString();
if(!r.test(l)){return l
}return l.replace(g,v)
},isEmpty:function(l){if(!l&&l!==0){return true
}else{if(p.call(l)==="[object Array]"&&l.length===0){return true
}else{return false
}}}};
var m=f.Compiler=function(){};
var j=f.JavaScriptCompiler=function(){};
m.prototype={compiler:m,disassemble:function(){var D=this.opcodes,C,A=[],F,E;
for(var B=0,w=D.length;
B<w;
B++){C=D[B];
if(C.opcode==="DECLARE"){A.push("DECLARE "+C.name+"="+C.value)
}else{F=[];
for(var z=0;
z<C.args.length;
z++){E=C.args[z];
if(typeof E==="string"){E='"'+E.replace("\n","\\n")+'"'
}F.push(E)
}A.push(C.opcode+" "+F.join(" "))
}}return A.join("\n")
},equals:function(w){var l=this.opcodes.length;
if(w.opcodes.length!==l){return false
}for(var B=0;
B<l;
B++){var C=this.opcodes[B],z=w.opcodes[B];
if(C.opcode!==z.opcode||C.args.length!==z.args.length){return false
}for(var A=0;
A<C.args.length;
A++){if(C.args[A]!==z.args[A]){return false
}}}l=this.children.length;
if(w.children.length!==l){return false
}for(B=0;
B<l;
B++){if(!this.children[B].equals(w.children[B])){return false
}}return true
},guid:0,compile:function(l,z){this.children=[];
this.depths={list:[]};
this.options=z;
var A=this.options.knownHelpers;
this.options.knownHelpers={helperMissing:true,blockHelperMissing:true,each:true,"if":true,unless:true,"with":true,log:true};
if(A){for(var w in A){this.options.knownHelpers[w]=A[w]
}}return this.program(l)
},accept:function(l){return this[l.type](l)
},program:function(A){var z=A.statements,C;
this.opcodes=[];
for(var B=0,w=z.length;
B<w;
B++){C=z[B];
this[C.type](C)
}this.isSimple=w===1;
this.depths.list=this.depths.list.sort(function(D,l){return D-l
});
return this
},compileProgram:function(A){var w=new this.compiler().compile(A,this.options);
var B=this.guid++,D;
this.usePartial=this.usePartial||w.usePartial;
this.children[B]=w;
for(var C=0,z=w.depths.list.length;
C<z;
C++){D=w.depths.list[C];
if(D<2){continue
}else{this.addDepth(D-1)
}}return B
},block:function(B){var A=B.mustache,w=B.program,l=B.inverse;
if(w){w=this.compileProgram(w)
}if(l){l=this.compileProgram(l)
}var z=this.classifyMustache(A);
if(z==="helper"){this.helperMustache(A,w,l)
}else{if(z==="simple"){this.simpleMustache(A);
this.opcode("pushProgram",w);
this.opcode("pushProgram",l);
this.opcode("emptyHash");
this.opcode("blockValue")
}else{this.ambiguousMustache(A,w,l);
this.opcode("pushProgram",w);
this.opcode("pushProgram",l);
this.opcode("emptyHash");
this.opcode("ambiguousBlockValue")
}}this.opcode("append")
},hash:function(B){var A=B.pairs,D,C;
this.opcode("pushHash");
for(var z=0,w=A.length;
z<w;
z++){D=A[z];
C=D[1];
if(this.options.stringParams){if(C.depth){this.addDepth(C.depth)
}this.opcode("getContext",C.depth||0);
this.opcode("pushStringParam",C.stringModeValue,C.type)
}else{this.accept(C)
}this.opcode("assignToHash",D[0])
}this.opcode("popHash")
},partial:function(l){var w=l.partialName;
this.usePartial=true;
if(l.context){this.ID(l.context)
}else{this.opcode("push","depth0")
}this.opcode("invokePartial",w.name);
this.opcode("append")
},content:function(l){this.opcode("appendContent",l.string)
},mustache:function(z){var l=this.options;
var w=this.classifyMustache(z);
if(w==="simple"){this.simpleMustache(z)
}else{if(w==="helper"){this.helperMustache(z)
}else{this.ambiguousMustache(z)
}}if(z.escaped&&!l.noEscape){this.opcode("appendEscaped")
}else{this.opcode("append")
}},ambiguousMustache:function(B,z,w){var C=B.id,A=C.parts[0],l=z!=null||w!=null;
this.opcode("getContext",C.depth);
this.opcode("pushProgram",z);
this.opcode("pushProgram",w);
this.opcode("invokeAmbiguous",A,l)
},simpleMustache:function(l){var w=l.id;
if(w.type==="DATA"){this.DATA(w)
}else{if(w.parts.length){this.ID(w)
}else{this.addDepth(w.depth);
this.opcode("getContext",w.depth);
this.opcode("pushContext")
}}this.opcode("resolvePossibleLambda")
},helperMustache:function(A,w,l){var B=this.setupFullMustacheParams(A,w,l),z=A.id.parts[0];
if(this.options.knownHelpers[z]){this.opcode("invokeKnownHelper",B.length,z)
}else{if(this.options.knownHelpersOnly){throw new Error("You specified knownHelpersOnly, but used the unknown helper "+z)
}else{this.opcode("invokeHelper",B.length,z)
}}},ID:function(B){this.addDepth(B.depth);
this.opcode("getContext",B.depth);
var z=B.parts[0];
if(!z){this.opcode("pushContext")
}else{this.opcode("lookupOnContext",B.parts[0])
}for(var A=1,w=B.parts.length;
A<w;
A++){this.opcode("lookup",B.parts[A])
}},DATA:function(A){this.options.data=true;
if(A.id.isScoped||A.id.depth){throw new f.Exception("Scoped data references are not supported: "+A.original)
}this.opcode("lookupData");
var B=A.id.parts;
for(var z=0,w=B.length;
z<w;
z++){this.opcode("lookup",B[z])
}},STRING:function(l){this.opcode("pushString",l.string)
},INTEGER:function(l){this.opcode("pushLiteral",l.integer)
},BOOLEAN:function(l){this.opcode("pushLiteral",l.bool)
},comment:function(){},opcode:function(l){this.opcodes.push({opcode:l,args:[].slice.call(arguments,1)})
},declare:function(l,w){this.opcodes.push({opcode:"DECLARE",name:l,value:w})
},addDepth:function(l){if(isNaN(l)){throw new Error("EWOT")
}if(l===0){return
}if(!this.depths[l]){this.depths[l]=true;
this.depths.list.push(l)
}},classifyMustache:function(A){var z=A.isHelper;
var B=A.eligibleHelper;
var w=this.options;
if(B&&!z){var l=A.id.parts[0];
if(w.knownHelpers[l]){z=true
}else{if(w.knownHelpersOnly){B=false
}}}if(z){return"helper"
}else{if(B){return"ambiguous"
}else{return"simple"
}}},pushParams:function(z){var l=z.length,w;
while(l--){w=z[l];
if(this.options.stringParams){if(w.depth){this.addDepth(w.depth)
}this.opcode("getContext",w.depth||0);
this.opcode("pushStringParam",w.stringModeValue,w.type)
}else{this[w.type](w)
}}},setupMustacheParams:function(l){var w=l.params;
this.pushParams(w);
if(l.hash){this.hash(l.hash)
}else{this.opcode("emptyHash")
}return w
},setupFullMustacheParams:function(z,w,l){var A=z.params;
this.pushParams(A);
this.opcode("pushProgram",w);
this.opcode("pushProgram",l);
if(z.hash){this.hash(z.hash)
}else{this.opcode("emptyHash")
}return A
}};
var u=function(l){this.value=l
};
j.prototype={nameLookup:function(w,l){if(/^[0-9]+$/.test(l)){return w+"["+l+"]"
}else{if(j.isValidJavaScriptVariableName(l)){return w+"."+l
}else{return w+"['"+l+"']"
}}},appendToBuffer:function(l){if(this.environment.isSimple){return"return "+l+";"
}else{return{appendToBuffer:true,content:l,toString:function(){return"buffer += "+l+";"
}}
}},initializeBuffer:function(){return this.quotedString("")
},namespace:"Handlebars",compile:function(l,w,A,z){this.environment=l;
this.options=w||{};
f.log(f.logger.DEBUG,this.environment.disassemble()+"\n\n");
this.name=this.environment.name;
this.isChild=!!A;
this.context=A||{programs:[],environments:[],aliases:{}};
this.preamble();
this.stackSlot=0;
this.stackVars=[];
this.registers={list:[]};
this.compileStack=[];
this.inlineStack=[];
this.compileChildren(l,w);
var C=l.opcodes,B;
this.i=0;
for(o=C.length;
this.i<o;
this.i++){B=C[this.i];
if(B.opcode==="DECLARE"){this[B.name]=B.value
}else{this[B.opcode].apply(this,B.args)
}}return this.createFunctionContext(z)
},nextOpcode:function(){var l=this.environment.opcodes;
return l[this.i+1]
},eat:function(){this.i=this.i+1
},preamble:function(){var l=[];
if(!this.isChild){var w=this.namespace;
var z="helpers = this.merge(helpers, "+w+".helpers);";
if(this.environment.usePartial){z=z+" partials = this.merge(partials, "+w+".partials);"
}if(this.options.data){z=z+" data = data || {};"
}l.push(z)
}else{l.push("")
}if(!this.environment.isSimple){l.push(", buffer = "+this.initializeBuffer())
}else{l.push("")
}this.lastContext=0;
this.source=l
},createFunctionContext:function(F){var A=this.stackVars.concat(this.registers.list);
if(A.length>0){this.source[1]=this.source[1]+", "+A.join(", ")
}if(!this.isChild){for(var E in this.context.aliases){if(this.context.aliases.hasOwnProperty(E)){this.source[1]=this.source[1]+", "+E+"="+this.context.aliases[E]
}}}if(this.source[1]){this.source[1]="var "+this.source[1].substring(2)+";"
}if(!this.isChild){this.source[1]+="\n"+this.context.programs.join("\n")+"\n"
}if(!this.environment.isSimple){this.source.push("return buffer;")
}var C=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];
for(var D=0,B=this.environment.depths.list.length;
D<B;
D++){C.push("depth"+this.environment.depths.list[D])
}var w=this.mergeSource();
if(!this.isChild){var G=f.COMPILER_REVISION,z=f.REVISION_CHANGES[G];
w="this.compilerInfo = ["+G+",'"+z+"'];\n"+w
}if(F){C.push(w);
return Function.apply(this,C)
}else{var H="function "+(this.name||"")+"("+C.join(",")+") {\n  "+w+"}";
f.log(f.logger.DEBUG,H+"\n\n");
return H
}},mergeSource:function(){var B="",z;
for(var A=0,l=this.source.length;
A<l;
A++){var w=this.source[A];
if(w.appendToBuffer){if(z){z=z+"\n    + "+w.content
}else{z=w.content
}}else{if(z){B+="buffer += "+z+";\n  ";
z=d
}B+=w+"\n  "
}}return B
},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";
var l=["depth0"];
this.setupParams(0,l);
this.replaceStack(function(w){l.splice(1,0,w);
return"blockHelperMissing.call("+l.join(", ")+")"
})
},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";
var w=["depth0"];
this.setupParams(0,w);
var l=this.topStack();
w.splice(1,0,l);
w[w.length-1]="options";
this.source.push("if (!"+this.lastHelper+") { "+l+" = blockHelperMissing.call("+w.join(", ")+"); }")
},appendContent:function(l){this.source.push(this.appendToBuffer(this.quotedString(l)))
},append:function(){this.flushInline();
var l=this.popStack();
this.source.push("if("+l+" || "+l+" === 0) { "+this.appendToBuffer(l)+" }");
if(this.environment.isSimple){this.source.push("else { "+this.appendToBuffer("''")+" }")
}},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression";
this.source.push(this.appendToBuffer("escapeExpression("+this.popStack()+")"))
},getContext:function(l){if(this.lastContext!==l){this.lastContext=l
}},lookupOnContext:function(l){this.push(this.nameLookup("depth"+this.lastContext,l,"context"))
},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)
},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"';
this.replaceStack(function(l){return"typeof "+l+" === functionType ? "+l+".apply(depth0) : "+l
})
},lookup:function(l){this.replaceStack(function(w){return w+" == null || "+w+" === false ? "+w+" : "+this.nameLookup(w,l,"context")
})
},lookupData:function(l){this.push("data")
},pushStringParam:function(l,w){this.pushStackLiteral("depth"+this.lastContext);
this.pushString(w);
if(typeof l==="string"){this.pushString(l)
}else{this.pushStackLiteral(l)
}},emptyHash:function(){this.pushStackLiteral("{}");
if(this.options.stringParams){this.register("hashTypes","{}");
this.register("hashContexts","{}")
}},pushHash:function(){this.hash={values:[],types:[],contexts:[]}
},popHash:function(){var l=this.hash;
this.hash=d;
if(this.options.stringParams){this.register("hashContexts","{"+l.contexts.join(",")+"}");
this.register("hashTypes","{"+l.types.join(",")+"}")
}this.push("{\n    "+l.values.join(",\n    ")+"\n  }")
},pushString:function(l){this.pushStackLiteral(this.quotedString(l))
},push:function(l){this.inlineStack.push(l);
return l
},pushLiteral:function(l){this.pushStackLiteral(l)
},pushProgram:function(l){if(l!=null){this.pushStackLiteral(this.programExpression(l))
}else{this.pushStackLiteral(null)
}},invokeHelper:function(z,l){this.context.aliases.helperMissing="helpers.helperMissing";
var w=this.lastHelper=this.setupHelper(z,l,true);
var A=this.nameLookup("depth"+this.lastContext,l,"context");
this.push(w.name+" || "+A);
this.replaceStack(function(B){return B+" ? "+B+".call("+w.callParams+") : helperMissing.call("+w.helperMissingParams+")"
})
},invokeKnownHelper:function(z,l){var w=this.setupHelper(z,l);
this.push(w.name+".call("+w.callParams+")")
},invokeAmbiguous:function(l,B){this.context.aliases.functionType='"function"';
this.pushStackLiteral("{}");
var w=this.setupHelper(0,l,B);
var z=this.lastHelper=this.nameLookup("helpers",l,"helper");
var C=this.nameLookup("depth"+this.lastContext,l,"context");
var A=this.nextStack();
this.source.push("if ("+A+" = "+z+") { "+A+" = "+A+".call("+w.callParams+"); }");
this.source.push("else { "+A+" = "+C+"; "+A+" = typeof "+A+" === functionType ? "+A+".apply(depth0) : "+A+"; }")
},invokePartial:function(l){var w=[this.nameLookup("partials",l,"partial"),"'"+l+"'",this.popStack(),"helpers","partials"];
if(this.options.data){w.push("data")
}this.context.aliases.self="this";
this.push("self.invokePartial("+w.join(", ")+")")
},assignToHash:function(w){var A=this.popStack(),l,z;
if(this.options.stringParams){z=this.popStack();
l=this.popStack()
}var B=this.hash;
if(l){B.contexts.push("'"+w+"': "+l)
}if(z){B.types.push("'"+w+"': "+z)
}B.values.push("'"+w+"': ("+A+")")
},compiler:j,compileChildren:function(w,B){var D=w.children,F,E;
for(var C=0,z=D.length;
C<z;
C++){F=D[C];
E=new this.compiler();
var A=this.matchExistingProgram(F);
if(A==null){this.context.programs.push("");
A=this.context.programs.length;
F.index=A;
F.name="program"+A;
this.context.programs[A]=E.compile(F,B,this.context);
this.context.environments[A]=F
}else{F.index=A;
F.name="program"+A
}}},matchExistingProgram:function(A){for(var z=0,w=this.context.environments.length;
z<w;
z++){var l=this.context.environments[z];
if(l&&l.equals(A)){return z
}}},programExpression:function(z){this.context.aliases.self="this";
if(z==null){return"self.noop"
}var E=this.environment.children[z],D=E.depths.list,C;
var B=[E.index,E.name,"data"];
for(var A=0,w=D.length;
A<w;
A++){C=D[A];
if(C===1){B.push("depth0")
}else{B.push("depth"+(C-1))
}}return(D.length===0?"self.program(":"self.programWithDepth(")+B.join(", ")+")"
},register:function(l,w){this.useRegister(l);
this.source.push(l+" = "+w+";")
},useRegister:function(l){if(!this.registers[l]){this.registers[l]=true;
this.registers.list.push(l)
}},pushStackLiteral:function(l){return this.push(new u(l))
},pushStack:function(w){this.flushInline();
var l=this.incrStack();
if(w){this.source.push(l+" = "+w+";")
}this.compileStack.push(l);
return l
},replaceStack:function(D){var A="",C=this.isInline(),l;
if(C){var B=this.popStack(true);
if(B instanceof u){l=B.value
}else{var w=this.stackSlot?this.topStackName():this.incrStack();
A="("+this.push(w)+" = "+B+"),";
l=this.topStack()
}}else{l=this.topStack()
}var z=D.call(this,l);
if(C){if(this.inlineStack.length||this.compileStack.length){this.popStack()
}this.push("("+A+z+")")
}else{if(!/^stack/.test(l)){l=this.nextStack()
}this.source.push(l+" = ("+A+z+");")
}return l
},nextStack:function(){return this.pushStack()
},incrStack:function(){this.stackSlot++;
if(this.stackSlot>this.stackVars.length){this.stackVars.push("stack"+this.stackSlot)
}return this.topStackName()
},topStackName:function(){return"stack"+this.stackSlot
},flushInline:function(){var z=this.inlineStack;
if(z.length){this.inlineStack=[];
for(var w=0,l=z.length;
w<l;
w++){var A=z[w];
if(A instanceof u){this.compileStack.push(A)
}else{this.pushStack(A)
}}}},isInline:function(){return this.inlineStack.length
},popStack:function(l){var z=this.isInline(),w=(z?this.inlineStack:this.compileStack).pop();
if(!l&&(w instanceof u)){return w.value
}else{if(!z){this.stackSlot--
}return w
}},topStack:function(w){var l=(this.isInline()?this.inlineStack:this.compileStack),z=l[l.length-1];
if(!w&&(z instanceof u)){return z.value
}else{return z
}},quotedString:function(l){return'"'+l.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'
},setupHelper:function(B,z,w){var A=[];
this.setupParams(B,A,w);
var l=this.nameLookup("helpers",z,"helper");
return{params:A,name:l,callParams:["depth0"].concat(A).join(", "),helperMissingParams:w&&["depth0",this.quotedString(z)].concat(A).join(", ")}
},setupParams:function(A,z,l){var G=[],E=[],F=[],w,B,D;
G.push("hash:"+this.popStack());
B=this.popStack();
D=this.popStack();
if(D||B){if(!D){this.context.aliases.self="this";
D="self.noop"
}if(!B){this.context.aliases.self="this";
B="self.noop"
}G.push("inverse:"+B);
G.push("fn:"+D)
}for(var C=0;
C<A;
C++){w=this.popStack();
z.push(w);
if(this.options.stringParams){F.push(this.popStack());
E.push(this.popStack())
}}if(this.options.stringParams){G.push("contexts:["+E.join(",")+"]");
G.push("types:["+F.join(",")+"]");
G.push("hashContexts:hashContexts");
G.push("hashTypes:hashTypes")
}if(this.options.data){G.push("data:data")
}G="{"+G.join(",")+"}";
if(l){this.register("options",G);
z.push("options")
}else{z.push(G)
}return z.join(", ")
}};
var h=("break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield").split(" ");
var a=j.RESERVED_WORDS={};
for(var q=0,o=h.length;
q<o;
q++){a[h[q]]=true
}j.isValidJavaScriptVariableName=function(l){if(!j.RESERVED_WORDS[l]&&/^[a-zA-Z_$][0-9a-zA-Z_$]+$/.test(l)){return true
}return false
};
f.precompile=function(z,A){if(z==null||(typeof z!=="string"&&z.constructor!==f.AST.ProgramNode)){throw new f.Exception("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+z)
}A=A||{};
if(!("data" in A)){A.data=true
}var w=f.parse(z);
var l=new m().compile(w,A);
return new j().compile(l,A)
};
f.compile=function(l,w){if(l==null||(typeof l!=="string"&&l.constructor!==f.AST.ProgramNode)){throw new f.Exception("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+l)
}w=w||{};
if(!("data" in w)){w.data=true
}var A;
function z(){var D=f.parse(l);
var C=new m().compile(D,w);
var B=new j().compile(C,w,d,true);
return f.template(B)
}return function(C,B){if(!A){A=z()
}return A.call(this,C,B)
}
};
f.VM={template:function(l){var w={escapeExpression:f.Utils.escapeExpression,invokePartial:f.VM.invokePartial,programs:[],program:function(A,B,C){var z=this.programs[A];
if(C){z=f.VM.program(A,B,C)
}else{if(!z){z=this.programs[A]=f.VM.program(A,B)
}}return z
},merge:function(B,A){var z=B||A;
if(B&&A){z={};
f.Utils.extend(z,A);
f.Utils.extend(z,B)
}return z
},programWithDepth:f.VM.programWithDepth,noop:f.VM.noop,compilerInfo:null};
return function(D,C){C=C||{};
var A=l.call(w,f,D,C.helpers,C.partials,C.data);
var E=w.compilerInfo||[],B=E[0]||1,G=f.COMPILER_REVISION;
if(B!==G){if(B<G){var z=f.REVISION_CHANGES[G],F=f.REVISION_CHANGES[B];
throw"Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+z+") or downgrade your runtime to an older version ("+F+")."
}else{throw"Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+E[1]+")."
}}return A
}
},programWithDepth:function(z,A,B){var w=Array.prototype.slice.call(arguments,3);
var l=function(D,C){C=C||{};
return A.apply(this,[D,C.data||B].concat(w))
};
l.program=z;
l.depth=w.length;
return l
},program:function(w,z,A){var l=function(C,B){B=B||{};
return z(C,B.data||A)
};
l.program=w;
l.depth=0;
return l
},noop:function(){return""
},invokePartial:function(l,z,B,C,A,D){var w={helpers:C,partials:A,data:D};
if(l===d){throw new f.Exception("The partial "+z+" could not be found")
}else{if(l instanceof Function){return l(B,w)
}else{if(!f.compile){throw new f.Exception("The partial "+z+" could not be compiled when running in runtime-only mode")
}else{A[z]=f.compile(l,{data:D!==d});
return A[z](B,w)
}}}}};
f.template=f.VM.template
})(Handlebars);
(function(t){var ab,D="1.7.2",af=Math.round,ag,T={},H="en",S=(typeof module!=="undefined"&&module.exports),r="months|monthsShort|weekdays|weekdaysShort|weekdaysMin|longDateFormat|calendar|relativeTime|ordinal|meridiem".split("|"),A=/^\/?Date\((\-?\d+)/i,n=/(\[[^\[]*\])|(\\)?(Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|YYYY|YY|a|A|hh?|HH?|mm?|ss?|SS?S?|zz?|ZZ?|.)/g,s=/(\[[^\[]*\])|(\\)?(LT|LL?L?L?)/g,ah=/([0-9a-zA-Z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+)/gi,j=/\d\d?/,U=/\d{1,3}/,V=/\d{3}/,M=/\d{1,4}/,N=/[0-9a-z\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+/i,b=/Z|[\+\-]\d\d:?\d\d/i,u=/T/i,O=/^\s*\d{4}-\d\d-\d\d(T(\d\d(:\d\d(:\d\d(\.\d\d?\d?)?)?)?)?([\+\-]\d\d:?\d\d)?)?/,f="YYYY-MM-DDTHH:mm:ssZ",l=[["HH:mm:ss.S",/T\d\d:\d\d:\d\d\.\d{1,3}/],["HH:mm:ss",/T\d\d:\d\d:\d\d/],["HH:mm",/T\d\d:\d\d/],["HH",/T\d\d/]],F=/([\+\-]|\d\d)/gi,p="Month|Date|Hours|Minutes|Seconds|Milliseconds".split("|"),ac={Milliseconds:1,Seconds:1000,Minutes:60000,Hours:3600000,Days:86400000,Months:2592000000,Years:31536000000},o={},J="DDD w M D d".split(" "),w="M D H h m s w".split(" "),k={M:function(){return this.month()+1
},MMM:function(aj){return z("monthsShort",this.month(),this,aj)
},MMMM:function(aj){return z("months",this.month(),this,aj)
},D:function(){return this.date()
},DDD:function(){var ak=new Date(this.year(),this.month(),this.date()),aj=new Date(this.year(),0,1);
return ~~(((ak-aj)/86400000)+1.5)
},d:function(){return this.day()
},dd:function(aj){return z("weekdaysMin",this.day(),this,aj)
},ddd:function(aj){return z("weekdaysShort",this.day(),this,aj)
},dddd:function(aj){return z("weekdays",this.day(),this,aj)
},w:function(){var ak=new Date(this.year(),this.month(),this.date()-this.day()+5),aj=new Date(ak.getFullYear(),0,4);
return ~~((ak-aj)/86400000/7+1.5)
},YY:function(){return ae(this.year()%100,2)
},YYYY:function(){return ae(this.year(),4)
},a:function(){return this.lang().meridiem(this.hours(),this.minutes(),true)
},A:function(){return this.lang().meridiem(this.hours(),this.minutes(),false)
},H:function(){return this.hours()
},h:function(){return this.hours()%12||12
},m:function(){return this.minutes()
},s:function(){return this.seconds()
},S:function(){return ~~(this.milliseconds()/100)
},SS:function(){return ae(~~(this.milliseconds()/10),2)
},SSS:function(){return ae(this.milliseconds(),3)
},Z:function(){var ak=-this.zone(),aj="+";
if(ak<0){ak=-ak;
aj="-"
}return aj+ae(~~(ak/60),2)+":"+ae(~~ak%60,2)
},ZZ:function(){var ak=-this.zone(),aj="+";
if(ak<0){ak=-ak;
aj="-"
}return aj+ae(~~(10*ak/6),4)
}};
function z(al,ak,aj,am){var an=aj.lang();
return an[al].call?an[al](aj,am):an[al][ak]
}function Q(ak,aj){return function(al){return ae(ak.call(this,al),aj)
}
}function K(aj){return function(al){var ak=aj.call(this,al);
return ak+this.lang().ordinal(ak)
}
}while(J.length){ag=J.pop();
k[ag+"o"]=K(k[ag])
}while(w.length){ag=w.pop();
k[ag+ag]=Q(k[ag],2)
}k.DDDD=Q(k.DDD,3);
function v(ak,aj,al){this._d=ak;
this._isUTC=!!aj;
this._a=ak._a||null;
this._lang=al||false
}function ai(am){var ao=this._data={},ap=am.years||am.y||0,ak=am.months||am.M||0,aj=am.weeks||am.w||0,at=am.days||am.d||0,aq=am.hours||am.h||0,an=am.minutes||am.m||0,ar=am.seconds||am.s||0,al=am.milliseconds||am.ms||0;
this._milliseconds=al+ar*1000+an*60000+aq*3600000;
this._days=at+aj*7;
this._months=ak+ap*12;
ao.milliseconds=al%1000;
ar+=aa(al/1000);
ao.seconds=ar%60;
an+=aa(ar/60);
ao.minutes=an%60;
aq+=aa(an/60);
ao.hours=aq%24;
at+=aa(aq/24);
at+=aj*7;
ao.days=at%30;
ak+=aa(at/30);
ao.months=ak%12;
ap+=aa(ak/12);
ao.years=ap;
this._lang=false
}function aa(aj){if(aj<0){return Math.ceil(aj)
}else{return Math.floor(aj)
}}function ae(al,ak){var aj=al+"";
while(aj.length<ak){aj="0"+aj
}return aj
}function X(al,an,am){var ak=an._milliseconds,ao=an._days,ap=an._months,aj;
if(ak){al._d.setTime(+al+ak*am)
}if(ao){al.date(al.date()+ao*am)
}if(ap){aj=al.date();
al.date(1).month(al.month()+ap*am).date(Math.min(aj,al.daysInMonth()))
}}function G(aj){return Object.prototype.toString.call(aj)==="[object Array]"
}function W(an,am){var aj=Math.min(an.length,am.length),ak=Math.abs(an.length-am.length),ao=0,al;
for(al=0;
al<aj;
al++){if(~~an[al]!==~~am[al]){ao++
}}return ao+ak
}function m(ak,ap,ao,an){var am,al,aj=[];
for(am=0;
am<7;
am++){aj[am]=ak[am]=(ak[am]==null)?(am===2?1:0):ak[am]
}ak[7]=aj[7]=ap;
if(ak[8]!=null){aj[8]=ak[8]
}ak[3]+=ao||0;
ak[4]+=an||0;
al=new Date(0);
if(ap){al.setUTCFullYear(ak[0],ak[1],ak[2]);
al.setUTCHours(ak[3],ak[4],ak[5],ak[6])
}else{al.setFullYear(ak[0],ak[1],ak[2]);
al.setHours(ak[3],ak[4],ak[5],ak[6])
}al._a=aj;
return al
}function C(am,ak){var al,aj,an=[];
if(!ak&&S){ak=require("./lang/"+am)
}for(al=0;
al<r.length;
al++){ak[r[al]]=ak[r[al]]||T.en[r[al]]
}for(al=0;
al<12;
al++){aj=ab([2000,al]);
an[al]=new RegExp("^"+(ak.months[al]||ak.months(aj,""))+"|^"+(ak.monthsShort[al]||ak.monthsShort(aj,"")).replace(".",""),"i")
}ak.monthsParse=ak.monthsParse||an;
T[am]=ak;
return ak
}function B(aj){var ak=(typeof aj==="string")&&aj||aj&&aj._lang||null;
return ak?(T[ak]||C(ak)):ab
}function L(aj){if(aj.match(/\[.*\]/)){return aj.replace(/^\[|\]$/g,"")
}return aj.replace(/\\/g,"")
}function Z(al){var am=al.match(n),aj,ak;
for(aj=0,ak=am.length;
aj<ak;
aj++){if(k[am[aj]]){am[aj]=k[am[aj]]
}else{am[aj]=L(am[aj])
}}return function(ao){var an="";
for(aj=0;
aj<ak;
aj++){an+=typeof am[aj].call==="function"?am[aj].call(ao,al):am[aj]
}return an
}
}function R(aj,am){var ak=5;
function al(an){return aj.lang().longDateFormat[an]||an
}while(ak--&&s.test(am)){am=am.replace(s,al)
}if(!o[am]){o[am]=Z(am)
}return o[am](aj)
}function h(aj){switch(aj){case"DDDD":return V;
case"YYYY":return M;
case"S":case"SS":case"SSS":case"DDD":return U;
case"MMM":case"MMMM":case"dd":case"ddd":case"dddd":case"a":case"A":return N;
case"Z":case"ZZ":return b;
case"T":return u;
case"MM":case"DD":case"YY":case"HH":case"hh":case"mm":case"ss":case"M":case"D":case"d":case"H":case"h":case"m":case"s":return j;
default:return new RegExp(aj.replace("\\",""))
}}function g(ao,am,al,an){var ak,aj;
switch(ao){case"M":case"MM":al[1]=(am==null)?0:~~am-1;
break;
case"MMM":case"MMMM":for(ak=0;
ak<12;
ak++){if(B().monthsParse[ak].test(am)){al[1]=ak;
aj=true;
break
}}if(!aj){al[8]=false
}break;
case"D":case"DD":case"DDD":case"DDDD":if(am!=null){al[2]=~~am
}break;
case"YY":al[0]=~~am+(~~am>70?1900:2000);
break;
case"YYYY":al[0]=~~Math.abs(am);
break;
case"a":case"A":an.isPm=((am+"").toLowerCase()==="pm");
break;
case"H":case"HH":case"h":case"hh":al[3]=~~am;
break;
case"m":case"mm":al[4]=~~am;
break;
case"s":case"ss":al[5]=~~am;
break;
case"S":case"SS":case"SSS":al[6]=~~(("0."+am)*1000);
break;
case"Z":case"ZZ":an.isUTC=true;
ak=(am+"").match(F);
if(ak&&ak[1]){an.tzh=~~ak[1]
}if(ak&&ak[2]){an.tzm=~~ak[2]
}if(ak&&ak[0]==="+"){an.tzh=-an.tzh;
an.tzm=-an.tzm
}break
}if(am==null){al[8]=false
}}function P(al,ap){var aj=[0,0,1,0,0,0,0],ak={tzh:0,tzm:0},ao=ap.match(n),am,an;
for(am=0;
am<ao.length;
am++){an=(h(ao[am]).exec(al)||[])[0];
if(an){al=al.slice(al.indexOf(an)+an.length)
}if(k[ao[am]]){g(ao[am],an,aj,ak)
}}if(ak.isPm&&aj[3]<12){aj[3]+=12
}if(ak.isPm===false&&aj[3]===12){aj[3]=0
}return m(aj,ak.isUTC,ak.tzh,ak.tzm)
}function E(an,ap){var ak,aq=an.match(ah)||[],ao,ar=99,am,aj,al;
for(am=0;
am<ap.length;
am++){aj=P(an,ap[am]);
ao=R(new v(aj),ap[am]).match(ah)||[];
al=W(aq,ao);
if(al<ar){ar=al;
ak=aj
}}return ak
}function ad(aj){var al="YYYY-MM-DDT",ak;
if(O.exec(aj)){for(ak=0;
ak<4;
ak++){if(l[ak][1].exec(aj)){al+=l[ak][0];
break
}}return b.exec(aj)?P(aj,al+" Z"):P(aj,al)
}return new Date(aj)
}function Y(ak,am,al,an,ao){var aj=ao.relativeTime[ak];
return(typeof aj==="function")?aj(am||1,!!al,ak,an):aj.replace(/%d/i,am||1)
}function I(al,aj,ak){var aq=af(Math.abs(al)/1000),am=af(aq/60),ap=af(am/60),ar=af(ap/24),an=af(ar/365),ao=aq<45&&["s",aq]||am===1&&["m"]||am<45&&["mm",am]||ap===1&&["h"]||ap<22&&["hh",ap]||ar===1&&["d"]||ar<=25&&["dd",ar]||ar<=45&&["M"]||ar<345&&["MM",af(ar/30)]||an===1&&["y"]||["yy",an];
ao[2]=aj;
ao[3]=al>0;
ao[4]=ak;
return Y.apply({},ao)
}ab=function(ak,am){if(ak===null||ak===""){return null
}var al,aj;
if(ab.isMoment(ak)){return new v(new Date(+ak._d),ak._isUTC,ak._lang)
}else{if(am){if(G(am)){al=E(ak,am)
}else{al=P(ak,am)
}}else{aj=A.exec(ak);
al=ak===t?new Date():aj?new Date(+aj[1]):ak instanceof Date?ak:G(ak)?m(ak):typeof ak==="string"?ad(ak):new Date(ak)
}}return new v(al)
};
ab.utc=function(aj,ak){if(G(aj)){return new v(m(aj,true),true)
}if(typeof aj==="string"&&!b.exec(aj)){aj+=" +0000";
if(ak){ak+=" Z"
}}return ab(aj,ak).utc()
};
ab.unix=function(aj){return ab(aj*1000)
};
ab.duration=function(aj,an){var am=ab.isDuration(aj),al=(typeof aj==="number"),ao=(am?aj._data:(al?{}:aj)),ak;
if(al){if(an){ao[an]=aj
}else{ao.milliseconds=aj
}}ak=new ai(ao);
if(am){ak._lang=aj._lang
}return ak
};
ab.humanizeDuration=function(aj,ak,al){return ab.duration(aj,ak===true?null:ak).humanize(ak===true?true:al)
};
ab.version=D;
ab.defaultFormat=f;
ab.lang=function(al,aj){var ak;
if(!al){return H
}if(aj||!T[al]){C(al,aj)
}if(T[al]){for(ak=0;
ak<r.length;
ak++){ab[r[ak]]=T[al][r[ak]]
}ab.monthsParse=T[al].monthsParse;
H=al
}};
ab.langData=B;
ab.isMoment=function(aj){return aj instanceof v
};
ab.isDuration=function(aj){return aj instanceof ai
};
ab.lang("en",{months:"January_February_March_April_May_June_July_August_September_October_November_December".split("_"),monthsShort:"Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),weekdays:"Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),weekdaysShort:"Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),weekdaysMin:"Su_Mo_Tu_We_Th_Fr_Sa".split("_"),longDateFormat:{LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D YYYY",LLL:"MMMM D YYYY LT",LLLL:"dddd, MMMM D YYYY LT"},meridiem:function(aj,ak,al){if(aj>11){return al?"pm":"PM"
}else{return al?"am":"AM"
}},calendar:{sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[last] dddd [at] LT",sameElse:"L"},relativeTime:{future:"in %s",past:"%s ago",s:"a few seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},ordinal:function(ak){var aj=ak%10;
return(~~(ak%100/10)===1)?"th":(aj===1)?"st":(aj===2)?"nd":(aj===3)?"rd":"th"
}});
ab.fn=v.prototype={clone:function(){return ab(this)
},valueOf:function(){return +this._d
},unix:function(){return Math.floor(+this._d/1000)
},toString:function(){return this._d.toString()
},toDate:function(){return this._d
},toArray:function(){var aj=this;
return[aj.year(),aj.month(),aj.date(),aj.hours(),aj.minutes(),aj.seconds(),aj.milliseconds(),!!this._isUTC]
},isValid:function(){if(this._a){if(this._a[8]!=null){return !!this._a[8]
}return !W(this._a,(this._a[7]?ab.utc(this._a):ab(this._a)).toArray())
}return !isNaN(this._d.getTime())
},utc:function(){this._isUTC=true;
return this
},local:function(){this._isUTC=false;
return this
},format:function(aj){return R(this,aj?aj:ab.defaultFormat)
},add:function(aj,al){var ak=al?ab.duration(+al,aj):ab.duration(aj);
X(this,ak,1);
return this
},subtract:function(aj,al){var ak=al?ab.duration(+al,aj):ab.duration(aj);
X(this,ak,-1);
return this
},diff:function(aq,al,at){var aj=this._isUTC?ab(aq).utc():ab(aq).local(),an=(this.zone()-aj.zone())*60000,ar=this._d-aj._d-an,ap=this.year()-aj.year(),ao=this.month()-aj.month(),am=this.date()-aj.date(),ak;
if(al==="months"){ak=ap*12+ao+am/30
}else{if(al==="years"){ak=ap+(ao+am/30)/12
}else{ak=al==="seconds"?ar/1000:al==="minutes"?ar/60000:al==="hours"?ar/3600000:al==="days"?ar/86400000:al==="weeks"?ar/604800000:ar
}}return at?ak:af(ak)
},from:function(ak,aj){return ab.duration(this.diff(ak)).lang(this._lang).humanize(!aj)
},fromNow:function(aj){return this.from(ab(),aj)
},calendar:function(){var am=this.diff(ab().sod(),"days",true),al=this.lang().calendar,ak=al.sameElse,aj=am<-6?ak:am<-1?al.lastWeek:am<0?al.lastDay:am<1?al.sameDay:am<2?al.nextDay:am<7?al.nextWeek:ak;
return this.format(typeof aj==="function"?aj.apply(this):aj)
},isLeapYear:function(){var aj=this.year();
return(aj%4===0&&aj%100!==0)||aj%400===0
},isDST:function(){return(this.zone()<ab([this.year()]).zone()||this.zone()<ab([this.year(),5]).zone())
},day:function(ak){var aj=this._isUTC?this._d.getUTCDay():this._d.getDay();
return ak==null?aj:this.add({d:ak-aj})
},startOf:function(aj){switch(aj.replace(/s$/,"")){case"year":this.month(0);
case"month":this.date(1);
case"day":this.hours(0);
case"hour":this.minutes(0);
case"minute":this.seconds(0);
case"second":this.milliseconds(0)
}return this
},endOf:function(aj){return this.startOf(aj).add(aj.replace(/s?$/,"s"),1).subtract("ms",1)
},sod:function(){return this.clone().startOf("day")
},eod:function(){return this.clone().endOf("day")
},zone:function(){return this._isUTC?0:this._d.getTimezoneOffset()
},daysInMonth:function(){return ab.utc([this.year(),this.month()+1,0]).date()
},lang:function(aj){if(aj===t){return B(this)
}else{this._lang=aj;
return this
}}};
function q(aj,ak){ab.fn[aj]=function(al){var am=this._isUTC?"UTC":"";
if(al!=null){this._d["set"+am+ak](al);
return this
}else{return this._d["get"+am+ak]()
}}
}for(ag=0;
ag<p.length;
ag++){q(p[ag].toLowerCase(),p[ag])
}q("year","FullYear");
ab.duration.fn=ai.prototype={weeks:function(){return aa(this.days()/7)
},valueOf:function(){return this._milliseconds+this._days*86400000+this._months*2592000000
},humanize:function(am){var an=+this,aj=this.lang().relativeTime,ak=I(an,!am,this.lang()),al=an<=0?aj.past:aj.future;
if(am){if(typeof al==="function"){ak=al(ak)
}else{ak=al.replace(/%s/i,ak)
}}return ak
},lang:ab.fn.lang};
function a(aj){ab.duration.fn[aj]=function(){return this._data[aj]
}
}function d(aj,ak){ab.duration.fn["as"+aj]=function(){return +this/ak
}
}for(ag in ac){if(ac.hasOwnProperty(ag)){d(ag,ac[ag]);
a(ag.toLowerCase())
}}d("Weeks",604800000);
if(S){module.exports=ab
}if(typeof ender==="undefined"){this["moment"]=ab
}if(typeof define==="function"&&define.amd){define("moment",[],function(){return ab
})
}}).call(this);
(function(g,b){var k="jwv7ouu";
if(g.CUI&&g.CUI.options&&g.CUI.options.typeKitId){k=g.CUI.options.typeKitId
}var a={kitId:k,scriptTimeout:3000};
if(!g.Typekit){var f=document.getElementsByTagName("html")[0];
f.className+=" wf-loading";
var l=setTimeout(function(){f.className=f.className.replace(/(\s|^)wf-loading(\s|$)/g," ");
f.className+=" wf-inactive"
},a.scriptTimeout);
var n=document.createElement("script"),j=false;
n.src="//use.typekit.net/"+a.kitId+".js";
n.type="text/javascript";
n.async="true";
n.onload=n.onreadystatechange=function(){var h=this.readyState;
if(j||h&&h!="complete"&&h!="loaded"){return
}j=true;
clearTimeout(l);
try{Typekit.load(a)
}catch(d){}};
var m=document.getElementsByTagName("script")[0];
m.parentNode.insertBefore(n,m)
}}(this));
(function(f,g,j){var a=g.event,d;
a.special.smartresize={setup:function(){g(this).bind("resize",a.special.smartresize.handler)
},teardown:function(){g(this).unbind("resize",a.special.smartresize.handler)
},handler:function(n,k){var m=this,l=arguments;
n.type="smartresize";
if(d){clearTimeout(d)
}d=setTimeout(function(){g(this).trigger(n,[l])
},k==="execAsap"?0:10)
}};
g.fn.smartresize=function(k){return k?this.bind("smartresize",k):this.trigger("smartresize",["execAsap"])
};
g.CUIGridLayout=function(k,l,m){this.element=g(l);
this._create(k);
this._init(m)
};
var h=g(f);
g.CUIGridLayout.settings={colWidth:240,gutterX:15,gutterY:15,marginLeft:0,marginRight:0,selector:"article"};
g.CUIGridLayout.prototype={option:function(k){this.options=g.extend({},g.CUIGridLayout.settings,k)
},_create:function(l){this.options=g.extend({},g.CUIGridLayout.settings,l);
this.items=[];
this.itemsByPath={};
this.numCols=-1;
this.pendingImages=0;
this.update();
var k=this;
h.bind("smartresize.cui.gridlayout",function(){k.updateDimensions();
k.layout()
})
},_init:function(k){this.updateDimensions();
this.layout(k);
setTimeout(function(){this.numCols=-1;
this.updateDimensions();
this.layout(k);
this.element.trigger(g.Event("cui-gridlayout-initialized",{widget:this}))
}.bind(this),1)
},update:function(){var k=[],l={};
this.element.find(this.options.selector).each(function(n){var p=g(this);
var m=g("img",p);
if(m.length===0){m=null
}var o={path:p.data().path,i:n,$el:p,$img:m};
k.push(o);
l[o.path]=o
});
this.items=k.sort(function(p,o){var n=p.$el.data("gridlayout-sortkey")||0,m=o.$el.data("gridlayout-sortkey")||0;
return m-n||p.i-o.i
});
this.itemsByPath=l
},_imageLoaded:function(){if(--this.pendingImages==0){this.numCols=-1;
this.layout()
}},updateDimensions:function(){var k=this;
this.items.every(function(m){var l=m.$el;
m.w=l.width();
m.h=l.height();
if(m.$img){if(m.$img.width()>m.w){m.h=(m.h-m.$img.height())+(m.$img.height()/m.$img.width()*m.w)
}if(m.$img.height()==0){m.h+=m.w;
k.pendingImages++;
m.$img.on("load.cui.gridlayout",function(){m.$img=null;
m.w=l.width();
m.h=l.height();
k._imageLoaded()
})
}else{m.$img=null
}}return true
})
},layout:function(){var A=this;
var u=this.element;
var p=this.options.colWidth;
var l=this.options.marginLeft;
var q=this.options.marginRight;
var z=this.options.gutterX;
if(u.width()===0){return
}var k=Math.floor((u.width()-l-q+z)/(p+z));
if(k<1){k=1
}if(k==this.numCols){return
}this.numCols=k;
var o=((u.width()-l-q+z)/k)-z;
var v=[];
var s=[];
while(v.length<k){v.push([]);
s.push(0)
}this.items.every(function(C){var n=(C.h/C.w)*o;
var B=s[0];
var E=0;
for(var F=0;
F<s.length;
F++){var D=s[F];
if(D<B){B=D;
E=F
}}v[E].push(C);
s[E]+=n+A.options.gutterY;
return true
});
u.detach(this.options.selector);
var r=u.contents();
for(var t=0;
t<v.length;
t++){var w=g('<div class="grid-'+k+'"></div>').appendTo(u);
for(var m=0;
m<v[t].length;
m++){w.append(v[t][m].$el)
}}r.remove()
},destroy:function(){h.unbind("smartresize.cui.gridlayout");
this.element.removeData("cuigridlayout")
}};
var b=function(k){if(f.console){f.console.error(k)
}};
g.fn.cuigridlayout=function(l,m){if(typeof l==="string"){var k=Array.prototype.slice.call(arguments,1);
this.each(function(){var n=g.data(this,"cuigridlayout");
if(!n){b("cannot call methods on cuigridlayout prior to initialization; attempted to call method '"+l+"'");
return
}if(!g.isFunction(n[l])||l.charAt(0)==="_"){b("no such method '"+l+"' for cuigridlayout instance");
return
}n[l].apply(n,k)
})
}else{this.each(function(){var n=g.data(this,"cuigridlayout");
if(n){n.option(l);
n._init(m)
}else{g.data(this,"cuigridlayout",new g.CUIGridLayout(l,this,m))
}})
}return this
}
})(window,jQuery);
/*!
 * jQuery :scrollable selector filter
 * https://github.com/litera/jquery-scrollintoview/blob/master/jquery.scrollintoview.js#L172
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(a,g){var d={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};
var f=/^(?:html)$/i;
var b={auto:true,scroll:true,visible:false,hidden:false};
g.extend(g.expr[":"],{scrollable:function(l,j,o,h){var n=d[typeof(o[3])==="string"&&o[3].toLowerCase()]||d.both;
var m=(a.defaultView&&a.defaultView.getComputedStyle?a.defaultView.getComputedStyle(l,null):l.currentStyle);
var p={x:b[m.overflowX.toLowerCase()]||false,y:b[m.overflowY.toLowerCase()]||false,isRoot:f.test(l.nodeName)};
if(!p.x&&!p.y&&!p.isRoot){return false
}var k={height:{scroll:l.scrollHeight,client:l.clientHeight},width:{scroll:l.scrollWidth,client:l.clientWidth},scrollableX:function(){return(p.x||p.isRoot)&&this.width.scroll>this.width.client
},scrollableY:function(){return(p.y||p.isRoot)&&this.height.scroll>this.height.client
}};
return n.y&&k.scrollableY()||n.x&&k.scrollableX()
}})
})(document,jQuery);
/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(h,b,j){var a=/\+/g;
function g(k){return k
}function d(k){return decodeURIComponent(k.replace(a," "))
}var f=h.cookie=function(r,q,w){if(q!==j){w=h.extend({},f.defaults,w);
if(q===null){w.expires=-1
}if(typeof w.expires==="number"){var s=w.expires,v=w.expires=new Date();
v.setDate(v.getDate()+s)
}q=f.json?JSON.stringify(q):String(q);
return(b.cookie=[encodeURIComponent(r),"=",f.raw?q:encodeURIComponent(q),w.expires?"; expires="+w.expires.toUTCString():"",w.path?"; path="+w.path:"",w.domain?"; domain="+w.domain:"",w.secure?"; secure":""].join(""))
}var k=f.raw?g:d;
var u=b.cookie.split("; ");
for(var p=0,n=u.length;
p<n;
p++){var o=u[p].split("=");
if(k(o.shift())===r){var m=k(o.join("="));
return f.json?JSON.parse(m):m
}}return null
};
f.defaults={};
h.removeCookie=function(l,k){if(h.cookie(l)!==null){h.cookie(l,null,k);
return true
}return false
}
})(jQuery,document);
(function(f,d,h){var g={threshold:200,applyClassToElement:h};
var b={rem:function(){if(b._rem===h){b._rem=parseInt(f("body").css("font-size"))
}return b._rem
},em:function(j){return parseFloat(j.css("font-size"))
}};
f.fn.reflow=function a(k,j){return this.each(function l(){var q=f(this),r=false,m=false,n;
if(k){n=f.extend({},g,j);
n.applyClassToElement=n.applyClassToElement||q;
function p(){if(q.is(":visible")){if(!m){o();
m=setTimeout(function s(){m=false;
if(!r&&q.is(":visible")){o()
}},n.threshold)
}else{r=false
}}}function o(){r=true;
for(var s in k){n.applyClassToElement.toggleClass(s,k[s](q,b))
}}q.on("reflow",p);
f(d).on("resize.reflow",p)
}q.trigger("reflow")
})
}
}(jQuery,this));
(function(f,b){function d(g){return function(k,j,l){if(g.message.hasOwnProperty(j)){var h=g.message[j];
(l||[]).forEach(function(n,m){h=h.replace(new RegExp("\\{"+m+"\\}","g"),n)
});
return h
}return undefined
}
}var a=(function(){var g=[];
return{register:function(h){g.push(h)
},message:function(k,j,n){for(var h=g.length-1;
h>=0;
h--){var m=g[h];
if(!k.is(m.selector)){continue
}var l=(f.isFunction(m.message)?m.message:d(m)).call(k,k,j,n);
if(l){return l
}}if(b){b.warn("Message not found:",j,k[0])
}return undefined
}}
})();
f.fn.message=function(g,h){return a.message(this.first(),g,h)
};
f.message=(function(){return{register:function(g){f.each(arguments,function(){a.register(this)
})
}}
})()
})(jQuery,window.console);
(function(j,g){var b=(function(){var m="input, textarea, select, button, keygen, object, [role=checkbox], [role=radio], [role=combobox], [role=listbox], [role=radiogroup], [role=tree], [role=slider], [role=spinbutton], [role=textbox]";
var o="input:not([readonly],[disabled],[type=hidden],[type=reset],[type=button]), select, textarea:not([readonly]), button[type=submit], [role=checkbox]:not([aria-disabled=true]), [role=radio]:not([aria-disabled=true]), [role=combobox]:not([aria-disabled=true]), [role=listbox]:not([aria-disabled=true]), [role=radiogroup]:not([aria-disabled=true]), [role=tree]:not([aria-disabled=true]), [role=slider]:not([aria-disabled=true]), [role=spinbutton]:not([aria-disabled=true]), [role=textbox]:not([aria-disabled=true],[aria-readonly=true])";
var n=[];
return{isSummittable:function(p){return p.is(m)
},submittables:function(p){return p.find(m)
},isCandidate:function(p){return p.is(o)
},api:function(p){if(!this.isSummittable(p)){return
}return p.data("validator")||(function(s,q){var r=l(s,q);
s.data("validator",r);
return r
})(p,this)
},register:function(p){n.push(p)
},validators:function(p){return n.filter(function(q){return p.is(q.selector)
})
}}
})();
function l(n,m){return new h(n,m)
}function h(n,m){this.el=n;
this.registry=m;
this.message=null;
this.customMessage=null;
this.state=(function(o){return{getCustomError:function(){return !!o.customMessage
},isValid:function(){return !o.customMessage&&!o.message
}}
})(this)
}function k(p,o,m){for(var n=p.length-1;
n>=0;
n--){if(!o.call(m,p[n],n,p)){return false
}}return true
}function d(){return g.Event("invalid",{isJqueryValidator:true})
}h.prototype={willValidate:function(){return this.registry.isCandidate(this.el)
},setCustomValidity:function(m){this.customMessage=m
},getValidity:function(){return this.state
},checkValidity:function(m){m=m||{};
if(!this.willValidate()){return true
}if(this.customMessage){if(!m.suppressEvent){this.el.trigger(d())
}return false
}this.message=null;
k(this.registry.validators(this.el),function(o){if(!o.validate){return true
}var n=o.validate(this.el);
if(n){this.message=n;
return false
}else{return true
}},this);
if(this.message){if(!m.suppressEvent){this.el.trigger(d())
}return false
}return true
},getValidationMessage:function(){if(!this.willValidate()){return""
}return this.customMessage||this.message||""
},updateUI:function(){var m;
if(this.getValidity().isValid()){m=function(n){return !n.clear||n.clear(this.el)===g.validator.CONTINUE
}
}else{m=function(n){return !n.show||n.show(this.el,this.getValidationMessage())===g.validator.CONTINUE
}
}k(this.registry.validators(this.el),m,this)
}};
g.extend(g.expr[":"],{submittable:function(m){return b.isSummittable(g(m))
}});
g.fn.willValidate=function(){var m=b.api(this.first());
if(m){return m.willValidate()
}else{return false
}};
g.fn.validationMessage=function(){var m=b.api(this.first());
if(m){return m.getValidationMessage()
}else{return""
}};
g.fn.checkValidity=function(){var m=b.api(this.first());
if(m){return m.checkValidity()
}else{return true
}};
g.fn.setCustomValidity=function(m){return this.each(function(){var n=b.api(g(this));
if(n){n.setCustomValidity(m)
}})
};
g.fn.updateErrorUI=function(){return this.each(function(){var m=b.api(g(this));
if(m){m.updateUI()
}})
};
g.validator=(function(){return{CONTINUE:1,STOP:2,register:function(){g.each(arguments,function(){b.register(this)
})
},isValid:function(m){var n=true;
m.find(":submittable").each(function(){var o=g(this);
if(o.willValidate()&&!o.checkValidity()){n=false;
return false
}});
return n
}}
})();
function f(n,m){return m.submittables(n).map(function(){var o=m.api(g(this));
if(!o||!o.willValidate()||o.checkValidity({suppressEvent:true})){return
}return this
}).map(function(){var o=d();
g(this).trigger(o);
if(!o.isDefaultPrevented()){return this
}})
}function a(o,m){var n=f(o,m);
if(n.length>0){n.each(function(){var p=m.api(g(this));
if(p){p.updateUI()
}});
return false
}return true
}j.addEventListener("submit",function(n){var m=g(n.target);
if(!m.is("form")||m.prop("noValidate")===true||(m.prop("noValidate")===undefined&&m.attr("novalidate")!==undefined)){return
}if(!a(m,b)){n.stopPropagation();
n.preventDefault()
}},true)
})(document,jQuery);
/*!
 * jQuery UI Position @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */
(function(g,d){g.ui=g.ui||{};
var m,n=Math.max,r=Math.abs,p=Math.round,f=/left|center|right/,k=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,o=/^\w+/,b=/%$/,j=g.fn.position;
function q(u,t,s){return[parseFloat(u[0])*(b.test(u[0])?t/100:1),parseFloat(u[1])*(b.test(u[1])?s/100:1)]
}function l(s,t){return parseInt(g.css(s,t),10)||0
}function h(t){var s=t[0];
if(s.nodeType===9){return{width:t.width(),height:t.height(),offset:{top:0,left:0}}
}if(g.isWindow(s)){return{width:t.width(),height:t.height(),offset:{top:t.scrollTop(),left:t.scrollLeft()}}
}if(s.preventDefault){return{width:0,height:0,offset:{top:s.pageY,left:s.pageX}}
}return{width:t.outerWidth(),height:t.outerHeight(),offset:t.offset()}
}g.position={scrollbarWidth:function(){if(m!==d){return m
}var t,s,v=g("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),u=v.children()[0];
g("body").append(v);
t=u.offsetWidth;
v.css("overflow","scroll");
s=u.offsetWidth;
if(t===s){s=v[0].clientWidth
}v.remove();
return(m=t-s)
},getScrollInfo:function(w){var v=w.isWindow?"":w.element.css("overflow-x"),u=w.isWindow?"":w.element.css("overflow-y"),t=v==="scroll"||(v==="auto"&&w.width<w.element[0].scrollWidth),s=u==="scroll"||(u==="auto"&&w.height<w.element[0].scrollHeight);
return{width:s?g.position.scrollbarWidth():0,height:t?g.position.scrollbarWidth():0}
},getWithinInfo:function(t){var u=g(t||window),s=g.isWindow(u[0]);
return{element:u,isWindow:s,offset:u.offset()||{left:0,top:0},scrollLeft:u.scrollLeft(),scrollTop:u.scrollTop(),width:s?u.width():u.outerWidth(),height:s?u.height():u.outerHeight()}
}};
g.fn.position=function(E){if(!E||!E.of){return j.apply(this,arguments)
}E=g.extend({},E);
var F,B,z,D,w,s,A=g(E.of),v=g.position.getWithinInfo(E.within),t=g.position.getScrollInfo(v),C=(E.collision||"flip").split(" "),u={};
s=h(A);
if(A[0].preventDefault){E.at="left top"
}B=s.width;
z=s.height;
D=s.offset;
w=g.extend({},D);
g.each(["my","at"],function(){var I=(E[this]||"").split(" "),H,G;
if(I.length===1){I=f.test(I[0])?I.concat(["center"]):k.test(I[0])?["center"].concat(I):["center","center"]
}I[0]=f.test(I[0])?I[0]:"center";
I[1]=k.test(I[1])?I[1]:"center";
H=a.exec(I[0]);
G=a.exec(I[1]);
u[this]=[H?H[0]:0,G?G[0]:0];
E[this]=[o.exec(I[0])[0],o.exec(I[1])[0]]
});
if(C.length===1){C[1]=C[0]
}if(E.at[0]==="right"){w.left+=B
}else{if(E.at[0]==="center"){w.left+=B/2
}}if(E.at[1]==="bottom"){w.top+=z
}else{if(E.at[1]==="center"){w.top+=z/2
}}F=q(u.at,B,z);
w.left+=F[0];
w.top+=F[1];
return this.each(function(){var H,Q,J=g(this),L=J.outerWidth(),I=J.outerHeight(),K=l(this,"marginLeft"),G=l(this,"marginTop"),P=L+K+l(this,"marginRight")+t.width,O=I+G+l(this,"marginBottom")+t.height,M=g.extend({},w),N=q(u.my,J.outerWidth(),J.outerHeight());
if(E.my[0]==="right"){M.left-=L
}else{if(E.my[0]==="center"){M.left-=L/2
}}if(E.my[1]==="bottom"){M.top-=I
}else{if(E.my[1]==="center"){M.top-=I/2
}}M.left+=N[0];
M.top+=N[1];
if(!g.support.offsetFractions){M.left=p(M.left);
M.top=p(M.top)
}H={marginLeft:K,marginTop:G};
g.each(["left","top"],function(S,R){if(g.ui.position[C[S]]){g.ui.position[C[S]][R](M,{targetWidth:B,targetHeight:z,elemWidth:L,elemHeight:I,collisionPosition:H,collisionWidth:P,collisionHeight:O,offset:[F[0]+N[0],F[1]+N[1]],my:E.my,at:E.at,within:v,elem:J})
}});
if(E.using){Q=function(U){var W=D.left-M.left,T=W+B-L,V=D.top-M.top,S=V+z-I,R={target:{element:A,left:D.left,top:D.top,width:B,height:z},element:{element:J,left:M.left,top:M.top,width:L,height:I},horizontal:T<0?"left":W>0?"right":"center",vertical:S<0?"top":V>0?"bottom":"middle"};
if(B<L&&r(W+T)<B){R.horizontal="center"
}if(z<I&&r(V+S)<z){R.vertical="middle"
}if(n(r(W),r(T))>n(r(V),r(S))){R.important="horizontal"
}else{R.important="vertical"
}E.using.call(this,U,R)
}
}J.offset(g.extend(M,{using:Q}))
})
};
g.ui.position={fit:{left:function(w,v){var u=v.within,A=u.isWindow?u.scrollLeft:u.offset.left,C=u.width,z=w.left-v.collisionPosition.marginLeft,B=A-z,t=z+v.collisionWidth-C-A,s;
if(v.collisionWidth>C){if(B>0&&t<=0){s=w.left+B+v.collisionWidth-C-A;
w.left+=B-s
}else{if(t>0&&B<=0){w.left=A
}else{if(B>t){w.left=A+C-v.collisionWidth
}else{w.left=A
}}}}else{if(B>0){w.left+=B
}else{if(t>0){w.left-=t
}else{w.left=n(w.left-z,w.left)
}}}},top:function(v,u){var t=u.within,B=t.isWindow?t.scrollTop:t.offset.top,C=u.within.height,z=v.top-u.collisionPosition.marginTop,A=B-z,w=z+u.collisionHeight-C-B,s;
if(u.collisionHeight>C){if(A>0&&w<=0){s=v.top+A+u.collisionHeight-C-B;
v.top+=A-s
}else{if(w>0&&A<=0){v.top=B
}else{if(A>w){v.top=B+C-u.collisionHeight
}else{v.top=B
}}}}else{if(A>0){v.top+=A
}else{if(w>0){v.top-=w
}else{v.top=n(v.top-z,v.top)
}}}}},flip:{left:function(A,z){var w=z.within,E=w.offset.left+w.scrollLeft,H=w.width,u=w.isWindow?w.scrollLeft:w.offset.left,B=A.left-z.collisionPosition.marginLeft,F=B-u,t=B+z.collisionWidth-H-u,D=z.my[0]==="left"?-z.elemWidth:z.my[0]==="right"?z.elemWidth:0,G=z.at[0]==="left"?z.targetWidth:z.at[0]==="right"?-z.targetWidth:0,v=-2*z.offset[0],s,C;
if(F<0){s=A.left+D+G+v+z.collisionWidth-H-E;
if(s<0||s<r(F)){A.left+=D+G+v
}}else{if(t>0){C=A.left-z.collisionPosition.marginLeft+D+G+v-u;
if(C>0||r(C)<t){A.left+=D+G+v
}}}},top:function(z,w){var v=w.within,G=v.offset.top+v.scrollTop,H=v.height,s=v.isWindow?v.scrollTop:v.offset.top,B=z.top-w.collisionPosition.marginTop,D=B-s,A=B+w.collisionHeight-H-s,E=w.my[1]==="top",C=E?-w.elemHeight:w.my[1]==="bottom"?w.elemHeight:0,I=w.at[1]==="top"?w.targetHeight:w.at[1]==="bottom"?-w.targetHeight:0,u=-2*w.offset[1],F,t;
if(D<0){t=z.top+C+I+u+w.collisionHeight-H-G;
if((z.top+C+I+u)>D&&(t<0||t<r(D))){z.top+=C+I+u
}}else{if(A>0){F=z.top-w.collisionPosition.marginTop+C+I+u-s;
if((z.top+C+I+u)>A&&(F>0||r(F)<A)){z.top+=C+I+u
}}}}},flipfit:{left:function(){g.ui.position.flip.left.apply(this,arguments);
g.ui.position.fit.left.apply(this,arguments)
},top:function(){g.ui.position.flip.top.apply(this,arguments);
g.ui.position.fit.top.apply(this,arguments)
}}};
(function(){var w,A,t,v,u,s=document.getElementsByTagName("body")[0],z=document.createElement("div");
w=document.createElement(s?"div":"body");
t={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};
if(s){g.extend(t,{position:"absolute",left:"-1000px",top:"-1000px"})
}for(u in t){w.style[u]=t[u]
}w.appendChild(z);
A=s||document.documentElement;
A.insertBefore(w,A.firstChild);
z.style.cssText="position: absolute; left: 10.7432222px;";
v=g(z).offset().left;
g.support.offsetFractions=v>10&&v<11;
w.innerHTML="";
A.removeChild(w)
})()
}(jQuery));
/*!
* toe.js
* version 3.0.2
* author: Damien Antipa
* https://github.com/dantipa/toe.js
*/
(function(g,k,b){var a,j={},f={active:false,on:function(){g(document).on("touchstart",h).on("touchmove",d).on("touchend touchcancel",l);
f.active=true
},off:function(){g(document).off("touchstart",h).off("touchmove",d).off("touchend touchcancel",l);
f.active=false
},track:function(o,n){j[o]=n
},addEventParam:function(o,n){var r=g(o.target),q=r.offset(),p={pageX:o.point[0].x,pageY:o.point[0].y,offsetX:q.left-o.point[0].x,offsetY:q.top-o.point[0].y};
return g.extend(p,n)
},Event:function(p){var o={type:p.type,timestamp:new Date().getTime(),target:p.target,point:[]},n=p.changedTouches||p.originalEvent.changedTouches||p.touches||p.originalEvent.touches;
g.each(n,function(q,r){o.point.push({x:r.pageX,y:r.pageY})
});
return o
},State:function(o){var n=o.point[0];
return{start:o,move:[],end:null}
},calc:{getDuration:function(o,n){return n.timestamp-o.timestamp
},getDistance:function(o,n){return Math.sqrt(Math.pow(n.x-o.x,2)+Math.pow(n.y-o.y,2))
},getAngle:function(o,n){return Math.atan2(n.y-o.y,n.x-o.x)*180/Math.PI
},getDirection:function(n){return n<-45&&n>-135?"top":n>=-45&&n<=45?"right":n>=45&&n<135?"down":n>=135||n<=-135?"left":"unknown"
},getScale:function(q,n){var p=q.point,o=n.point;
if(p.length===2&&o.length===2){return(Math.sqrt(Math.pow(o[0].x-o[1].x,2)+Math.pow(o[0].y-o[1].y,2))/Math.sqrt(Math.pow(p[0].x-p[1].x,2)+Math.pow(p[0].y-p[1].y,2))).toFixed(2)
}return 0
},getRotation:function(q,n){var p=q.point,o=n.point;
if(p.length===2&&o.length===2){return((Math.atan2(o[0].y-o[1].y,o[0].x-o[1].x)*180/Math.PI)-(Math.atan2(p[0].y-p[1].y,p[0].x-p[1].x)*180/Math.PI)).toFixed(2)
}return 0
}}};
function m(o,p,q,n){g.each(j,function(r,s){s[o].call(this,p,q,n)
})
}function h(n){var o=f.Event(n);
a=f.State(o);
m("touchstart",n,a,o)
}function d(o){var n=f.Event(o);
a.move.push(n);
m("touchmove",o,a,n)
}function l(o){var n=f.Event(o);
a.end=n;
m("touchend",o,a,n)
}f.on();
g.toe=f
}(jQuery,this));
(function(f,h,d,g){var b="swipe",a={distance:40,duration:1200,direction:"all"};
h.track(b,{touchstart:function(j,k,l){k[b]={finger:l.point.length}
},touchmove:function(k,l,j){l[b].finger=j.point.length>l[b].finger?j.point.length:l[b].finger
},touchend:function(l,m,j){var k=f.extend(a,l.data),n,o;
n=h.calc.getDuration(m.start,j);
o=h.calc.getDistance(m.start.point[0],j.point[0]);
if(n<k.duration&&o>k.distance){m[b].angle=h.calc.getAngle(m.start.point[0],j.point[0]);
m[b].direction=h.calc.getDirection(m[b].angle);
if(k.direction==="all"||m[b].direction===k.direction){f(l.target).trigger(f.Event(b,h.addEventParam(m.start,m[b])))
}}}})
}(jQuery,jQuery.toe,this));
(function(f,h,d,g){var b="tap",a={distance:10,duration:300,finger:1};
h.track(b,{touchstart:function(j,k,l){k[b]={finger:l.point.length}
},touchmove:function(k,l,j){l[b].finger=j.point.length>l[b].finger?j.point.length:l[b].finger
},touchend:function(l,m,j){var k=f.extend(a,l.data),n,o;
n=h.calc.getDuration(m.start,j);
o=h.calc.getDistance(m.start.point[0],j.point[0]);
if(n<k.duration&&o<k.distance){if(m[b].finger===k.finger){f(l.target).trigger(f.Event(b,h.addEventParam(m.start,m[b])))
}}}})
}(jQuery,jQuery.toe,this));
(function(f,k,d,g){var j,h,b="taphold",a={distance:20,duration:500,finger:1};
k.track(b,{touchstart:function(m,n,o){var l=f.extend(a,m.data);
h=false;
n[b]={finger:o.point.length};
clearTimeout(j);
j=setTimeout(function(){if(!h&&k.active){if(n[b].finger===l.finger){f(m.target).trigger(f.Event(b,k.addEventParam(o,n[b])))
}}},l.duration)
},touchmove:function(n,o,l){var m=f.extend(a,n.data),p;
o[b].finger=l.point.length>o[b].finger?l.point.length:o[b].finger;
p=k.calc.getDistance(o.start.point[0],l.point[0]);
if(p>m.distance){h=true
}},touchend:function(m,n,l){h=true;
clearTimeout(j)
}})
}(jQuery,jQuery.toe,this));
(function(g,j,f,h){var d="transform",b={scale:0.1,rotation:15},a;
j.track(d,{touchstart:function(k,l,m){a=false;
l[d]={start:m,move:[]}
},touchmove:function(m,n,k){var l=g.extend(b,m.data);
if(k.point.length!==2){return
}n[d].move.push(k);
if(n[d].start.point.length!==2&&k.point.length===2){n[d].start=g.extend({},k)
}n[d].rotation=j.calc.getRotation(n[d].start,k);
n[d].scale=j.calc.getScale(n[d].start,k);
if(Math.abs(1-n[d].scale)>l.scale||Math.abs(n[d].rotation)>l.rotation){if(!a){g(m.target).trigger(g.Event("transformstart",n[d]));
a=true
}g(m.target).trigger(g.Event("transform",n[d]))
}},touchend:function(l,m,k){if(a){a=false;
if(k.point.length!==2){m.end=g.extend({},m[d].move[m[d].move.length-1])
}m[d].rotation=j.calc.getRotation(m[d].start,m.end);
m[d].scale=j.calc.getScale(m[d].start,m.end);
g(l.target).trigger(g.Event("transformend",m[d]))
}}})
}(jQuery,jQuery.toe,this));
var Class;
var Exception;
(function(){var d=function(g){var f=g.bind(this);
f._methodName=g._methodName;
this[f._methodName]=f;
return f
};
var b=function(f){f.extend=this;
return new Class(f)
};
Class=function(f){f=f||{};
if(f.hasOwnProperty("extend")&&!f.extend){throw new Class.NonTruthyExtendError(typeof f.toString==="function"?f.toString():f.toString)
}var j=f.extend||Object;
var n=f.construct;
var g=f.destruct;
delete f.bind;
delete f.extend;
delete f.destruct;
delete f.construct;
if(f.hasOwnProperty("toString")&&typeof f.toString!=="function"){var l=f.toString;
f.toString=function(){return l.toString()
}
}else{if(!f.hasOwnProperty("toString")&&j.prototype.hasOwnProperty("toString")){f.toString=j.prototype.toString
}}var o=f;
var k=Object.create(j&&j.prototype);
k.superClass=j.prototype;
if(o){for(var m in o){if(o.hasOwnProperty(m)){k[m]=o[m];
if(typeof o[m]==="function"){k[m]._methodName=m;
k[m]._parentProto=k
}}}}k.inherited=function(s){var r=s.callee;
var p=r._methodName;
if(!p){throw new Class.MissingCalleeError(this.toString())
}var u=r._parentProto;
var q=null;
while(u.superClass){u=u.superClass;
q=u[p];
if(typeof q==="function"){break
}}if(typeof q==="function"){var t=this.inherited;
this.inherited=u.inherited;
var v=q.apply(this,s);
this.inherited=t;
return v
}else{throw new Class.InheritedMethodNotFoundError(this.toString(),p)
}};
k.bind=d;
k.destruct=function(){if(typeof g==="function"){g.apply(this)
}if(j&&j.prototype&&typeof j.prototype.destruct==="function"){j.prototype.destruct.apply(this)
}};
k.construct=function(){var p=arguments;
if(p[0]===undefined){p.length=1;
p[0]={}
}if(j&&j.prototype&&typeof j.prototype.construct==="function"){j.prototype.construct.apply(this,arguments)
}if(typeof n==="function"){n.apply(this,arguments)
}};
var h=function(){var p=Object.create(k);
k.construct.apply(p,arguments);
return p
};
h.toString=k.toString;
h.prototype=k;
h.extend=b;
k.constructor=h;
return h
};
if(!Object.create){Object.create=function(g){if(arguments.length>1){throw new Error("Object.create implementation only accepts the first parameter.")
}function f(){}f.prototype=g;
return new f()
}
}if(!Function.prototype.bind){Function.prototype.bind=function(g){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")
}var k=Array.prototype.slice.call(arguments,1);
var j=this;
var f=function(){};
var h=function(){return j.apply(this instanceof f?this:g,k.concat(Array.prototype.slice.call(arguments)))
};
f.prototype=this.prototype;
h.prototype=new f();
return h
}
}Exception=new Class({extend:Error,construct:function(){this.name="Error";
this.message="General exception"
},toString:function(){return this.name+": "+this.message
}});
var a=Exception.extend({name:"Class Exception"});
Class.NonTruthyExtendError=a.extend({construct:function(f){this.message=f+" attempted to extend a non-truthy object"
}});
Class.InheritedMethodNotFoundError=a.extend({construct:function(g,f){this.message=g+" can't call method '"+f+"', no method defined in parent classes"
}});
Class.MissingCalleeError=a.extend({construct:function(f){this.message=f+" can't call inherited method: calling method did not have _methodName"
}})
}());
(function(b,a,d){a.CUI=a.CUI||{};
CUI.options=b.extend({debug:false,dataAPI:true},CUI.options);
b(function(){b(document).trigger("cui-contentloaded")
})
}(jQuery,this));
(function(d,b,f){var a=1;
CUI.util={isTouch:"ontouchstart" in b,getNextId:function(){return"coral-"+a++
},getDataTarget:function(h){var j=h.attr("href");
var g=d(h.attr("data-target")||(j&&j.replace(/.*(?=#[^\s]+$)/,"")));
return g
},decapitalize:function(g){return g.slice(0,1).toLowerCase()+g.slice(1)
},capitalize:function(g){return g.slice(0,1).toUpperCase()+g.slice(1)
},plugClass:function(h,g,j){g=g||CUI.util.decapitalize(h.toString());
d.fn[g]=function(k){var l=arguments;
return this.each(function(){var n=d(this);
var o=d.extend({},n.data(),typeof k==="object"&&k,{element:this});
var m=n.data(g)||new h(o);
if(typeof k==="string"){m[k].apply(m,Array.prototype.slice.call(l,1))
}else{if(d.isPlainObject(k)){m.set(k)
}}if(typeof j==="function"){j.call(this,m)
}})
};
d.fn[g].Constructor=h
},buildFunction:function(h,k){k=k||[];
if(typeof k==="string"){k=[k]
}if(h){try{var g=Function;
return new g(k,"return "+h+"("+k.join(", ")+");")
}catch(j){return null
}}},selectText:function(l,m,g){var k=l.val();
if(k.length>0){m=m||0;
g=g||k.length;
var j=d(l)[0];
if(j.setSelectionRange){j.blur();
j.setSelectionRange(m,g);
j.focus()
}else{if(j.createTextRange){var h=j.createTextRange();
h.collapse(true);
h.moveEnd("character",g-k.length);
h.moveStart("character",m);
h.select()
}}}},getNested:function(h,k){if(!k){return h
}var j=typeof k==="string"?k.split("."):k;
var g=h;
while(g&&j.length>0){g=g[j.shift()]
}return g
},isTrue:function(g){return g==="true"
}};
d("html").toggleClass("touch",CUI.util.isTouch)
}(jQuery,this));
(function(b,a,g){b.fn.loadWithSpinner=function(k,j,m){var h=b(this);
if(k&&(j||h.data("loaded-remote")!==k)){var l=setTimeout(function(){h.html('<div class="spinner large"></div>')
},50);
h.load(k,function(o,n,p){clearTimeout(l);
if(n==="error"){h.html('<div class="alert error"><strong>ERROR</strong> Failed to load content: '+p.statusText+" ("+p.status+")</div>");
h.data("loaded-remote","")
}if(typeof m==="function"){m.call(this,o,n,p)
}});
h.data("loaded-remote",k)
}};
b.fn.finger=function(){if(CUI.util.isTouch){this.on.apply(this,arguments)
}return this
};
b.fn.pointer=function(){if(!CUI.util.isTouch){this.on.apply(this,arguments)
}return this
};
b.fn.fipo=function(){var h=Array.prototype.slice.call(arguments,1,arguments.length);
this.pointer.apply(this,h);
h[0]=arguments[0];
this.finger.apply(this,h);
return this
};
function f(k,h){var m,l,j,n=k.nodeName.toLowerCase();
if("area"===n){m=k.parentNode;
l=m.name;
if(!k.href||!l||m.nodeName.toLowerCase()!=="map"){return false
}j=b("img[usemap=#"+l+"]")[0];
return !!j&&d(j)
}return(/input|select|textarea|button|object/.test(n)?!k.disabled:"a"===n?k.href||h:h)&&d(k)
}function d(h){return b.expr.filters.visible(h)&&!b(h).parents().addBack().filter(function(){return b.css(this,"visibility")==="hidden"
}).length
}b.extend(b.expr[":"],{data:b.expr.createPseudo(function(h){return function(j){return !!b.data(j,h)
}
}),focusable:function(h){return f(h,!isNaN(b.attr(h,"tabindex")))
},tabbable:function(k){var h=b.attr(k,"tabindex"),j=isNaN(h);
return(j||h>=0)&&f(k,!j)
}})
}(jQuery,this));
(function(g,f,j){var h="cui-state",b="cui-state-restore",a={},d=false,k=g(document);
CUI.util.state={config:{serverpersistence:true},save:function(l,q,p,n){var o=g(l),m=function(s,r){a.global[l]=a.global[l]||{};
a.global[l][r]=a.global[l][r]||{};
a.global[l][r].val=o.attr(r);
a.global[l][r].autorestore=p||false;
a.global[l][r].customEvent=n||null
};
if(q){if(g.isArray(q)){g.each(q,m)
}else{m(0,q)
}}else{}localStorage.setItem(h,JSON.stringify(a));
if(CUI.util.state.config.serverpersistence){g.cookie(h,JSON.stringify(a),{expires:7,path:"/"})
}},restore:function(l,o){var m=o||function(){return true
},q,p,r=function(t,s){q=t;
p=g(q);
if(a.global[q]){g.each(a.global[q],n)
}},n=function(s,t){if(m(q,s,t)){p.attr(s,t.val);
if(t.customEvent){k.trigger(t.customEvent,[p,t])
}k.trigger(b,[p,t])
}};
if(!d){d=CUI.util.state.load()
}if(l){r(l)
}else{g.each(a.global,r)
}},load:function(){var l=localStorage.getItem(h);
a=l?JSON.parse(l):{global:{}};
return true
},setSessionItem:function(l,o,n){var m=l;
if(n){m=l+":"+n
}sessionStorage.setItem(m,JSON.stringify(o))
},getSessionItem:function(l,n){var m=l;
if(n){m=l+":"+n
}var o=sessionStorage.getItem(m);
if(o){o=JSON.parse(o)
}return o
},removeSessionItem:function(l,n){var m=l;
if(n){m=l+":"+n
}sessionStorage.removeItem(m)
},clearSessionItems:function(p){if(p){p=":"+p;
var s=sessionStorage.length;
var o=[];
for(var m=0;
m<s;
m++){var t=sessionStorage.key(m);
var l=t.length;
if(l>p.length){if(t.substring(l-p.length)===p){o.push(t)
}}}var n=o.length;
for(var q=0;
q<n;
q++){sessionStorage.removeItem(o[q])
}}}};
k.ready(function(){CUI.util.state.restore(null,function(m,l,n){if(n.autorestore){return true
}return false
})
})
}(jQuery,this));
(function(b,a,d){CUI.util.color={hex:function(f){return("0"+parseInt(f,10).toString(16)).slice(-2)
},HexToRGB:function(f){f=parseInt(((f.indexOf("#")>-1)?f.substring(1):f),16);
return{r:f>>16,g:(f&65280)>>8,b:(f&255)}
},RGBAToHex:function(g){var f=g.substring(g.indexOf("(")+1,g.lastIndexOf(")")).split(/,\s*/);
return"#"+this.hex(f[0])+this.hex(f[1])+this.hex(f[2])
},RGBToHex:function(f){return"#"+this.hex(f.r)+this.hex(f.g)+this.hex(f.b)
},CMYKtoRGB:function(j){var g={r:0,g:0,b:0};
var n=parseInt(j.c,10)/100;
var f=parseInt(j.m,10)/100;
var l=parseInt(j.y,10)/100;
var h=parseInt(j.k,10)/100;
g.r=1-Math.min(1,n*(1-h)+h);
g.g=1-Math.min(1,f*(1-h)+h);
g.b=1-Math.min(1,l*(1-h)+h);
g.r=Math.round(g.r*255);
g.g=Math.round(g.g*255);
g.b=Math.round(g.b*255);
return g
},RGBtoCMYK:function(j){var h={c:0,m:0,y:0,k:0};
if(parseInt(j.r,10)===0&&parseInt(j.g,10)===0&&parseInt(j.b,10)===0){h.k=100;
return h
}var l=parseInt(j.r,10)/255;
var k=parseInt(j.g,10)/255;
var f=parseInt(j.b,10)/255;
h.k=Math.min(1-l,1-k,1-f);
h.c=(1-l-h.k)/(1-h.k);
h.m=(1-k-h.k)/(1-h.k);
h.y=(1-f-h.k)/(1-h.k);
h.c=Math.round(h.c*100);
h.m=Math.round(h.m*100);
h.y=Math.round(h.y*100);
h.k=Math.round(h.k*100);
return h
},fixHex:function(g){if(g.length===3){g=g.charAt(0)+g.charAt(0)+g.charAt(1)+g.charAt(1)+g.charAt(2)+g.charAt(2)
}if(g.indexOf("#")===-1){g="#"+g
}var f=/(^#[0-9A-F]{6})|(^#[0-9A-F]{3})$/i.test(g);
if(!f){this.$element.find("[name=':hex']").val("");
return""
}return g
},isSameColor:function(g,f){return g&&f&&(g===f)
},isValid:function(f,g){if(g.indexOf(f)!=-1){return this.fixHex(this.RGBAToHex(g))!==""
}return false
}}
}(jQuery,this));
CUI.util.HTTP={isOkStatus:function(a){try{return(String(a).indexOf("2")===0)
}catch(b){return false
}},html5UploadSupported:function(){var a=new XMLHttpRequest();
return !!(a&&("upload" in a)&&("onprogress" in a.upload))
}};
this["CUI"]=this["CUI"]||{};
this["CUI"]["Templates"]=this["CUI"]["Templates"]||{};
this["CUI"]["Templates"]["alert"]=Handlebars.template(function(j,k,f,b,g){this.compilerInfo=[4,">= 1.0.0"];
f=this.merge(f,j.helpers);
g=g||{};
var a="",d,h="function";
a+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details  \n\n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                    \n                                                                          \n-->\n<button class="close" data-dismiss="alert">&times;</button>\n<strong>';
if(d=f.heading){d=d.call(k,{hash:{},data:g})
}else{d=k.heading;
d=typeof d===h?d.apply(k):d
}if(d||d===0){a+=d
}a+="</strong><div>";
if(d=f.content){d=d.call(k,{hash:{},data:g})
}else{d=k.content;
d=typeof d===h?d.apply(k):d
}if(d||d===0){a+=d
}a+="</div>";
return a
});
this["CUI"]["Templates"]["badge"]=Handlebars.template(function(f,m,d,l,k){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,f.helpers);
k=k||{};
var h="",a,n=this,g="function",j=this.escapeExpression;
function b(p,o){return" empty"
}h+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n\n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<div class="badge';
a=d.unless.call(m,m.value,{hash:{},inverse:n.noop,fn:n.program(1,b,k),data:k});
if(a||a===0){h+=a
}h+='">';
if(a=d.value){a=a.call(m,{hash:{},data:k})
}else{a=m.value;
a=typeof a===g?a.apply(m):a
}h+=j(a)+"</div>";
return h
});
this["CUI"]["Templates"]["header"]=Handlebars.template(function(g,m,f,l,k){this.compilerInfo=[4,">= 1.0.0"];
f=this.merge(f,g.helpers);
l=this.merge(l,g.partials);
k=k||{};
var j="",b,h="function",o=this;
function d(s,r){var p="",q;
p+='<div class="logo">';
if(q=f.logo){q=q.call(s,{hash:{},data:r})
}else{q=s.logo;
q=typeof q===h?q.apply(s):q
}if(q||q===0){p+=q
}p+="</div>";
return p
}function a(r,q){var p;
p=o.invokePartial(l.header_navItem,"header_navItem",r,f,l,q);
if(p||p===0){return p
}else{return""
}}function n(s,r){var p="",q;
p+='<div class="drawer">';
q=o.invokePartial(l.header_drawer,"header_drawer",s.drawer,f,l,r);
if(q||q===0){p+=q
}p+="</div>";
return p
}j+="<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n";
b=f["if"].call(m,m.logo,{hash:{},inverse:o.noop,fn:o.program(1,d,k),data:k});
if(b||b===0){j+=b
}j+='\n<nav role="tablist">';
b=f.each.call(m,m.navItems,{hash:{},inverse:o.noop,fn:o.program(3,a,k),data:k});
if(b||b===0){j+=b
}j+="</nav>\n";
b=f["if"].call(m,m.drawer,{hash:{},inverse:o.noop,fn:o.program(5,n,k),data:k});
if(b||b===0){j+=b
}return j
});
this["CUI"]["Templates"]["header_drawer"]=Handlebars.template(function(f,k,d,j,h){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,f.helpers);
j=this.merge(j,f.partials);
h=h||{};
var g="",a,l=this;
function b(o,n){var m;
m=l.invokePartial(j.badge,"badge",o.badge,d,j,n);
if(m||m===0){return m
}else{return""
}}g+="<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n";
a=d["if"].call(k,k.badge,{hash:{},inverse:l.noop,fn:l.program(1,b,h),data:h});
if(a||a===0){g+=a
}return g
});
this["CUI"]["Templates"]["header_navItem"]=Handlebars.template(function(g,n,f,m,l){this.compilerInfo=[4,">= 1.0.0"];
f=this.merge(f,g.helpers);
l=l||{};
var j="",b,h="function",k=this.escapeExpression,q=this;
function d(u,t){var r="",s;
r+=' id="';
if(s=f.id){s=s.call(u,{hash:{},data:t})
}else{s=u.id;
s=typeof s===h?s.apply(u):s
}r+=k(s)+'"';
return r
}function a(u,t){var r="",s;
r+=' aria-owns="';
if(s=f.owns){s=s.call(u,{hash:{},data:t})
}else{s=u.owns;
s=typeof s===h?s.apply(u):s
}r+=k(s)+'"';
return r
}function p(s,r){return'aria-selected="true" class="selected"'
}function o(s,r){return'aria-selected="false"'
}j+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<a href="';
if(b=f.url){b=b.call(n,{hash:{},data:l})
}else{b=n.url;
b=typeof b===h?b.apply(n):b
}j+=k(b)+'" role="tab"';
b=f["if"].call(n,n.id,{hash:{},inverse:q.noop,fn:q.program(1,d,l),data:l});
if(b||b===0){j+=b
}b=f["if"].call(n,n.owns,{hash:{},inverse:q.noop,fn:q.program(3,a,l),data:l});
if(b||b===0){j+=b
}j+=" ";
b=f["if"].call(n,n.selected,{hash:{},inverse:q.program(7,o,l),fn:q.program(5,p,l),data:l});
if(b||b===0){j+=b
}j+='">';
if(b=f.label){b=b.call(n,{hash:{},data:l})
}else{b=n.label;
b=typeof b===h?b.apply(n):b
}j+=k(b)+"</a>";
return j
});
this["CUI"]["Templates"]["modal"]=Handlebars.template(function(j,k,f,b,g){this.compilerInfo=[4,">= 1.0.0"];
f=this.merge(f,j.helpers);
g=g||{};
var a="",d,h="function";
a+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<div class="modal-header">\n  <h2>';
if(d=f.heading){d=d.call(k,{hash:{},data:g})
}else{d=k.heading;
d=typeof d===h?d.apply(k):d
}if(d||d===0){a+=d
}a+='</h2>\n  <button type="button" class="close" data-dismiss="modal">&times;</button>\n</div>\n<div class="modal-body">';
if(d=f.content){d=d.call(k,{hash:{},data:g})
}else{d=k.content;
d=typeof d===h?d.apply(k):d
}if(d||d===0){a+=d
}a+='</div>\n<div class="modal-footer">';
if(d=f.buttons){d=d.call(k,{hash:{},data:g})
}else{d=k.buttons;
d=typeof d===h?d.apply(k):d
}if(d||d===0){a+=d
}a+="</div>";
return a
});
this["CUI"]["Templates"]["tabs"]=Handlebars.template(function(g,l,f,k,j){this.compilerInfo=[4,">= 1.0.0"];
f=this.merge(f,g.helpers);
k=this.merge(k,g.partials);
j=j||{};
var h="",b,m=this;
function d(q,p){var n="",o;
n+="\n    ";
o=m.invokePartial(k.tabs_tab,"tabs_tab",q,f,k,p);
if(o||o===0){n+=o
}n+="\n  ";
return n
}function a(q,p){var n="",o;
n+="\n";
o=m.invokePartial(k.tabs_panel,"tabs_panel",q,f,k,p);
if(o||o===0){n+=o
}n+="\n";
return n
}h+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<nav role="tablist">\n  ';
b=f.each.call(l,l.tabs,{hash:{},inverse:m.noop,fn:m.program(1,d,j),data:j});
if(b||b===0){h+=b
}h+="\n</nav>\n";
b=f.each.call(l,l.tabs,{hash:{},inverse:m.noop,fn:m.program(3,a,j),data:j});
if(b||b===0){h+=b
}return h
});
this["CUI"]["Templates"]["tabs_panel"]=Handlebars.template(function(g,n,f,m,l){this.compilerInfo=[4,">= 1.0.0"];
f=this.merge(f,g.helpers);
l=l||{};
var j="",b,h="function",k=this.escapeExpression,p=this;
function d(t,s){var q="",r;
q+='id="';
if(r=f.id){r=r.call(t,{hash:{},data:s})
}else{r=t.id;
r=typeof r===h?r.apply(t):r
}q+=k(r)+'" aria-labelledby="';
if(r=f.id){r=r.call(t,{hash:{},data:s})
}else{r=t.id;
r=typeof r===h?r.apply(t):r
}q+=k(r)+'"';
return q
}function a(r,q){return'class="active"'
}function o(r,q){return'aria-disabled="true"'
}j+="<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<section ";
b=f["if"].call(n,n.id,{hash:{},inverse:p.noop,fn:p.program(1,d,l),data:l});
if(b||b===0){j+=b
}j+=' role="tabpanel" ';
b=f["if"].call(n,n.active,{hash:{},inverse:p.noop,fn:p.program(3,a,l),data:l});
if(b||b===0){j+=b
}j+=" ";
b=f["if"].call(n,n.disabled,{hash:{},inverse:p.noop,fn:p.program(5,o,l),data:l});
if(b||b===0){j+=b
}j+=">";
if(b=f.content){b=b.call(n,{hash:{},data:l})
}else{b=n.content;
b=typeof b===h?b.apply(n):b
}j+=k(b)+"</section>";
return j
});
this["CUI"]["Templates"]["tabs_tab"]=Handlebars.template(function(f,r,p,k,u){this.compilerInfo=[4,">= 1.0.0"];
p=this.merge(p,f.helpers);
u=u||{};
var q="",g,b="function",a=this.escapeExpression,o=this;
function n(z,w){var v;
if(v=p.remote){v=v.call(z,{hash:{},data:w})
}else{v=z.remote;
v=typeof v===b?v.apply(z):v
}return a(v)
}function m(A,z){var v="",w;
v+="#";
w=p["if"].call(A,A.id,{hash:{},inverse:o.noop,fn:o.program(4,l,z),data:z});
if(w||w===0){v+=w
}return v
}function l(z,w){var v;
if(v=p.id){v=v.call(z,{hash:{},data:w})
}else{v=z.id;
v=typeof v===b?v.apply(z):v
}return a(v)
}function j(z,w){var v;
v=p["if"].call(z,z.remote,{hash:{},inverse:o.noop,fn:o.program(7,h,w),data:w});
if(v||v===0){return v
}else{return""
}}function h(A,z){var v="",w;
v+='data-target="#';
if(w=p.id){w=w.call(A,{hash:{},data:z})
}else{w=A.id;
w=typeof w===b?w.apply(A):w
}v+=a(w)+'"';
return v
}function d(w,v){return'class="active" aria-selected="true"'
}function t(w,v){return'aria-selected="false"'
}function s(w,v){return'class="disabled" aria-disabled="true"'
}q+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<a href="';
g=p["if"].call(r,r.remote,{hash:{},inverse:o.program(3,m,u),fn:o.program(1,n,u),data:u});
if(g||g===0){q+=g
}q+='" ';
g=p["if"].call(r,r.id,{hash:{},inverse:o.noop,fn:o.program(6,j,u),data:u});
if(g||g===0){q+=g
}q+=' data-toggle="tab" role="tab" ';
g=p["if"].call(r,r.active,{hash:{},inverse:o.program(11,t,u),fn:o.program(9,d,u),data:u});
if(g||g===0){q+=g
}q+=" ";
g=p["if"].call(r,r.disabled,{hash:{},inverse:o.noop,fn:o.program(13,s,u),data:u});
if(g||g===0){q+=g
}q+=">";
if(g=p.label){g=g.call(r,{hash:{},data:u})
}else{g=r.label;
g=typeof g===b?g.apply(r):g
}q+=a(g)+"</a>";
return q
});
this["CUI"]["Templates"]["toolbar"]=Handlebars.template(function(d,l,b,k,j){this.compilerInfo=[4,">= 1.0.0"];
b=this.merge(b,d.helpers);
j=j||{};
var g="",a,f="function",h=this.escapeExpression;
g+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<nav class="toolbar">\n  <div class="left">\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(l,{hash:{},data:j})
}else{a=l.actionName;
a=typeof a===f?a.apply(l):a
}g+=h(a)+">";
if(a=b.actionTitle){a=a.call(l,{hash:{},data:j})
}else{a=l.actionTitle;
a=typeof a===f?a.apply(l):a
}g+=h(a)+'</a>\n    <span class="divider"></span>\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(l,{hash:{},data:j})
}else{a=l.actionName;
a=typeof a===f?a.apply(l):a
}g+=h(a)+">";
if(a=b.actionTitle){a=a.call(l,{hash:{},data:j})
}else{a=l.actionTitle;
a=typeof a===f?a.apply(l):a
}g+=h(a)+'</a>\n  </div>\n  <div class="center">\n    <h1>';
if(a=b.heading){a=a.call(l,{hash:{},data:j})
}else{a=l.heading;
a=typeof a===f?a.apply(l):a
}g+=h(a)+'</h1>\n  </div>\n  <div class="right">\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(l,{hash:{},data:j})
}else{a=l.actionName;
a=typeof a===f?a.apply(l):a
}g+=h(a)+">";
if(a=b.actionTitle){a=a.call(l,{hash:{},data:j})
}else{a=l.actionTitle;
a=typeof a===f?a.apply(l):a
}g+=h(a)+'</a>\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(l,{hash:{},data:j})
}else{a=l.actionName;
a=typeof a===f?a.apply(l):a
}g+=h(a)+">";
if(a=b.actionTitle){a=a.call(l,{hash:{},data:j})
}else{a=l.actionTitle;
a=typeof a===f?a.apply(l):a
}g+=h(a)+"</a>\n  </div>\n</nav>";
return g
});
(function(b,a,d){CUI.Widget=new Class({toString:"Widget",construct:function(f){this.options=b.extend({},typeof this.defaults==="object"&&this.defaults,f);
this.$element=b(f.element);
this.$element.data(CUI.util.decapitalize(this.toString()),this);
this.bind(this.hide);
this.bind(this.show);
this.bind(this.toggleVisibility);
this.on("change:visible",function(g){this[g.value?"_show":"_hide"]()
}.bind(this))
},set:function(f,h){if(b.isPlainObject(f)){for(var g in f){this._set(g,f[g])
}}else{this._set(f,h)
}return this
},_set:function(f,g){var h=b.Event("beforeChange:"+f,{widget:this,option:f,currentValue:this.options[f],value:g});
this.$element.trigger(h);
if(h.isDefaultPrevented()){return this
}this.options[f]=g;
h=b.Event("change:"+f,{widget:this,option:f,value:g});
this.$element.trigger(h)
},get:function(f){return this.options[f]
},on:function(g,f){this.$element.on.apply(this.$element,arguments);
return this
},off:function(g,f){this.$element.off.apply(this.$element,arguments);
return this
},show:function(f){f=f||{};
if(this.options.visible){return this
}if(!f.silent){var g=b.Event("show");
this.$element.trigger(g);
if(g.isDefaultPrevented()){return this
}}this.options.visible=true;
this._show(f);
return this
},_show:function(f){this.$element.show()
},hide:function(f){f=f||{};
if(!this.options.visible){return this
}if(!f.silent){var g=b.Event("hide");
this.$element.trigger(g);
if(g.isDefaultPrevented()){return this
}}this.options.visible=false;
this._hide(f);
return this
},_hide:function(f){this.$element.hide()
},toggleVisibility:function(){return this[!this.options.visible?"show":"hide"]()
},setName:function(f){this.toString=function(){return f
};
return this
}});
CUI.Widget.fromElement=function(g,f){return f.data(CUI.util.decapitalize(g.toString()))
};
CUI.Widget.registry={register:function(f,g){CUI.util.plugClass(g);
this._widgets[f]=g;
g.init=function(h){this._init(g,h)
}.bind(this)
},resolve:function(f){return this._widgets[f]
},init:function(f,g){this._init(this.resolve(f),g)
},getSelectors:function(){var g=[];
for(var f in this._widgets){g.push(f)
}return g
},_widgets:{},_init:function(g,f){if(g!==d){if(CUI.Widget.fromElement(g,f)===d){f[CUI.util.decapitalize(g.toString())]()
}}}}
}(jQuery,this));
(function(b,a,d){CUI.Modal=new Class({toString:"Modal",extend:CUI.Widget,construct:function(f){if(this.$element.children().length===0){this.$element.html(CUI.Templates.modal(b.extend({},this.options,{buttons:""})))
}this.$element.addClass("modal");
this.header=this.$element.find(".modal-header");
this.body=this.$element.find(".modal-body");
this.footer=this.$element.find(".modal-footer");
this._previousFocus=b();
this.backdrop=b("<div/>",{"class":"modal-backdrop",style:"display: none;"}).fipo("tap","click",function(g){if(this.options.backdrop!=="static"){this.hide()
}}.bind(this));
this.body.loadWithSpinner(this.options.remote);
this.applyOptions();
this.$element.on("change:heading",this._setHeading.bind(this)).on("change:header",this._setHeader.bind(this)).on("change:content",this._setContent.bind(this)).on("change:buttons",this._setFooter.bind(this)).on("change:type",this._setType.bind(this)).on("change:fullscreen",this._setFullscreen.bind(this)).fipo("tap","click",'[data-dismiss="modal"]',this.hide.bind(this));
this._makeAccessible()
},defaults:{backdrop:"static",visible:true,type:"default",fullscreen:false,attachToBody:true},_types:["default","error","notice","success","help","info"],applyOptions:function(){this._setHeader();
this._setHeading();
this._setContent();
this._setFooter();
this._setType();
this._setFullscreen();
if(this.options.visible){this.options.visible=false;
this.show()
}},_makeAccessible:function(){var f=this,g="modal-header"+new Date().getTime()+"-";
this.$element.attr({role:"dialog","aria-hidden":!this.options.visible,"aria-labelledby":g+"label","aria-describedby":g+"message",tabindex:-1});
this.header.find("h2").attr({id:g+"label",tabindex:0});
this.body.attr({id:g+"message",role:"document",tabindex:0});
this.$element.on("keydown",":focusable",function(k){var j=b(k.currentTarget),h=f.$element.find(":tabbable"),l;
switch(k.which){case 9:if(k.shiftKey&&k.currentTarget===h[0]){l=h.last()
}else{if(!k.shiftKey&&k.currentTarget===h[h.length-1]){l=h.first()
}}break
}if(l){k.preventDefault();
l.trigger("focus")
}})
},_setType:function(){if(!this.options.type){return
}this.$element.removeClass(this._types.join(" "));
if(this.options.type!=="default"){this.$element.addClass(this.options.type)
}},_setHeader:function(){if(!this.options.header){return
}this.header.find("h2").html(this.options.header)
},_setHeading:function(){if(!this.options.heading){return
}this.options.header=this.options.heading;
this._setHeader.apply(this,arguments)
},_setContent:function(){if(!this.options.content){return
}this.body.html(this.options.content)
},_setFooter:function(){if(!b.isArray(this.options.buttons)){return
}var f=this;
this.footer.empty();
b.each(this.options.buttons,function(g,j){var h=j.href?b("<a/>",{"class":"button"}):b("<button/>",{type:"button"});
h.html(j.label);
if(j.click==="hide"){h.attr("data-dismiss","modal")
}else{if(b.isFunction(j.click)){h.fipo("tap","click",j.click.bind(f,{dialog:f}))
}}if(j.href){h.attr("href",j.href)
}if(j.className){h.addClass(j.className)
}f.footer.append(h)
})
},_setFullscreen:function(){if(this.options.fullscreen){this.$element.addClass("fullscreen")
}else{this.$element.removeClass("fullscreen")
}},_show:function(){var f=b("body"),h,g=this;
this._previousFocus=b(":focus");
this._previousFocus.trigger("blur");
f.addClass("modal-open");
this.center();
this.$element.trigger("beforeshow");
this._toggleBackdrop(true);
if(this.options.attachToBody){if(this.$element.parent("body").length===0){this.$element.appendTo(f)
}this.$element.siblings("[aria-hidden]").each(function(j,k){b(k).data("aria-hidden",b(k).attr("aria-hidden"))
});
this.$element.siblings().not("script, link, style").attr("aria-hidden",this.options.visible)
}this.$element.attr("aria-hidden",!this.options.visible);
this.$element.fadeIn();
this.$element.find(":tabbable:not(.modal-header .close):first").focus();
h=b('<div class="cui-modal-tabcapture" tabindex="0"/>');
h.on("focus.modal-tabcapture",function(m){var l=g.$element.find(":tabbable"),k=b("body > .cui-modal-tabcapture"),j=k.last(),n;
if(m.currentTarget===j[0]){n=l.filter(":not(.modal-header .close):last")
}else{n=l.filter(":not(.modal-header .close):first")
}if(n.length===0){n=g.$element
}n.trigger("focus")
}).prependTo(f).clone(true).appendTo(f);
b(document).on("keydown.modal-escape",this._escapeKeyHandler.bind(this));
return this
},_hide:function(){b("body").removeClass("modal-open").find(".cui-modal-tabcapture").off("focus.modal-tabcapture").remove();
b(document).off("keydown.modal-escape");
this.$element.trigger("beforehide");
this._toggleBackdrop(false);
this.$element.attr("aria-hidden",!this.options.visible);
this.$element.siblings().removeAttr("aria-hidden").filter(':data("aria-hidden")').each(function(f,g){b(g).attr("aria-hidden",b(g).data("aria-hidden")).removeData("aria-hidden")
});
this.$element.fadeOut().trigger("blur");
this._previousFocus.trigger("focus");
return this
},center:function(){var g=this.$element.outerWidth(),f=this.$element.outerHeight();
this.$element.css({"margin-left":-(g/2),"margin-top":-(f/2)})
},_toggleBackdrop:function(g){if(!this.options.backdrop){return
}var f=b("body");
if((g||this.backdrop.is(":hidden"))&&g!==false){this.backdrop.appendTo(f).fadeIn()
}else{this.backdrop.fadeOut(function(){b(this).detach()
})
}},_escapeKeyHandler:function(f){if(f.which===27){this.hide()
}}});
CUI.Widget.registry.register("modal",CUI.Modal);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){CUI.Modal.init(b("[data-init~=modal]",f.target))
});
b(document).fipo("tap.modal.data-api","click.modal.data-api",'[data-toggle="modal"]',function(m){var h=b(this);
var g=CUI.util.getDataTarget(h);
var k=h.attr("href");
var l=b.extend({remote:!/#/.test(k)&&k},g.data(),h.data());
if(typeof l.buttons==="string"){l.buttons=JSON.parse(l.buttons)
}var f=g.data("modal");
var j=true;
if(f&&f.get("visible")){j=false
}g.modal(l);
if(f){g.data("modal").set({visible:j})
}m.preventDefault()
}).finger("click.modal.data-api",'[data-toggle="modal"]',false)
}}(jQuery,this));
(function(b,a,d){CUI.Tabs=new Class({toString:"Tabs",extend:CUI.Widget,construct:function(f){this.tablist=this.$element.find("> nav");
this._applyOptions();
this.$element.on("change:type",this._setType.bind(this));
this.$element.on("change:active",this._setActive.bind(this))
},defaults:{},DEFAULT_VARIANT_KEY:"default",WHITE_VARIANT_CLASS:"white",STACKED_VARIANT_CLASS:"stacked",NAV_VARIANT_CLASS:"nav",VARIANT_TYPES:["default","white","stacked","nav"],setDisabled:function(g,h){var f=h||false;
g.toggleClass("disabled",f).prop("aria-disabled",f);
return this
},setEnabled:function(f){return this.setDisabled(f,true)
},addItem:function(g){var h=this._getTabs();
g=b.extend({tabContent:"",panelContent:"",panelID:d,panelURL:d,index:h.length,enabled:true,active:true},g);
var k=b("<section/>").append(g.panelContent);
if(g.panelID!==d){k.attr("id",g.panelID)
}var j=b('<a data-toggle="tab"/>').append(g.tabContent);
if(g.panelURL!==d){j.attr("href",g.panelURL)
}var f=Math.min(Math.max(g.index,0),h.length);
if(f===0){this.tablist.prepend(j);
this.tablist.after(k)
}else{h.eq(f-1).after(j);
this._getPanels().eq(f-1).after(k)
}if(!g.enabled){j.addClass("disabled")
}this._makeTabsAccessible(j);
if(g.active&&g.enabled){this._activateTab(j,true)
}return k.attr("id")
},removeItem:function(m){var f=this._getTabs(),j=this._getPanels(),k,l;
if(typeof m==="number"){k=f.eq(m);
l=j.eq(m)
}else{if(typeof m==="string"){k=f.filter('[aria-controls="'+m+'"]');
l=j.filter("#"+m)
}}if(!k||!l){return
}if(k.hasClass("active")){var h='a[data-toggle="tab"]:not(.disabled)';
var g=k.nextAll(h).first();
if(g.length===0){g=k.prevAll(h).first()
}if(g.length===1){this._activateTab(g,true)
}}l.remove();
k.remove()
},_applyOptions:function(){var f=this._getTabs().filter(".active");
if(this.options.type){this._setType(this.options.type)
}this._initTabswitch();
this._makeAccessible();
if(f.length===0){this._setActive(this.options.active||0)
}else{this._activateTab(f,true)
}},_getTabs:function(){return this.tablist.find('> a[data-toggle="tab"]')
},_getPanels:function(){return this.$element.find("> section")
},_setActive:function(g){g=b.isNumeric(g)?g:this.options.active;
var f=this._getTabs().eq(g);
this._activateTab(f,true)
},_setType:function(f){var g=b.type(f)==="string"?f:this.options.type;
if(this.VARIANT_TYPES.indexOf(g)>-1||g===this.DEFAULT_VARIANT_KEY){this.$element.removeClass(this.VARIANT_TYPES.join(" "));
if(g!==this.DEFAULT_VARIANT_KEY){this.$element.addClass(g)
}}},_activateTab:function(l,m){var g=l.attr("href"),k="active",j=this._getTabs(),h=this._getPanels(),f;
if(l.hasClass("disabled")){l.blur();
return false
}f=h.filter("#"+l.attr("aria-controls"));
if(g&&g.charAt(0)!=="#"){f.loadWithSpinner(g)
}j.removeClass(k).attr({"aria-selected":false,tabindex:-1});
h.removeClass(k).attr({"aria-hidden":true});
l.addClass(k).attr({"aria-selected":true,tabindex:0});
f.addClass(k).attr({"aria-hidden":false});
if(!m){l.trigger("focus")
}},_initTabswitch:function(){var f=this,g='> nav > a[data-toggle="tab"]';
this.$element.fipo("tap","click",g,function(j){var h=b(j.currentTarget);
j.preventDefault();
f._activateTab(h)
}).finger("click",g,false)
},_makeAccessible:function(){this._makeTabsAccessible();
this._makeTablistAccessible()
},_makeTabsAccessible:function(f){var g=this._getPanels();
f=f||this._getTabs();
f.each(function(j,l){var k=b(l),m=g.eq(k.index()),n=m.attr("id")||CUI.util.getNextId();
var h={role:"tab",tabindex:-1,"aria-selected":false,"aria-controls":n,"aria-disabled":k.hasClass("disabled")};
if(!k.attr("href")){h.href="#"
}k.attr(h);
m.attr({id:n,role:"tabpanel","aria-hidden":true})
})
},_makeTablistAccessible:function(){var f=this,g='> [role="tab"]';
this.tablist.attr("role","tablist");
this.tablist.on("keydown",g,function(l){var k=b(l.currentTarget),j=b(l.delegateTarget).find(g).not('[aria-disabled="true"]'),n=k,m=true,h=j.index(k);
switch(l.which){case 33:case 37:case 38:n=h-1>-1?j[h-1]:j[j.length-1];
break;
case 34:case 39:case 40:n=h+1<j.length?j[h+1]:j[0];
break;
case 36:n=j[0];
break;
case 35:n=j[j.length-1];
break;
default:m=false;
break
}if(m){l.preventDefault();
f._activateTab(b(n))
}})
}});
CUI.Widget.registry.register("tabs",CUI.Tabs);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){CUI.Tabs.init(b("[data-init~=tabs]",f.target))
})
}}(jQuery,this));
(function(a){CUI.Alert=new Class({toString:"Alert",extend:CUI.Widget,construct:function(b){this.$element.delegate('[data-dismiss="alert"]',"click.dismiss.alert",this.hide);
this.$element.addClass("alert");
this.$element.on("change:heading",this._setHeading.bind(this));
this.$element.on("change:content",this._setContent.bind(this));
this.$element.on("change:type",this._setType.bind(this));
this.$element.on("change:closable",this._setClosable.bind(this));
this.$element.on("change:size",this._setSize.bind(this));
a.each(this._types,function(d,f){if(this.$element.hasClass(f)){this.options.type=f;
return false
}}.bind(this));
a.each(this._sizes,function(d,f){if(this.$element.hasClass(f)){this.options.size=f;
return false
}}.bind(this));
if(this.$element.children().length===0){this.options.type=this._fixType(this.options.type);
this.options.heading=this._fixHeading(this.options.heading);
this.$element.html(CUI.Templates.alert(this.options));
this._setClosable();
this._setType();
this._setSize()
}this._setHeading();
this._setContent()
},defaults:{type:"error",size:"small",heading:undefined,visible:true,closable:true},_types:["error","notice","success","help","info"],_sizes:["small","large"],_setContent:function(){if(typeof this.options.content==="string"){this.$element.find("div").html(this.options.content)
}},_setHeading:function(){if(typeof this.options.content==="string"){this.$element.find("strong").html(this.options.heading)
}},_setType:function(){if(this._isValidType(this.options.type)){this.$element.removeClass(this._types.join(" "));
this.$element.addClass(this.options.type)
}},_setSize:function(){if(this._isValidSize(this.options.size)){if(this.options.size==="small"){this.$element.removeClass("large")
}else{this.$element.addClass("large")
}}},_setClosable:function(){var b=this.$element.find(".close");
if(!b.length){this.$element.prepend('<button class="close" data-dismiss="alert">&times;</button>')
}else{b[this.options.closable?"show":"hide"]()
}},_isValidType:function(b){return typeof b=="string"&&this._types.indexOf(b)>-1
},_isValidSize:function(b){return typeof b=="string"&&this._sizes.indexOf(b)>-1
},_fixType:function(b){return this._isValidType(b)?b:this.defaults.type
},_fixHeading:function(b){return b===undefined?this._fixType(this.options.type).toUpperCase():b
}});
CUI.util.plugClass(CUI.Alert);
if(CUI.options.dataAPI){a(function(){a("body").fipo("tap.alert.data-api","click.alert.data-api",'[data-dismiss="alert"]',function(b){a(b.target).parent().hide();
b.preventDefault()
})
})
}}(window.jQuery));
(function(b,a,d){CUI.Rail=new Class({toString:"Rail",extend:CUI.Widget,construct:function(f){if(!this.$element.hasClass("theme-dark")){this.$element.addClass("theme-dark")
}this.applyOptions()
},applyOptions:function(){this._initFoldable();
if(this.$element.find(".rail-switch").length>0){this._initRailSwitcher()
}this._makeAccessible()
},_show:function(){this.$element.removeClass("closed")
},_hide:function(){this.$element.addClass("closed")
},_initFoldable:function(){var g="open",f="rail-section-foldable-";
this.$element.find("section.foldable").each(function(l,o){var n=b(o),k=n.find(".heading"),h=n.find(".fold"),m=f+(k.attr("href")||(" "+new Date().getTime()+"-"+l)).substring(1),j=n.hasClass(g);
n.attr("role","presentation");
k.attr({role:"button",id:k.attr("id")||m,"aria-controls":h.attr("id")||m+"-fold",tabindex:0,"aria-expanded":j});
h.attr({id:h.attr("id")||m+"-fold","aria-labelledby":k.attr("id"),"aria-hidden":!j,"aria-expanded":j})
});
this.$element.fipo("tap","click","section.foldable .heading",function(l){var k=b(l.currentTarget),m=k.parents(".foldable:first"),h=m.find(".fold"),j=m.toggleClass(g).hasClass(g);
k.attr({"aria-expanded":j});
h.attr({"aria-hidden":!j,"aria-expanded":j});
if(j&&l.type==="tap"){h.attr("tabindex","-1").trigger("focus");
k.trigger("focus");
h.removeAttr("tabindex")
}}).on("keydown","section.foldable .heading:not(button):not(a[href])",function(j){var h=b(j.currentTarget);
switch(j.which){case 13:case 32:h.trigger("click");
break
}})
},_initRailSwitcher:function(){var j="active",g="focus",k="rail-switcher-view-",h=this.$element.find(".rail-switch a"),f=this.$element.find(".rail-view");
h.filter('[href="#"]').each(function(m,o){var n=b(this),p=n.data("view"),l=f.filter('[data-view="'+p+'"]');
n.attr("href","#"+k+p);
l.attr("id",k+p)
});
this.$element.find(".rail-switch nav").attr({role:"tablist"});
h.attr({role:"tab","aria-selected":function(){return b(this).hasClass(j)
},tabindex:function(){return b(this).hasClass(j)?0:-1
},"aria-controls":function(){return b(this).attr("href").substring(1)
}});
f.attr({role:"tabpanel","aria-hidden":function(){return !b(this).hasClass(j)
},"aria-expanded":function(){return b(this).hasClass(j)
},"aria-labelledby":function(){return b(this).attr("id")
}});
this.$element.fipo("tap","click",".rail-switch a",function(n){var l=b(n.currentTarget),o=l.attr("href").substring(1),m=f.filter("#"+o);
n.preventDefault();
f.removeClass(j).attr({"aria-hidden":true,"aria-expanded":false});
h.removeClass(j).attr({"aria-selected":false,tabindex:-1});
l.addClass(j).attr({"aria-selected":true,tabindex:0});
m.addClass(j).attr({"aria-hidden":false,"aria-expanded":true})
});
this.$element.pointer("blur",".rail-switch a",function(l){b(l.currentTarget).removeClass(g)
})
},_makeAccessible:function(){var g="focus";
this.$element.attr("role","complementary");
var f=this.$element.find('[role="tablist"]'),h='[role="tab"]';
f.on("keydown",h,function(m){var l=b(m.currentTarget),k=b(m.delegateTarget).find(h),o=l,n=true,j=k.index(l);
switch(m.which){case 33:case 37:case 38:o=j-1>-1?k[j-1]:k[0];
break;
case 34:case 39:case 40:o=j+1<k.length?k[j+1]:k[k.length-1];
break;
case 36:o=k[0];
break;
case 35:o=k[k.length-1];
break;
default:n=false;
break
}if(n){m.preventDefault();
b(o).addClass(g).trigger("focus").trigger("click")
}})
}});
CUI.Widget.registry.register("rail",CUI.Rail);
if(CUI.options.dataAPI){b(function(){CUI.Rail.init(b("[data-init~=rail]"))
})
}}(jQuery,this));
(function(b){var a=0;
CUI.Popover=new Class({toString:"Popover",extend:CUI.Widget,construct:function(d){this.$element.addClass("popover");
this.$element.on("change:content",this._setContent.bind(this));
this.$element.on("change:pointAt",this._position.bind(this));
this.$element.on("change:pointFrom",this._position.bind(this));
this.$element.on("change:alignFrom",this._position.bind(this));
if(this.$element.html()===""){this._setContent()
}this._createTail();
this.uuid=(a+=1)
},defaults:{pointFrom:"bottom",preventAutoHide:false,alignFrom:"left",visible:false},_directions:["top","bottom","right","left"],_createTail:function(){this._$tail=b('<div class="popover-arrow arrow-left"/>').appendTo(this.$element);
this._cachedTailDimensions={};
this._cachedTailDimensions.leftRight={width:this._$tail.outerWidth(),height:this._$tail.outerHeight()};
this._cachedTailDimensions.topBottom={width:this._cachedTailDimensions.leftRight.height,height:this._cachedTailDimensions.leftRight.width};
this._$tail.removeClass("arrow-left")
},_position:function(){if(!this.options.visible||!this.options.pointAt){return
}var h=this.$element,k=this.options.pointAt,f=this.options.pointFrom,g=this._cachedTailDimensions,d;
if(b.isArray(k)){if(k.length!==2){return
}k=this._convertCoordsToEvent(k)
}var j=function(m,n){var o=h.offsetParent().offset(),l;
if((f=="top"||f=="bottom")&&o.top+m.top<0){l="bottom"
}else{if((f=="left"||f=="right")&&o.left+m.left<0){l="right"
}}if(l){d=this._instructionFactory[l]({target:k,tailDimensions:g,allowFlip:false,callback:this._applyFinalPosition.bind(this)});
h.position(d)
}else{this._applyFinalPosition(m,n)
}}.bind(this);
d=this._instructionFactory[f]({target:k,tailDimensions:g,allowFlip:true,callback:j});
h.position(d)
},_convertCoordsToEvent:function(d){var f=b.Event();
f.pageX=d[0];
f.pageY=d[1];
return f
},_applyFinalPosition:function(d,f){var g={top:d.top};
if(this.options.alignFrom==="right"){var j=this.$element.offsetParent();
var h;
if(j.prop("tagName").toLowerCase()=="html"){j=b("body");
h=j.outerWidth(true)
}else{h=j.innerWidth()
}g.left="auto";
g.right=h-d.left-this.$element.outerWidth(true)
}else{g.left=d.left;
g.right="auto"
}this.$element.css(g);
this._positionTail(f)
},_instructionFactory:{top:function(d){return{my:"center bottom-"+d.tailDimensions.topBottom.height,at:"center top",of:d.target,collision:"fit "+(d.allowFlip?"flip":"none"),using:d.callback}
},right:function(d){return{my:"left+"+d.tailDimensions.leftRight.width+" center",at:"right center",of:d.target,collision:(d.allowFlip?"flip":"none")+" fit",using:d.callback}
},bottom:function(d){return{my:"center top+"+d.tailDimensions.topBottom.height,at:"center bottom",of:d.target,collision:"fit "+(d.allowFlip?"flip":"none"),using:d.callback}
},left:function(d){return{my:"right-"+d.tailDimensions.leftRight.width+" center",at:"left center",of:d.target,collision:(d.allowFlip?"flip":"none")+" fit",using:d.callback}
}},_positionTail:function(m){var g,j=this.$element.offset();
if(b.isArray(this.options.pointAt)){g={top:this.options.pointAt[1],left:this.options.pointAt[0],width:0,height:0}
}else{var h=b(m.target.element).offset();
g={top:h.top,left:h.left,width:m.target.width,height:m.target.height}
}g.top-=(j.top+parseFloat(this.$element.css("borderTopWidth")));
g.left-=(j.left+parseFloat(this.$element.css("borderLeftWidth")));
var l,k,d,f;
switch(this.options.pointFrom){case"top":case"bottom":f=this._cachedTailDimensions.topBottom.width;
k=g.left+g.width/2-f/2;
if(m.vertical=="bottom"){l="arrow-down";
d=g.top-this._cachedTailDimensions.topBottom.height
}else{l="arrow-up";
d=g.top+g.height
}break;
case"left":case"right":f=this._cachedTailDimensions.leftRight.width;
d=g.top+g.height/2-this._cachedTailDimensions.leftRight.height/2;
if(m.horizontal=="left"){l="arrow-left";
k=g.left+g.width
}else{l="arrow-right";
k=g.left-f
}break
}this._$tail.css({top:d,left:k}).removeClass("arrow-up arrow-down arrow-left arrow-right").addClass(l)
},_show:function(){this.$element.show().prop("aria-hidden",false);
this._position();
if(!this.options.preventAutoHide){b("body").fipo("tap.popover-hide-"+this.uuid,"click.popover-hide-"+this.uuid,function(f){var d=this.$element.get(0);
if(f.target!==d&&!b.contains(d,f.target)){this.hide();
b("body").off(".popover-hide-"+this.uuid)
}}.bind(this))
}},_hide:function(){this.$element.hide().prop("aria-hidden",true);
b("body").off(".popover-hide-"+this.uuid)
},_setContent:function(){if(typeof this.options.content!=="string"){return
}this.$element.html(this.options.content);
if(this._$tail){this.$element.append(this._$tail)
}this._position()
},setPosition:function(d){this.set("pointAt",d)
}});
CUI.Widget.registry.register("popover",CUI.Popover);
b(function(){b("body").fipo("tap.popover.data-api","click.popover.data-api",'[data-toggle="popover"]',function(h){var f=b(this),d=CUI.util.getDataTarget(f);
d=d&&d.length>0?d:f.next(".popover");
var g=d.popover(b.extend({pointAt:f},d.data(),f.data())).data("popover");
g.toggleVisibility()
}).on("click.popover.data-api",'[data-toggle="popover"]',false)
})
}(window.jQuery));
(function(a){CUI.DropdownList=new Class({toString:"DropdownList",extend:CUI.Widget,construct:function(d){var b=a('<div class="dropdown-container">');
var f=(this.options.positioningElement)?this.options.positioningElement:this.$element;
f.after(b);
f.detach();
b.append(f);
this.containerElement=b;
this.$element.on("change:options change:optionRenderer",function(g){if(g.widget!==this){return
}this.update()
}.bind(this));
this.$element.on("keydown","",this._keyPressed.bind(this));
this.$element.on("blur","",function(){if(this.preventHiding){this.preventHiding=false;
return
}this.hide()
}.bind(this))
},defaults:{positioningElement:null,position:"below",autoPosition:true,optionRenderer:null,options:["Apples","Pears","Bananas","Strawberries"],cssClass:null,visible:false,scrollBuffer:10,loadingIndicator:"<div class='wait'></div>",noWidth:false},listElement:null,containerElement:null,currentIndex:-1,preventHiding:false,show:function(){this._unrender();
this.currentIndex=-1;
this.$element.focus();
this._render()
},hide:function(b){if(b>0){return setTimeout(this._unrender.bind(this),b)
}else{this._unrender()
}return null
},isVisible:function(){return this.options.visible
},toggle:function(){return this.isVisible()?this.hide():this.show()
},update:function(){if(this.listElement){this._unrender();
this._render()
}},addItems:function(b){var f=this.listElement.find("li").not(".loading-indicator").length;
if(this.listElement){var d=this.listElement.find("ul");
a.each(b,function(j,l){var k=(this.options.optionRenderer)?this.options.optionRenderer(j,l):a("<span>"+l.toString()+"</span>");
var g=a('<li data-id="'+(f+j)+'">');
if(j===this.currentIndex){g.addClass("selected")
}var h=this.options.getOptionClassAttribute(j);
if(h){g.addClass(h)
}g.append(k);
d.append(g);
this.options.options.push(l)
}.bind(this))
}},getNumberOfItems:function(){var b=this.listElement.find("li").not(".loading-indicator").length;
return b
},addLoadingIndicator:function(){if(this.listElement){this.listElement.find("ul").append(a("<li>"+this.options.loadingIndicator+"</li>").addClass("loading-indicator"))
}},removeLoadingIndicator:function(){if(this.listElement){this.listElement.find(".loading-indicator").remove()
}},_keyPressed:function(g){var d=g.keyCode;
if(!this.listElement){return
}var b=this.currentIndex;
if(d===38){g.preventDefault();
if(b>0){b--
}else{b=this.listElement.find("li").length-1
}}if(d===40){g.preventDefault();
if(b<(this.listElement.find("li").length-1)){b++
}else{b=0
}}if(d===27){g.preventDefault();
this.hide();
return
}if(d===13||d===20){g.preventDefault();
if(b>=0){this._triggerSelect(b,g);
return
}}this.currentIndex=b;
var h=this.listElement.find("li");
h.removeClass("selected");
if(b>=0){var f=a(h[b]);
f.addClass("selected");
this._updateScrollPosition(b)
}},_updateScrollPosition:function(b){var d=this.listElement.find(".autocomplete-results").children(":nth-child("+(b+1)+")");
if(this.listElement.length&&d.length){var h=d.position().top,g=this.listElement.scrollTop(),f=0;
if(h+d.height()>this.listElement.height()){f=g;
f+=h+d.outerHeight();
f-=this.listElement.height();
this.listElement.scrollTop(f)
}else{if(h<0){f=g;
f+=h;
this.listElement.scrollTop(f)
}}}},_unrender:function(){if(this.listElement){this.listElement.remove();
this.listElement=null
}this.containerElement.removeClass("dropdown-visible");
this.options.visible=false
},_render:function(){var d=this.options.options,h;
if(d.length===0){return
}var g=a("<ul></ul>");
if(this.options.cssClass){g.addClass(this.options.cssClass)
}a.each(d,function(l,n){var m=(this.options.optionRenderer)?this.options.optionRenderer(l,n):a("<span>"+n.toString()+"</span>");
var j=a('<li data-id="'+l+'">');
if(l===this.currentIndex){j.addClass("selected")
}var k=this.options.getOptionClassAttribute?this.options.getOptionClassAttribute(l):undefined;
if(k){j.addClass(k)
}j.append(m);
g.append(j)
}.bind(this));
g.on("click","li:not(.loading-indicator)",function(j){j.preventDefault();
this._triggerSelect(a(j.target).closest("li").attr("data-id"),j)
}.bind(this));
var f=(this.options.positioningElement)?this.options.positioningElement:this.$element;
var b=a('<div class="dropdown-list">');
b.append(g);
this.listElement=g=b;
g.css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);
if(!this.options.noWidth){g.css("width",f.outerWidth(false)+"px")
}h=this._calcPosition();
g.css({top:h.top+"px",left:h.left+"px",visibility:"visible"});
this.containerElement.addClass("dropdown-visible");
g.on("scroll","",function(j){this._listScrolled()
}.bind(this));
g.on("mousedown","",function(j){j.preventDefault();
j.stopPropagation()
}.bind(this));
g.on("focusin","",function(j){this.preventHiding=true
}.bind(this));
g.on("focusout","",function(j){this.preventHiding=false;
this.$element.trigger("blur")
}.bind(this));
this.options.visible=true
},_calcPosition:function(){var h=(this.options.positioningElement)?this.options.positioningElement:this.$element,d=h.offset().top+h.outerHeight(),g=h.offset().top-this.listElement.outerHeight(),l={left:h.offset().left,top:d},b=d+this.listElement.outerHeight()-a(window).scrollTop()<a(window).height(),f=g>a(window).scrollTop(),j=d+this.listElement.outerHeight()<a(document).height(),k=g>0;
l.top=(this.options.position==="above")?g:d;
if(this.options.autoPosition){if(this.options.position==="above"&&!f){l.top=(b||(!k&&j))?d:g
}else{if(this.options.position==="below"&&!b){l.top=(f||(!j&&k))?g:d
}}}return l
},_listScrolled:function(){if(this._reachedListBottom()){this._triggerScrolledBottom()
}},_reachedListBottom:function(){var b=this.listElement;
var d=this.listElement.find("ul");
return(d.height()-b.height()<=b.scrollTop()+this.options.scrollBuffer)
},_triggerSelect:function(b,d){this.$element.focus();
var f=a.Event("dropdown-list:select",{selectedIndex:b,selectedValue:this.options.options[b],source:this,originalEvent:d});
this.$element.trigger(f)
},_triggerScrolledBottom:function(b){var d=a.Event("dropdown-list:scrolled-bottom");
this.$element.trigger(d)
}});
CUI.util.plugClass(CUI.DropdownList)
}(window.jQuery));
(function(a){CUI.Dropdown=new Class({toString:"Dropdown",extend:CUI.Widget,construct:function(b){if(this.options.autocompleteCallback){this.options.editable=true
}this._render();
if(this._isMobile()&&!this.options.editable){this._initForMobile()
}else{this._initForDesktop()
}var d=this.$element.find(">div>button");
if(d.length>0&&d.attr("type")===undefined){d[0].setAttribute("type","button")
}},defaults:{options:[],multiple:false,placeholder:"Select",disabled:false,editable:false,hasError:false,noWidth:false,expandwidth:false,position:"below",autoPosition:true},dropdownList:null,autocompleteList:null,syncSelectElement:null,buttonElement:null,positioningElement:null,inputElement:null,hasFocus:false,_initForMobile:function(){this.$element.addClass("mobile");
this.buttonElement.on("click",function(){this._openSelectInput()
}.bind(this));
this.$element.find("select").on("change",function(){this._update(true)
}.bind(this));
this._placeSelect()
},_initForDesktop:function(){var b;
this.dropdownList=new CUI.DropdownList({element:this.buttonElement,positioningElement:this.positioningElement,position:this.options.position,autoPosition:this.options.autoPosition,options:this.options.options,optionRenderer:this._optionRenderer.bind(this),getOptionClassAttribute:this._getOptionClassAttribute.bind(this),noWidth:this.options.noWidth});
if(this.options.editable){this.autocompleteList=new CUI.DropdownList({element:this.inputElement,positioningElement:this.positioningElement,position:this.options.position,autoPosition:this.options.autoPosition,options:this.options.options,optionRenderer:this._optionRendererAutocomplete.bind(this),getOptionClassAttribute:this._getOptionClassAttribute.bind(this),noWidth:this.options.noWidth,cssClass:"autocomplete-results"})
}else{if(this.options.expandwidth){if(this.options.options.length!==0){b=this._getTextWidthFromOptions(this.options.options)
}this.buttonElement.width(b)
}}this.buttonElement.on("dropdown-list:select",this._processSelect.bind(this));
this.buttonElement.on("mousedown","",function(d){d.preventDefault();
if(this.autocompleteList!==null){this._adjustAutocompleter()
}else{this.dropdownList.toggle()
}}.bind(this));
this.buttonElement.on("mouseup","",function(d){d.preventDefault()
}.bind(this));
this.inputElement.on("click","",function(){if(this.autocompleteList!==null){this._adjustAutocompleter()
}}.bind(this));
this.inputElement.on("input","",function(){if(this.autocompleteList!==null){this._adjustAutocompleter({toggleList:false})
}}.bind(this));
this.inputElement.on("dropdown-list:select","",function(d){this._processSelect(d)
}.bind(this));
this.$element.children().on("focus","",function(){this.hasFocus=true;
this._update()
}.bind(this));
this.$element.children().on("blur","",function(){this.hasFocus=false;
this._update()
}.bind(this));
this.$element.find("select").on("change",function(){this._update(true)
}.bind(this))
},_placeSelect:function(){var b=this.$element.find("select").first();
b.css({position:"absolute",left:0,top:0,right:0,bottom:0,width:"auto",height:"auto"})
},_openSelectInput:function(){var b=this.$element.find("select")[0];
if(document.createEvent){var d=document.createEvent("MouseEvents");
d.initMouseEvent("mousedown",true,true,window,0,0,0,0,0,false,false,false,false,0,null);
b.dispatchEvent(d)
}else{if(b.fireEvent){b.fireEvent("onmousedown")
}}},_getTextWidthFromOptions:function(f){var h={position:"absolute",visibility:"hidden",width:"auto",height:"auto"},d=a(this.buttonText).clone().css(h).empty().appendTo(a(this.buttonElement)),j=0,g;
function b(k,l){k.text(l);
return k.width()
}if(f.length!==0){a.each(f,function(){g=b(d,this);
j=(g>j)?g:j
})
}d.remove();
j+=parseInt(this.buttonText.css("padding-left"),10)+parseInt(this.buttonText.css("padding-right"),10);
j+=parseInt(this.buttonText.css("margin-left"),10)+parseInt(this.buttonText.css("margin-right"),10);
j+=parseInt(this.buttonText.css("borderLeftWidth"),10)+parseInt(this.buttonText.css("borderRightWidth"),10);
return j
},_adjustAutocompleter:function(g){var d=this.inputElement.val();
var j={toggleList:true};
var f=a.extend(j,g);
var h=function(l,k){this.autocompleteList.set({options:l});
if(f.toggleList){this.autocompleteList.toggle()
}else{this.autocompleteList.show()
}}.bind(this);
if(this.options.autocompleteCallback){this.options.autocompleteCallback(h,d)
}else{var b=[];
a.each(this.options.options,function(k,l){if(l.toLowerCase().indexOf(d.toLowerCase(),0)>=0){b.push(l)
}});
h(b,d)
}},_optionRenderer:function(b,f){var d=a("<span>"+f+"</span>");
if(this.options.multiple){var g=a('<div class="checkbox">');
if(this.syncSelectElement&&a(this.syncSelectElement.find("option").get(b)).attr("selected")){g.addClass("checked")
}d.prepend(g)
}return d
},_optionRendererAutocomplete:function(d,g){var b=this.inputElement.val();
var f=g.toLowerCase().indexOf(b.toLowerCase());
if(f>=0){g=g.substr(0,f)+"<em>"+g.substr(f,b.length)+"</em>"+g.substr(f+b.length)
}return a("<span>"+g+"</span>")
},_getOptionClassAttribute:function(b){return(this.syncSelectElement)?a(this.syncSelectElement.find("option").get(b)).data("itemclass"):""
},_processSelect:function(d){if(this.syncSelectElement){var f=d.selectedValue;
var g=null;
if(d.source===this.autocompleteList){this.syncSelectElement.find("option").each(function(){if(a(this).attr("value")===f){g=a(this)
}});
if(g===null){g=a("<option>");
g.attr("value",f).text(f);
this.syncSelectElement.append(g)
}this.autocompleteList.hide()
}else{g=a(this.syncSelectElement.find("option").get(d.selectedIndex));
f=g.attr("value")
}if(this.options.multiple){var b=this.syncSelectElement.val();
if(b===null){b=[]
}if(b.indexOf(f)>=0){b.splice(b.indexOf(f),1)
}else{b.push(f)
}this.syncSelectElement.val(b);
this.dropdownList.update()
}else{this.syncSelectElement.val(f);
this.dropdownList.hide()
}this.syncSelectElement.change()
}this._update(true)
},_render:function(){this._readDataFromMarkup();
if(this.$element.get(0).tagName!=="DIV"){var b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.append(this.$element);
this.$element=b
}this._createMissingElements();
this.buttonElement=this.$element.find("button");
this.syncSelectElement=this.$element.find("select");
this.inputElement=this.$element.find("input");
this.positioningElement=(this.options.editable)?this.$element:this.buttonElement;
if(!this.options.editable){this.buttonText=a(this.buttonElement).wrapInner("<span />").find("span")
}if(!this.inputElement.attr("name")){this.inputElement.attr("name",this.syncSelectElement.attr("name")+".edit")
}if(this.syncSelectElement.attr("multiple")){this.options.multiple=true
}this.$element.addClass("dropdown");
if(this.options.editable){this.$element.addClass("dropdown-editable")
}if(this.$element.find("select option").length>0&&this.options.options.length===0){this.options.options=[];
this.$element.find("select option").each(function(d,f){this.options.options.push(a(f).html())
}.bind(this))
}if(this.options.multiple){this.syncSelectElement.attr("multiple","multiple")
}else{this.syncSelectElement.removeAttr("multiple","multiple")
}if(this.options.placeholder){if(!this.options.editable){this.buttonText.text(this.options.placeholder)
}else{this.buttonElement.text(this.options.placeholder)
}this.inputElement.attr("placeholder",this.options.placeholder)
}this._update(true)
},_readDataFromMarkup:function(){if(this.$element.attr("disabled")){this.options.disabled=true
}if(this.$element.attr("data-disabled")){this.options.disabled=true
}if(this.$element.attr("multiple")){this.options.multiple=true
}if(this.$element.attr("data-multiple")){this.options.multiple=true
}if(this.$element.attr("placeholder")){this.options.placeholder=this.$element.attr("placeholder")
}if(this.$element.attr("data-placeholder")){this.options.placeholder=this.$element.attr("data-placeholder")
}if(this.$element.attr("data-editable")){this.options.editable=true
}if(this.$element.attr("data-error")){this.options.hasError=true
}if(this.$element.hasClass("error")){this.options.hasError=true
}if(this.$element.attr("data-nowidth")){this.options.noWidth=true
}if(this.$element.attr("data-expandwidth")){this.options.expandwidth=true
}},_createMissingElements:function(){if(this.$element.find("button").length===0){var f=a("<button/>",{text:this.options.placeholder,type:"button"});
f.addClass("dropdown");
this.$element.append(f)
}if(this.options.editable&&this.$element.find("input").length===0){var d=a('<input type="text">');
this.$element.prepend(d)
}if(this.$element.find("select").length===0){var b=a("<select>");
this.$element.append(b)
}},_update:function(g){if(g){if(this.syncSelectElement&&!this.options.multiple){var f=this.syncSelectElement.find("option:selected");
if(f){var b=f.index();
var h=f.text();
var d=f.html();
if(this.inputElement.length>0){this.inputElement.val(h).trigger("change")
}else{this.buttonText.html(d)
}}}}if(this.options.disabled){this.buttonElement.attr("disabled","disabled");
this.inputElement.attr("disabled","disabled")
}else{this.buttonElement.removeAttr("disabled");
this.inputElement.removeAttr("disabled")
}if(this.hasFocus){this.$element.addClass("focus")
}else{this.$element.removeClass("focus")
}if(this.options.hasError){this.$element.addClass("error")
}else{this.$element.removeClass("error")
}},_isMobile:function(){return typeof window.ontouchstart==="object"
}});
CUI.util.plugClass(CUI.Dropdown);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~=dropdown]",b.target).dropdown()
})
}}(window.jQuery));
(function(a){CUI.Filters=new Class({toString:"Filters",extend:CUI.Widget,construct:function(b){this.selectedIndices=[];
this.createdIndices=[];
if(!this.options.autocompleteCallback){this.options.autocompleteCallback=this._defaultAutocompleteCallback.bind(this)
}else{this.usingExternalData=true
}if(!this.options.optionRenderer){this.options.optionRenderer=CUI.Filters.defaultOptionRenderer
}this._readDataFromMarkup();
if(this.options.stacking){this.options.multiple=true
}this._render();
if(this.options.optionDisplayStrings.length>this.options.options.length){this.options.optionDisplayStrings=this.options.optionDisplayStrings.slice(0,this.options.options.length)
}while(this.options.optionDisplayStrings.length<this.options.options.length){this.options.optionDisplayStrings.push(this.options.options[this.options.optionDisplayStrings.length])
}this.dropdownList=new CUI.DropdownList({element:this.inputElement,positioningElement:(this.options.stacking)?this.$element:this.inputElement,position:this.options.position,autoPosition:this.options.autoPosition,cssClass:"autocomplete-results"});
this._addEventListeners()
},defaults:{autocompleteCallback:null,optionRenderer:null,options:[],optionDisplayStrings:[],multiple:false,delay:200,highlight:true,stacking:false,placeholder:null,allowCreate:false,icons:null,iconSize:"small",infiniteLoad:false,maxLoadingItems:20,hasError:false,position:"below",autoPosition:true},dropdownList:null,syncSelectElement:null,inputElement:null,typeTimeout:null,selectedIndex:-1,selectedIndices:null,createdIndices:null,triggeredBackspace:false,usingExternalData:false,selectedValue:null,isLoadingExternal:false,loadedEverything:false,setSelectedIndex:function(b){if(b<-1||b>=this.options.options.length){return
}this.inputElement.attr("value","");
this.selectedIndex=b;
if(this.options.multiple&&b>=0&&this.selectedIndices.indexOf(b*1)<0){this.selectedIndices.push(b*1)
}if(!this.options.multiple){this.selectedIndices=(b>=0)?[b]:[]
}this._update()
},removeSelectedIndex:function(b){var d=this.selectedIndices.indexOf(b*1);
if(d<0){return
}this.selectedIndices.splice(d,1);
this._update()
},getSelectedIndex:function(){return this.selectedIndex
},setSelectedIndices:function(b){this.selectedIndices=b.slice(0);
this._update()
},getSelectedIndices:function(){return this.selectedIndices.slice(0)
},_addEventListeners:function(){this.$element.on("change:disabled",this._update.bind(this));
this.$element.on("change:placeholder",this._update.bind(this));
this.$element.on("change:options",this._changeOptions.bind(this));
this.$element.on("input","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=setTimeout(this._inputChanged.bind(this),this.options.delay)
}.bind(this));
this.$element.on("click touchend","input",function(){if(this.options.disabled){return
}this.inputElement.focus();
this._inputChanged()
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=null;
if(!this.options.multiple&&this.selectedIndex>=0){if(this.inputElement.attr("value")===""){this.setSelectedIndex(-1)
}else{this._update()
}}var b=this.options.hasError||(!this.options.multiple&&this.inputElement.val().length>0&&this.selectedIndex<0);
this.$element.toggleClass("error",b)
}.bind(this));
this.$element.on("keydown","input",this._keyPressed.bind(this));
this.$element.on("keyup","input",this._keyUp.bind(this));
this.dropdownList.on("dropdown-list:select","",function(b){if(this.options.infiniteLoad){this.loadedEverything=false
}this.dropdownList.hide(200);
if(this.usingExternalData){this._createNewOption(b.selectedValue.toString(),b.selectedValue.toString(),true);
this._update()
}var d=a.inArray(b.selectedValue.toString(),this.options.options);
this.setSelectedIndex(d*1)
}.bind(this));
if(this.options.infiniteLoad){this.dropdownList.on("dropdown-list:scrolled-bottom","",function(d){if(!this.isLoadingExternal&&!this.loadedEverything){this.isLoadingExternal=true;
this.dropdownList.addLoadingIndicator();
var f=this.dropdownList.getNumberOfItems();
var b=this.inputElement.attr("value");
this.options.autocompleteCallback(a.proxy(this._appendLoadedData,this),b,f,this.options.maxLoadingItems)
}}.bind(this))
}this.$element.on("click","[data-dismiss=filter]",function(b){if(this.options.disabled){return
}var d=a(b.target).closest("[data-id]");
this.removeSelectedIndex(d.attr("data-id"));
return false
}.bind(this));
this.$element.on("input","input",function(){if(this.options.disabled){return
}this._correctInputFieldWidth()
}.bind(this));
this.$element.on("focus","input",function(b){if(this.options.disabled){return
}this.$element.addClass("focus");
b.preventDefault()
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}this.$element.removeClass("focus")
}.bind(this))
},_changeOptions:function(b){if(b.widget!==this){return
}this.selectedIndex=-1;
this.selectedIndices=[];
this.createdIndices=[];
this._update()
},_render:function(){var b;
if(this.$element.get(0).tagName==="SELECT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.append(this.$element);
this.$element=b
}if(this.$element.get(0).tagName==="INPUT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.prepend(this.$element);
this.$element=b
}if(this.$element.find("select option").length>0&&this.options.options.length===0){this.options.options=[];
this.options.optionDisplayStrings=[];
this.$element.find("select option").each(function(d,f){this.options.options.push(a(f).val());
this.options.optionDisplayStrings.push(a.trim(a(f).text()));
if(a(f).attr("selected")){this.selectedIndices.push(d);
this.selectedIndex=d
}}.bind(this))
}this._createMissingElements();
this.syncSelectElement=this.$element.find("select");
this.inputElement=this.$element.find("input");
this.$element.addClass("filters");
this.$element.removeClass("focus");
if(!this.options.placeholder){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.options.name){this.syncSelectElement.attr("name",this.options.name)
}if(this.options.stacking){this.$element.addClass("stacking")
}else{this.$element.removeClass("stacking")
}this._update()
},_createMissingElements:function(){if(this.$element.find("select").length===0){this.$element.append(a("<select "+(this.options.multiple?"multiple":"")+"></select>"))
}if(this.$element.find("input").length===0){this.$element.prepend(a('<input type="text">'))
}if(this.$element.find("select option").length<this.options.options.length){for(var f=this.$element.find("select option").length;
f<this.options.options.length;
f++){var g=this.options.options[f];
var b=this.options.optionDisplayStrings[f]||this.options.options[f];
var d=a("<option></option>");
d.text(b);
d.attr("value",g);
this.$element.find("select").append(d)
}}},_readDataFromMarkup:function(){if(this.$element.attr("multiple")){this.options.multiple=true
}if(this.$element.attr("data-multiple")){this.options.multiple=true
}if(this.$element.attr("data-stacking")){this.options.stacking=true
}if(this.$element.attr("placeholder")){this.options.placeholder=this.$element.attr("placeholder")
}if(this.$element.attr("data-placeholder")){this.options.placeholder=this.$element.attr("data-placeholder")
}if(this.$element.attr("disabled")){this.options.disabled=true
}if(this.$element.hasClass("error")){this.options.hasError=true
}if(this.$element.find("input").hasClass("error")){this.options.hasError=true
}if(this.$element.attr("data-disabled")){this.options.disabled=true
}if(this.$element.attr("data-allow")==="create"){this.options.allowCreate=true
}if(this.$element.attr("data-option-renderer")){this.options.optionRenderer=CUI.Filters[this.$element.attr("data-option-renderer")+"OptionRenderer"];
if(!this.options.optionRenderer){this.options.optionRenderer=CUI.Filters.defaultOptionRenderer
}}},_update:function(){if(this.options.placeholder){this.inputElement.attr("placeholder",this.options.placeholder)
}if(this.options.disabled){this.$element.addClass("disabled");
this.inputElement.attr("disabled","disabled")
}else{this.$element.removeClass("disabled");
this.inputElement.removeAttr("disabled")
}if(!this.options.multiple){if(this.syncSelectElement){this.syncSelectElement.find("option:selected").removeAttr("selected")
}if(this.selectedIndex>=0){if(this.syncSelectElement){a(this.syncSelectElement.find("option").get(this.selectedIndex)).attr("selected","selected")
}var g=this.options.options[this.selectedIndex];
if(this.options.optionDisplayStrings[this.selectedIndex]){g=this.options.optionDisplayStrings[this.selectedIndex]
}this.inputElement.attr("value",g)
}else{this.inputElement.attr("value","")
}this.$element.find("select").change();
return
}if(this.syncSelectElement){this.syncSelectElement.find("option:selected").removeAttr("selected");
for(var f=0;
f<this.selectedIndices.length;
f++){var b=this.selectedIndices[f];
a(this.syncSelectElement.find("option").get(b)).attr("selected","selected")
}}var d=a('<ul class="tags"></ul>');
a.each(this.selectedIndices,function(m,j){var l=this.options.options[j];
var k=(this.options.optionRenderer.bind(this))(j,l,false,false);
var h=a('<li data-id="'+j+'"><button data-dismiss="filter">&times;</button></li>');
d.append(h);
h.append(k)
}.bind(this));
this.$element.find("ul").remove();
if(d.children().length>0){if(this.options.stacking){this.$element.prepend(d)
}else{this.$element.append(d)
}}this._correctInputFieldWidth();
this.$element.find("select").change()
},_keyUp:function(d){var b=d.keyCode;
if(b===8){this.triggeredBackspace=false
}},_keyPressed:function(d){var b=d.keyCode;
if(b===8){if(this.triggeredBackspace===false&&this.inputElement.attr("value").length===0){if(this.options.multiple&&this.selectedIndices.length>0){d.preventDefault();
this.removeSelectedIndex(this.selectedIndices[this.selectedIndices.length-1]);
this._inputChanged()
}}this.triggeredBackspace=true
}if(!this.dropdownList.isVisible()){if(b===40){this._inputChanged();
d.preventDefault()
}if(b===13){var f=this.inputElement.val();
if(f.length>0){this._createNewOption(f,f,false);
d.preventDefault()
}}}else{if(b===13&&this.dropdownList.currentIndex<0){this.dropdownList.hide();
d.preventDefault()
}}},_createNewOption:function(g,d,h){var b=-1;
a.each(this.options.options,function(k,l){if(this.options.optionDisplayStrings[k]===g){b=k
}if(l===g){b=k
}}.bind(this));
if(b>=0){this.setSelectedIndex(b);
return
}if(!this.options.allowCreate&&!h){return
}var f=this.options.options.length;
this.options.options.push(g);
this.options.optionDisplayStrings.push(d);
if(this.syncSelectElement){var j=a("<option></option>");
j.text(d);
j.attr("value",g);
if(!h){j.attr("data-new","true")
}this.syncSelectElement.append(j)
}if(!h){this.createdIndices.push(f)
}this.setSelectedIndex(f)
},_correctInputFieldWidth:function(){if(!this.options.stacking){return
}var f=this.inputElement;
var j=f.attr("value")||"";
if(j.length===0){j=f.attr("placeholder")
}var g=["font-family","font-weight","font-style","font-size","letter-spacing","line-height","text-transform"];
var k=a('<div style="position: absolute; display: none;"></div>');
a.each(g,function(l,m){k.css(m,f.css(m))
});
k.text(j);
a("body").append(k);
var b=k.width()+25;
k.remove();
var d=parseFloat(f.css("margin-left"))+parseFloat(f.css("margin-right"));
var h=(this.selectedIndices.length===0);
if(h||b>(this.$element.width()-d)){b=(this.$element.width()-d)
}f.width(b)
},_inputChanged:function(){if(this.options.infiniteLoad){this.loadedEverything=false
}var b=this.inputElement.attr("value");
this.options.autocompleteCallback(a.proxy(this._showAutocompleter,this),b,0,(this.options.infiniteLoad)?this.options.maxLoadingItems:500)
},_appendLoadedData:function(b){this.dropdownList.removeLoadingIndicator();
if(b.length===0){this.loadedEverything=true;
this.isLoadingExternal=false;
return
}this.dropdownList.addItems(b);
this.isLoadingExternal=false
},_showAutocompleter:function(f){this.dropdownList.hide();
if(this.options.multiple){var d=[];
a.each(f,function(h,g){var j=a.inArray(g,this.options.options);
if(this.selectedIndices.indexOf(j)>=0){return
}d.push(g)
}.bind(this));
f=d
}if(f.length===0){return
}var b=function(g,h){return(this.options.optionRenderer.bind(this))(g,h,this.options.highlight,!a.isEmptyObject(this.options.icons))
};
this.dropdownList.set("optionRenderer",b.bind(this));
this.dropdownList.set("options",f);
this.dropdownList.show()
},_defaultAutocompleteCallback:function(f,d){var b=[];
a.each(this.options.options,function(h,j){var g=j;
if(this.options.optionDisplayStrings[h]){g=this.options.optionDisplayStrings[h]
}if(g.toLowerCase().indexOf(d.toLowerCase(),0)>=0){b.push(j)
}}.bind(this));
f(b,d)
},_buildIcon:function(f,b,d){if(f==="url"){return'<i class="'+d+' icon-inline-bg-image" style="background-image: url('+b+')">icon</i>'
}else{if(f==="cuiIcon"){return'<i class="'+b+" "+d+'">'+b.split("icon-")[1]+"</i>"
}}}});
CUI.util.plugClass(CUI.Filters);
a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~=filters]",b.target).filters()
});
CUI.Filters.defaultOptionRenderer=function(g,n,d,l){var k=a.inArray(n,this.options.options);
var m=n;
if(this.options.optionDisplayStrings[k]){m=this.options.optionDisplayStrings[k]
}var b=this.inputElement.val();
if(d){var f=m.toLowerCase().indexOf(b.toLowerCase());
if(f>=0){m=m.substr(0,f)+"<em>"+m.substr(f,b.length)+"</em>"+m.substr(f+b.length)
}}if(this.createdIndices.indexOf(k)>=0){m=m+"&nbsp;*"
}if(l){var h;
if(typeof(h=this.options.icons[n])!=="undefined"){var j=(/^icon-/i.test(h))?"cuiIcon":"url";
m=this._buildIcon(j,h,this.options.iconSize)+m
}}return a("<span>"+m+"</span>")
};
CUI.Filters.cqTagOptionRenderer=function(k,r,g){var l=a.inArray(r,this.options.options);
var p=r;
if(this.options.optionDisplayStrings[l]){p=this.options.optionDisplayStrings[l]
}var b=this.inputElement.val();
var o=p.split(":");
if(o.length<2){o[1]=""
}var h=o[0];
var n=o[1];
var s=n.split("/");
function m(q){return a("<div>").text(q).html()
}h=m(h);
p=h+": ";
for(var d=0;
d<s.length;
d++){var f=s[d];
if(g){var j=f.toLowerCase().indexOf(b.toLowerCase());
if(j>=0){f=m(f.substr(0,j))+"<em>"+m(f.substr(j,b.length))+"</em>"+m(f.substr(j+b.length))
}else{f=m(f)
}}else{f=m(f)
}if(d>0){p+=" / "
}if(d===s.length-1){f="<b>"+f+"</b>"
}p=p+f
}if(this.createdIndices.indexOf(l)>=0){p=p+"&nbsp;*"
}return a("<span>"+p+"</span>")
}
}(window.jQuery));
(function(b,a,d){CUI.Slider=new Class({toString:"Slider",extend:CUI.Widget,construct:function(){var k=this,h=this.$element.attr("id"),f=this.$element.children("fieldset"),j=f.children("legend"),g=[];
this._readOptions();
if(!h){h=CUI.util.getNextId();
this.$element.attr("id",h)
}this._renderMissingElements();
if(f.length>0){this.$element.append(f.contents(":not(legend)"));
this._group=b("<div/>",{role:"group","class":"sliderfieldset"});
k.$element.wrap(this._group);
if(j.length>0){this._grouplegend=b("<label/>").append(j.contents());
b.each(j.prop("attributes"),function(){k._grouplegend.attr(this.name,this.value)
});
if(!this._grouplegend.attr("id")){this._grouplegend.attr("id",h+"-legend")
}this._group.attr("aria-labelledby",this._grouplegend.attr("id"));
f.replaceWith(this._grouplegend);
j=this._grouplegend.insertBefore(this.$element)
}}this.$inputs=this.$element.find("input");
this.$inputs.each(function(n){var o=b(this),m=o.attr("id");
if(!m){o.attr("id",h+"-input"+n);
m=o.attr("id")
}if(!o.attr("aria-labelledby")){o.attr("aria-labelledby","")
}var l=k.$element.find('label[for="'+m+'"]');
if(j){if(o.attr("aria-labelledby").indexOf(j.attr("id"))===-1){o.attr("aria-labelledby",j.attr("id")+(o.attr("aria-labelledby").length?" ":"")+o.attr("aria-labelledby"))
}}if(l.length>0){l.not(o.parent()).insertBefore(k.$element);
l.each(function(p){if(!b(this).attr("id")){b(this).attr("id",m+"-label"+p)
}if(o.attr("aria-labelledby").indexOf(m+"-label"+p)===-1){o.attr("aria-labelledby",(o.attr("aria-labelledby").length?" ":"")+m+"-label"+p)
}if(!CUI.util.isTouch){b(this).fipo("touchstart","mousedown",function(q){k.$handles.eq(p).focus()
}.bind(this))
}})
}if(o.parent().is("label")){l=o.parent();
if(!l.attr("id")){l.attr("id",m+"-label")
}if(!l.attr("for")){l.attr("for",m)
}o.insertAfter(l);
if(j){l.addClass("hidden-accessible")
}l.insertBefore(k.$element)
}if(l.length&&o.attr("aria-labelledby").indexOf(l.attr("id"))===-1){o.attr("aria-labelledby",o.attr("aria-labelledby")+(o.attr("aria-labelledby").length?" ":"")+l.attr("id"))
}if(l.length===0&&o.attr("aria-labelledby").length>0){l=b("#"+o.attr("aria-labelledby").split(" ")[0])
}if(o.attr("aria-labelledby").length===0){o.removeAttr("aria-labelledby")
}if(!o.is("[step]")){o.attr("step",k.options.step)
}if(!o.is("[min]")){o.attr("min",k.options.min)
}if(!o.is("[max]")){o.attr("max",k.options.max)
}if(!o.is("[value]")){o.attr({value:k.options.value,"aria-valuetext":k.options.valuetextFormatter(k.options.value)});
g.push(k.options.value)
}else{g.push(o.attr("value"))
}if(n===0){if(o.is(":disabled")){k.options.disabled=true;
k.$element.addClass("disabled")
}else{if(k.options.disabled){o.attr("disabled","disabled");
k.$element.addClass("disabled")
}}}if(CUI.util.isTouch){o.on("change",function(p){if(k.options.disabled){return
}if(o.val()===k.values[n]){return
}k.setValue(o.val(),n)
}.bind(this));
o.on("focus",function(p){k._focus(p)
}.bind(this));
o.on("blur",function(p){k._blur(p)
}.bind(this))
}else{o.attr({"aria-hidden":true,tabindex:-1,hidden:"hidden"});
if(n===0){if(l){l.on("click",function(p){if(k.options.disabled){return
}k._clickLabel(p)
}.bind(this))
}if(j){j.on("click",function(p){if(k.options.disabled){return
}k._clickLabel(p)
}.bind(this))
}}}});
k.values=g;
if(this.options.orientation==="vertical"){this.isVertical=true
}this.$element.fipo("touchstart","mousedown",function(l){this._mouseDown(l)
}.bind(this));
this.$element.on("change:value",this._processValueChanged.bind(this));
this.$element.on("change:disabled",this._processDisabledChanged.bind(this));
this.$element.on("change:min",this._processMinMaxStepChanged.bind(this));
this.$element.on("change:max",this._processMinMaxStepChanged.bind(this));
this.$element.on("change:step",this._processMinMaxStepChanged.bind(this));
this._render()
},defaults:{step:"1",min:"1",max:"100",value:"1",orientation:"horizontal",slide:false,disabled:false,tooltips:false,tooltipFormatter:function(f){return f.toString()
},valuetextFormatter:function(f){return f.toString()
},ticks:false,filled:false,bound:false},values:[],$inputs:null,$ticks:null,$fill:null,$handles:null,$tooltips:null,isVertical:false,draggingPosition:-1,_readOptions:function(){if(this.$element.hasClass("vertical")){this.options.orientation="vertical";
this.isVertical=true
}if(this.$element.hasClass("tooltips")){this.options.tooltips=true
}if(this.$element.hasClass("ticked")){this.options.ticks=true
}if(this.$element.hasClass("filled")){this.options.filled=true
}if(this.$element.data("slide")){this.options.slide=true
}if(this.$element.hasClass("bound")){this.options.bound=true
}},setValue:function(f,g){g=g||0;
this._updateValue(g,f,true);
this._moveHandles();
if(this.options.filled){this._updateFill()
}},_renderMissingElements:function(){if(!this.$element.find("input").length){var j=this,h,f=(b.isArray(this.options.value))?this.options.value:[this.options.value];
b.each(f,function(k,l){h=b("<input>");
h.attr({type:"range",min:j.options.min,max:j.options.max,step:j.options.step,value:l}).val(l);
j.$element.append(h)
})
}if(!this.$element.find("div.clickarea").length){var g=b('<div class="clickarea">');
this.$element.prepend(g)
}this.$element.toggleClass("slider",true);
this.$element.toggleClass("vertical",this.options.orientation==="vertical");
this.$element.toggleClass("tooltips",this.options.tooltips);
this.$element.toggleClass("ticked",this.options.ticks);
this.$element.toggleClass("filled",this.options.filled)
},_processValueChanged:function(){var g=this,f=(b.isArray(this.options.value))?this.options.value:[this.options.value];
b.each(f,function(h,j){g._updateValue(h,j,true)
});
this._moveHandles();
if(this.options.filled){this._updateFill()
}},_processMinMaxStepChanged:function(){var f=this;
this.$element.find("input").attr("min",this.options.min);
this.$element.find("input").attr("max",this.options.max);
this.$element.find("input").attr("step",this.options.step);
b.each(this.values,function(g,h){f._updateValue(g,h,true)
});
if(this.options.ticks){this.$element.find(".ticks").remove();
this._buildTicks()
}if(this.options.filled){this.$element.find(".fill").remove();
this._buildFill()
}this._moveHandles();
if(this.options.filled){this._updateFill()
}},_processDisabledChanged:function(){if(this.options.disabled){this.$inputs.attr("disabled","disabled");
this.$handles.each(function(){b(this).removeClass("focus");
b(this).parent().removeClass("focus")
});
if(CUI.util.isTouch){this.$handles.attr("aria-disabled",true).removeAttr("tabindex")
}}else{this.$inputs.removeAttr("disabled");
if(CUI.util.isTouch){this.$handles.removeAttr("aria-disabled").attr("tabindex",0)
}}this.$element.toggleClass("disabled",this.options.disabled)
},_render:function(){var g=this;
var j=g.$inputs.map(function(){return b(this).attr("max")
});
g.options.max=Math.max.apply(null,j.toArray());
var h=g.$inputs.map(function(){return b(this).attr("min")
});
g.options.min=Math.min.apply(null,h.toArray());
var f=g.$inputs.map(function(){return b(this).attr("step")
});
g.options.step=Math.min.apply(null,f.toArray());
if(g.options.ticks){g._buildTicks()
}if(g.options.filled){g._buildFill()
}g._buildHandles()
},_buildTicks:function(){var n=this;
var h=b("<div></div>").addClass("ticks");
this.$element.prepend(h);
var l=Math.round((n.options.max-n.options.min)/n.options.step)-1;
var g=n.isVertical?n.$element.height():n.$element.width();
for(var k=0;
k<l;
k++){var f=(k+1)*(g/(l+1));
var m=(f/g)*100;
var j=b("<div></div>").addClass("tick").css((n.isVertical?"bottom":"left"),m+"%");
h.append(j)
}n.$ticks=h.find(".tick");
if(n.options.filled){n._coverTicks()
}},_buildFill:function(){var g=this;
this.$fill=b("<div></div>").addClass("fill");
if(g.values.length!==0){var f,h;
if(g.values.length<2){f=(g.values[0]-g.options.min)/(g.options.max-g.options.min)*100;
this.$fill.css((g.isVertical?"height":"width"),f+"%")
}else{f=(this._getLowestValue()-g.options.min)/(g.options.max-g.options.min)*100;
h=(this._getHighestValue()-this._getLowestValue())/(g.options.max-g.options.min)*100;
this.$fill.css((g.isVertical?"height":"width"),h+"%").css((g.isVertical?"bottom":"left"),f+"%")
}}this.$element.prepend(this.$fill);
g.options.filled=true
},_buildHandles:function(){var f=this;
f.$inputs.each(function(h){var l=b(this).wrap("<div></div>").parent().addClass("value");
var m=(f.values[h]-f.options.min)/(f.options.max-f.options.min)*100;
var o=b("<div></div>").addClass("handle").css((f.isVertical?"bottom":"left"),m+"%").attr({role:"slider",id:b(this).attr("id")+"-handle","aria-valuemin":f.options.min,"aria-valuemax":f.options.max,"aria-valuenow":f.values[h],"aria-valuetext":f.options.valuetextFormatter(f.values[h])});
b(this).css((f.isVertical?"bottom":"left"),m+"%");
b(l).append(o);
if(f.options.tooltips){var n=b("<output>"+b(this).attr("value")+"</output>").addClass("tooltip").addClass(f.isVertical?"arrow-left":"arrow-bottom").attr({id:b(this).attr("id")+"-tooltip","for":b(this).attr("id")});
o.append(n)
}if(b(this).attr("aria-labelledby")){o.attr("aria-labelledby",b(this).attr("aria-labelledby"))
}if(f.$inputs.length>1&&b(this).attr("aria-labelledby")){var k=b(this).attr("aria-labelledby").split(" "),g;
for(var j=0;
j<k.length;
j++){g=b("#"+k[j]);
if(j>0){g.removeAttr("for");
o.prepend(g)
}}}if(CUI.util.isTouch){o.attr("aria-hidden",true);
b(this).attr("tabindex",0).removeAttr("aria-hidden").removeAttr("hidden")
}else{o.on("focus",function(p){f._focus(p)
}.bind(this));
o.on("blur",function(p){f._blur(p)
}.bind(this));
o.on("keydown",function(p){f._keyDown(p)
}.bind(this));
o.attr("tabindex",0);
b(this).attr({"aria-hidden":true,tabindex:-1,hidden:"hidden"})
}if(f.options.disabled){o.attr("aria-disabled",true).removeAttr("tabindex")
}});
f.$handles=f.$element.find(".handle");
f.$tooltips=f.$element.find(".tooltip")
},_handleClick:function(j){if(this.options.disabled){return false
}var h=this;
var g=j.pageX;
var f=j.pageY;
if(j.type==="touchstart"){var k=(j.originalEvent.touches.length>0)?j.originalEvent.touches:j.originalEvent.changedTouches;
g=k[0].pageX;
f=k[0].pageY
}if(g===d||f===d){return
}var m=h._findNearestHandle(g,f);
var l=h._getValueFromCoord(g,f,true);
if(!isNaN(l)){h._updateValue(m,l);
h._moveHandles();
if(h.options.filled){h._updateFill()
}}if(!CUI.util.isTouch){if(j.type==="mousedown"){h.$handles.eq(m).data("mousedown",true)
}h.$handles.eq(m).focus()
}},_findNearestHandle:function(g,f){var h=this;
var j=999999;
var k=0;
h.$handles.each(function(m){var p=b(this).offset().left;
var o=b(this).offset().top;
var l=b(this).width();
var n=b(this).height();
var q=Math.abs(g-(p+(l/2)));
if(h.options.orientation==="vertical"){q=Math.abs(f-(o+(n/2)))
}if(q<j){j=q;
k=m
}});
return k
},_focus:function(h){if(this.options.disabled){return false
}var g=this,j=b(h.target),f=j.closest(".value"),k=f.find(".handle");
if(!k.data("mousedown")){g.$element.addClass("focus");
f.addClass("focus");
k.addClass("focus")
}},_blur:function(h){if(this.options.disabled){return false
}var g=this,j=b(h.target),f=j.closest(".value"),k=f.find(".handle");
g.$element.removeClass("focus");
f.removeClass("focus");
k.removeClass("focus").removeData("mousedown")
},_keyDown:function(f){if(this.options.disabled){return
}var k=this,o=b(f.target),p=o.closest(".value").find("input"),l=k.$inputs.index(p),g=Number(p.val()),h=Number(k.options.step),n=Number(k.options.min),j=Number(k.options.max),m=Math.max(h,Math.round((j-n)/10));
o.removeData("mousedown");
k._focus(f);
switch(f.keyCode){case 40:case 37:g-=h;
f.preventDefault();
break;
case 38:case 39:g+=h;
f.preventDefault();
break;
case 33:g+=(m-(g%m));
f.preventDefault();
break;
case 34:g-=(m-(g%m===0?0:m-g%m));
f.preventDefault();
break;
case 35:g=j;
f.preventDefault();
break;
case 36:g=n;
f.preventDefault();
break
}if(g!==Number(p.val())){k.setValue(g,l);
p.change()
}},_mouseDown:function(g){if(this.options.disabled){return false
}g.preventDefault();
var f=this,h;
this.draggingPosition=-1;
this.$handles.each(function(j,k){if(k===g.target){f.draggingPosition=j
}}.bind(this));
this.$tooltips.each(function(j,k){if(k===g.target){f.draggingPosition=j
}}.bind(this));
if(this.draggingPosition<0){this._handleClick(g);
return
}h=this.$handles.eq(this.draggingPosition);
h.addClass("dragging");
this.$element.closest("body").addClass("slider-dragging-cursorhack");
b(a).fipo("touchmove.slider","mousemove.slider",this._handleDragging.bind(this));
b(a).fipo("touchend.slider","mouseup.slider",this._mouseUp.bind(this));
if(h!==document.activeElement&&!CUI.util.isTouch){if(g.type==="mousedown"){h.data("mousedown",true)
}h.focus()
}},_handleDragging:function(h){var g=h.pageX;
var f=h.pageY;
if(h.originalEvent.targetTouches){var j=h.originalEvent.targetTouches.item(0);
g=j.pageX;
f=j.pageY
}this._updateValue(this.draggingPosition,this._getValueFromCoord(g,f));
this._moveHandles();
if(this.options.filled){this._updateFill()
}h.preventDefault()
},_mouseUp:function(){this.$handles.eq(this.draggingPosition).removeClass("dragging");
this.$element.closest("body").removeClass("slider-dragging-cursorhack");
this.draggingPosition=-1;
b(a).unbind("mousemove.slider touchmove.slider");
b(a).unbind("mouseup.slider touchend.slider")
},_clickLabel:function(f){this.$handles.eq(0)[0].focus()
},_updateValue:function(j,h,f){var g=this;
if(g.$inputs.eq(j).attr("value")!==h.toString()||(g.values[j]!==h.toString())){if(h>this.options.max){h=this.options.max
}if(h<this.options.min){h=this.options.min
}if(j===0||j===1){if(g.$inputs.length===2&&this.options.bound){if(j===0){h=Math.min(h,Number(g.$inputs.eq(1).val()));
g.$inputs.eq(1).attr({min:h});
g.$inputs.eq(j).attr({max:g.$inputs.eq(1).val()});
g.$handles.eq(1).attr({"aria-valuemin":h});
g.$handles.eq(j).attr({"aria-valuemax":g.$inputs.eq(1).val()})
}else{h=Math.max(h,Number(g.$inputs.eq(0).val()));
g.$inputs.eq(0).attr({max:h});
g.$inputs.eq(j).attr({min:g.$inputs.eq(0).val()});
g.$handles.eq(0).attr({"aria-valuemax":h});
g.$handles.eq(j).attr({"aria-valuemin":g.$inputs.eq(0).val()})
}}g.values[j]=h.toString();
g.$inputs.eq(j).val(h).attr({value:h,"aria-valuetext":g.options.valuetextFormatter(h)});
g.$handles.eq(j).attr({"aria-valuenow":h,"aria-valuetext":g.options.valuetextFormatter(h)});
if(!f){setTimeout(function(){g.$inputs.eq(j).change()
},1)
}}}},_moveHandles:function(){var f=this;
this.$handles.each(function(g){var h=(f.values[g]-f.options.min)/(f.options.max-f.options.min)*100;
var j=f.$inputs.eq(g);
if(f.options.orientation==="vertical"){if(f.options.slide){b(this).stop().animate({bottom:h+"%"});
j.stop().animate({bottom:h+"%"})
}else{b(this).css("bottom",h+"%");
j.css("bottom",h+"%")
}}else{if(f.options.slide){b(this).stop().animate({left:h+"%"});
j.stop().animate({left:h+"%"})
}else{b(this).css("left",h+"%");
j.css("left",h+"%")
}}if(f.options.tooltips){f.$tooltips.eq(g).html(f.options.tooltipFormatter(f.values[g]))
}})
},_updateFill:function(){var h=this;
var g;
if(h.values.length!==0){if(h.values.length===2){g=((h._getLowestValue()-h.options.min)/(h.options.max-h.options.min))*100;
var f=((h._getHighestValue()-h.options.min)/(h.options.max-h.options.min))*100;
var j=f-g;
if(h.options.orientation==="vertical"){if(h.options.slide){h.$fill.stop().animate({bottom:g+"%",height:j+"%"})
}else{h.$fill.css("bottom",g+"%").css("height",j+"%")
}}else{if(h.options.slide){h.$fill.stop().animate({left:g+"%",width:j+"%"})
}else{h.$fill.css("left",g+"%").css("width",j+"%")
}}}else{g=((h.values[0]-h.options.min)/(h.options.max-h.options.min))*100;
if(h.options.orientation==="vertical"){if(h.options.slide){h.$fill.stop().animate({height:g+"%"})
}else{h.$fill.css("height",g+"%")
}}else{if(h.options.slide){h.$fill.stop().animate({width:g+"%"})
}else{h.$fill.css("width",g+"%")
}}}}if(h.options.ticks){h._coverTicks()
}},_coverTicks:function(){var f=this;
f.$ticks.each(function(g){var h=f._getValueFromCoord(b(this).offset().left,b(this).offset().top);
if(f.values.length===2){if((h>f._getLowestValue())&&(h<f._getHighestValue())){if(!b(this).hasClass("covered")){b(this).addClass("covered")
}}else{b(this).removeClass("covered")
}}else{if(h<f._getHighestValue()){if(!b(this).hasClass("covered")){b(this).addClass("covered")
}}else{b(this).removeClass("covered")
}}})
},_getValueFromCoord:function(g,f,p){var l=this;
var n,j,q;
var h=l.$element.offset();
if(l.options.orientation==="vertical"){var m=l.$element.height();
n=((h.top+m)-f)/m
}else{var o=l.$element.width();
n=((g-h.left)/o)
}if(p&&(n<0||n>1)){return NaN
}var k=l.options.min*1+((l.options.max-l.options.min)*n);
if(k>=l.options.max){return l.options.max
}if(k<=l.options.min){return l.options.min
}q=((k-l.options.min)%l.options.step);
if(Math.abs(q)*2>=l.options.step){j=(k-q)+(l.options.step*1)
}else{j=k-q
}return j
},_getHighestValue:function(){return Math.max.apply(null,this.values)
},_getLowestValue:function(){return Math.min.apply(null,this.values)
}});
CUI.Widget.registry.register("slider",CUI.Slider);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){CUI.Slider.init(b(".slider[data-init~='slider']",f.target))
})
}}(jQuery,this));
(function(j){var h=0;
CUI.Datepicker=new Class({toString:"Datepicker",extend:CUI.Widget,defaults:{monthNames:null,dayNames:null,format:null,type:"date",selectedDateTime:null,startDay:0,disabled:false,displayedFormat:null,storedFormat:null,headFormat:"MMMM YYYY",forceHTMLMode:false,required:false,hasError:false,minDate:null,maxDate:null},displayDateTime:null,pickerShown:false,construct:function(){this.guid=(h+=1);
this._readOptionsFromMarkup();
this._parseOptions();
this._setupMomentJS();
this._adjustMarkup();
this._findElements();
this._constructPopover();
this._initialize()
},_readOptionsFromMarkup:function(){var G=this.options;
var H=this.$element;
if(H.hasClass("error")){G.hasError=true
}var I=j(H.find("input").filter("[type^=date],[type=time]"));
if(I.length!==0){G.type=I.attr("type")
}[["disabled","disabled",a],["required","required",a],["displayed-format","displayedFormat",u],["stored-format","storedFormat",u],["force-html-mode","forceHTMLMode",u],["day-names","dayNames",C],["month-names","monthNames",C],["head-format","headFormat",C],["start-day","startDay",r],["min-date","minDate",u],["max-date","maxDate",u]].map(function(J){var K=J[0],M=J[1],L=J[2];
L(H.data(K),M,G)
})
},_parseOptions:function(){var G=this.options;
G.monthNames=G.monthNames||CUI.Datepicker.monthNames;
G.dayNames=G.dayNames||CUI.Datepicker.dayNames;
G.isDateEnabled=(G.type==="date")||(G.type==="datetime")||(G.type==="datetime-local");
G.isTimeEnabled=(G.type==="time")||(G.type==="datetime")||(G.type==="datetime-local");
var H=document.createElement("input");
H.setAttribute("type",G.type);
G.supportsInputType=H.type!=="text";
if(G.minDate!==null){if(G.minDate==="today"){G.minDate=moment().startOf("day")
}else{if(moment(G.minDate,E).isValid()){G.minDate=moment(G.minDate,E)
}else{G.minDate=null
}}}if(G.maxDate!==null){if(G.maxDate==="today"){G.maxDate=moment().startOf("day")
}else{if(moment(G.maxDate,E).isValid()){G.maxDate=moment(G.maxDate,E)
}else{G.maxDate=null
}}}G.storedFormat=G.storedFormat||(G.type==="time"?g:D);
G.displayedFormat=G.displayedFormat||(G.type==="time"?g:b);
G.useNativeControls=G.forceHTMLMode;
if((!G.forceHTMLMode)&&f&&G.supportsInputType){G.useNativeControls=true
}if(G.useNativeControls){if(G.type==="date"){G.displayedFormat=E
}else{if(G.type==="time"){G.displayedFormat=g
}else{G.displayedFormat=D
}}}},_setupMomentJS:function(){this.options.language=w+new Date().getTime();
moment.lang(this.options.language,{months:this.options.monthNames,weekdaysMin:this.options.dayNames})
},_adjustMarkup:function(){var G=this.$element;
G.addClass("datepicker");
if(!this.options.useNativeControls){if(G.find("input").not("[type=hidden]").length===0){G.append(s)
}if(G.find("button").length===0){G.append(o)
}var L="popguid"+this.guid;
var H="#"+L+".popover";
this.$popover=j("body").find(H);
if(this.$popover.length===0){j("body").append(z.replace("%ID%",L));
this.$popover=j("body").find(H);
if(this.options.isDateEnabled){this.$popover.find(".inner").append(l)
}}}else{this.$popover=[]
}if(G.find("input[type=hidden]").length===0){G.append('<input type="hidden">')
}if(!G.find("input[type=hidden]").attr("name")){var I=G.find("input").not("[type=hidden]").attr("name");
G.find("input[type=hidden]").attr("name",I);
G.find("input").not("[type=hidden]").removeAttr("name")
}var J=G.find(">button");
if(J.length&&J.attr("type")===undefined){try{J.attr("type","button")
}catch(K){}}},_findElements:function(){this.$input=this.$element.find("input").not("[type=hidden]");
this.$hiddenInput=this.$element.find("input[type=hidden]");
this.$openButton=this.$element.find("button")
},_constructPopover:function(){if(this.$popover.length){this.popover=new F({$element:this.$popover,$trigger:this.$openButton,options:this.options,setDateTimeCallback:this._popoverSetDateTimeCallback.bind(this),hideCallback:this._popoverHideCallback.bind(this)})
}},_initialize:function(){if(this.options.useNativeControls){this.displayDateTime=this.options.selectedDateTime=moment(this.$input.val(),this.options.displayedFormat)
}else{this._switchInputTypeToText(this.$input)
}if(!this.options.disabled){this.$openButton.on("click",this._clickHandler.bind(this));
this.$input.on("change"+(f?" blur":""),this._inputChangedHandler.bind(this))
}if(!this.options.selectedDateTime){this._readInputVal([this.options.storedFormat,this.options.displayedFormat])
}this._setDateTime(this.options.selectedDateTime,true)
},_readInputVal:function(I){var H=this.$input.eq(0).val();
if(H!==""){var G=moment(H,I||this.options.displayedFormat);
if(!G||!G.isValid()){G=moment(H)
}this.displayDateTime=this.options.selectedDateTime=G;
if(G!==null&&G.isValid()){this.displayDateTime=this.options.selectedDateTime=G
}}else{this.displayDateTime=null
}},_updateState:function(){if(this.options.disabled){this.$element.find("input,button").attr("disabled","disabled");
this._hidePicker()
}else{this.$element.find("input,button").removeAttr("disabled")
}if(this.options.hasError||(!this.options.selectedDateTime&&this.options.required)||(this.options.selectedDateTime&&!this.options.selectedDateTime.isValid())){this.$element.addClass("error")
}else{this.$element.removeClass("error")
}},_popoverSetDateTimeCallback:function(){this._setDateTime.apply(this,arguments);
if(this.options.isTimeEnabled===false){this._hidePicker()
}},_popoverHideCallback:function(){this.pickerShown=false
},_switchInputTypeToText:function(H){var G=H.detach().attr("type","text");
this.$element.prepend(G)
},_openNativeInput:function(){this.$input.trigger("tap")
},_clickHandler:function(H){if(this.pickerShown){this._hidePicker()
}else{var G=this;
setTimeout(function(){G._openPicker()
},100)
}},_inputChangedHandler:function(){if(this.options.disabled){return
}var G;
if(this.$input.val()!==""){G=moment(this.$input.val(),this.options.displayedFormat);
this.options.hasError=G!==null&&!B(G,this.options.minDate,this.options.maxDate)
}else{this.options.hasError=false
}this._setDateTime(G,true)
},_keyPress:function(){if(this.pickerShown){}},_openPicker:function(){if(this.options.useNativeControls){this._openNativeInput()
}else{this._readInputVal();
this._showPicker()
}},_showPicker:function(){if(!this.pickerShown){this.$element.addClass("focus");
this.popover.show(this.displayDateTime);
this.pickerShown=true
}},_hidePicker:function(){if(this.pickerShown){this.$element.removeClass("focus");
this.popover.hide();
this.pickerShown=false
}},_setDateTime:function(H,G){this.options.selectedDateTime=this.displayDateTime=H;
if(!H){this.$input.val("")
}else{if(H.isValid()){this.$input.val(H.lang(this.options.language).format(this.options.displayedFormat))
}}var I=(H&&H.isValid())?H.lang("en").format(this.options.storedFormat):"";
this.$hiddenInput.val(I);
this._updateState();
if(!G){this.$input.trigger("change")
}this.$hiddenInput.trigger("change")
}});
CUI.Datepicker.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];
CUI.Datepicker.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"];
CUI.Widget.registry.register("datepicker",CUI.Datepicker);
if(CUI.options.dataAPI){j(document).on("cui-contentloaded.data-api",function(G){CUI.Datepicker.init(j("[data-init~=datepicker]",G.target))
})
}var F=new Class({toString:"Popover",extend:Object,construct:function(G){this.$element=G.$element;
this.options=G.options;
this.setDateTimeCallback=G.setDateTimeCallback;
this.hideCallback=G.hideCallback;
this.$element.popover();
this.popover=this.$element.data("popover");
this.popover.set({pointAt:G.$trigger,pointFrom:"bottom"});
this._setupListeners()
},show:function(G){this.displayDateTime=G;
this._renderCalendar();
if(this.options.isTimeEnabled){this._renderTime()
}this.popover.show()
},hide:function(){this.popover.hide()
},_setupListeners:function(){this.popover.on("hide",this._popupHideHandler.bind(this));
this.$element.find(".calendar").on("swipe",this._swipeHandler.bind(this));
this.$element.on("mousedown",".next-month",this._mouseDownNextHandler.bind(this));
this.$element.on("mousedown",".prev-month",this._mouseDownPrevHandler.bind(this));
if(this.options.isTimeEnabled){this.$element.on("selected",".hour,.minute",this._dropdownChangedHandler.bind(this));
this.$element.on("change",".hour,.minute",this._dropdownChangedHandler.bind(this))
}},_popupHideHandler:function(G){this.hideCallback()
},_swipeHandler:function(H){var J=H.direction,G=this.displayDateTime.year(),I=this.displayDateTime.month();
if(J==="left"){this.displayDateTime=k(moment([G,I+1,1]));
this._renderCalendar("left")
}else{if(J==="right"){this.displayDateTime=k(moment([G,I-1,1]));
this._renderCalendar("right")
}}},_mouseDownNextHandler:function(G){G.preventDefault();
if(this.displayDateTime){this.displayDateTime=k(moment([this.displayDateTime.year(),this.displayDateTime.month()+1,1]));
this._renderCalendar("left")
}},_mouseDownPrevHandler:function(G){G.preventDefault();
if(this.displayDateTime){this.displayDateTime=k(moment([this.displayDateTime.year(),this.displayDateTime.month()-1,1]));
this._renderCalendar("right")
}},_dropdownChangedHandler:function(){var G=this._getHoursFromDropdown();
var I=this._getMinutesFromDropdown();
if(!this.options.selectedDateTime){this.options.selectedDateTime=moment()
}var H=this.options.selectedDateTime.hours(G).minutes(I);
this.setDateTimeCallback(H)
},_tableMouseDownHandler:function(J){J.preventDefault();
var H=moment(j(J.target).data("date"),D);
if(this.options.isTimeEnabled){var I=this._getHoursFromDropdown();
var G=this._getMinutesFromDropdown();
H.hours(I).minutes(G)
}this.setDateTimeCallback(H);
this._renderCalendar()
},_renderCalendar:function(G){var I=this.displayDateTime;
if(!I||!I.isValid()){this.displayDateTime=I=moment()
}var H=I.year();
var J=I.month()+1;
var L=this._renderOneCalendar(J,H);
var K=this.$element.find(".calendar");
L.on("mousedown","a",this._tableMouseDownHandler.bind(this));
if(K.find("table").length>0&&G){this._slideCalendar(L,(G==="left"))
}else{K.find("table").remove();
K.find(".sliding-container").remove();
K.find(".calendar-body").append(L)
}},_renderOneCalendar:function(W,N){var I=moment([N,W-1,1]).lang(this.options.language).format(this.options.headFormat);
var Y=j('<div class="calendar-header"><h2>'+I+"</h2></div>").append(j('<button class="next-month">›</button>')).append(j('<button class="prev-month">‹</button>'));
var T=this.$element.find(".calendar");
var P=T.find(".calendar-header");
if(P.length>0){P.replaceWith(Y)
}else{T.prepend(Y)
}var S=j("<table>");
S.data("date",N+"/"+W);
var M="<tr>";
var O=null;
for(var Q=0;
Q<7;
Q++){O=(Q+this.options.startDay)%7;
var R=this.options.dayNames[O];
M+="<th><span>"+R+"</span></th>"
}M+="</tr>";
S.append("<thead>"+M+"</thead>");
var X=moment([N,W-1,1]);
var H=(X.day()-this.options.startDay)%7;
if(H<0){H+=7
}M="";
var U=moment();
for(var L=0;
L<6;
L++){M+="<tr>";
for(var V=0;
V<7;
V++){O=(L*7+V)-H+1;
var G=moment([N,W-1,O]);
var J=(G.month()+1)===parseFloat(W);
var K="";
if(m(G,U)){K+=" today"
}if(m(G,this.options.selectedDateTime)){K+=" selected"
}if(J&&B(G,this.options.minDate,this.options.maxDate)){M+='<td class="'+K+'"><a href="#" data-date="'+G.lang(this.options.language).format(D)+'">'+G.date()+"</a></td>"
}else{M+='<td class="'+K+'"><span>'+G.date()+"</span></td>"
}}M+="</tr>"
}S.append("<tbody>"+M+"</tbody>");
return S
},_slideCalendar:function(I,L){this.$element.find(".sliding-container table").stop(true,true);
this.$element.find(".sliding-container").remove();
var K=this.$element.find("table");
var J=K.width();
var G=K.height();
var H=j('<div class="sliding-container">');
H.css({display:"block",position:"relative",width:J+"px",height:G+"px",overflow:"hidden"});
this.$element.find(".calendar-body").append(H);
H.append(K).append(I);
K.css({position:"absolute",left:0,top:0});
K.after(I);
I.css({position:"absolute",left:(L)?J:-J,top:0});
K.animate({left:(L)?-J:J},v,function(){K.remove()
});
I.animate({left:0},v,function(){if(H.parents().length===0){return
}I.css({position:"relative",left:0,top:0});
I.detach();
this.$element.find(".calendar-body").append(I);
H.remove()
}.bind(this))
},_renderTime:function(){var M=this.options.selectedDateTime;
var K=j(q);
var N=j("<select></select>");
for(var J=0;
J<24;
J++){var I=j("<option>"+n(J)+"</option>");
if(M&&J===M.hours()){I.attr("selected","selected")
}N.append(I)
}var G=j(t).append(N);
var O=j("<select></select>");
for(var H=0;
H<60;
H++){var L=j("<option>"+n(H)+"</option>");
if(M&&H===M.minutes()){L.attr("selected","selected")
}O.append(L)
}var P=j(A).append(O);
j(G).css(p);
j(G).find("select").css(d);
j(P).css(p);
j(P).find("select").css(d);
K.append(G,j("<span>:</span>"),P);
if(this.$element.find(".time").length===0){this.$element.find(".inner").append(K)
}else{this.$element.find(".time").empty().append(K.children())
}j(G).select();
j(P).select()
},_getHoursFromDropdown:function(){return parseInt(this.$element.find(".time .hour select").val(),10)
},_getMinutesFromDropdown:function(){return parseInt(this.$element.find(".time .minute select").val(),10)
}});
function n(G){if(G<10){return"0"+G
}return G
}function u(H,I,G){if(H!==undefined){G[I]=H
}}function a(H,I,G){G[I]=H?true:false
}function C(H,I,G){G[I]=H||G[I]
}function r(H,I,G){if(H!==undefined){G[I]=H*1
}}function k(G){if(!G){return null
}return moment([G.year(),G.month(),G.date()])
}function B(H,G,I){if(G===null&&I===null){return true
}if(G===null){return H<=I
}else{if(I===null){return H>=G
}else{return(G<=H&&H<=I)
}}}function m(H,G){if(H&&G){return H.year()===G.year()&&H.month()===G.month()&&H.date()===G.date()
}}var f=navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i),E="YYYY-MM-DD",g="HH:mm",D="YYYY-MM-DD[T]HH:mmZ",b="YYYY-MM-DD HH:mm",w="coralui_",s='<input type="text">',o='<button class="icon-calendar small"><span>Datepicker</span></button>',l=['<div class="calendar">','<div class="calendar-header"></div>','<div class="calendar-body"></div>',"</div>"].join(""),z=['<div class="datepicker popover" style="display:none" id="%ID%">','<div class="inner"></div>',"</div>"].join(""),q="<div class='time'><i class='icon-clock small'></i></div>",t='<div class="select hour"><button></button></div>',A='<div class="select minute"><button>Single Select</button></div>',p={position:"relative"},d={position:"absolute",left:"1.5rem",top:"1rem"},v=400
}(window.jQuery));
(function(a){CUI.Pulldown=new Class({toString:"Pulldown",extend:CUI.Widget,defaults:{pulldownSize:0},timeout:null,popoverShown:false,construct:function(d){this._readDataFromMarkup();
var b=this.$element.find("a").first();
var f=this.$element.find(".popover").first();
b.on("click",function(g){g.preventDefault();
this.togglePopover();
this._keepFocus()
}.bind(this));
f.on("click",function(){this._keepFocus()
}.bind(this));
b.on("blur",function(){this.timeout=setTimeout(function(){this.timeout=null;
this.hidePopover()
}.bind(this),200)
}.bind(this));
f.fipo("tap","click","ul > li > a",function(){var g=this;
setTimeout(function(){g.hidePopover()
},500)
}.bind(this))
},_readDataFromMarkup:function(){if(this.$element.data("pulldownSize")){this.options.pulldownSize=this.$element.data("pulldownSize")*1
}},_keepFocus:function(){var b=this.$element.find("a").first();
if(!b.is(".disabled, [disabled]")){clearTimeout(this.timeout);
this.timeout=null;
b.focus()
}},togglePopover:function(){if(this.popoverShown){this.hidePopover()
}else{if(!this.$element.find("a").first().is(".disabled, [disabled]")){this.showPopover()
}}},showPopover:function(){this._placePopover();
this.$element.find(".popover").show();
this.popoverShown=true
},hidePopover:function(){this.$element.find(".popover").hide();
this.popoverShown=false
},setDisabled:function(b){if(b===true){this.$element.find("a").first().addClass("disabled");
this.hidePopover()
}else{this.$element.find("a").first().removeClass("disabled")
}},_placePopover:function(){var k=this.$element.find("a").first(),f=this.$element.find(".popover"),h=k.position(),l,b,d;
var m=Math.max(k.width()+22,f.width());
var n={width:m,height:k.height()};
if(f.hasClass("alignleft")){l=h.top+n.height;
b=-30;
d=30-m
}else{l=h.top+n.height+15;
b=h.left+k.width()-n.width+5;
d=n.width-30
}f.css({top:l,left:b,width:n.width});
var g=f.find("ul").first();
if(this.options.pulldownSize>0){var j=0;
g.find("li:lt("+this.options.pulldownSize+")").each(function(){j+=a(this).outerHeight()+a(this).find("a").first().outerHeight()
});
g.css("max-height",j)
}}});
CUI.Widget.registry.register("pulldown",CUI.Pulldown);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Pulldown.init(a("[data-init~=pulldown]",b.target))
})
}}(window.jQuery));
(function(a){CUI.Wizard=new Class({toString:"Wizard",extend:CUI.Widget,construct:function(b){this.$nav=this.$element.find("nav").first();
this.$back=this.$nav.find("button").first();
this.$next=this.$nav.find("button").last();
this.$pageOverview=this.$nav.find("ol").last();
if(this.$element.data("hide-steps")===true){this.$pageOverview.addClass("hidden")
}if(this.$back.attr("type")===undefined){this.$back[0].setAttribute("type","button")
}if(this.$next.attr("type")===undefined){this.$next[0].setAttribute("type","button")
}this.$nav.addClass("toolbar");
this.$back.addClass("left");
this.$next.addClass("right");
this.$pageOverview.addClass("center");
this.$nav.find("li").first().append('<div class="lead-fill"></div>');
this.$next.click(this._onNextClick.bind(this));
this.$back.click(this._onBackClick.bind(this));
this._updateDefault();
setTimeout(function(){this.changePage(1)
}.bind(this),1)
},defaults:{nextDisabled:false,backDisabled:false,nextLabel:"next",backLabel:"back",onPageChanged:null,onFinish:null,onLeaving:null,onNextButtonClick:null,onBackButtonClick:null},changePage:function(b){if(b<1||b>this.$nav.find("li").length){return
}this.pageNumber=b;
var f=this.pageNumber-1;
var d=this.getCurrentPage();
this.$nav.find("li").removeClass("stepped");
this.$nav.find("li:lt("+f+")").addClass("stepped");
this.$nav.find("li.active").removeClass("active");
this.$nav.find("li:eq("+f+")").addClass("active");
this.$element.find(">section.active").removeClass("active");
this.$element.find(">section:eq("+f+")").addClass("active");
this._updateButtons();
this._fireCallback("onPageChanged");
if(typeof this.options.onPageChanged==="object"&&this._dataExists(d,"wizardPageCallback")&&typeof this.options.onPageChanged[d.data("wizardPageCallback")]==="function"){this.options.onPageChanged[d.data("wizardPageCallback")](d)
}},getCurrentPageNumber:function(){return this.pageNumber
},getCurrentPage:function(){return this.getPage(this.pageNumber)
},getPage:function(b){return this.$element.find(">section:eq("+(parseFloat(b)-1)+")")
},getPageNav:function(b){return this.$element.find(">nav li:eq("+(parseFloat(b)-1)+")")
},setNextButtonLabel:function(b){this.$next.text(b)
},setBackButtonLabel:function(b){this.$back.text(b)
},setNextButtonDisabled:function(b){this.$next.attr("disabled",b)
},setBackButtonDisabled:function(b){this.$back.attr("disabled",b)
},activatePage:function(b){this.getPage(b).removeClass("wizard-hidden-step");
this.getPageNav(b).removeClass("wizard-hidden-step")
},deactivatePage:function(b){this.getPage(b).addClass("wizard-hidden-step");
this.getPageNav(b).addClass("wizard-hidden-step")
},_onNextClick:function(f){var d=this._fireCallback("onNextButtonClick");
if(d===false){return
}var b=this._getNextPageNumber();
if(b!=null){this.changePage(b)
}else{this._fireCallback("onFinish")
}},_onBackClick:function(f){var d=this._fireCallback("onBackButtonClick");
if(d===false){return
}var b=this._getPreviousPageNumber();
if(b!=null){this.changePage(b)
}else{this._fireCallback("onLeaving")
}},_getNextPageNumber:function(){var b=this.getCurrentPageNumber();
return this._getRelativeNextPageNumber(b)
},_getRelativeNextPageNumber:function(b){if(b<this.$nav.find("li").length){var f=b+1;
var d=this.getPage(f);
if(a(d).hasClass("wizard-hidden-step")){return this._getRelativeNextPageNumber(f)
}else{return f
}}else{return null
}},_getPreviousPageNumber:function(){var b=this.getCurrentPageNumber();
return this._getRelativePreviousPageNumber(b)
},_getRelativePreviousPageNumber:function(b){if(b>1){var f=b-1;
var d=this.getPage(f);
if(a(d).hasClass("wizard-hidden-step")){return this._getRelativePreviousPageNumber(f)
}else{return f
}return b-1
}else{return null
}},_updateButtons:function(){var b=this.getCurrentPage();
this.setNextButtonLabel((this._dataExists(b,"nextLabel"))?b.data("nextLabel"):this.options.nextLabel);
this.setBackButtonLabel((this._dataExists(b,"backLabel"))?b.data("backLabel"):this.options.backLabel);
this.setNextButtonDisabled((this._dataExists(b,"nextDisabled"))?b.data("nextDisabled"):this.options.nextDisabled);
this.setBackButtonDisabled((this._dataExists(b,"backDisabled"))?b.data("backDisabled"):this.options.backDisabled)
},_fireCallback:function(b){if(typeof this.options[b]==="function"){return this.options[b]()
}return undefined
},_dataExists:function(b,d){return b.data(d)!==undefined
},_updateDefault:function(){this.options.nextDisabled=this.$next.is("[disabled]");
this.options.backDisabled=this.$back.is("[disabled]");
this.options.nextLabel=this.$next.text();
this.options.backLabel=this.$back.text()
}});
CUI.util.plugClass(CUI.Wizard);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~=wizard]",b.target).wizard()
})
}}(window.jQuery));
(function(d){function b(n){return n.filter("[data-action=prev], [data-action=cancel]").first().addClass("hidden").clone(true).addClass("left").each(a)
}function j(n){return n.filter("[data-action=next]").first().addClass("hidden").clone(true).addClass("primary right").each(a)
}function f(n){return n.filter("[data-action=cancel]").first().clone(true).addClass("quiet right").each(a)
}function a(n,o){d(o).removeClass("hidden").not("button").toggleClass("button",true)
}function l(o){var q=o.children(".step");
var p=o.children(".toolbar");
if(p.length===0){o.prepend(function(){p=d('<nav class="toolbar"><ol class="center"></ol></nav>');
var r=p.children("ol");
q.map(function(){return d("<li />").text(d(this).data("stepTitle")||this.title).get(0)
}).appendTo(r);
return p
})
}p.toggleClass("theme-dark",true);
p.find("> ol > li").first().addClass("active");
var n=q.first().find(".flexwizard-control");
p.prepend(function(){return b(n)
}).append(function(){return j(n).add(f(n).toggleClass("hidden",true))
})
}function g(r,q,o){var n=d("<li />").text(q.data("stepTitle")||q.attr("title"));
var p=r.children(".step").index(o);
r.find("> .toolbar > ol > li").eq(p).after(n);
o.after(q)
}function h(n){if(n.length===0){return
}n.addClass("active").removeClass("stepped");
n.prevAll("li").addClass("stepped").removeClass("active");
n.nextAll("li").removeClass("active stepped")
}function m(n,p,o){if(p.length===0){return
}if(o){o.removeClass("active")
}p.toggleClass("active",true);
n.trigger("flexwizard-stepchange",[p,o])
}function k(r,q){var s=r.children("nav");
var u=r.children(".step.active");
var n=s.children("ol").children("li.active");
var t,o;
switch(q){case"prev":t=u.prev(".step");
o=n.prev("li");
break;
case"next":t=u.next(".step");
o=n.next("li");
break;
case"cancel":return
}if(t.length===0){return
}var p=t.find(".flexwizard-control");
b(p).replaceAll(s.children(".left"));
j(p).replaceAll(s.children(".right:not([data-action=cancel])"));
s.children(".right[data-action=cancel]").toggleClass("hidden",t.prev(".step").length===0);
h(o);
m(r,t,u)
}CUI.FlexWizard=new Class({toString:"FlexWizard",extend:CUI.Widget,construct:function(n){var o=this.$element;
l(o);
o.on("click",".flexwizard-control",function(p){k(o,d(this).data("action"))
});
m(o,o.children(".step").first())
},prevStep:function(){k(this.$element,"prev")
},nextStep:function(){k(this.$element,"next")
},add:function(o,n){var p=this.$element;
if(n===undefined){this.addAfter(o,p.children(".step").last());
return
}if(!o.jquery){o=d(o)
}o.toggleClass("step",true);
g(p,o,p.children(".step").eq(n))
},addAfter:function(o,n){var p=this.$element;
if(!o.jquery){o=d(o)
}if(!n.jquery){n=d(n)
}o.toggleClass("step",true);
g(p,o,n)
},remove:function(o){var p=this.$element;
if(!o.jquery){o=d(o)
}var n=p.children(".step").index(o);
p.find("> .toolbar > ol > li").eq(n).remove();
o.remove()
}});
CUI.Widget.registry.register("flexwizard",CUI.FlexWizard);
CUI.util.plugClass(CUI.FlexWizard);
if(CUI.options.dataAPI){d(document).on("cui-contentloaded.data-api",function(n){CUI.FlexWizard.init(d("[data-init~=flexwizard]",n.target))
})
}}(window.jQuery));
(function(a){CUI.Sticky=new Class({toString:"Sticky",extend:CUI.Widget,construct:function(b){this.$element.addClass("sticky");
this.wrapper=a("<div>").addClass("sticky-wrapper");
this.$element.wrapAll(this.wrapper);
this.wrapper=this.$element.parent();
this.wrapper.height(this.$element.outerHeight(true));
this.scrollingElement=this.$element.parents(".sticky-container");
if(this.scrollingElement.length===0){this.scrollingElement=a(document);
this.pageScroll=true
}this.scrollingElement.on("scroll",this._fixElementPosition.bind(this));
a(window).on("resize",this._fixElementPosition.bind(this))
},_fixElementPosition:function(){var j=this.wrapper.offset().top;
var d=(this.pageScroll)?this.scrollingElement.scrollTop():this.scrollingElement.offset().top;
var g=this._getStickPosition();
var h=this.wrapper.position().left;
var f=this.wrapper.width();
if((j-g)<d){if(!this.pageScroll){var b=this.scrollingElement.position();
g+=b.top;
h+=b.left;
this.$element.detach();
this.scrollingElement.after(this.$element)
}this.$element.css({position:(this.pageScroll)?"fixed":"absolute",top:g+"px",left:h,width:f+"px"})
}else{if(!this.pageScroll){this.$element.detach();
this.wrapper.append(this.$element)
}this.$element.css({position:"",top:"",left:"",width:f+"px"})
}},_getStickPosition:function(){var d=this.wrapper.offset().top;
var b=0;
this.scrollingElement.find(".sticky-wrapper").each(function(f,g){if(a(g).offset().top<d){b+=a(g).outerHeight(true)
}}.bind(this));
return b
},scrollingElement:null,pageScroll:false,wrapper:null});
CUI.Widget.registry.register("sticky",CUI.Sticky);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Sticky.init(a(".sticky,[data-init=sticky]",b.target))
})
}}(window.jQuery));
(function(j){var h="grid";
var t="list";
var n="single";
var m="multiple";
var b={itemSelector:"article",headerSelector:"header",dataContainer:"grid-0",enableImageMultiply:true,view:{selectedItem:{list:{cls:"selected"},grid:{cls:"selected"}},selectedItems:{list:{selector:"article.selected"},grid:{selector:"article.selected"}}},controller:{selectElement:{list:"article > i.select",grid:"article"},moveHandleElement:{list:"article > i.move"},targetToItem:{list:function(u){return u.closest("article")
},grid:function(u){return u.closest("article")
},header:function(u){return u.closest("header")
}},gridSelect:{cls:"selection-mode"},selectAll:{selector:"header > i.select",cls:"selected"},sort:{columnSelector:".label > *"}}};
var k=function(u){if(u.jquery){return u.data("cardView-item")
}return u
};
var o={equals:function(u,v){return(u.length===v.length)&&(u.length===u.filter(v).length)
},getWidget:function(u){var v;
if(u.length>0){v=j(u[0]).data("cardView")
}return v
},mixObjects:function(z,w){if(z===undefined){return w
}var u={};
for(var v in w){if(z[v]===undefined){u[v]=w[v];
continue
}var A=z[v];
if(typeof(z[v])=="object"&&(!(z[v] instanceof String))){A=this.mixObjects(z[v],w[v])
}u[v]=A
}return u
},resolve:function(v,w){var u=[];
v.each(function(){u.push.apply(u,w(j(this)).toArray())
});
return j(u)
},multiplyImages:function(w,v){w=w.filter(function(){var C=j(this);
return !C.is(".multiplied")&&!C.prev().is(".multiplied")&&C.is(":visible")
});
var B=w.length;
var z=0;
function u(){if(z<B){A(w[z]);
z++;
setTimeout(u,0)
}}function A(H){var D=H.naturalWidth,K=H.naturalHeight;
if((D===0)&&(K===0)){window.setTimeout(function(){A(H)
},200);
return
}var F=j("<canvas width='"+D+"' height='"+K+"'></canvas>")[0];
var E=F.getContext("2d");
E.drawImage(H,0,0,D,K);
var C=E.getImageData(0,0,D,K);
var I=C.data;
for(var J=0,G=I.length;
J<G;
J+=4){I[J]*=v[0];
I[J+1]*=v[1];
I[J+2]*=v[2]
}E.putImageData(C,0,0);
j("<img class='"+H.className+" multiplied' width='"+D+"' height='"+K+"' src='"+F.toDataURL("image/png")+"'/>").insertBefore(H)
}u()
}};
var f=new Class({$el:null,$containerEl:null,stepSize:0,iid:undefined,autoMoveOffset:0,maxScrollTop:0,construct:function(w,v,z){this.$el=w;
this.stepSize=v;
this.$containerEl=this._getScrollingContainer(w);
var u=this.$containerEl[0];
this.maxScrollTop=Math.max(u.scrollHeight-u.clientHeight,0);
this.autoMoveFn=z
},_getScrollingContainer:function(u){while((u.length>0)&&!u.is("body")){var v=u.css("overflowY");
var w=u.css("position");
if(((v==="auto")||(v==="visible"))&&(w==="absolute")){return u
}u=u.parent()
}return j(window)
},_execute:function(){var v=this.$containerEl[0];
var z=v.clientHeight;
var B=v.scrollTop;
var A=this.$el.offset().top-this.$containerEl.offset().top;
var w=A+this.$el.height();
var u=false;
if(A<=0){if(B>0){B-=this.stepSize;
this.autoMoveOffset=-this.stepSize;
if(B<0){B=0
}v.scrollTop=B;
u=true
}}else{if(w>=z){if(B<this.maxScrollTop){B+=this.stepSize;
this.autoMoveOffset=this.stepSize;
if(B>this.maxScrollTop){B=this.maxScrollTop
}v.scrollTop=B;
u=true
}}}return u
},_autoMove:function(){if(this.autoMoveOffset&&this.autoMoveFn){var u=this.$el.offset();
var v=u.top+this.autoMoveOffset;
this.autoMoveFn(u.left,v)
}},check:function(){var v=this;
this.stop();
var u=this._execute();
if(u){this.iid=window.setTimeout(function(){v.iid=undefined;
v._autoMove()
},50)
}},stop:function(){if(this.iid!==undefined){window.clearTimeout(this.iid);
this.autoMoveOffset=0;
this.iid=undefined
}}});
var p=new Class({$listEl:null,$itemEl:null,$items:null,$doc:null,$oldBefore:null,dragCls:null,fixHorizontalPosition:false,autoScroller:null,construct:function(v){var u=this;
this.$listEl=v.$listEl;
this.$itemEl=v.$itemEl;
this.$items=v.$items;
this.dragCls=v.dragCls;
this.fixHorizontalPosition=(v.fixHorizontalPosition!==false);
this.autoScroller=(v.autoScrolling?new f(this.$itemEl,8,function(w,z){u._autoMove(w,z)
}):undefined)
},_getEventCoords:function(u){if(!u.originalEvent.touches){return{x:u.pageX,y:u.pageY}
}return(u.originalEvent.touches.length>0?{x:u.originalEvent.touches[0].pageX,y:u.originalEvent.touches[0].pageY}:u.originalEvent.changedTouches.length>0?{x:u.originalEvent.changedTouches[0].pageX,y:u.originalEvent.changedTouches[0].pageY}:{x:u.pageX,y:u.pageY})
},_limit:function(A,z){if(z<this.listOffset.left){z=this.listOffset.left
}if(A<this.listOffset.top){A=this.listOffset.top
}var w=z+this.size.width;
var u=A+this.size.height;
var v=this.listOffset.left+this.listSize.width;
var B=this.listOffset-A+this.listSize.height;
if(w>v){z=v-this.size.width
}if(u>B){A=B-this.size.height
}if(this.fixHorizontalPosition){z=this.listOffset.left
}return{top:A,left:z}
},_getEventPos:function(v){var u=this._getEventCoords(v);
return{x:u.x-this.delta.left,y:u.y-this.delta.top}
},_adjustPosition:function(u,v){this.$itemEl.offset(this._limit(v,u));
if(this.autoScroller){this.autoScroller.check()
}},_changeOrderIfRequired:function(){var H=this.$itemEl.offset();
var E=H.left+(this.size.width/2);
var D=H.top+(this.size.height/2);
var A=null;
var B=false;
for(var w=0;
w<this.$items.length;
w++){var F=j(this.$items[w]);
if(!o.equals(F,this.$itemEl)){var C=F.offset();
var v=F.width();
var G=F.height();
var u=C.top+G;
if((E>=C.left)&&(E<C.left+v)&&(D>=C.top)&&(D<u)){B=((D-C.top)>(u-D));
A=F;
break
}}}if(A){var z=this.$itemEl.offset();
if(B){A.before(this.$itemEl)
}else{A.after(this.$itemEl)
}this.$itemEl.offset(z)
}},_autoMove:function(u,v){this._adjustPosition(u,v);
this._changeOrderIfRequired()
},start:function(w){this.$oldPrev=this.$itemEl.prev();
this.$oldNext=this.$itemEl.next();
var v=this._getEventCoords(w);
if(this.dragCls){this.$itemEl.addClass(this.dragCls)
}var u=this;
this.$doc=j(document);
this.$doc.fipo("touchmove.listview.drag","mousemove.listview.drag",function(z){u.move(z)
});
this.$doc.fipo("touchend.listview.drag","mouseup.listview.drag",function(z){u.end(z)
});
this.offset=this.$itemEl.offset();
this.delta={left:v.x-this.offset.left,top:v.y-this.offset.top};
this.size={width:this.$itemEl.width(),height:this.$itemEl.height()};
this.listOffset=this.$listEl.offset();
this.listSize={width:this.$listEl.width(),height:this.$listEl.height()};
w.stopPropagation();
w.preventDefault()
},move:function(u){var v=this._getEventPos(u);
this._adjustPosition(v.x,v.y);
this._changeOrderIfRequired();
u.stopPropagation();
u.preventDefault()
},end:function(w){var z=this._getEventPos(w);
this._adjustPosition(z.x,z.y);
if(this.dragCls){this.$itemEl.removeClass(this.dragCls)
}if(this.autoScroller){this.autoScroller.stop()
}this.$itemEl.css("position","");
this.$itemEl.css("top","");
this.$itemEl.css("left","");
this.$doc.off("touchmove.listview.drag");
this.$doc.off("mousemove.listview.drag");
this.$doc.off("touchend.listview.drag");
this.$doc.off("mouseup.listview.drag");
var v=this.$itemEl.prev();
var u=this.$itemEl.next();
this.$itemEl.trigger(j.Event("item-moved",{newPrev:v,newNext:u,oldPrev:this.$oldPrev,oldNext:this.$oldNext,hasMoved:!o.equals(v,this.$oldPrev)}));
w.stopPropagation();
w.preventDefault()
}});
var g=new Class({$itemEl:null,construct:function(u){this.$itemEl=u;
this.reference()
},getItemEl:function(){return this.$itemEl
},reference:function(){this.$itemEl.data("cardView-item",this)
}});
var r=new Class({$headerEl:null,itemRef:null,construct:function(v,u){this.$headerEl=v;
this.itemRef=u
},getHeaderEl:function(){return this.$headerEl
},getItemRef:function(){return this.itemRef
},setItemRef:function(u){this.itemRef=u
}});
var d=new Class({construct:function(v){this.model=v.model;
this.comparators=v.comparators;
this.selectors=v.selectors;
this.columnElement=v.columnElement;
this.headerElement=v.columnElement.closest(this.selectors.headerSelector);
var w=this.model.getHeaderForEl(this.headerElement);
this.items=this.model.getItemsForHeader(w);
this.isReverse=this.columnElement.hasClass("sort-asc");
this.toNatural=this.columnElement.hasClass("sort-desc");
this.fromNatural=!this.headerElement.hasClass("sort-mode");
this.comparator=null;
if(this.comparators){for(var u in this.comparators){if(!this.columnElement.is(u)){continue
}this.comparator=this.comparators[u]
}}if(!this.comparator){this.comparator=this._readComparatorFromMarkup()
}},_readComparatorFromMarkup:function(){var u=this.columnElement.data("sort-selector");
var w=this.columnElement.data("sort-attribute");
var z=this.columnElement.data("sort-type");
var v=this.columnElement.data("ignorecase");
if(!u&&!w){return null
}return new CUI.CardView.DefaultComparator(u,w,z,v)
},_adjustMarkup:function(){if(this.fromNatural){this.headerElement.addClass("sort-mode")
}if(this.toNatural){this.headerElement.removeClass("sort-mode")
}this.headerElement.find(this.selectors.controller.sort.columnSelector).removeClass("sort-asc sort-desc");
this.columnElement.removeClass("sort-desc sort-asc");
if(!this.toNatural){this.columnElement.addClass(this.isReverse?"sort-desc":"sort-asc")
}var u=this.toNatural;
j.each(this.items,function(){this.getItemEl().find(".move").toggle(u)
})
},sort:function(){if(!this.comparator&&!this.toNatural){return
}this._adjustMarkup();
var v=this.items.slice();
if(this.comparator){this.comparator.setReverse(this.isReverse);
var z=this.comparator.getCompareFn();
if(!this.toNatural){v.sort(z)
}}var u=this.headerElement;
j.each(this.items,function(){this.getItemEl().detach()
});
for(var w=0;
w<v.length;
w++){var A=v[w].getItemEl();
u.after(A);
u=A
}}});
var l=new Class({$el:null,items:null,headers:null,selectors:null,construct:function(G,F){this.$el=G;
this.items=[];
this.selectors=F;
var C=this.$el.find(F.itemSelector);
var A=C.length;
for(var w=0;
w<A;
w++){this.items.push(new g(j(C[w])))
}this.headers=[];
var D=this.$el.find(F.headerSelector);
var E=D.length;
for(var B=0;
B<E;
B++){var u=j(D[B]);
var v=u.nextAll(F.itemSelector);
var z=(v.length>0?this.getItemForEl(j(v[0])):undefined);
this.headers.push(new r(u,z))
}},initialize:function(){var u=this;
this.$el.on("item-moved",this.selectors.itemSelector,function(v){if(v.hasMoved){u._reorder(v)
}})
},_reorder:function(A){var D=this.getItemForEl(j(A.target));
var E=this.getItemForEl(A.newPrev);
var C=false;
var w;
if(!E){w=this.getHeaderForEl(A.newPrev);
if(w){C=true;
var u=this.getItemIndex(w.getItemRef());
if(u>0){E=this.getItemAt(u-1)
}}}var v=this.getItemIndex(D);
this.items.splice(v,1);
var B=this._getHeaderByItemRef(D);
if(B){B.setItemRef(this.getItemAt(v))
}var z=(E?this.getItemIndex(E)+1:0);
this.items.splice(z,0,D);
if(C){w.setItemRef(D)
}},getItemCount:function(){return this.items.length
},getItemAt:function(u){return this.items[u]
},getItemIndex:function(v){for(var u=0;
u<this.items.length;
u++){if(v===this.items[u]){return u
}}return -1
},getItemForEl:function(v){var z=this.items.length;
for(var u=0;
u<z;
u++){var w=this.items[u];
if(o.equals(w.getItemEl(),v)){return w
}}return undefined
},insertItemAt:function(B,C,u){if(!j.isArray(B)){B=B.toArray()
}for(var v=B.length-1;
v>=0;
v--){var E=B[v];
if(!E.jquery){E=j(E)
}var A;
var G=new g(E);
if((C===undefined)||(C===null)){this.items.push(G);
C=this.items.length-1
}else{A=this.items[C];
this.items.splice(C,0,G)
}var F={item:A,mode:"item"};
var D=this.headers.length;
for(var z=0;
z<D;
z++){var w=this.headers[z];
if(w.getItemRef()===A){if(u){F={item:w,mode:"header"};
break
}else{w.setItemRef(G)
}}}this.$el.trigger(j.Event("change:insertitem",{insertPoint:F,followupItem:A,item:G,pos:C,widget:o.getWidget(this.$el),moreItems:(v>0)}))
}},getHeaderCount:function(){return this.headers.length
},getHeaderAt:function(u){return this.headers[u]
},getHeaders:function(){var u=[];
u.push.apply(u,this.headers);
return u
},getHeaderForEl:function(v){var u=this.headers.length;
for(var w=0;
w<u;
w++){var z=this.headers[w];
if(o.equals(z.getHeaderEl(),v)){return z
}}return undefined
},_getHeaderByItemRef:function(u){for(var v=0;
v<this.headers.length;
v++){if(this.headers[v].getItemRef()===u){return this.headers[v]
}}return undefined
},getItemsForHeader:function(A){var C=A.getItemRef();
var D=this.headers.length;
var B=this.items.length;
var u=[];
var v=false;
for(var w=0;
w<B;
w++){var E=this.items[w];
if(v){for(var z=0;
z<D;
z++){if(this.headers[z].getItemRef()===E){v=false;
break
}}if(v){u.push(E)
}else{break
}}else{if(E===C){v=true;
u.push(C)
}}}return u
},fromItemElements:function(v){var u=[];
v.each(function(){var w=j(this).data("cardView-item");
if(w){u.push(w)
}});
return u
},reference:function(){var v=this.items.length;
for(var u=0;
u<v;
u++){this.items[u].reference()
}},removeAllItemsSilently:function(){this.items.length=0;
for(var u=0;
u<this.headers.length;
u++){this.headers[u].setItemRef(undefined)
}}});
var s=new Class({$el:null,selectors:null,construct:function(v,u){this.$el=v;
this.selectors=u
},initialize:function(){var u=this;
this.$el.on("change:displayMode",function(z){var v=z.oldValue;
var w=z.value;
u.cleanupAfterDisplayMode(v);
u.prepareDisplayMode(w)
});
this.$el.on("change:insertitem",function(v){u._onItemInserted(v)
});
this.$el.reflow({small:function(w,v){return w.width()>40*v.rem()&&w.width()<50*v.rem()
},xsmall:function(w,v){return w.width()>30*v.rem()&&w.width()<40*v.rem()
},xxsmall:function(w,v){return w.width()<30*v.rem()
}})
},_onItemInserted:function(C){var A=this.$el;
if(this.selectors.dataContainer){A=A.find("."+this.selectors.dataContainer)
}var u=C.item.getItemEl();
var D=C.followupItem;
switch(this.getDisplayMode()){case t:if(!D){A.append(u)
}else{var z=C.insertPoint;
var v=z.item;
var B=(z.mode==="item"?v.getItemEl():v.getHeaderEl());
B.before(u)
}break;
case h:if(!C.moreItems){var w=o.getWidget(this.$el);
w._restore();
w.layout()
}break
}},getDisplayMode:function(){return o.getWidget(this.$el).getDisplayMode()
},setSelectionState:function(w,v){var A=this.getDisplayMode();
var u=this.selectors.view.selectedItem[A];
var z=w.getItemEl();
if(u.selector){z=z.find(u.selector)
}if(v==="selected"){z.addClass(u.cls);
if(A===h){this._drawSelectedGrid(w)
}}else{if(v==="unselected"){z.removeClass(u.cls)
}}},getSelectionState:function(w){var u=this.selectors.view.selectedItem[this.getDisplayMode()];
var z=w.getItemEl();
if(u.selector){z=z.find(u.selector)
}var v=u.cls.split(" ");
for(var A=0;
A<v.length;
A++){if(!z.hasClass(v[A])){return"unselected"
}}return"selected"
},getSelectedItems:function(){var u=this.selectors.view.selectedItems[this.getDisplayMode()];
var v=this.$el.find(u.selector);
if(u.resolver){v=u.resolver(v)
}return v
},restore:function(C,u){var F=j("<div class='"+this.selectors.dataContainer+"'>");
this.$el.empty();
this.$el.append(F);
var z=C.getItemCount();
for(var v=0;
v<z;
v++){F.append(C.getItemAt(v).getItemEl())
}if(u){var E=C.getHeaderCount();
for(var B=0;
B<E;
B++){var A=C.getHeaderAt(B);
var D=A.getHeaderEl();
var w=A.getItemRef();
if(w){w.getItemEl().before(D)
}else{F.append(D)
}}}},prepareDisplayMode:function(u){if(u===h){this._drawAllSelectedGrid()
}},cleanupAfterDisplayMode:function(u){},_drawImage:function(v){if(v.length===0){return
}if(this._colorFloat===undefined){var u=v.closest("a, .card").css("background-color");
if(!u){return
}this._colorFloat=j.map(u.match(/(\d+)/g),function(w){return w/255
})
}o.multiplyImages(v,this._colorFloat)
},_drawAllSelectedGrid:function(){if(!this.selectors.enableImageMultiply){return
}var v=this;
var u=this.selectors.view.selectedItems.grid.selector+" img";
var w=j(u);
this._drawImage(w);
w.load(function(){v._drawImage(j(this))
})
},_drawSelectedGrid:function(w){if(!this.selectors.enableImageMultiply){return
}var u=this;
var v=w.getItemEl().find("img");
this._drawImage(v);
v.load(function(){u._drawImage(j(this))
})
},removeAllItemsSilently:function(){this.$el.find(this.selectors.itemSelector).remove()
}});
var q=new Class({$el:null,selectors:null,comparators:null,selectionModeCount:null,_listSelect:false,construct:function(w,v,u){this.$el=w;
this.selectors=v;
this.comparators=u;
this.selectionModeCount=m
},initialize:function(){this.setDisplayMode(this.$el.hasClass("list")?t:h);
var u=this;
this.$el.fipo("tap.cardview.select","click.cardview.select",this.selectors.controller.selectElement.list,function(A){var z=o.getWidget(u.$el);
if(z.getDisplayMode()===t){var w=k(u.getItemElFromEvent(A));
if(z.toggleSelection(w)){A.stopPropagation();
A.preventDefault()
}if(A.type==="tap"){u._listSelect=true
}}});
this.$el.fipo("tap.cardview.select","click.cardview.select",this.selectors.controller.selectElement.grid,function(A){var z=o.getWidget(u.$el);
if((z.getDisplayMode()===h)&&z.isGridSelectionMode()){var w=k(u.getItemElFromEvent(A));
if(z.toggleSelection(w)){A.stopPropagation();
A.preventDefault()
}}});
this.$el.fipo("tap.cardview.selectall","click.cardview.selectall",this.selectors.controller.selectAll.selector,function(B){var A=o.getWidget(u.$el);
if(A.getDisplayMode()===t){var w=u.selectors.controller.selectAll.cls;
var z=u.selectors.controller.targetToItem.header(j(B.target));
var C=A.getModel().getHeaderForEl(z);
if(z.hasClass(w)){A.deselectAll(C)
}else{A.selectAll(C)
}}});
this.$el.fipo("tap.cardview.sort","click.cardview.sort",this.selectors.headerSelector+" "+this.selectors.controller.sort.columnSelector,function(B){var A=o.getWidget(u.$el);
var w=A.getModel();
var z=j.Event("sortstart");
j(B.target).trigger(z);
if(z.isDefaultPrevented()){return
}var C=new d({model:w,columnElement:j(B.target),comparators:u.comparators,selectors:u.selectors});
C.sort();
z=j.Event("sortend");
j(B.target).trigger(z)
});
this.$el.on("selectstart.cardview",this.selectors.headerSelector+" "+this.selectors.controller.sort.columnSelector,function(w){w.preventDefault()
});
this.$el.finger("click.cardview.select",this.selectors.controller.selectElement.grid,function(A){var z=o.getWidget(u.$el);
var w=z.getDisplayMode();
if((w===h)&&z.isGridSelectionMode()){A.stopPropagation();
A.preventDefault()
}});
var v=this.selectors.controller.selectElement.listNavElement||this.selectors.controller.selectElement.grid;
this.$el.finger("click.cardview.select",v,function(A){var z=o.getWidget(u.$el);
var w=z.getDisplayMode();
if((w===t)&&u._listSelect){A.stopPropagation();
A.preventDefault()
}u._listSelect=false
});
this.$el.fipo("touchstart.cardview.reorder","mousedown.cardview.reorder",this.selectors.controller.moveHandleElement.list,function(A){var z=u.getItemElFromEvent(A);
var w=new p({$listEl:u.$el,$itemEl:z,$items:j(u.selectors.itemSelector),dragCls:"dragging",autoScrolling:true});
w.start(A)
});
this.$el.on("change:selection",function(w){if(w.moreSelectionChanges){return
}u._adjustSelectAllState(w.widget)
});
this.$el.on("change:insertitem",function(w){if(w.moreItems){return
}u._adjustSelectAllState(w.widget)
})
},_adjustSelectAllState:function(B){var v=this.selectors.controller.selectAll.cls;
var z=B.getHeaderSelectionState();
var C=z.headers;
var u=C.length;
for(var A=0;
A<u;
A++){var D=C[A];
var w=D.header.getHeaderEl();
if(D.hasUnselected){w.removeClass(v)
}else{w.addClass(v)
}}},getItemElFromEvent:function(v){var u=j(v.target);
var w=this.selectors.controller.targetToItem[this.getDisplayMode()];
if(j.isFunction(w)){return w(u)
}return u.find(w)
},isGridSelect:function(){var u=this.selectors.controller.gridSelect;
var v=this.$el;
if(u.selector){v=v.find(u.selector)
}return v.hasClass(u.cls)
},setGridSelect:function(v){if(this.isGridSelect()!==v){var u=this.selectors.controller.gridSelect;
var w=this.$el;
if(u.selector){w=w.find(u.selector)
}if(v){w.addClass(u.cls)
}else{w.removeClass(u.cls);
o.getWidget(w).clearSelection()
}this.$el.trigger(j.Event("change:gridSelect",{widget:this.$el.data("cardView"),oldValue:!v,value:v}))
}},getDisplayMode:function(){if(this.$el.hasClass("list")){return t
}if(this.$el.hasClass("grid")){return h
}return null
},isColumnSorted:function(){return(this.getDisplayMode()=="list")&&this.$el.find(this.selectors.headerSelector).filter(".sort-mode").length>0
},setDisplayMode:function(z){var u=this.getDisplayMode();
if(u!==z){var w=o.getWidget(this.$el);
w._restore(z===t);
switch(z){case h:this.$el.removeClass("list");
this.$el.addClass("grid");
if(u!==null){var v=w.getSelection();
this.setGridSelect(v.length>0);
w.layout()
}break;
case t:this.$el.cuigridlayout("destroy");
this.$el.removeClass("grid");
this.$el.addClass("list");
break
}this.$el.trigger(j.Event("change:displayMode",{widget:this.$el.data("cardView"),oldValue:u,value:z}))
}},getSelectionModeCount:function(){return this.selectionModeCount
},setSelectionModeCount:function(u){this.selectionModeCount=u
}});
var a=new Class({$el:null,selectors:null,comparators:null,model:null,view:null,controller:null,construct:function(v,u){this.selectors=v;
this.comparators=u
},initialize:function(u){this.$el=u;
this.setModel(new l(u,this.selectors));
this.setView(new s(u,this.selectors));
this.setController(new q(u,this.selectors,this.comparators));
this.model.initialize();
this.view.initialize();
this.controller.initialize()
},setModel:function(u){this.model=u
},getModel:function(){return this.model
},setView:function(u){this.view=u
},getView:function(){return this.view
},setController:function(u){this.controller=u
},getController:function(){return this.controller
},isSelected:function(v){var u=this.view.getSelectionState(v);
return(u==="selected")
},setSelected:function(w,u){var v=(u?"selected":"unselected");
this.view.setSelectionState(w,v)
},getSelection:function(u){var v=this.view.getSelectedItems();
if(u===true){v=this.model.fromItemElements(v)
}return v
},getDisplayMode:function(){return this.controller.getDisplayMode()
},isColumnSorted:function(){return this.controller.isColumnSorted()
},setDisplayMode:function(u){this.controller.setDisplayMode(u)
},isGridSelectionMode:function(){return this.controller.isGridSelect()
},setGridSelectionMode:function(u){this.controller.setGridSelect(u)
},getSelectionModeCount:function(){return this.controller.getSelectionModeCount()
},setSelectionModeCount:function(u){this.controller.setSelectionModeCount(u)
},_restore:function(u){this.view.restore(this.model,u);
this.model.reference()
},removeAllItems:function(){var u=o.getWidget(this.$el);
u.clearSelection();
this.model.removeAllItemsSilently();
this.view.removeAllItemsSilently()
}});
CUI.CardView=new Class({toString:"CardView",extend:CUI.Widget,adapter:null,construct:function(u){var w=o.mixObjects(u.selectorConfig,b);
var v=u.comparators||null;
this.adapter=new a(w,v);
this.adapter.initialize(this.$element);
this.layout(u.gridSettings)
},getModel:function(){return this.adapter.getModel()
},setModel:function(u){this.adapter.setModel(u)
},isSelected:function(u){return this.adapter.isSelected(u)
},getDisplayMode:function(){return this.adapter.getDisplayMode()
},isColumnSorted:function(){return this.adapter.isColumnSorted()
},setColumnSortable:function(u){},isColumnSortable:function(){},setDisplayMode:function(u){this.adapter.setDisplayMode(u)
},isGridSelectionMode:function(){return this.adapter.isGridSelectionMode()
},setGridSelectionMode:function(u){this.adapter.setGridSelectionMode(u)
},toggleGridSelectionMode:function(){this.setGridSelectionMode(!this.isGridSelectionMode())
},getSelectionModeCount:function(){return this.adapter.getSelectionModeCount()
},setSelectionModeCount:function(u){this.adapter.setSelectionModeCount(u)
},select:function(w,v){w=k(w);
var u=this.adapter.isSelected(w);
if(!u){if(this.getSelectionModeCount()===n&&this.getSelection().length>0){this.clearSelection()
}this.adapter.setSelected(w,true);
this.$element.trigger(j.Event("change:selection",{widget:this,item:w,isSelected:true,moreSelectionChanges:(v===true)}))
}},deselect:function(w,v){w=k(w);
var u=this.adapter.isSelected(w);
if(u){this.adapter.setSelected(w,false);
this.$element.trigger(j.Event("change:selection",{widget:this,item:w,isSelected:false,moreSelectionChanges:v}))
}},toggleSelection:function(z,w){z=k(z);
var v=j.Event("beforeselect",{selectionCancelled:false,stopEvent:false,item:z,cancelSelection:function(A){this.selectionCancelled=true;
this.stopEvent=(A===true)
}});
this.$element.trigger(v);
if(v.selectionCancelled){return v.stopEvent
}var u=this.isSelected(z);
if(!u&&(this.getSelectionModeCount()===n)&&(this.getSelection().length>0)){this.clearSelection()
}this.adapter.setSelected(z,!u);
this.$element.trigger(j.Event("change:selection",{widget:this,item:z,isSelected:!u,moreSelectionChanges:w}));
return true
},getSelection:function(u){return this.adapter.getSelection(u===true)
},clearSelection:function(){var v=this.getSelection(true);
var z=v.length;
var w=(z-1);
for(var u=0;
u<z;
u++){this.deselect(v[u],(u<w))
}},_headerSel:function(v,E,u){var D=this.adapter.getModel();
if(v==null){v=D.getHeaders()
}if(!j.isArray(v)){v=[v]
}var F=v.length;
for(var C=0;
C<F;
C++){var B=v[C];
if(B.jquery){B=D.getHeaderForEl(B)
}var w=D.getItemsForHeader(B);
var A=w.length;
for(var z=0;
z<A;
z++){E.call(this,w[z],!u(z,w))
}}},selectAll:function(v){if(this.getSelectionModeCount()!==m){return
}var u=this;
this._headerSel(v,this.select,function(z,w){for(++z;
z<w.length;
z++){if(!u.isSelected(w[z])){return false
}}return true
})
},deselectAll:function(v){var u=this;
this._headerSel(v,this.deselect,function(z,w){for(++z;
z<w.length;
z++){if(u.isSelected(w[z])){return false
}}return true
})
},getHeaderSelectionState:function(){var C=this.getModel();
var v=null;
var u={selected:[],hasUnselected:false,headers:[]};
var D=C.getHeaderCount();
var A=C.getItemCount();
for(var w=0;
w<A;
w++){var E=C.getItemAt(w);
for(var B=0;
B<D;
B++){var z=C.getHeaderAt(B);
if(z.getItemRef()===E){v={header:z,selected:[],hasUnselected:false};
u.headers.push(v);
break
}}if(this.isSelected(E)){if(v!==null){v.selected.push(E)
}else{u.selected.push(E)
}}else{if(v!==null){v.hasUnselected=true
}else{u.hasUnselected=true
}}}return u
},layout:function(u){if(this.getDisplayMode()!==h){return
}if(this.$element.data("cuigridlayout")){this.$element.cuigridlayout("destroy")
}this.$element.cuigridlayout(u)
},relayout:function(){if(this.getDisplayMode()!==h){return
}this.$element.cuigridlayout("layout")
},_restore:function(u){this.adapter._restore(u)
},append:function(u){this.adapter.getModel().insertItemAt(u,null,false)
},prepend:function(u){this.adapter.getModel().insertItemAt(u,0,false)
},removeAllItems:function(){this.adapter.removeAllItems();
if(this.getDisplayMode()===h){this.relayout()
}this.$element.trigger(j.Event("change:removeAll",{widget:this}))
}});
CUI.CardView.DefaultComparator=new Class({construct:function(u,z,w,v){this.selector=u;
this.attribute=z;
this.ignoreCase=v;
this.isNumeric=(w=="numeric");
this.reverseMultiplier=1
},setReverse:function(u){this.reverseMultiplier=(u)?-1:1
},compare:function(v,u){var D=v.getItemEl();
var C=u.getItemEl();
var B=(this.selector)?D.find(this.selector):D;
var A=(this.selector)?C.find(this.selector):C;
var z="";
var w="";
if(!this.attribute){z=(this.ignoreCase)?B.text().toLowerCase():B.text();
w=(this.ignoreCase)?A.text().toLowerCase():A.text()
}else{if(this.attribute.substr(0,5)=="data-"){z=B.data(this.attribute.substr(5));
w=A.data(this.attribute.substr(5))
}else{z=B.attr(this.attribute);
w=A.attr(this.attribute)
}}if(this.isNumeric){z=z*1;
w=w*1;
if(isNaN(z)){z=0
}if(isNaN(w)){w=0
}}if(z>w){return 1*this.reverseMultiplier
}if(z<w){return -1*this.reverseMultiplier
}return 0
},getCompareFn:function(){return this.compare.bind(this)
}});
CUI.CardView.DISPLAY_GRID=h;
CUI.CardView.DISPLAY_LIST=t;
CUI.CardView.SELECTION_MODE_COUNT_SINGLE="single";
CUI.CardView.SELECTION_MODE_COUNT_MULTI="multiple";
CUI.CardView.get=function(u){var v=o.getWidget(u);
if(!v){v=o.getWidget(u.cardView())
}return v
};
CUI.Widget.registry.register("cardview",CUI.CardView);
if(CUI.options.dataAPI){j(function(){var v=j("body").find('[data-toggle="cardview"]');
for(var w=0;
w<v.length;
w++){var u=j(v[w]);
if(!u.data("cardview")){CUI.CardView.init(u)
}}})
}}(window.jQuery));
(function(a){CUI.PathBrowser=new Class({toString:"PathBrowser",extend:CUI.Widget,construct:function(b){if(!this.options.autocompleteCallback){this.options.autocompleteCallback=this._defaultAutocompleteCallback.bind(this)
}if(!this.options.optionRenderer){this.options.optionRenderer=CUI.PathBrowser.defaultOptionRenderer
}this._render();
while(this.options.optionDisplayStrings.length<this.options.options.length){this.options.optionDisplayStrings.push(this.options.options[this.options.optionDisplayStrings.length])
}this.dropdownList=new CUI.DropdownList({element:this.inputElement,positioningElement:this.inputElement,position:this.options.position,autoPosition:this.options.autoPosition,cssClass:"autocomplete-results"});
this.$element.on("change:disabled",this._update.bind(this));
this.$element.on("change:placeholder",this._update.bind(this));
this.$element.on("change:options",this._changeOptions.bind(this));
this.$element.on("input","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=setTimeout(this._inputChanged.bind(this),this.options.delay)
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=null;
if(this.selectedIndex>=0){if(this.inputElement.attr("value")===""){this.setSelectedIndex(-1)
}else{this._update()
}}}.bind(this));
this.$element.on("keydown","input",this._keyPressed.bind(this));
this.$element.on("keyup","input",this._keyUp.bind(this));
this.dropdownList.on("dropdown-list:select","",function(d){this.dropdownList.hide(200);
this.setSelectedIndex(d.selectedValue*1)
}.bind(this));
if(!CUI.util.isTouch){this.$element.on("focus","input",function(d){if(this.options.disabled){return
}this.$element.addClass("focus")
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}this.$element.removeClass("focus")
}.bind(this));
this.$element.on("click touchend","input",function(d){if(this.options.disabled){return
}this.inputElement.focus();
this._inputChanged()
}.bind(this))
}},defaults:{autocompleteCallback:null,options:[],optionDisplayStrings:[],optionLoader:null,optionLoaderRoot:null,optionValueReader:null,optionTitleReader:null,showTitles:true,rootPath:"/content",delay:200,placeholder:null,optionRenderer:null,position:"below",autoPosition:true},dropdownList:null,syncSelectElement:null,inputElement:null,typeTimeout:null,selectedIndex:-1,triggeredBackspace:false,setSelectedIndex:function(b){if(b<-1||b>=this.options.options.length){return
}this.selectedIndex=b;
this._update()
},getSelectedIndex:function(){return this.selectedIndex
},_changeOptions:function(b){if(b.widget!==this){return
}this.selectedIndex=-1;
this._update()
},_render:function(){this._readDataFromMarkup();
var b;
if(this.$element.get(0).tagName==="SELECT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.append(this.$element);
this.$element=b
}if(this.$element.get(0).tagName==="INPUT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.prepend(this.$element);
this.$element=b
}if(this.$element.find("select option").length>0&&this.options.options.length===0){this.options.options=[];
this.options.optionDisplayStrings=[];
this.$element.find("select option").each(function(d,f){this.options.options.push(a(f).val());
this.options.optionDisplayStrings.push(a.trim(a(f).text()));
if(a(f).attr("selected")){this.selectedIndex=d
}}.bind(this))
}this._createMissingElements();
this.syncSelectElement=this.$element.find("select");
this.inputElement=this.$element.find("input");
this.$element.addClass("pathbrowser");
this.$element.removeClass("focus");
if(!this.options.placeholder){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.options.name){this.syncSelectElement.attr("name",this.options.name)
}this._update()
},_createMissingElements:function(){if(this.$element.find("select").length===0){this.$element.append(a("<select></select>"))
}if(this.$element.find("input").length===0){this.$element.prepend(a("<input/>",{type:"text"}))
}},_readDataFromMarkup:function(){if(this.$element.attr("placeholder")){this.options.placeholder=this.$element.attr("placeholder")
}if(this.$element.attr("data-placeholder")){this.options.placeholder=this.$element.attr("data-placeholder")
}if(this.$element.attr("disabled")||this.$element.attr("data-disabled")){this.options.disabled=true
}if(this.$element.attr("data-option-renderer")){this.options.optionRenderer=CUI.PathBrowser[this.$element.attr("data-option-renderer")+"OptionRenderer"]
}if(this.$element.attr("data-root-path")){this.options.rootPath=this.$element.attr("data-root-path")
}var f=CUI.util.buildFunction(this.$element.attr("data-option-loader"),["path","callback"]);
if(f){this.options.optionLoader=f.bind(this)
}if(this.$element.attr("data-option-loader-root")){this.options.optionLoaderRoot=this.$element.attr("data-option-loader-root")
}var d=CUI.util.buildFunction(this.$element.attr("data-option-value-reader"),["object"]);
if(d){this.options.optionValueReader=d.bind(this)
}var b=CUI.util.buildFunction(this.$element.attr("data-option-title-reader"),["object"]);
if(b){this.options.optionTitleReader=b.bind(this)
}},_update:function(){if(this.options.placeholder){this.inputElement.attr("placeholder",this.options.placeholder)
}if(this.options.disabled){this.$element.addClass("disabled");
this.inputElement.attr("disabled","disabled")
}else{this.$element.removeClass("disabled");
this.inputElement.removeAttr("disabled")
}if(this.syncSelectElement){this.syncSelectElement.find("option:selected").removeAttr("selected")
}if(this.selectedIndex>=0){if(this.syncSelectElement){a(this.syncSelectElement.find("option").get(this.selectedIndex)).attr("selected","selected")
}var d=this.options.options[this.selectedIndex];
if(d&&d.indexOf("/")!==0){var b="";
var f=this.inputElement.attr("value").lastIndexOf("/");
if(f>=0){b=this.inputElement.attr("value").substring(0,f+1)
}d=b+d
}this._setInputValue(d,true)
}else{this._setInputValue("")
}},_setInputValue:function(b,d){if(b){this.inputElement.attr("value",b);
if(d&&this.inputElement.is(":focus")){CUI.util.selectText(this.inputElement,b.length)
}}},_keyUp:function(d){var b=d.keyCode;
if(b===8){this.triggeredBackspace=false
}},_keyPressed:function(d){var b=d.keyCode;
if(!this.dropdownList.isVisible()){if(b===40){this._inputChanged();
d.preventDefault()
}}},_inputChanged:function(){var d=this;
var b=this.inputElement.val();
if(b.length>0){this.options.autocompleteCallback(b).done(function(f){d._showAutocompleter(f)
}).fail(function(){})
}else{this.dropdownList.hide()
}},_showAutocompleter:function(d){this.dropdownList.hide();
if(d.length===0){return
}var b=function(f,g){return(this.options.optionRenderer.bind(this))(f,g)
};
this.dropdownList.set("optionRenderer",b.bind(this));
this.dropdownList.set("options",d);
this.dropdownList.show()
},_defaultAutocompleteCallback:function(k){var f=this;
var h=a.Deferred();
if(/^\//.test(k)&&/\/$/.test(k)&&f.options.optionLoader){var d=false;
if(k==="/"){if(f.options.rootPath){k=f.options.rootPath.replace(/\/$/,"");
if(k!==""){d=true
}else{k="/"
}}}else{k=k.replace(/\/$/,"")
}if(d){f._setInputValue(k+"/")
}var b={loadOptions:f.options.optionLoader};
var j=a.Deferred();
j.promise(b);
b.done(function(l){if(a.isFunction(l.promise)){l.done(function(m){f._rebuildOptions(h,k,m)
})
}else{f._rebuildOptions(h,k,l)
}});
var g=b.loadOptions(k,function(l){j.resolve(l)
});
if(g){j.resolve(g)
}}else{h.resolve(f._filterOptions(k))
}return h.promise()
},_rebuildOptions:function(j,k,g){var d=this;
var b=CUI.util.getNested(g,d.options.optionLoaderRoot);
if(b){var l=[];
var h=[];
a.each(b,function(n,m){var o;
if(d.options.optionValueReader){o=d.options.optionValueReader(m)
}else{o=typeof m==="object"?m.path:m
}l.push(o);
var p="";
if(d.options.optionTitleReader){p=d.options.optionTitleReader(m)
}else{if(typeof m==="object"){p=m.title
}}h.push(p)
}.bind(d));
d.options.options=l;
d.options.optionDisplayStrings=h;
var f=d._filterOptions(k);
j.resolve(f)
}else{j.reject()
}},_filterOptions:function(d){var b=[];
a.each(this.options.options,function(f,g){b.push(f)
}.bind(this));
return b
}});
CUI.util.plugClass(CUI.PathBrowser);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~='pathbrowser']",b.target).pathBrowser()
})
}CUI.PathBrowser.defaultOptionRenderer=function(g,f){var h=this.options.options[f];
if(h.indexOf("/")===0){var j=h.lastIndexOf("/");
h=h.substring(j+1)
}var d="pathbrowser-autocomplete-item-value";
var b="";
if(this.options.showTitles&&this.options.optionDisplayStrings[f]&&this.options.optionDisplayStrings[f].length>0){d+=" pathbrowser-autocomplete-item-value-with-title";
b+='<div class="pathbrowser-autocomplete-item-title">'+this.options.optionDisplayStrings[f]+"</div>"
}return a('<div class="'+d+'">'+h+"</div>"+b)
}
}(window.jQuery));
(function(a){CUI.FileUpload=new Class({toString:"FileUpload",extend:CUI.Widget,construct:function(b){this._render();
this.inputElement.on("change",function(d){if(this.options.disabled){return
}this._onFileSelectionChange(d)
}.bind(this))
},defaults:{name:"file",placeholder:null,uploadUrl:null,uploadUrlBuilder:null,disabled:false,multiple:false,sizeLimit:null,mimeTypes:[],autoStart:false,fileNameParameter:null,useHTML5:true,dropZone:null,events:{}},inputElement:null,$spanElement:null,fileNameElement:null,uploadQueue:[],_render:function(){var b=this;
if(this.$element.get(0).tagName==="INPUT"){var f=this.$element.attr("class");
var g=a("<span/>",{"class":f});
this.$element.removeAttr("class");
this.$element.after(g);
this.$element.detach();
g.prepend(this.$element);
this.$element=g
}this.$spanElement=this.$element.is("span")?this.$element:this.$element.find("span");
this.inputElement=this.$element.find("input[type='file']");
this._readDataFromMarkup();
if(!CUI.util.HTTP.html5UploadSupported()){this.options.useHTML5=false
}this._createMissingElements();
this.$element.addClass("fileupload");
this.$element.removeClass("focus");
if(this.inputElement.attr("title")){this.$element.prepend(a("<label/>",{"for":b.options.name}).html(this.inputElement.attr("title")))
}if(this.options.events){if(typeof this.options.events==="object"){for(var d in this.options.events){this._registerEventHandler(d,this.options.events[d])
}}}if(this.options.useHTML5){this._registerDropZone()
}else{this.options.dropZone=null
}if(!this.options.placeholder){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.options.autoStart){this._registerEventHandler("fileselected",function(h){h.fileUpload.uploadFile(h.item)
})
}if(this.options.uploadUrlBuilder){this.options.uploadUrl=this.options.uploadUrlBuilder(this)
}if(!this.options.uploadUrl||/\$\{.+\}/.test(this.options.uploadUrl)){this.options.disabled=true
}this._update()
},setDropZone:function(b){if(this.options.dropZone){this.options.dropZone.off()
}this.options.dropZone=b;
this._registerDropZone()
},_registerDropZone:function(){var b=this;
if(!b.options.dropZone){b.options.dropZone=b.$element.parent()
}try{b.options.dropZone=a(b.options.dropZone)
}catch(d){delete b.options.dropZone
}if(b.options.dropZone){b.options.dropZone.on("dragenter",function(f){if(b._isActive()){if(f.stopPropagation){f.stopPropagation()
}if(f.preventDefault){f.preventDefault()
}b.$element.trigger({type:"dropzonedragenter",originalEvent:f,fileUpload:b})
}return false
}).on("dragover",function(f){if(b._isActive()){b.isDragOver=true;
if(f.stopPropagation){f.stopPropagation()
}if(f.preventDefault){f.preventDefault()
}b.$element.trigger({type:"dropzonedragover",originalEvent:f,fileUpload:b})
}return false
}).on("dragleave",function(f){if(b._isActive()){if(f.stopPropagation){f.stopPropagation()
}if(f.preventDefault){f.preventDefault()
}b.isDragOver=false;
window.setTimeout(function(){if(!b.isDragOver){b.$element.trigger({type:"dropzonedragleave",originalEvent:f,fileUpload:b})
}},1)
}return false
}).on("drop",function(g){if(b._isActive()){if(g.stopPropagation){g.stopPropagation()
}if(g.preventDefault){g.preventDefault()
}var f=g.originalEvent.dataTransfer.files;
b.$element.trigger({type:"dropzonedrop",originalEvent:g,files:f,fileUpload:b});
b._onFileSelectionChange(g,f)
}return false
})
}},_registerEventHandler:function(b,d){this.$element.on(b,d)
},_createMissingElements:function(){var d=this;
var b=d.options.useHTML5&&d.options.multiple;
if(d.inputElement.length===0){d.inputElement=a("<input/>",{type:"file",name:d.options.name,multiple:b});
d.$element.prepend(d.inputElement)
}else{d.inputElement.attr("multiple",b)
}d.$element.wrap(a("<div class='fileupload-container'/>"))
},_readDataFromMarkup:function(){var d=this;
if(this.inputElement.attr("name")){this.options.name=this.inputElement.attr("name")
}if(this.inputElement.attr("placeholder")){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.inputElement.data("placeholder")){this.options.placeholder=this.inputElement.data("placeholder")
}if(this.inputElement.attr("disabled")||this.inputElement.data("disabled")){this.options.disabled=true
}if(this.inputElement.attr("multiple")||this.inputElement.data("multiple")){this.options.multiple=true
}if(this.inputElement.data("uploadUrl")){this.options.uploadUrl=this.inputElement.data("uploadUrl")
}if(this.inputElement.data("uploadUrlBuilder")){this.options.uploadUrlBuilder=CUI.util.buildFunction(this.inputElement.data("uploadUrlBuilder"),["fileUpload"])
}if(this.inputElement.data("mimeTypes")){this.options.mimeTypes=this.inputElement.data("mimeTypes")
}if(this.inputElement.data("sizeLimit")){this.options.sizeLimit=this.inputElement.data("sizeLimit")
}if(this.inputElement.data("autoStart")){this.options.autoStart=true
}if(this.inputElement.data("usehtml5")){this.options.useHTML5=this.inputElement.data("usehtml5")===true
}if(this.inputElement.data("dropzone")){this.options.dropZone=this.inputElement.data("dropzone")
}if(this.inputElement.data("fileNameParameter")){this.options.fileNameParameter=this.inputElement.data("fileNameParameter")
}var b=this.inputElement.length?this.inputElement.get(0):undefined;
if(b){a.each(b.attributes,function(h,j){var f=/^data-event-(.*)$/.exec(j.name);
if(f&&f.length>1){var g=CUI.util.buildFunction(j.value,["event"]);
if(g){d.options.events[f[1]]=g.bind(d)
}}})
}},_update:function(){if(this.options.placeholder){this.inputElement.attr("placeholder",this.options.placeholder)
}if(this.options.disabled){this.$element.addClass("disabled");
this.inputElement.attr("disabled","disabled")
}else{this.$element.removeClass("disabled");
this.inputElement.removeAttr("disabled")
}},_onFileSelectionChange:function(g,f){var h=0,b=0;
if(this.options.useHTML5){f=f||g.target.files;
for(var d=0;
d<f.length;
d++){if(this._addFile(f[d])){h++
}else{b++
}}}else{if(this._addFile(g.target)){h++
}else{b++
}}this.$element.trigger({type:"filelistprocessed",addedCount:h,rejectedCount:b,fileUpload:this})
},_addFile:function(d){var b=this;
var h,g;
if(this.options.useHTML5){h=d.name;
g=d.type
}else{h=a(d).attr("value")||d.value;
g=CUI.FileUpload.MimeTypes.getMimeTypeFromFileName(h)
}if(h.lastIndexOf("\\")!==-1){h=h.substring(h.lastIndexOf("\\")+1)
}if(b.options.fileNameParameter&&!this.options.autoStart){if(!b.fileNameElement){b.fileNameElement=a('input[name="'+b.options.fileNameParameter+'"]');
if(b.fileNameElement.length===0){b.fileNameElement=a("<input/>",{type:"hidden",name:b.options.fileNameParameter});
b.fileNameElement.appendTo(b.$element)
}}b.fileNameElement.val(h)
}if(!b._getQueueItemByFileName(h)){var f={fileName:h};
if(this.options.useHTML5){f.file=d;
f.fileSize=d.size;
if(b.options.sizeLimit&&d.size>b.options.sizeLimit){b.$element.trigger({type:"filerejected",item:f,message:"File is too big",fileUpload:b});
return false
}}if(!b._checkMimeTypes(g)){b.$element.trigger({type:"filerejected",item:f,message:"File mime type is not allowed",fileUpload:b});
return false
}b.uploadQueue.push(f);
b.$element.trigger({type:"queuechanged",item:f,operation:"ADD",queueLength:b.uploadQueue.length,fileUpload:b});
b.$element.trigger({type:"fileselected",item:f,fileUpload:b});
return true
}return false
},_checkMimeTypes:function(g){function d(l,k){var j=/(.+)\/(.+)$/,n=/\.(.+)$/,m=/.*/,h=false;
if(k==="*"||k===".*"||k==="*/*"){h=true
}else{if(!l||!l.match(j)){h=false
}else{if(k.match(j)){h=(l===k)
}else{if(k.match(n)){h=(l===CUI.FileUpload.MimeTypes[k])
}else{if(k.match(m)){h=(l.split("/")[0]===k)
}}}}}return h
}var f=this.options.mimeTypes.length,b;
if(f===0){return true
}else{for(b=0;
b<f;
b+=1){if(d(g,this.options.mimeTypes[b])){return true
}}return false
}},_getQueueIndex:function(d){var b=-1;
a.each(this.uploadQueue,function(f,g){if(g.fileName===d){b=f;
return false
}});
return b
},_getQueueItem:function(b){return b>-1?this.uploadQueue[b]:null
},_getQueueItemByFileName:function(b){return this._getQueueItem(this._getQueueIndex(b))
},uploadFile:function(m){var n=this;
if(n.options.useHTML5){m.xhr=new XMLHttpRequest();
m.xhr.addEventListener("loadstart",function(f){n._onUploadStart(f,m)
},false);
m.xhr.addEventListener("load",function(f){n._onUploadLoad(f,m)
},false);
m.xhr.addEventListener("error",function(f){n._onUploadError(f,m)
},false);
m.xhr.addEventListener("abort",function(f){n._onUploadCanceled(f,m)
},false);
var p=m.xhr.upload;
p.addEventListener("progress",function(f){n._onUploadProgress(f,m)
},false);
var b=m.file;
var d=m.fileName;
if(window.FormData){var j=new FormData();
if(n.options.fileNameParameter){j.append(n.inputElement.attr("name"),b);
j.append(n.options.fileNameParameter||"fileName",d)
}else{j.append(d,b)
}j.append("_charset_","utf-8");
m.xhr.open("POST",n.options.uploadUrl+"?:ck="+new Date().getTime(),true);
m.xhr.send(j)
}else{m.xhr.open("PUT",n.options.uploadUrl+"/"+d,true);
m.xhr.send(b)
}}else{var g=a(document.body);
var h="upload-"+new Date().getTime();
var l=a("<iframe/>",{name:h});
l.addClass("fileupload").appendTo(g);
var o=a("<form/>",{method:"post",enctype:"multipart/form-data",action:n.options.uploadUrl,target:h});
o.addClass("fileupload").appendTo(g);
var k=a("<input/>",{type:"hidden",name:"_charset_",value:"utf-8"});
o.prepend(k);
if(this.options.fileNameParameter){this.fileNameElement=a("<input/>",{type:"hidden",name:this.options.fileNameParameter,value:m.fileName});
o.prepend(this.fileNameElement)
}l.one("load",function(){var f=this.contentWindow.document.body.innerHTML;
n.inputElement.prependTo(n.$spanElement);
o.remove();
l.remove();
n.$element.trigger({type:"fileuploadload",item:m,content:f,fileUpload:n})
});
n.inputElement.prependTo(o);
o.submit()
}},cancelUpload:function(b){b.xhr.abort()
},_onUploadStart:function(d,b){this.$element.trigger({type:"fileuploadstart",item:b,originalEvent:d,fileUpload:this})
},_onUploadProgress:function(d,b){this.$element.trigger({type:"fileuploadprogress",item:b,originalEvent:d,fileUpload:this})
},_onUploadLoad:function(f,d){var b=f.target;
if(b.readyState===4){this._internalOnUploadLoad(f,d,b.status,b.responseText)
}},_internalOnUploadLoad:function(f,b,g,d){if(CUI.util.HTTP.isOkStatus(g)){this.$element.trigger({type:"fileuploadsuccess",item:b,originalEvent:f,fileUpload:this})
}else{this.$element.trigger({type:"fileuploaderror",item:b,originalEvent:f,message:d,fileUpload:this})
}if(this.fileNameElement){this.fileNameElement.remove()
}this.uploadQueue.splice(this._getQueueIndex(b.fileName),1);
this.$element.trigger({type:"queuechanged",item:b,operation:"REMOVE",queueLength:this.uploadQueue.length,fileUpload:this})
},_onUploadError:function(d,b){this.$element.trigger({type:"fileuploaderror",item:b,originalEvent:d,fileUpload:this})
},_onUploadCanceled:function(d,b){this.$element.trigger({type:"fileuploadcanceled",item:b,originalEvent:d,fileUpload:this})
},_isActive:function(){return !this.inputElement.is(":disabled")
}});
CUI.Widget.registry.register("fileupload",CUI.FileUpload);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.FileUpload.init(a("[data-init~='fileupload']",b.target))
})
}}(window.jQuery));
(function(a){CUI.FileUpload.MimeTypes={".3dm":"x-world/x-3dmf",".3dmf":"x-world/x-3dmf",".a":"application/octet-stream",".aab":"application/x-authorware-bin",".aam":"application/x-authorware-map",".aas":"application/x-authorware-seg",".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".ai":"application/postscript",".aif":"audio/x-aiff",".aifc":"audio/x-aiff",".aiff":"audio/x-aiff",".aim":"application/x-aim",".aip":"text/x-audiosoft-intra",".ani":"application/x-navi-animation",".aos":"application/x-nokia-9000-communicator-add-on-software",".aps":"application/mime",".arc":"application/octet-stream",".arj":"application/octet-stream",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf-plugin",".au":"audio/x-au",".avi":"video/x-msvideo",".avs":"video/avs-video",".bcpio":"application/x-bcpio",".bin":"application/x-macbinary",".bm":"image/bmp",".bmp":"image/x-windows-bmp",".boo":"application/book",".book":"application/book",".boz":"application/x-bzip2",".bsh":"application/x-bsh",".bz":"application/x-bzip",".bz2":"application/x-bzip2",".c":"text/x-c",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/x-c",".ccad":"application/clariscad",".cco":"application/x-cocoa",".cdf":"application/x-netcdf",".cer":"application/x-x509-ca-cert",".cha":"application/x-chat",".chat":"application/x-chat",".class":"application/x-java-class",".com":"text/plain",".conf":"text/plain",".cpio":"application/x-cpio",".cpp":"text/x-c",".cpt":"application/x-cpt",".crl":"application/pkix-crl",".crt":"application/x-x509-user-cert",".csh":"text/x-script.csh",".css":"text/css",".cxx":"text/plain",".dcr":"application/x-director",".deepv":"application/x-deepv",".def":"text/plain",".der":"application/x-x509-ca-cert",".dif":"video/x-dv",".dir":"application/x-director",".dl":"video/x-dl",".doc":"application/msword",".dot":"application/msword",".dp":"application/commonground",".drw":"application/drafting",".dump":"application/octet-stream",".dv":"video/x-dv",".dvi":"application/x-dvi",".dwf":"model/vnd.dwf",".dwg":"image/x-dwg",".dxf":"image/x-dwg",".dxr":"application/x-director",".el":"text/x-script.elisp",".elc":"application/x-elc",".env":"application/x-envoy",".eps":"application/postscript",".es":"application/x-esrehber",".etx":"text/x-setext",".evy":"application/x-envoy",".exe":"application/octet-stream",".f":"text/x-fortran",".f77":"text/x-fortran",".f90":"text/x-fortran",".fdf":"application/vnd.fdf",".fif":"image/fif",".fli":"video/x-fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.net-fpx",".frl":"application/freeloader",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/x-gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".gsp":"application/x-gsp",".gss":"application/x-gss",".gtar":"application/x-gtar",".gz":"application/x-gzip",".gzip":"multipart/x-gzip",".h":"text/x-h",".hdf":"application/x-hdf",".help":"application/x-helpfile",".hgl":"application/vnd.hp-hpgl",".hh":"text/x-h",".hlb":"text/x-script",".hlp":"application/x-winhelp",".hpg":"application/vnd.hp-hpgl",".hpgl":"application/vnd.hp-hpgl",".hqx":"application/x-mac-binhex40",".hta":"application/hta",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".ice":"x-conference/x-cooltalk",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".iges":"model/iges",".igs":"model/iges",".ima":"application/x-ima",".imap":"application/x-httpd-imap",".inf":"application/inf",".ins":"application/x-internett-signup",".ip":"application/x-ip2",".isu":"video/x-isvideo",".it":"audio/it",".iv":"application/x-inventor",".ivr":"i-world/i-vrml",".ivy":"application/x-livescreen",".jam":"audio/x-jam",".jav":"text/x-java-source",".java":"text/x-java-source",".jcm":"application/x-java-commerce",".jfif":"image/pjpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/pjpeg",".jpeg":"image/pjpeg",".jpg":"image/pjpeg",".jps":"image/x-jps",".js":"application/x-javascript",".jut":"image/jutvision",".kar":"music/x-karaoke",".ksh":"text/x-script.ksh",".la":"audio/x-nspaudio",".lam":"audio/x-liveaudio",".latex":"application/x-latex",".lha":"application/x-lha",".lhx":"application/octet-stream",".list":"text/plain",".lma":"audio/x-nspaudio",".log":"text/plain",".lsp":"text/x-script.lisp",".lst":"text/plain",".lsx":"text/x-la-asf",".ltx":"application/x-latex",".lzh":"application/x-lzh",".lzx":"application/x-lzx",".m":"text/x-m",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".man":"application/x-troff-man",".map":"application/x-navimap",".mar":"text/plain",".mbd":"application/mbedlet",".mc$":"application/x-magic-cap-package-1.0",".mcd":"application/x-mathcad",".mcf":"text/mcf",".mcp":"application/netmc",".me":"application/x-troff-me",".mht":"message/rfc822",".mhtml":"message/rfc822",".mid":"x-music/x-midi",".midi":"x-music/x-midi",".mif":"application/x-mif",".mime":"www/mime",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mm":"application/x-meme",".mme":"application/base64",".mod":"audio/x-mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"video/x-mpeq2a",".mp3":"video/x-mpeg",".mpa":"video/mpeg",".mpc":"application/x-project",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/x-project",".mpv":"application/x-project",".mpx":"application/x-project",".mrc":"application/marc",".ms":"application/x-troff-ms",".mv":"video/x-sgi-movie",".my":"audio/make",".mzz":"application/x-vnd.audioexplosion.mzz",".nap":"image/naplps",".naplps":"image/naplps",".nc":"application/x-netcdf",".ncm":"application/vnd.nokia.configuration-message",".nif":"image/x-niff",".niff":"image/x-niff",".nix":"application/x-mix-transfer",".nsc":"application/x-conference",".nvd":"application/x-navidoc",".o":"application/octet-stream",".oda":"application/oda",".omc":"application/x-omc",".omcd":"application/x-omcdatamaker",".omcr":"application/x-omcregerator",".p":"text/x-pascal",".p10":"application/x-pkcs10",".p12":"application/x-pkcs12",".p7a":"application/x-pkcs7-signature",".p7c":"application/x-pkcs7-mime",".p7m":"application/x-pkcs7-mime",".p7r":"application/x-pkcs7-certreqresp",".p7s":"application/pkcs7-signature",".part":"application/pro_eng",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pcl":"application/x-pcl",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdb":"chemical/x-pdb",".pdf":"application/pdf",".pfunk":"audio/make.my.funk",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pkg":"application/x-newton-compatible-pkg",".pko":"application/vnd.ms-pki.pko",".pl":"text/x-script.perl",".plx":"application/x-pixclscript",".pm":"text/x-script.perl-module",".pm4":"application/x-pagemaker",".pm5":"application/x-pagemaker",".png":"image/png",".pnm":"image/x-portable-anymap",".pot":"application/vnd.ms-powerpoint",".pov":"model/x-pov",".ppa":"application/vnd.ms-powerpoint",".ppm":"image/x-portable-pixmap",".pps":"application/vnd.ms-powerpoint",".ppt":"application/x-mspowerpoint",".ppz":"application/mspowerpoint",".pre":"application/x-freelance",".prt":"application/pro_eng",".ps":"application/postscript",".psd":"application/octet-stream",".pvu":"paleovu/x-pv",".pwz":"application/vnd.ms-powerpoint",".py":"text/x-script.phyton",".pyc":"applicaiton/x-bytecode.python",".qcp":"audio/vnd.qcelp",".qd3":"x-world/x-3dmf",".qd3d":"x-world/x-3dmf",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-realaudio",".ram":"audio/x-pn-realaudio",".ras":"image/x-cmu-raster",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rm":"audio/x-pn-realaudio",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio-plugin",".rng":"application/vnd.nokia.ringing-tone",".rnx":"application/vnd.rn-realplayer",".roff":"application/x-troff",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/vnd.rn-realtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".saveme":"application/octet-stream",".sbk":"application/x-tbook",".scm":"video/x-scm",".sdml":"text/plain",".sdp":"application/x-sdp",".sdr":"application/sounder",".sea":"application/x-sea",".set":"application/set",".sgm":"text/x-sgml",".sgml":"text/x-sgml",".sh":"text/x-script.sh",".shar":"application/x-shar",".shtml":"text/x-server-parsed-html",".sid":"audio/x-psid",".sit":"application/x-stuffit",".skd":"application/x-koan",".skm":"application/x-koan",".skp":"application/x-koan",".skt":"application/x-koan",".sl":"application/x-seelogo",".smi":"application/smil",".smil":"application/smil",".snd":"audio/x-adpcm",".sol":"application/solids",".spc":"text/x-speech",".spl":"application/futuresplash",".spr":"application/x-sprite",".sprite":"application/x-sprite",".src":"application/x-wais-source",".ssi":"text/x-server-parsed-html",".ssm":"application/streamingmedia",".sst":"application/vnd.ms-pki.certstore",".step":"application/step",".stl":"application/x-navistyle",".stp":"application/step",".sv4cpio":"application/x-sv4cpio",".sv4crc":"application/x-sv4crc",".svf":"image/x-dwg",".svr":"x-world/x-svr",".swf":"application/x-shockwave-flash",".t":"application/x-troff",".talk":"text/x-speech",".tar":"application/x-tar",".tbk":"application/x-tbook",".tcl":"text/x-script.tcl",".tcsh":"text/x-script.tcsh",".tex":"application/x-tex",".texi":"application/x-texinfo",".texinfo":"application/x-texinfo",".text":"text/plain",".tgz":"application/x-compressed",".tif":"image/x-tiff",".tiff":"image/x-tiff",".tr":"application/x-troff",".tsi":"audio/tsp-audio",".tsp":"audio/tsplayer",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".unv":"application/i-deas",".uri":"text/uri-list",".uris":"text/uri-list",".ustar":"multipart/x-ustar",".uu":"text/x-uuencode",".uue":"text/x-uuencode",".vcd":"application/x-cdlink",".vcs":"text/x-vcalendar",".vda":"application/vda",".vdo":"video/vdo",".vew":"application/groupwise",".viv":"video/vnd.vivo",".vivo":"video/vnd.vivo",".vmd":"application/vocaltec-media-desc",".vmf":"application/vocaltec-media-file",".voc":"audio/x-voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vrml":"x-world/x-vrml",".vrt":"x-world/x-vrt",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w60":"application/wordperfect6.0",".w61":"application/wordperfect6.1",".w6w":"application/msword",".wav":"audio/x-wav",".wb1":"application/x-qpro",".wbmp":"image/vnd.wap.wbmp",".web":"application/vnd.xara",".wiz":"application/msword",".wk1":"application/x-123",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmlc":"application/vnd.wap.wmlc",".wmls":"text/vnd.wap.wmlscript",".wmlsc":"application/vnd.wap.wmlscriptc",".word":"application/msword",".wp":"application/wordperfect",".wp5":"application/wordperfect6.0",".wp6":"application/wordperfect",".wpd":"application/x-wpwin",".wq1":"application/x-lotus",".wri":"application/x-wri",".wrl":"x-world/x-vrml",".wrz":"x-world/x-vrml",".wsc":"text/scriplet",".wsrc":"application/x-wais-source",".wtk":"application/x-wintalk",".xbm":"image/xbm",".xdr":"video/x-amt-demorun",".xgz":"xgl/drawing",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":"application/x-msexcel",".xlb":"application/x-excel",".xlc":"application/x-excel",".xld":"application/x-excel",".xlk":"application/x-excel",".xll":"application/x-excel",".xlm":"application/x-excel",".xls":"application/x-msexcel",".xlt":"application/x-excel",".xlv":"application/x-excel",".xlw":"application/x-msexcel",".xm":"audio/xm",".xml":"text/xml",".xmz":"xgl/movie",".xpix":"application/x-vnd.ls-xpix",".xpm":"image/xpm",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwindowdump",".xyz":"chemical/x-pdb",".z":"application/x-compressed",".zip":"multipart/x-zip",".zoo":"application/octet-stream",".zsh":"text/x-script.zsh"};
CUI.FileUpload.MimeTypes.getMimeTypeFromFileName=function(d){var b=d.match(/.+(\..+)/);
return(b?CUI.FileUpload.MimeTypes[b[1]]:undefined)
}
}(window.jQuery));
(function(a){CUI.Toolbar=new Class({toString:"Toolbar",extend:CUI.Widget,construct:function(g){var f=this.$element,d=f.closest(".content-header"),b=f.find(".left"),h=f.find(".center").length!==0,j=b.width();
f.reflow({"break-lines":function(k,l){return h&&k.width()-2*j<16*l.rem()
},"long-title":function(k,l){return h&&k.width()-2*j>40*l.rem()
}},{applyClassToElement:d})
}});
CUI.Widget.registry.register("toolbar",CUI.Toolbar);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Toolbar.init(a("[data-init~=toolbar]",b.target))
})
}}(window.jQuery));
(function(a){CUI.Tooltip=new Class({toString:"Tooltip",extend:CUI.Widget,construct:function(d){if(this.options.target){this.options.target=a(this.options.target)
}if(this.$element.length===0&&this.options.target){this.$element=a("<div>");
this.$element.insertAfter(this.options.target)
}this.$element.addClass("tooltip");
if(this.$element.data("interactive")){this.options.interactive=true;
if(!this.options.target){this.options.target=this.$element.parent()
}}if(this.$element.data("target")){this.options.target=a(this.$element.data("target"))
}if(!this.options.arrow){this.options.arrow="left";
if(this.$element.hasClass("arrow-left")){this.options.arrow="left"
}if(this.$element.hasClass("arrow-right")){this.options.arrow="right"
}if(this.$element.hasClass("arrow-top")){this.options.arrow="top"
}if(this.$element.hasClass("arrow-bottom")){this.options.arrow="bottom"
}}if(this.options.interactive){this.options.visible=false
}this.$element.toggleClass("hidden",!this.options.visible);
this.$element.on("change:content",this._setContent.bind(this));
this.$element.on("change:type",this._setType.bind(this));
this.$element.on("change:arrow",this._setArrow.bind(this));
this.applyOptions();
this.reposition();
if(this.options.target){this.options.target.data("tooltip",this)
}if(this.options.interactive&&this.options.target){var b=null;
a(this.options.target).finger("touchstart.cui-tooltip",function(g){if(b){clearTimeout(b)
}this.show();
b=setTimeout(function(){this.hide()
}.bind(this),3000)
}.bind(this));
var f=false;
a(this.options.target).pointer("mouseover.cui-tooltip",function(g){if(f){clearTimeout(f)
}f=setTimeout(function(){this.show()
}.bind(this),this.options.delay)
}.bind(this));
a(this.options.target).pointer("mouseout.cui-tooltip",function(g){if(f){clearTimeout(f)
}this.hide()
}.bind(this))
}},defaults:{target:null,visible:true,type:"default",interactive:false,arrow:null,delay:500,distance:5},_types:["info","error","notice","success","inspect"],_arrows:["arrow-left","arrow-right","arrow-top","arrow-bottom"],applyOptions:function(){this._setContent();
this._setType();
this._setArrow()
},_setType:function(){if(typeof this.options.type!=="string"||this._types.indexOf(this.options.type)===-1){return
}this.$element.removeClass(this._types.join(" "));
this.$element.addClass(this.options.type);
this.reposition()
},_setArrow:function(){if(typeof this.options.arrow!=="string"||this._arrows.indexOf("arrow-"+this.options.arrow)===-1){return
}this.$element.removeClass(this._arrows.join(" "));
this.$element.addClass("arrow-"+this.options.arrow);
this.reposition()
},_setContent:function(){if(typeof this.options.content!=="string"){return
}this.$element.html(this.options.content);
this.reposition()
},_show:function(){if(this.$element.hasClass("hidden")){this.$element.removeClass("hidden");
this.$element.css("display","none")
}this.$element.fadeIn()
},_hide:function(){this.$element.fadeOut(400,function(){if(this.options.autoDestroy){this.$element.remove();
a(this.options.target).off(".cui-tooltip");
a(this.options.target).data("tooltip",null)
}}.bind(this));
return this
},reposition:function(g){if(!this.options.target){return
}if(!g){setTimeout(function(){this.reposition(true)
}.bind(this),50)
}this.$element.detach().insertAfter(this.options.target);
this.$element.css("position","absolute");
var d=a(this.options.target);
var m=d.outerWidth(true);
var k=d.outerHeight(true);
var l=d.position().left;
var h=d.position().top+d.offsetParent().scrollTop();
var b=this.$element.outerWidth(true);
var n=this.$element.outerHeight(true);
var f=0;
var j=0;
if(this.options.arrow==="left"){f=l+m+this.options.distance;
j=h+(k-n)/2
}if(this.options.arrow==="right"){f=l-b-this.options.distance;
j=h+(k-n)/2
}if(this.options.arrow==="bottom"){f=l+(m-b)/2;
j=h-n-this.options.distance
}if(this.options.arrow==="top"){f=l+(m-b)/2;
j=h+k+this.options.distance
}this.$element.css("left",f);
this.$element.css("top",j);
return this
}});
CUI.Widget.registry.register("tooltip",CUI.Tooltip);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Tooltip.init(a("[data-init~=tooltip]",b.target))
});
a(document).fipo("touchstart","mouseover","[data-init~=quicktip]",function(f){var b=a(this);
var d=b.data("tooltip");
if(!d){new CUI.Tooltip({target:b,content:b.data("quicktip-content")||b.html(),type:b.data("quicktip-type"),arrow:b.data("quicktip-arrow"),interactive:true,autoDestroy:true});
b.trigger(f)
}})
}}(window.jQuery));
(function(a){CUI.Accordion=new Class({toString:"Accordion",extend:CUI.Widget,construct:function(d){this.isAccordion=(!this.$element.hasClass("collapsible"))&&(this.$element.data("init")!=="collapsible");
if(this.isAccordion){this.$element.addClass("accordion")
}if(this.isAccordion){var b=this.$element.children(".active").index();
if(this.options.active!==false){b=this.options.active
}this.$element.children().each(function(f,g){this._initElement(g,f!=b)
}.bind(this))
}else{this._initElement(this.$element,!(this.options.active||this.$element.hasClass("active")))
}this._setListeners();
this._makeAccessible();
this._updateDOMForDisabled()
},defaults:{active:false,disabled:false},isAccordion:false,_setListeners:function(){var b=this.isAccordion?"> .collapsible > h3":"> h3";
this.$element.on("click",b,this._toggle.bind(this));
this.$element.on("change:active",this._changeActive.bind(this));
this.$element.on("selectstart","h3",function(d){d.preventDefault()
});
this.on("change:disabled",function(d){this._updateDOMForDisabled()
}.bind(this))
},_updateDOMForDisabled:function(){if(this.options.disabled){this.$element.addClass("disabled").attr("aria-disabled",true).find("[role=tab], > [role=button]").removeAttr("tabindex").attr("aria-disabled",true)
}else{this.$element.removeClass("disabled").attr("aria-disabled",false).find("[role=tab], > [role=button]").each(function(b,d){var f=a(d);
f.removeAttr("aria-disabled").attr("tabindex",f.is("[aria-selected=true][aria-controls], [aria-expanded][aria-controls]")?0:-1)
})
}},_toggle:function(d){if(this.options.disabled){return
}var b=a(d.target).closest(".collapsible"),g=b.hasClass("active"),f=(g)?false:((this.isAccordion)?b.index():true);
this.setActive(f)
},_changeActive:function(){if(this.isAccordion){this._collapse(this.$element.children(".active"));
if(this.options.active!==false){var b=this.$element.children().eq(this.options.active);
this._expand(b)
}}else{if(this.options.active){this._expand(this.$element)
}else{this._collapse(this.$element)
}}},setActive:function(b){this.options.active=b;
this._changeActive()
},_initElement:function(f,h){if(a(f).find("> h3").length===0){a(f).prepend("<h3>&nbsp;</h3>")
}if(a(f).find("> h3 > i").length===0){a(f).find("> h3").prepend("<i></i>")
}a(f).addClass("collapsible");
var d=a(f).find("> h3"),b=a("<div></div>").toggle(!h),g=d.find("> i");
a(f).wrapInner(b);
d.prependTo(f);
if(h){a(f).removeClass("active");
a(f).height(d.height());
g.removeClass("icon-chevronup").addClass("icon-chevrondown")
}else{a(f).addClass("active");
a(f).css("height","auto");
g.removeClass("icon-chevrondown").addClass("icon-chevronup")
}},_collapse:function(f){f.find("> h3 > i").removeClass("icon-chevronup").addClass("icon-chevrondown");
f.animate({height:f.find("> h3").height()},{duration:"fast",complete:function(){f.removeClass("active");
f.find("> div[aria-expanded]").hide();
f.trigger("deactivate")
},progress:function(j,g,h){f.trigger("collapse",{animation:j,progress:g,remainingMs:h})
}});
var d=f.find("> h3"),b=d.next("div[aria-expanded]");
if(this.isAccordion){d.attr({tabindex:d.is(document.activeElement)?0:-1,"aria-selected":false})
}else{d.attr({"aria-expanded":false})
}b.attr({"aria-hidden":true,"aria-expanded":false})
},_expand:function(g){g.addClass("active");
g.find("> h3 > i").removeClass("icon-chevrondown").addClass("icon-chevronup");
var f=this._calcHeight(g);
g.animate({height:f},{duration:"fast",complete:function(){g.css("height","auto");
g.trigger("activate")
},progress:function(k,h,j){g.trigger("expand",{animation:k,progress:h,remainingMs:j})
}});
var d=g.find("> h3"),b=d.next("div[aria-expanded]");
if(this.isAccordion){d.attr({tabindex:0,"aria-selected":true})
}else{d.attr({"aria-expanded":true})
}b.attr({"aria-hidden":false,"aria-expanded":true}).show()
},_calcHeight:function(f){var b=a(f).clone(),g=b.find("> div[aria-expanded]");
g.show();
b.css({display:"block",position:"absolute",top:"-10000px",width:f.width(),height:"auto"});
f.parent().append(b);
var d=b.height();
b.remove();
return d
},_makeAccessible:function(){var h="accordion-"+new Date().getTime()+"-",j,f,b,g,d;
if(this.isAccordion){this.$element.attr({role:"tablist"});
this.$element.children(".collapsible").each(function(n,q){var p=a(q),m=p.find("> h3:first"),o=p.hasClass("active"),l=h+"panel-"+n,k=m.next("div");
p.attr({role:"presentation"});
m.attr({role:"tab",id:m.attr("id")||h+"tab-"+n,"aria-controls":l,"aria-selected":o,tabindex:(o?0:-1)});
k.attr({role:"tabpanel",id:l,"aria-labelledby":m.attr("id"),"aria-expanded":o,"aria-hidden":!o})
})
}else{h="collapsible-"+new Date().getTime()+"-";
j=this.$element;
f=j.find("> h3:first");
g=j.hasClass("active");
d=h+"panel";
b=f.next("div");
f.attr({role:"button",id:f.attr("id")||h+"heading","aria-controls":d,"aria-expanded":g,tabindex:0});
b.attr({id:d,"aria-labelledby":f.attr("id"),"aria-expanded":g,"aria-hidden":!g})
}this.$element.on("keydown",":focusable",this._onKeyDown.bind(this));
this.$element.on("focusin.accordion",":focusable",this._onFocusIn.bind(this));
this.$element.on("focusout.accordion","h3:focusable",this._onFocusOut.bind(this));
this.$element.on("touchstart.accordion, mousedown.accordion","h3:focusable",this._onMouseDown.bind(this))
},_onKeyDown:function(g){var f=a(g.currentTarget).closest(".collapsible"),b=f.find("> h3:first"),d=a(g.currentTarget).is(b),h=true;
switch(g.which){case 13:case 32:if(d){b.trigger("click")
}else{h=false
}break;
case 33:case 37:case 38:if((d&&this.isAccordion)||(g.which===33&&(g.metaKey||g.ctrlKey))){if(f.prev().find("> h3:first").focus().length===0){this.$element.find("> .collapsible:last > h3:first").focus()
}}else{if(!d&&(g.metaKey||g.ctrlKey)){b.focus()
}else{h=false
}}break;
case 34:case 39:case 40:if(d&&this.isAccordion){if(f.next().find("> h3:first").focus().length===0){this.$element.find("> .collapsible:first > h3:first").focus()
}}else{if(!d&&g.which===34&&(g.metaKey||g.ctrlKey)){b.focus()
}else{h=false
}}break;
case 36:if(d&&this.isAccordion){this.$element.find("> .collapsible:first > h3:first").focus()
}else{h=false
}break;
case 35:if(d&&this.isAccordion){this.$element.find("> .collapsible:last > h3:first").focus()
}else{h=false
}break;
default:h=false;
break
}if(h===true){g.preventDefault()
}},_onFocusIn:function(g){var f=a(g.currentTarget).closest(".collapsible"),b=f.find("> h3:first"),d=a(g.currentTarget).is(b);
if(this.options.disabled){return
}if(d){if(this.isAccordion){this.$element.find("> .collapsible > h3[role=tab]").attr("tabindex",-1)
}if(!b.data("collapsible-mousedown")){f.addClass("focus")
}else{b.removeData("collapsible-mousedown")
}}b.attr("tabindex",0)
},_onFocusOut:function(g){var f=a(g.currentTarget).closest(".collapsible"),b=f.find("> h3:first"),d=a(g.currentTarget).is(b);
if(d){f.removeClass("focus").removeData("collapsible-mousedown")
}},_onMouseDown:function(g){var f=a(g.currentTarget).closest(".collapsible"),b=f.find("> h3:first"),d=a(g.currentTarget).is(b);
if(d){b.data("collapsible-mousedown",true)
}}});
CUI.Widget.registry.register("accordion",CUI.Accordion);
a(document).on("cui-contentloaded.data-api",function(b){CUI.Accordion.init(a("[data-init~=accordion],[data-init~=collapsible]",b.target))
})
}(window.jQuery));
(function(a){CUI.Tour=new Class({toString:"Tour",extend:CUI.Widget,construct:function(d){var b;
this.$slides=this.$element.find(".tour-slide");
this.$navigation=this.$element.find("nav");
this.$skip=this.$navigation.find("button.skip");
this.$done=this.$navigation.find("button.done");
this.$prev=this.$navigation.find("a.prev");
this.$next=this.$navigation.find("a.next");
this.$control=this.$navigation.find(".control");
this.$current=this.$element.find(".tour-slide.active");
this.$current=this.$current.length>0?this.$current:this.$element.find(".tour-slide:eq(0)").addClass("active");
this._setCircleNav(this.$current);
this._toggleButtons(this.$current);
this._bindControls();
if(this.$element.hasClass("show")){this.options.autoshow=true
}if(this.options.autoshow){this.show()
}},defaults:{autoshow:false,backdrop:"static"},_toggleButtons:function(b){this.$skip.removeClass("show");
this.$done.removeClass("show");
this.$prev.removeClass("hide");
this.$next.removeClass("hide");
if(b.hasClass("first")){this.$skip.addClass("show");
this.$prev.addClass("hide")
}else{if(b.hasClass("last")||b.hasClass("skipper")){this.$done.addClass("show");
this.$next.addClass("hide")
}}},_setCircleNav:function(d){var b=d.index();
if(d.hasClass("skipper")){this.$control.removeClass("show").addClass("hide")
}else{this.$control.removeClass("hide").addClass("show").find("a").removeClass("active").filter(":eq("+b+")").addClass("active")
}},_slideTo:function(b){var d=a(b);
if(d.length>0){this.$current.find(".fadable").addClass("faded");
this.$current.removeClass("active");
this.$current=d.addClass("active");
this._setCircleNav(d);
this._toggleButtons(d);
this._stopLastAnimation();
this._startNewAnimation()
}},slideToNext:function(){var b=this.$current.next(".tour-slide");
if(!this.$current.hasClass("last")){this._slideTo(b)
}return this
},slideToPrev:function(){var b=this.$current.hasClass("skipper")?this.$element.find(".first"):this.$current.prev(".tour-slide");
this._slideTo(b);
return this
},slideToSkipper:function(){var b=this.$element.find(".skipper");
this._slideTo(b);
return this
},slideToFirst:function(){var b=this.$element.find(".first");
this._slideTo(b);
return this
},slideTo:function(b){this._slideTo(this.$slides[b]);
return this
},_bindControls:function(){this.$navigation.on("click","a",function(b){b.preventDefault()
});
this.$skip.fipo("tap","click",this.slideToSkipper.bind(this));
this.$done.fipo("tap","click",this.hide.bind(this));
this.$prev.fipo("tap","click",this.slideToPrev.bind(this));
this.$next.fipo("tap","click",this.slideToNext.bind(this));
this.$control.fipo("tap","click","a",function(b){this.slideTo(a(b.currentTarget).index())
}.bind(this));
this.$element.finger("swipe",".tour-slide",function(b){if(b.finger===1){if(b.direction==="left"){this.slideToNext()
}else{if(b.direction==="right"){this.slideToPrev()
}}}}.bind(this))
},_startNewAnimation:function(){var b=this.$current.find(".fadable");
if(b){this._animationTimer=setInterval(function(){b.toggleClass("faded")
},5000)
}},_stopLastAnimation:function(){clearInterval(this._animationTimer)
},_show:function(){this.$element.addClass("show");
this.slideToFirst();
this._toggleBackdrop(true);
this._startNewAnimation()
},_hide:function(){this.$element.removeClass("show");
this._toggleBackdrop();
this._stopLastAnimation()
},_removeBackdrop:function(){if(this.$backdrop&&!this.get("visible")){this.$backdrop.remove();
this.$backdrop=null
}},_toggleBackdrop:function(b){if(b&&this.options.backdrop){if(this.$backdrop){this.$backdrop.fadeIn()
}else{this.$backdrop=a("<div/>",{"class":"tour-backdrop",css:{display:"none"}}).appendTo(document.body);
setTimeout(function(){this.$backdrop.fadeIn()
}.bind(this),50);
if(this.options.backdrop!=="static"){this.$backdrop.click(this.hide)
}}}else{if(!b&&this.$backdrop){this.$backdrop.fadeOut(function(){this._removeBackdrop()
}.bind(this))
}}}});
CUI.util.plugClass(CUI.Tour);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init=tour]",b.target).tour()
})
}}(window.jQuery));
(function(d){var j='<div class="button-group navigation-bar"></div>';
var h="<button id='classicButton'><i class=\"icon-viewgrid\"></i></button>";
var a="<button id='editButton'><i class=\"icon-edit\"></i></button>";
var b='<button><i class="icon-properties"></i></button>';
var f="editMode";
var g="classicMode";
CUI.Colorpicker=new Class({toString:"Colorpicker",extend:CUI.Widget,defaults:{config:{colors:{},displayModes:{}},disabled:false,name:null,title:""},palettePageSize:3,colorShadeNo:6,lowerLimit:0,upperLimit:0,colorNames:[],currentPage:0,pages:1,construct:function(k){this._readDataFromMarkup();
this._adjustMarkup();
if(this.options.config===null||this.options.config.colors.length===0){this.options.disabled=true
}if(!this.options.disabled&&(this.options.config.displayModes.classicPalette&&this.options.config.displayModes.freestylePalette)){this.options.disabled=true
}if(!this.options.disabled&&(this.options.config.displayModes.length===0||(!this.options.config.displayModes.classicPalette&&!this.options.config.displayModes.freestylePalette))){this.options.config.displayModes.classicPalette=true
}this.$openButton=this.$element.find("input.colorpicker-launcher");
this.$hiddenInput=this.$element.find("input[name='"+this.options.name+"']");
if(this.$element.attr("value")){var l=this.$element.attr("value");
if(CUI.util.color.isValid("rgba",l)||CUI.util.color.isValid("rgb",l)){this._setColor(l)
}else{this.$element.removeAttr("value")
}}if(this.options.disabled){this.$element.find(">input").attr("disabled","disabled")
}else{this.colorNames=[];
d.each(this.options.config.colors,function(m,n){this.colorNames.push(m)
}.bind(this));
d("body").off("tap."+this.options.name+" click."+this.options.name).fipo("tap."+this.options.name,"click."+this.options.name,function(m){if(!this.keepShown){if(this.$element.find(".popover").has(m.target).length===0){this._hidePicker()
}}}.bind(this));
this.$openButton.on("click",function(m){try{if(!this.pickerShown){this._openPicker()
}else{this._hidePicker()
}this.keepShown=true;
setTimeout(function(){this.keepShown=false
}.bind(this),200)
}catch(n){}}.bind(this))
}},_readDataFromMarkup:function(){if(this.$element.data("disabled")){this.options.disabled=true
}if(this.$element.data("name")){this.options.name=this.$element.data("name")
}if(this.$element.attr("title")){this.options.title=this.$element.attr("title")
}var k=this.$element;
if(k.data("config")!==undefined){this.options.config={};
this.options.config.colors={};
this.options.config.displayModes={};
if(k.data("config").colors){this.options.config.colors=k.data("config").colors
}else{this.options.disabled=true
}if(k.data("config").pickerModes){this.options.config.displayModes=k.data("config").pickerModes
}}},_adjustMarkup:function(){this.$element.addClass("colorpicker");
if(this.$element.find(".popover").length===0){this.$element.append('<div class="popover arrow-top" style="display:none"><div class="inner"></div></div>');
this.$element.find(".inner").append('<div class="colorpicker-holder"><div class="palette-header"></div><div class="colorpicker-body"></div><div class="colorpicker-footer"></div></div>')
}if(this.$element.find("input[type=hidden]").length===0){this.$element.append('<input type="hidden" name="'+this.options.name+'">')
}var k=this.$element.find("input.colorpicker-launcher");
if(k.attr("type")===undefined){k.attr("type","button")
}},_openPicker:function(){this._renderPicker(g);
var l=this.$openButton.position().left+this.$openButton.width()/2-(this.$element.find(".popover").width()/2+9);
if(l<0){l=0
}var k=this.$openButton.position().top+this.$openButton.outerHeight()+14;
this._renderPickerFooter();
this.$element.find(".popover").css({position:"absolute",left:l+"px",top:k+"px"}).show();
this.pickerShown=true
},_hidePicker:function(){this.lowerLimit=0;
this.upperLimit=0;
this.currentPage=0;
this.$element.removeClass("focus");
this.$element.find(".popover").hide();
this.pickerShown=false
},_renderPicker:function(r,q,k){if(r===g&&!this._calculatePaletteBoundaries(q,k)){return
}var t=null;
if(r===g){t=this._renderPalette()
}else{t=this._renderEditPalette()
}var n=this.$element.find(".colorpicker-holder");
var l=n.find(".palette-navigator");
var p=n.find(".colorpicker-body");
if(q&&n.find("table").length>0){this._slidePicker(t,(q==="left"))
}else{n.find("table").remove();
n.find(".sliding-container").remove();
if(r===f){p.append(t);
l.remove();
if(this.$hiddenInput.val()!==undefined&&this.$hiddenInput.val().length>0){t.find("div.color").css("background",this.$hiddenInput.val());
var o=CUI.util.color.RGBAToHex(this.$hiddenInput.val());
t.find("input[name=':hex']").val(o);
var s=CUI.util.color.HexToRGB(o);
this._fillRGBFields(s);
var m=CUI.util.color.RGBtoCMYK(s);
this._fillCMYKFields(m)
}}else{if(l.length>0){l.before(t)
}else{p.append(t);
this._renderPaletteNavigation()
}}}},_renderPickerFooter:function(){this.$element.find(".colorpicker-footer").html(j);
if(this.options.config.displayModes!==undefined){if(this.options.config.displayModes.classicPalette||this.options.config.displayModes.freestylePalette){var k=d(h);
k.addClass("selected");
this.$element.find(".navigation-bar").append(k)
}if(this.options.config.displayModes.edit){this.$element.find(".navigation-bar").append(a)
}else{this.$element.find(".colorpicker-footer").remove();
return
}}this.$element.find(".colorpicker-footer button").off("tap.button click.button").fipo("tap.button","click.button",function(m){m.stopPropagation();
m.preventDefault();
var l=d(m.target);
var n=null;
this.$element.find(".navigation-bar > .selected").removeClass("selected");
if(m.target.nodeName==="BUTTON"){l.addClass("selected");
n=d(m.target)
}else{l.parent().addClass("selected");
n=l.parent()
}if(n.attr("id")==="editButton"){this._renderPicker(f)
}else{this._renderPicker(g,false,this.currentPage)
}}.bind(this))
},_calculatePaletteBoundaries:function(k,m){var l=0;
if(this.options.config.displayModes.freestylePalette){l=this.palettePageSize*this.colorShadeNo
}else{l=this.palettePageSize
}if(!k){if(m!==undefined){this.lowerLimit=l*m;
this.upperLimit=this.lowerLimit+l-1;
this.currentPage=m
}else{this.upperLimit+=l-1;
this.lowerLimit=0;
this.currentPage=0
}}else{if(k==="left"){m=this.currentPage+1;
if(m+1>this.pages){return false
}this.lowerLimit=l*m;
this.upperLimit=this.lowerLimit+l-1;
this.currentPage=m
}else{m=this.currentPage-1;
if(m<0){return false
}this.lowerLimit=l*m;
this.upperLimit=this.lowerLimit+l-1;
this.currentPage=m
}}return true
},_renderPaletteNavigation:function(){this.$element.find(".palette-navigator").remove();
var k=d("<div>");
k.addClass("palette-navigator");
if(this.options.config.displayModes.classicPalette){this.pages=Math.ceil(this.colorNames.length/this.palettePageSize)
}else{this.pages=Math.ceil(this.colorNames.length/(this.palettePageSize*this.colorShadeNo))
}if(this.pages>1){for(var l=0;
l<this.pages;
l++){k.append("<i class='dot' page='"+l+"'></i>")
}}this.$element.find(".colorpicker-body").append(k);
this.$element.find("i[page='"+this.currentPage+"']").addClass("active");
this.$element.find(".colorpicker-body").on("swipe",function(m){this._renderPicker(g,m.direction==="left"?"left":"right")
}.bind(this));
this.$element.find(".dot").off("tap.dot click.dot").fipo("tap.dot","click.dot",function(m){m.stopPropagation();
if(this.currentPage===parseInt(d(m.target).attr("page"),10)){return
}this._renderPicker(g,false,parseInt(d(m.target).attr("page"),10))
}.bind(this))
},_slidePicker:function(m,q){this.$element.find(".sliding-container table").stop(true,true);
this.$element.find(".sliding-container").remove();
var p=this.$element.find("table");
var n=p.width();
var k=p.height();
var l=d('<div class="sliding-container">');
l.css({display:"block",position:"relative",width:n+"px",height:k+"px",overflow:"hidden"});
this.$element.find(".palette-navigator").before(l);
l.append(p).append(m);
p.css({position:"absolute",left:0,top:0});
p.after(m);
m.css({position:"absolute",left:(q)?n:-n,top:0});
var o=400;
p.animate({left:(q)?-n:n},o,function(){p.remove()
});
m.animate({left:0},o,function(){if(l.parents().length===0){return
}m.css({position:"relative",left:0,top:0});
m.detach();
this.$element.find(".palette-navigator").before(m);
l.remove()
}.bind(this))
},_renderPaletteHeader:function(){var l=d('<div class="palette-header"><div class="title"></div><div class="selection"></div></div>');
var k=this.$element.find(".colorpicker-holder");
if(k.find(".palette-header").length>0){k.find(".palette-header").replaceWith(l)
}else{k.prepend(l)
}k.find(".title").html("<span>"+this.options.title+"</span>")
},_renderPalette:function(){this._renderPaletteHeader();
var r=d("<table>");
var l="";
for(var k=0;
k<this.palettePageSize;
k++){l+="<tr>";
var n=0;
var p="";
var s="";
var q="";
for(var m=0;
m<this.colorShadeNo;
m++){if(this.options.config.displayModes.classicPalette){if(this.colorNames.length-1<k+this.lowerLimit){l+="<td><a></a></td>"
}else{p=CUI.util.color.HexToRGB(this.options.config.colors[this.colorNames[k+this.lowerLimit]]);
q="rgba("+p.r+","+p.g+","+p.b+","+(1-n).toFixed(2)+")";
n+=0.16;
if(CUI.util.color.isSameColor(q,this.$hiddenInput.val())){s="selected";
this._fillSelectedColor(this.colorNames[k+this.lowerLimit],CUI.util.color.RGBAToHex(q))
}else{s=""
}l+="<td class='filled'><a style='background-color:"+q+"' color='"+q+"' colorName='"+this.colorNames[k+this.lowerLimit]+"' class='"+s+"'></a></td>"
}}else{if(this.colorNames.length-1<k*this.colorShadeNo+m){l+="<td><a></a></td>"
}else{p=CUI.util.color.HexToRGB(this.options.config.colors[this.colorNames[k*this.colorShadeNo+m]]);
q="rgba("+p.r+","+p.g+","+p.b+","+1+")";
if(CUI.util.color.isSameColor(q,this.$hiddenInput.val())){s="selected"
}else{s=""
}l+="<td class='filled'><a style='background-color:"+q+"' color='"+q+"' colorName='"+this.colorNames[k*this.colorShadeNo+m]+"' class='"+s+"'></a></td>"
}}}l+="</tr>"
}r.append("<tbody>"+l+"</tbody>");
r.find("a").off("tap.a click.a").fipo("tap.a","click.a",function(u){u.stopPropagation();
u.preventDefault();
if(CUI.util.color.isSameColor(this.$hiddenInput.val(),d(u.target).attr("color"))){return
}this.$element.find("table").find(".selected").removeClass("selected");
d(u.target).addClass("selected");
var t=d(u.target).attr("colorName")!==undefined?d(u.target).attr("colorName"):"";
this._fillSelectedColor(t,CUI.util.color.RGBAToHex(d(u.target).attr("color")));
this._setColor(d(u.target).attr("color"))
}.bind(this));
var o=this.$element.find(".palette-navigator");
o.find(".active").removeClass("active");
o.find("i[page='"+this.currentPage+"']").addClass("active");
return r
},_fillSelectedColor:function(k,l){this.$element.find(".colorpicker-holder").find(".selection").html("<div><span>"+k+"</span><span>"+l+"</span></div>")
},_renderEditPalette:function(){var l=d("<table>");
var k="<tr><td colspan='2' rowspan='2'><div class='color'></div></td><td class='label'>HEX</td><td colspan='2'><input type='text' name=':hex'/></td><td colspan='2'>&nbsp;</td></tr><tr><td class='label'>RGB</td><td><input type='text' name=':rgb_r'/></td><td><input type='text' name=':rgb_g'/></td><td><input type='text' name=':rgb_b'/></td><td>&nbsp;</td></tr><tr><td colspan='2'>&nbsp;</td><td class='label'>CMYK</td><td><input type='text' name=':cmyk_c'/></td><td><input type='text' name=':cmyk_m'/></td><td><input type='text' name=':cmyk_y'/</td><td><input type='text' name=':cmyk_k'/></td></tr><tr><td colspan='3'>&nbsp;</td><td colspan='4'><button class='primary'>Save Color</button></td></tr>";
l.append("<tbody>"+k+"</tbody>");
this.$element.find(".palette-header").remove();
l.find("input[name^=':rgb_']").each(function(m,n){d(n).attr("maxlength","3");
d(n).on("blur",function(r){var s=/^([0]|[1-9]\d?|[1]\d{2}|2([0-4]\d|5[0-5]))$/;
if(!s.test(d(r.target).val().trim())||d("input:text[value=''][name^='rgb_']").length>0){d(r.target).val("");
this._clearCMYKFields();
this.$element.find("input[name=':hex']").val("");
this.$element.find("div.color").removeAttr("style");
return
}var o={r:this.$element.find("input[name=':rgb_r']").val(),g:this.$element.find("input[name=':rgb_g']").val(),b:this.$element.find("input[name=':rgb_b']").val()};
var q=CUI.util.color.RGBtoCMYK(o);
var p=CUI.util.color.RGBToHex(o);
this._fillCMYKFields(q);
this.$element.find("input[name=':hex']").val(p);
this.$element.find("div.color").css("background",p)
}.bind(this))
}.bind(this));
l.find("input[name^=':cmyk_']").each(function(m,n){d(n).attr("maxlength","3");
d(n).on("blur",function(r){var s=/^[1-9]?[0-9]{1}$|^100$/;
if(!s.test(d(r.target).val().trim())||d("input:text[value=''][name^='cmyk_']").length>0){d(r.target).val("");
this._clearRGBFields();
this.$element.find("input[name=':hex']").val("");
this.$element.find("div.color").removeAttr("style");
return
}var q={c:this.$element.find("input[name=':cmyk_c']").val(),m:this.$element.find("input[name=':cmyk_m']").val(),y:this.$element.find("input[name=':cmyk_y']").val(),k:this.$element.find("input[name=':cmyk_k']").val()};
var o=CUI.util.color.CMYKtoRGB(q);
var p=CUI.util.color.RGBToHex(o);
this.$element.find("input[name=':hex']").val(p);
this._fillRGBFields(o);
this.$element.find("div.color").css("background",p)
}.bind(this))
}.bind(this));
l.find("input[name=':hex']").each(function(m,n){d(n).attr("maxlength","7");
d(n).on("blur",function(r){var q=CUI.util.color.fixHex(d(r.target).val().trim());
if(q.length===0){this._clearRGBFields();
this._clearCMYKFields();
this.$element.find("div.color").removeAttr("style");
return
}var o=CUI.util.color.HexToRGB(q);
var p=CUI.util.color.RGBtoCMYK(o);
this._fillRGBFields(o);
this._fillCMYKFields(p);
l.find("div.color").css("background",q)
}.bind(this))
}.bind(this));
l.on("click tap","input, div",function(m){m.stopPropagation();
m.preventDefault()
});
l.on("click tap","button",function(m){m.stopPropagation();
m.preventDefault();
if(this.$element.find("input[name=':hex']").val()!==undefined&&this.$element.find("input[name=':hex']").val().length>0){this._setColor(this.$element.find("input[name=':hex']").val())
}}.bind(this));
return l
},_setColor:function(k){this.$hiddenInput.val(k);
this.$openButton.css("background-color",this.$hiddenInput.val())
},_fillRGBFields:function(k){this.$element.find("input[name=':rgb_r']").val(k.r);
this.$element.find("input[name=':rgb_g']").val(k.g);
this.$element.find("input[name=':rgb_b']").val(k.b)
},_clearRGBFields:function(){this.$element.find("input[name^=':rgb']").val("")
},_fillCMYKFields:function(k){this.$element.find("input[name=':cmyk_c']").val(k.c);
this.$element.find("input[name=':cmyk_m']").val(k.m);
this.$element.find("input[name=':cmyk_y']").val(k.y);
this.$element.find("input[name=':cmyk_k']").val(k.k)
},_clearCMYKFields:function(){this.$element.find("input[name^=':cmyk']").val("")
}});
CUI.Widget.registry.register("colorpicker",CUI.Colorpicker);
if(CUI.options.dataAPI){d(document).on("cui-contentloaded.data-api",function(k){CUI.Colorpicker.init(d("[data-init~=colorpicker]",k.target))
})
}}(window.jQuery));
(function(a){CUI.NumberInput=new Class({toString:"NumberInput",extend:CUI.Widget,construct:function(b){this._fixMarkup();
this._setListeners();
this._setAttributes()
},defaults:{max:null,min:null,step:1,hasError:false,disabled:false},increment:function(){if(this._isNumber()){var b=this.getValue();
b+=this.getStep();
b=b>this.getMax()?this.getMax():b;
this.setValue(b)
}},decrement:function(){var b=this.getValue();
b-=this.getStep();
b=b<this.getMin()?this.getMin():b;
this.setValue(b)
},setValue:function(b){this.$input.val(b);
this.$input.trigger("change")
},setMin:function(b){this.set("min",b)
},setMax:function(b){this.set("max",b)
},setStep:function(b){this.set("step",b)
},getValue:function(){var b=this.$input.val();
if(typeof b=="undefined"||b==null||b.length<1){b=""
}else{b=parseFloat(b)
}return b
},getMin:function(){return parseFloat(this.options.min)
},getMax:function(){return parseFloat(this.options.max)
},getStep:function(){return parseFloat(this.options.step)
},_fixMarkup:function(){this.$input=this.$element.find("input").not("[type=hidden]");
if(this.$input.attr("type")!="text"){this._switchInputTypeToText(this.$input)
}var b=this.$element.find("button");
if(b&&b.length==2){this.$decrementElement=a(b[0]);
this.$incrementElement=a(b[1])
}else{a.each(b,function(d){a(b[d]).detach()
});
this.$decrementElement=a('<button type="button">');
this.$incrementElement=a('<button type="button">');
this.$input.before(this.$decrementElement);
this.$input.after(this.$incrementElement)
}this.$decrementElement.addClass("decrement").html("decrement");
this.$incrementElement.addClass("increment").html("increment")
},_setListeners:function(){this.$input.on("change",function(){this._checkMinMaxViolation();
this._adjustValueLimitedToRange()
}.bind(this));
this.on("beforeChange:step",function(b){this._optionBeforeChangeHandler(b)
}.bind(this));
this.on("beforeChange:min",function(b){this._optionBeforeChangeHandler(b)
}.bind(this));
this.on("beforeChange:max",function(b){this._optionBeforeChangeHandler(b)
}.bind(this));
this.on("change:disabled",function(b){this._toggleDisabled()
}.bind(this));
this.on("change:hasError",function(b){this._toggleError()
}.bind(this));
this.$incrementElement.on("click",function(){this.increment()
}.bind(this));
this.$decrementElement.on("click",function(b){this.decrement()
}.bind(this))
},_setAttributes:function(){this.$element.addClass("numberinput");
if(this.$input.attr("max")){this.setMax(this.$input.attr("max"))
}if(this.$input.attr("min")){this.setMin(this.$input.attr("min"))
}if(this.$input.attr("step")){this.setStep(this.$input.attr("step"))
}if(this.$element.attr("error")){this.options.hasError=true
}this.setStep(this.options.step||CUI.Datepicker.step);
this.setValue(this.$input.val()||0);
if(this.$element.attr("disabled")||this.$element.attr("data-disabled")){this._toggleDisabled()
}if(this.$element.hasClass("error")||this.$element.attr("data-error")){this.set("hasError",true)
}},_adjustValueLimitedToRange:function(){var b=this.getValue();
if(!isNaN(b)){if(b>this.getMax()){b=this.getMax()
}else{if(b<this.getMin()){b=this.getMin()
}}}this.$input.val(b)
},_checkMinMaxViolation:function(){if(this._isNumber()){this.$incrementElement.removeAttr("disabled");
this.$decrementElement.removeAttr("disabled");
if(this.options.max&&this.getValue()>=this.getMax()){this.$incrementElement.attr("disabled","disabled")
}else{if(this.options.min&&this.getValue()<=this.getMin()){this.$decrementElement.attr("disabled","disabled")
}}}},_switchInputTypeToText:function(d){var b=d.detach().attr("type","text");
this.$element.prepend(b)
},_isNumber:function(){return !isNaN(this.$input.val())
},_optionBeforeChangeHandler:function(b){if(isNaN(parseFloat(b.value))){b.preventDefault()
}},_toggleDisabled:function(){if(this.options.disabled){this.$incrementElement.attr("disabled","disabled");
this.$decrementElement.attr("disabled","disabled");
this.$input.attr("disabled","disabled")
}else{this.$incrementElement.removeAttr("disabled");
this.$decrementElement.removeAttr("disabled");
this.$input.removeAttr("disabled")
}},_toggleError:function(){if(this.options.hasError){this.$element.addClass("error")
}else{this.$element.removeClass("error")
}}});
CUI.Widget.registry.register("numberinput",CUI.NumberInput);
a(document).on("cui-contentloaded.data-api",function(b){CUI.NumberInput.init(a("[data-init~=numberinput]",b.target))
})
}(window.jQuery));
(function(a){function b(f){var d=f.next();
if(d.length>0){return d
}return f.prevAll().last()
}CUI.CycleButtons=new Class({toString:"CycleButtons",extend:CUI.Widget,construct:function(){this.$element.on("click tap",function(g){if(g._cycleButtons){return
}g.stopPropagation();
g.preventDefault();
var d=a(this);
if(d.children().length===1){return
}var j=d.children(".cyclebuttons-active");
var h=b(j);
j.removeClass("cyclebuttons-active");
h.addClass("cyclebuttons-active");
var f=a.Event("click",{_cycleButtons:true});
h.trigger(f)
})
}});
CUI.Widget.registry.register("cyclebuttons",CUI.CycleButtons);
a(document).on("cui-contentloaded.data-api",function(d){CUI.CycleButtons.init(a("[data-init~='cyclebuttons']",d.target))
})
}(window.jQuery));
(function(b,a,d){CUI.Select=new Class({toString:"Select",extend:CUI.Widget,construct:function(){var f=this;
this._button=this.$element.children("button");
this._select=this.$element.children("select");
this._selectList=this.$element.children(".selectlist");
this._tagList=this.$element.children(".taglist");
this._valueInput=this.$element.children("input[type=hidden]");
this.applyOptions()
},defaults:{type:"static",nativewidget:false,nativewidgetonmobile:true,multiple:false,tagConfig:null,selectlistConfig:null},applyOptions:function(){var f=this.options.nativewidgetonmobile&&CUI.util.isTouch&&this.options.type==="static";
if(this._select.length>0){if(this._select.prop("multiple")){this.options.multiple=true
}}if(this.options.nativewidget||f){this._setNativeWidget(f)
}else{this._setSelectList()
}this._setTagList();
if(this.options.type==="static"){this._handleNativeSelect()
}},getValue:function(){if(this.options.multiple){return this._tagListWidget.getValues()
}else{if(this.options.type==="static"){return this._select[0][this._select[0].selectedIndex].value
}else{if(this.options.type==="dynamic"){return this._valueInput.val()
}}}return null
},_setNativeWidget:function(g){var f=this;
if(this.options.nativewidget||g){this.$element.addClass("native");
this._select.css({height:this._button.outerHeight()});
if(this.options.multiple){this._setTagList()
}this._select.on("change.select",this._handleNativeSelect.bind(this))
}else{this.$element.removeClass("native");
this._select.off("change.select")
}},_handleNativeSelect:function(h){var f=this,g,j;
if(f.options.multiple){b.each(f._select[0].options,function(l,k){if(k.selected){f._tagListWidget.addItem({value:k.value,display:k.text})
}else{f._tagListWidget.removeItem(k.value)
}});
g=f._tagListWidget.getValues()
}else{if(f._select[0]){j=f._select[0][f._select[0].selectedIndex];
f._button.text(j.text);
g=j.value
}}if(h){this.$element.trigger(b.Event("selected",{selected:g}))
}},_parseMarkup:function(){var g=this,h=this._select.children("optgroup");
function f(k,j){k.children("option").each(function(m,n){var l=b(n);
b("<li/>",{"data-value":l.val(),text:l.text()}).appendTo(j)
})
}if(h.length>0){h.each(function(j,m){var l=b(m),k=b("<li/>",{"class":"optgroup"}).append(b("<span/>",{text:l.attr("label")}));
f(l,b("<ul/>").appendTo(k));
g._selectList.append(k)
})
}else{f(this._select,this._selectList)
}},_setSelectList:function(){var f=this,g="static";
if(this._selectList.length===0){this._selectList=b("<ul/>",{id:CUI.util.getNextId(),"class":"selectlist"}).appendTo(this.$element)
}else{if(!this._selectList.attr("id")){this._selectList.attr("id",CUI.util.getNextId())
}}this._button.attr({"data-toggle":"selectlist","data-target":"#"+this._selectList.attr("id")});
if(this._select.length>0){this._parseMarkup()
}else{g="dynamic"
}this._selectList.selectList(b.extend({relatedElement:this._button,type:g},this.options.selectlistConfig||{}));
this._selectListWidget=this._selectList.data("selectList");
this._selectList.on("selected.select",this._handleSelected.bind(this)).on("show.select hide.select",function(h){f._button.toggleClass("active",h.type==="show")
})
},_setTagList:function(){if(this.options.multiple){if(this._tagList.length===0){this._tagList=b("<ol/>",{"class":"taglist"}).appendTo(this.$element)
}this._tagList.tagList(this.options.tagConfig||{});
this._tagListWidget=this._tagList.data("tagList")
}},_handleSelected:function(g){var f;
if(g){g.stopPropagation()
}this._selectListWidget.hide();
if(g.selectedValue===true){this._select.find("option[value=true]").prop("selected","selected")
}else{this._select.val(g.selectedValue)
}if(this.options.multiple){this._tagListWidget.addItem({value:g.selectedValue,display:g.displayedValue});
f=this._tagListWidget.getValues()
}else{this._button.text(g.displayedValue);
this._valueInput.val(g.selectedValue);
f=""+g.selectedValue
}this._button.trigger("focus");
this.$element.trigger(b.Event("selected",{selected:f}))
}});
CUI.Widget.registry.register("select",CUI.Select);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){CUI.Select.init(b("[data-init~=select]",f.target))
})
}}(jQuery,this));
(function(h,g,j){CUI.SelectList=new Class({toString:"SelectList",extend:CUI.Widget,construct:function(k){this.applyOptions();
this.$element.on("change:type",this._setType.bind(this)).on("click",this._SELECTABLE_SELECTOR,this._triggerSelected.bind(this)).on("mouseenter",this._SELECTABLE_SELECTOR,this._handleMouseEnter.bind(this));
this._makeAccessible()
},defaults:{type:"static",multiple:false,relatedElement:null,autofocus:true,autohide:true,dataurl:null,dataurlformat:"html",datapaging:true,datapagesize:10,dataadditional:null,loadData:h.noop,position:"center bottom-1"},_SELECTABLE_SELECTOR:'[role="option"]:visible:not([aria-disabled="true"])',applyOptions:function(){this._setType()
},_setType:function(){var l=this,m;
function k(){var o=l.$element.get(0),n=o.scrollHeight,p=o.scrollTop;
if((n-l.$element.height())<=(p+30)){l._handleLoadData()
}}if(this.options.type==="dynamic"){this.$element.on("scroll.selectlist-dynamic-load",function(n){if(m){clearTimeout(m)
}if(l._loadingComplete||this._loadingIsActive){return
}m=setTimeout(k,500)
})
}else{this.$element.off("scroll.selectlist-dynamic-load")
}},_makeAccessible:function(){var k=this;
this.$element.attr({role:"listbox","aria-controls":h(this.options.relatedElement).attr("id")||"","aria-hidden":true,"aria-multiselectable":this.options.multiple});
this._makeAccessibleListOption(this.$element.children())
},_handleKeyDown:function(n){var l=this.$element.find(this._SELECTABLE_SELECTOR),m=l.filter(".focus"),k=l.index(m),o;
if(!l.length){return
}switch(n.which){case 13:case 32:if(m.length){m.trigger("click");
n.preventDefault()
}break;
case 27:this.hide();
n.preventDefault();
break;
case 33:case 37:case 38:if(k>0){o=l[k-1]
}else{if(k==-1){o=l[l.length-1]
}}n.preventDefault();
break;
case 34:case 39:case 40:if(k+1<l.length){o=l[k+1]
}n.preventDefault();
break;
case 36:o=l[0];
n.preventDefault();
break;
case 35:o=l[l.length-1];
n.preventDefault();
break
}if(o!==j){this.setCaretToItem(h(o),true)
}},_makeAccessibleListOption:function(k){k.each(function(l,n){var m=h(n);
if(m.hasClass("optgroup")){m.attr({role:"presentation"}).children("ul").attr({role:"group"}).children("li").attr({role:"option"})
}else{m.attr({role:"option"})
}})
},setCaretToItem:function(k,l){this.$element.find('[role="option"]').removeClass("focus");
k.addClass("focus");
if(l){this.scrollToItem(k)
}},resetCaret:function(){this.$element.find('[role="option"]').removeClass("focus");
this.$element.scrollTop(0)
},scrollToItem:function(k){if(!k.length){return
}var l=k.position().top,o=k.outerHeight(false),m=this.$element[0];
var n=l+o-m.clientHeight;
if(n>0){m.scrollTop+=n
}else{if(l<0){m.scrollTop+=l
}}},show:function(){if(this.options.visible){return this
}else{b();
return this.inherited(arguments)
}},_show:function(){var k=this;
this.$element.addClass("visible").attr("aria-hidden",false);
this.$element.position({my:"top",at:this.options.position,of:this.options.relatedElement});
if(this.options.autofocus){this.setCaretToItem(this.$element.find(this._SELECTABLE_SELECTOR).first(),true)
}if(this.options.type==="dynamic"){this._handleLoadData().done(function(){if(k.options.autofocus){k.setCaretToItem(k.$element.find(k._SELECTABLE_SELECTOR).first(),true)
}})
}h(document).on("keydown.selectlist",this._handleKeyDown.bind(this))
},_hide:function(){this.$element.removeClass("visible").attr("aria-hidden",true);
this.reset();
h(document).off("keydown.selectlist")
},_triggerSelected:function(k){var n=h(k.currentTarget),m=n.data("value"),l=n.text();
n.trigger(h.Event("selected",{selectedValue:m,displayedValue:l}))
},_handleMouseEnter:function(k){this.setCaretToItem(h(k.currentTarget),false)
},clearItems:function(){this.$element.empty()
},_pagestart:0,_loadingComplete:false,_loadingIsActive:false,_handleLoadData:function(){var n,l=this,k=this._pagestart+this.options.datapagesize,m=h("<div/>",{"class":"selectlist-wait"}).append(h("<span/>",{"class":"wait"}));
if(this._loadingIsActive){return h.Deferred().resolve().promise()
}this._loadingIsActive=true;
this.$element.append(m);
if(this.options.dataurl){n=h.ajax({url:this.options.dataurl,context:this,dataType:this.options.dataurlformat,data:h.extend({start:this._pagestart,end:k},this.options.dataadditional||{})}).done(function(q){var o=0;
if(l.options.dataurlformat==="html"){var p=h(q);
o=p.filter("li").length;
l._makeAccessibleListOption(p);
l.$element.append(p)
}if(o<l.options.datapagesize){this._loadingComplete=true
}})
}else{n=this.options.loadData.call(this,this._pagestart,k)
}this._pagestart=k;
n.always(function(){m.remove();
l._loadingIsActive=false
});
return n
},reset:function(){if(this.options.type==="dynamic"){this.clearItems();
this._pagestart=0;
this._loadingComplete=false
}},triggerLoadData:function(k){if(k){this.reset()
}this._handleLoadData()
},filter:function(m){var l=this.$element.find('[role="option"]'),k=this.$element.find(".optgroup");
if(m){l.each(function(){var n=h(this);
var o=!m.call(this,n.data("value"),n.text());
n.toggleClass("hidden",o);
if(o){n.removeClass("focus")
}});
k.each(function(){var o=h(this);
var n=o.find('[role="option"]:not(.hidden)').length>0;
o.toggleClass("hidden",!n)
})
}else{l.removeClass("hidden");
k.removeClass("hidden")
}}});
CUI.Widget.registry.register("selectlist",CUI.SelectList);
if(CUI.options.dataAPI){h(document).on("cui-contentloaded.data-api",function(k){CUI.SelectList.init(h("[data-init~=selectlist]",k.target))
})
}var a=".selectlist",f="[data-toggle~=selectlist]";
var b=function(){h(".selectlist").each(function(){var k=h(this).data("selectList");
if(k&&k.get("autohide")){k.hide()
}})
};
var d=function(){var k=CUI.util.getDataTarget(h(this));
if(k.length){k.data("selectList").toggleVisibility()
}return false
};
h(document).on("click.selectlist",b).on("click.selectlist",a,function(k){k.stopPropagation()
}).on("click.selectlist",f,d)
}(jQuery,this));
(function(b,a,d){CUI.TagList=new Class({toString:"TagList",extend:CUI.Widget,construct:function(g){var f=this;
this.applyOptions();
this.$element.on("change:values",this._setValues.bind(this));
this.$element.fipo("tap","click","button",function(j){var h=b(j.currentTarget).next("input");
f.removeItem(h.val())
});
this._makeAccessible()
},defaults:{fieldname:"",values:null,tag:"li"},_existingValues:null,applyOptions:function(){var f=this;
this._existingValues=[];
this.options.values=this.options.values||[];
if(this.options.values.length>0){this._setValues()
}else{this.$element.find("input").each(function(g,j){var h=b(j);
f._existingValues.push(h.attr("value"))
})
}},_setValues:function(){var f=this.options.values;
this.$element.empty();
this.options.values=[];
this.addItem(f)
},_makeAccessible:function(){this.$element.attr({role:"list"});
this.$element.children(this.options.tag).attr({role:"listitem"})
},_show:function(){this.$element.show().attr("aria-hidden",false)
},_hide:function(){this.$element.hide().attr("aria-hidden",true)
},_removeItem:function(g){var f=this.$element.find('input[value="'+g+'"]');
if(f.length>0){f.parent().remove();
this.$element.trigger(b.Event("itemremoved",{value:g}))
}},_appendItem:function(g){var h,j,f;
if(b.type(g)==="string"){h=j=g
}else{h=g.display;
j=g.value
}j+="";
if((b.inArray(j,this._existingValues)>-1)||j.length===0){return
}this._existingValues.push(j);
f=b("<"+this.options.tag+"/>",{role:"listitem",text:h});
b("<button/>",{"class":"icon-close"}).prependTo(f);
b("<input/>",{type:"hidden",value:j,name:this.options.fieldname}).appendTo(f);
this.$element.append(f);
this.$element.trigger(b.Event("itemadded"),{value:j,display:h})
},removeItem:function(g){var f=this._existingValues.indexOf(""+g);
if(f>-1){this._removeItem(g);
this._existingValues.splice(f,1)
}},addItem:function(h){var g=this,f=b.isArray(h)?h:[h];
b.each(f,function(j,k){g._appendItem(k)
})
},getValues:function(){return this._existingValues.slice(0)
}});
CUI.Widget.registry.register("taglist",CUI.TagList);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){CUI.TagList.init(b("[data-init~=taglist]",f.target))
})
}}(jQuery,this));
(function(d){var b=".cui-dragaction";
function g(j){while(true){var k=j.parent();
if(k.length===0){return k
}if(k.is("body")){return k
}var h=k.css("overflow");
if(h==="hidden"||h==="auto"||h==="scroll"){return k
}j=k
}}function f(h){var k={};
if(h.originalEvent){var j=h.originalEvent;
if(j.changedTouches&&j.changedTouches.length>0){k=j.changedTouches[0]
}if(j.touches&&j.touches.length>0){k=j.touches[0]
}}return{x:k.pageX||h.pageX,y:k.pageY||h.pageY}
}function a(h,l,j){var k=j.offset();
return h>=k.left&&h<(k.left+j.outerWidth())&&l>=k.top&&l<k.top+j.outerHeight()
}CUI.DragAction=new Class({construct:function(l,m,j,h,k){this.sourceElement=m;
this.dragElement=j;
this.container=g(j);
this.containerHeight=this.container.get(0).scrollHeight;
this.dropZones=h;
this.axis=k;
this.scrollZone=20;
this.dragStart(l)
},currentDragOver:null,dragStart:function(j){j.preventDefault();
var k=this.dragElement.position();
var h=f(j);
this.dragElement.css({left:k.left,top:k.top,width:this.dragElement.width()+"px"}).addClass("dragging");
this.dragStart={x:h.x-k.left,y:h.y-k.top};
d(document).fipo("touchmove"+b,"mousemove"+b,this.drag.bind(this));
d(document).fipo("touchend"+b,"mouseup"+b,this.dragEnd.bind(this));
this.sourceElement.trigger(this._createEvent("dragstart",j));
this.drag(j)
},drag:function(o){o.preventDefault();
var q=f(o);
if(this.container.is("body")){if(q.y-this.container.scrollTop()<this.scrollZone){this.container.scrollTop(q.y-this.scrollZone)
}if(q.y-this.container.scrollTop()>this.container.height()-this.scrollZone){this.container.scrollTop(q.y-this.container.height()-this.scrollZone)
}}else{var j=this.container.scrollTop();
var l=this.container.offset().top+this.scrollZone;
if(q.y<l){this.container.scrollTop(this.container.scrollTop()-(l-q.y))
}var n=this.container.offset().top+this.container.height()-this.scrollZone;
if(q.y>n){var m=Math.min(this.container.scrollTop()+(q.y-n),Math.max(this.containerHeight-this.container.height(),0));
this.container.scrollTop(m)
}var k=this.container.scrollTop();
this.dragStart.y+=j-k
}var p={};
if(this.axis!=="horizontal"){p.top=q.y-this.dragStart.y
}if(this.axis!=="vertical"){p.left=q.x-this.dragStart.x
}this.dragElement.css(p);
this.triggerDrag(o)
},dragEnd:function(h){h.preventDefault();
this.dragElement.removeClass("dragging");
this.dragElement.css({top:"",left:"",width:""});
d(document).off(b);
this.triggerDrop(h);
if(this.currentDragOver){d(this.currentDragOver).trigger(this._createEvent("dragleave",h))
}this.sourceElement.trigger(this._createEvent("dragend",h))
},triggerDrag:function(j){var h=this._getCurrentDropZone(j);
if(h===this.currentDragOver){if(this.currentDragOver){d(this.currentDragOver).trigger(this._createEvent("dragover",j))
}return
}if(this.currentDragOver){d(this.currentDragOver).trigger(this._createEvent("dragleave",j))
}this.currentDragOver=h;
if(this.currentDragOver){d(this.currentDragOver).trigger(this._createEvent("dragenter",j))
}},triggerDrop:function(j){var h=this._getCurrentDropZone(j);
if(!h){return
}h.trigger(this._createEvent("drop",j))
},_getCurrentDropZone:function(j){var k=f(j);
var h=null;
d.each(this.dropZones,function(l,m){if(a(k.x,k.y,m)){h=m;
return false
}});
return h
},_createEvent:function(h,k){var l=f(k);
var j=jQuery.Event(h);
j.pageX=l.x;
j.pageY=l.y;
j.sourceElement=this.sourceElement;
j.item=this.dragElement;
return j
}})
})(jQuery);
(function(h,a){var d="<button type='button' class='multifield-add icon-add-circle medium'/>";
var f="<button type='button' class='multifield-remove icon-minus-circle medium'/>";
var b="<button type='button' class='multifield-move icon-navigation medium'/>";
var g="<li><div class='multifield-placeholder'></div>"+f+b+"</li>";
CUI.Multifield=new Class({toString:"Multifield",extend:CUI.Widget,construct:function(j){this.script=this.$element.find("script[type='text/html']");
this.ol=this.$element.children("ol");
if(this.ol.length===0){this.ol=h("<ol>").prependTo(this.$element)
}this._adjustMarkup();
this._addListeners()
},_adjustMarkup:function(){this.$element.toggleClass("multifield",true);
this.ol.children("li").append(f).append(b);
this.ol.after(d)
},_addListeners:function(){var j=this;
this.$element.on("click",".multifield-add",function(l){var k=h(g);
k.find(".multifield-placeholder").replaceWith(j.script.html().trim());
k.appendTo(j.ol);
h(j.ol).trigger("cui-contentloaded")
});
this.$element.on("click",".multifield-remove",function(k){h(this).closest("li").remove()
});
this.$element.fipo("taphold","mousedown",".multifield-move",function(l){l.preventDefault();
var k=h(this).closest("li");
k.prevAll().addClass("drag-before");
k.nextAll().addClass("drag-after");
j.ol.css({height:j.ol.height()+h(l.item).height()+"px"});
new CUI.DragAction(l,j.$element,k,[j.ol],"vertical")
}).on("dragenter",function(k){j.ol.addClass("drag-over");
j._reorderPreview(k)
}).on("dragover",function(k){j._reorderPreview(k)
}).on("dragleave",function(k){j.ol.removeClass("drag-over").children().removeClass("drag-before drag-after")
}).on("drop",function(k){j._reorder(h(k.item));
j.ol.children().removeClass("drag-before drag-after")
}).on("dragend",function(k){j.ol.css({height:""})
})
},_reorder:function(j){var k=this.ol.children(".drag-after").first();
var l=this.ol.children(".drag-before").last();
if(k.length>0){j.insertBefore(k)
}if(l.length>0){j.insertAfter(l)
}},_reorderPreview:function(j){var k=this._pagePosition(j);
this.ol.children(":not(.dragging)").each(function(){var m=h(this);
var l=k.y<(m.offset().top+m.outerHeight()/2);
m.toggleClass("drag-after",l);
m.toggleClass("drag-before",!l)
})
},_pagePosition:function(j){var l={};
if(j.originalEvent){var k=j.originalEvent;
if(k.changedTouches&&k.changedTouches.length>0){l=k.changedTouches[0]
}if(k.touches&&k.touches.length>0){l=k.touches[0]
}}return{x:l.pageX||j.pageX,y:l.pageY||j.pageY}
}});
CUI.Widget.registry.register("multifield",CUI.Multifield);
if(CUI.options.dataAPI){h(document).on("cui-contentloaded.data-api",function(j){CUI.Multifield.init(h("[data-init~=multifield]",j.target))
})
}})(jQuery,window.console);
(function(b,a,d){CUI.Autocomplete=new Class({toString:"Autocomplete",extend:CUI.Widget,construct:function(){this._input=this.options.predefine.input||this.$element.children("input");
this._selectlist=this.options.predefine.selectlist||this.$element.find(".selectlist");
this._tags=this.options.predefine.tags||this.$element.find(".taglist");
this._suggestionsBtn=this.options.predefine.suggestionsBtn||this.$element.find(".autocomplete-suggestion-toggle");
this.applyOptions();
this._makeAccessible();
this._initTypeahead();
this._setOptionListeners()
},defaults:{mode:"starts",ignorecase:true,delay:200,multiple:false,selectlistConfig:null,tagConfig:null,predefine:{}},applyOptions:function(){this._setInput();
this._setTags();
this._setSelectlist();
this._setSuggestions()
},_setOptionListeners:function(){this.on("change:multiple",function(){this._setInput();
this._setTags()
}.bind(this))
},_setInput:function(){if(this.options.multiple){this._input.on("keypress.autocomplete-preventsubmit",function(f){if(f.which===13){f.preventDefault();
return false
}})
}else{this._input.off("keypress.autocomplete-preventsubmit")
}this._input.attr("autocomplete","off")
},_setSelectlist:function(){if(this._selectlist.length===0){this._selectlist=b("<ul/>",{id:CUI.util.getNextId(),"class":"selectlist"}).appendTo(this.$element)
}else{if(!this._selectlist.attr("id")){this._selectlist.attr("id",CUI.util.getNextId())
}}this._selectlist.selectList(b.extend({relatedElement:this._input,autofocus:false,autohide:true},this.options.selectlistConfig||{}));
this._selectListWidget=this._selectlist.data("selectList");
this._selectlist.on("selected.autocomplete",this._handleSelected.bind(this))
},_setTags:function(){if(this.options.multiple&&!this._tagList){if(this._tags.length===0){this._tags=b("<ul/>",{"class":"taglist"}).appendTo(this.$element)
}this._tags.tagList(this.options.tagConfig||{});
this._tagList=this._tags.data("tagList");
this._input.on("keyup.autocomplete-addtag",this._addTag.bind(this))
}else{if(!this.options.multiple&&this._tagList){this._tags.remove();
this._tags=null;
this._tagList=null;
this._input.off("keyup.autocomplete-addtag")
}}},_initTypeahead:function(){var g=this,j;
var h=function(k){g.showSuggestions(g._input.val(),false,g._selectListWidget)
};
var f=function(){if(j){clearTimeout(j)
}j=setTimeout(h,g.options.delay)
};
this._input.on("input.autocomplete",f);
this._input.on("cut.autocomplete",f);
this._input.on("keyup.autocomplete",function(k){switch(k.which){case 8:case 46:f()
}})
},_setSuggestions:function(){var f=this;
if(this._suggestionsBtn.length){this._suggestionsBtn.attr("type","button");
this._suggestionsBtn.on("click.autocomplete",function(g){if(!f._selectListWidget.get("visible")){f.showSuggestions(f._input.val(),true,f._selectListWidget);
g.stopPropagation()
}});
this._input.addClass("autocomplete-has-suggestion-btn")
}},_makeAccessible:function(){this.$element.attr({role:"combobox","aria-multiselectable":this.options.multiple,"aria-autocomplete":this.options.typeahead?"list":"","aria-owns":this._selectlist.attr("id")||""});
this._input.add(this._suggestionsBtn).on("keydown",function(f){switch(f.which){case 40:if(!this._selectListWidget.get("visible")){this._selectListWidget.show().resetCaret();
f.preventDefault();
f.stopPropagation()
}break
}}.bind(this))
},_addTag:function(f){if(f.which!==13){return
}this._tagList.addItem(this._input.val());
this.clear();
this._selectListWidget.hide()
},_handleSelected:function(f){this._selectListWidget.hide();
if(this.options.multiple){this._tagList.addItem({display:f.displayedValue,value:f.selectedValue});
this.clear()
}else{this._input.val(f.displayedValue)
}this._input.trigger("focus")
},showSuggestions:function(h,g,f){this.$element.trigger(b.Event("query",{value:h}));
if(h.length||g){if(this._selectListWidget.options.type==="static"){this._handleStaticFilter(h)
}else{if(this._selectListWidget.options.type==="dynamic"){this._handleDynamicFilter(h)
}}this._selectListWidget.show().resetCaret()
}else{this._selectListWidget.hide()
}},_handleStaticFilter:function(g){var f=this;
if(g){this._selectListWidget.filter(function(h,j){if(f.options.ignorecase){j=j.toLowerCase();
g=g.toLowerCase()
}return f.options.mode==="starts"?j.lastIndexOf(g,0)===0:f.options.mode==="contains"?j.search(g)!==-1:false
})
}else{this._selectListWidget.filter()
}},_handleDynamicFilter:function(f){this._selectListWidget.set("dataadditional",{query:f});
this._selectListWidget.triggerLoadData(true)
},clear:function(){this._input.val("");
this._selectListWidget.filter()
},disable:function(){this.$element.addClass("disabled");
this.$element.attr("aria-disabled",true);
this._input.prop("disabled",true);
this._suggestionsBtn.prop("disabled",true)
},enable:function(){this.$element.removeClass("disabled");
this.$element.attr("aria-disabled",false);
this._input.prop("disabled",false);
this._suggestionsBtn.prop("disabled",false)
}});
CUI.Widget.registry.register("autocomplete",CUI.Autocomplete);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){CUI.Autocomplete.init(b("[data-init~=autocomplete]",f.target))
})
}}(jQuery,this));
(function(f,a){if(!f.message||!f.validator){if(a){a.warn("$.message and/or $.validator are not available, thus nothing is registered.")
}return
}f.message.register({selector:"*",message:{"validation.required":"Please fill out this field."}});
f.message.register({selector:":lang(de)",message:{}});
f(document).on("cui-contentloaded",function(g){f(":submittable",g.target).on("invalid",function(j){if(j.isJqueryValidator){return
}j.preventDefault();
var h=f(this);
h.checkValidity();
h.updateErrorUI()
})
});
function d(h,j){var g=h.next(".form-error");
h.attr("aria-invalid","true").toggleClass("error",true);
if(g.length===0){h.after(f("<span class='form-error' data-init='quicktip' data-quicktip-arrow='top' data-quicktip-type='error' />").html(j))
}else{g.html(j)
}}function b(g){g.removeAttr("aria-invalid").removeClass("error");
g.next(".form-error").remove()
}f.validator.register({selector:"form *",show:d,clear:b});
f.validator.register({selector:"form .fieldwrapper .field",show:function(h,j){h.attr("aria-invalid","true").toggleClass("error",true);
h.nextAll(".fieldinfo").addClass("hidden-accessible");
var g=h.nextAll(".fielderror");
if(g.length===0){var k=h.closest("form").hasClass("vertical")?"right":"top";
f("<span class='fielderror form-error small' data-init='quicktip' data-quicktip-type='error' />").attr("data-quicktip-arrow",k).html(j).insertAfter(h)
}else{g.html(j)
}},clear:function(g){g.removeAttr("aria-invalid").removeClass("error").nextAll(".fielderror").remove();
g.nextAll(".fieldinfo").removeClass("hidden-accessible")
}});
f.validator.register({selector:"form input, form textarea",validate:function(g){var h=g.prop("required")===true||(g.prop("required")===undefined&&g.attr("required")!==undefined)||g.attr("aria-required")==="true";
if(h&&g.val().length===0){return g.message("validation.required")||"required"
}}});
f(document).on("input","form input, form textarea",function(h){var g=f(this);
g.checkValidity();
g.updateErrorUI()
});
f.validator.register({selector:"[role=listbox]",validate:function(h){if(h.attr("aria-required")!=="true"){return
}var g=false;
h.find("[role=option]").each(function(){if(f(this).attr("aria-selected")==="true"){g=true;
return false
}});
if(!g){return h.message("validation.required")||"required"
}}})
})(jQuery,window.console);
/*!
 * jQuery Cookie Plugin
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(a){a.cookie=function(j,h,m){if(arguments.length>1&&(!/Object/.test(Object.prototype.toString.call(h))||h===null||h===undefined)){m=a.extend({},m);
if(h===null||h===undefined){m.expires=-1
}if(typeof m.expires==="number"){var k=m.expires,l=m.expires=new Date();
l.setDate(l.getDate()+k)
}h=String(h);
return(document.cookie=[encodeURIComponent(j),"=",m.raw?h:encodeURIComponent(h),m.expires?"; expires="+m.expires.toUTCString():"",m.path?"; path="+m.path:"",m.domain?"; domain="+m.domain:"",m.secure?"; secure":""].join(""))
}m=h||{};
var b=m.raw?function(n){return n
}:decodeURIComponent;
var d=document.cookie.split("; ");
for(var g=0,f;
f=d[g]&&d[g].split("=");
g++){if(b(f[0])===j){return b(f[1]||"")
}}return null
}
})(jQuery);
(function(a){if(typeof define==="function"&&define.amd){define(["jquery"],a)
}else{a(window.jQuery)
}}(function(b){var a=0;
b.ajaxTransport("iframe",function(d){if(d.async){var g,f,h;
return{send:function(j,k){g=b('<form style="display:none;"></form>');
g.attr("accept-charset",d.formAcceptCharset);
h=/\?/.test(d.url)?"&":"?";
if(d.type==="DELETE"){d.url=d.url+h+"_method=DELETE";
d.type="POST"
}else{if(d.type==="PUT"){d.url=d.url+h+"_method=PUT";
d.type="POST"
}else{if(d.type==="PATCH"){d.url=d.url+h+"_method=PATCH";
d.type="POST"
}}}f=b('<iframe src="javascript:false;" name="iframe-transport-'+(a+=1)+'"></iframe>').bind("load",function(){var l,m=b.isArray(d.paramName)?d.paramName:[d.paramName];
f.unbind("load").bind("load",function(){var n;
try{n=f.contents();
if(!n.length||!n[0].firstChild){throw new Error()
}}catch(o){n=undefined
}k(200,"success",{iframe:n});
b('<iframe src="javascript:false;"></iframe>').appendTo(g);
g.remove()
});
g.prop("target",f.prop("name")).prop("action",d.url).prop("method",d.type);
if(d.formData){b.each(d.formData,function(n,o){b('<input type="hidden"/>').prop("name",o.name).val(o.value).appendTo(g)
})
}if(d.fileInput&&d.fileInput.length&&d.type==="POST"){l=d.fileInput.clone();
d.fileInput.after(function(n){return l[n]
});
if(d.paramName){d.fileInput.each(function(n){b(this).prop("name",m[n]||d.paramName)
})
}g.append(d.fileInput).prop("enctype","multipart/form-data").prop("encoding","multipart/form-data")
}g.submit();
if(l&&l.length){d.fileInput.each(function(o,n){var p=b(l[o]);
b(n).prop("name",p.prop("name"));
p.replaceWith(n)
})
}});
g.append(f).appendTo(document.body)
},abort:function(){if(f){f.unbind("load").prop("src","javascript".concat(":false;"))
}if(g){g.remove()
}}}
}});
b.ajaxSetup({converters:{"iframe text":function(d){return d&&b(d[0].body).text()
},"iframe json":function(d){return d&&b.parseJSON(b(d[0].body).text())
},"iframe html":function(d){return d&&b(d[0].body).html()
},"iframe script":function(d){return d&&b.globalEval(b(d[0].body).text())
}}})
}));
/*!
 * jQuery Transit - CSS3 transitions and transformations
 * (c) 2011-2012 Rico Sta. Cruz <rico@ricostacruz.com>
 * MIT Licensed.
 *
 * http://ricostacruz.com/jquery.transit
 * http://github.com/rstacruz/jquery.transit
 */
(function(n){n.transit={version:"0.9.9",propertyMap:{marginLeft:"margin",marginRight:"margin",marginBottom:"margin",marginTop:"margin",paddingLeft:"padding",paddingRight:"padding",paddingBottom:"padding",paddingTop:"padding"},enabled:true,useTransitionEnd:false};
var f=document.createElement("div");
var t={};
function b(A){if(A in f.style){return A
}var z=["Moz","Webkit","O","ms"];
var u=A.charAt(0).toUpperCase()+A.substr(1);
if(A in f.style){return A
}for(var w=0;
w<z.length;
++w){var v=z[w]+u;
if(v in f.style){return v
}}}function g(){f.style[t.transform]="";
f.style[t.transform]="rotateY(90deg)";
return f.style[t.transform]!==""
}var a=navigator.userAgent.toLowerCase().indexOf("chrome")>-1;
t.transition=b("transition");
t.transitionDelay=b("transitionDelay");
t.transform=b("transform");
t.transformOrigin=b("transformOrigin");
t.transform3d=g();
var l={transition:"transitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd",WebkitTransition:"webkitTransitionEnd",msTransition:"MSTransitionEnd"};
var h=t.transitionEnd=l[t.transition]||null;
for(var s in t){if(t.hasOwnProperty(s)&&typeof n.support[s]==="undefined"){n.support[s]=t[s]
}}f=null;
n.cssEase={_default:"ease","in":"ease-in",out:"ease-out","in-out":"ease-in-out",snap:"cubic-bezier(0,1,.5,1)",easeOutCubic:"cubic-bezier(.215,.61,.355,1)",easeInOutCubic:"cubic-bezier(.645,.045,.355,1)",easeInCirc:"cubic-bezier(.6,.04,.98,.335)",easeOutCirc:"cubic-bezier(.075,.82,.165,1)",easeInOutCirc:"cubic-bezier(.785,.135,.15,.86)",easeInExpo:"cubic-bezier(.95,.05,.795,.035)",easeOutExpo:"cubic-bezier(.19,1,.22,1)",easeInOutExpo:"cubic-bezier(1,0,0,1)",easeInQuad:"cubic-bezier(.55,.085,.68,.53)",easeOutQuad:"cubic-bezier(.25,.46,.45,.94)",easeInOutQuad:"cubic-bezier(.455,.03,.515,.955)",easeInQuart:"cubic-bezier(.895,.03,.685,.22)",easeOutQuart:"cubic-bezier(.165,.84,.44,1)",easeInOutQuart:"cubic-bezier(.77,0,.175,1)",easeInQuint:"cubic-bezier(.755,.05,.855,.06)",easeOutQuint:"cubic-bezier(.23,1,.32,1)",easeInOutQuint:"cubic-bezier(.86,0,.07,1)",easeInSine:"cubic-bezier(.47,0,.745,.715)",easeOutSine:"cubic-bezier(.39,.575,.565,1)",easeInOutSine:"cubic-bezier(.445,.05,.55,.95)",easeInBack:"cubic-bezier(.6,-.28,.735,.045)",easeOutBack:"cubic-bezier(.175, .885,.32,1.275)",easeInOutBack:"cubic-bezier(.68,-.55,.265,1.55)"};
n.cssHooks["transit:transform"]={get:function(u){return n(u).data("transform")||new m()
},set:function(w,u){var z=u;
if(!(z instanceof m)){z=new m(z)
}if(t.transform==="WebkitTransform"&&!a){w.style[t.transform]=z.toString(true)
}else{w.style[t.transform]=z.toString()
}n(w).data("transform",z)
}};
n.cssHooks.transform={set:n.cssHooks["transit:transform"].set};
if(n.fn.jquery<"1.8"){n.cssHooks.transformOrigin={get:function(u){return u.style[t.transformOrigin]
},set:function(u,v){u.style[t.transformOrigin]=v
}};
n.cssHooks.transition={get:function(u){return u.style[t.transition]
},set:function(u,v){u.style[t.transition]=v
}}
}q("scale");
q("translate");
q("rotate");
q("rotateX");
q("rotateY");
q("rotate3d");
q("perspective");
q("skewX");
q("skewY");
q("x",true);
q("y",true);
function m(u){if(typeof u==="string"){this.parse(u)
}return this
}m.prototype={setFromString:function(w,v){var u=(typeof v==="string")?v.split(","):(v.constructor===Array)?v:[v];
u.unshift(w);
m.prototype.set.apply(this,u)
},set:function(v){var u=Array.prototype.slice.apply(arguments,[1]);
if(this.setter[v]){this.setter[v].apply(this,u)
}else{this[v]=u.join(",")
}},get:function(u){if(this.getter[u]){return this.getter[u].apply(this)
}else{return this[u]||0
}},setter:{rotate:function(u){this.rotate=r(u,"deg")
},rotateX:function(u){this.rotateX=r(u,"deg")
},rotateY:function(u){this.rotateY=r(u,"deg")
},scale:function(u,v){if(v===undefined){v=u
}this.scale=u+","+v
},skewX:function(u){this.skewX=r(u,"deg")
},skewY:function(u){this.skewY=r(u,"deg")
},perspective:function(u){this.perspective=r(u,"px")
},x:function(u){this.set("translate",u,null)
},y:function(u){this.set("translate",null,u)
},translate:function(u,v){if(this._translateX===undefined){this._translateX=0
}if(this._translateY===undefined){this._translateY=0
}if(u!==null&&u!==undefined){this._translateX=r(u,"px")
}if(v!==null&&v!==undefined){this._translateY=r(v,"px")
}this.translate=this._translateX+","+this._translateY
}},getter:{x:function(){return this._translateX||0
},y:function(){return this._translateY||0
},scale:function(){var u=(this.scale||"1,1").split(",");
if(u[0]){u[0]=parseFloat(u[0])
}if(u[1]){u[1]=parseFloat(u[1])
}return(u[0]===u[1])?u[0]:u
},rotate3d:function(){var v=(this.rotate3d||"0,0,0,0deg").split(",");
for(var u=0;
u<=3;
++u){if(v[u]){v[u]=parseFloat(v[u])
}}if(v[3]){v[3]=r(v[3],"deg")
}return v
}},parse:function(v){var u=this;
v.replace(/([a-zA-Z0-9]+)\((.*?)\)/g,function(w,A,z){u.setFromString(A,z)
})
},toString:function(w){var v=[];
for(var u in this){if(this.hasOwnProperty(u)){if((!t.transform3d)&&((u==="rotateX")||(u==="rotateY")||(u==="perspective")||(u==="transformOrigin"))){continue
}if(u[0]!=="_"){if(w&&(u==="scale")){v.push(u+"3d("+this[u]+",1)")
}else{if(w&&(u==="translate")){v.push(u+"3d("+this[u]+",0)")
}else{v.push(u+"("+this[u]+")")
}}}}}return v.join(" ")
}};
function p(v,u,w){if(u===true){v.queue(w)
}else{if(u){v.queue(u,w)
}else{w()
}}}function k(v){var u=[];
n.each(v,function(w){w=n.camelCase(w);
w=n.transit.propertyMap[w]||n.cssProps[w]||w;
w=d(w);
if(n.inArray(w,u)===-1){u.push(w)
}});
return u
}function j(v,A,C,u){var w=k(v);
if(n.cssEase[C]){C=n.cssEase[C]
}var B=""+o(A)+" "+C;
if(parseInt(u,10)>0){B+=" "+o(u)
}var z=[];
n.each(w,function(E,D){z.push(D+" "+B)
});
return z.join(", ")
}n.fn.transition=n.fn.transit=function(E,v,D,H){var I=this;
var z=0;
var B=true;
if(typeof v==="function"){H=v;
v=undefined
}if(typeof D==="function"){H=D;
D=undefined
}if(typeof E.easing!=="undefined"){D=E.easing;
delete E.easing
}if(typeof E.duration!=="undefined"){v=E.duration;
delete E.duration
}if(typeof E.complete!=="undefined"){H=E.complete;
delete E.complete
}if(typeof E.queue!=="undefined"){B=E.queue;
delete E.queue
}if(typeof E.delay!=="undefined"){z=E.delay;
delete E.delay
}if(typeof v==="undefined"){v=n.fx.speeds._default
}if(typeof D==="undefined"){D=n.cssEase._default
}v=o(v);
var J=j(E,v,D,z);
var G=n.transit.enabled&&t.transition;
var w=G?(parseInt(v,10)+parseInt(z,10)):0;
if(w===0){var F=function(K){I.css(E);
if(H){H.apply(I)
}if(K){K()
}};
p(I,B,F);
return I
}var C={};
var u=function(M){var L=false;
var K=function(){if(L){I.unbind(h,K)
}if(w>0){I.each(function(){this.style[t.transition]=(C[this]||null)
})
}if(typeof H==="function"){H.apply(I)
}if(typeof M==="function"){M()
}};
if((w>0)&&(h)&&(n.transit.useTransitionEnd)){L=true;
I.bind(h,K)
}else{window.setTimeout(K,w)
}I.each(function(){if(w>0){this.style[t.transition]=J
}n(this).css(E)
})
};
var A=function(K){this.offsetWidth;
u(K)
};
p(I,B,A);
return this
};
function q(v,u){if(!u){n.cssNumber[v]=true
}n.transit.propertyMap[v]=t.transform;
n.cssHooks[v]={get:function(z){var w=n(z).css("transit:transform");
return w.get(v)
},set:function(z,A){var w=n(z).css("transit:transform");
w.setFromString(v,A);
n(z).css({"transit:transform":w})
}}
}function d(u){return u.replace(/([A-Z])/g,function(v){return"-"+v.toLowerCase()
})
}function r(v,u){if((typeof v==="string")&&(!v.match(/^[\-0-9\.]+$/))){return v
}else{return""+v+u
}}function o(v){var u=v;
if(n.fx.speeds[u]){u=n.fx.speeds[u]
}return r(u,"ms")
}n.transit.getTransitionValue=j
})(jQuery);
window._g=window._g||{};
_g.shared={};
if(window.console===undefined){window.console={log:function(a){}}
}_g.shared.HTTP=new function(){var createResponse=function(){var response=new Object();
response.headers=new Object();
response.body=new Object();
return response
};
var getResponseFromXhr=function(request){if(!request){return null
}var response=createResponse();
response.body=request.responseText;
response.headers[_g.HTTP.HEADER_STATUS]=request.status;
response.responseText=request.responseText;
response.status=request.status;
return response
};
return{EXTENSION_HTML:".html",EXTENSION_JSON:".json",EXTENSION_RES:".res",HEADER_STATUS:"Status",HEADER_MESSAGE:"Message",HEADER_LOCATION:"Location",HEADER_PATH:"Path",PARAM_NO_CACHE:"cq_ck",get:function(url,callback,scope,suppressForbiddenCheck){url=_g.HTTP.getXhrHookedURL(_g.HTTP.externalize(url,true));
if(callback!=undefined){return _g.$.ajax({type:"GET",url:url,externalize:false,encodePath:false,hook:false,complete:function(request,textStatus){var response=getResponseFromXhr(request);
if(!suppressForbiddenCheck){_g.HTTP.handleForbidden(response)
}callback.call(scope||this,this,textStatus=="success",response)
}})
}else{try{var request=_g.$.ajax({type:"GET",url:url,async:false,externalize:false,encodePath:false,hook:false});
var response=getResponseFromXhr(request);
if(!suppressForbiddenCheck){_g.HTTP.handleForbidden(response)
}return response
}catch(e){return null
}}},post:function(url,callback,params,scope,suppressErrorMsg,suppressForbiddenCheck){url=_g.HTTP.externalize(url,true);
var hook=_g.HTTP.getXhrHook(url,"POST",params);
if(hook){url=hook.url;
params=hook.params
}if(callback!=undefined){return _g.$.ajax({type:"POST",url:url,data:params,externalize:false,encodePath:false,hook:false,complete:function(request,textStatus){var response=_g.HTTP.buildPostResponseFromHTML(request.responseText);
if(!suppressForbiddenCheck){_g.HTTP.handleForbidden(request)
}callback.call(scope||this,this,textStatus=="success",response)
}})
}else{try{var request=_g.$.ajax({type:"POST",url:url,data:params,async:false,externalize:false,encodePath:false,hook:false});
var response=_g.HTTP.buildPostResponseFromHTML(request.responseText);
if(!suppressForbiddenCheck){_g.HTTP.handleForbidden(request)
}return response
}catch(e){return null
}}},getParameter:function(url,name){var params=_g.HTTP.getParameters(url,name);
return params!=null?params[0]:null
},getParameters:function(url,name){var values=[];
if(!name){return null
}name=encodeURIComponent(name);
if(url.indexOf("?")==-1){return null
}var query=url.substring(url.indexOf("?")+1);
if(query.indexOf(name)==-1){return null
}var queryPts=query.split("&");
for(var i=0;
i<queryPts.length;
i++){var paramPts=queryPts[i].split("=");
if(paramPts[0]==name){values.push(paramPts.length>1?decodeURIComponent(paramPts[1]):"")
}}return values.length>0?values:null
},addParameter:function(url,name,value){if(value&&value instanceof Array){for(var i=0;
i<value.length;
i++){url=_g.HTTP.addParameter(url,name,value[i])
}return url
}var separator=url.indexOf("?")==-1?"?":"&";
var hashIdx=url.indexOf("#");
if(hashIdx<0){return url+separator+encodeURIComponent(name)+"="+encodeURIComponent(value)
}else{var hash=url.substring(hashIdx);
url=url.substring(0,hashIdx);
return url+separator+encodeURIComponent(name)+"="+encodeURIComponent(value)+hash
}},setParameter:function(url,name,value){url=_g.HTTP.removeParameter(url,name);
return _g.HTTP.addParameter(url,name,value)
},removeParameter:function(url,name){var pattern0="?"+encodeURIComponent(name)+"=";
var pattern1="&"+encodeURIComponent(name)+"=";
var pattern;
if(url.indexOf(pattern0)!=-1){pattern=pattern0
}else{if(url.indexOf(pattern1)!=-1){pattern=pattern1
}else{return url
}}var indexCutStart=url.indexOf(pattern);
var begin=url.substring(0,indexCutStart);
var indexCutEnd=url.indexOf("&",indexCutStart+1);
var end="";
if(indexCutEnd!=-1){end=url.substring(indexCutEnd);
if(end.indexOf("&")==0){end=end.replace("&","?")
}}return begin+end
},removeParameters:Granite.HTTP.removeParameters,addSelector:function(url,selector,index){if(!index){index=0
}var post="";
var pIndex=url.indexOf("?");
if(pIndex==-1){pIndex=url.indexOf("#")
}if(pIndex!=-1){post=url.substring(pIndex);
url=url.substring(0,pIndex)
}var sIndex=url.lastIndexOf("/");
var main=url.substring(sIndex);
if(main.indexOf("."+selector+".")==-1){var path=url.substring(0,sIndex);
var obj=main.split(".");
var newMain="";
var delim="";
if(index>obj.length-2||index==-1){index=obj.length-2
}for(var i=0;
i<obj.length;
i++){newMain+=delim+obj[i];
delim=".";
if(index==i){newMain+=delim+selector
}}return path+newMain+post
}else{return url
}},setSelector:function(url,selector,index){var post="";
var pIndex=url.indexOf("?");
if(pIndex==-1){pIndex=url.indexOf("#")
}if(pIndex!=-1){post=url.substring(pIndex);
url=url.substring(0,pIndex)
}var selectors=_g.HTTP.getSelectors(url);
var ext=url.substring(url.lastIndexOf("."));
url=url.substring(0,url.lastIndexOf("."));
var fragment=(selectors.length>0)?url.replace("."+selectors.join("."),""):url;
if(selectors.length>0){for(var i=0;
i<selectors.length;
i++){if(index==i){fragment+="."+selector
}else{fragment+="."+selectors[i]
}}}else{fragment+="."+selector
}return fragment+ext+post
},addSelectors:function(url,selectors){var res=url;
if(url&&selectors&&selectors.length){for(var i=0;
i<selectors.length;
i++){res=_g.HTTP.addSelector(res,selectors[i],i)
}}return res
},getAnchor:function(url){if(url.indexOf("#")!=-1){return url.substring(url.indexOf("#")+1)
}return""
},setAnchor:function(url,anchor){return _g.HTTP.removeAnchor(url)+"#"+anchor
},removeAnchor:Granite.HTTP.removeAnchor,noCaching:function(url){return _g.HTTP.setParameter(url,_g.HTTP.PARAM_NO_CACHE,new Date().valueOf())
},buildPostResponseFromNode:function(node,response){if(!node){return null
}if(response==undefined){response=createResponse()
}for(var i=0;
i<node.childNodes.length;
i++){var child=node.childNodes[i];
if(child.tagName){if(child.id){if(child.href){response.headers[child.id]=child.href
}else{response.headers[child.id]=child.innerHTML
}}response=_g.HTTP.buildPostResponseFromNode(child,response)
}}return response
},buildPostResponseFromHTML:function(html){var response=createResponse();
try{if(html.responseText!=undefined){html=html.responseText
}else{if(typeof html!="string"){html=html.toString()
}}var div=document.createElement("div");
div.innerHTML=html;
response=_g.HTTP.buildPostResponseFromNode(div,response);
div=null
}catch(e){}return response
},getCookie:function(name){var cname=encodeURIComponent(name)+"=";
var dc=document.cookie;
if(dc.length>0){var begin=dc.indexOf(cname);
if(begin!=-1){begin+=cname.length;
var end=dc.indexOf(";",begin);
if(end==-1){end=dc.length
}return decodeURIComponent(dc.substring(begin,end))
}}return null
},setCookie:function(name,value,path,days,domain,secure){if(typeof(days)!="number"){days=7
}var date;
if(days>0){date=new Date();
date.setTime(date.getTime()+(days*24*60*60*1000))
}else{date=new Date(0)
}document.cookie=encodeURIComponent(name)+"="+encodeURIComponent(value)+"; "+(days!=0?"expires="+date.toGMTString()+"; ":"")+(domain?"domain="+domain+"; ":"")+(path?"path="+path:"")+(secure?"; secure":"");
return value
},clearCookie:function(name,path,domain,secure){_g.HTTP.setCookie(name,"null",path||"",-1,domain||"",secure||"")
},getSchemeAndAuthority:Granite.HTTP.getSchemeAndAuthority,getContextPath:Granite.HTTP.getContextPath,externalize:function(url,encode){if((typeof G_IS_HOOKED!="undefined")&&G_IS_HOOKED(url)){return url
}if(encode){url=_g.HTTP.encodePathOfURI(url)
}url=Granite.HTTP.externalize(url);
return url
},internalize:Granite.HTTP.internalize,getPath:Granite.HTTP.getPath,getSuffix:function(){if(window.CQURLInfo&&CQURLInfo.suffix){return CQURLInfo.suffix
}return null
},getSelectors:function(url){if(!url&&window.CQURLInfo){if(CQURLInfo.selectors){return CQURLInfo.selectors
}}var selectors=[];
url=url||window.location.href;
url=_g.HTTP.removeParameters(url);
url=_g.HTTP.removeAnchor(url);
var fragment=url.substring(url.lastIndexOf("/"));
if(fragment){var split=fragment.split(".");
if(split.length>2){for(var i=0;
i<split.length;
i++){if(i>0&&i<split.length-1){selectors.push(split[i])
}}}}return selectors
},getExtension:function(url){if(!url&&window.CQURLInfo){if(CQURLInfo.extension){return CQURLInfo.extension
}}url=url||window.location.href;
url=_g.HTTP.removeParameters(url);
url=_g.HTTP.removeAnchor(url);
var pos=url.lastIndexOf(".");
if(pos<0){return""
}url=url.substring(pos+1);
pos=url.indexOf("/");
if(pos<0){return url
}return url.substring(0,pos)
},encodePathOfURI:Granite.HTTP.encodePathOfURI,encodePath:Granite.HTTP.encodePath,eval:Granite.HTTP.eval,isOkStatus:function(status){try{return(new String(status).indexOf("2")==0)
}catch(e){return false
}},isOk:function(response){try{return _g.HTTP.isOkStatus(response.headers[_g.HTTP.HEADER_STATUS])
}catch(e){return false
}},handleForbidden:function(response,suppressLogin){try{if(response[_g.HTTP.HEADER_STATUS.toLowerCase()]==403){Granite.HTTP.handleLoginRedirect();
return true
}return false
}catch(e){return false
}},getXhrHook:Granite.HTTP.getXhrHook,getXhrHookedURL:function(url,method,params){var hook=_g.HTTP.getXhrHook(url,method,params);
if(hook){return hook.url
}return url
},reloadHook:function(url){if(typeof G_RELOAD_HOOK!="undefined"&&_g.$.isFunction(G_RELOAD_HOOK)){if(CQURLInfo.selectorString!=""){url=_g.HTTP.addSelector(url,CQURLInfo.selectorString)
}url=G_RELOAD_HOOK(url)||url
}return url
}}
};
_g.HTTP=_g.shared.HTTP;
_g.shared.Util=new function(){return{reload:function(win,url,preventHistory){if(!win){win=window
}if(!url){url=_g.HTTP.noCaching(win.location.href)
}url=_g.HTTP.reloadHook(url);
if(preventHistory){win.location.replace(url)
}else{win.location.href=url
}},load:function(url,preventHistory){_g.Util.reload(window,url,preventHistory)
},open:function(url,win,name,options){if(!win){win=window
}if(!url){return
}url=_g.HTTP.reloadHook(url);
if(!name){name=""
}if(!options){options=""
}return win.open(url,name,options)
},htmlEncode:function(value){return !value?value:String(value).replace(/&/g,"&amp;").replace(/>/g,"&gt;").replace(/</g,"&lt;").replace(/"/g,"&quot;")
},htmlDecode:function(value){return !value?value:String(value).replace(/&gt;/g,">").replace(/&lt;/g,"<").replace(/&quot;/g,'"').replace(/&amp;/g,"&")
},ellipsis:function(value,length,word){if(value&&value.length>length){if(word){var vs=value.substr(0,length-2);
var index=Math.max(vs.lastIndexOf(" "),vs.lastIndexOf("."),vs.lastIndexOf("!"),vs.lastIndexOf("?"),vs.lastIndexOf(";"));
if(index==-1||index<(length-15)){return value.substr(0,length-3)+"..."
}else{return vs.substr(0,index)+"..."
}}else{return value.substr(0,length-3)+"..."
}}return value
},patchText:Granite.Util.patchText,eval:function(response){return _g.HTTP.eval(response)
},getTopWindow:Granite.Util.getTopWindow,setIFrameMode:Granite.Util.setIFrameMode}
};
_g.Util=_g.shared.Util;
_g.shared.Sling=function(){return{SELECTOR_INFINITY:Granite.Sling.SELECTOR_INFINITY,CHARSET:Granite.Sling.CHARSET,STATUS:Granite.Sling.STATUS,STATUS_BROWSER:Granite.Sling.STATUS_BROWSER,OPERATION:Granite.Sling.OPERATION,OPERATION_DELETE:Granite.Sling.OPERATION_DELETE,OPERATION_MOVE:Granite.Sling.OPERATION_MOVE,DELETE_SUFFIX:Granite.Sling.DELETE_SUFFIX,TYPEHINT_SUFFIX:Granite.Sling.TYPEHINT_SUFFIX,COPY_SUFFIX:Granite.Sling.COPY_SUFFIX,MOVE_SUFFIX:Granite.Sling.MOVE_SUFFIX,ORDER:Granite.Sling.ORDER,REPLACE:Granite.Sling.REPLACE,DESTINATION:Granite.Sling.DESTINATION,SAVE_PARAM_PREFIX:Granite.Sling.SAVE_PARAM_PREFIX,IGNORE_PARAM:Granite.Sling.IGNORE_PARAM,REQUEST_LOGIN_PARAM:Granite.Sling.REQUEST_LOGIN_PARAM,LOGIN_URL:Granite.Sling.LOGIN_URL,LOGOUT_URL:Granite.Sling.LOGOUT_URL,processBinaryData:function(a){if(a&&a[":jcr:data"]!=undefined){var b=new Object();
b.size=a[":jcr:data"];
b.type=a["jcr:mimeType"];
b.date=a["jcr:lastModified"];
a=b
}return a
},getContentPath:function(d,a,b){var f=a;
if(f.lastIndexOf(".")>f.lastIndexOf("/")){f=f.substr(0,f.indexOf(".",f.lastIndexOf("/")))
}if(d){if(d.indexOf("/")==0){f=d
}else{if(b){while(d.indexOf("../")==0){d=d.substring(3);
f=f.substring(0,f.lastIndexOf("/"))
}}d=d.replace("./","");
f=f+"/"+d
}}return f
}}
}();
_g.Sling=_g.shared.Sling;
_g.shared.XSS=new function(){return{getXSSPropertyName:function(a){if(!a){return""
}if(_g.XSS.KEY_REGEXP.test(a)){return a
}return a+=_g.XSS.KEY_SUFFIX
},getXSSRecordPropertyValue:function(g,d,a){var f="";
if(g&&d){var b=g.get(this.getXSSPropertyName(d));
if(b){f=b
}else{f=g.get(d)
}if(a&&!isNaN(a)){f=_g.Util.ellipsis(f,a,true)
}}return f
},getXSSTablePropertyValue:function(f,d,a){var g="";
if(f&&d){var b=f[this.getXSSPropertyName(d)];
if(b){g=b
}else{g=f[d]
}if(a&&!isNaN(a)){g=_g.Util.ellipsis(g,a,true)
}}return g
},getXSSValue:function(a){if(a){return _g.Util.htmlEncode(a)
}else{return""
}},updatePropertyName:function(a,b){if(!a||!b||!a[b]){return
}if(a.xssProtect&&!a.xssKeepPropName){a[b]=this.getXSSPropertyName(a[b])
}},xssPropertyRenderer:function(f,b,d,a){if(a&&a.dataIndex&&d&&d.data&&d.data[this.getXSSPropertyName(a.dataIndex)]){f=d.data[this.getXSSPropertyName(a.dataIndex)];
if(a.ellipsisLimit&&!isNaN(a.ellipsisLimit)){f=_g.Util.ellipsis(f,a.ellipsisLimit,true)
}return f
}else{if(f){return f
}else{return""
}}}}
};
_g.XSS=_g.shared.XSS;
_g.XSS.KEY_SUFFIX="_xss";
_g.XSS.KEY_REGEXP=new RegExp(_g.XSS.KEY_SUFFIX+"$");
_g.shared.I18n=Granite.I18n;
_g.I18n=_g.shared.I18n;
_g.shared.I18n.getMessage=Granite.I18n.get;
_g.shared.I18n.getVarMessage=Granite.I18n.getVar;
_g.shared.String=new function(){return{startsWith:function(f,b){if(f==null||b==null){return f==null&&b==null
}if(b.length>f.length){return false
}var a=f.toString();
var d=b.toString();
return(a.indexOf(d)==0)
},endsWith:function(b,a){if(b==null||a==null){return b==null&&a==null
}if(a.length>b.length){return false
}b=b.toString();
a=a.toString();
return(b.lastIndexOf(a)==(b.length-a.length))
},contains:function(b,a){if(b==null||a==null){return false
}b=b.toString();
a=a.toString();
return(b.indexOf(a)>=0)
}}
};
_g.String=_g.shared.String;
_g.shared.ClientSidePersistence=function(a){var b={PERSISTENCE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("ClientSidePersistence"),config:{},cache:null,getMode:function(){return this.config.mode
},getWindow:function(){return this.config.window||_g.shared.Util.getTopWindow()
},debug:function(){if(console){var d=this.getMap();
var g="[ClientSidePersistence -> mode="+this.getMode().name+", container="+(this.config.container||"")+"]\n";
var f=0;
var h=new RegExp("^"+this.config.container+"/");
for(var k=0,n=Object.keys(d).sort(),l=null;
k<n.length;
k++){var m=n[k];
if(this.config.container&&(typeof(m)=="string")&&!m.match(h)){continue
}var j=d[m];
g+="-["+ ++f+"]-> '"+m.replace(h,"")+"' = '"+decodeURIComponent(j)+"'\n"
}if(!f){g+="(container is empty)"
}console.log(g)
}},keyName:function(d){return(this.config.container?(this.config.container+"/"):"")+d
},getKeys:function(){var h=this.getMap();
var g=[];
if(h){for(var d in h){if(this.config.container){if(d.indexOf(this.config.container+"/")==0){var f=d.substring(this.config.container.length+1);
g.push(f)
}}else{g.push(d)
}}}return g
},get:function(d){var f=this.getMap()[this.keyName(d)];
return f?decodeURIComponent(f):f
},set:function(f,j){f=(typeof f==="string")?f.replace(/:=/g,""):"";
var h={key:f};
f=this.keyName(f);
if(!f.length){return
}var d=[];
var k=this.getMap();
h.action=k[f]?"update":"set";
if(j){k[f]=encodeURIComponent(j)
}else{h.action="remove";
delete k[f]
}for(var g in k){d.push(g+":="+k[g])
}this.cache=k;
this.write(d.join("|"));
_g.$.extend(h,{value:j,mode:this.getMode().name,container:this.config.container});
_g.$(_g.shared.ClientSidePersistence).trigger(_g.shared.ClientSidePersistence.EVENT_NAME,h)
},getMap:function(){if(!this.cache||!this.config.useCache){var h=this.read().split("|");
var f={};
for(var d=0;
d<h.length;
d++){var j=h[d].split(":=");
var g=j[0];
if(g&&g.length){f[g]=j[1]||""
}}this.cache=f
}return this.cache
},remove:function(d){this.set(d)
},clearMap:function(){this.write()
},read:function(){return this.config.mode.read(this)||""
},write:function(d){this.config.mode.write(this,d||"")
}};
_g.$.extend(b.config,_g.shared.ClientSidePersistence.getDefaultConfig(),a);
if(b.config.useContainer===false){b.config.container=null
}if((b.config.mode===_g.shared.ClientSidePersistence.MODE_SESSION)&&(!window.sessionStorage||!window.sessionStorage.getItem||!window.sessionStorage.setItem)){b.config.mode=_g.shared.ClientSidePersistence.MODE_LOCAL
}if((b.config.mode===_g.shared.ClientSidePersistence.MODE_LOCAL)&&(!window.localStorage||!window.localStorage.getItem||!window.localStorage.setItem)){b.config.mode=_g.shared.ClientSidePersistence.MODE_WINDOW
}return b
};
_g.shared.ClientSidePersistence.EVENT_NAME="ClientSidePersistence";
_g.shared.ClientSidePersistence.MODE_SESSION={name:"session",read:function(a){return a.getWindow().sessionStorage.getItem(a.PERSISTENCE_NAME)
},write:function(a,b){if(Granite.OptOutUtil.isOptedOut()){return
}a.getWindow().sessionStorage.setItem(a.PERSISTENCE_NAME,b)
}};
_g.shared.ClientSidePersistence.MODE_LOCAL={name:"local",read:function(a){return a.getWindow().localStorage.getItem(a.PERSISTENCE_NAME)
},write:function(a,b){if(Granite.OptOutUtil.isOptedOut()){return
}a.getWindow().localStorage.setItem(a.PERSISTENCE_NAME,b)
}};
_g.shared.ClientSidePersistence.decoratePersistenceName=function(a){return a
};
_g.shared.ClientSidePersistence.MODE_WINDOW={name:"window",read:function(a){return a.getWindow().name
},write:function(a,b){if(Granite.OptOutUtil.isOptedOut()){return
}a.getWindow().name=b
}};
_g.shared.ClientSidePersistence.MODE_COOKIE={COOKIE_NAME:_g.shared.ClientSidePersistence.decoratePersistenceName("SessionPersistence"),name:"cookie",read:function(a){return _g.shared.ClientSidePersistence.CookieHelper.read(this.COOKIE_NAME)
},write:function(a,b){if(Granite.OptOutUtil.isOptedOut()&&!Granite.OptOutUtil.maySetCookie(this.COOKIE_NAME)){return
}if(!b){_g.shared.ClientSidePersistence.CookieHelper.erase(this.COOKIE_NAME)
}else{_g.shared.ClientSidePersistence.CookieHelper.set(this.COOKIE_NAME,b,365)
}}};
_g.shared.ClientSidePersistence.getDefaultConfig=function(){return{window:_g.shared.Util.getTopWindow(),useCache:false,container:null,mode:_g.shared.ClientSidePersistence.MODE_LOCAL}
};
_g.shared.ClientSidePersistence.CookieHelper={set:function(d,f,g){var a="";
if(g){var b=new Date();
b.setTime(b.getTime()+(g*24*60*60*1000));
a="; expires="+b.toGMTString()
}if(f){f=encodeURIComponent(f)
}document.cookie=d+"="+f+a+"; path=/"
},read:function(b){var g=b+"=";
var a=document.cookie.split(";");
for(var d=0;
d<a.length;
d++){var h=a[d];
while(h.charAt(0)==" "){h=h.substring(1,h.length)
}if(h.indexOf(g)==0){var f=h.substring(g.length,h.length);
return f?decodeURIComponent(f):null
}}return null
},erase:function(a){_g.shared.ClientSidePersistence.CookieHelper.set(a,"",-1)
}};
_g.shared.ClientSidePersistence.clearAllMaps=function(){var a=[_g.shared.ClientSidePersistence.MODE_COOKIE,_g.shared.ClientSidePersistence.MODE_LOCAL,_g.shared.ClientSidePersistence.MODE_SESSION,_g.shared.ClientSidePersistence.MODE_WINDOW];
_g.$.each(a,function(f,d){var b=new _g.shared.ClientSidePersistence({mode:d});
b.clearMap()
})
};
_g.I18n.init();
Granite=window.Granite||{};
Granite.UI=Granite.UI||{};
Granite.UI.Annotation={DV_V2DMapping:function(h,a,d){if(a){var g=a.plotBounds();
if(d){h.x=(h.x-g.left)/a.plotWidth()*1000;
h.y=(h.y-g.top)/a.plotHeight()*1000
}else{var f=a.getTrainedScale("x");
var b=a.getTrainedScale("y");
h.x=f.invertValue(h.x-g.left);
h.y=b.invertValue(h.y-g.top)
}}return h
},DV_D2VMapping:function(h,a,d){if(a){var g=a.plotBounds();
if(d){h.x=g.left+h.x/1000*a.plotWidth();
h.y=g.top+h.y/1000*a.plotHeight()
}else{var f=a.getTrainedScale("x");
var b=a.getTrainedScale("y");
if(typeof h.x==="string"&&h.x.match(/\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.*/)){h.x=new Date(h.x)
}h.x=f.mapValue(h.x)+g.left;
h.y=b.mapValue(h.y)+g.top
}}return h
}};
Granite=window.Granite||{};
Granite.UI=Granite.UI||{};
Granite.UI.Annotation.Shape=function(){function a(j){j.closePath()
}function g(k,j,l){k.moveTo(j,l)
}function f(k,j,l){k.lineTo(j,l)
}function h(k,m,o,l,n,j,p){k.bezierCurveTo(m,o,l,n,j,p)
}function d(k,l,m,j,n){k.quadraticCurveTo(l,m,j,n)
}function b(n,k,j){var l=[null];
for(var m=0;
m<j;
m++){l[m+1]=Math.round(+n[k+m])
}return l
}return{lineWidth:1,strokeStyle:null,fillStyle:null,type:"",domainBox:null,box:null,chrs:[],cmds:[],args:[],constructor:function(k,l,j){if(k){this.addPath(k)
}this.box=l||{x0:0,y0:0,x1:0,y1:0};
if(j){this.type=j
}return this
},stroke:function(j){j.beginPath();
this.drawPath(j);
j.stroke()
},fill:function(j){j.beginPath();
this.drawPath(j);
j.fill()
},draw:function(j){j.save();
j.translate(this.box.x0,this.box.y0);
if(this.fillStyle){j.fillStyle=this.fillStyle;
this.fill(j)
}if(this.strokeStyle){j.lineWidth=this.lineWidth;
j.strokeStyle=this.strokeStyle;
this.stroke(j)
}j.restore()
},drawPath:function(j){for(var l=0;
l<this.cmds.length;
l++){var k=this.args[l];
k[0]=j;
this.cmds[l].apply(this,k);
k[0]=null
}},toObject:function(){var j={path:this.toSVGPath(),box:this.box};
if(this.strokeStyle){j.strokeStyle=this.strokeStyle;
j.lineWidth=this.lineWidth
}if(this.fillStyle){j.fillStyle=this.fillStyle
}if(this.domainBox){j.domainBox=this.domainBox
}if(this.type){j.type=this.type
}return j
},clear:function(){this.cmds=[];
this.args=[];
this.chrs=[];
this.box={x0:0,y0:0,x1:0,y1:0};
this.lineStyle=null;
this.fillStyle=null
},toSVGPath:function(){var m="";
for(var n=0;
n<this.cmds.length;
n++){if(n>0){m+=" "
}m+=this.chrs[n];
var l=this.args[n];
for(var k=1;
k<l.length;
k++){m+=" "+l[k]
}}return m
},addCommand:function(l,k,j){switch(l){case"Z":this.cmds.push(a);
this.args.push([null]);
this.chrs.push(l);
return 0;
case"M":this.cmds.push(g);
this.args.push(b(k,j,2));
this.chrs.push(l);
return 2;
case"L":this.cmds.push(f);
this.args.push(b(k,j,2));
this.chrs.push(l);
return 2;
case"C":this.cmds.push(h);
this.args.push(b(k,j,6));
this.chrs.push(l);
return 6;
case"Q":this.cmds.push(d);
this.args.push(b(k,j,4));
this.chrs.push(l);
return 4;
default:console.log("unknown command",c);
return 0
}},addPath:function(l){var k=l.split(/\s+/);
for(var j=0;
j<k.length;
j++){j+=this.addCommand(k[j],k,j+1)
}}}.constructor(arguments[0],arguments[1],arguments[2])
};
Granite.UI.Annotation.Shape.fromObject=function(d,a,l){var k;
if(d.domainBox&&a){var b=d.domainBox;
var j=a.call(l,{x:b.x0,y:b.y0});
var h=a.call(l,{x:b.x1,y:b.y1});
var f={x0:j.x,y0:j.y,x1:h.x,y1:h.y};
if(d.type=="arrow"){var g=a.call(l,{x:b.ctlx,y:b.ctly});
f.ctlx=g.x;
f.ctly=g.y;
k=Granite.UI.Annotation.Shape.createArrow(f)
}else{if(d.type=="ellipse"){k=Granite.UI.Annotation.Shape.createEllipse(f)
}}}if(!k){k=new Granite.UI.Annotation.Shape(d.path,d.box,d.type)
}if(d.fillStyle){k.fillStyle=d.fillStyle
}if(d.strokeStyle){k.strokeStyle=d.strokeStyle;
k.lineWidth=d.lineWidth||1
}if(d.domainBox){k.domainBox=d.domainBox
}return k
};
Granite.UI.Annotation.Shape.createArrow=function(m,l){function v(L,J,M,H,K){var G=Math.sin(K);
var F=Math.cos(K);
while(H-->0){var E=F*L[M]-G*J[M];
var I=G*L[M]+F*J[M];
L[M]=E;
J[M++]=I
}}function r(I,H,E,a,G,F){while(a-->0){I[E]+=G;
H[E++]+=F
}}if(!m.l){var t=m.x0-m.x1;
var A=m.y0-m.y1;
m.l=Math.sqrt(t*t+A*A)
}var D=Math.min(1,m.l/100);
var h=5*D;
var w=15*D;
var s=20*D;
var C=2*D;
var z=3;
var n=Math.atan2(m.y1-m.y0,m.x1-m.x0);
var g,f,d,b,k,j;
if(m.ctlx){k=[d=m.ctlx];
j=[b=m.ctly];
v(k,j,0,1,-n);
g=k[0];
f=j[0]
}else{g=m.l/2;
f=m.maxD*2;
k=[g];
j=[f];
v(k,j,0,1,n);
d=k[0];
b=j[0]
}var B=Math.atan2(-f,m.l-g);
var q=[0,g,0,0,s,0,0,g,0];
var o=[-C,f-z,-h,-w,0,w,h,f+z,C];
v(q,o,2,5,B);
r(q,o,2,5,m.l,0);
v(q,o,0,q.length,n);
var p="";
for(var u=0;
u<q.length;
u++){if(u==0){p+="M "+q[u]+" "+o[u]+" "
}else{if(u==1||u==7){p+="Q "+q[u]+" "+o[u]+" "+q[u+1]+" "+o[u+1]+" ";
u++
}else{p+="L "+q[u]+" "+o[u]+" "
}}}p+="Z";
return new Granite.UI.Annotation.Shape(p,{x0:m.x0,y0:m.y0,x1:m.x1,y1:m.y1,ctlx:d,ctly:b},"arrow")
};
Granite.UI.Annotation.Shape.createEllipse=function(l,m){var n=l.x1-l.x0;
var f=l.y1-l.y0;
var j=0.5522848;
var d=(n/2)*j,a=(f/2)*j,g=n/2,b=f/2;
var k=new Granite.UI.Annotation.Shape(null,l,"ellipse");
k.addCommand("M",[0,b],0);
k.addCommand("C",[0,b-a,g-d,0,g,0],0);
k.addCommand("C",[g+d,0,n,b-a,n,b],0);
k.addCommand("C",[n,b+a,g+d,f,g,f],0);
k.addCommand("C",[g-d,f,0,b+a,0,b],0);
k.addCommand("Z");
return k
};
Granite.UI.Annotation.Canvas=function(){return{ctx:null,px:[],py:[],bb:{x0:0,y0:0,x1:0,y1:0,px0:0,py0:0,px1:0,py1:0,w:0,h:0,cx:0,cy:0,l:0,avgD:0,maxD:0,type:""},color:"#ffcc00",constructor:function(a){this.ctx=a;
return this
},addPoint:function(b,d){var a=this.px.length;
this.px[a]=b;
this.py[a++]=d
},clear:function(){this.px=[];
this.py=[];
this.bb.w=0
},calc:function(){var p=this.px;
var o=this.py;
var j=this.bb;
var v=p.length;
if(v>1){j.x0=j.x1=p[0];
j.y0=j.y1=o[0];
for(var u=1;
u<v;
u++){var m=p[u];
var l=o[u];
if(m<j.x0){j.x0=m
}if(m>j.x1){j.x1=m
}if(l<j.y0){j.y0=l
}if(l>j.y1){j.y1=l
}}j.w=j.x1-j.x0;
j.h=j.y1-j.y0;
var h=j.cx=j.x0+j.w/2;
var g=j.cy=j.y0+j.h/2;
j.px0=p[0];
j.py0=o[0];
j.px1=p[v-1];
j.py1=o[v-1];
var r=j.px0-j.px1;
var B=j.py0-j.py1;
j.l=Math.sqrt(r*r+B*B);
if(j.px0>j.px1){var n=j.x0;
j.x0=j.x1;
j.x1=n
}if(j.py0>j.py1){n=j.y0;
j.y0=j.y1;
j.y1=n
}var C=j.py0-j.py1;
var A=j.px1-j.px0;
var z=j.px0*j.py1-j.py0*j.px1;
var w=Math.sqrt(C*C+A*A);
var s=0;
var k=0;
var D=1;
for(u=0;
u<v;
u++){m=p[u];
l=o[u];
var f=C*m+A*l+z;
var q=Math.abs(f)/w;
if(q>k){k=q;
D=f>0?1:-1
}s+=q
}j.avgD=s/v;
j.maxD=D*k;
j.type=j.avgD/j.l<0.2?"a":"e"
}},getShape:function(){var f=this.bb;
var d=null;
if(f.w>0){if(f.type=="a"){d=Granite.UI.Annotation.Shape.createArrow({x0:f.px0,y0:f.py0,x1:f.px1,y1:f.py1,l:f.l,maxD:f.maxD});
d.strokeStyle=this.color;
d.lineWidth=1;
d.fillStyle=this.color
}else{var a=Math.min(f.x0,f.x1);
var b=Math.min(f.y0,f.y1);
var g={x0:a,y0:b,x1:a+f.w,y1:b+f.h};
d=Granite.UI.Annotation.Shape.createEllipse(g);
d.strokeStyle=this.color;
d.lineWidth=5;
d.fillStyle=null
}}return d
},draw:function(g){var f=this.px;
var b=this.py;
var j=this.bb;
var a=this.ctx;
if(f.length==0&&j.w==0){return
}if(g&&f.length>0){a.lineWidth=1;
a.strokeStyle="rgba(0,255,0,0.9)";
a.beginPath();
a.moveTo(j.x0,j.y0);
a.lineTo(j.x1,j.y0);
a.lineTo(j.x1,j.y1);
a.lineTo(j.x0,j.y1);
a.closePath();
a.stroke()
}var h=this.getShape();
if(h){h.draw(a)
}if(f.length>0){a.strokeStyle="rgba(128,128,128,0.8)";
a.lineWidth=5;
a.lineCap="round";
a.beginPath();
for(var d=0;
d<f.length;
d++){if(d==0){a.moveTo(f[0],b[0])
}else{a.lineTo(f[d],b[d])
}}if(f.length==1){a.lineTo(f[0]+1,b[0]+1)
}a.stroke()
}}}.constructor(arguments[0])
};
(function(b){var a=b([]);
var f;
b.event.special.resize={setup:function(){var g=b(this);
a=a.add(g);
g.data("resize",{w:g.width(),h:g.height()});
if(a.length===1){d()
}},teardown:function(){var g=b(this);
a=a.not(g);
g.removeData("resize");
if(!a.length){clearTimeout(f)
}}};
function d(){a.each(function(){var h=b(this);
var k=h.data("resize");
var j=h.width();
var g=h.height();
if(j!==k.w||g!==k.h){k.w=j;
k.h=g;
h.triggerHandler("resize")
}});
f=setTimeout(d,250)
}})(jQuery);
(function(b,d,g){d.Annotation=function(h,j){this.$el=d(j);
this._init(h)
};
var f=d(b);
d.Annotation.prototype={options:{canvasClass:null,activeClass:null,resizeWatch:false},ctx:null,dimension:{w:0,h:0},shapes:[],texts:[],imageData:null,damCanvas:null,isDrawing:false,$canvas:null,d2vMapping:null,v2dMapping:null,_init:function(h){this.options=h||{};
this.d2vMapping=this._defaultD2VMapping;
this.v2dMapping=this._defaultV2DMapping
},_defaultD2VMapping:function(h){if(this.dimension.w){h.x=h.x/1000*this.dimension.w;
h.y=h.y/1000*this.dimension.h
}return h
},_defaultV2DMapping:function(h){if(this.dimension.w){h.x=h.x/this.dimension.w*1000;
h.y=h.y/this.dimension.h*1000
}return h
},_bindEvents:function(){var h=this.$canvas;
if(h){h.on({"mousedown touchstart":this._beginDraw,"mouseup touchend":this._endDraw,"mousemove touchmove":this._userDraw},{self:this});
if(this.options.activeClass){h.addClass(this.options.activeClass)
}else{h.css({cursor:"crosshair"})
}this.$el.trigger("annotateStart",this)
}},_unbindEvents:function(){var h=this.$canvas;
if(h){h.off({"mousedown touchstart":this._beginDraw,"mouseup touchend":this._endDraw,"movemove touchmove":this._userDraw});
if(this.options.activeClass){h.removeClass(this.options.activeClass)
}else{h.css("cursor","")
}}},_draw:function(){var j=this.ctx;
if(j){var h=j.canvas.width;
var l=j.canvas.height;
j.clearRect(0,0,h,l);
if(this.damCanvas){this.damCanvas.draw(false)
}for(var k=0;
k<this.shapes.length;
k++){this.shapes[k].draw(j)
}}},_userDraw:function(l){var j=l.data.self;
if(j.isDrawing&&j.damCanvas){var p=l;
var k=l.originalEvent.targetTouches;
if(k){p=k[0]
}var m=j.$canvas.offset();
var h=p.pageX-m.left;
var n=p.pageY-m.top;
j.damCanvas.addPoint(h,n);
j.damCanvas.calc();
j._draw()
}return false
},_beginDraw:function(j){var h=j.data.self;
if(h.damCanvas){h.annotation=null;
h.isDrawing=true;
h.$el.trigger("annotateBegin",h)
}return false
},_endDraw:function(j){var h=j.data.self;
if(h.damCanvas){h.isDrawing=false;
var l=h.damCanvas.getShape();
h.damCanvas=null;
if(l){if(h.v2dMapping){var m={x:l.box.x0,y:l.box.y0};
var k={x:l.box.x1,y:l.box.y1};
h.v2dMapping(m);
h.v2dMapping(k);
l.domainBox={x0:m.x,y0:m.y,x1:k.x,y1:k.y};
if(l.box.ctlx){k={x:l.box.ctlx,y:l.box.ctly};
h.v2dMapping(k);
l.domainBox.ctlx=k.x;
l.domainBox.ctly=k.y
}}h.addShape(l)
}h._draw();
if(l){h.setImageData(h.ctx.canvas.toDataURL("image/png",1));
h.$el.trigger("annotateEnd",[h,l])
}h._unbindEvents()
}return false
},open:function(){if(!this.ctx){var k=this.$el;
var m=this.$canvas=d("<canvas></canvas>");
if(this.options.canvasClass){m.addClass(this.options.canvasClass)
}else{m.css({position:"absolute",display:"block","z-index":100})
}m.insertBefore(k);
this.ctx=m.get(0).getContext("2d");
var j=k.width();
var l=k.height();
this.dimension={w:j,h:l};
m.attr("width",j);
m.attr("height",l);
k.on("load",this.onResize,{self:this});
if(this.options.resizeWatch){k.on("resize",this.onResize)
}this.$el.trigger("annotateOpen",this)
}return this
},close:function(){if(this.$canvas){this._unbindEvents();
this.$el.off("load resize");
this.$canvas.remove();
this.ctx=null;
this.$canvas=null;
this.$el.trigger("annotateClose",this);
this.shapes=[];
this.texts=[]
}},onResize:function(){var l=this;
var j=d.data(this,"annotation");
if(j){l=j
}var o=l.$canvas;
if(o){var k=l.$el.width();
var n=l.$el.height();
l.dimension={w:k,h:n};
o.attr("width",k);
o.attr("height",n);
for(var m=0;
m<l.shapes.length;
m++){l.shapes[m]=Granite.UI.Annotation.Shape.fromObject(l.shapes[m],l.d2vMapping,l)
}l._draw()
}},show:function(){if(this.$canvas){this._draw();
this.$canvas.show()
}else{a("Annotation canvas needs to be open before it can be shown.")
}},hide:function(){if(this.$canvas){this.$canvas.hide()
}},start:function(){if(!this.ctx){a("Annotation canvas needs to be open before you can draw.");
return
}if(!this.damCanvas){this.damCanvas=new Granite.UI.Annotation.Canvas(this.ctx);
this.show();
this._bindEvents()
}return this
},addShape:function(h){this.shapes.push(h);
return this
},addText:function(h){this.texts.push(h);
return this
},clear:function(){this.shapes=[];
this.texts=[];
this._draw()
},setV2DMapping:function(h){this.v2dMapping=h
},setD2VMapping:function(h){this.d2vMapping=h
},toJson:function(j){var h=[];
for(var k=0;
k<this.shapes.length;
k++){h.push(this.shapes[k].toObject())
}return JSON.stringify({dimension:this.dimension,shapes:h,texts:this.texts},null,j)
},fromJson:function(j){var k=JSON.parse(j);
if(!k||!k.shapes){return false
}this.shapes=[];
for(var h=0;
h<k.shapes.length;
h++){var l=Granite.UI.Annotation.Shape.fromObject(k.shapes[h],this.d2vMapping,this);
this.shapes.push(l)
}this.text=k.text;
this.dimension=k.dimension;
return true
},setImageData:function(h){this.imageData=h
},getImageData:function(){return this.imageData
}};
var a=function(h){if(b.console){b.console.error(h)
}};
d.fn.annotation=function(l){var k=this,h;
if(l===g){h=d.data(this[0],"annotation");
if(!h){a("Annotation instance not initialized. Call $.annotation({}) first.");
return
}return h
}else{if(typeof l==="string"){var j=Array.prototype.slice.call(arguments,1);
this.each(function(){var m=d.data(this,"annotation");
if(!m){a("Annotation instance not initialized. Call $.annotation({}) first.");
return
}if(!d.isFunction(m[l])||l.charAt(0)==="_"){a("no such method '"+l+"' for annotation instance");
return
}var n=m[l].apply(m,j);
if(n!==g){k=n
}});
return k
}else{h=d.data(this[0],"annotation");
if(h){h._init(l)
}else{h=new d.Annotation(l,this[0]);
d.data(this[0],"annotation",h)
}return h
}}}
})(window,jQuery);
(function(g,f,j){var h=0,d,b=function(l){if(d){f.requestAnimationFrame(b,l);
g.fx.tick()
}},k=["ms","moz","webkit","o"];
for(var a=0;
a<k.length&&!f.requestAnimationFrame;
++a){f.requestAnimationFrame=f[k[a]+"RequestAnimationFrame"];
f.cancelAnimationFrame=f[k[a]+"CancelAnimationFrame"]||f[k[a]+"CancelRequestAnimationFrame"]
}if(!f.requestAnimationFrame){f.requestAnimationFrame=function(n,m){var l=new Date().getTime(),q=l-h,o=Math.max(0,13-q);
var p=f.setTimeout(function(){n(l+o)
},o);
h=l+o;
return p
}
}if(!f.cancelAnimationFrame){f.cancelAnimationFrame=function(l){clearTimeout(l)
}
}g.fx.timer=function(l){if(l()&&g.timers.push(l)&&!d){d=true;
b(l.elem)
}};
g.fx.stop=function(){d=false
}
}(jQuery,this));
(function(b){var a={};
b.each(["Quad","Cubic","Quart","Quint","Expo"],function(f,d){a[d]=function(g){return Math.pow(g,f+2)
}
});
b.extend(a,{Sine:function(d){return 1-Math.cos(d*Math.PI/2)
},Circ:function(d){return 1-Math.sqrt(1-d*d)
},Elastic:function(d){return d===0||d===1?d:-Math.pow(2,8*(d-1))*Math.sin(((d-1)*80-7.5)*Math.PI/15)
},Back:function(d){return d*d*(3*d-2)
},Bounce:function(g){var d,f=4;
while(g<((d=Math.pow(2,--f))-1)/11){}return 1/Math.pow(4,3-f)-7.5625*Math.pow((d*3-2)/22-g,2)
}});
b.each(a,function(f,d){b.easing["easeIn"+f]=d;
b.easing["easeOut"+f]=function(g){return 1-d(1-g)
};
b.easing["easeInOut"+f]=function(g){return g<0.5?d(g*2)/2:d(g*-2+2)/-2+1
}
})
}(jQuery));
(function(k,n,g,d){var h=!!("ontouchstart" in n);
var a=[];
var p;
function l(q,r){return(h?q.touch:q.pointer)+"."+r
}function f(r,v,q,t,u,s){return{top:Math.round(v-q-(Math.cos(s*t)*u)),left:Math.round(r-q-(Math.sin(s*t)*-u))}
}function j(q,t){var u=5;
var v=t.layout.details.distance+t.layout.details.radius+u;
var s=k(t.container);
var w=function(B,A,z){if(B-A<0){return A
}else{return n.Math.min(B,z-A)
}};
return{x:w(q.x,v,s.innerWidth()),y:w(q.y,v,s.innerHeight())}
}function b(q){if(!q){return d
}if(k.isFunction(q)){return q(event)
}if(typeof q==="string"){return k(event.target).closest(q)
}return k(q)
}function m(t,r){var s=b(r.anchor);
if(s){var v=s.position();
return j({x:v.left+Math.round(s.width()/2),y:v.top+Math.round(s.height()/2)},r)
}else{var q={pageX:t.pageX,pageY:t.pageY};
var u=k(r.container).offset();
return j({x:q.pageX-u.left,y:q.pageY-u.top},r)
}}function o(s,q,r){if(typeof q.startPos=="number"){return q.startPos
}return -1*((s?s.length-1:0)/2)
}k.quickaction=function(s,t,r){var q=k.extend(true,k.quickaction.settings,r);
if(t===d){k.quickaction.settings.layout.destroy(q)
}else{k.quickaction.settings.layout.render(t,q,s)
}};
k.quickaction.LAYOUT_CIRCLE={tag:"<div/>",cssClass:"quickaction-circle",closeButton:"<button class='icon-close'>"+g.I18n.get("Close")+"</a>",effect:{duration:150,easing:"easeInQuad"},details:{zIndex:9999,distance:100,angle:2*Math.PI/11,radius:21,startPos:"auto"},render:function(t,q,s){var r=l(q.event.closeMenu,q.event.namespace);
k.quickaction.settings.layout.destroy(q);
p=k("<div class='quickaction-mask'>").css("z-index",this.details.zIndex).appendTo(h?q.container:"body");
this.renderActions(t,q,s);
k(q.container).trigger(k.quickaction.events.openMenu,{cfg:q,target:s.target})
},destroy:function(q){var r=false;
while(a.length>0){r=true;
a.pop().remove()
}if(r){k(q.container).trigger(k.quickaction.events.closeMenu,{cfg:q})
}if(p){n.setTimeout(function(){if(p){p.remove();
p=d
}},400)
}},renderActions:function(z,D,s){var u=k(D.container);
var E=k(s.target);
var r=m(s,D);
var q=D.layout.details;
var C=q.radius*2;
var A={top:r.y-q.radius,left:r.x-q.radius,height:C,width:C,borderRadius:C,position:"absolute","z-index":q.zIndex-1};
var w=l(D.event.executeHandler,D.event.namespace);
var B=o(z,D,s);
if(D.displayCloseButton){var v={display:k.quickaction.settings.layout.closeButton,touchpoint:true,handler:function(t){k.quickaction.settings.layout.destroy(D)
}};
z.push(v)
}k.each(z,function(){var G=this;
if(k.isFunction(G.condition)&&!G.condition(E)){return true
}var F=k(D.layout.tag).addClass(D.layout.cssClass);
u.append(F);
a.push(F);
F.css(A);
F.append(G.display);
if(G.customEvent){k.each(G.customEvent,function(J,I){F.on(J,function(K){K.target=E;
I(K)
})
})
}if(G.handler){F.on(w,function(I){I.target=E;
if(!G.handler(I)){k.quickaction.settings.layout.destroy(D)
}})
}if(D.autoClose&&G.pinned!==true){F.on(w,function(){n.setTimeout(function(){k.quickaction.settings.layout.destroy(D)
},500)
})
}if(!G.touchpoint){var t=D.layout.details;
var H=f(r.x,r.y,t.radius,t.angle,t.distance,B);
B++;
F.delay(10).animate({top:H.top,left:H.left},{duration:D.layout.effect.duration,easing:D.layout.effect.easing,complete:function(){k(this).css("z-index",t.zIndex+1)
}})
}else{F.css("z-index",D.layout.details.zIndex+1)
}})
}};
k.quickaction.LAYOUT_BAR={tag:"<ul/>",cssClass:"quickaction-bar",details:{zIndex:9999,size:28},render:function(v,q,u){var r=this;
if(q.container.find("."+this.cssClass).length){return
}this.destroy(q);
this.renderActions(v,q,u);
k(q.container).trigger(k.quickaction.events.openMenu,{cfg:q,target:u.target});
if(q.autoClose){var s=l(q.event.closeMenu,q.event.namespace);
var t=r.getQuickactionsBar();
q.anchor.off(s);
q.anchor.on(s,function(w){if(k(w.relatedTarget).closest("."+q.layout.cssClass).length){return
}if(t&&t.data("quickaction.internal.pinned")===true){return
}r.destroy(q);
q.anchor.off(s)
});
if(t){t.off(s);
t.on(s,function(w){if(k(w.relatedTarget).closest(q.anchor).length){return
}if(t.data("quickaction.internal.pinned")===true){return
}r.destroy(q);
t.off(s)
})
}}},destroy:function(q){var r=false;
while(a.length>0){r=true;
a.pop().remove()
}if(r){k(q.container).trigger(k.quickaction.events.closeMenu,{cfg:q})
}},getQuickactionsBar:function(){return(a&&a.length)?a[0]:d
},renderActions:function(A,B,r){var E=this;
var s=k(B.container);
var D=k(r.target);
var C=b(B.anchor);
var q=this.details;
var v=k(B.layout.tag).addClass(B.layout.cssClass);
var u=parseInt(C.css("margin-top").replace("px",""));
var z=k(C).find(".label").outerHeight(true);
s.append(v);
v.css("position","absolute");
v.css("top",C.position().top+u+C.height()-z-q.size-10);
v.css("left",C.position().left-1);
v.css("width",C.width());
v.css("height",q.size);
v.css("z-index",q.zIndex);
a.push(v);
var w=l(B.event.executeHandler,B.event.namespace);
k.each(A,function(){var F=this;
if(k.isFunction(F.condition)&&!F.condition(D)){return true
}var t=k("<li/>").css({width:q.size,height:q.size});
v.append(t);
a.push(t);
t.append(F.display);
if(F.customEvent){k.each(F.customEvent,function(H,G){t.on(H,function(I){I.target=D;
G(I)
})
})
}if(F.handler){t.on(w,function(G){G.target=D;
if(!F.handler(G)){k.quickaction.settings.layout.destroy(B)
}})
}if(B.autoClose&&F.pinned===true){t.on(w,function(){v.data("quickaction.internal.pinned",true)
})
}});
v.addClass("quickaction-fadein")
}};
k.quickaction.settings={event:{namespace:"quickaction",openMenu:{touch:"taphold",pointer:"mouseover"},closeMenu:{touch:"tap",pointer:"mouseleave"},executeHandler:{touch:"tap",pointer:"click"}},container:"body",layout:k.quickaction.LAYOUT_CIRCLE,autoClose:false};
k.quickaction.events={openMenu:"quickactionopenmenu",closeMenu:"quickactionclosemenu"};
k.fn.extend({quickaction:function(u,t){var q=k.extend(true,k.quickaction.settings,t);
var s=l(q.event.openMenu,q.event.namespace);
var r=function(v){k.quickaction.settings.layout.render(u,q,v)
};
return this.each(function(){k(this).on(s,r)
})
}})
}(jQuery,this,Granite));
(function(a,d){var b=function(g,h,f){this.currentPath=h;
this.impersonatesOnly=f;
g.filters({autocompleteCallback:this.autocompleteCallback.bind(this),optionRenderer:this.optionRenderer.bind(this)})
};
b.prototype.autocompleteCallback=function(g,f){this.lastSearch=f;
jQuery.get(this.currentPath,{search:f,impersonatesOnly:(this.impersonatesOnly)?"1":"0"},function(j){var h=[];
d(j).find("li").each(function(){var k={};
k.html=d(this).children();
k.value=d(this).data("value");
k.toString=function(){return this.value
};
h.push(k)
});
g(h)
})
};
b.prototype.optionRenderer=function(h,g,f,k){if(typeof g=="string"){var j=d("<span>");
j.text(g);
return j
}if(g.html){return g.html
}return""
};
d(a).on("foundation-contentloaded",function(g){var f=g.target;
d(f).find(".granite-userpicker").each(function(){var k=d(this).data("userpicker-path");
var j=d(this).data("userpicker-impersonates-only");
var h=(j!=undefined&&j!="false"&&j!="0"&&j!="");
new b(d(this),k+".userlist.html",h)
})
})
})(document,Granite.$||jQuery);
$(document).on("foundation-contentloaded",function(b){var a=b.target;
$(a).find("[data-datepicker-format]").each(function(){var h=$(this).data("datepicker-format");
if(!h){return
}var f=$(this).text();
if(!f){return
}var d=moment(f,["YYYY-MM-DD[T]HH:mm:ss.000Z","YYYY-MM-DD[T]HH:mm:ssZ",h]);
if(!d){return
}var g=d.format(h);
$(this).replaceWith(g)
})
});
(function(j,a){var f=j.console||a,l=j.document,o=j.navigator,n=j.sessionStorage||false,d=j.setTimeout,m=j.clearTimeout,g=j.setInterval,q=j.clearInterval,p=j.JSON,k=j.alert,b=j.History=j.History||{},h=j.history;
p.stringify=p.stringify||p.encode;
p.parse=p.parse||p.decode;
if(typeof b.init!=="undefined"){throw new Error("History.js Core has already been loaded...")
}b.init=function(){if(typeof b.Adapter==="undefined"){return false
}if(typeof b.initCore!=="undefined"){b.initCore()
}if(typeof b.initHtml4!=="undefined"){b.initHtml4()
}return true
};
b.initCore=function(){if(typeof b.initCore.initialized!=="undefined"){return false
}else{b.initCore.initialized=true
}b.options=b.options||{};
b.options.hashChangeInterval=b.options.hashChangeInterval||100;
b.options.safariPollInterval=b.options.safariPollInterval||500;
b.options.doubleCheckInterval=b.options.doubleCheckInterval||500;
b.options.storeInterval=b.options.storeInterval||1000;
b.options.busyDelay=b.options.busyDelay||250;
b.options.debug=b.options.debug||false;
b.options.initialTitle=b.options.initialTitle||l.title;
b.options.transformHash=b.options.transformHash||true;
b.intervalList=[];
b.clearAllIntervals=function(){var u,t=b.intervalList;
if(typeof t!=="undefined"&&t!==null){for(u=0;
u<t.length;
u++){q(t[u])
}b.intervalList=null
}};
b.debug=function(){if((b.options.debug||false)){b.log.apply(b,arguments)
}};
b.log=function(){var B=!(typeof f==="undefined"||typeof f.log==="undefined"||typeof f.log.apply==="undefined"),u=l.getElementById("log"),A,z,C,v,t;
if(B){v=Array.prototype.slice.call(arguments);
A=v.shift();
if(typeof f.debug!=="undefined"){f.debug.apply(f,[A,v])
}else{f.log.apply(f,[A,v])
}}else{A=("\n"+arguments[0]+"\n")
}for(z=1,C=arguments.length;
z<C;
++z){t=arguments[z];
if(typeof t==="object"&&typeof p!=="undefined"){try{t=p.stringify(t)
}catch(w){}}A+="\n"+t+"\n"
}if(u){u.value+=A+"\n-----\n";
u.scrollTop=u.scrollHeight-u.clientHeight
}else{if(!B){k(A)
}}return true
};
b.getInternetExplorerMajorVersion=function(){var t=b.getInternetExplorerMajorVersion.cached=(typeof b.getInternetExplorerMajorVersion.cached!=="undefined")?b.getInternetExplorerMajorVersion.cached:(function(){var u=3,z=l.createElement("div"),w=z.getElementsByTagName("i");
while((z.innerHTML="<!--[if gt IE "+(++u)+"]><i></i><![endif]-->")&&w[0]){}return(u>4)?u:false
})();
return t
};
b.isInternetExplorer=function(){var t=b.isInternetExplorer.cached=(typeof b.isInternetExplorer.cached!=="undefined")?b.isInternetExplorer.cached:Boolean(b.getInternetExplorerMajorVersion());
return t
};
b.emulated={pushState:!Boolean(j.history&&j.history.pushState&&j.history.replaceState&&!((/ Mobile\/([1-7][a-z]|(8([abcde]|f(1[0-8]))))/i).test(o.userAgent)||(/AppleWebKit\/5([0-2]|3[0-2])/i).test(o.userAgent))),hashChange:Boolean(!(("onhashchange" in j)||("onhashchange" in l))||(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<8))};
b.enabled=!b.emulated.pushState;
b.bugs={setHash:Boolean(!b.emulated.pushState&&o.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),safariPoll:Boolean(!b.emulated.pushState&&o.vendor==="Apple Computer, Inc."&&/AppleWebKit\/5([0-2]|3[0-3])/.test(o.userAgent)),ieDoubleCheck:Boolean(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<8),hashEscape:Boolean(b.isInternetExplorer()&&b.getInternetExplorerMajorVersion()<7)};
b.isEmptyObject=function(u){for(var t in u){return false
}return true
};
b.cloneObject=function(v){var u,t;
if(v){u=p.stringify(v);
t=p.parse(u)
}else{t={}
}return t
};
b.getRootUrl=function(){var t=l.location.protocol+"//"+(l.location.hostname||l.location.host);
if(l.location.port||false){t+=":"+l.location.port
}t+="/";
return t
};
b.getBaseHref=function(){var t=l.getElementsByTagName("base"),v=null,u="";
if(t.length===1){v=t[0];
u=v.href.replace(/[^\/]+$/,"")
}u=u.replace(/\/+$/,"");
if(u){u+="/"
}return u
};
b.getBaseUrl=function(){var t=b.getBaseHref()||b.getBasePageUrl()||b.getRootUrl();
return t
};
b.getPageUrl=function(){var t=b.getState(false,false),v=(t||{}).url||l.location.href,u;
u=v.replace(/\/+$/,"").replace(/[^\/]+$/,function(A,z,w){return(/\./).test(A)?A:A+"/"
});
return u
};
b.getBasePageUrl=function(){var t=l.location.href.replace(/[#\?].*/,"").replace(/[^\/]+$/,function(w,v,u){return(/[^\/]$/).test(w)?"":w
}).replace(/\/+$/,"")+"/";
return t
};
b.getFullUrl=function(u,w){var t=u,v=u.substring(0,1);
w=(typeof w==="undefined")?true:w;
if(/[a-z]+\:\/\//.test(u)){}else{if(v==="/"){t=b.getRootUrl()+u.replace(/^\/+/,"")
}else{if(v==="#"){t=b.getPageUrl().replace(/#.*/,"")+u
}else{if(v==="?"){t=b.getPageUrl().replace(/[\?#].*/,"")+u
}else{if(w){t=b.getBaseUrl()+u.replace(/^(\.\/)+/,"")
}else{t=b.getBasePageUrl()+u.replace(/^(\.\/)+/,"")
}}}}}return t.replace(/\#$/,"")
};
b.getShortUrl=function(v){var u=v,w=b.getBaseUrl(),t=b.getRootUrl();
if(b.emulated.pushState){u=u.replace(w,"")
}u=u.replace(t,"/");
if(b.isTraditionalAnchor(u)){u="./"+u
}u=u.replace(/^(\.\/)+/g,"./").replace(/\#$/,"");
return u
};
b.store={};
b.idToState=b.idToState||{};
b.stateToId=b.stateToId||{};
b.urlToId=b.urlToId||{};
b.storedStates=b.storedStates||[];
b.savedStates=b.savedStates||[];
b.normalizeStore=function(){b.store.idToState=b.store.idToState||{};
b.store.urlToId=b.store.urlToId||{};
b.store.stateToId=b.store.stateToId||{}
};
b.getState=function(v,u){if(typeof v==="undefined"){v=true
}if(typeof u==="undefined"){u=true
}var t=b.getLastSavedState();
if(!t&&u){t=b.createStateObject()
}if(v){t=b.cloneObject(t);
t.url=t.cleanUrl||t.url
}return t
};
b.getIdByState=function(t){var v=b.extractId(t.url),u;
if(!v){u=b.getStateString(t);
if(typeof b.stateToId[u]!=="undefined"){v=b.stateToId[u]
}else{if(typeof b.store.stateToId[u]!=="undefined"){v=b.store.stateToId[u]
}else{while(true){v=(new Date()).getTime()+String(Math.random()).replace(/\D/g,"");
if(typeof b.idToState[v]==="undefined"&&typeof b.store.idToState[v]==="undefined"){break
}}b.stateToId[u]=v;
b.idToState[v]=t
}}}return v
};
b.normalizeState=function(u){var v,t;
if(!u||(typeof u!=="object")){u={}
}if(typeof u.normalized!=="undefined"){return u
}if(!u.data||(typeof u.data!=="object")){u.data={}
}v={};
v.normalized=true;
v.title=u.title||"";
v.url=b.getFullUrl(b.unescapeString(u.url||l.location.href));
v.hash=b.getShortUrl(v.url);
v.data=b.cloneObject(u.data);
v.id=b.getIdByState(v);
v.cleanUrl=v.url.replace(/\??\&_suid.*/,"");
v.url=v.cleanUrl;
t=!b.isEmptyObject(v.data);
if(v.title||t){v.hash=b.getShortUrl(v.url).replace(/\??\&_suid.*/,"");
if(!/\?/.test(v.hash)){v.hash+="?"
}v.hash+="&_suid="+v.id
}v.hashedUrl=b.getFullUrl(v.hash);
if((b.emulated.pushState||b.bugs.safariPoll)&&b.hasUrlDuplicate(v)){v.url=v.hashedUrl
}return v
};
b.createStateObject=function(v,w,u){var t={data:v,title:w,url:u};
t=b.normalizeState(t);
return t
};
b.getStateById=function(u){u=String(u);
var t=b.idToState[u]||b.store.idToState[u]||a;
return t
};
b.getStateString=function(u){var t,v,w;
t=b.normalizeState(u);
v={data:t.data,title:u.title,url:u.url};
w=p.stringify(v);
return w
};
b.getStateId=function(u){var t,v;
t=b.normalizeState(u);
v=t.id;
return v
};
b.getHashByState=function(u){var t,v;
t=b.normalizeState(u);
v=t.hash;
return v
};
b.extractId=function(v){var w,u,t;
u=/(.*)\&_suid=([0-9]+)$/.exec(v);
t=u?(u[1]||v):v;
w=u?String(u[2]||""):"";
return w||false
};
b.isTraditionalAnchor=function(u){var t=!(/[\/\?\.]/.test(u));
return t
};
b.extractState=function(w,v){var t=null,z,u;
v=v||false;
z=b.extractId(w);
if(z){t=b.getStateById(z)
}if(!t){u=b.getFullUrl(w);
z=b.getIdByUrl(u)||false;
if(z){t=b.getStateById(z)
}if(!t&&v&&!b.isTraditionalAnchor(w)){t=b.createStateObject(null,null,u)
}}return t
};
b.getIdByUrl=function(t){var u=b.urlToId[t]||b.store.urlToId[t]||a;
return u
};
b.getLastSavedState=function(){return b.savedStates[b.savedStates.length-1]||a
};
b.getLastStoredState=function(){return b.storedStates[b.storedStates.length-1]||a
};
b.hasUrlDuplicate=function(v){var u=false,t;
t=b.extractState(v.url);
u=t&&t.id!==v.id;
return u
};
b.storeState=function(t){b.urlToId[t.url]=t.id;
b.storedStates.push(b.cloneObject(t));
return t
};
b.isLastSavedState=function(w){var v=false,u,t,z;
if(b.savedStates.length){u=w.id;
t=b.getLastSavedState();
z=t.id;
v=(u===z)
}return v
};
b.saveState=function(t){if(b.isLastSavedState(t)){return false
}b.savedStates.push(b.cloneObject(t));
return true
};
b.getStateByIndex=function(u){var t=null;
if(typeof u==="undefined"){t=b.savedStates[b.savedStates.length-1]
}else{if(u<0){t=b.savedStates[b.savedStates.length+u]
}else{t=b.savedStates[u]
}}return t
};
b.getHash=function(){var t=b.unescapeHash(l.location.hash);
return t
};
b.unescapeString=function(v){var t=v,u;
while(true){u=j.unescape(encodeURIComponent(t));
if(u===t){break
}t=u
}return t
};
b.unescapeHash=function(u){var t=b.normalizeHash(u);
t=b.unescapeString(t);
return t
};
b.normalizeHash=function(u){var t=u.replace(/[^#]*#/,"").replace(/#.*/,"");
return t
};
b.setHash=function(z,u){var t,v,w;
if(u!==false&&b.busy()){b.pushQueue({scope:b,callback:b.setHash,args:arguments,queue:u});
return false
}t=b.escapeHash(z);
b.busy(true);
v=b.extractState(z,true);
if(v&&!b.emulated.pushState){b.pushState(v.data,v.title,v.url,false)
}else{if(l.location.hash!==t){if(b.bugs.setHash){w=b.getPageUrl();
b.pushState(null,null,w+"#"+t,false)
}else{l.location.hash=t
}}}return b
};
b.escapeHash=function(u){var t=b.normalizeHash(u);
t=j.escape(t);
if(!b.bugs.hashEscape){t=t.replace(/\%21/g,"!").replace(/\%26/g,"&").replace(/\%3D/g,"=").replace(/\%3F/g,"?")
}return t
};
b.getHashByUrl=function(t){var u=String(t).replace(/([^#]*)#?([^#]*)#?(.*)/,"$2");
u=b.unescapeHash(u);
return u
};
b.setTitle=function(v){var w=v.title,u;
if(!w){u=b.getStateByIndex(0);
if(u&&u.url===v.url){w=u.title||b.options.initialTitle
}}try{l.getElementsByTagName("title")[0].innerHTML=w.replace("<","&lt;").replace(">","&gt;").replace(" & "," &amp; ")
}catch(t){}l.title=w;
return b
};
b.queues=[];
b.busy=function(u){if(typeof u!=="undefined"){b.busy.flag=u
}else{if(typeof b.busy.flag==="undefined"){b.busy.flag=false
}}if(!b.busy.flag){m(b.busy.timeout);
var t=function(){var w,v,z;
if(b.busy.flag){return
}for(w=b.queues.length-1;
w>=0;
--w){v=b.queues[w];
if(v.length===0){continue
}z=v.shift();
b.fireQueueItem(z);
b.busy.timeout=d(t,b.options.busyDelay)
}};
b.busy.timeout=d(t,b.options.busyDelay)
}return b.busy.flag
};
b.busy.flag=false;
b.fireQueueItem=function(t){return t.callback.apply(t.scope||b,t.args||[])
};
b.pushQueue=function(t){b.queues[t.queue||0]=b.queues[t.queue||0]||[];
b.queues[t.queue||0].push(t);
return b
};
b.queue=function(u,t){if(typeof u==="function"){u={callback:u}
}if(typeof t!=="undefined"){u.queue=t
}if(b.busy()){b.pushQueue(u)
}else{b.fireQueueItem(u)
}return b
};
b.clearQueue=function(){b.busy.flag=false;
b.queues=[];
return b
};
b.stateChanged=false;
b.doubleChecker=false;
b.doubleCheckComplete=function(){b.stateChanged=true;
b.doubleCheckClear();
return b
};
b.doubleCheckClear=function(){if(b.doubleChecker){m(b.doubleChecker);
b.doubleChecker=false
}return b
};
b.doubleCheck=function(t){b.stateChanged=false;
b.doubleCheckClear();
if(b.bugs.ieDoubleCheck){b.doubleChecker=d(function(){b.doubleCheckClear();
if(!b.stateChanged){t()
}return true
},b.options.doubleCheckInterval)
}return b
};
b.safariStatePoll=function(){var u=b.extractState(l.location.href),t;
if(!b.isLastSavedState(u)){t=u
}else{return
}if(!t){t=b.createStateObject()
}b.Adapter.trigger(j,"popstate");
return b
};
b.back=function(t){if(t!==false&&b.busy()){b.pushQueue({scope:b,callback:b.back,args:arguments,queue:t});
return false
}b.busy(true);
b.doubleCheck(function(){b.back(false)
});
h.go(-1);
return true
};
b.forward=function(t){if(t!==false&&b.busy()){b.pushQueue({scope:b,callback:b.forward,args:arguments,queue:t});
return false
}b.busy(true);
b.doubleCheck(function(){b.forward(false)
});
h.go(1);
return true
};
b.go=function(u,t){var v;
if(u>0){for(v=1;
v<=u;
++v){b.forward(t)
}}else{if(u<0){for(v=-1;
v>=u;
--v){b.back(t)
}}else{throw new Error("History.go: History.go requires a positive or negative integer passed.")
}}return b
};
if(b.emulated.pushState){var s=function(){};
b.pushState=b.pushState||s;
b.replaceState=b.replaceState||s
}else{b.onPopState=function(w,t){var A=false,z=false,v,u;
b.doubleCheckComplete();
v=b.getHash();
if(v){u=b.extractState(v||l.location.href,true);
if(b.options.transformHash&&u){b.replaceState(u.data,u.title,u.url,false)
}else{b.Adapter.trigger(j,"anchorchange");
b.busy(false)
}b.expectedStateId=false;
return false
}A=b.Adapter.extractEventData("state",w,t)||false;
if(A){z=b.getStateById(A)
}else{if(b.expectedStateId){z=b.getStateById(b.expectedStateId)
}else{z=b.extractState(l.location.href)
}}if(!z){z=b.createStateObject(null,null,l.location.href)
}b.expectedStateId=false;
if(b.isLastSavedState(z)){b.busy(false);
return false
}b.storeState(z);
b.saveState(z);
b.setTitle(z);
b.Adapter.trigger(j,"statechange");
b.busy(false);
return true
};
b.Adapter.bind(j,"popstate",b.onPopState);
b.pushState=function(v,z,u,t){if(b.getHashByUrl(u)&&b.emulated.pushState){throw new Error("History.js does not support states with fragment-identifiers (hashes/anchors).")
}if(t!==false&&b.busy()){b.pushQueue({scope:b,callback:b.pushState,args:arguments,queue:t});
return false
}b.busy(true);
var w=b.createStateObject(v,z,u);
if(b.isLastSavedState(w)){b.busy(false)
}else{b.storeState(w);
b.expectedStateId=w.id;
h.pushState(w.id,w.title,w.url);
b.Adapter.trigger(j,"popstate")
}return true
};
b.replaceState=function(v,z,u,t){if(b.getHashByUrl(u)&&b.emulated.pushState){throw new Error("History.js does not support states with fragement-identifiers (hashes/anchors).")
}if(t!==false&&b.busy()){b.pushQueue({scope:b,callback:b.replaceState,args:arguments,queue:t});
return false
}b.busy(true);
var w=b.createStateObject(v,z,u);
if(b.isLastSavedState(w)){b.busy(false)
}else{b.storeState(w);
b.expectedStateId=w.id;
h.replaceState(w.id,w.title,w.url);
b.Adapter.trigger(j,"popstate")
}return true
}
}if(n){try{b.store=p.parse(n.getItem("History.store"))||{}
}catch(r){b.store={}
}b.normalizeStore()
}else{b.store={};
b.normalizeStore()
}b.Adapter.bind(j,"beforeunload",b.clearAllIntervals);
b.Adapter.bind(j,"unload",b.clearAllIntervals);
b.saveState(b.storeState(b.extractState(l.location.href,true)));
if(n){b.onUnload=function(){var t,v;
try{t=p.parse(n.getItem("History.store"))||{}
}catch(u){t={}
}t.idToState=t.idToState||{};
t.urlToId=t.urlToId||{};
t.stateToId=t.stateToId||{};
for(v in b.idToState){if(!b.idToState.hasOwnProperty(v)){continue
}t.idToState[v]=b.idToState[v]
}for(v in b.urlToId){if(!b.urlToId.hasOwnProperty(v)){continue
}t.urlToId[v]=b.urlToId[v]
}for(v in b.stateToId){if(!b.stateToId.hasOwnProperty(v)){continue
}t.stateToId[v]=b.stateToId[v]
}b.store=t;
b.normalizeStore();
n.setItem("History.store",p.stringify(t))
};
b.intervalList.push(g(b.onUnload,b.options.storeInterval));
b.Adapter.bind(j,"beforeunload",b.onUnload);
b.Adapter.bind(j,"unload",b.onUnload)
}if(!b.emulated.pushState){if(b.bugs.safariPoll){b.intervalList.push(g(b.safariStatePoll,b.options.safariPollInterval))
}if(o.vendor==="Apple Computer, Inc."||(o.appCodeName||"")==="Mozilla"){b.Adapter.bind(j,"hashchange",function(){b.Adapter.trigger(j,"popstate")
});
if(b.getHash()){b.Adapter.onDomLoad(function(){b.Adapter.trigger(j,"hashchange")
})
}}}};
b.init()
})(window);
(function(b,f){var a=b.History=b.History||{},d=b.jQuery;
if(typeof a.Adapter!=="undefined"){throw new Error("History.js Adapter has already been loaded...")
}a.Adapter={bind:function(g,h,j){d(g).bind(h,j)
},trigger:function(h,j,g){d(h).trigger(j,g)
},extractEventData:function(j,k,h){var g=(k&&k.originalEvent&&k.originalEvent[j])||(h&&h[j])||f;
return g
},onDomLoad:function(g){d(g)
}};
if(typeof a.init!=="undefined"){a.init()
}})(window);
$(document).on("click","button[type=submit]",function(a){var b=$(this).attr("form");
if(b){a.preventDefault();
$("#"+b).submit()
}});
(function(a,b){b(a).on("foundation-selections-change",".foundation-collection[role=listbox]",function(d){b(this).find(".foundation-collection-item").each(function(){var g=b(this);
var f=g.is(".foundation-selections-item");
g.attr("aria-selected",f);
g.find("input.aria-value[type=hidden]").prop("disabled",!f)
})
})
})(document,Granite.$);
(function(b,a,d){b.eventSpider=(function(){var s={},h=b.event.add,j=b.event.remove,q=b.event.trigger,k=b.event.dispatch,l=decodeURIComponent(a.location.search.slice(1)).split("&").reduce(function f(u,t){t=t.split("=");
u[t[0]]=t[1];
return u
},{});
s.storage=[];
s.timeline=[];
s.config={autoflush:false};
function m(u,t){console.log(u,t)
}function p(u){var t=null;
b.each(s.storage,function(v,w){if(w.elem===u){t=w;
return false
}});
return t
}function r(z,u,v,B,t){var A=p(z),w={types:u,handler:v,data:B,selector:t,created:new Date().getTime()};
if(A){A.events.push(w)
}else{s.storage.push({elem:z,events:[w]})
}h.apply(this,arguments);
if(s.config.autoflush){m("listener added",{elem:z,event:w})
}}function n(z,v,w,t,u){var A=p(z);
if(v&&!w&&!t&&!u){}j.apply(this,arguments)
}function g(w,z,v,t){var u={event:w.type,originalEvent:w,data:z,elem:v,onlyHandlers:t,fired:new Date().getTime()};
s.timeline.push(u);
q.apply(this,arguments);
if(s.config.autoflush){m("event triggered",u)
}}function o(u){var t={event:u.type,originalEvent:u,fired:new Date().getTime()};
s.timeline.push(t);
k.apply(this,arguments);
if(s.config.autoflush){m("native event triggered",t)
}}s.getHandler=function(t){return p(t)
};
s.getEvents=function(u){var v=s.getHandler(u),t={};
if(v){b.each(v.events,function(w,z){b.each(z.types.split(" "),function(B,C){var D=C.split(".");
if(!t[D[0]]){t[D[0]]=[]
}for(var A=1;
A<D.length;
A++){if(b.inArray(D[A],t[D[0]])===-1){t[D[0]].push(D[A])
}}})
});
return t
}return v
};
if(l.debugClientLibs){if(location.hash=="#flushEvents"){s.config.autoflush=true
}b.event.add=r;
b.event.remove=n;
b.event.trigger=g;
b.event.dispatch=o
}return s
}())
}(jQuery,this));
Granite=window.Granite||{};
Granite.UI=Granite.UI||{};
Granite.UI.Foundation=Granite.UI.Foundation||{};
(function(a,d,b){b.options.transformHash=false;
d(a).on("cui-contentloaded.foundation",function(g,f){if(f&&f._foundationcontentloaded){return
}d(g.target).trigger("foundation-contentloaded",{_cuicontentloaded:true})
});
d(a).on("foundation-contentloaded.foundation",function(g,f){if(f&&f._cuicontentloaded){return
}d(g.target).trigger("cui-contentloaded",{_foundationcontentloaded:true})
})
})(window.document,Granite.$,History);
(function(a,b,d,f){b.UI.Foundation.Utils=b.UI.Foundation.Utils||(function(){var h=[];
var g=function(m,k,l,n){n=n||d(k);
m.find(k).each(function(){var o=this;
if(n.is(function(){return l(this,o)
})){d(o).remove()
}})
};
var j=function(l,k){if(l.length===0){d.each(k,function(){if(d(this).prop("src")){l.push(this)
}});
return l
}d.each(k,function(){var m=this;
var n=d(m).prop("src");
if(!n){return
}var o=false;
d.each(l,function(){var p=d(this).prop("src");
if(p===n){o=true;
return false
}});
if(!o){l.push(m)
}});
return l
};
return{processHtml:function(n,k){var l;
if(n.jquery){l=n
}else{var p=a.createElement("div");
p.innerHTML=n;
l=d(p)
}g(l,"script",function(r,s){var q=d(s).prop("src");
if(!q){return false
}return d(r).prop("src")===q
},d(j(h,d("script"))));
g(l,"link",function(r,t){var s=d(r);
var q=d(t);
if(s.prop("rel")!=="stylesheet"||q.prop("rel")!=="stylesheet"){return false
}else{return s.prop("href")===q.prop("href")
}});
var m=d("head");
d("link",d(k||"body")).each(function(){m.append(d(this).clone());
d(this).remove()
});
j(h,d("script",l));
var o=l.find(k);
if(n.jquery){if(k){return o.length?o:l
}else{return l
}}else{if(k){return o.length?o[0].outerHTML:l[0].innerHTML
}else{return l[0].innerHTML
}}}}
})()
})(document,Granite,Granite.$);
(function(d,a,b,f){function g(l,j,h){var k;
l.some(function(m){if(j.apply(h,arguments)){k=m;
return true
}return false
});
return k
}b.UI.Foundation.Adapters=b.UI.Foundation.Adapters||(function(){var h=[];
var j=function(l){var k;
if(typeof l.selector==="string"){k=l.selector
}else{if(l.selector===a){k="document"
}else{if(f(d).is(l.selector)){k="window"
}else{throw new Error("Invalid config selector")
}}}return"foundation.adapters.internal.adapters."+l.type+"::"+k
};
return{register:function(n,k,l){var m={type:n,selector:k,adapter:l};
j(m);
h.push(m)
},has:function(k){return h.some(function(l){return l.type===k
})
},get:function(l){var k=[];
h.forEach(function(m){if(m.type===l){k.push(m)
}});
return k
},adapt:function(l,o){if(!l||!o){return
}var n=f(l);
var k=g(h,function(p){return p.type==o&&n.is(p.selector)
});
if(!k){return
}var m=j(k);
return n.data(m)||(function(){var p=k.adapter(l);
n.data(m,p);
return p
})()
}}
})();
f.fn.adaptTo=f.fn.adaptTo||function(h){return b.UI.Foundation.Adapters.adapt(this[0],h)
}
})(window,document,Granite,Granite.$);
(function(a,b,d,f){b.UI.Foundation.Layouts=b.UI.Foundation.Layouts||(function(){function g(){this.layouter={};
this.cleaner={}
}g.prototype={register:function(h,k,j){this.layouter[h]=k;
this.cleaner[h]=j
},has:function(h){return this.layouter.hasOwnProperty(h)
},hasCleaner:function(h){return this.cleaner.hasOwnProperty(h)
},get:function(h){return this.has(h)?this.layouter[h]:f
},getCleaner:function(h){return this.hasCleaner(h)?this.cleaner[h]:f
},layout:function(k){var j=d(k);
var h=j.data("foundationLayout");
var l=this.get(h.name);
if(l){l(k,h)
}this.displayToggle(j.data("foundationLayout"))
},displayToggle:function(k){var h=d(".foundation-admin-layouttoggle"),j=h.find("button");
j.each(function(m,o){var l=d(o),n=l.data("foundation-admin-layouttoggle-layout");
if(n.name!==k.name){l.removeClass("hide")
}else{l.addClass("hide")
}})
},switchLayout:function(l,k){var j=d(l),h=j.data("foundationLayout");
if(h.name===k.name){return
}if(h){(this.getCleaner(h.name)||this.clean)(l,h)
}j.addClass(k.name);
j.data("foundationLayout",k);
this.layout(l)
},clean:function(k){var j=d(k);
var h=j.data("foundationLayout");
j.removeClass(h.name);
j.data("foundationLayout",null)
}};
return new g()
})();
d(a).on("foundation-contentloaded.foundation-layout",function(g){d(g.target).filter("[data-foundation-layout]").add(d("[data-foundation-layout]",g.target)).each(function(){b.UI.Foundation.Layouts.layout(this)
})
})
})(document,Granite,Granite.$);
(function(b,k){var j=".foundation-collection-action";
function a(m,l){m.toggleClass("hide",!l)
}function h(l,m){if(m===0&&l===0){return true
}if(m>0&&l===">0"){return true
}return false
}function f(m,l){if(l===0&&m==="none"){return true
}if(l===1&&m==="single"){return true
}if(l>=1&&m==="multiple"){return true
}return false
}function g(m,o){var l=o.find(".foundation-selections-item").toArray().map(function(q){var p=k(q).find(".foundation-collection-quickactions").data("foundationCollectionQuickactionsRel")||"";
p=p.trim();
return p.length?p.split(/\s+/):[]
});
var n=l.every(function(p){return p.length===0
});
if(n){return true
}return l.every(function(p){return !p.every(function(q){return !m.hasClass(q)
})
})
}function d(p,m,q){var l=true;
if(m.hasOwnProperty("activeCount")){var o=q.find(".foundation-collection-item").length;
l=h(m.activeCount,o)
}if(l&&m.hasOwnProperty("activeSelectionCount")){var n=q.adaptTo("foundation-selections");
l=f(m.activeSelectionCount,n.count())
}if(l){l=g(p,q)
}return l
}k(b).on("foundation-contentloaded"+j,function(l){k(".foundation-collection-action",l.target).each(function(){var n=k(this);
var m=n.data("foundationCollectionAction");
if(!m){return
}var o=k(m.target);
if(!o.length){return
}a(n,d(n,m,o))
})
});
k(b).on("foundation-selections-change"+j,".foundation-collection",function(l){var m=k(this);
k(".foundation-collection-action").each(function(){var o=k(this);
var n=o.data("foundationCollectionAction");
if(!n||!m.is(n.target)){return
}a(o,d(o,n,m))
})
})
})(document,Granite.$);
(function(j,b,h,k){var g=".foundation-collection-infinityscrolling";
function f(p,m){var n=m.prop("scrollHeight");
var o=m.prop("scrollTop");
var l=m.prop("clientHeight");
if(l+o>=n&&p.is(":visible")){d(p)
}}function a(p,n){var o=n.height();
var m=n.prop("scrollHeight");
var l=p.data("src");
if(l&&(m-o)===0){d(p).done(function(){a(p,n)
})
}}function d(m){if(m.data("foundationCollectionInfinityscrolling.internal.isLoading")){return k.Deferred().fail()
}var l=m.data("src");
if(!l){return k.Deferred().fail()
}m.data("foundationCollectionInfinityscrolling.internal.isLoading",true);
return k.ajax({url:l}).done(function(n){var p=k(h.UI.Foundation.Utils.processHtml(n));
m.data("src",p.find(".foundation-collection").data("src"));
var o=m.adaptTo("foundation-layout");
if(o&&typeof o.append==="function"){o.append(p.find(".foundation-collection-item").get())
}else{if(j.console){console.warn("The collection has no layout or the layout has no appending support; new items are not appended")
}}m.data("foundationCollectionInfinityscrolling.internal.isLoading",false)
}).fail(function(){m.data("foundationCollectionInfinityscrolling.internal.isLoading",false)
})
}k(b).on("foundation-contentloaded"+g,function(l){k(".foundation-collection",l.target).each(function(){var n=k(this);
var m=(function(p){var o=p.data("scrollSrc");
if(o){return p.closest(o)
}return p.parent()
})(n);
m.off("scroll"+g).on("scroll"+g,function(){f(n,m)
});
a(n,m)
})
})
})(window,document,Granite,Granite.$);
(function(a,b){a.UI.Foundation.Adapters.register("foundation-selections",".foundation-collection",function(d){var f=b(d);
return{count:function(){return f.find(".foundation-selections-item").length
},clear:function(g){var h=f.find(".foundation-selections-item").removeClass("foundation-selections-item").length;
if(!g&&h){f.trigger("foundation-selections-change")
}return this
}}
})
})(Granite,Granite.$);
(function(g,a,f,h,d){function b(n){var l=[n];
var m=0;
return{current:function(){return this.peek(0)
},peek:function(o){return l[m+o]
},pointToToken:function(p){for(var o=0,q=l.length;
o<q;
o++){var r=l[o];
if(r.token===p){m=o;
return r
}}},forward:function(){if(m<l.length-1){return l[++m]
}},back:function(){if(m>0){return l[--m]
}},push:function(o){l.splice(++m,l.length-m,o)
}}
}function k(){return""+Date.now()
}var j=k();
if(d.enabled){d.replaceState({foundationContent:{token:j}})
}h(a).on("click.foundation-content",".foundation-content-control",function(p){p.preventDefault();
var o=h(this);
var n=o.data("foundationContentControlAction");
var m=o.data("foundationContentControlRefresh");
var l=o.closest(".foundation-content").adaptTo("foundation-content");
if(n==="back"){l.back(m)
}else{if(n==="forward"){l.forward(m)
}}});
h(g).on("statechange",function(o){var n=d.getState();
if(!n.data.foundationContent){return
}var m=h(".foundation-content");
if(!m.length){return
}var l=m.adaptTo("foundation-content");
l.goToToken(n.data.foundationContent.token)
});
f.UI.Foundation.Adapters.register("foundation-content",".foundation-content",function(o){var p=h(o);
var m=b({token:j,el:p.children(".foundation-content-current")});
var l=function(q){return q.children(".foundation-content-current").removeClass("foundation-content-current").detach()
};
var n=function(q){return h.ajax(q,{cache:!h.browser.msie})
};
return{pushState:function(r,s,q){return this.go(q,false,d.enabled?{data:r,title:s,url:q}:undefined)
},replaceState:function(r,s,q){return this.go(q,true,d.enabled?{data:r,title:s,url:q}:undefined)
},go:function(r,s,t){var q=this;
return n(r).then(function(u){if(s){return q.replace(u,t)
}else{return q.push(u,t)
}})
},goToToken:function(r){var s=m.pointToToken(r);
if(!s||s.el.is(".foundation-content-current")){return
}var q=f.UI.Foundation.Utils.processHtml(s.el);
l(p);
q.addClass("foundation-content-current").appendTo(p)
},refresh:function(){return this.go(a.location.toString(),true)
},push:function(r,w){var q=k();
var v=h(".foundation-content-path").data("foundation-content-path");
var s=f.UI.Foundation.Utils.processHtml(r,".foundation-content-current");
l(p);
var u=h("<div class='foundation-content-current'>").append(s).appendTo(p);
if(h(".foundation-content-path").length===0){h('<div class="foundation-content-path hidden"></div>').data("foundation-content-path",v).prependTo(h(".foundation-content-current"))
}m.push({token:q,el:u,history:d.enabled&&w});
u.trigger("foundation-contentloaded");
if(d.enabled&&w){var t=w.data||{};
t.foundationContent={token:q};
d.pushState(t,w.title,w.url)
}return q
},replace:function(q,u){var r=f.UI.Foundation.Utils.processHtml(q,".foundation-content-current");
p.children(".foundation-content-current").empty().append(r).trigger("foundation-contentloaded");
var t=m.current();
t.historyConfig=d.enabled&&u;
if(t.historyConfig){var s=u.data||{};
s.foundationContent={token:t.token};
d.replaceState(s,u.title,u.url)
}return t.token
},back:function(t){if(d.enabled&&m.current().history&&d.getState().data.foundationContent){if(t){var q=this;
h(g).one("statechange",function(){q.refresh()
})
}var v=m.peek(-1);
d.back();
return v?v.token:undefined
}var u=m.back();
if(!u){return
}var s=f.UI.Foundation.Utils.processHtml(u.el);
l(p);
s.addClass("foundation-content-current").appendTo(p);
if(t){this.refresh()
}var r=CUI.CardView.get(h(".foundation-collection",p));
if(r&&r.layout){r.layout()
}return u.token
},forward:function(t){if(d.enabled&&d.getState().data.foundationContent){if(t){var q=this;
h(g).one("statechange",function(){q.refresh()
})
}var u=m.peek(1);
d.forward();
return u?u.token:undefined
}var s=m.forward();
if(!s){return
}var r=f.UI.Foundation.Utils.processHtml(s.el);
l(p);
r.addClass("foundation-content-current").appendTo(p);
if(t){this.refresh()
}return s.token
}}
})
})(window,document,Granite,Granite.$,History);
(function(a,h,g){if(!g.enabled){return
}var f=".foundation-content-history";
var d=(function(){var k=g.options.initialTitle;
if(k.indexOf("|")!=-1){k=k.substring(0,k.indexOf("|")).replace(/\s\s*$/,"")
}return k
})();
function j(m,r,t,s){var n=m.data(r);
if(n===undefined){n={}
}if(typeof n!=="object"){var l={};
l[t]=n;
n=l
}for(var p=3,q=arguments.length;
p<q;
p++){var k=arguments[p];
n[k]=m.data(r+"-"+k)
}return n
}function b(l){var k=j(l,"foundation-content-history","action","title","data");
var m=d+(k.title?" | "+k.title:"");
return{title:m,url:l.prop("href"),replace:k.action!==undefined?k.action==="replace":!!k.replace,data:k.data}
}h(a).on("click"+f,"a[data-foundation-content-history]",function(p){try{var k=h(this);
var n=h(".foundation-content");
if(!n.length){return
}var o=b(k);
var m=n.adaptTo("foundation-content");
if(o.replace){m.replaceState(o.data,o.title,o.url)
}else{m.pushState(o.data,o.title,o.url)
}p.preventDefault()
}catch(l){}})
})(document,Granite.$,History);
(function(k,f,g,d){var n=".foundation-form";
var b=g('<div class="modal" data-type="error"><div class="modal-header"><h2></h2><button class="close" type="button" data-dismiss="modal">&times;</button></div><div class="modal-body"></div></div>');
function p(s){var t=s.adaptTo("foundation-field");
if(t){t.reset()
}}function a(s){return g.ajax({type:s.prop("method"),url:s.prop("action"),contentType:s.prop("enctype"),data:s.serialize(),cache:false})
}function h(s,t){t.done(q(s)).fail(r(s))
}function q(t){var s=t.data("redirect");
if(s){return function(){g.ajax(s).always(j(t))
}
}else{return j(t)
}}function o(s,t){if(s.lastIndexOf("?")>=0){return s+"&"+t
}return s+"?"+t
}function j(s){return function(u){var z=s.data("foundationFormOutputReplace")||s.data("foundationFormOutputPush");
if(!z){return
}var w=g(z);
var t=w.adaptTo("foundation-content");
if(t){var v=(function(){if(d.enabled){var B=s.data("foundationFormHistory");
if(B){var A=B.url||B.useFormUrl?o(s.prop("action"),s.serialize()):undefined;
return{data:B.data,title:B.title,url:A}
}}})();
if(s.data("foundationFormOutputReplace")){t.replace(u,v)
}else{t.push(u,v)
}}else{w.html(u)
}}
}function r(){return function(w,t,v){var u=b.clone();
if(t==="error"){var s=g(w.responseText);
if(s.find(".foundation-form-response-status-code").length>0){u.find(".modal-header h2").html(s.find(".foundation-form-response-title").next().html());
u.find(".modal-body").html(s.find(".foundation-form-response-description").next().html());
u.appendTo("body").modal("show");
return
}}u.find(".modal-header h2").text(t);
u.find(".modal-body").text(v);
u.appendTo("body").modal("show")
}
}g(k).on("foundation-form-submit-callback"+n,"form.foundation-form",function(s,t){h(g(this),t)
});
g(k).on("reset"+n,"form.foundation-form",function(s){g(this).adaptTo("foundation-form").reset(true)
});
g(k).on("submit"+n,"form.foundation-form",function(u){var s=g(this);
if(s.data("foundationFormAjax")){var t=s.data("foundationFormHistory");
if(!d.enabled&&(typeof(t)!="undefined")&&t.noSupportBehaviour==="disableAjax"){return
}u.preventDefault();
if(!s.data("foundationFormDisable")){h(s,a(s))
}}});
f.UI.Foundation.Adapters.register("foundation-form","form.foundation-form",function(s){var t=g(s);
return{reset:function(u){if(!u){s.reset()
}t.find(".foundation-field-editable").each(function(){var v=g(this);
p(v.find(".foundation-field-readonly"));
p(v.find(".foundation-field-edit"))
})
}}
});
function m(s,t){if(t){return g("."+s+"[data-foundation-mode-group~='"+t+"'], ."+s+":not([data-foundation-mode-group])")
}else{return g("."+s)
}}function l(s,t){s.toggleClass("mode-edit mode-default")
}g(k).on("foundation-mode-change"+n,function(t,u,s){if(u!=="default"&&u!=="edit"){return
}l(m("foundation-form",s),u)
})
})(document,Granite,Granite.$,History);
(function(a,b){a.UI.Foundation.Adapters.register("foundation-wizard",".foundation-wizard",function(d){var f=b(d);
return{toggleNext:function(g){this.toggle("next",g)
},togglePrev:function(g){this.toggle("prev",g)
},toggleCancel:function(g){this.toggle("cancel",g)
},toggle:function(k,g){var h=f.adaptTo("foundation-layout");
if(h&&typeof h.toggle==="function"){h.toggle(k,g);
return
}var j=f.children(".foundation-wizard-step.foundation-wizard-step-active").find(".foundation-wizard-control[data-foundation-wizard-control-action="+k+"]");
j.each(function(){if(b(this).is("button")){b(this).prop("disabled",!g)
}else{b(this).toggleClass("disabled",!g)
}})
}}
})
})(Granite,Granite.$);
(function(d,a,b,f,h){function g(j){var k=j?d.localStorage:d.sessionStorage;
return{get:function(l){return JSON.parse(k.getItem(l))
},set:function(l,m){k.setItem(l,JSON.stringify(m))
},remove:function(l){k.removeItem(l)
}}
}b.UI.Foundation.Adapters.register("foundation-clipboard",f(d),function(j){var l=f(j);
var k=g();
return{get:function(m){return k.get(m)
},set:function(m,n){k.set(m,n);
l.trigger("foundation-clipboard-change",{key:m,data:n,timestamp:new Date().getTime()})
},remove:function(m){k.remove(m);
l.trigger("foundation-clipboard-change",{key:m,data:null,timestamp:new Date().getTime()})
}}
})
})(window,document,Granite,Granite.$);
(function(d,a,f){var b=".foundation-mode";
f(a).on("click"+b,".foundation-mode-change",function(j){j.preventDefault();
var g=f(this);
var k=g.data("foundationModeValue");
var h=g.data("foundationModeGroup");
g.trigger("foundation-mode-change",[k,h]);
f(d).resize()
})
})(window,document,Granite.$);
(function(b,a,d){d(a).fipo("tap","click",".foundation-history-control",function(h){h.preventDefault();
var g=d(this);
var f=g.data("foundationHistoryControlAction");
if(f==="back"){b.history.back()
}else{if(f==="forward"){b.history.forward()
}}})
})(window,document,Granite.$);
(function(d,a,f){function g(h,j){if(j){return"%7B"+h+"%7D"
}else{return"{"+h+"}"
}}var b=(function(){var h=[];
return{register:function(j,k){h.push({varname:j,provider:k})
},expandURITemplate:function(j){if(!j){return j
}return h.reduce(function(l,k){var m=encodeURIComponent(k.provider(k.varname));
return l.replace(g(k.varname),m).replace(g(k.varname,true),m)
},j)
},resolveVar:function(j){var k;
h.some(function(l){if(l.varname===j){k=l.provider(j);
return true
}});
return k
}}
})();
b.register("window.location",function(){return d.location
});
f(a).on("click","a.foundation-setter",function(h){h.preventDefault();
d.location=b.expandURITemplate(this.href)
});
f(a).on("foundation-contentloaded",function(h){f("input.foundation-setter",h.target).each(function(){this.value=b.resolveVar(f(this).data("foundationSetterVar"))
})
})
})(window,document,Granite.$);
(function(l,g,k,n){var m=".foundation-layout-card";
var h=m+"-quickactions";
function a(q){var p=function(s,t,r){if(t!=="default"&&t!=="selection"){return
}if(q.data("foundationModeGroup")!==r){return
}n.CardView.get(q).setGridSelectionMode(t==="selection");
q.closest(".foundation-collection-container").toggleClass("mode-selection",t==="selection");
if(t==="default"){d(q)
}else{f(q)
}};
k(l).on("foundation-mode-change"+m,p);
q.data("foundation-layout-card.internal.modeChangeHandler",p);
q.on("change:selection"+m,function(r){q.trigger("foundation-selections-change")
});
if(q.is("[data-foundation-collection-quickactions]")){var o=q.data("foundationCollection");
if(!o||o.mode==="default"){d(q)
}}}function b(p,r,o){var q=p.find(".foundation-collection-quickactions").children();
if(q.length){return q
}return r.siblings("[data-foundation-collection-quickactions-name~="+o.fallback+"]").children()
}function d(r){var p=r.data("foundationCollectionQuickactions");
var o=r.adaptTo("foundation-selections");
var q=k.quickaction.settings.event;
r.finger(q.openMenu.touch+h,".foundation-collection-item",function(t){var s=k(this);
var u=b(s,r,p);
if(!u||!u.length){return
}t.preventDefault();
t.stopImmediatePropagation();
k.quickaction(t,u.map(function(){var v=k(this);
return{display:v.clone(true).data("foundationCollectionItem",s[0]),pinned:!!v.data("foundationCollectionQuickactionPinned")}
}),{container:r,layout:k.quickaction.LAYOUT_CIRCLE,autoClose:true,displayCloseButton:true});
o.clear(true);
s.addClass("foundation-selections-item");
r.trigger("foundation-selections-change");
r.one("quickactionclosemenu"+h,function(){o.clear()
})
});
r.pointer(q.openMenu.pointer+h,".foundation-collection-item",function(t){var s=k(this);
var u=b(s,r,p);
if(!u||!u.length){return
}t.preventDefault();
t.stopImmediatePropagation();
k.quickaction(t,u.map(function(){var v=k(this);
return{display:v.clone(true).data("foundationCollectionItem",s[0]),pinned:!!v.data("foundationCollectionQuickactionPinned")}
}),{container:r,anchor:s,layout:k.quickaction.LAYOUT_BAR,autoClose:true})
})
}function f(o){o.off(h)
}function j(o){k(l).off("foundation-mode-change"+m,o.data("foundation-layout-card.internal.modeChangeHandler"));
o.off("change:selection"+m);
o.removeData("foundation-layout-card.internal.modeChangeHandler");
f(o)
}g.UI.Foundation.Layouts.register("foundation-layout-card",function(p,o){var s=k(p);
if(!s.hasClass("foundation-collection")){return
}if(s.data("foundation-layout-card.internal.init")){return
}s.data("foundation-layout-card.internal.init",true);
s.closest(".foundation-collection-container").addClass("card");
s.wrapInner("<div class='grid-0'>");
s.cardView({selectorConfig:{itemSelector:".foundation-collection-item",headerSelector:"header",dataContainer:"grid-0",enableImageMultiply:true,view:{selectedItem:{list:{cls:"foundation-selections-item selected"},grid:{cls:"foundation-selections-item selected"}},selectedItems:{list:{selector:".foundation-selections-item"},grid:{selector:".foundation-selections-item"}}},controller:{selectElement:{list:".foundation-collection-item .select",grid:".foundation-collection-item"},moveHandleElement:{list:".foundation-collection-item > .move"},targetToItem:{list:function(t){return t.closest(".foundation-collection-item")
},grid:function(t){return t.closest(".foundation-collection-item")
},header:function(t){return t.closest("header")
}},gridSelect:{cls:"mode-selection"},selectAll:{selector:"header > i.select",cls:"selected"}}}});
var q=n.CardView.get(s);
q.setDisplayMode(n.CardView.DISPLAY_GRID);
a(s);
if(o.selectionMode){q.setGridSelectionMode(true)
}var r=s.data("foundationSelectionsMode");
if(r){q.setSelectionModeCount(r)
}},function(p,o){g.UI.Foundation.Layouts.clean(p);
var q=k(p);
q.closest(".foundation-collection-container").removeClass("card");
j(q);
q.removeData("foundation-layout-card.internal.init")
});
g.UI.Foundation.Adapters.register("foundation-layout",".foundation-layout-card.foundation-collection",function(o){var p=k(o);
return{append:function(q){n.CardView.get(p).append(q);
p.trigger("foundation-contentloaded")
}}
})
})(document,Granite,Granite.$,CUI);
(function(a,j,k,d){var h=".foundation-layout-list";
function g(l,m){if(m){return k("."+l+"[data-foundation-mode-group~='"+m+"'], ."+l+":not([data-foundation-mode-group])")
}else{return k("."+l)
}}function b(o){var l=o.adaptTo("foundation-selections");
var n=o.data("foundationModeGroup");
var m=function(q,r,p){if(r!=="default"&&r!=="selection"){return
}if(o.data("foundationModeGroup")!==p){return
}if(r!=="selection"){d.CardView.get(o).clearSelection()
}};
k(a).on("foundation-mode-change"+h,m);
o.data("foundation-layout-list.internal.modeChangeHandler",m);
o.on("change:selection"+h,function(r){if(r.moreSelectionChanges===true){return
}var p=o.data("foundation-layout-list.internal.beforeCount")||0;
var q=l.count();
if(p===0&&q>0){o.trigger("foundation-mode-change",["selection",n])
}else{if(p>0&&q===0){o.trigger("foundation-mode-change",["default",n])
}}o.trigger("foundation-selections-change");
o.data("foundation-layout-list.internal.beforeCount",q)
})
}function f(l){k(a).off("foundation-mode-change"+h,l.data("foundation-layout-list.internal.modeChangeHandler"));
l.off("change:selection"+h);
l.removeData("foundation-layout-list.internal.modeChangeHandler");
l.removeData("foundation-layout-list.internal.beforeCount")
}j.UI.Foundation.Layouts.register("foundation-layout-list",function(m,l){var p=k(m);
if(!p.hasClass("foundation-collection")){return
}if(p.data("foundation-layout-list.internal.init")){return
}p.data("foundation-layout-list.internal.init",true);
var n=p.data("foundationModeGroup");
g("foundation-mode-change",n).css("display","none");
if(!p.data("cardView")){p.addClass("list").wrapInner("<div class='grid-0'>")
}p.cardView({selectorConfig:{itemSelector:".foundation-collection-item",headerSelector:"header",dataContainer:"grid-0",enableImageMultiply:true,view:{selectedItem:{list:{cls:"foundation-selections-item selected"},grid:{cls:"foundation-selections-item selected"}},selectedItems:{list:{selector:".foundation-selections-item"},grid:{selector:".foundation-selections-item"}}},controller:{selectElement:{list:".foundation-collection-item .select",grid:".foundation-collection-item"},moveHandleElement:{list:".foundation-collection-item > .move"},targetToItem:{list:function(q){return q.closest(".foundation-collection-item")
},grid:function(q){return q.closest(".foundation-collection-item")
},header:function(q){return q.closest("header")
}},gridSelect:{cls:"mode-selection"},selectAll:{selector:"header > i.select",cls:"selected"}}}});
d.CardView.get(p).setDisplayMode(d.CardView.DISPLAY_LIST);
b(p);
var o=p.data("foundationSelectionsMode");
if(o){d.CardView.get(p).setSelectionModeCount(o)
}},function(m,l){j.UI.Foundation.Layouts.clean(m);
var o=k(m);
var n=o.data("foundationModeGroup");
g("foundation-mode-change",n).css("display","");
f(o);
o.removeData("foundation-layout-list.internal.init")
});
j.UI.Foundation.Adapters.register("foundation-layout",".foundation-layout-list.foundation-collection",function(l){var m=k(l);
return{append:function(n){d.CardView.get(m).append(n);
m.trigger("foundation-contentloaded")
}}
})
})(document,Granite,Granite.$,CUI);
(function(a,b,d,f){function g(j,h,k){if(k){return h.group===k
}else{return true
}}b.UI.Foundation.Layouts.register("foundation-layout-mode",function(k,j){var h=d(k);
d(a).on("foundation-mode-change.foundation-layout-mode",function(m,n,l){if(!g(h,j,l)){return
}h.children(":not(.mode-"+n+")").addClass("hide").removeClass("show");
h.children(".mode-"+n).addClass("show").removeClass("hide")
})
})
})(document,Granite,Granite.$);
(function(f,g){var d=".foundation-layout-wizard";
function a(h,l,k){var j=[l[0]];
if(k){k.removeClass("foundation-wizard-step-active");
j.push(k[0])
}l.addClass("foundation-wizard-step-active");
h.trigger("foundation-wizard-stepchange",j)
}function b(h){h.addClass("flexwizard").children(".foundation-wizard-step").addClass("step content-container").find(".foundation-wizard-control").addClass("flexwizard-control").attr("data-action",function(){return g(this).data("foundationWizardControlAction")
}).end().end().on("flexwizard-stepchange"+d,function(j,l,k){a(h,l,k)
}).flexWizard().children("nav").addClass("content-header").end()
}f.UI.Foundation.Layouts.register("foundation-layout-wizard",function(j,h){var k=g(j);
if(!k.hasClass("foundation-wizard")){return
}b(k)
},function(j,h){f.UI.Foundation.Layouts.clean(j);
g(j).off(d)
});
f.UI.Foundation.Adapters.register("foundation-layout",".foundation-layout-wizard.foundation-wizard",function(h){var j=g(h);
return{toggleNext:function(k){this.toggle("next",k)
},togglePrev:function(k){this.toggle("prev",k)
},toggleCancel:function(k){this.toggle("cancel",k)
},toggle:function(m,k){var l=j.children(".foundation-wizard-step.foundation-wizard-step-active").add(j.children("nav")).find(".foundation-wizard-control[data-foundation-wizard-control-action="+m+"]");
l.each(function(){if(g(this).is("button")){g(this).prop("disabled",!k)
}else{g(this).toggleClass("disabled",!k)
}})
}}
});
g.validator.register({selector:".foundation-layout-wizard.foundation-wizard .foundation-wizard-step input, .foundation-layout-wizard.foundation-wizard .foundation-wizard-step textarea, .foundation-layout-wizard.foundation-wizard .foundation-wizard-step [role=listbox]",show:function(h,j){var k=h.closest(".foundation-wizard").adaptTo("foundation-wizard");
k.toggleNext(false)
},clear:function(h){var k=true;
h.find(":submittable").each(function(){var l=g(this);
if(l.willValidate&&!l.checkValidity()){k=false;
return false
}});
var j=h.closest(".foundation-wizard").adaptTo("foundation-wizard");
j.toggleNext(k)
}})
})(Granite,Granite.$);
(function(a,b){b(a).on("foundation-selections-change",".foundation-wizard-step .foundation-collection[role=listbox]",function(f){var d=b(this);
d.checkValidity();
d.updateErrorUI()
})
})(document,Granite.$);
(function(a,d){function b(f){return d.ajax({type:f.prop("method"),url:f.prop("action"),contentType:f.prop("enctype"),data:f.serialize()})
}d(a).on("click","#user_dialog a[href=#user_preferences]",function(){d("#user_dialog").popover("hide")
});
d(a).on("submit",".foundation-form-reload",function(g){g.preventDefault();
var f=d(this);
b(f).done(function(){d(a).trigger(d.Event("user-preferences-changed",{userPreferences:f.serializeArray()}));
setTimeout(function(){location.reload()
},100)
})
})
})(document,Granite.$);
(function(a,b){b(a).on("foundation-contentloaded.foundation-admin-rail",function(d){b(".rail",d.target).rail()
})
})(document,Granite.$);
(function(d,a,f){var b=".foundation-admin-rail-toggle";
f(a).on("click"+b,".foundation-admin-rail-toggle",function(j){j.preventDefault();
var g=f(this),h=g.data("target"),k=f(h);
k.toggleClass("closed");
f(d).resize();
CUI.util.state.save(h,"class")
})
})(window,document,Granite.$);
(function(a,d,b,f){f(a).fipo("tap.foundation-admin-layouttoggle","click.foundation-admin-layouttoggle",".foundation-admin-layouttoggle button",function(k){var g=f(this),h=g.data("foundationAdminLayouttoggleLayout"),j=g.closest(".foundation-admin-layouttoggle").data("foundationAdminLayouttoggleTarget");
d.UI.Foundation.Layouts.switchLayout(f(j).get(0),h);
b.util.state.save(j,"class")
})
})(document,Granite,CUI,Granite.$);
(function(d,g){function f(h,j){return g(h).filter(function(){return g(g(this).data("foundationAdminSelectionstatusTarget")).filter(j).length
})
}function b(h){return function(j){if(!h){return""
}return h.replace("{{count}}",j.count)
}
}function a(j,l){var k=b(j.data("foundationAdminSelectionstatusTemplate"));
var h=l.adaptTo("foundation-selections");
j.html(k({count:h.count()}))
}g(d).on("foundation-selections-change.foundation-admin-selectionstatus",".foundation-collection",function(){var h=g(this);
f(".foundation-admin-selectionstatus",h).each(function(){var j=g(this);
a(j,h)
})
})
})(document,Granite.$);
(function(a,d){function b(j,h){if(!h.length){return
}var g=j.data("href")+"?"+h.map(function(){return"item="+encodeURIComponent(d(this).data("path"))
}).toArray().join("&");
var f=j.closest(".foundation-content").adaptTo("foundation-content");
return f.go(g)
}d(a).fipo("tap.foundation-admin-properties-activator","click.foundation-admin-properties-activator",".foundation-admin-properties-activator",function(k){var j=d(this);
var g;
var h=j.data("foundationCollectionItem");
if(h){g=d(h)
}else{var f=j.data("foundationCollectionAction");
g=d(f.target).first().find(".foundation-selections-item")
}b(j,g)
})
})(document,Granite.$);
window.$CQ=_g.$;
window.CQ=window.CQ||{};
CQ.shared=_g.shared;
CQ.Sling=CQ.shared.Sling;
CQ.I18n=CQ.shared.I18n;
G_XHR_HOOK=typeof CQ_XHR_HOOK!="undefined"?CQ_XHR_HOOK:undefined;
G_RELOAD_HOOK=typeof CQ_RELOAD_HOOK!="undefined"?CQ_RELOAD_HOOK:undefined;
G_IS_HOOKED=typeof CQ_IS_HOOKED!="undefined"?CQ_IS_HOOKED:undefined;
G_CONTENT_PATH=typeof CQ_CONTENT_PATH!="undefined"?CQ_CONTENT_PATH:undefined;
CQ.shared.Form=function(){var g=function(){var l=new Object();
var m=document.getElementsByTagName("label");
for(var k=0;
k<m.length;
k++){var j=m[k].htmlFor;
if(j){l[j]=m[k]
}}return l
};
var h=function(k){var l="";
var j=function(n){if(n.nodeType==3){l+=n.nodeValue
}if(n.nodeName.toLowerCase()=="select"||n.nodeName.toLowerCase()=="input"||n.nodeName.toLowerCase()=="textarea"||n.nodeName.toLowerCase()=="button"){return
}for(var m=0;
n.childNodes&&m<n.childNodes.length;
m++){j(n.childNodes[m])
}};
j(k);
return l
};
var d=function(j){return j.replace(/-\d+$/,"")
};
var b=function(k,j){if(!j){j=g()
}if(j[k]){return h(j[k])
}return null
};
var a=function(l){var k;
var m=l.nodeName.toLowerCase();
var j=f(l,"type")?l.getAttribute("type"):undefined;
if(m=="input"){if(j=="radio"||j=="checkbox"){if(f(l,"checked")){k=l.getAttribute("value")
}}else{if(l.type=="text"){k=l.defaultValue
}else{k=l.value
}}}else{if(m=="textarea"){k=l.value
}else{if(m=="option"&&f(l,"selected")){k=l.getAttribute("value")
}}}return k
};
var f=function(k,j){if(k==null){return false
}return($CQ(k).attr(j)!=undefined)
};
return{searchArray:function(k,j,m){for(var l=0;
l<k.length;
l++){if(k[l][j]&&k[l][j]==m){return k[l]
}}return null
},getLabelForField:function(j,l){if(!l){l=g()
}var m=j.getAttribute("id");
if(m&&l[m]){return h(l[m])
}var k=j.parentNode;
while(k){if(k.nodeName.toLowerCase()=="label"){return h(k)
}k=k.parentNode
}return j.getAttribute("name")
},getFields:function(){var m=g();
var j=[];
var k=function(q,r){var p=q.getAttribute("name");
var s=q.nodeName.toLowerCase();
var u;
if(s=="input"||s=="textarea"){var o=f(q,"type")?q.getAttribute("type").toLowerCase():"text";
if(o=="button"||o=="submit"||o=="reset"){return
}u=CQ.shared.Form.searchArray(j,"value",p);
if(!u){j.push({text:CQ.shared.Form.getLabelForField(q,m),value:p,name:p,enumeration:undefined,local:r,type:s,defaultValue:a(q),node:q});
u=j[j.length-1]
}if(o=="radio"||(u.local&&o=="checkbox")){if(!u.enumeration){var v=q.getAttribute("id");
if(v){var z=d(v);
var w=b(z,m);
u.text=(w?w:p)
}else{u.text=p
}u.enumeration=[]
}u.enumeration.push({text:CQ.shared.Form.getLabelForField(q,m),value:q.getAttribute("value"),defaultValue:a(q),node:q})
}}else{if(s=="select"){j.push({text:CQ.shared.Form.getLabelForField(q,m),value:p,name:p,enumeration:[],local:r,type:s,defaultValue:undefined,node:q});
u=j[j.length-1];
var n=q.getElementsByTagName("option");
for(var t=0;
t<n.length;
t++){u.enumeration.push({text:n[t].innerHTML,value:n[t].getAttribute("value"),defaultValue:a(n[t]),node:n[t]})
}}}};
var l=function(p,o){if(p.nodeName.toLowerCase()=="div"&&$CQ(p).hasClass("section")){o=true
}if(p.getAttribute&&p.getAttribute("name")){k(p,o)
}for(var n=0;
p.childNodes&&n<p.childNodes.length;
n++){var q=p.childNodes[n];
if(q.nodeType==1){l(q,o)
}}};
l(document,false);
return j
}}
}();
CQ.shared.User=function(infoData){return{data:null,language:null,userPropsPath:null,getUserPropsUrl:function(){if(!this.userPropsPath){this.userPropsPath=CQ.shared.User.PROXY_URI
}return this.userPropsPath
},load:function(){var url=this.getUserPropsUrl();
url=CQ.shared.HTTP.noCaching(url);
var response=CQ.shared.HTTP.get(url);
if(CQ.shared.HTTP.isOk(response)){this.data=CQ.shared.Util.eval(response)
}},init:function(infoData,force){if(!this.initialized||force){if(infoData){this.data=infoData
}else{this.load()
}this.initialized=true
}return this.data
},lazyInit:function(){this.lazyLoad=function(){this.load();
this.initialized=true
}
},isInitialized:function(){return this.initialized
},getLanguage:function(){if(!this.isInitialized()&&this.lazyLoad){this.lazyLoad.call(this)
}this.language=this.data&&this.data.preferences&&this.data.preferences["language"]?this.data.preferences["language"]:"en";
return this.language
}}
}();
CQ.shared.User.PROXY_URI=CQ.shared.HTTP.externalize("/libs/cq/security/userinfo"+CQ.shared.HTTP.EXTENSION_JSON);
CQ.shared.User.lazyInit();
CQ.shared.I18n.init({locale:function(){return CQ.shared.User.getLanguage()
},urlPrefix:"/libs/cq/i18n/dict."});
(function(a,b){b.fn.overlayMask=function(f,g){var d=this.find(".overlay-mask");
if(!d.length&&(!f||f==="show")){d=b('<div class="overlay-mask"></div>');
d.css({position:"absolute",width:"100%",height:"100%",top:"0px",left:"0px",zIndex:10000}).appendTo(this);
d.append(g)
}if(!f||f==="show"){this.fadeTo(0,0.5);
d.show()
}else{if(f==="hide"){this.fadeTo(0,1);
d.hide()
}}return this
}
})(document,Granite.$);
(function(a,b){b(a).ready(function(){var d=b("form.foundation-form .search").closest("form");
d.each(function(){b(this).on("submit.foundation-form",function(g){var f=b(g.target).data("foundation-form-disable");
if(f==true||f=="true"){}else{var h=b('<div style=" position: fixed; top: 50%; left: 50%;" class="spinner large"></div>');
b(".foundation-content").overlayMask("show",h)
}})
})
});
b(a).on("foundation-contentloaded",".foundation-content",function(d){b(".foundation-content").overlayMask("hide")
})
})(document,Granite.$);
(function(a,d){function b(h){var g=h.data("classicui");
if(g){var k=g;
if(g.indexOf("#")==g.length-1){var j=Granite.HTTP.internalize(window.location.pathname);
var f=j.indexOf("/",1);
if(f!=-1){k+=j.substring(f)
}}return Granite.HTTP.externalize(k)
}return null
}d(a).on("click",".classicui-switcher",function(g){var f=b(d(this));
if(f){window.open(f);
g.preventDefault();
g.stopImmediatePropagation();
g.stopPropagation()
}});
d(a).on("touchstart","nav.feature",function(f){d(this).find("i.action").remove()
})
})(document,Granite.$);
(function(a,b){b(a).fipo("tap","click",".refresh-foundation-content-on-back",function(f){var d=b(".foundation-content-control[data-foundation-content-control-action=back]");
if(d.length){d.attr("data-foundation-content-control-refresh",true)
}})
})(document,Granite.$);
(function(a,b){b(a).on("user-preferences-changed",function(){b.cookie("cq-authoring-mode",null,{path:Granite.HTTP.externalize("/")})
})
})(document,Granite.$);
window.tartan=window.tartan||{};
(function(m,B,j){if(!m.console){var f=function(){};
m.console={log:f,trace:f,debug:f,info:f,warn:f,error:f}
}var C=location.protocol+"//"+location.host;
var q={loginBasePath:"/libs/granite/core/content/login",logoutPath:"/libs/cq/core/content/login.logout.html",loginSubDomain:"login"};
function d(E,G){if(E){for(var D=0;
D<E.length;
D++){var F=E[D].prodCtx;
if(G(F)){return F
}}}return null
}function h(E,D,F){return d(E,function(G){return G.owningEntity==D&&G.serviceCode==F
})
}function v(F,D){if(s(F,D)){return true
}var G=A.skipRedirectPatterns;
if(G){for(var E=0;
E<G.length;
E++){if(new RegExp("^"+G[E]+"$").test(D)){return true
}}}return false
}function s(E,D){if(D){return d(E,function(F){return F.serviceCode=="dma_tartan"&&(F.tenant_id||"").toLowerCase()==D.toLowerCase()
})
}return null
}function t(F,G,D){var E=(F||[]).filter(function(H){if(D){return H.prodCtx.owningEntity==D&&H.prodCtx.serviceCode==G
}else{return H.prodCtx.serviceCode==G
}}).sort(function(I,H){return I.prodCtx.tenant_id.localeCompare(H.prodCtx.tenant_id)
});
return E[0]&&E[0].prodCtx||null
}function u(D,E,F,J,G){var I=location.protocol+"//";
if(!D){l(G,E,F,J);
return
}if(A.tenantRedirectEnabled){I+=(D!=null?D:A.loginSubDomain)+"."
}I+=A.hostname+":"+location.port+A.loginBasePath+".html";
var H={ims:A.ims.configid,token:E,resource:J||"/"};
if(!A.tenantRedirectEnabled&&D){H.hintTenantId=D
}g(D);
p(I,H)
}function l(F,D,E,I){var H=location.protocol+"//";
var G=null;
var J=null;
$.ajax({type:"POST",url:"/content/mac/default/tools/profilehelper.json",data:{action:"getUserOrgsPref",imsUserId:F,imsToken:D},success:(function(K){G=K.DEFAULT_TENANT;
J=K.LAST_ACCESSED_TENANT
}),error:(function(K){console.log(K)
}),complete:(function(){var M=null;
var K=null;
if(G){K=G
}else{if(J){K=J
}else{M=t(E,"dma_tartan");
K=M&&M.tenant_id
}}if(A.tenantRedirectEnabled){H+=(K!=null?K:A.loginSubDomain)+"."
}H+=A.hostname+":"+location.port+A.loginBasePath+".html";
var L={ims:A.ims.configid,token:D,resource:I||"/"};
if(!A.tenantRedirectEnabled&&K){L.hintTenantId=K
}g(K);
p(H,L)
}),dataType:"json"})
}function p(E,H){var G=document.createElement("form");
G.action=E;
G.method="POST";
if(H){for(var F in H){var D=document.createElement("input");
D.setAttribute("name",F);
D.setAttribute("value",H[F]);
G.appendChild(D)
}}document.body.appendChild(G);
G.submit()
}function o(D){}function g(D){if(D!=null){k(D,1)
}}function a(){k("",-1)
}function k(G,F){var D=new Date();
D.setDate(D.getDate()+F);
var E="currentTenant="+encodeURIComponent(G)+"; expires="+D.toUTCString()+"; path=/";
if(A.tenantRedirectEnabled){E+="; domain=."+A.hostname
}if(m.location.protocol=="https:"){E+="; secure"
}document.cookie=E
}function r(D){if(m.jQuery){jQuery.ajax(D)
}else{if(D.dataType=="jsonp"){z.jsonp(D)
}else{throw new Error("Only jsonp is supported without jQuery.")
}}}function w(E,F){var D={dataType:"jsonp",timeout:A.timeout,success:function(H,J,I){if(!H||H.error||H.error_flag){return this.error(I,J,null,H)
}else{var G=H.access_token||E.data&&(E.data.bearer_token||E.data.access_token);
H.access_token=G;
if(G&&G!=z.getCookie("token")){}F&&F(null,H)
}},error:function(K,L,J,H){try{H=H||JSON.parse(K.responseText)
}catch(I){console.error("IMS response parse error:",I);
H={}
}console.error("IMS error:",H.error,H.error_description,J);
var G=H.error||H.error_description||J||L||"error";
F&&F(G,H)
}};
r(z.extend(D,E))
}var z=B.utils=B.utils||{};
z.getQueryParam=function(F,E){var D=new RegExp("[?&]"+E+"=(.*?)($|&|#)").exec(F);
return D&&decodeURIComponent(D[1])||null
};
z.getCookie=function(E){var D=new RegExp("(^|; )"+E+"=([^;]*)").exec(document.cookie);
return D&&D[2]
};
z.extend=function(G){for(var F=1;
F<arguments.length;
F++){var D=arguments[F];
if(D){for(var E in D){G[E]=D[E]
}}}return G
};
z.jsonp=function(L){var K={};
var J="jsonp_"+new Date().getTime();
m[J]=function(M){E();
L.success&&L.success(M,"success",K);
L.complete&&L.complete(K,"success")
};
var D=L.url;
if(L.data){for(var I in L.data){D+=(D.indexOf("?")==-1)?"?":"&";
D+=encodeURIComponent(I)+"="+encodeURIComponent(L.data[I])
}}if(D.indexOf("=?")==-1){D+=(D.indexOf("?")==-1)?"?":"&";
D+=(L.jsonp||"callback")+"=?"
}D=D.replace("=?","="+J);
var G=document.createElement("script");
G.async=true;
G.src=D;
G.onerror=function(){F("error","error")
};
document.head.appendChild(G);
var H;
if(L.timeout){H=m.setTimeout(function(){F("timeout","timeout")
},L.timeout)
}function F(M,N){E();
L.error&&L.error(K,M,N);
L.complete&&L.complete(K,M)
}function E(){m.clearTimeout(H);
try{delete m[J]
}catch(M){}G.parentNode&&G.parentNode.removeChild(G)
}};
function b(F,D,E){r({url:A.loginBasePath+".html/j_security_check",type:"POST",global:false,dataType:"text",data:{_charset_:"utf-8",j_username:F,j_password:D,j_validate:true},success:function(){E()
},error:function(I,G,H){console.warn("CRX login failed:",G,H);
E(H)
}})
}var A=z.extend({},q,m.tartanAuthConfig);
var n=B.auth={config:A,loadConfig:function(D){if(A&&Object.keys(A).length>0){D&&D()
}else{r({url:C+A.loginBasePath+".config.js?callback=?",success:function(E){n.config=A=z.extend({},q,E);
D&&D()
},error:function(G,E,F){D&&D(F||E)
}})
}},getSessionData:function(E,D){w({url:E.session,data:{client_id:A.ims.client_id,bearer_token:E.access_token}},function(F,G){if(F){D(F)
}else{D(null,G&&G.session_data||{})
}})
},getSessionActiveOrg:function(E,D){n.getSessionData(E,function(H,G){if(H){D(H)
}else{var F=G.current_active_org;
var I=F&&(F.org_id+"@"+F.org_auth_src);
D(null,I)
}})
},redirect:function(I,H,J){if(I){var F=I.projectedProductContext,E=I.access_token,D=z.getQueryParam(location.search,"hintTenantId");
if(v(F,D)){u(D,E,F,H,I.userId)
}else{var G=location.hostname;
D=G.substring(0,G.indexOf("."+A.hostname));
if(v(F,D)){u(D,E,F,H,I.userId)
}else{if(I.session){n.getSessionActiveOrg(I,function(K,M){if(!K&&M){var L=h(F,M,"dma_tartan");
if(L&&L.tenant_id){u(L.tenant_id,E,F,H,I.userId);
return
}}u(null,E,F,H,I.userId)
})
}else{u(null,E,F,H,I.userId)
}}}}else{location.href="/content/mac.html"
}},loginAuto:function(D){w({url:A.ims.endpoint+"/check/v1/token",data:{client_id:A.ims.client_id,scope:A.ims.scope}},D)
},loginToken:function(D,E){w({url:A.ims.endpoint+"/profile/v1",data:{client_id:A.ims.client_id,bearer_token:D}},E)
},loginCredentials:function(F,D,E){if(A.crxLoginEnabled){b(F,D,function(G){if(G){E(G)
}else{E()
}})
}},loginEnsure:function(D,H,G){var F=z.getCookie("token");
if(!F||D){n.loginAuto(E)
}else{E()
}function E(I){if(I||!H){G&&G(I)
}else{r({dataType:"jsonp",url:C+"/content/mac/default/header.jsonp",success:function(){G()
},error:function(L,J,K){G(K)
}})
}}},keepAlive:function(D){n.loginAuto(function(E,F){if(E){top.location.href=A.logoutPath
}else{n.getSessionData(F,D)
}})
},setTokenCookie:o,setCurrentTenantCookie:g,removeCurrentTenantCookie:a}
})(window,tartan);
tartan=window.tartan||{};
tartan.api=(function(){return{shareCard:function(d){if(!d||(!d.url&&!d.cardDataPath)){if(window.console){window.console.error("tartan.shareCard() needs 'options.url'")
}return false
}var q=function(){document.body.removeChild(u);
document.body.removeChild(w);
window[E](A,k,false);
if((typeof d.onclose)=="function"){d.onclose()
}};
var k=function(H){var G=JSON.parse(H.data);
if(G.action=="login"){s&&s(H,G);
return
}if(G.show){u.style.visibility="visible"
}if(G.loaded){u.contentWindow.postMessage(JSON.stringify(d),"*")
}if(G.share){if(window.console){window.console.log("card shared")
}}if(G.close){q()
}};
var w=document.createElement("div");
w.id="share_frame_shadow_box";
var z=/^(https?:\/\/[^\/?#]+)(.*\/mac\/mac-api.js)(\?.*)?$/i;
var l=/^(?:http|https):\/\/[^\/]+(\/[^\/]+)\/(?:etc|libs|apps)\/.*\.js(\?.*)?$/;
var a="";
var b=document.getElementsByTagName("script");
var r="";
for(var B=0;
B<b.length;
B++){var j=b[B].getAttribute("src");
if(j){var n=j.match(z);
if(n){var p=l.exec(j);
if(p){a=p[1]
}r=n[1]+a;
break
}}}var u=document.createElement("iframe");
var D=document.createElement("style");
D.type="text/css";
D.innerHTML="#share_frame_shadow_box {position:fixed;left:0;top:0;z-index:999;width:100%;height:100%;opacity:0.7;background-color:#000000}#share_frame {outline:12px solid rgba(0,0,0,0.7);overflow:hidden;position:fixed;left:50%;top:50%;background-color:white;z-index:1001;width:860px;height:440px;margin-left:-430px;margin-top:-220px;visibility:hidden;}@media all and (max-width: 875px) {#share_frame {width:660px;margin-left:-330px;}}";
u.id="share_frame";
u.src="about:blank";
u.frameBorder=0;
u.scrolling="no";
u.hspace=0;
u.vspace=0;
u.marginheight=0;
u.marginwidth=0;
var C=window.addEventListener?"addEventListener":"attachEvent";
var E=window.removeEventListener?"removeEventListener":"removeEvent";
var A=C=="attachEvent"?"onmessage":"message";
window[C](A,k,false);
document.head.appendChild(D);
document.body.appendChild(w);
document.body.appendChild(u);
var f=function(G){u.src=G+"/content/mac/default/tools/shareframe.html"
};
var h=function(){alert("Sharing is not possible at this time. Please try again later.");
q()
};
if(!r||r.charAt(0)=="/"){f(r);
return true
}var o=d.imsOrgId;
if(o){var g="tartanServer-"+o;
var v=window.sessionStorage&&sessionStorage.getItem(g);
if(v){m(v,false)
}else{F({url:r+"/content/mac/default/services/tenant.jsonp?callback=?&orgId="+o,timeout:5000,success:function(H){var G=H.tenantUrl;
if(G){window.sessionStorage&&sessionStorage.setItem(g,G);
m(G,false)
}else{window.console&&console.error("Error while resolving tenant for organization: "+o,H);
h()
}},error:h})
}}else{var v=window.sessionStorage&&sessionStorage.getItem("lastTartanServer");
if(!v){window.console&&console.log("lastTartanServer is not set.");
v=r
}m(v,true)
}function m(H,G){t({server:H,success:function(J,K){if(J.redirect){if(G){var K=J.redirect;
var I=K.indexOf("/",8);
if(I!=-1){K=K.substr(0,I)
}m(K,true)
}else{window.console&&console.error("User cannot login on server: ",H);
h()
}}else{window.sessionStorage&&sessionStorage.setItem("lastTartanServer",H);
f(K)
}},error:h})
}var s;
function t(H){var G=H.server+"/libs/granite/core/content/login.autologin.html";
var I=document.createElement("iframe");
I.style.display="none";
I.src=G;
document.body.appendChild(I);
s=function(K,J){if(G.indexOf(K.origin+"/")===0){s=null;
I.parentNode.removeChild(I);
if(J.success){H.success&&H.success(J,H.server)
}else{H.error&&H.error(null,J.error)
}H.complete&&H.complete()
}}
}function F(I){var L="jsonp_"+new Date().getTime();
window[L]=function(M){I.success&&I.success(M);
J()
};
var H=I.url.replace("=?","="+L);
var G=document.createElement("script");
G.async=true;
G.src=H;
G.onerror=function(){J();
I.error&&I.error(null,"error");
I.complete&&I.complete()
};
document.head.appendChild(G);
var K;
if(I.timeout){K=window.setTimeout(function(){J();
I.error&&I.error(null,"timeout");
I.complete&&I.complete()
},I.timeout)
}function J(){window.clearTimeout(K);
delete window[L];
G.parentNode&&G.parentNode.removeChild(G)
}}return true
},shareOembedResource:function(){var f=this;
var b=location.protocol==="https:";
var d=document.querySelector("link[rel^='alternat'][type='application/json+oembed']");
if(d==undefined){alert("Web page does not support oEmbed");
return
}var a=d.href;
var g=this.createCORSRequest("GET",a,true,function(n){var l=false;
try{l=("response" in n&&n.responseType=="json")
}catch(h){}var m=l?n.response:JSON.parse(n.responseText);
if(m==null){alert("Server response not in JSON format.");
return
}var o=(b&&m.thumbnail_url)?m.thumbnail_url.replace(/http:/gi,"https:"):m.thumbnail_url;
var k=m.type;
var j=(b&&m.html)?m.html.replace(/http:/gi,"https:"):m.html;
f.shareCard({url:window.location.href,title:m.title,product:m.provider_name,type:"oembed",data:{thumbnailUrl:o,type:k,html:j},auth:{type:"bearer",token:"sally_token"}})
},function(h){alert("Error loading oEmbed document at "+a)
});
g?g.send():alert("Browser does not support CORS Requests")
},createCORSRequest:function(h,a,b,g,d){var f=new XMLHttpRequest();
if("withCredentials" in f){f.open(h,a,b);
f.onreadystatechange=function(){if(f.readyState==4){if(f.status==200){if(g){g(f)
}}else{if(d){d(f)
}}}}
}else{if(typeof XDomainRequest!="undefined"){f=new XDomainRequest();
f.open(h,a,b);
f.onerror=d;
f.ontimeout=d;
f.onload=g
}else{f=null
}}return f
},ssoKeepalive:function(b,h,j,g){if(typeof b=="undefined"||typeof h=="undefined"){throw new Error("Client and/or host for SSO keepalive not supplied.")
}var f="ssoKeepalive_"+new Date().getTime();
window[f]=function(k){};
j=typeof j!=="undefined"?j:f;
g=typeof g!=="undefined"?g:"AdobeID,openid";
var a=document.getElementsByTagName("body")[0];
var d=document.createElement("script");
d.type="text/javascript";
d.src="https://"+h+"/ims/check/v1/token?callback="+j+"&client_id="+b+"&scope="+g+"&_="+new Date().getTime();
a.appendChild(d)
}}
}());
tartan.shareCard=tartan.api.shareCard;
tartan.createCORSRequest=tartan.api.createCORSRequest;
tartan.ssoKeepalive=tartan.api.ssoKeepalive;
jQuery(function(f){var z=f(".popovers"),n={timeout:15000,errorLoading:"Error while loading data.",isTenantRedirect:true,server:"/"},w=f.extend({},n,z.data()),p;
var m=f("header.top");
if(w.server){var u=window.sessionStorage&&sessionStorage.getItem("lastTartanServer");
h(u||w.server)
}function h(E){if(E=="/"){E=location.protocol+"//"+location.host
}else{if(E){var D=E.indexOf("/",8);
if(D!=-1){E=E.substr(0,D)
}}}w.server=E;
p=w.server+"/content/mac/default/header";
window.sessionStorage&&sessionStorage.setItem("lastTartanServer",E)
}if(w.localData){t(w.localData)
}else{if(w.server){var B=window.sessionStorage&&sessionStorage.getItem("lastHeaderData");
if(B){try{t(JSON.parse(B))
}catch(r){window.console&&console.error("Header data parse error: ",r)
}}q()
}}function q(D){C({url:p+".jsonp?callback=?",timeout:w.timeout,data:A("header"),success:function(E){t(E,true)
},error:function(E,H){if(!D){if(w.devLogin){var G=w.devLogin.split(":");
d(G[0],G[1],function(){q(true)
})
}else{function F(){o({success:function(I){if(I.redirect){h(I.redirect);
F()
}else{q(true)
}}})
}F()
}}else{window.console&&console.error("Header request error: "+H)
}}})
}function t(H,F){if(H){f(".home-link").attr("href",H.homeLink);
var E=f(".feedback-button");
if(H.feedback&&H.feedback.enabled){E.text(H.feedback.buttonText).show()
}else{E.hide()
}var D=f(".notifications-link"),G=D.data("href");
if(H.notificationLink&&H.notificationCount==0){G=H.notificationLink;
D.addClass("notifications-activator")
}D.text(H.notificationCount).toggleClass("is-empty",H.notificationCount==0);
D.attr("href",G);
if(F&&window.sessionStorage&&window.JSON){sessionStorage.setItem("lastHeaderData",JSON.stringify(H))
}}}function o(E){var H=w.server;
if(E.tenantId&&w.isTenantRedirect==true){H=H.replace(/(:\/\/)([^.]+)(.marketing)/i,"$1"+E.tenantId+"$3")
}var D=H+"/libs/granite/core/content/login.autologin.html";
if(E.tenantId){D+="?hintTenantId="+E.tenantId
}var G=f("<iframe>",{src:D}).hide().appendTo("body");
f(window).on("message",function F(J){var J=J.originalEvent;
if(J.source==G[0].contentWindow&&D.indexOf(J.origin+"/")===0){G.remove();
var I=JSON.parse(J.data);
if(I.success){E.success&&E.success(I,H)
}else{E.error&&E.error(null,I.error)
}E.complete&&E.complete();
f(window).off("message",F)
}})
}function d(D,E,F){k({type:"post",url:w.server+"/libs/granite/core/content/login.html/j_security_check",data:{_charset_:"UTF-8",j_username:D,j_password:E,j_validate:true},success:F})
}z.fipo("tap","click",".notifications-activator",j);
m.fipo("tap","click",".notifications-activator",j);
function j(D){if(window.Granite){this.href+="?ref="+Granite.HTTP.internalize(window.location.pathname)
}}z.find(".help-link, .notifications-link, .user-link").fipo("tap","click",s);
m.find(".help-link, .notifications-link, .user-link").fipo("tap","click",s);
function s(){var E=f(this),D=E.attr("href"),I=f(D);
if(I.length==0||I.data("stale")){var F=D.substring(1,D.lastIndexOf("_")),G=Handlebars.templates[F+"_popover.hbs"];
var H=E.data("localData");
if(H){I=l(G,H,F,E)
}else{if(w.server){var K=f();
var J=window.setTimeout(function(){K=f(G({loading:true}));
g(K,E)
},300);
C({url:p+"/"+F+".jsonp?callback=?",data:A(F),timeout:w.timeout,success:function(L){window.clearTimeout(J);
I.add(K).remove();
I=l(G,L,F,E)
},error:function(M,N){window.console&&console.error("Header request error: "+N);
window.clearTimeout(J);
var L=K.length==0||K.is(":visible");
I.add(K).remove();
if(L){I=f(G({loading:true,error:w.errorLoading}));
I.data("stale",true);
g(I,E,true)
}}})
}}}else{g(I,E)
}return false
}function l(G,I,E,D){var H;
if(I){H=f(G(I)).data("popoverData",I);
var F=a[E];
if(F){F(H)
}if(E=="notifications"){if(I.viewAll&&(I.viewAll.viewCount||0==I.viewAll.viewCount)){D.text(I.viewAll.viewCount)
}}g(H,D,true)
}H.on("click","a",function(){H.popover("hide")
});
f("a[href='#help_popover']").trigger("popoverInitialized");
return H
}function g(F,E,D){f(".popover").filter(":visible").not(F).popover("hide");
if(f(".endor-BlackBar").length==0){F.insertAfter(E)
}else{F.insertAfter(f(".endor-BlackBar"))
}F.css({maxHeight:0}).popover(f.extend({pointAt:E,pointFrom:"bottom"},F.data(),E.data())).popover(D?"show":"toggleVisibility").css({maxHeight:"none"});
setTimeout(function(){F.find("input:visible:first").focus()
},0)
}function A(D){var E=w.lang||"";
if(D=="help"){return{lang:E,product:w.searchProduct}
}else{return{lang:E}
}}var v=window.tartan||{};
v.headerUtils=v.headerUtils||{};
v.headerUtils.openHelpMenu=function(){f("a[href='#help_popover']").on("popoverInitialized",function(){f("body").trigger("coachmarks.functionFinish",["tartan.headerUtils.openHelpMenu"])
});
f("a[href='#help_popover']").click()
};
var a={help:function(I){var L=I.find(".search input"),F=I.find(".search + .close"),J=I.find("form").data("previewUrl"),N=I.find(".search-results"),D=I.find(".link-list").not(N).has("li"),M,K;
L.on("keyup",function(){var O=f.trim(f(this).val());
if(O.length>=3){if(O==K){return
}K=O;
window.clearTimeout(M);
M=window.setTimeout(function(){M=null;
f.ajax({url:J.replace("{query}",encodeURIComponent(O)),success:H,error:function(P,R,Q){window.console&&console.error("Header help search error: "+R,Q)
}})
},300)
}else{if(D.is(":hidden")){N.slideUp("fast");
f("#help_popover .link-list").not(N).has("li").slideDown("fast");
window.clearTimeout(M)
}}F.toggle(O.length>0)
});
F.fipo("tap","click",function(){L.val("").keyup().focus()
});
function H(P){P.popover=I.data("popoverData");
P.results=P.results.slice(0,5);
var O=Handlebars.templates["help_popover_search_results.hbs"];
var Q=f(O(P)).css("display",N.css("display"));
N=Q.replaceAll(N);
L.focus();
N.on("mouseenter focus","li",function(){var S=f(".tooltip",this);
if(S.length>0){var R=f("a",this);
S.css({top:R.position().top-S.height()/2}).show()
}}).on("mouseleave blur","li",function(){f(".tooltip",this).hide()
});
if(D.is(":visible")){D.slideUp("fast");
N.slideDown("fast")
}}I.on("keydown","input, a",function(Q){if(Q.which==38||Q.which==40){Q.preventDefault();
var P=I.find("input, .link-list a").filter(":visible");
var O=P.index(document.activeElement);
O+=(Q.which==40)?+1:-1;
O=O%P.length;
P.eq(O).focus()
}});
I.on("mouseenter",".link-list a",function(){f(document.activeElement).filter("#help_popover a").blur()
});
var E=I.find("input[type='checkbox'].coachmarksinput");
if(_satellite){var G=_satellite.getVar("coachmarks_visible");
if(G==="on"){E.attr("checked","checked")
}else{E.removeAttr("checked")
}}E.on("change",function(O){if(f(this).prop("checked")==true){if(_satellite){_satellite.setCookie("coachmarks_visible","on")
}}else{if(_satellite){_satellite.setCookie("coachmarks_visible","off")
}}})
},notifications:function(D){D.find(".footer a").addClass("notifications-activator")
},user:function(D){D.find("a.manageLink").fipo("tap","click",function(F){F.preventDefault();
var E=f(".organizations li.active").children("a").data("tenantId");
if(E!=null){document.location="/content/mac/"+f(".organizations li.active").children("a").data("tenantId")+".html/orgs"
}else{document.location="/content/mac/"+f(".singleOrg").data("tenantId")+".html/orgs"
}});
D.find(".organizations a").fipo("tap","click",function(J){J.preventDefault();
J.stopImmediatePropagation();
f(".organizations li.active").find("i.icon-check").remove();
f(".organizations li.active").find("label").removeClass("active");
var H=f(this),G=H.data("orgId"),F=H.data("tenantId");
f(".loading-overlay",D).fadeIn();
C({url:p+".setActiveOrg.jsonp?callback=?",data:{orgId:G},timeout:w.timeout,complete:function(){f(".organizations li.active",D).add(H.closest("li")).toggleClass("active");
if(!(H.has("i.icon-check").length)){H.children("label").prepend('<i class="icon-check blue"></i>');
H.children("label").addClass("active")
}o({tenantId:F.toLowerCase(),success:function(K,L){if(v&&v.auth){v.auth.setCurrentTenantCookie(F)
}E(F,function(){location.href=K.redirect||L
})
},complete:I})
}});
function I(){f(".loading-overlay",D).hide()
}function E(K,L){f.ajax({type:"POST",url:"/content/mac/default/tools/profilehelper.json",data:{action:"setLastLoggedInTenant",lastLoggedInTenant:K},success:(function(M){console.log("set last logged in tenant successful ")
}),error:(function(M){console.log(M)
}),complete:function(){if(L&&typeof L=="function"){L()
}},dataType:"json"})
}});
D.find(".actionLinks a.primary").click(function(E){E.preventDefault();
if(v&&v.auth){v.auth.removeCurrentTenantCookie()
}document.location.href=f(this).data("href")
})
}};
z.find(".feedback-button").fipo("tap","click",b);
m.find(".feedback-button").fipo("tap","click",b);
z.find(".feedback-button-shell2").fipo("tap","click",b);
m.find(".feedback-button-shell2").fipo("tap","click",b);
function b(){var F=f(this);
var E=f.extend(F.data(),{lang:w.lang,url:location.href});
var H=w.server+"/content/mac/default/tools/feedback.html?"+f.param(E,true);
var G=f("<iframe>",{id:"feedback_iframe",src:H,allowtransparency:true}).addClass("hidden").appendTo("body");
f(window).on("message",function D(J){var J=J.originalEvent;
if(J.source==G[0].contentWindow){var I=JSON.parse(J.data);
switch(I.type){case"loaded":G.removeClass("hidden");
G[0].contentWindow.postMessage(JSON.stringify({type:"showFeedbackModal"}),"*");
break;
case"closed":G.remove();
f(window).off("message",D);
break
}}})
}function C(L){var K={};
var J="jsonp_"+new Date().getTime();
window[J]=function(M){E();
L.success&&L.success(M,"success",K);
L.complete&&L.complete(K,"success")
};
var D=L.url;
if(L.data){for(var I in L.data){D+=(D.indexOf("?")==-1)?"?":"&";
D+=encodeURIComponent(I)+"="+encodeURIComponent(L.data[I])
}}if(D.indexOf("=?")==-1){D+=(D.indexOf("?")==-1)?"?":"&";
D+=(L.jsonp||"callback")+"=?"
}D=D.replace("=?","="+J);
var G=document.createElement("script");
G.async=true;
G.src=D;
G.onerror=function(){F("error","error")
};
document.head.appendChild(G);
var H;
if(L.timeout){H=window.setTimeout(function(){F("timeout","timeout")
},L.timeout)
}function F(M,N){E();
L.error&&L.error(K,M,N);
L.complete&&L.complete(K,M)
}function E(){window.clearTimeout(H);
try{delete window[J]
}catch(M){}G.parentNode&&G.parentNode.removeChild(G)
}}function k(E){var H="iframe_"+f.now();
var G=f("<iframe>",{name:H,src:"about:blank"});
var D=f("<form>",{action:E.url,method:E.type||"post",target:H});
if(E.data){for(var F in E.data){D.append(f("<input>",{name:F,value:E.data[F]}))
}}G.on("load",function(){E.success&&E.success();
E.complete&&E.complete();
G.add(D).remove()
});
f("body").append(G.hide(),D.hide());
D.submit()
}f(this).on("foundation-history-change.mac-unifiedheader",".cq-inbox-notification-action",function(){q()
})
});
(function(){var b=Handlebars.template,a=Handlebars.templates=Handlebars.templates||{};
a["help_popover.hbs"]=b(function(k,q,j,p,o){this.compilerInfo=[4,">= 1.0.0"];
j=this.merge(j,k.helpers);
o=o||{};
var m="",d,l="function",n=this.escapeExpression,u=this;
function h(B,A){var w="",z;
w+='\n    <div class="inner-border">\n        ';
z=j["if"].call(B,B.error,{hash:{},inverse:u.program(4,v,A),fn:u.program(2,g,A),data:A});
if(z||z===0){w+=z
}w+="\n    </div>\n    ";
return w
}function g(B,A){var w="",z;
w+='\n        <div class="alert error"><div>';
if(z=j.error){z=z.call(B,{hash:{},data:A})
}else{z=B.error;
z=typeof z===l?z.apply(B):z
}w+=n(z)+"</div></div>\n        ";
return w
}function v(z,w){return'\n        <div class="spinner large"></div>\n        '
}function t(B,A){var w="",z;
w+="\n        ";
z=j["with"].call(B,B.search,{hash:{},inverse:u.noop,fn:u.program(7,s,A),data:A});
if(z||z===0){w+=z
}w+='\n        <ul class="link-list search-results"></ul>\n        <ul class="link-list">\n            ';
z=j.each.call(B,B.links,{hash:{},inverse:u.noop,fn:u.program(9,r,A),data:A});
if(z||z===0){w+=z
}w+="\n             ";
z=j["if"].call(B,B.toggleCoachMarks,{hash:{},inverse:u.noop,fn:u.program(11,f,A),data:A});
if(z||z===0){w+=z
}w+="\n        </ul>\n    ";
return w
}function s(B,A){var w="",z;
w+='\n            <form method="get" action="';
if(z=j.url){z=z.call(B,{hash:{},data:A})
}else{z=B.url;
z=typeof z===l?z.apply(B):z
}w+=n(z)+'" target="_blank" data-preview-url="';
if(z=j.previewUrl){z=z.call(B,{hash:{},data:A})
}else{z=B.previewUrl;
z=typeof z===l?z.apply(B):z
}w+=n(z)+'">\n                <input type="hidden" name="_charset_" value="utf-8"/>\n                <div class="search">\n                    <input name="';
if(z=j.queryParameter){z=z.call(B,{hash:{},data:A})
}else{z=B.queryParameter;
z=typeof z===l?z.apply(B):z
}w+=n(z)+'" type="text" autocomplete="off" placeholder="';
if(z=j.placeholder){z=z.call(B,{hash:{},data:A})
}else{z=B.placeholder;
z=typeof z===l?z.apply(B):z
}w+=n(z)+'">\n                    <button type="submit"></button>\n                    <button type="reset"></button>\n                </div>\n            </form>\n        ';
return w
}function r(B,A){var w="",z;
w+='\n                <li>\n                    <a href="'+n(((z=B.url),typeof z===l?z.apply(B):z))+'" target="_blank" title="'+n(((z=B.text),typeof z===l?z.apply(B):z))+'">'+n(((z=B.text),typeof z===l?z.apply(B):z))+"</a>\n                </li>\n            ";
return w
}function f(z,w){return'\n                <li data-dtm-coachmarkKey="turnoffCoachmarks">\n                    <label class="coachmarkslabel" style="line-height: 1rem;">\n                        <input type="checkbox" name="c1" value="1" checked="" class="coachmarksinput" style="float: left;width: 0rem;">\n                        <span class="coachmarksspan" style="padding-left: 1.4rem;">Coach Marks</span>\n                    </label>\n                </li>\n            '
}m+='<div id="help_popover" class="popover">\n    ';
d=j["if"].call(q,q.loading,{hash:{},inverse:u.program(6,t,o),fn:u.program(1,h,o),data:o});
if(d||d===0){m+=d
}m+="\n</div>";
return m
});
a["help_popover_search_results.hbs"]=b(function(j,p,h,o,n){this.compilerInfo=[4,">= 1.0.0"];
h=this.merge(h,j.helpers);
n=n||{};
var l="",f,r,k="function",m=this.escapeExpression,q=this;
function g(v,u){var s="",t;
s+="\n    <li>\n        <span>"+m(((t=((t=((t=v.popover),t==null||t===false?t:t.search)),t==null||t===false?t:t.noResults)),typeof t===k?t.apply(v):t))+"</span>\n    </li>\n    ";
return s
}function d(v,u){var s="",t;
s+='\n    <li>\n        <div class="tooltip info arrow-right"><h4>'+m(((t=v.title),typeof t===k?t.apply(v):t))+"</h4><p>"+m(((t=v.description),typeof t===k?t.apply(v):t))+'</p></div>\n        <a href="'+m(((t=v.href),typeof t===k?t.apply(v):t))+'" target="_blank">'+m(((t=v.title),typeof t===k?t.apply(v):t))+"</a>\n    </li>\n    ";
return s
}l+='<ul class="link-list search-results">\n    ';
r=h.unless.call(p,((f=p.results),f==null||f===false?f:f.length),{hash:{},inverse:q.noop,fn:q.program(1,g,n),data:n});
if(r||r===0){l+=r
}l+="\n    ";
r=h.each.call(p,p.results,{hash:{},inverse:q.noop,fn:q.program(3,d,n),data:n});
if(r||r===0){l+=r
}l+="\n</ul>";
return l
});
a["notifications_popover.hbs"]=b(function(j,p,h,o,n){this.compilerInfo=[4,">= 1.0.0"];
h=this.merge(h,j.helpers);
n=n||{};
var l="",d,k="function",m=this.escapeExpression,s=this;
function g(z,w){var u="",v;
u+="\n            ";
v=h["if"].call(z,z.error,{hash:{},inverse:s.program(4,t,w),fn:s.program(2,f,w),data:w});
if(v||v===0){u+=v
}u+="\n        ";
return u
}function f(z,w){var u="",v;
u+='\n            <div class="alert error"><div>';
if(v=h.error){v=v.call(z,{hash:{},data:w})
}else{v=z.error;
v=typeof v===k?v.apply(z):v
}u+=m(v)+"</div></div>\n            ";
return u
}function t(v,u){return'\n            <div class="spinner large"></div>\n            '
}function r(z,w){var u="",v;
u+='\n        <div class="header">\n            <h3>';
if(v=h.title){v=v.call(z,{hash:{},data:w})
}else{v=z.title;
v=typeof v===k?v.apply(z):v
}u+=m(v)+'</h3>\n        </div>\n        <ul class="body">\n            ';
v=h.each.call(z,z.newNotifications,{hash:{},inverse:s.noop,fn:s.program(7,q,w),data:w});
if(v||v===0){u+=v
}u+='\n        </ul>\n        <div class="footer">\n            <a href="'+m(((v=((v=z.viewAll),v==null||v===false?v:v.url)),typeof v===k?v.apply(z):v))+'" class="notifications-activator">'+m(((v=((v=z.viewAll),v==null||v===false?v:v.text)),typeof v===k?v.apply(z):v))+"</a>\n        </div>\n        ";
return u
}function q(A,z){var u="",w,v;
u+="\n            <li>";
v=((w=A.html),typeof w===k?w.apply(A):w);
if(v||v===0){u+=v
}u+="</li>\n            ";
return u
}l+='<div id="notifications_popover" class="popover">\n    <div class="inner-border">\n        ';
d=h["if"].call(p,p.loading,{hash:{},inverse:s.program(6,r,n),fn:s.program(1,g,n),data:n});
if(d||d===0){l+=d
}l+="\n    </div>\n</div>";
return l
});
a["user_popover.hbs"]=b(function(n,E,C,s,K){this.compilerInfo=[4,">= 1.0.0"];
C=this.merge(C,n.helpers);
K=K||{};
var D="",o,f="function",d=this.escapeExpression,w=this;
function v(O,N){var L="",M;
L+="\n            ";
M=C["if"].call(O,O.error,{hash:{},inverse:w.program(4,t,N),fn:w.program(2,u,N),data:N});
if(M||M===0){L+=M
}L+="\n        ";
return L
}function u(O,N){var L="",M;
L+='\n            <div class="alert error"><div>';
if(M=C.error){M=M.call(O,{hash:{},data:N})
}else{M=O.error;
M=typeof M===f?M.apply(O):M
}L+=d(M)+"</div></div>\n            ";
return L
}function t(M,L){return'\n            <div class="spinner large"></div>\n            '
}function r(O,N){var L="",M;
L+='\n        <div class="header">\n            <div class="userInfo">\n            ';
M=C["with"].call(O,O.info,{hash:{},inverse:w.noop,fn:w.program(7,q,N),data:N});
if(M||M===0){L+=M
}L+="\n            ";
M=C["if"].call(O,O.singleOrganization,{hash:{},inverse:w.noop,fn:w.program(9,m,N),data:N});
if(M||M===0){L+=M
}L+="\n            </div>\n            ";
M=C["if"].call(O,O.settingsURL,{hash:{},inverse:w.noop,fn:w.program(11,J,N),data:N});
if(M||M===0){L+=M
}L+='\n        </div>\n        <ul class="organizations ';
M=C["if"].call(O,O.singleOrganization,{hash:{},inverse:w.noop,fn:w.program(13,I,N),data:N});
if(M||M===0){L+=M
}L+='">\n            ';
M=C.each.call(O,O.organizations,{hash:{},inverse:w.noop,fn:w.program(15,H,N),data:N});
if(M||M===0){L+=M
}L+="\n            ";
M=C["if"].call(O,O.deniedOrganizations,{hash:{},inverse:w.noop,fn:w.program(24,k,N),data:N});
if(M||M===0){L+=M
}L+='\n        </ul>\n        <div class="footer">\n            ';
M=C["if"].call(O,O.manageOrganizationsLabel,{hash:{},inverse:w.noop,fn:w.program(27,h,N),data:N});
if(M||M===0){L+=M
}L+='\n            <div class="actionLinks">\n                ';
M=C.each.call(O,O.actions,{hash:{},inverse:w.noop,fn:w.program(30,B,N),data:N});
if(M||M===0){L+=M
}L+="\n            </div>\n        </div>\n        ";
return L
}function q(O,N){var L="",M;
L+='\n            <img src="';
if(M=C.avatar){M=M.call(O,{hash:{},data:N})
}else{M=O.avatar;
M=typeof M===f?M.apply(O):M
}L+=d(M)+'" class="avatar">\n            <h3>';
if(M=C.displayName){M=M.call(O,{hash:{},data:N})
}else{M=O.displayName;
M=typeof M===f?M.apply(O):M
}L+=d(M)+"</h3>\n            <span>";
if(M=C.title){M=M.call(O,{hash:{},data:N})
}else{M=O.title;
M=typeof M===f?M.apply(O):M
}L+=d(M)+"</span>\n            ";
return L
}function m(O,N){var L="",M;
L+='\n                <span class="singleOrg" data-tenant-id="';
if(M=C.singleOrganizationTenant){M=M.call(O,{hash:{},data:N})
}else{M=O.singleOrganizationTenant;
M=typeof M===f?M.apply(O):M
}L+=d(M)+'"><a href="#" class="manageLink">';
if(M=C.singleOrganization){M=M.call(O,{hash:{},data:N})
}else{M=O.singleOrganization;
M=typeof M===f?M.apply(O):M
}L+=d(M)+"</a></span>\n            ";
return L
}function J(O,N){var L="",M;
L+='\n                <a href="';
if(M=C.settingsURL){M=M.call(O,{hash:{},data:N})
}else{M=O.settingsURL;
M=typeof M===f?M.apply(O):M
}L+=d(M)+'" class="icon-gear medium black"><span>Gear</span></a>\n            ';
return L
}function I(M,L){return"hidden"
}function H(P,O){var L="",N,M;
L+='\n            <li class="';
N=C["if"].call(P,P.active,{hash:{},inverse:w.noop,fn:w.program(16,G,O),data:O});
if(N||N===0){L+=N
}L+='">\n                <a href="#" data-tenant-id="'+d(((N=P.tenantId),typeof N===f?N.apply(P):N))+'" data-org-id="'+d(((N=P.orgId),typeof N===f?N.apply(P):N))+'" title="'+d(((N=P.name),typeof N===f?N.apply(P):N))+'" tabindex="-1">\n                <label ';
M=C["if"].call(P,P.active,{hash:{},inverse:w.noop,fn:w.program(18,F,O),data:O});
if(M||M===0){L+=M
}L+=">";
M=C["if"].call(P,P.active,{hash:{},inverse:w.noop,fn:w.program(20,p,O),data:O});
if(M||M===0){L+=M
}M=C["if"].call(P,P.avatar,{hash:{},inverse:w.noop,fn:w.program(22,l,O),data:O});
if(M||M===0){L+=M
}L+=d(((N=P.name),typeof N===f?N.apply(P):N))+"</label>\n                </a>\n            </li>\n            ";
return L
}function G(M,L){return"active"
}function F(M,L){return'class=\n"active"'
}function p(M,L){return'<i class="icon-check blue"></i>'
}function l(O,N){var L="",M;
L+='<img src="'+d(((M=O.avatar),typeof M===f?M.apply(O):M))+'">';
return L
}function k(P,O){var L="",N,M;
L+='\n            <li class="disabled">\n                <div class="alert notice">'+d(((N=((N=P.deniedOrganizations),N==null||N===false?N:N.message)),typeof N===f?N.apply(P):N))+"</div>\n            </li>\n            ";
M=C.each.call(P,((N=P.deniedOrganizations),N==null||N===false?N:N.list),{hash:{},inverse:w.noop,fn:w.program(25,j,O),data:O});
if(M||M===0){L+=M
}L+="\n            ";
return L
}function j(P,O){var L="",N,M;
L+='\n            <li class="disabled">\n                <span title="'+d(((N=P.name),typeof N===f?N.apply(P):N))+'">\n                    ';
M=C["if"].call(P,P.avatar,{hash:{},inverse:w.noop,fn:w.program(22,l,O),data:O});
if(M||M===0){L+=M
}L+=d(((N=P.name),typeof N===f?N.apply(P):N))+"\n                </span>\n            </li>\n            ";
return L
}function h(O,N){var L="",M;
L+='\n                <div class="manageLinkDiv">\n                    ';
M=C.unless.call(O,O.singleOrganization,{hash:{},inverse:w.noop,fn:w.program(28,g,N),data:N});
if(M||M===0){L+=M
}L+="\n                </div>\n            ";
return L
}function g(O,N){var L="",M;
L+='\n                        <a href="#" class="manageLink">';
if(M=C.manageOrganizationsLabel){M=M.call(O,{hash:{},data:N})
}else{M=O.manageOrganizationsLabel;
M=typeof M===f?M.apply(O):M
}L+=d(M)+"</a>\n                    ";
return L
}function B(O,N){var L="",M;
L+="\n                    ";
M=C["if"].call(O,O.visible,{hash:{},inverse:w.noop,fn:w.program(31,A,N),data:N});
if(M||M===0){L+=M
}L+="\n                ";
return L
}function A(P,O){var L="",N,M;
L+='\n                        <a href="#" data-href="'+d(((N=P.url),typeof N===f?N.apply(P):N))+'" class="button ';
M=C["if"].call(P,P.primary,{hash:{},inverse:w.noop,fn:w.program(32,z,O),data:O});
if(M||M===0){L+=M
}L+='">'+d(((N=P.text),typeof N===f?N.apply(P):N))+"</a>\n                    ";
return L
}function z(M,L){return"primary"
}D+='<div id="user_popover" class="popover">\n    <div class="inner-border">\n        ';
o=C["if"].call(E,E.loading,{hash:{},inverse:w.program(6,r,K),fn:w.program(1,v,K),data:K});
if(o||o===0){D+=o
}D+='\n        <div class="loading-overlay">\n            <div class="spinner large"></div>\n        </div>\n    </div>\n</div>';
return D
})
})();
if(!window.CQ_Analytics){window.CQ_Analytics={}
}CQ_Analytics.Operator=(function(){return function(){}
})();
CQ_Analytics.Operator.IS="is";
CQ_Analytics.Operator.EQUALS="equals";
CQ_Analytics.Operator.NOT_EQUAL="notequal";
CQ_Analytics.Operator.GREATER="greater";
CQ_Analytics.Operator.GREATER_OR_EQUAL="greaterorequal";
CQ_Analytics.Operator.OLDER="older";
CQ_Analytics.Operator.OLDER_OR_EQUAL="olderorequal";
CQ_Analytics.Operator.LESS="less";
CQ_Analytics.Operator.LESS_OR_EQUAL="lessorequal";
CQ_Analytics.Operator.YOUNGER="younger";
CQ_Analytics.Operator.YOUNGER_OR_EQUAL="youngerorequal";
CQ_Analytics.Operator.CONTAINS="contains";
CQ_Analytics.Operator.BEGINS_WITH="beginswith";
CQ_Analytics.OperatorActions=function(){var mapping={};
var addOperator=function(name,text,operation){mapping[name]=[text,operation]
};
addOperator(CQ_Analytics.Operator.EQUALS,"equals","==");
addOperator(CQ_Analytics.Operator.IS,"is","==");
addOperator(CQ_Analytics.Operator.NOT_EQUAL,"is not equal to","!=");
addOperator(CQ_Analytics.Operator.GREATER,"is greater than",">");
addOperator(CQ_Analytics.Operator.GREATER_OR_EQUAL,"is equal to or greater than",">=");
addOperator(CQ_Analytics.Operator.OLDER,"is older than",">");
addOperator(CQ_Analytics.Operator.OLDER_OR_EQUAL,"is equal to or older than",">=");
addOperator(CQ_Analytics.Operator.LESS,"is less than","<");
addOperator(CQ_Analytics.Operator.LESS_OR_EQUAL,"is equal to or less than","<=");
addOperator(CQ_Analytics.Operator.YOUNGER,"is younger than","<");
addOperator(CQ_Analytics.Operator.YOUNGER_OR_EQUAL,"is equal to or younger than","<=");
addOperator(CQ_Analytics.Operator.CONTAINS,"contains",function(s1,s2){if(s1){if(s2){s1=""+s1;
s2=""+s2;
return s1.toLowerCase().indexOf(s2.toLowerCase())!=-1
}return true
}return false
});
addOperator(CQ_Analytics.Operator.BEGINS_WITH,"begins with",function(s1,s2){if(s1){if(s2){s1=""+s1;
s2=""+s2;
return s1.toLowerCase().indexOf(s2.toLowerCase())==0
}return true
}return false
});
var getByIndex=function(op,index){if(mapping[op]&&mapping[op][index]){return mapping[op][index]
}return""
};
var escapeQuote=function(str){if(str){str=str.replace(new RegExp("\\'","ig"),str)
}return str
};
return{getText:function(operator){return getByIndex(operator,0)
},setText:function(operator,newText){if(mapping[operator]&&mapping[operator][0]){mapping[operator][0]=newText
}},getOperation:function(operator){return getByIndex(operator,1)
},operate:function(object,property,operator,value,valueFormat){try{if(object&&object[property]){var toEval="";
var op=this.getOperation(operator);
op=op?op:operator;
var objectValue=CQ.shared.XSS.getXSSTablePropertyValue(object,property);
if(typeof op=="function"){return op.call(this,objectValue,value,valueFormat)
}else{if(valueFormat){toEval=valueFormat+"('"+objectValue+"') "+op+" "+valueFormat+"('"+value+"')"
}else{var s1=escapeQuote(objectValue);
var s2=escapeQuote(value);
toEval="'"+s1+"' "+op+" '"+s2+"'"
}var b=eval(toEval);
return b
}}}catch(e){}return false
}}
}();
CQ_Analytics.Utils=new function(){return{registerDocumentEventHandler:function(d,b){var a=window.document[d];
if(typeof window.document[d]!="function"){window.document[d]=b
}else{window.document[d]=function(f){if(a){a(f)
}b(f)
}
}},eventWrapper:function(a){return function(f){var d,b;
if(document.all){d=window.event.keyCode;
b=window.event
}else{d=(typeof(f.which)!="undefined")?f.which:0;
b=f
}if(b){a(b,d)
}}
},loadElement:function(a,b){$CQ("#"+b).load(a)
},loadTeaserElement:function(a,f){var g=$CQ("#"+f).css("height");
var j=$CQ("#"+f).height();
if(j>0){$CQ("#"+f).css("height",j)
}var k=function(o){if(o&&o!=""){var h=$CQ(o).css("display","none");
$CQ("#"+f).append(h);
h.fadeIn(function(){if(g&&g!="0px"){$CQ("#"+f).css("height",g)
}})
}else{if(g&&g!="0px"){$CQ("#"+f).css("height",g)
}}};
var l=function(h,o){if(!CQ_Analytics.Utils.teasersCache){CQ_Analytics.Utils.teasersCache={}
}CQ_Analytics.Utils.teasersCache[h]=o
};
var b=function(){if(CQ_Analytics.Utils.teasersCache&&CQ_Analytics.Utils.teasersCache[a]){k(CQ_Analytics.Utils.teasersCache[a])
}else{CQ_Analytics.Utils.teasersLoading=CQ_Analytics.Utils.teasersLoading||{};
if(CQ_Analytics.Utils.teasersLoading[a]){window.setTimeout(function(){CQ_Analytics.Utils.loadTeaserElement(a,f)
},100)
}else{CQ_Analytics.Utils.teasersLoading[a]=true;
m()
}}};
var m=function(){var o=a;
var h=location.href;
if(typeof CQ_CONTENT_PATH!="undefined"){h=CQ_CONTENT_PATH
}var p=CQ.shared.HTTP.getParameter(h,"wcmmode");
if(p){o+=(o.indexOf("?")>0?"&":"?")+"wcmmode="+p
}CQ.shared.HTTP.get(o,function(t,s,q){if(s){var r=q.body;
if(r){r=r.replace(new RegExp("\\n","ig"),"");
r=r.replace(new RegExp("\\r","ig"),"");
l(a,r);
delete CQ_Analytics.Utils.teasersLoading[a];
b()
}}else{l(a,"")
}})
};
var d=$CQ("#"+f).children().length;
if(d>0){var n=0;
$CQ("#"+f).children().fadeOut(function(){var h=$CQ(this);
window.setTimeout(function(){h.remove();
n++;
if(n>=d){b()
}},50)
})
}else{b()
}},clearElement:function(a){if(a){$CQ("#"+a).html("")
}},indexOf:function(f,d){for(var b=0,a=f.length;
b<a;
b++){if(f[b]==d){return b
}}return -1
},load:function(a,d,b){return CQ.shared.HTTP.get(a,d,b)
},post:function(a,f,d,b){return CQ.shared.HTTP.post(a,f,d,b)
},getPagePath:function(){return CQ.shared.HTTP.getPath()
},getPath:function(a){return CQ.shared.HTTP.getPath(a)
},addParameter:function(b,a,d){return CQ.shared.HTTP.addParameter(b,a,d)
},removeParameters:function(a){return CQ.shared.HTTP.removeParameters(a)
},removeAnchor:function(a){return CQ.shared.HTTP.removeAnchor(a)
},getSchemeAndAuthority:function(a){return CQ.shared.HTTP.getSchemeAndAuthority(a)
},internalize:function(a,b){return CQ.shared.HTTP.internalize(b)
},externalize:function(a,b){return CQ.shared.HTTP.externalize(a,b)
},encodePathOfURI:function(a){return CQ.shared.HTTP.encodePathOfURI(a)
},encodePath:function(a){return CQ.shared.HTTP.encodePath(a)
},getContextPath:function(){return CQ.shared.HTTP.getContextPath()
},detectContextPath:function(){return CQ.shared.HTTP.detectContextPath()
},urlEncode:function(l){if(!l){return""
}if(typeof l=="string"){return l
}var d=[];
for(var h in l){var g=l[h],b=encodeURIComponent(h);
var j=typeof g;
if(j=="undefined"){d.push(b,"=&")
}else{if(j!="function"&&j!="object"){d.push(b,"=",encodeURIComponent(g),"&")
}else{if(typeof g=="array"){if(g.length){for(var f=0,a=g.length;
f<a;
f++){d.push(b,"=",encodeURIComponent(g[f]===undefined?"":g[f]),"&")
}}else{d.push(b,"=&")
}}}}}d.pop();
return d.join("")
},getUID:function(){var a=Math.floor(Math.random()*(Math.pow(2,42)-1));
return this.getTimestamp().toString(16)+a.toString(16)
},getTimestamp:function(){var a=new Date();
return a.getTime()
},insert:function(f,d,b){if(!f||isNaN(d)||!b){return f
}var a="";
var h=0;
var g=d;
while(g<f.length){a+=f.substring(h,g)+b;
h+=d;
g+=d
}if(h<f.length){a+=f.substring(h)
}return a
},addListener:function(){if(window.addEventListener){return function(f,b,d,a){f.addEventListener(b,d,(a))
}
}else{if(window.attachEvent){return function(f,b,d,a){f.attachEvent("on"+b,d)
}
}else{return function(){}
}}},removeListener:function(){if(window.removeEventListener){return function(f,b,d,a){f.removeEventListener(b,d,(a))
}
}else{if(window.detachEvent){return function(d,a,b){d.detachEvent("on"+a,b)
}
}else{return function(){}
}}}}
};
CQ_Analytics.ClickstreamcloudRenderingUtils=new function(){return{createLink:function(h,f,b,a){var d=document.createElement("a");
d.href=a;
d.onclick=f;
d.innerHTML=h;
if(b){for(var g in b){if(b.hasOwnProperty(g)){d[g]=b[g]
}}}return d
},createStaticLink:function(f,a,d){var b=document.createElement("a");
b.href=a;
b.innerHTML=f;
b.title=d;
b.alt=d;
return b
},createNameValue:function(b,f,a,g){var d=document.createElement("span");
d.className=a||"ccl-data";
d.innerHTML=b+" = "+f;
d.title=g;
d.alt=g;
return d
},createText:function(f,a,d){var b=document.createElement("span");
b.className=a||"ccl-data";
if(f&&f.indexOf&&((f.indexOf("/home")!=-1&&f.indexOf("/image")!=-1)||(f.indexOf("/")!=-1&&f.indexOf(".png")!=-1))){b.innerHTML='<img src="'+f+'.prof.thumbnail.png" border="0">'
}else{if(f&&f.indexOf&&f.indexOf("www.gravatar.com")!=-1){b.innerHTML='<img src="'+f+'">'
}else{b.innerHTML=f
}}b.title=d;
b.alt=d;
return b
},createEditablePropertySpan:function(b,f){var a="var editSpan = this.nextSibling; this.style.display = 'none'; editSpan.style.display = 'block';";
var g="var editSpan = this.parentNode; var readSpan = this.parentNode.previousSibling;var newValue = this.value;editSpan.style.display = 'none'; readSpan.innerHTML = '"+b+" = '+value; readSpan.style.display = 'block';";
var d=document.createElement("span");
d.innerHTML='<span class="ccl-data" onclick="'+a+'">'+b+" = "+f+"</span>";
d.innerHTML+='<span class="ccl-data" style="display: none;">'+b+' = <input class="ccl-input" type="text" value="'+f+'" onblur="'+g+'"></span>';
d.className="ccl-data";
return d
}}
};
CQ_Analytics.ClientContextUtils=new function(){return{renderStoreProperty:function(h,d,b,f,g,a){if(CQ_Analytics&&CQ_Analytics.CCM){CQ_Analytics.CCM.onReady(function(){var j=function(){var k=CQ_Analytics.StoreRegistry.getStore(d);
if(k){var l=function(){var o=k.getProperty(b)||a;
var n=$CQ("#"+h);
if(n.attr("contenteditable")&&n.attr("contenteditable")!="inherit"){return
}if(typeof(o)=="string"&&((o.indexOf("/")==0&&(o.toLowerCase().indexOf(".png")!=-1||o.toLowerCase().indexOf(".jpg")!=-1||o.toLowerCase().indexOf(".gif")!=-1)||o.toLowerCase().indexOf("http")==0))){if(!o||o==""){n.children().remove();
if(CQ_Analytics.isUIAvailable){n.html(CQ.I18n.getMessage("No",null,"Ex: No address, No keywords")+" "+b)
}else{n.html("No "+b)
}}else{var m="";
if(n.parents(".cq-cc-thumbnail").length==0||o.toLowerCase().indexOf("http")==0||o.indexOf("/libs/wcm/mobile")==0){m=o.replace(new RegExp("&amp;","g"),"&")
}else{m="/etc/clientcontext/shared/thumbnail/content.png";
m=CQ.shared.HTTP.addParameter(m,"path",CQ_Analytics.Variables.replaceVariables(o))
}m=CQ_Analytics.Variables.replaceVariables(m);
if(n.find("div").css("background-image")!="url("+m+")"){if(k.fireEvent("beforepropertyrender",k,h)!==false){n.html("");
n.children().remove();
$CQ("<div>").addClass("cq-cc-thumbnail-img").css("background-image","url("+CQ.shared.HTTP.externalize(m)+")").appendTo(n);
k.fireEvent("propertyrender",k,h)
}}}}else{o=CQ_Analytics.Variables.replaceVariables(o);
if(CQ_Analytics.isUIAvailable){o=(!o||o=="")?CQ.I18n.getMessage("No",null,"Ex: No address, No keywords")+" "+b:o=f+o+g
}else{o=(!o||o=="")?"No "+b:o=f+o+g
}if(n.html()!=o){if(k.fireEvent("beforepropertyrender",k,h)!==false){n.html(o);
k.fireEvent("propertyrender",k,h)
}}}};
if(k.fireEvent("beforeinitialpropertyrender",k,h)!==false){l();
if(k.addListener){k.addListener("update",function(){l()
})
}k.fireEvent("initialpropertyrender",k,h)
}}};
CQ_Analytics.ClientContextUtils.onStoreRegistered(d,j)
})
}},renderStore:function(b,a){if(CQ_Analytics&&CQ_Analytics.CCM&&b&&a){CQ_Analytics.CCM.onReady(function(){var d=function(){var f=CQ_Analytics.StoreRegistry.getStore(a);
if(f){f.divId=b;
var g=function(){if(f.fireEvent("beforerender",f,f.divId)!==false){f.renderer(f,f.divId);
f.fireEvent("render",f,f.divId)
}};
if(f.fireEvent("beforeinitialrender",f,b)!==false){g();
if(f.addListener){f.addListener("update",function(){g()
})
}f.fireEvent("initialrender",f,b)
}}};
CQ_Analytics.ClientContextUtils.onStoreRegistered(a,d)
})
}},storesOptionsProvider:function(){var d=[];
var a=CQ_Analytics.StoreRegistry.getStores();
for(var b in a){d.push({value:b})
}return d
},storePropertiesOptionsProvider:function(d,g){var b=[];
var a=CQ_Analytics.StoreRegistry.getStore(d);
if(a){var j=a.getPropertyNames();
for(var f=0;
f<j.length;
f++){var h=j[f];
if(!CQ.shared.XSS.KEY_REGEXP.test(h)){var k={value:h};
if(g){k.text=h+" - "+a.getProperty(h)
}b.push(k)
}}}return b
},onStoreRegistered:function(b,d){if(d){var a=CQ_Analytics.StoreRegistry.getStore(b);
if(a){d.call(a,a)
}else{CQ_Analytics.CCM.addListener("storeregister",function(g,f){if(f.getName()==b){d.call(f,f)
}})
}}},onStoreInitialized:function(d,g,b){if(b===true){b=CQ_Analytics.ClientContextUtils.DEFAULT_INIT_DELAY
}var f=function(){var h=CQ_Analytics.StoreRegistry.getStore(d);
if(h.DELAYED_INIT_TIMEOUT){window.clearTimeout(h.DELAYED_INIT_TIMEOUT);
h.DELAYED_INIT_TIMEOUT=null
}if(b>0){h.DELAYED_INIT_TIMEOUT=window.setTimeout(function(){h.DELAYED_INIT_TIMEOUT=null;
g.call(h,"initialize",h)
},b)
}else{g.call(h,"initialize",h)
}};
var a=CQ_Analytics.StoreRegistry.getStore(d);
if(a){if(a.isInitialized()){f.call(a);
a.addListener("initialize",function(j,h){f.call(h)
})
}else{a.addListener("initialize",function(j,h){f.call(h)
})
}}else{CQ_Analytics.CCM.addListener("storeregister",function(j,h){if(h.getName()==d){CQ_Analytics.ClientContextUtils.onStoreInitialized(d,g,b)
}})
}},init:function(f,d){CQ_Analytics.ClientContextMgr.PATH=f;
CQ_Analytics.ClientContextMgr.loadConfig(null,true);
var a=CQ.shared.HTTP.externalize(f+"/content/jcr:content/stores.init.js");
a=CQ.shared.HTTP.addParameter(a,"path",d);
a=CQ.shared.HTTP.noCaching(a);
var b=CQ.shared.HTTP.get(a)
},initUI:function(d,a,b){CQ_Analytics.ClientContextUI.create(d,a,b)
}}
};
CQ_Analytics.ClientContextUtils.DEFAULT_INIT_DELAY=200;
CQ_Analytics.Variables=new function(){return{containsVariable:function(a){return CQ_Analytics.Variables.getVariables(a).length>0
},getVariables:function(b){if(!b||typeof(b)!="string"){return[]
}var a=b.match(new RegExp("\\$\\{([\\w/]*)\\}","ig"));
return a?a:[]
},replaceVariables:function(g){if(!g){return g
}var h="";
var f=g;
var j=CQ_Analytics.Variables.getVariables(g);
while(j.length>0&&h.indexOf(j.join())==-1){for(var d=0;
d<j.length;
d++){var b=CQ_Analytics.Variables.getPropertyPath(j[d]);
var a=CQ_Analytics.ClientContext.get(b)||"";
f=CQ_Analytics.Variables.replace(f,b,a)
}h+=j.join();
j=CQ_Analytics.Variables.getVariables(f)
}return f
},getPropertyPath:function(a){if(!a||a.length<2){return null
}return a.substring(2,a.length-1)
},getPropertyName:function(a){var d=CQ_Analytics.Variables.getPropertyPath(a);
if(d){var b=d.split("/");
if(b.length==3){return b[2]
}}return null
},getStoreName:function(a){var d=CQ_Analytics.Variables.getPropertyPath(a);
if(d){var b=d.split("/");
if(b.length>1){return b[1]
}}return null
},replace:function(a,b,d){return a.replace(new RegExp("\\$\\{"+b+"\\}","ig"),d)
}}
};
CQ_Analytics.SessionPersistence=CQ.shared.ClientSidePersistence;
CQ_Analytics.Cookie=CQ.shared.ClientSidePersistence.CookieHelper;
CQ_Analytics.Observable=function(){this.fireEvent=function(f){if(f&&this.listeners&&!this.suppressEvents){f=f.toLowerCase();
var b=Array.prototype.slice.call(arguments,0);
var g=this.listeners.slice(0);
for(var d=0;
d<g.length;
d++){var a=g[d];
if(f==a.event){if(a.fireFn.apply(a.scope||this||window,b)===false){return false
}}}}return true
}
};
CQ_Analytics.Observable.prototype.addListener=function(d,a,b){this.listeners=this.listeners||new Array();
if(d&&a){this.listeners.push({event:d.toLowerCase(),fireFn:a,scope:b})
}};
CQ_Analytics.Observable.prototype.removeListener=function(d,a){this.listeners=this.listeners||new Array();
if(d&&a){for(var b=0;
b<this.listeners.length;
b++){if(this.listeners[b].event==d&&this.listeners[b].fireFn==a){this.listeners.splice(b,1)
}}}};
CQ_Analytics.Observable.prototype.setSuppressEvents=function(a){this.suppressEvents=a
};
CQ_Analytics.Observable.prototype.listeners=null;
CQ_Analytics.Observable.prototype.suppressEvents=false;
if(!CQ_Analytics.StoreRegistry){CQ_Analytics.StoreRegistry=new function(){var a={};
return{register:function(b){if(b.STORENAME){a[b.STORENAME]=b
}},getStores:function(){return a
},getStore:function(b){return a[b]
}}
}()
}CQ_Analytics.SessionStore=function(){};
CQ_Analytics.SessionStore.prototype=new CQ_Analytics.Observable();
CQ_Analytics.SessionStore.prototype.setProperty=function(a,b){if(this.data==null){this.init()
}this.data[a]=b;
this.fireEvent("update",a)
};
CQ_Analytics.SessionStore.prototype.setProperties=function(b){if(this.data==null){this.init()
}var f=[];
for(var a in b){if(b.hasOwnProperty(a)){f.push(a);
var d=b[a];
this.data[a]=d
}}if(f.length>0){this.fireEvent("update",f)
}};
CQ_Analytics.SessionStore.prototype.initialized=false;
CQ_Analytics.SessionStore.prototype.init=function(){this.initialized=true;
this.fireEvent("initialize",this)
};
CQ_Analytics.SessionStore.prototype.getLabel=function(a){return a
};
CQ_Analytics.SessionStore.prototype.getLink=function(a){return a
};
CQ_Analytics.SessionStore.prototype.removeProperty=function(a){if(this.data==null){this.init()
}if(this.data[a]){delete this.data[a]
}this.fireEvent("update",a)
};
CQ_Analytics.SessionStore.prototype.getPropertyNames=function(a){if(this.data==null){this.init()
}a=a?a:[];
var b=new Array();
for(var d in this.data){if(CQ_Analytics.Utils.indexOf(a,d)==-1){b.push(d)
}}return b
};
CQ_Analytics.SessionStore.prototype.getSessionStore=function(){return this
};
CQ_Analytics.SessionStore.prototype.clear=function(){this.data=null
};
CQ_Analytics.SessionStore.prototype.getData=function(b){if(this.data==null){this.init()
}if(b){var a={};
for(var d in this.data){if(CQ_Analytics.Utils.indexOf(b,d)==-1){a[d]=this.data[d]
}}return a
}else{return this.data
}};
CQ_Analytics.SessionStore.prototype.reset=function(){if(this.data!=null){this.data=null;
this.fireEvent("update")
}};
CQ_Analytics.SessionStore.prototype.getProperty=function(b,a){if(this.data==null){this.init()
}var f=this.data[b];
if(!a){var d=CQ.shared.XSS.getXSSValue(f);
return d
}return f
};
CQ_Analytics.SessionStore.prototype.getName=function(){return this.STORENAME
};
CQ_Analytics.SessionStore.prototype.addInitProperty=function(a,b){if(!this.initProperty){this.initProperty={}
}this.initProperty[a]=b
};
CQ_Analytics.SessionStore.prototype.getInitProperty=function(a){return this.initProperty?this.initProperty[a]:null
};
CQ_Analytics.SessionStore.prototype.loadInitProperties=function(d,a){if(d){for(var b in d){this.addInitProperty(b,d[b]);
if(a&&this.data&&this.data[b]===undefined){this.setProperty(b,d[b])
}}}};
CQ_Analytics.SessionStore.prototype.isInitialized=function(){return this.initialized
};
CQ_Analytics.PersistedSessionStore=function(){};
CQ_Analytics.PersistedSessionStore.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.PersistedSessionStore.prototype.STOREKEY="key";
CQ_Analytics.PersistedSessionStore.prototype.setNonPersisted=function(a){if(!this.nonPersisted){this.nonPersisted={}
}this.nonPersisted[a]=true
};
CQ_Analytics.PersistedSessionStore.EXCLUDED_PROPERTIES_REGEX="^generated*";
CQ_Analytics.PersistedSessionStore.prototype.isPersisted=function(a){if(!this.nonPersisted){this.nonPersisted={}
}return this.nonPersisted[a]!==true&&!new RegExp(CQ_Analytics.PersistedSessionStore.EXCLUDED_PROPERTIES_REGEX,"ig").test(a)&&!$CQ.isFunction(this.data[a])&&(typeof this.data[a])!="object"
};
CQ_Analytics.PersistedSessionStore.prototype.getStoreKey=function(){return this.STOREKEY
};
CQ_Analytics.PersistedSessionStore.prototype.persist=function(){if(this.fireEvent("beforepersist")!==false){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
a.set(this.getStoreKey(),this.toString());
this.fireEvent("persist")
}};
CQ_Analytics.PersistedSessionStore.prototype.setProperty=function(a,b){if(this.data==null){this.init()
}this.data[a]=b;
if(this.isPersisted(a)){this.persist()
}this.fireEvent("update",a)
};
CQ_Analytics.PersistedSessionStore.prototype.setProperties=function(b){if(this.data==null){this.init()
}var f=[];
var g=false;
for(var a in b){if(b.hasOwnProperty(a)){f.push(a);
var d=b[a];
this.data[a]=d;
if(this.isPersisted(a)){g=true
}}}if(g){this.persist()
}if(f.length>0){this.fireEvent("update",f)
}};
CQ_Analytics.PersistedSessionStore.prototype.toString=function(){var b=null;
if(this.data){var a=function(g){if(!g||typeof(g)!="string"){return g
}var f=g;
f=f.replace(new RegExp(",","g"),"&#44;");
f=f.replace(new RegExp("=","g"),"&#61;");
f=f.replace(new RegExp("\\|","g"),"&#124;");
return f
};
for(var d in this.data){if(this.isPersisted(d)&&this.data.hasOwnProperty(d)){b=(b===null?"":b+",");
b+=(d+"="+a(this.data[d]))
}}}return b
};
CQ_Analytics.PersistedSessionStore.prototype.parse=function(g){var f=function(k){if(!k||typeof(k)!="string"){return k
}var j=k;
j=j.replace(new RegExp("&#44;","g"),",");
j=j.replace(new RegExp("&#61;","g"),"=");
j=j.replace(new RegExp("&#124;","g"),"|");
return j
};
var d={};
var h=g.split(",");
for(var a in h){if(h.hasOwnProperty(a)){var b=h[a].split("=");
if(b.length==2){d[b[0]]=f(b[1])
}}}return d
};
CQ_Analytics.PersistedSessionStore.prototype.reset=function(a){if(this.data!=null){this.data={};
this.persist();
this.data=null;
if(!a){this.fireEvent("update")
}}};
CQ_Analytics.PersistedSessionStore.prototype.removeProperty=function(a){if(this.data==null){this.init()
}if(this.data[a]){delete this.data[a];
if(this.isPersisted(a)){this.persist()
}}this.fireEvent("update",a)
};
CQ_Analytics.PersistedSessionStore.prototype.clear=function(){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
a.remove(this.getStoreKey());
this.data=null
};
if(!CQ_Analytics.ClientContextMgr){CQ_Analytics.ClientContextMgr=function(){this.clientcontext=null;
this.clientcontextToServer=null;
this.stores={};
this.data=null;
this.config=null;
this.isConfigLoaded=false;
this.areStoresLoaded=false
};
CQ_Analytics.ClientContextMgr.prototype=new CQ_Analytics.PersistedSessionStore();
CQ_Analytics.ClientContextMgr.prototype.STOREKEY="CLIENTCONTEXT";
CQ_Analytics.ClientContextMgr.prototype.STORENAME="clientcontext";
CQ_Analytics.ClientContextMgr.prototype.INITIALIZATION_EVENT_TIMER=1000;
CQ_Analytics.ClientContextMgr.prototype.CONFIG_PATH=CQ_Analytics.Utils.externalize("/etc/clientcontext/legacy/config.json",true);
CQ_Analytics.ClientContextMgr.prototype.init=function(){if(!this.initialized){this.clientcontext={};
this.clientcontextToServer={}
}var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var b=a.get(this.getStoreKey());
if(b){this.data=this.parse(b)
}else{this.data={}
}this.initialized=true;
this.fireEvent("initialize",this)
};
CQ_Analytics.ClientContextMgr.prototype.getSessionId=function(){if(!this.data.sessionId){this.setSessionId(CQ_Analytics.Utils.getUID())
}return this.data.sessionId
};
CQ_Analytics.ClientContextMgr.prototype.setSessionId=function(a){if(a){this.setProperty("sessionId",a)
}};
CQ_Analytics.ClientContextMgr.prototype.getVisitorId=function(){return this.data.visitorId
};
CQ_Analytics.ClientContextMgr.prototype.setVisitorId=function(a){this.setProperty("visitorId",a)
};
CQ_Analytics.ClientContextMgr.prototype.getId=function(){var a=this.getVisitorId();
if(!a){return this.getSessionId()
}return a
};
CQ_Analytics.ClientContextMgr.prototype.isAnonymous=function(){var a=this.getVisitorId();
return(!a)
};
CQ_Analytics.ClientContextMgr.prototype.isMode=function(a){return CQ_Analytics.ClientContextMgr.ServerStorage.isMode(a)
};
CQ_Analytics.ClientContextMgr.prototype.get=function(a){if(this.clientcontext==null){this.init()
}if(a){return this.clientcontextToServer
}return this.clientcontext
};
CQ_Analytics.ClientContextMgr.prototype.register=function(d){if(this.clientcontext==null){this.init()
}var a=this;
this.clientcontext[d.getName()]=d.getData();
this.stores[d.getName()]=d;
CQ_Analytics.StoreRegistry.register(d);
var b=this.getStoreConfig(d.getName());
if(b.stats!==false&&b.stats!="false"){this.clientcontextToServer[d.getName()]=d.getData(b.excludedFromStats)
}if(this.initTimer){window.clearTimeout(this.initTimer);
this.initTimer=null
}this.initTimer=window.setTimeout(function(){a.fireEvent("storesinitialize");
a.areStoresInitialized=true
},this.INITIALIZATION_EVENT_TIMER);
d.addListener("update",function(){a.update(d)
});
CQ_Analytics.ClientContextMgr.ServerStorage.handleStoreRegistration(d);
this.addListener("clear",function(){d.clear()
});
this.fireEvent("storeregister",d);
this.fireEvent("storeupdate",d)
};
CQ_Analytics.ClientContextMgr.prototype.update=function(b){if(this.clientcontext==null){this.init()
}this.clientcontext[b.getName()]=b.getData();
var a=this.getStoreConfig(b.getName());
if(a.stats!==false&&a.stats!="false"){this.clientcontextToServer[b.getName()]=b.getData(a.excludedFromStats)
}this.fireEvent("storeupdate",b)
};
CQ_Analytics.ClientContextMgr.prototype.startPosting=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.startPosting()
};
CQ_Analytics.ClientContextMgr.prototype.stopPosting=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.stopPosting()
};
CQ_Analytics.ClientContextMgr.prototype.post=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.post()
};
CQ_Analytics.ClientContextMgr.prototype.getCCMToJCR=function(){return CQ_Analytics.ClientContextMgr.ServerStorage.getCCMToJCR()
};
CQ_Analytics.ClientContextMgr.prototype.getName=function(){return this.STORENAME
};
CQ_Analytics.ClientContextMgr.prototype.clear=function(){this.clientcontext=null;
this.clientcontextToServer=null;
this.fireEvent("clear")
};
CQ_Analytics.ClientContextMgr.prototype.getRegisteredStore=function(a){return this.stores&&this.stores[a]?this.stores[a]:null
};
CQ_Analytics.ClientContextMgr.prototype.loadConfig=function(c,autoConfig){var setConfig=function(ccm,config){ccm.config=config;
ccm.isConfigLoaded=true;
ccm.fireEvent("configloaded");
ccm.fireEvent("storesloaded");
ccm.areStoresLoaded=true
};
if(c){setConfig(this,c)
}else{if(!autoConfig){var params={};
params.path=CQ_Analytics.Utils.getPagePath();
params.cq_ck=new Date().valueOf();
var url=this.CONFIG_PATH;
url+="?"+CQ_Analytics.Utils.urlEncode(params);
CQ_Analytics.Utils.load(url,function(data,status,response){var config={};
try{config=eval("config = "+response.responseText)
}catch(error){}setConfig(this,config)
},this)
}else{setConfig(this,{})
}}};
CQ_Analytics.ClientContextMgr.prototype.getConfig=function(){return this.config
};
CQ_Analytics.ClientContextMgr.prototype.getStoreConfig=function(a){if(this.config&&this.config.configs&&this.config.configs[a]&&this.config.configs[a]["store"]){return this.config.configs[a]["store"]
}return{}
};
CQ_Analytics.ClientContextMgr.prototype.getEditConfig=function(a){if(this.config&&this.config.configs&&this.config.configs[a]&&this.config.configs[a]["edit"]){return this.config.configs[a]["edit"]
}return{}
};
CQ_Analytics.ClientContextMgr.prototype.getUIConfig=function(a){if(this.config&&this.config.configs&&this.config.configs[a]&&this.config.configs[a]["ui"]){return this.config.configs[a]["ui"]
}return{}
};
CQ_Analytics.ClientContextMgr.prototype.getInitialData=function(a){if(this.config&&this.config.data&&this.config.data[a]){return this.config.data[a]
}return{}
};
CQ_Analytics.ClientContextMgr.prototype.getStores=function(){return this.stores
};
CQ_Analytics.ClientContextMgr.prototype.onReady=function(b,a){if(b){if(this.areStoresLoaded){b.call(a)
}else{this.addListener("storesloaded",b,a)
}}};
CQ_Analytics.ClientContextMgr=CQ_Analytics.CCM=new CQ_Analytics.ClientContextMgr();
CQ_Analytics.ClickstreamcloudMgr=CQ_Analytics.CCM;
CQ_Analytics.ContextCloudMgr=CQ_Analytics.CCM;
CQ_Analytics.ClientContextMgr.PATH=null;
CQ_Analytics.ClientContextMgr.getClientContextURL=function(a){return CQ_Analytics.ClientContextMgr.PATH+a
};
window.setTimeout(function(){CQ_Analytics.CCM.init()
},1);
CQ_Analytics.Utils.addListener(window,"unload",function(){try{for(var b in CQ_Analytics.ClientContextMgr){delete CQ_Analytics.ClientContextMgr[b]
}CQ_Analytics.ClientContextMgr=null
}catch(a){}CQ_Analytics.CCM=null
})
}if(CQ_Analytics.ClientContextMgr&&!CQ_Analytics.ClientContextMgr.ServerStorage){CQ_Analytics.ClientContextMgr.ServerStorage=function(){this.posting=false;
this.initialized=false
};
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_PAGELOAD=1;
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_TIMER=2;
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE_DATAUPDATE=4;
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_TIMER=600;
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_PROCESS_TIMER=60;
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_MODE=6;
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.POST_PATH="/var/statistics/";
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.init=function(){if(this.isMode(CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_TIMER)){var a=this;
var b=function(){a.timer=window.setInterval(function(){try{var f=parseInt(a.data.lastPost);
var h=false;
if(isNaN(f)){h=true
}else{var g=new Date().getTime();
if(g>f+CQ_Analytics.ClientContextMgr.ServerStorage.POST_TIMER*1000){h=true
}}}catch(d){}if(h){a.post()
}},CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER*1000)
};
b.call(this)
}this.initialized=true
};
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.isMode=function(a){return(CQ_Analytics.CCM.POST_MODE&a)>0
};
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.handleStoreRegistration=function(a){if(!this.initialized){this.init()
}if(this.isMode(CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_DATAUPDATE)){a.addListener("persist",function(){CQ_Analytics.ClientContextMgr.ServerStorage.post(a)
})
}};
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.startPosting=function(){this.posting=true
};
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.stopPosting=function(){this.posting=false
};
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.post=function(f,h){if(this.posting||h){try{var j=this.getCCMToJCR(f);
var g=CQ_Analytics.Utils.getTimestamp();
j["./jcr:primaryType"]="nt:unstructured";
j["./sessionId"]=CQ_Analytics.CCM.getSessionId();
var d=this.POST_PATH+"clientcontext/";
if(CQ_Analytics.CCM.isAnonymous()){var a=CQ_Analytics.Utils.insert(CQ_Analytics.CCM.getId(),2,"/");
d+="anonymous/"+a+"/"+g
}else{d+="users/"+CQ_Analytics.CCM.getId()+"/"+g
}CQ_Analytics.Utils.post(d,null,j);
this.lastPost=g
}catch(b){}}};
CQ_Analytics.ClientContextMgr.ServerStorage.prototype.getCCMToJCR=function(j){var d=CQ_Analytics.CCM.get(true);
var g={};
for(var m in d){if(!j||m==j){var a=d[m],b=encodeURIComponent(m);
var h=typeof a;
if(h=="object"){for(var f in a){var l=a[f];
f=f.replace(":","/");
g["./"+m+"/./"+f]=l
}}else{g["./"+m]=a
}}}return g
};
CQ_Analytics.ClientContextMgr.ServerStorage=new CQ_Analytics.ClientContextMgr.ServerStorage();
CQ_Analytics.ClickstreamcloudMgr.POST_MODE_PAGELOAD=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_PAGELOAD;
CQ_Analytics.ClickstreamcloudMgr.POST_MODE_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_TIMER;
CQ_Analytics.ClickstreamcloudMgr.POST_MODE_DATAUPDATE=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE_DATAUPDATE;
CQ_Analytics.ClickstreamcloudMgr.POST_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER;
CQ_Analytics.ClickstreamcloudMgr.POST_PROCESS_TIMER=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PROCESS_TIMER;
CQ_Analytics.ClickstreamcloudMgr.POST_MODE=CQ_Analytics.ClientContextMgr.ServerStorage.POST_MODE;
CQ_Analytics.ClickstreamcloudMgr.POST_PATH=CQ_Analytics.ClientContextMgr.ServerStorage.POST_PATH
}CQ_Analytics.Percentile={};
CQ_Analytics.Percentile.matchesPercentiles=function(b){var f=ClientContext.get("/surferinfo/percentile");
if(!f){f=Math.round(Math.random()*100);
ClientContext.set("/surferinfo/percentile",f)
}for(var d=0;
d<b.length;
d++){var a=b[d];
if((a.start<=f)&&(f<a.end)){return true
}}return false
};
if(!CQ_Analytics.SegmentMgr){CQ_Analytics.SegmentMgr=function(){this.SEGMENTATION_ROOT="/etc/segmentation";
this.SEGMENT_SELECTOR=".segment.js";
this.SEGMENTATION_SCRIPT_LOADER="cq-segmentation-loader";
this.segments={};
this.boosts={};
var a=this;
this.fireUpdate=function(){a.fireEvent("update")
};
this.init()
};
CQ_Analytics.SegmentMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.SegmentMgr.prototype.STORENAME="segments";
CQ_Analytics.SegmentMgr.prototype.register=function(a,d,b){this.segments[a]=d;
if(this.rulesCache&&this.rulesCache[a]){this.rulesCache[a]=false
}this.boosts[a]=!isNaN(b)?parseInt(b):0;
this.fireUpdate()
};
CQ_Analytics.SegmentMgr.prototype.resolveArray=function(g,j,b){j=j||CQ_Analytics.ClientContextMgr.get();
if(!(g instanceof Array)){return this.resolve(g,j)
}b=(b=="AND"?"AND":"OR");
var a=(b=="AND");
for(var f=0;
f<g.length;
f++){var h=g[f];
var d=this.resolve(h,j);
if(b=="AND"){if(d!==true){return d
}}else{if(d===true){return true
}}}return a
};
CQ_Analytics.SegmentMgr.prototype.resolve=function(segmentPath,clientcontext){clientcontext=clientcontext||CQ_Analytics.ClientContextMgr.get();
if(!segmentPath){return false
}if(segmentPath instanceof Array){return this.resolveArray(segmentPath,clientcontext)
}if(segmentPath.indexOf(this.SEGMENTATION_ROOT)!=0){return false
}if(segmentPath==this.SEGMENTATION_ROOT){return true
}if(!this.segments[segmentPath]){return true
}var parent=segmentPath.substring(0,segmentPath.lastIndexOf("/"));
if(parent.indexOf(this.SEGMENTATION_ROOT)==0){var pres=this.resolve(parent,clientcontext);
if(pres!==true){return pres
}}var rules="function(clientcontext, contextcloud, clickstreamcloud) { return true ";
rules+=" && ( "+this.segments[segmentPath]+" ) ";
rules+=";}";
var res=true;
try{var f=null;
this.rulesCache=this.rulesCache||{};
if(this.rulesCache[segmentPath]){f=this.rulesCache[segmentPath]
}else{eval("f = "+rules+"");
this.rulesCache[segmentPath]=f
}var e=(f==null||f(clientcontext,clientcontext,clientcontext));
res=res&&(e===true)
}catch(error){return"Unresolved - Error while evaluating segment "+segmentPath+" : "+error.message
}return res
};
CQ_Analytics.SegmentMgr.prototype.getResolved=function(d){d=d||CQ_Analytics.ClientContextMgr.get();
var a=new Array();
for(var b in this.segments){if(this.resolve(b,d)===true){a.push(b)
}}return a
};
CQ_Analytics.SegmentMgr.prototype.getMaxBoost=function(g,j){if(!(g instanceof Array)){return this.getBoost(g)
}var d=0;
for(var f=0;
f<g.length;
f++){var h=g[f];
if(this.resolve(h,j)===true){var a=this.boosts[h]||0;
if(a>d){d=a
}}}return d
};
CQ_Analytics.SegmentMgr.prototype.getBoost=function(a){if(!(a instanceof Array)){a=[a]
}return this.boosts[a]||0
};
CQ_Analytics.SegmentMgr.prototype.reload=function(path){var url=path;
if(!url){url=this.SEGMENTATION_ROOT
}if(url){if(url.indexOf(this.SEGMENT_SELECTOR)==-1){url+=this.SEGMENT_SELECTOR
}try{CQ_Analytics.Utils.load(url,function(config,status,response){if(response&&response.responseText){eval(response.responseText)
}},this);
var response=CQ.HTTP.get(scripts[i].src)
}catch(err){}}};
CQ_Analytics.SegmentMgr.prototype.getSessionStore=function(){return this
};
CQ_Analytics.SegmentMgr.prototype.getProperty=function(a){return a
};
CQ_Analytics.SegmentMgr.prototype.getLink=function(a){return a+".html"
};
CQ_Analytics.SegmentMgr.prototype.getLabel=function(d){if(d){var b=d;
var a=b.lastIndexOf("/");
if(a!=-1){b=b.substring(a+1,b.length)
}var f=this.resolve(d);
if(f===true){return b
}else{if(f!==true){return'<span class="invalid" title="'+f+'" alt="'+f+'">'+b+"</span>"
}}}return d
};
CQ_Analytics.SegmentMgr.prototype.getPropertyNames=function(){return this.getResolved()
};
CQ_Analytics.SegmentMgr=new CQ_Analytics.SegmentMgr();
CQ_Analytics.SegmentMgr.loadSegments=function(a){CQ_Analytics.SegmentMgr.areSegmentsLoaded=false;
CQ.shared.HTTP.get(CQ.shared.HTTP.externalize(a+".segment.js"));
CQ_Analytics.SegmentMgr.areSegmentsLoaded=true;
this.fireEvent("segmentsload")
};
CQ_Analytics.SegmentMgr.renderer=function(a,d){if(a&&a.STORENAME==CQ_Analytics.SegmentMgr.STORENAME){var g=a.getPropertyNames();
var h=[];
h.push("<div>");
for(var f=0;
f<g.length;
f++){var b=g[f];
h.push('<span title="'+a.getProperty(b)+'" ><a href="'+CQ.shared.HTTP.externalize(a.getLink(b))+'"  title="'+a.getProperty(b)+'" >'+a.getLabel(b)+"</a></span>")
}h.push("</div>");
$CQ("#"+d).children().remove();
$CQ("#"+d).append(h.join(""))
}};
CQ_Analytics.ClientContextMgr.addListener("storeupdate",CQ_Analytics.SegmentMgr.fireUpdate);
CQ_Analytics.Utils.addListener(window,"unload",function(){try{for(var b in CQ_Analytics.SegmentMgr){delete CQ_Analytics.SegmentMgr[b]
}}catch(a){}CQ_Analytics.SegmentMgr=null
})
}if(!CQ_Analytics.StrategyMgr){CQ_Analytics.StrategyMgr=function(){this.strategies={}
};
CQ_Analytics.StrategyMgr.prototype={};
CQ_Analytics.StrategyMgr.prototype.isRegistered=function(a){return !!this.strategies[a]
};
CQ_Analytics.StrategyMgr.prototype.register=function(b,a){if(typeof a=="function"){this.strategies[b]=a
}};
CQ_Analytics.StrategyMgr.prototype.choose=function(b,a){if(a.length==1){return a[0]
}if(this.strategies[b]){return this.strategies[b].call(this,a)
}return null
};
CQ_Analytics.StrategyMgr=new CQ_Analytics.StrategyMgr()
}CQ_Analytics.StrategyMgr.register("clickstream-score",function(l){if(l.length==1){return l[0]
}var a=[];
if(CQ_Analytics.TagCloudMgr){var o=CQ_Analytics.TagCloudMgr.getTags();
o=o||{};
var n=-1;
for(var g=0;
g<l.length;
g++){var k=0;
var m=l[g].tags;
if(m){for(var f=0;
f<m.length;
f++){var h=m[f].tagID;
k+=parseInt(o[h])||0
}}if(k==n){a.push(l[g])
}else{if(k>n){a=[];
a.push(l[g]);
n=k
}}}}else{a=l
}if(a.length==1){return a[0]
}var b=null;
if(CQ_Analytics.PageDataMgr){b=CQ_Analytics.PageDataMgr.getProperty("random")
}if(!b){b=window.CQ_StrategyRandom
}if(!b){b=window.CQ_StrategyRandom=Math.random()
}if(parseFloat(b)>1){b=1/b
}if(parseFloat(b)==1){b=0
}var d=Math.floor(b*a.length);
return a[d]
});
CQ_Analytics.StrategyMgr.register("first",function(a){return a[0]
});
CQ_Analytics.StrategyMgr.register("random",function(d){var a=null;
if(CQ_Analytics.PageDataMgr){a=CQ_Analytics.PageDataMgr.getProperty("random")
}if(!a){a=window.CQ_StrategyRandom
}if(!a){a=window.CQ_StrategyRandom=Math.random()
}if(parseFloat(a)>1){a=1/a
}if(parseFloat(a)==1){a=0
}var b=Math.floor(a*d.length);
return d[b]
});
if(!CQ_Analytics.PageDataMgr){CQ_Analytics.PageDataMgr=function(){};
CQ_Analytics.PageDataMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.PageDataMgr.prototype.STORENAME="pagedata";
CQ_Analytics.PageDataMgr.prototype.FORCE_EXPERIENCE_COOKIE="cq-forceexperience";
CQ_Analytics.PageDataMgr.prototype.init=function(){this.data={};
for(var a in this.initProperty){this.data[a]=this.initProperty[a]
}this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.PageDataMgr.prototype.getLabel=function(a){return a
};
CQ_Analytics.PageDataMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.PageDataMgr.prototype.setExperience=function(a){CQ.shared.HTTP.setCookie(CQ_Analytics.PageDataMgr.FORCE_EXPERIENCE_COOKIE,a,"/")
};
CQ_Analytics.PageDataMgr.prototype.getExperience=function(){return CQ.shared.HTTP.getCookie(CQ_Analytics.PageDataMgr.FORCE_EXPERIENCE_COOKIE,"/")
};
CQ_Analytics.PageDataMgr.prototype.clearExperience=function(){CQ.shared.HTTP.clearCookie(CQ_Analytics.PageDataMgr.FORCE_EXPERIENCE_COOKIE,"/")
};
CQ_Analytics.PageDataMgr=new CQ_Analytics.PageDataMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){this.loadInitProperties(CQ_Analytics.CCM.getInitialData(this.getName()));
this.init();
CQ_Analytics.CCM.register(this)
},CQ_Analytics.PageDataMgr)
}CQ_Analytics.BrowserInfo=function(){var j=navigator.userAgent.toLowerCase();
var f=function(b){return b.test(j)
};
var h=function(){if(f(/opera/)){return{browserFamily:"Opera",browserVersion:""}
}if(f(/chrome/)){return{browserFamily:"Chrome",browserVersion:""}
}if(f(/safari/)){if(f(/applewebkit\/4/)){return{browserFamily:"Safari",browserVersion:"2"}
}if(f(/version\/3/)){return{browserFamily:"Safari",browserVersion:"3"}
}if(f(/version\/4/)){return{browserFamily:"Safari",browserVersion:"4"}
}if(f(/version\/5/)){return{browserFamily:"Safari",browserVersion:"5"}
}if(f(/version\/6/)){return{browserFamily:"Safari",browserVersion:"6"}
}return{browserFamily:"Safari",browserVersion:"7 or higher"}
}if(f(/webkit/)){return{browserFamily:"WebKit",browserVersion:""}
}if(f(/msie/)){if(f(/msie 6/)){return{browserFamily:"IE",browserVersion:"6"}
}if(f(/msie 7/)){return{browserFamily:"IE",browserVersion:"7"}
}if(f(/msie 8/)){return{browserFamily:"IE",browserVersion:"8"}
}if(f(/msie 9/)){return{browserFamily:"IE",browserVersion:"9"}
}if(f(/msie 10/)){return{browserFamily:"IE",browserVersion:"10"}
}return{browserFamily:"IE",browserVersion:"11 or higher"}
}if(f(/gecko/)){if(f(/rv:1\.8/)){return{browserFamily:"Firefox",browserVersion:"2"}
}if(f(/rv:1\.9/)){return{browserFamily:"Firefox",browserVersion:"3"}
}if(f(/rv:2.0/)){return{browserFamily:"Firefox",browserVersion:"4"}
}if(f(/rv:5./)){return{browserFamily:"Firefox",browserVersion:"5"}
}if(f(/rv:6./)){return{browserFamily:"Firefox",browserVersion:"6"}
}if(f(/rv:7./)){return{browserFamily:"Firefox",browserVersion:"7"}
}if(f(/rv:8./)){return{browserFamily:"Firefox",browserVersion:"8"}
}if(f(/rv:9./)){return{browserFamily:"Firefox",browserVersion:"9"}
}return{browserFamily:"Firefox",browserVersion:"10 or higher"}
}var b=f(/adobeair/);
if(b){return{browserFamily:"Adobe AIR",browserVersion:""}
}return{browserFamily:"Unresolved",browserVersion:"Unresolved"}
};
var g=function(){if(f(/windows 98|win98/)){return"Windows 98"
}if(f(/windows nt 5.0|windows 2000/)){return"Windows 2000"
}if(f(/windows nt 5.1|windows xp/)){return"Windows XP"
}if(f(/windows nt 5.2/)){return"Windows Server 2003"
}if(f(/windows nt 6.0/)){return"Windows Vista"
}if(f(/windows nt 6.1/)){return"Windows 7"
}if(f(/windows nt 4.0|winnt4.0|winnt/)){return"Windows NT 4.0"
}if(f(/windows me/)){return"Windows ME"
}if(f(/mac os x/)){if(f(/ipad/)||f(/iphone/)){return"iOS"
}return"Mac OS X"
}if(f(/macintosh|mac os/)){return"Mac OS"
}if(f(/android/)){return"Android"
}if(f(/linux/)){return"Linux"
}return"Unresolved"
};
var d=function(){if(f(/ipad/)){return"iPad"
}if(f(/iphone/)){return"iPhone"
}if(f(/mobi/)){return"Mobile"
}return"Desktop"
};
var a=h.call();
this.browserFamily=a.browserFamily;
this.browserVersion=a.browserVersion;
this.OSName=g.call();
this.deviceType=d.call();
this.ua=j;
var k=/^https/i.test(window.location.protocol);
this.screenResolution=screen.width+"x"+screen.height
};
CQ_Analytics.BrowserInfo.prototype={getBrowserName:function(){return this.browserFamily+" "+this.browserVersion
},getBrowserFamily:function(){return this.browserFamily
},getBrowserVersion:function(){return this.browserVersion
},getOSName:function(){return this.OSName
},getScreenResolution:function(){return this.screenResolution
},getDeviceType:function(){return this.deviceType
},getUserAgent:function(){return this.ua
},isMobile:function(a){if(!a){a=this.getDeviceType()
}a=a?a.toLowerCase():"desktop";
return a!="desktop"
},isIE:function(a){return this.getBrowserFamily()=="IE"&&(a?this.getBrowserVersion()==a:true)
},isIE6:function(){return this.isIE("6")
},isIE7:function(){return this.isIE("7")
},isIE8:function(){return this.isIE("8")
},isIE9:function(){return this.isIE("9")
}};
CQ_Analytics.BrowserInfoInstance=new CQ_Analytics.BrowserInfo();
if(!CQ_Analytics.MousePositionMgr){CQ_Analytics.MousePositionMgr=function(){this.position={x:0,y:0};
this.getPageX=function(d){var b=d.pageX;
if(!b&&0!==b){b=d.clientX||0
}return b
};
this.getPageY=function(b){var d=b.pageY;
if(!d&&0!==d){d=b.clientY||0
}return d
};
var a=this;
this.timer=null;
$CQ(document).bind("mousemove",function(h,g,f,l){var j=h||window.event;
if(j){if(!a.timer){var d=a.getPageX(j);
var k=a.getPageY(j);
a.timer=setTimeout(function(){a.setPosition(d,k);
a.timer=null
},500)
}}});
this.init()
};
CQ_Analytics.MousePositionMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.MousePositionMgr.prototype.STORENAME="mouseposition";
CQ_Analytics.MousePositionMgr.prototype.setPosition=function(a,b){this.position.x=a;
this.position.y=b;
this.fireEvent("update")
};
CQ_Analytics.MousePositionMgr.prototype.getProperty=function(a){return this.position[a]
};
CQ_Analytics.MousePositionMgr.prototype.getLabel=function(a){return a
};
CQ_Analytics.MousePositionMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.MousePositionMgr.prototype.getPropertyNames=function(){var a=new Array();
for(var b in this.position){a.push(b)
}return a
};
CQ_Analytics.MousePositionMgr.prototype.getSessionStore=function(){return this
};
CQ_Analytics.MousePositionMgr.prototype.getData=function(a){return this.position
};
CQ_Analytics.MousePositionMgr.prototype.clear=function(){this.position={}
};
CQ_Analytics.MousePositionMgr=new CQ_Analytics.MousePositionMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this)
},CQ_Analytics.MousePositionMgr)
}if(!CQ_Analytics.EventDataMgr){CQ_Analytics.EventDataMgr=function(){};
CQ_Analytics.EventDataMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.EventDataMgr.prototype.STORENAME="eventdata";
CQ_Analytics.EventDataMgr.prototype.init=function(){this.data={};
for(var a in this.initProperty){this.data[a]=this.initProperty[a]
}this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.EventDataMgr.prototype.getLabel=function(a){return a
};
CQ_Analytics.EventDataMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.EventDataMgr=new CQ_Analytics.EventDataMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){this.loadInitProperties(CQ_Analytics.CCM.getInitialData(this.getName()));
this.init();
CQ_Analytics.CCM.register(this)
},CQ_Analytics.EventDataMgr)
}if(!window.CQ_Context){window.CQ_Context=function(){};
window.CQ_Context.prototype=new CQ_Analytics.Observable();
window.CQ_Context.prototype.getProfile=function(){return(function(){return{getUserId:function(){return this.getProperty("authorizableId")
},getDisplayName:function(){var a=this.getProperty("formattedName");
if(a){return a
}a=this.getProperty("displayName");
if(a){return a
}return this.getUserId()
},getFirstname:function(){return this.getProperty("givenName")
},getLastname:function(){return this.getProperty("familyName")
},getEmail:function(){return this.getProperty("email")
},getProperty:function(a){if(CQ_Analytics&&CQ_Analytics.ProfileDataMgr){return CQ_Analytics.ProfileDataMgr.getProperty(a)
}return""
},getProperties:function(){if(CQ_Analytics&&CQ_Analytics.ProfileDataMgr){return CQ_Analytics.ProfileDataMgr.getData()
}return{}
},getAvatar:function(){return this.getProperty("avatar")
},onUpdate:function(a,b){if(a&&CQ_Analytics&&CQ_Analytics.ProfileDataMgr){CQ_Analytics.ProfileDataMgr.addListener("update",a,b||this)
}}}
})()
};
window.CQ_Context=new window.CQ_Context()
}CQ_Analytics.Engine=function(){window.CQ_trackTeasersStats=true;
function k(){return !!(window.CQ&&CQ.WCM&&CQ.WCM.isEditMode())
}function d(o){var m=$CQ.Deferred();
var n=CQ.WCM.getEditable(o);
if(n){m.resolve(n)
}else{CQ.WCM.onEditableReady(o,function(p){m.resolve(p)
})
}return m.promise()
}function h(n,m){if(!CQ_Analytics.loadedTeasersStack){CQ_Analytics.loadedTeasersStack=[];
$CQ(window).unload(function(){try{var o=CQ_Analytics.loadedTeasersStack;
if(o){delete CQ_Analytics.loadedTeasersStack;
var q=m;
for(var r=0;
r<o.length;
r++){q=CQ.shared.HTTP.addParameter(q,"path",o[r])
}CQ.shared.HTTP.get(q,function(){})
}}catch(p){}})
}CQ_Analytics.loadedTeasersStack.push(n.path)
}function f(s,r,o){var q="",t;
function m(A,z,B,w){return'<a href="'+z+'" class="cq-teaser-segment-link"><img src="'+B+'" class="cq-teaser-decision-thumbnail '+(w?"cq-teaser-decision-match":"cq-teaser-decision-nomatch")+'"></a>'+A+"<br>"
}for(var p=0;
p<s.length;
p++){var n=s[p];
var v=CQ.shared.HTTP.externalize(n.teaser.path+".html");
if(n.hasOwnProperty("boost")){if(n.noSegment){t=CQ.I18n.getMessage("Experience: {0} - match (no segments, boost = {1})",[n.teaser.title,n.boost])
}else{t=CQ.I18n.getMessage("Experience: {0} - match (boost = {1})",[n.teaser.title,n.boost])
}var u=m(t,v,n.teaser.thumbnail,true);
if(r===n.teaser.path){q+="<b>"+u+"</b>"
}else{q+=u
}}else{if(n.unknownSegment){t=CQ.I18n.getMessage("Experience: {0} - no match (unknown segment)",[n.teaser.title])
}else{t=CQ.I18n.getMessage("Experience: {0} - no match",[n.teaser.title])
}q+=m(t,v,n.teaser.thumbnail,false)
}}q+="<br>";
if(o){q+=CQ.I18n.getMessage("Strategy <b>{0}</b> selected current teaser.",o)
}else{q+=CQ.I18n.getMessage("No strategy configured, used the first match.")
}q+="<br>";
return q
}function l(o,n,m,p){o.done(function(q){if(q.teaserToolTip){q.teaserToolTip.hide();
q.teaserToolTip.remove()
}q.teaserToolTip=new CQ.Ext.Tip({html:f(n,m,p),title:CQ.I18n.getMessage("Selection decision"),width:450,autoHide:false,closable:true,height:300,floating:true,autoHeight:false,bodyStyle:"overflow-y: scroll;"});
q.on(CQ.wcm.EditRollover.EVENT_SHOW_HIGHTLIGHT,function(r){if(!this.teaserInfoButton){this.teaserInfoButton=CQ.Ext.DomHelper.append("CQ",{tag:"div",cls:"x-tool x-tool-help cq-teaser-tooltip-tool"},true);
this.teaserInfoButton.position("absolute");
this.teaserInfoButton.on("click",function(){var s=this.getXY();
q.teaserToolTip.setPosition(s[0]-460,s[1]-100);
q.teaserToolTip.show()
})
}this.teaserInfoButton.anchorTo(r.frameBottom.getEl(),"tr",[-26,-15]);
this.teaserInfoButton.show()
});
q.on(CQ.wcm.EditRollover.EVENT_HIDE_HIGHTLIGHT,function(r){if(this.teaserInfoButton){this.teaserInfoButton.hide()
}})
})
}function j(m){m.done(function(n){if(n.teaserToolTip){n.teaserToolTip.hide();
n.teaserToolTip.remove();
n.teaserToolTip=null
}})
}function b(v,u){var q=[];
var s=0;
for(var o=0;
o<v.length;
o++){var n=v[o],r=n.segments;
var m;
if(u){m={teaser:n};
u.push(m)
}var p=!r||r.length===0;
if(p&&m){m.noSegment=true
}if(!p&&CQ_Analytics.SegmentMgr.resolve(r)){p=true;
if(r&&r.length>0){if(!CQ_Analytics.SegmentMgr.segments[r[0]]){p=false;
if(m){m.unknownSegment=true
}}}}if(p){var t=CQ_Analytics.SegmentMgr.getMaxBoost(r);
if(m){m.boost=t
}if(t===s){q.push(n)
}else{if(t>s){q=[];
q.push(n);
s=t
}}}}return q
}var a={};
function g(m,n){CQ_Analytics.Engine.stopTeaserLoader(m);
a[m]=n
}return{stopTeaserLoader:function(n){var m=n.path||n;
if(!m){return
}var o=a[m];
if(o){CQ_Analytics.SegmentMgr.removeListener("update",o);
delete a[m]
}},resolveTeaser:function(p,o,m){var n=b(p,m);
if(n.length===0){return null
}return CQ_Analytics.StrategyMgr.choose(o,n)||n[0]
},loadTeaser:function(m){var p,o;
if(k()){o=CQ.WCM.getEditablePathFromDOM(document.getElementById(m.targetID));
p=d(o)
}var q=ClientContext.get("campaign");
if(q&&q.isCampaignSelected()){return
}var n=function(){var t=CQ_Analytics.PageDataMgr.getExperience();
if(t){CQ_Analytics.PageDataMgr.clearExperience();
var u="/_jcr_content/par.html";
if(k()){u+="?wcmmode=disabled"
}CQ_Analytics.Utils.loadElement(t+u,m.targetID);
return
}var s=null;
var r=function(){var w=null;
if(k()){w=[]
}var z=CQ_Analytics.Engine.resolveTeaser(m.teasers,m.strategy,w);
if(z){if(!s||s.path!==z.path){s=z;
var v=z.url;
if(k()){v+="?wcmmode=disabled"
}CQ_Analytics.Utils.loadTeaserElement(v,m.targetID);
if(window.CQ_trackTeasersStats&&m.trackingURL){h(z,m.trackingURL)
}if(p){l(p,w,s.path,m.strategy)
}}}else{if(p){j(p)
}CQ_Analytics.Utils.clearElement(m.targetID);
s=null
}};
r.call();
if(CQ_Analytics.SegmentMgr){if(o){g(o,r)
}CQ_Analytics.SegmentMgr.addListener("update",r)
}};
if(CQ_Analytics.CCM.areStoresInitialized){n.call(this)
}else{CQ_Analytics.CCM.addListener("storesinitialize",n)
}}}
}();
window.CQ_trackTeasersStats=true;
function initializeTeaserLoader(b,h,j,g,a,f){g=!!(CQ.Ext&&(g=="true"||g===true));
if(window.CQ_Analytics){var d=function(){var p="/_jcr_content/par.html";
if(g){p+="?wcmmode=disabled"
}var n=CQ_Analytics.PageDataMgr.getExperience();
if(n){CQ_Analytics.PageDataMgr.clearExperience();
CQ_Analytics.Utils.loadElement(n+p,j);
return
}var o=function(r){var t="";
var z=new Array();
if(CQ_Analytics.SegmentMgr){var v=0;
for(var s=0;
s<b.length;
s++){var u=CQ.shared.HTTP.externalize(b[s].path+".html");
if(!b[s]["segments"]||b[s]["segments"].length==0||CQ_Analytics.SegmentMgr.resolveArray(b[s]["segments"])===true){var q=CQ_Analytics.SegmentMgr.getMaxBoost(b[s]["segments"]);
var w=[b[s]["title"],q,b[s].thumbnail,u];
if(r==b[s].path){t+=CQ.I18n.getMessage('<b><a href="{3}" class="cq-teaser-segment-link"><img src="{2}" class="cq-teaser-decision-thumbnail cq-teaser-decision-match"></a>Experience: {0} - match ( boost = {1} )</b><br>',w)
}else{t+=CQ.I18n.getMessage('<a href="{3}" class="cq-teaser-segment-link"><img src="{2}" class="cq-teaser-decision-thumbnail cq-teaser-decision-match"></a>Experience: {0} - match ( boost = {1} )<br>',w)
}if(q==v){z.push(b[s])
}else{if(q>v){z=new Array();
z.push(b[s]);
v=q
}}}else{var w=[b[s]["title"],b[s].thumbnail,u];
t+=CQ.I18n.getMessage('<a href="{2}" class="cq-teaser-segment-link"><img src="{1}" class="cq-teaser-decision-thumbnail cq-teaser-decision-nomatch"></a>Experience: {0} - no match<br>',w)
}}}t+=CQ.I18n.getMessage("<br>Strategy <b>{0}</b> selected current teaser.<br>",h);
return t
};
var m=null;
var k=null;
var l=function(){var z=new Array();
if(CQ_Analytics.SegmentMgr){var v=0;
for(var t=0;
t<b.length;
t++){if(!b[t]["segments"]||b[t]["segments"].length==0||CQ_Analytics.SegmentMgr.resolveArray(b[t]["segments"])===true){var q=CQ_Analytics.SegmentMgr.getMaxBoost(b[t]["segments"]);
if(q==v){z.push(b[t])
}else{if(q>v){z=new Array();
z.push(b[t]);
v=q
}}}}}if(z.length>0){var w=z[0];
if(CQ_Analytics.StrategyMgr){var u=CQ_Analytics.StrategyMgr.choose(h,z);
if(u!=null){w=u
}}if(!m||m.path!=w.path){m=w;
var r=w.path+p;
r=CQ.shared.HTTP.addSelectors(r,CQ.shared.HTTP.getSelectors(window.location.href));
CQ_Analytics.Utils.loadTeaserElement(r,j);
if(window.CQ_trackTeasersStats&&a){if(!CQ_Analytics.loadedTeasersStack){CQ_Analytics.loadedTeasersStack=[];
$CQ(window).unload(function(){try{var A=CQ_Analytics.loadedTeasersStack;
if(A){delete CQ_Analytics.loadedTeasersStack;
var C=a;
for(var D=0;
D<A.length;
D++){C=CQ.shared.HTTP.addParameter(C,"path",A[D])
}CQ.shared.HTTP.get(C,function(){})
}}catch(B){}})
}CQ_Analytics.loadedTeasersStack.push(w.path)
}if(g){if(f){var s=CQ.WCM.getEditable(f);
if(s){if(s&&s.teaserToolTip){s.teaserToolTip.hide();
s.teaserToolTip.remove();
s.teaserToolTip=null
}else{s.on(CQ.wcm.EditRollover.EVENT_SHOW_HIGHTLIGHT,function(A){if(!this.teaserInfoButton){this.teaserInfoButton=CQ.Ext.DomHelper.append("CQ",{tag:"div",cls:"x-tool x-tool-help cq-teaser-tooltip-tool"},true);
this.teaserInfoButton.position("absolute");
this.teaserInfoButton.on("click",function(){if(!s.teaserToolTip){s.teaserToolTip=new CQ.Ext.Tip({html:o(m.path),title:CQ.I18n.getMessage("Selection decision"),width:450,autoHide:false,closable:true,height:300,floating:true,autoHeight:false,bodyStyle:"overflow-y: scroll;"})
}var B=this.getXY();
s.teaserToolTip.setPosition(B[0]-460,B[1]-100);
s.teaserToolTip.show()
})
}this.teaserInfoButton.anchorTo(A.frameBottom.getEl(),"tr",[-26,-15]);
this.teaserInfoButton.show()
});
s.on(CQ.wcm.EditRollover.EVENT_HIDE_HIGHTLIGHT,function(A){if(this.teaserInfoButton){this.teaserInfoButton.hide()
}})
}}}}}}else{if(g){var s=CQ.WCM.getEditable(f);
if(s&&s.teaserToolTip){s.teaserToolTip.hide();
s.teaserToolTip.remove();
s.teaserToolTip=null
}}CQ_Analytics.Utils.clearElement(j);
m=null
}};
l.call();
if(CQ_Analytics.SegmentMgr){CQ_Analytics.SegmentMgr.addListener("update",l)
}};
if(CQ_Analytics.CCM.areStoresInitialized){d.call(this)
}else{CQ_Analytics.CCM.addListener("storesinitialize",d)
}}}window.CQ_trackLandingPagesStats=true;
function initializeLandingPageLoader(h,f,g,d,a){d=CQ.Ext&&(d=="true"||d===true);
if(window.CQ_Analytics){var j=".html";
var b=function(){var l=null;
var k=function(){var n=new Array();
if(CQ_Analytics.SegmentMgr){var u=0;
for(var r=0;
r<h.length;
r++){if(!h[r]["segments"]||h[r]["segments"].length==0||CQ_Analytics.SegmentMgr.resolveArray(h[r]["segments"])===true){var z=CQ_Analytics.SegmentMgr.getMaxBoost(h[r]["segments"]);
if(z==u){n.push(h[r])
}else{if(z>u){n=new Array();
n.push(h[r]);
u=z
}}}}}if(n.length>0){var q=n[0];
if(CQ_Analytics.StrategyMgr){var v=CQ_Analytics.StrategyMgr.choose(f,n);
if(v!=null){q=v
}}if(!l||l.path!=q.path){var B=l;
l=q;
var p=CQ.shared.HTTP.get(q.path+j);
var C=p.responseText;
var s=function(O,E){var L="";
if(O&&O.indexOf('id="'+E+'"')!=-1){var K=O.indexOf('id="'+E+'"');
var F=O.substring(0,K).lastIndexOf("<div");
var J=O.substring(F);
var N=J.split(new RegExp("<div","ig"));
var H=0;
for(var I=0;
I<N.length;
I++){H++;
var M=N[I].split(new RegExp("</div","ig"));
for(var G=1;
G<M.length;
G++){H--;
if(H==1){var D=N[I].lastIndexOf("</div")+6;
D=J.indexOf(N[I])+D;
J=J.substring(0,D);
J=J.substring(J.indexOf(">")+1,J.lastIndexOf("</div"));
return J
}}}}return""
};
C=s(C,g);
var w=$CQ("#"+g)[0];
var t=function(F,D){if(d){var G=CQ.WCM.getEditables();
for(var H in G){var E=G[H];
if(!F||E.path.indexOf(F)!=-1){E.hide();
E.remove()
}}}};
var o=document.createElement("div");
o.innerHTML=C;
if(B){$CQ("object",w).parent().fadeOut("slow");
$CQ("img",w).fadeOut("slow");
$CQ(w).slideUp("slow",function(){t(B.path,false);
$CQ(w).children().remove();
var D=w.insertBefore(o,w.firstChild);
$CQ(w).slideDown("slow",function(){if(d){CQ.DOM.executeScripts(CQ.Ext.get(o))
}})
})
}else{var m=w.insertBefore(o,w.firstChild);
$CQ(w).slideDown("slow",function(){if(d){CQ.DOM.executeScripts(CQ.Ext.get(o))
}})
}try{if(window.CQ_trackLandingPagesStats&&a){if(!CQ_Analytics.loadedLandingPagesStack){CQ_Analytics.loadedLandingPagesStack=[];
$CQ(window).unload(function(){try{var G=CQ_Analytics.loadedLandingPagesStack;
if(G){delete CQ_Analytics.loadedLandingPagesStack;
var E=a;
for(var F=0;
F<G.length;
F++){E=CQ.shared.HTTP.addParameter(E,"path",G[F])
}CQ.shared.HTTP.get(E,function(){})
}}catch(D){}})
}CQ_Analytics.loadedLandingPagesStack.push(q.path)
}}catch(A){}}}else{CQ_Analytics.Utils.clearElement(g);
l=null
}};
k.call();
if(CQ_Analytics.SegmentMgr){CQ_Analytics.SegmentMgr.addListener("update",k)
}};
if(CQ_Analytics.ClickstreamcloudMgr){if(CQ_Analytics.ClickstreamcloudMgr.areStoresLoaded){b.call(this)
}else{CQ_Analytics.ClickstreamcloudMgr.addListener("storesloaded",b)
}}}}CQ_Analytics.PersistedJSONStore=function(){};
CQ_Analytics.PersistedJSONStore.prototype=new CQ_Analytics.PersistedSessionStore();
CQ_Analytics.PersistedJSONStore.prototype.STOREKEY="";
CQ_Analytics.PersistedJSONStore.prototype.STORENAME="";
CQ_Analytics.PersistedJSONStore.prototype.init=function(){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var b=a.get(this.getStoreKey());
if(!b||b==""){this.data={};
for(var d in this.initProperty){this.data[d]=this.initProperty[d]
}}else{this.data=this.parse(b)
}this.persist();
this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.PersistedJSONStore.prototype.clear=function(){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
a.remove(this.getStoreKey());
this.data=null;
this.initProperty={}
};
CQ_Analytics.PersistedJSONStore.prototype.initJSON=function(b,d){if(!d){this.initProperty={}
}var a=function(j,f,h){for(var g in h){if(typeof h[g]=="object"){a(j,f?f+"/"+g:g,h[g])
}else{j[f?f+"/"+g:g]=h[g]
}}};
a(this.initProperty,null,b)
};
CQ_Analytics.PersistedJSONStore.prototype.getJSON=function(){var g=this.getData();
var d={};
for(var j in g){var f=j.split("/");
var h=d;
for(var b=0;
b<f.length;
b++){var a=f[b];
if(b==f.length-1){h[a]=g[j]
}else{h[a]=h[a]||{};
h=h[a]
}}}return d
};
CQ_Analytics.PersistedJSONStore.getInstance=function(a,d){var b=new CQ_Analytics.PersistedJSONStore();
b.STOREKEY=a.toUpperCase();
b.STORENAME=a;
b.initJSON(d);
return b
};
CQ_Analytics.PersistedJSONStore.registerNewInstance=function(a,b){var d=CQ_Analytics.PersistedJSONStore.getInstance(a,b);
d.init();
CQ_Analytics.CCM.register(d);
return d
};
CQ_Analytics.JSONStore=function(){};
CQ_Analytics.JSONStore.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.JSONStore.prototype.STOREKEY="";
CQ_Analytics.JSONStore.prototype.STORENAME="";
CQ_Analytics.JSONStore.prototype.init=function(){this.data={};
for(var a in this.initProperty){this.data[a]=this.initProperty[a]
}this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.JSONStore.prototype.clear=function(){this.data=null;
this.initProperty={}
};
CQ_Analytics.JSONStore.prototype.initJSON=function(b,d){if(!d){this.initProperty={}
}var a=function(j,f,h){for(var g in h){if(typeof h[g]=="object"){a(j,f?f+"/"+g:g,h[g])
}else{j[f?f+"/"+g:g]=h[g]
}}};
a(this.initProperty,null,b)
};
CQ_Analytics.JSONStore.prototype.getJSON=function(){var g=this.getData();
var d={};
for(var j in g){var f=j.split("/");
var h=d;
for(var b=0;
b<f.length;
b++){var a=f[b];
if(b==f.length-1){h[a]=g[j]
}else{h[a]=h[a]||{};
h=h[a]
}}}return d
};
CQ_Analytics.JSONStore.getInstance=function(a,d){var b=new CQ_Analytics.JSONStore();
b.STOREKEY=a.toUpperCase();
b.STORENAME=a;
b.initJSON(d);
return b
};
CQ_Analytics.JSONStore.registerNewInstance=function(a,b){var d=CQ_Analytics.JSONStore.getInstance(a,b);
d.init();
CQ_Analytics.CCM.register(d);
return d
};
CQ_Analytics.PersistedJSONPStore=function(){};
CQ_Analytics.PersistedJSONPStore.prototype=new CQ_Analytics.PersistedJSONStore();
CQ_Analytics.PersistedJSONPStore.prototype.setServiceURL=function(a){this.serviceURL=a
};
CQ_Analytics.PersistedJSONPStore.prototype.getServiceURL=function(){return this.serviceURL
};
CQ_Analytics.PersistedJSONPStore.prototype.load=function(f,a,g){var d=this.getName();
if(!CQ_Analytics.PersistedJSONPStore.JSONPCallbacks[this.getName()]){CQ_Analytics.PersistedJSONPStore.JSONPCallbacks[d]=function(j){var h=CQ_Analytics.CCM.getRegisteredStore(d);
if(h){h.initJSON(j);
if(a){h.initJSON(a,true)
}}if(g){g.call(h)
}}
}if(f){this.setServiceURL(f)
}var b=this.serviceURL;
b=b.replace("${callback}","CQ_Analytics.PersistedJSONPStore.JSONPCallbacks."+d);
$CQ.getScript(b)
};
CQ_Analytics.PersistedJSONPStore.JSONPCallbacks={};
CQ_Analytics.PersistedJSONPStore.getInstance=function(g,h,b,a,f){if(g&&h){try{var j=new CQ_Analytics.PersistedJSONPStore();
j.STOREKEY=g.toUpperCase();
j.STORENAME=g;
if(h){j.setServiceURL(h)
}if(!a){j.load(h,b,f)
}return j
}catch(d){console.log("Cannot create the JSONP store",g,h,d)
}}return null
};
CQ_Analytics.PersistedJSONPStore.registerNewInstance=function(f,g,b,h){if(!g){return null
}if(!f){var a=CQ.shared.HTTP.getSchemeAndAuthority(g);
if(a){if(a.indexOf(".")!=-1){a=a.substring(0,a.lastIndexOf("."));
f=a.substring(a.lastIndexOf(".")+1)
}else{f=a.substring(a.lastIndexOf("/")+1)
}}else{f=g
}}var d=CQ_Analytics.PersistedJSONPStore.getInstance(f,g,b,false,function(){this.init();
this.reset();
if(h){h.call(this)
}});
if(d!=null){CQ_Analytics.CCM.register(d);
return d
}return null
};
CQ_Analytics.JSONPStore=function(){};
CQ_Analytics.JSONPStore.prototype=new CQ_Analytics.JSONStore();
CQ_Analytics.JSONPStore.prototype.setServiceURL=function(a){this.serviceURL=a
};
CQ_Analytics.JSONPStore.prototype.getServiceURL=function(){return this.serviceURL
};
CQ_Analytics.JSONPStore.prototype.load=function(f,a,g){var d=this.getName();
if(!CQ_Analytics.JSONPStore.JSONPCallbacks[this.getName()]){CQ_Analytics.JSONPStore.JSONPCallbacks[d]=function(j){var h=CQ_Analytics.CCM.getRegisteredStore(d);
if(h){h.initJSON(j);
if(a){h.initJSON(a,true)
}}if(g){g.call(h)
}}
}if(f){this.setServiceURL(f)
}var b=this.serviceURL;
b=b.replace("${callback}","CQ_Analytics.JSONPStore.JSONPCallbacks."+d);
$CQ.getScript(b)
};
CQ_Analytics.JSONPStore.JSONPCallbacks={};
CQ_Analytics.JSONPStore.getInstance=function(g,h,b,a,f){if(g){try{var j=new CQ_Analytics.JSONPStore();
j.STOREKEY=g.toUpperCase();
j.STORENAME=g;
if(h){j.setServiceURL(h);
if(!a){j.load(h,b,f)
}}return j
}catch(d){console.log("Cannot create the JSONP store",g,h,d)
}}return null
};
CQ_Analytics.JSONPStore.registerNewInstance=function(f,g,b,h){if(!f&&g){var a=CQ.shared.HTTP.getSchemeAndAuthority(g);
if(a){if(a.indexOf(".")!=-1){a=a.substring(0,a.lastIndexOf("."));
f=a.substring(a.lastIndexOf(".")+1)
}else{f=a.substring(a.lastIndexOf("/")+1);
f=f.replace(new RegExp(":","ig"),"_")
}}else{f=g
}}var d=CQ_Analytics.JSONPStore.getInstance(f,g,b,false,function(){this.init();
this.reset();
if(h){h.call(this)
}});
if(d!=null){CQ_Analytics.CCM.register(d);
return d
}return null
};
CQ_Analytics.storeData=function(g,A){var q=function(p,l){for(var k=0;
k<CQ_Analytics.Sitecatalyst.frameworkMappings.length;
k++){var j=CQ_Analytics.Sitecatalyst.frameworkMappings[k];
if(j[p]===l){return j
}}return null
};
var u=function(j){if(typeof j==="string"){return j.replace(/[,;=\|]/g,"")
}return j
};
for(var z in A){if(z!=="product"){var r=z.indexOf(".");
var t=(r>0)?z.substr(0,r-1):undefined;
var B=(r>0)?z.substr(r):z;
if(t&&CQ_Analytics.StoreRegistry.getStore(t)){g=CQ_Analytics.StoreRegistry.getStore(t)
}g.setProperty(B,A[z])
}else{var o=["category","sku","quantity","price","events","evars"];
var d=g.getProperty("products").split(",");
d=(d[0]=="")?new Array():d;
var A=(A[z] instanceof Array)?A[z]:[A[z]];
for(var n=0;
n<A.length;
n++){var s=A[n];
var b=new Array(6);
for(var w in s){var r=o.indexOf(w);
if(r>-1){if(r<4){b[r]=u(s[w])
}else{var h=[];
for(var v in s[w]){var f=g.getName()+"."+z+"."+w+"."+v;
var m=q("cqVar",f);
if(m){h.push(m.scVar+"="+u(s[w][v]));
var a=g.getProperty("events").split("\u2026");
if(a.indexOf(m.cqVar)<0){a.push(m.cqVar.replace(/.+\./,""));
g.setProperty("events",a.join("\u2026"))
}}}b[r]=h.join("|")
}}}d.push(b.join(";"))
}g.setProperty("products",d.join(","))
}}};
CQ_Analytics.record=function(b){if(b.collect){return[b.event,b.values]
}else{if(b.event){b.options=b.options||{};
try{CQ_Analytics.recordBeforeCallbacks.sort(function(h,g){return h.rank-g.rank
});
for(var f in CQ_Analytics.recordBeforeCallbacks){if(CQ_Analytics.recordBeforeCallbacks[f].func.call(this,b)){return
}}}catch(d){}var a=b.dataMgr||CQ_Analytics.EventDataMgr;
a.reset();
if(typeof b.event=="string"){a.setProperty("events",b.event)
}else{a.setProperty("events",b.event.join("\u2026"))
}if(b.values){CQ_Analytics.storeData(a,b.values)
}try{CQ_Analytics.recordAfterCallbacks.sort(function(h,g){return h.rank-g.rank
});
for(var f in CQ_Analytics.recordAfterCallbacks){if(CQ_Analytics.recordAfterCallbacks[f].func.call(this,b)){return
}}}catch(d){}}}};
CQ_Analytics.recordBeforeCallbacks=[];
CQ_Analytics.recordAfterCallbacks=[];
CQ_Analytics.registerBeforeCallback=function(b,a){CQ_Analytics.recordBeforeCallbacks.push({rank:a,func:b})
};
CQ_Analytics.registerAfterCallback=function(b,a){CQ_Analytics.recordAfterCallbacks.push({rank:a,func:b})
};
if(!CQ_Analytics.ClientContext){CQ_Analytics.ClientContext=new function(){return{get:function(h,d){if(h){if(h.indexOf("/")!=0){h="/"+h
}var f=h.split("/")[1];
var b=h.substring(h.indexOf("/"+f)+f.length+2,h.length);
var a=CQ_Analytics.CCM.getRegisteredStore(f);
if(a){if(b){var g=a.getProperty(b);
if(g&&d){g=CQ_Analytics.Variables.replaceVariables(g)
}return g
}return a
}}return null
},set:function(g,f){if(g){if(g.indexOf("/")!=0){g="/"+g
}var d=g.split("/")[1];
var b=g.substring(g.indexOf("/"+d)+d.length+2,g.length);
var a=CQ_Analytics.CCM.getRegisteredStore(d);
if(a){if(b){a.setProperty(b,f)
}}}},clear:function(){var a=CQ_Analytics.CCM.getStores();
if(a){for(var b in a){if(a[b].clear){a[b].clear()
}}}},reset:function(){var a=CQ_Analytics.CCM.getStores();
if(a){for(var b in a){if(a[b].reset){a[b].reset()
}}}},persist:function(a){CQ_Analytics.ClientContextMgr.ServerStorage.post(a,true)
}}
}();
window.ClientContext=CQ_Analytics.ClientContext;
window.ContextCloud=CQ_Analytics.ClientContext
}if(CQ_Analytics&&!CQ_Analytics.TwitterProfileDataMgr){CQ_Analytics.TwitterProfileDataMgr=function(){};
CQ_Analytics.TwitterProfileDataMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.TwitterProfileDataMgr.prototype.STOREKEY="TWITTERPROFILEDATA";
CQ_Analytics.TwitterProfileDataMgr.prototype.STORENAME="twitterprofile";
CQ_Analytics.TwitterProfileDataMgr.prototype.clear=function(){this.data=null;
this.initProperty={}
};
CQ_Analytics.TwitterProfileDataMgr.prototype.init=function(){if(!this.data){this.data={};
for(var a in this.initProperty){this.data[a]=this.initProperty[a]
}}};
CQ_Analytics.TwitterProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/twitterprofiledata/loader.json")
};
CQ_Analytics.TwitterProfileDataMgr.prototype.loadProfile=function(authorizableId){if(authorizableId){CQ_Analytics.TwitterProfileDataMgr.lastUid=authorizableId;
var url=this.getLoaderURL();
url=CQ_Analytics.Utils.addParameter(url,"authorizableId",authorizableId);
try{var object=CQ.shared.HTTP.eval(url);
if(object){this.data={};
for(var p in object){this.data[p]=object[p]
}this.fireEvent("update");
if(CQ_Analytics.ClickstreamcloudEditor){CQ_Analytics.ClickstreamcloudEditor.reload()
}return true
}}catch(error){if(console&&console.log){console.log("Error during profile loading",error)
}}}return false
};
CQ_Analytics.TwitterProfileDataMgr=new CQ_Analytics.TwitterProfileDataMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var a=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");
if(a!=this.lastUid){CQ_Analytics.TwitterProfileDataMgr.loadProfile(a);
this.fireEvent("update")
}},CQ_Analytics.TwitterProfileDataMgr);
CQ_Analytics.CCM.register(this)
},CQ_Analytics.TwitterProfileDataMgr)
}if(!CQ_Analytics.FacebookProfileDataMgr){CQ_Analytics.FacebookProfileDataMgr=function(){};
CQ_Analytics.FacebookProfileDataMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.FacebookProfileDataMgr.prototype.STOREKEY="FBPROFILEDATA";
CQ_Analytics.FacebookProfileDataMgr.prototype.STORENAME="facebookprofile";
CQ_Analytics.FacebookProfileDataMgr.prototype.clear=function(){this.data=null;
this.initProperty={}
};
CQ_Analytics.FacebookProfileDataMgr.prototype.init=function(){if(!this.data){this.data={};
for(var a in this.initProperty){this.data[a]=this.initProperty[a]
}}};
CQ_Analytics.FacebookProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/fbprofiledata/loader.json")
};
CQ_Analytics.FacebookProfileDataMgr.prototype.loadProfile=function(authorizableId){if(authorizableId){CQ_Analytics.FacebookProfileDataMgr.lastUid=authorizableId;
var url=this.getLoaderURL();
url=CQ_Analytics.Utils.addParameter(url,"authorizableId",authorizableId);
try{var object=CQ.shared.HTTP.eval(url);
if(object){this.data={};
for(var p in object){this.data[p]=object[p]
}this.fireEvent("update");
this.fireEvent("checkBirthday");
if(CQ_Analytics.ClickstreamcloudEditor){CQ_Analytics.ClickstreamcloudEditor.reload()
}return true
}}catch(error){if(console&&console.log){console.log("Error during profile loading",error)
}}}return false
};
CQ_Analytics.FacebookProfileDataMgr=new CQ_Analytics.FacebookProfileDataMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var a=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");
if(a!=this.lastUid){CQ_Analytics.FacebookProfileDataMgr.loadProfile(a);
this.fireEvent("update")
}},CQ_Analytics.FacebookProfileDataMgr);
CQ_Analytics.CCM.register(this)
},CQ_Analytics.FacebookProfileDataMgr)
}if(!CQ_Analytics.FacebookInterestsMgr){CQ_Analytics.FacebookInterestsMgr=function(){};
CQ_Analytics.FacebookInterestsMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.FacebookInterestsMgr.prototype.STOREKEY="FBINTERESTSDATA";
CQ_Analytics.FacebookInterestsMgr.prototype.STORENAME="fbinterests";
CQ_Analytics.FacebookInterestsMgr.prototype.getLabel=function(a){return a
};
CQ_Analytics.FacebookInterestsMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.FacebookInterestsMgr.prototype.clear=function(){this.data=null;
this.initProperty={}
};
CQ_Analytics.FacebookInterestsMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/fbinterestsdata/loader.json")
};
CQ_Analytics.FacebookInterestsMgr.prototype.loadProfile=function(authorizableId){if(authorizableId){var url=this.getLoaderURL();
url=CQ_Analytics.Utils.addParameter(url,"authorizableId",authorizableId);
CQ_Analytics.FacebookInterestsMgr.lastUid=authorizableId;
try{var object=CQ.shared.HTTP.eval(url);
if(object){this.data={};
for(var p in object){this.data[p]=object[p]
}if(CQ_Analytics.ClickstreamcloudEditor){CQ_Analytics.ClickstreamcloudEditor.reload()
}return true
}}catch(error){if(console&&console.log){console.log("Error during profile loading",error)
}}}return false
};
CQ_Analytics.FacebookInterestsMgr=new CQ_Analytics.FacebookInterestsMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.ProfileDataMgr.addListener("update",function(){var a=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");
if(a!=this.lastUid){CQ_Analytics.FacebookInterestsMgr.loadProfile(a);
this.fireEvent("update")
}},CQ_Analytics.FacebookInterestsMgr);
CQ_Analytics.CCM.register(this)
},CQ_Analytics.FacebookInterestsMgr)
}if(CQ_Analytics&&!CQ_Analytics.SalesforceProfileDataMgr){CQ_Analytics.SalesforceProfileDataMgr=function(){};
CQ_Analytics.SalesforceProfileDataMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.SalesforceProfileDataMgr.prototype.STOREKEY="SALESFORCEPROFILEDATA";
CQ_Analytics.SalesforceProfileDataMgr.prototype.STORENAME="salesforceprofile";
CQ_Analytics.SalesforceProfileDataMgr.prototype.clear=function(){this.data=null;
this.initProperty={}
};
CQ_Analytics.SalesforceProfileDataMgr.prototype.init=function(){if(!this.data){this.data={};
for(var a in this.initProperty){this.data[a]=this.initProperty[a]
}}};
CQ_Analytics.SalesforceProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/salesforceprofiledata/loader.json")
};
CQ_Analytics.SalesforceProfileDataMgr.prototype.loadProfile=function(authorizableId){CQ_Analytics.SalesforceProfileDataMgr.lastUid=authorizableId;
var url=this.getLoaderURL();
url=CQ_Analytics.Utils.addParameter(url,"authorizableId",authorizableId);
try{var object=CQ.shared.HTTP.eval(url);
if(object){this.data={};
for(var p in object){this.data[p]=object[p]
}this.fireEvent("update");
if(CQ_Analytics.ClickstreamcloudEditor){CQ_Analytics.ClickstreamcloudEditor.reload()
}return true
}}catch(error){if(console&&console.log){console.log("Error during profile loading",error)
}}return false
};
CQ_Analytics.SalesforceProfileDataMgr=new CQ_Analytics.SalesforceProfileDataMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this)
},CQ_Analytics.SalesforceProfileDataMgr)
}if(!CQ_Analytics.ViewedProducts){CQ_Analytics.ViewedProducts=function(){this.data=null;
this.MAX_COUNT=20
};
CQ_Analytics.ViewedProducts.prototype=new CQ_Analytics.PersistedSessionStore();
CQ_Analytics.ViewedProducts.prototype.STOREKEY="VIEWEDPRODUCTS";
CQ_Analytics.ViewedProducts.prototype.STORENAME="viewedproducts";
CQ_Analytics.ViewedProducts.prototype.record=function(f,g,d,b){if(!this.data){this.init()
}for(var a=0;
a<this.data.length;
a++){if(this.data[a].path==f){this.data.splice(a,1);
break
}}if(this.data.length==this.MAX_COUNT){this.data.shift()
}this.data.push({path:f,title:g,image:d,price:b});
this.persist();
this.fireEvent("update")
};
CQ_Analytics.ViewedProducts.prototype.mostRecent=function(){if(!this.data){this.init()
}if(this.data.length>0){return this.data[this.data.length-1]
}else{return null
}};
CQ_Analytics.ViewedProducts.prototype.mostRecentNotInCart=function(){if(!this.data){this.init()
}if(!CQ_Analytics.CartMgr){return this.mostRecent()
}for(var a=this.data.length-1;
a>=0;
a--){var b=this.data[a];
if(!CQ_Analytics.CartHelper.containsProduct(CQ_Analytics.CartMgr.getData(),b.path,1)){return b
}}return null
};
CQ_Analytics.ViewedProducts.prototype.recent=function(g,b){var a=[];
if(!this.data){this.init()
}if(!CQ_Analytics.CartMgr){b=false
}for(var d=this.data.length-1;
d>=0&&g>0;
d--){var f=this.data[d];
if(b&&CQ_Analytics.CartHelper.containsProduct(CQ_Analytics.CartMgr.getData(),f.path,1)){continue
}a.push(f);
g--
}return a
};
CQ_Analytics.ViewedProducts.prototype.getData=function(a){if(!this.data){this.init()
}return this.data
};
CQ_Analytics.ViewedProducts.prototype.init=function(){var b=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var f=b.get(this.getStoreKey());
f=f===null?"":new String(f);
var g=f.split(";");
this.data=[];
for(var d=0;
d<g.length;
d++){var a=g[d].split(",");
if(a.length>=4){this.data.push({path:a[0],title:a[1],image:a[2],price:a[3]})
}else{if(a.length>=3){this.data.push({path:a[0],title:a[1],image:a[2],price:undefined})
}}}this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.ViewedProducts.prototype.persist=function(){if(this.fireEvent("beforepersist")!==false){var b=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var g=[];
for(var d=0;
d<this.data.length;
d++){var f=this.data[d];
var a=f.path+","+f.title+","+f.image;
if(f.price){a+=","+f.price
}g.push(a)
}b.set(this.getStoreKey(),g.join(";"));
this.fireEvent("persist")
}};
CQ_Analytics.ViewedProducts.prototype.reset=function(){this.clear();
this.fireEvent("update")
};
CQ_Analytics.ViewedProducts.prototype.clear=function(){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
a.remove(this.getStoreKey());
this.data=[]
};
CQ_Analytics.ViewedProducts=new CQ_Analytics.ViewedProducts();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this)
},CQ_Analytics.ViewedProducts)
}if(!CQ_Analytics.TagCloudMgr){CQ_Analytics.TagCloudMgr=function(){this.data=null;
this.addedTags={};
this.frequencies=null;
this.initialTags=null;
this.initialAddedTags={};
this.copyObject=function(d){var b={};
for(var a in d){b[a]=d[a]
}return b
}
};
CQ_Analytics.TagCloudMgr.prototype=new CQ_Analytics.PersistedSessionStore();
CQ_Analytics.TagCloudMgr.prototype.STOREKEY="TAGCLOUD";
CQ_Analytics.TagCloudMgr.prototype.STORENAME="tagcloud";
CQ_Analytics.TagCloudMgr.prototype.parseTagList=function(a){var d={};
var b=a.split(",");
for(var f in b){if(b.hasOwnProperty(f)){var g=b[f].split("=");
if(g.length==2){d[g[0]]=parseInt(g[1])
}}}return d
};
CQ_Analytics.TagCloudMgr.prototype.parseString=function(a){this.data=this.parseTagList(a);
return this
};
CQ_Analytics.TagCloudMgr.prototype.add=function(a){this.addedTags[a]=true;
this.data[a]=(this.data[a]||0)+1
};
CQ_Analytics.TagCloudMgr.prototype.each=function(b){for(var a in this.data){if(this.data.hasOwnProperty(a)){b(a,this.data[a])
}}};
CQ_Analytics.TagCloudMgr.prototype.calculateFrequencies=function(){var d={};
var a=[];
this.each(function(f,g){if(!d[g]){a.push(g)
}d[g]=true
});
a.sort(function b(g,f){if(g>f){return 1
}if(g<f){return -1
}return 0
});
return a
};
CQ_Analytics.TagCloudMgr.prototype.calculateNtile=function(b,d){if(this.frequencies===null){this.frequencies=this.calculateFrequencies()
}var a=0;
while(true){if((a>=(this.frequencies.length-1))||(this.frequencies[a]>=b)){return Math.ceil((a+1)/this.frequencies.length*d)
}a++
}};
CQ_Analytics.TagCloudMgr.prototype.getTags=function(){return this.data
};
CQ_Analytics.TagCloudMgr.prototype.getData=function(a){return this.getTags()
};
CQ_Analytics.TagCloudMgr.prototype.getTag=function(a){return this.data[a]>0?this.data[a]:0
};
CQ_Analytics.TagCloudMgr.prototype.init=function(a){var b=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var f=b.get(this.getStoreKey());
f=f===null?"":new String(f);
this.data=this.parseTagList(f);
if(a){for(var d in a){if(a.hasOwnProperty(d)){this.add(a[d])
}}}this.initialTags=this.copyObject(this.data);
this.initialAddedTags=this.copyObject(this.addedTags);
this.persist();
this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.TagCloudMgr.prototype.setProperty=function(a,b){if(this.data==null){this.init()
}if(b>0){this.addedTags[a]=true;
this.data[a]=b>0?b:0
}else{delete this.addedTags[a];
delete this.data[a]
}this.persist();
this.fireEvent("update")
};
CQ_Analytics.TagCloudMgr.prototype.reset=function(){this.clear();
this.fireEvent("update")
};
CQ_Analytics.TagCloudMgr.prototype.getProperty=function(a){if(this.data==null){this.init()
}return this.data[a]>0?this.data[a]:0
};
CQ_Analytics.TagCloudMgr.prototype.removeProperty=function(a){if(this.data==null){this.init()
}this.setProperty(a,0)
};
CQ_Analytics.TagCloudMgr.prototype.clear=function(){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
a.remove(this.getStoreKey());
this.addedTags={};
this.data={}
};
CQ_Analytics.TagCloudMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.TagCloudMgr.prototype.getLabel=function(b){if(b){var d=b.split(":");
var a=d[d.length-1].split("/");
b=a[a.length-1]
}return b
};
CQ_Analytics.TagCloudMgr=new CQ_Analytics.TagCloudMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this)
},CQ_Analytics.TagCloudMgr)
}if(!CQ_Analytics.SurferInfoMgr){CQ_Analytics.SurferInfoMgr=function(){};
CQ_Analytics.SurferInfoMgr.prototype=new CQ_Analytics.SessionStore();
CQ_Analytics.SurferInfoMgr.prototype.STOREKEY="SURFERINFO";
CQ_Analytics.SurferInfoMgr.prototype.STORENAME="surferinfo";
CQ_Analytics.SurferInfoMgr.prototype.init=function(){this.data={};
for(var a in this.initProperty){this.data[a]=this.initProperty[a]
}this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.SurferInfoMgr.prototype.clear=function(){this.data=null;
this.initProperty={}
};
CQ_Analytics.SurferInfoMgr.prototype.getLabel=function(a){return a
};
CQ_Analytics.SurferInfoMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.SurferInfoMgr=new CQ_Analytics.SurferInfoMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){var b=CQ_Analytics.BrowserInfoInstance;
this.addInitProperty("browserFamily",b.getBrowserFamily());
this.addInitProperty("browserVersion",b.getBrowserVersion());
this.addInitProperty("browser","${/surferinfo/browserFamily} ${/surferinfo/browserVersion}");
this.addInitProperty("OS",b.getOSName());
this.addInitProperty("resolution",b.getScreenResolution());
this.addInitProperty("device",b.getDeviceType());
this.addInitProperty("isMobile",b.isMobile());
this.addInitProperty("userAgent",b.getUserAgent());
var a=new Date();
this.addInitProperty("day",a.getDate());
this.addInitProperty("month",a.getMonth()+1);
this.addInitProperty("year",a.getFullYear());
this.addInitProperty("hours",a.getHours());
this.addInitProperty("minutes",a.getMinutes());
var d="${/surferinfo/browserFamily}";
if(b.isMobile()){d="${/surferinfo/device}"
}this.addInitProperty("image",d);
var f=CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/surferinfo/resources/${/surferinfo/image}.png");
this.addInitProperty("thumbnail",f);
if(CQ_Analytics.MousePositionMgr){CQ_Analytics.MousePositionMgr.addListener("update",function(){this.setProperty("mouse X",CQ_Analytics.MousePositionMgr.getProperty("x"));
this.setProperty("mouse Y",CQ_Analytics.MousePositionMgr.getProperty("y"))
},this)
}this.addListener("update",function(){var h=this.getProperty("device");
var j="${/surferinfo/browserFamily}";
if(b.isMobile(h)){j="${/surferinfo/device}"
}var g=this.getProperty("image");
if(g!=j){this.setProperty("image",j)
}},this);
CQ_Analytics.CCM.register(this)
},CQ_Analytics.SurferInfoMgr)
}if(!CQ_Analytics.SocialGraphMgr){CQ_Analytics.SocialGraphMgr=CQ_Analytics.JSONPStore.registerNewInstance("socialgraph");
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this);
CQ_Analytics.ProfileDataMgr.addListener("update",function(){var a=CQ_Analytics.ProfileDataMgr.getProperty("authorizableId");
if(a!=this.lastUid){this.fireEvent("update")
}},CQ_Analytics.SocialGraphMgr)
},CQ_Analytics.SocialGraphMgr)
}if(CQ_Analytics.SegmentMgr&&!CQ_Analytics.SegmentMgr.isResolvedRegistered){CQ_Analytics.SegmentMgr.isResolvedRegistered=true;
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.StoreRegistry.register(CQ_Analytics.SegmentMgr);
CQ_Analytics.CCM.fireEvent("storeregister",CQ_Analytics.SegmentMgr)
},CQ_Analytics.SegmentMgr)
}if(!CQ_Analytics.ProfileDataMgr){CQ_Analytics.ProfileDataMgr=function(){this.addListener("beforepersist",function(){this.checkAuthorizableId()
},this)
};
CQ_Analytics.ProfileDataMgr.prototype=new CQ_Analytics.PersistedSessionStore();
CQ_Analytics.ProfileDataMgr.prototype.STOREKEY="PROFILEDATA";
CQ_Analytics.ProfileDataMgr.prototype.STORENAME="profile";
CQ_Analytics.ProfileDataMgr.prototype.LOADER_PATH=CQ_Analytics.Utils.externalize("/libs/cq/personalization/components/profileloader/content/load.js",true);
CQ_Analytics.ProfileDataMgr.prototype.PROFILE_LOADER=CQ_Analytics.Utils.externalize("/libs/cq/personalization/components/profileloader/content/load.json",true);
CQ_Analytics.ProfileDataMgr.prototype.init=function(){this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
$CQ(CQ.shared.ClientSidePersistence).bind(CQ.shared.ClientSidePersistence.EVENT_NAME,function(f,h){if(!h){return
}if(((h.key==="CLIENTCONTEXT")||(h.key==="PROFILEDATA"))&&(h.mode!=CQ.shared.ClientSidePersistence.MODE_COOKIE.name)){var d=new CQ.shared.ClientSidePersistence({container:"",mode:CQ.shared.ClientSidePersistence.MODE_COOKIE});
var g=d.get(h.key);
if(h.key==="PROFILEDATA"&&(!g||g=="")&&h.action!="set"){CQ.shared.ClientSidePersistence.clearAllMaps()
}d.set(h.key,h.value)
}});
var a=this.persistence.get(this.getStoreKey());
if(!a||a==""){this.data={};
for(var b in this.initProperty){this.data[b]=this.initProperty[b]
}}else{this.data=this.parse(a)
}this.persist();
this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.ProfileDataMgr.prototype.checkAuthorizableId=function(){if(!this.data){this.init()
}if(this.data.authorizableId){CQ_Analytics.CCM.setVisitorId(this.data.authorizableId)
}else{CQ_Analytics.CCM.setVisitorId("")
}};
CQ_Analytics.ProfileDataMgr.prototype.getLabel=function(a){return a
};
CQ_Analytics.ProfileDataMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.ProfileDataMgr.prototype.clear=function(){if(this.persistence){this.persistence.remove(this.getStoreKey())
}this.data=null;
this.initProperty={}
};
CQ_Analytics.ProfileDataMgr.prototype.getLoaderURL=function(){return CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/profiledata/loader.json")
};
CQ_Analytics.ProfileDataMgr.prototype.loadProfile=function(authorizableId){var url=this.getLoaderURL();
url=CQ_Analytics.Utils.addParameter(url,"authorizableId",authorizableId);
try{var object=CQ.shared.HTTP.eval(url);
if(object){this.data={};
for(var p in object){this.data[p]=object[p]
}this.persist();
this.fireEvent("initialize",this);
this.fireEvent("update");
if(CQ_Analytics.ClickstreamcloudEditor){CQ_Analytics.ClickstreamcloudEditor.reload()
}return true
}}catch(error){if(console&&console.log){console.log("Error during profile loading",error)
}}return false
};
CQ_Analytics.ProfileDataMgr=new CQ_Analytics.ProfileDataMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){this.checkAuthorizableId();
this.addListener("update",function(a,l){if(l=="birthday"||!l){var m=this.getProperty("birthday");
var n=this.getProperty("age");
var j="";
if(m){try{var d=function(q,p){var o=new Date(p.getTime());
o.setUTCHours(q.getUTCHours(),q.getUTCMinutes(),q.getUTCSeconds(),q.getUTCMilliseconds());
var r=o.getTime()-q.getTime();
return r/(1000*60*60*24)
};
var f=function(o){var p=new Date(o.getFullYear(),0,0);
return d(o,p)*-1
};
var k=new Date(Date.parse(m));
if(!isNaN(k.getTime())){var h=new Date();
if(f(k)==f(h)&&k.getMonth()==h.getMonth()){j=CQ.shared.HTTP.externalize(CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/profiledata/resources/birthday_cake.png"))
}else{var b=h.getFullYear()-k.getFullYear();
if(f(k)>f(h)){j=b
}else{j=Math.max(0,b-1)
}}}else{j=""
}}catch(g){j=""
}}if(n!=j){this.setProperty("age",j)
}}});
CQ_Analytics.CCM.register(this)
},CQ_Analytics.ProfileDataMgr)
}if(!CQ_Analytics.GeolocationUtils){CQ_Analytics.GeolocationUtils=new function(){return{init:function(b){var f;
try{if(typeof navigator.geolocation==="undefined"){f=google.gears.factory.create("beta.geolocation")
}else{f=navigator.geolocation
}}catch(g){}var a=function(h){var j=CQ_Analytics.PersistedJSONStore.registerNewInstance(b,h);
j.addListener("update",function(k,m){var n=CQ_Analytics.ClientContext.get(b+"/latitude");
var l=CQ_Analytics.ClientContext.get(b+"/longitude");
if(!n||!l){if(m!="generatedThumbnail"){j.setProperty("generatedThumbnail",CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback)
}else{if(j.getProperty(m,true)!=CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback){j.setProperty(m,CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback)
}}}else{if(j.getProperty("generatedThumbnail",true)==CQ_Analytics.GeolocationUtils.THUMBNAILS.fallback){j.setProperty("generatedThumbnail",j.getInitProperty("generatedThumbnail"))
}if(m=="latitude"||m=="longitude"||!m){CQ_Analytics.GeolocationUtils.computeAddress(n,l,b)
}}})
};
var d=function(l,k){var j=CQ_Analytics.StoreRegistry.getStore(b);
if(j){l=l||CQ_Analytics.GeolocationUtils.DEFAULTS;
var h=l.generatedThumbnail=j.getInitProperty("generatedThumbnail");
j.initJSON(l);
if(!k){j.init();
j.setProperty("generatedThumbnail",h)
}}else{a(l)
}};
a();
if(f){f.getCurrentPosition(function(h){var j={longitude:h.coords.longitude,latitude:h.coords.latitude};
if(h.address){j.address=h.address
}d(j,CQ_Analytics.CCM.areStoresInitialized)
},function(h){if(!CQ_Analytics.CCM.areStoresInitialized){var k="Error";
if(CQ_Analytics.isUIAvailable){k=CQ.I18n.getMessage("Connection timeout",null,"timeout while connecting geolocation service");
if(h.code==1){k=CQ.I18n.getMessage("Permission denied",null,"permission denied message from goelocation service")
}else{if(h.code==2){k=CQ.I18n.getMessage("Position unavailable",null,"geolocation service couldn't find location")
}}}var j={address:{country:k}};
d(j,CQ_Analytics.CCM.areStoresInitialized)
}})
}else{d()
}},computeAddress:function(f,b,a){CQ_Analytics.ClientContext.set(a+"/address/region");
CQ_Analytics.ClientContext.set(a+"/address/countryCode");
CQ_Analytics.ClientContext.set(a+"/address/country");
var d=function(){var g=new google.maps.LatLng(f,b);
var h=new google.maps.Geocoder();
h.geocode({location:g},function(j,l){if(l==="OK"&&j[0]&&j[0].address_components){for(var m=0;
m<j[0].address_components.length;
m++){var k=j[0].address_components[m];
if(k.types&&k.types.length){if(k.types[0]=="administrative_area_level_1"){CQ_Analytics.ClientContext.set(a+"/address/region",k.short_name)
}else{if(k.types[0]=="country"){CQ_Analytics.ClientContext.set(a+"/address/countryCode",k.short_name);
CQ_Analytics.ClientContext.set(a+"/address/country",k.long_name)
}}}}}})
};
if(!window.google){window.geocode_callback=d;
$CQ.getScript(document.location.protocol+"//maps.google.com/maps/api/js?sensor=false&callback=geocode_callback")
}else{d.call()
}}}
}();
CQ_Analytics.GeolocationUtils.DEFAULTS={latitude:37.331375,longitude:-121.893992};
CQ_Analytics.GeolocationUtils.THUMBNAILS={fallback:document.location.protocol+"//maps.googleapis.com/maps/api/staticmap?center=37,-121&zoom=0&size=80x80&sensor=false"}
}if(!CQ_Analytics.CartMgr){CQ_Analytics.CartMgr=new CQ_Analytics.SessionStore();
CQ_Analytics.CartMgr.STOREKEY="CART";
CQ_Analytics.CartMgr.STORENAME="cart";
CQ_Analytics.CartMgr.init=function(){if(!this.data){this.data={}
}else{var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var b=a.get(this.STOREKEY);
if(b){var d=b.split("=");
if(d.length>=2){this.referenceTotalPrice=d[0];
this.simulatedTotalPrice=d[1];
this.updateSimulatedPrice()
}}this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
}};
CQ_Analytics.CartMgr.persist=function(){if(this.fireEvent("beforepersist")!==false){var a=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var b=null;
if(this.referenceTotalPrice&&this.simulatedTotalPrice){b=this.referenceTotalPrice+"="+this.simulatedTotalPrice
}a.set(this.STOREKEY,b);
this.fireEvent("persist")
}};
CQ_Analytics.CartMgr.updateSimulatedPrice=function(){if(this.simulatedTotalPrice&&this.referenceTotalPrice==this.data.totalPriceFloat){this.data.totalPrice=this.simulatedTotalPrice+"";
this.data.totalPriceFloat=this.simulatedTotalPrice
}else{this.simulatedTotalPrice=null;
this.persist()
}};
CQ_Analytics.CartMgr.registerSimulatedPrice=function(a){if(this.simulatedTotalPrice){this.simulatedTotalPrice=a;
this.data.totalPrice=a+""
}else{this.referenceTotalPrice=this.data.totalPriceFloat;
this.simulatedTotalPrice=a
}this.persist()
};
CQ_Analytics.CartMgr.getProperty=function(a,l){if(!this.data){this.init()
}var g=this.data;
try{var f=a.split(".");
for(var h=0;
h<f.length-1;
h++){var b=f[h];
var d=b.indexOf("[");
var j=-1;
if(d>0){j=parseInt(b.substring(d+1,b.length-1));
b=b.substring(0,d)
}g=g[b];
if(j>=0){g=g[j]
}}var n=f[f.length-1];
if(!l){var m=CQ.shared.XSS.getXSSPropertyName(n);
if(g[m]){return g[m]
}}return g[n]
}catch(k){return undefined
}};
CQ_Analytics.CartMgr.validate=function(a,d){if(a=="totalPriceFloat"){var b=parseFloat(d);
return b>=0
}else{if(a.indexOf(".quantity")>0){var f=parseInt(d);
return f>=0
}}return true
};
CQ_Analytics.CartMgr.setProperty=function(a,k){if(!this.data){this.init()
}if(!this.validate(a,k)){this.fireEvent("update",a);
return
}if(a=="totalPriceFloat"){this.registerSimulatedPrice(k)
}var g=this.data;
var f=a.split(".");
for(var h=0;
h<f.length-1;
h++){var b=f[h];
var d=b.indexOf("[");
var j=-1;
if(d>0){j=parseInt(b.substring(d+1,b.length-1));
b=b.substring(0,d)
}if(!g[b]){g[b]={}
}g=g[b];
if(j>=0){if(!g[j]){g[j]={}
}g=g[j]
}}var m=f[f.length-1];
g[m]=k;
var l=CQ.shared.XSS.getXSSPropertyName(m);
this.data[l]=CQ.shared.XSS.getXSSValue(k);
this.fireEvent("update",a)
};
CQ_Analytics.CartMgr.update=function(){var a=this;
if(this.updateUrl){$CQ.ajax({url:this.updateUrl,type:"POST",data:{cart:JSON.stringify(a.data)},externalize:false,encodePath:false,hook:true,success:function(b){a.data=b;
a.updateSimulatedPrice();
CQ_Analytics.ClientContextUtils.renderStore(CQ_Analytics.CartMgr.divId,CQ_Analytics.CartMgr.STORENAME);
a.fireEvent("updatecomplete");
a.fireEvent("update")
}})
}};
CQ_Analytics.CartMgr.clear=function(){if(this.data.entries){this.data.entries=[]
}if(this.data.vouchers){this.data.vouchers=[]
}this.data.totalPrice="0";
this.referenceTotalPrice=null;
this.simulatedTotalPrice=null
};
CQ_Analytics.CartMgr.reset=function(){this.clear();
this.fireEvent("update");
this.persist();
this.update()
};
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this);
CQ_Analytics.SegmentMgr.addListener("update",function(){if(!this.promotionsMap){return
}if(!this.data.promotions){this.data.promotions=[]
}var h=CQ_Analytics.SegmentMgr.getResolved();
var g=[];
for(var f=0;
f<this.promotionsMap.length;
f++){var a=this.promotionsMap[f];
var l=false;
var k=a.segments.split(",");
for(var b=0;
b<k.length;
b++){if($CQ.inArray(k[b],h)>=0){l=true;
break
}}if(l){g.push(a.path)
}}var d=false;
for(var f=0;
f<this.data.promotions.length;
f++){var m=this.data.promotions[f];
var b=$CQ.inArray(m.path,g);
if(b>=0){g.splice(b,1)
}else{this.data.promotions.splice(f--,1);
d=true
}}for(var f=0;
f<g.length;
f++){var m={path:g[f]};
this.data.promotions.push(m);
d=true
}if(d){this.update()
}},CQ_Analytics.CartMgr)
},CQ_Analytics.CartMgr)
}if(!CQ_Analytics.CartHelper){CQ_Analytics.CartHelper=(function(){return{containsProduct:function(g,f,h){var j=f?f.substring(0,f.lastIndexOf("#")):null;
for(var a=0;
g.entries&&a<g.entries.length;
a++){var d=g.entries[a];
var b=d.page.substring(0,d.page.lastIndexOf("#"));
if((!f||b==j)&&(!h||d.quantity>=h)){return true
}}return false
}}
})()
}if(!CQ_Analytics.CampaignMgr){CQ_Analytics.CampaignMgr=function(){};
CQ_Analytics.CampaignMgr.prototype=new CQ_Analytics.PersistedSessionStore();
CQ_Analytics.CampaignMgr.prototype.STOREKEY="CAMPAIGN";
CQ_Analytics.CampaignMgr.prototype.STORENAME="campaign";
CQ_Analytics.CampaignMgr.prototype.DEFAULT_EXPERIENCE="DEFAULT";
CQ_Analytics.CampaignMgr.prototype.init=function(){var d;
this.persistence=new CQ_Analytics.SessionPersistence({container:"ClientContext"});
var a=this.persistence.get(this.getStoreKey());
if(!this.data){this.data={}
}if(!a||a===""){for(d in this.initProperty){if(this.initProperty.hasOwnProperty(d)){this.data[d]=this.initProperty[d]
}}}else{this.data=this.parse(a);
var b=this.getInitProperty("campaigns");
if(b){this.data.campaigns=b
}}this.validate();
this.persist();
this.initialized=true;
this.fireEvent("initialize",this);
this.fireEvent("update")
};
CQ_Analytics.CampaignMgr.prototype.validate=function(){if(this.data.campaigns){if(!this.getCampaignBy("path",this.data.path)&&!this.getCampaignBy("id",this.data.id)){this.setCampaign(null)
}if(this.data["recipe/path"]!==CQ_Analytics.CampaignMgr.DEFAULT_EXPERIENCE){if(!this.getExperienceBy("path",this.data["recipe/path"])&&!this.getExperienceBy("id",this.data["recipe/id"])){this.setExperience(null)
}}}};
CQ_Analytics.CampaignMgr.prototype.getCampaignBy=function(g,b){if(!this.data||!this.data.campaigns){return null
}var a,d=this.data.campaigns;
for(a=0;
a<d.length;
a++){var f=d[a];
if(f[g]===b){return f
}}return null
};
CQ_Analytics.CampaignMgr.prototype.getExperienceBy=function(k,f){if(!this.data||!this.data.campaigns){return null
}var d,g=this.data.campaigns;
for(d=0;
d<g.length;
d++){var h=g[d];
for(var a=0;
a<h.experiences.length;
a++){var b=h.experiences[a];
if(b[k]===f){return b
}}}return null
};
CQ_Analytics.CampaignMgr.prototype.setCampaign=function(a){this.setProperties({name:a?a.title:"",path:a?a.path:"",id:a?a.id:"","recipe/name":a?CQ.I18n.getMessage("(default)"):"","recipe/path":a?this.DEFAULT_EXPERIENCE:"","recipe/id":a?this.DEFAULT_EXPERIENCE:""})
};
CQ_Analytics.CampaignMgr.prototype.setExperience=function(a){this.setProperties({"recipe/name":a?a.title:"","recipe/path":a?a.path:"","recipe/id":a?a.id:""})
};
CQ_Analytics.CampaignMgr.prototype.setProperty=function(a,b){if(a==="id"||a==="path"){this.setCampaign(this.getCampaignBy(a,b));
return
}else{if(a==="recipe/id"||a==="recipe/path"){if(b!==CQ_Analytics.CampaignMgr.DEFAULT_EXPERIENCE){this.setExperience(this.getExperienceBy(a.substring("recipe/".length),b));
return
}}}CQ_Analytics.PersistedSessionStore.prototype.setProperty.call(this,a,b)
};
CQ_Analytics.CampaignMgr.prototype.isCampaignSelected=function(){return this.getProperty("path")!==""
};
CQ_Analytics.CampaignMgr.prototype.clear=function(){this.data=null;
this.initProperty={}
};
CQ_Analytics.CampaignMgr.prototype.getLabel=function(a){return a
};
CQ_Analytics.CampaignMgr.prototype.getLink=function(a){return""
};
CQ_Analytics.CampaignMgr=new CQ_Analytics.CampaignMgr();
CQ_Analytics.CCM.addListener("configloaded",function(){CQ_Analytics.CCM.register(this)
},CQ_Analytics.CampaignMgr)
}if(!CQ_Analytics.ActivityStreamMgr){CQ_Analytics.ActivityStreamMgr=CQ_Analytics.JSONStore.registerNewInstance("activitystream",{});
CQ_Analytics.ActivityStreamMgr.internalRenderer=function(d,a){var b=d+".form.html";
b+=CQ_Analytics.ClientContextMgr.getClientContextURL("/contextstores/activitystream.html");
b+="?limit=3";
CQ.shared.HTTP.get(b,function(g,h,f){$CQ("#"+a).children().remove();
if(h){$CQ("#"+a).append(f.body)
}})
};
CQ_Analytics.ActivityStreamMgr.renderer=function(b,a){if(!b.isReady){b.isReady=true;
CQ_Analytics.ClientContextUtils.onStoreRegistered("profile",function(d){d.addListener("update",function(g,h){var j=this.getProperty("path");
if(j!=CQ_Analytics.ActivityStreamMgr.currentProfilePath){CQ_Analytics.ActivityStreamMgr.currentProfilePath=j;
CQ_Analytics.ActivityStreamMgr.internalRenderer(j,a)
}},d);
var f=d.getProperty("path");
CQ_Analytics.ActivityStreamMgr.currentProfilePath=f;
CQ_Analytics.ActivityStreamMgr.internalRenderer(f,a)
})
}return""
}
}(function(h){function f(){}function A(K){d=[K]
}function r(M,K,L){return M&&M.apply(K.context||K,L)
}function q(K){return/\?/.test(K)?"&":"?"
}var s="async",w="charset",u="",I="error",z="insertBefore",v="_jqjsp",F="on",j=F+"click",n=F+I,t=F+"load",D=F+"readystatechange",b="readyState",H="removeChild",m="<script>",E="success",G="timeout",g=window,a=h.Deferred,k=h("head")[0]||document.documentElement,C={},p=0,d,o={callback:v,url:location.href},B=g.opera,l=!!h("<div>").html("<!--[if IE]><i><![endif]-->").find("i").length;
function J(P){P=h.extend({},o,P);
var N=P.success,U=P.error,M=P.complete,ad=P.dataFilter,af=P.callbackParameter,V=P.callback,ae=P.cache,L=P.pageCache,O=P.charset,Q=P.url,ah=P.data,X=P.timeout,T,ab=0,Z=f,W,S,K,ag,R,aa;
a&&a(function(ai){ai.done(N).fail(U);
N=ai.resolve;
U=ai.reject
}).promise(P);
P.abort=function(){!(ab++)&&Z()
};
if(r(P.beforeSend,P,[P])===!1||ab){return P
}Q=Q||u;
ah=ah?((typeof ah)=="string"?ah:h.param(ah,P.traditional)):u;
Q+=ah?(q(Q)+ah):u;
af&&(Q+=q(Q)+encodeURIComponent(af)+"=?");
!ae&&!L&&(Q+=q(Q)+"_"+(new Date()).getTime()+"=");
Q=Q.replace(/=\?(&|$)/,"="+V+"$1");
function ac(ai){if(!(ab++)){Z();
L&&(C[Q]={s:[ai]});
ad&&(ai=ad.apply(P,[ai]));
r(N,P,[ai,E,P]);
r(M,P,[P,E])
}}function Y(ai){if(!(ab++)){Z();
L&&ai!=G&&(C[Q]=ai);
r(U,P,[P,ai]);
r(M,P,[P,ai])
}}if(L&&(T=C[Q])){T.s?ac(T.s[0]):Y(T)
}else{g[V]=A;
ag=h(m)[0];
ag.id=v+p++;
if(O){ag[w]=O
}B&&B.version()<11.6?((R=h(m)[0]).text="document.getElementById('"+ag.id+"')."+n+"()"):(ag[s]=s);
if(l){ag.htmlFor=ag.id;
ag.event=j
}ag[t]=ag[n]=ag[D]=function(ai){if(!ag[b]||!/i/.test(ag[b])){try{ag[j]&&ag[j]()
}catch(aj){}ai=d;
d=0;
ai?ac(ai[0]):Y(I)
}};
ag.src=Q;
Z=function(ai){aa&&clearTimeout(aa);
ag[D]=ag[t]=ag[n]=null;
k[H](ag);
R&&k[H](R)
};
k[z](ag,(K=k.firstChild));
R&&k[z](R,K);
aa=X>0&&setTimeout(function(){Y(G)
},X)
}return P
}J.setup=function(K){h.extend(o,K)
};
h.jsonp=J
})(jQuery);
(function(b){function a(o,k){var p,q,m,f,j,d,g,n,l,h;
p=o.length&3;
q=o.length-p;
m=k;
j=3432918353;
g=461845907;
h=0;
while(h<q){l=((o.charCodeAt(h)&255))|((o.charCodeAt(++h)&255)<<8)|((o.charCodeAt(++h)&255)<<16)|((o.charCodeAt(++h)&255)<<24);
++h;
l=((((l&65535)*j)+((((l>>>16)*j)&65535)<<16)))&4294967295;
l=(l<<15)|(l>>>17);
l=((((l&65535)*g)+((((l>>>16)*g)&65535)<<16)))&4294967295;
m^=l;
m=(m<<13)|(m>>>19);
f=((((m&65535)*5)+((((m>>>16)*5)&65535)<<16)))&4294967295;
m=(((f&65535)+27492)+((((f>>>16)+58964)&65535)<<16))
}l=0;
switch(p){case 3:l^=(o.charCodeAt(h+2)&255)<<16;
case 2:l^=(o.charCodeAt(h+1)&255)<<8;
case 1:l^=(o.charCodeAt(h)&255);
l=(((l&65535)*j)+((((l>>>16)*j)&65535)<<16))&4294967295;
l=(l<<15)|(l>>>17);
l=(((l&65535)*g)+((((l>>>16)*g)&65535)<<16))&4294967295;
m^=l
}m^=o.length;
m^=m>>>16;
m=(((m&65535)*2246822507)+((((m>>>16)*2246822507)&65535)<<16))&4294967295;
m^=m>>>13;
m=((((m&65535)*3266489909)+((((m>>>16)*3266489909)&65535)<<16)))&4294967295;
m^=m>>>16;
return m>>>0
}b.murmurhash3=a
})(jQuery);
CQ_Analytics=window.CQ_Analytics||{};
CQ_Analytics.AAM=CQ_Analytics.AAM||{};
CQ_Analytics.AAM.AudienceMgr=CQ_Analytics.AAM.AudienceMgr||function(h){var g=h.partner||"geometrixx";
var s=h.destinationNames||{CQIntegrationDestination:{domain:".cqclientintegration.adobe.com",segkey:"segs",keysep:",",valsep:";"}};
var r=h.debug||false;
var b=h.containerNSID||"0";
var t=false;
if(h.simulationPath){t=h.simulationPath+".segments.json"
}var d=function(){};
if(r){d=function(u){console.log("DEBUG: audiencemanager.js "+u)
}
}var q=function(u){console.log("ERROR: audiencemanager.js "+u)
};
d("Initialise Audience Manager");
var n={};
var f=new CQ_Analytics.JSONStore();
var l="http://";
if("https:"==document.location.protocol){l="https://"
}l+=encodeURIComponent(g)+".demdex.net/event?d_cb=?";
function j(v){var u={};
$.each(v,function(B,D){if(s[D.cn]){var A=s[D.cn];
if(D.dmn.slice(0,A.domain.length)===A.domain){var z=(A.segkey||"segs")+"=";
var C=z.length;
var E=A.keysep||",";
var w=A.valsep||";";
$.each(D.cv.split(E),function(G,F){if(F.slice(0,C)===z){$.each(F.substring(C).split(w),function(H,I){u[I]=true
})
}})
}}});
return u
}function o(){}function m(u){n={};
var v=[];
$.each(u,function(A,B){if(B){n[A]=true;
v.push(A)
}});
v.sort();
var w=f.getProperty("segments");
var z=v.join(",");
if(w!==z){f.setProperty("segments",z);
d("Set segments to "+z)
}}function k(u,w){w=w||o;
if(t){if(!u.sid){w();
f.fireEvent("update")
}else{$.getJSON(t,{t:u.sid},function(z){if(z.segments){m(z.segments)
}w();
f.fireEvent("update")
}).fail(function(z,B,A){q("Failed to resolve segments from AAM server  "+B+" error "+A);
w();
f.fireEvent("update")
})
}}else{var v={};
u=u||{};
$.each(u,function(z,A){if(z==="sid"){v.d_sid=A
}else{v["c_"+z]=A
}});
v.d_nsid=b;
v.d_rtbd="json";
$.jsonp({url:l,callback:"__aaminvoke",data:v,success:function(z,B,A){if(z.stuff){m(j(z.stuff))
}w();
f.fireEvent("update")
},error:function(A,z){q("Failed to retieve json response "+z);
w();
f.fireEvent("update")
}})
}}function a(){return n
}function p(u){return(n[u])
}k(false,function(){CQ_Analytics.ClientContextMgr.register(f)
});
f.getUserSegments=a;
f.matches=p;
f.invoke=k;
return f
};
tartan=tartan||{};
(function(a){a.cardTypes=a.cardTypes||{};
a.cardTypes.base=new Class({titleEditable:true,subtitleEditable:true,acceptedMimeTypes:undefined,acceptedExtensions:undefined,getTitle:function(b){return b.title
},getSubtitle:function(b){return b.subtitle
},renderShare:function(b,d){},renderNormal:function(b,d){d()
},prepareActivity:function(b,d){return d
},createPayload:function(d,f,b){return null
},prepareAnnotation:function(b,d){},handleDrop:undefined,handleFileUpload:undefined})
})(tartan);
(function(b,a){b.cardTypes.staticimage=new Class({extend:b.cardTypes.base,acceptedMimeTypes:["image/png","image/jpeg","image/gif"],acceptedExtensions:["png","gif","jpg","jpeg"],handleFileUpload:function(f,d){var g=f.options.uploadUrl.replace(/(.*?)\?.*/,"$1");
g+="?resourceType=mac/components/cards/staticimage";
g+="&title="+encodeURIComponent(d.fileName);
g+="&iFrameTransport=true";
g+="&bug=";
f.options.uploadUrl=g;
f.uploadFile(d)
}})
})(tartan,jQuery);
(function(){var b=Handlebars.template,a=Handlebars.templates=Handlebars.templates||{};
a["social_details.hbs"]=b(function(j,v,t,o,C){this.compilerInfo=[4,">= 1.0.0"];
t=this.merge(t,j.helpers);
C=C||{};
var u="",l,h,g,f="function",d=this.escapeExpression,r=this,s=t.helperMissing;
function q(G,F){var D="",E;
D+='\n    <div class="sentiment-';
if(E=t.sentiment_class){E=E.call(G,{hash:{},data:F})
}else{E=G.sentiment_class;
E=typeof E===f?E.apply(G):E
}D+=d(E)+'"></div>\n    ';
return D
}function p(G,F){var D="",E;
D+='\n            <a href="';
if(E=t.author_profile_url){E=E.call(G,{hash:{},data:F})
}else{E=G.author_profile_url;
E=typeof E===f?E.apply(G):E
}D+=d(E)+'" class="author-name" target="_blank">';
if(E=t.author_display_name){E=E.call(G,{hash:{},data:F})
}else{E=G.author_display_name;
E=typeof E===f?E.apply(G):E
}D+=d(E)+"</a>\n            ";
return D
}function n(G,F){var D="",E;
D+='\n            <span class="author-name">';
if(E=t.author_display_name){E=E.call(G,{hash:{},data:F})
}else{E=G.author_display_name;
E=typeof E===f?E.apply(G):E
}D+=d(E)+"</span>\n            ";
return D
}function m(G,F){var D="",E;
D+="\n        ";
E=t["if"].call(G,G.author_username,{hash:{},inverse:r.noop,fn:r.program(8,k,F),data:F});
if(E||E===0){D+=E
}D+="\n        ";
E=t["if"].call(G,G.reach,{hash:{},inverse:r.noop,fn:r.program(10,B,F),data:F});
if(E||E===0){D+=E
}D+="\n        ";
return D
}function k(G,F){var D="",E;
D+="<span>@";
if(E=t.author_username){E=E.call(G,{hash:{},data:F})
}else{E=G.author_username;
E=typeof E===f?E.apply(G):E
}D+=d(E)+"</span>";
return D
}function B(G,F){var D="",E;
D+="<span>";
if(E=t.i18nFollowers){E=E.call(G,{hash:{},data:F})
}else{E=G.i18nFollowers;
E=typeof E===f?E.apply(G):E
}D+=d(E)+"</span>";
return D
}function A(I,H){var D="",G,F,E;
D+="\n    ";
E={hash:{},inverse:r.noop,fn:r.program(13,z,H),data:H};
F=((G=t.ifCond||I.ifCond),G?G.call(I,I.type,"image",E):s.call(I,"ifCond",I.type,"image",E));
if(F||F===0){D+=F
}D+="\n    ";
return D
}function z(G,F){var D="",E;
D+='\n    <p class="media"><img src="';
if(E=t.url){E=E.call(G,{hash:{},data:F})
}else{E=G.url;
E=typeof E===f?E.apply(G):E
}D+=d(E)+'"></p>\n    ';
return D
}function w(G,F){var D="",E;
D+="\n    <tr><th>";
if(E=t.i18nLocation){E=E.call(G,{hash:{},data:F})
}else{E=G.i18nLocation;
E=typeof E===f?E.apply(G):E
}D+=d(E)+"</th><td>";
if(E=t.location){E=E.call(G,{hash:{},data:F})
}else{E=G.location;
E=typeof E===f?E.apply(G):E
}D+=d(E)+"</td></tr>\n    ";
return D
}u+='\n<article class="card-mac-social">\n    ';
l=t["if"].call(v,v.sentiment_class,{hash:{},inverse:r.noop,fn:r.program(1,q,C),data:C});
if(l||l===0){u+=l
}u+='\n\n    <div class="author-box clearfix">\n        <img class="author-image" src="';
if(l=t.author_image_url){l=l.call(v,{hash:{},data:C})
}else{l=v.author_image_url;
l=typeof l===f?l.apply(v):l
}u+=d(l)+'">\n        <span class="creation-date">';
if(l=t.created_formatted){l=l.call(v,{hash:{},data:C})
}else{l=v.created_formatted;
l=typeof l===f?l.apply(v):l
}u+=d(l)+'</span>\n        <span>\n            <img class="provider-image" src="';
if(l=t.provider_image){l=l.call(v,{hash:{},data:C})
}else{l=v.provider_image;
l=typeof l===f?l.apply(v):l
}u+=d(l)+'">\n            ';
l=t["if"].call(v,v.author_profile_url,{hash:{},inverse:r.program(5,n,C),fn:r.program(3,p,C),data:C});
if(l||l===0){u+=l
}u+="\n        </span>\n        ";
g={hash:{},inverse:r.noop,fn:r.program(7,m,C),data:C};
h=((l=t.ifCond||v.ifCond),l?l.call(v,v.provider,"Twitter",g):s.call(v,"ifCond",v.provider,"Twitter",g));
if(h||h===0){u+=h
}u+='\n    </div>\n    <p class="verbatim">';
if(h=t.verbatim_html){h=h.call(v,{hash:{},data:C})
}else{h=v.verbatim_html;
h=typeof h===f?h.apply(v):h
}if(h||h===0){u+=h
}u+="</p>\n    ";
h=t.each.call(v,v.media,{hash:{},inverse:r.noop,fn:r.program(12,A,C),data:C});
if(h||h===0){u+=h
}u+='\n</article>\n\n<table class="information-table">\n    ';
h=t["if"].call(v,v.location,{hash:{},inverse:r.noop,fn:r.program(15,w,C),data:C});
if(h||h===0){u+=h
}u+="\n</table>";
return u
})
})();
(function(d,b,a){d.cardTypes.social=new Class({extend:d.cardTypes.base,subtitleEditable:false,getSubtitle:function(f){return f.subtitle||a.I18n.get("Social Mention")
},renderShare:function(g,h){var f=this;
b.ajax({url:g.data.dataURL,success:function(k){g.dataJSON=JSON.stringify(k);
if(!g.title&&k.provider){g.title=(k.provider.val=="Twitter")?a.I18n.get("Tweet"):a.I18n.get("{0} Post",k.provider.val);
b("#title").text(g.title).attr("title",g.title)
}b(".shareframe").data(g);
var j=f.generateCardContent(k);
h.append(j)
},error:function(j,l,k){window.console&&console.error("Error while loading social data:",l,k)
}})
},renderNormal:function(g,h){var f=this;
g.children().each(function(){var k=b(this).data("socialData");
var j=f.generateCardContent(k);
g.append(j);
h()
})
},generateCardContent:function(m){var l={};
for(var g in m){var k=m[g];
l[g]=k.hasOwnProperty("val")?k.val:k
}window.console&&console.log("Social card data:",l);
if(l.sentiment!==undefined){l.sentiment_class=(l.sentiment<4)?"negative":(l.sentiment>6)?"positive":"neutral"
}l.author_image_url=l.author_image_url||a.HTTP.externalize("/etc/designs/mac/avatar.png");
l.author_display_name=l.author_display_name||l.author_username;
l.created_formatted=moment(l.created).format("LLL");
var j=b("<textarea>");
var f=j.html(l.verbatim).html();
f=f.replace(/((?:https?:\/\/|www\.)\S+)([.,;!?]\s|$)?/g,function(p,q,n){q=j.html(q).val();
var o=q;
if(o.indexOf("http")!==0){o="http://"+o
}var r=b("<a>",{href:o,text:q,target:"_blank"})[0].outerHTML;
if(n){r+=n
}return r
});
l.verbatim_html=f;
l.i18nFollowers=a.I18n.get("{0} Followers",[l.reach]);
l.i18nLocation=a.I18n.get("Location");
var h=Handlebars.templates["social_details.hbs"];
return h(l)
},prepareActivity:function(f,g){delete g.object.summary;
return g
},createPayload:function(g,j,f){var h={link:g.url,"jcr:title":j};
if(g.dataJSON){h.dataJson=g.dataJSON
}return h
}})
})(tartan,jQuery,Granite);
(function(b,a){b.cardTypes.remote_asset=new Class({extend:b.cardTypes.base,titleEditable:false,subtitleEditable:false,renderShare:function(f,g){var d=a("<img>").addClass("annotatable");
d.attr("src",f.data.url);
g.append(a("<span class='image'>").append(d))
},prepareActivity:function(d,f){f.object.id=decodeURIComponent(d.url);
f.object.image={url:d.data.url};
f.object.imageUrl=decodeURI(d.data.imageUrl);
f.object.imagePreviewUrl=decodeURI(d.data.imagePreviewUrl);
return f
},createPayload:function(f,g,d){return null
}})
})(tartan,jQuery);
(function(b,a){b.cardTypes.pdf=new Class({extend:b.cardTypes.base,acceptedMimeTypes:["application/pdf"],acceptedExtensions:["pdf"],handleFileUpload:function(f,d){var g=f.options.uploadUrl.replace(/(.*?)\?.*/,"$1");
g+="?resourceType=mac/components/cards/pdf";
g+="&title="+encodeURIComponent(d.fileName);
g+="&iFrameTransport=true";
g+="&bug=";
f.options.uploadUrl=g;
f.uploadFile(d)
}})
})(tartan,jQuery);
(function(b,a){b.cardTypes.oembed=new Class({extend:b.cardTypes.base,renderShare:function(g,h){var f=a("<div class='preview'>");
if(g.data.html){f.append(g.data.html)
}else{if(g.data.thumbnailUrl){f.append(a("<img class='preview' src='"+g.data.thumbnailUrl+"'>"))
}else{var d=a("<div class='nopreview'/>");
d.text(Granite.I18n.get("No Preview Available"));
f.append(d)
}}h.append(f)
},prepareActivity:function(d,f){f.object.id=decodeURIComponent(d.url);
f.object.url=decodeURIComponent(d.url);
f.object.image={url:d.data.thumbnailUrl};
return f
},createPayload:function(f,g,d){payload={"jcr:title":g,"jcr:description":d,url:f.url};
return payload
},handleDrop:function(g){var k=g.originalEvent.originalEvent;
var f=k.dataTransfer.getData("text/plain");
if(f&&f.match(/http.*/gi)){console.debug(this.name,"URL dropped",f);
var j=g.fileUpload.options.uploadUrl.replace(/(.*?)\?.*/,"$1");
j+="?resourceType=mac/components/cards/oembed";
j+="&url="+encodeURIComponent(f);
var d;
try{a.ajax({type:"POST",url:j,data:{link:f},error:function(l,n,m){b.core.addNoticeMessage(Granite.I18n.get(m))
},complete:function(n,o){var l=JSON.parse(n.responseText);
if(l.success){b.core.refreshCards()
}else{var m=l.error;
b.core.addNoticeMessage(Granite.I18n.get(m))
}}})
}catch(h){d=h
}if(d){window.console&&console.error("Upload card error: ",d);
b.core.addNoticeMessage(Granite.I18n.get(d))
}}else{console.debug(this.name,"No URL found.")
}}})
})(tartan,jQuery);
(function(b,a){b.cardTypes.firsttimeexperience=new Class({extend:b.cardTypes.base,renderNormal:function(d,f){a(document).on("click",".first-time-experience-tooltip",function(l){l.preventDefault();
var h=a(this),k=a(h.attr("href"));
if(k.length>0){h.removeClass("not-active");
var n=h.closest("ul").find("a").not(h);
n.addClass("not-active");
var j=k.data();
k.insertAfter(j.pointAt);
k.popover(j);
if(j.moveX||j.moveY){var m=k.offset();
if(j.moveX){m.left+=j.moveX
}if(j.moveY){m.top+=j.moveY
}k.offset(m)
}k.data("popover").show();
function g(){if(k.is(":hidden")){if(!h.hasClass("not-active")){n.removeClass("not-active")
}}else{window.setTimeout(arguments.callee,100)
}}g()
}f()
})
}})
})(tartan,jQuery);
(function(j,f){j.cardTypes["dv-report"]=new Class({extend:j.cardTypes.base,acceptedMimeTypes:["text/csv","application/vnd.ms-excel","application/vnd.openxmlformats-officedocument.spreadsheetml.sheet"],acceptedExtensions:["csv","xls","xlsx"],renderShare:function(m,n){var l=f("<div>").addClass("mac-dv-chart annotatable").data("chartType",m.data.chartType).appendTo(n).on("render",function(o,p){f(this).data("chart",p)
});
j.dv.render({parent:l,dataURL:m.data.dataURL,dataTraits:m.dataTraits,chartType:m.data.chartType,chartOpts:m.data.chartOpts,onSuccess:function(o){if(window.console){console.log("chart.onload",o)
}if(o.dataJSON){m.dataJSON=o.dataJSON
}f(".shareframe").data(m)
}})
},renderNormal:function(l,m){l.find(".mac-dv-chart").each(function(){var o=f(this).addClass("annotatable").on("render",function(s,t){f(this).data("chart",t);
m()
});
var n=o.data("json");
var r=o.data("url");
var p=o.data("chartType")||"";
var q=o.data("chartOpts")||{};
j.dv.render({parent:o,data:n,dataURL:r,chartType:p,chartOpts:q})
})
},prepareActivity:function(l,m){return m
},createPayload:function(m,o,l){var n={link:m.url,"jcr:title":o,"jcr:description":l,dataUrl:m.data.dataURL,chartType:m.data.chartType};
if(m.dataJSON){n.dataJson=m.dataJSON
}if(m.dataTraits){n.dataTraits=JSON.stringify(m.dataTraits)
}if(m.data.chartOpts){n.chartOpts=JSON.stringify(m.data.chartOpts)
}return n
},prepareAnnotation:function(l,n){var m=n.find(".mac-dv-chart");
var o=m.data("chart");
if(o&&o.plotBounds){var p=m.data("chartType").indexOf("/trend/")<0;
l.setV2DMapping(function(q){return Granite.UI.Annotation.DV_V2DMapping(q,currentChart,p)
});
l.setD2VMapping(function(q){return Granite.UI.Annotation.DV_D2VMapping(q,currentChart,p)
})
}},handleDrop:function(l){var m=new FileHandler(this.handleExcelData);
m.onFileDrop(l.originalEvent.originalEvent)
},handleExcelData:function(C){var z=Object.keys(C.lines[0])[0];
while(""==C.lines[C.lines.length-1][z]){C.lines.pop()
}var s={};
var t=[];
for(var u=1;
u<C.headers.length;
++u){var B=[];
for(var r=0;
r<C.lines.length;
++r){var p=C.lines[r][C.headers[u]];
if(undefined!=p){B.push([{val:p.replace(/ |,/g,"")}])
}}t.push(B)
}s.data=t;
var w={};
w.id="values";
w.ref_id="m001";
w.name="Values";
w.type="int";
w.source="real";
w.transforms=null;
var o=k(C.lines[0][z]);
var v=k(C.lines[C.lines.length-1][z]);
var A={start:o.getFullYear()+"/"+(o.getMonth()+1)+"/"+o.getDate()+" 00:00:00",end:v.getFullYear()+"/"+(v.getMonth()+1)+"/"+v.getDate()+" 00:00:00",gran:"day"};
w.date_range=A;
w.date_ref=[];
for(var r=0;
r<C.lines.length;
++r){w.date_ref.push(r)
}w.filter_ref=[];
for(var u=0;
u<C.headers.length-1;
++u){w.filter_ref.push(u)
}s.metrics=[w];
var n=[];
for(var u=1;
u<C.headers.length;
++u){var m={ref_id:"f001",data_store:"mac/xls",filter_def:[{"var":"page",op:"id",val:u}],metric_ref:[0],info:{id:u,name:C.headers[u]}};
n.push(m)
}s.filters=n;
var l=[];
for(var r=0;
r<C.lines.length;
++r){var q=k(C.lines[r][z]);
l.push({val:q.getFullYear()+"/"+(q.getMonth()+1)+"/"+q.getDate()+" 00:00:00",gran:"day"})
}s.dates=l;
s.children=[];
f.ajax({url:window.location.href.replace(/\.html/,"")+"/_jcr_content.createCard.json",type:"POST",data:{title:C.file.name,resourceType:"mac/components/cards/dv-report","payload/jcr:title":C.file.name,"payload/dataUrl":"data:application/json,"+JSON.stringify(s),"payload/chartType":"trend","payload/chartOptions":JSON.stringify({}),"payload/type":"dv-report"},success:function(){j.core.refreshCards()
},error:j.core.ajaxError})
}});
function k(o){var l=/(\d+)\/(\d+)\/(\d+)/;
var m=/^(\d+)-(\d+)$/;
if(l.test(o)){var n=o.match(l);
return new Date(n[3],(n[1]-1),n[2])
}else{if(m.test(o)){var n=o.match(m);
return b(n[2],n[1])
}else{console.info('Unparseable date: "'+o+'"')
}}}function b(m,n){if(n==null){n=(new Date()).getFullYear()
}var l=a(n),o=h(m),p=l.getTime()+o;
l.setTime(p);
return l
}function h(l){return 1000*60*60*24*7*(l-1)
}function a(m){var l=new Date();
l=d(l,m);
l=g(l);
return l
}function d(l,m){l.setYear(m);
l.setDate(1);
l.setMonth(0);
l.setHours(0);
l.setMinutes(0);
l.setSeconds(0);
l.setMilliseconds(0);
return l
}function g(o){var p=1;
var n=7;
var m=o.getDay();
m=(m===0)?7:m;
var l=-m+p;
if(n-m+1<4){l+=n
}return new Date(o.getTime()+l*24*60*60*1000)
}})(tartan,jQuery);
var JSZip=function(b,a){this.files={};
this.root="";
if(b){this.load(b,a)
}};
JSZip.signature={LOCAL_FILE_HEADER:"PK",CENTRAL_FILE_HEADER:"PK",CENTRAL_DIRECTORY_END:"PK",ZIP64_CENTRAL_DIRECTORY_LOCATOR:"PK",ZIP64_CENTRAL_DIRECTORY_END:"PK",DATA_DESCRIPTOR:"PK\b"};
JSZip.defaults={base64:false,binary:false,dir:false,date:null};
JSZip.prototype=function(){var f=function(m,n,l){this.name=m;
this.data=n;
this.options=l
};
f.prototype={asText:function(){return this.options.binary?JSZip.prototype.utf8decode(this.data):this.data
},asBinary:function(){return this.options.binary?this.data:JSZip.prototype.utf8encode(this.data)
}};
var b=function(o,l){var n="",m;
for(m=0;
m<l;
m++){n+=String.fromCharCode(o&255);
o=o>>>8
}return n
};
var k=function(){var m={},n,l;
for(n=0;
n<arguments.length;
n++){for(l in arguments[n]){if(typeof m[l]==="undefined"){m[l]=arguments[n][l]
}}}return m
};
var g=function(l){l=l||{};
if(l.base64===true&&l.binary==null){l.binary=true
}l=k(l,JSZip.defaults);
l.date=l.date||new Date();
return l
};
var d=function(l,n,p){var m=j(l);
if(m){a.call(this,m)
}p=g(p);
return this.files[l]={name:l,data:n,options:p}
};
var j=function(m){if(m.slice(-1)=="/"){m=m.substring(0,m.length-1)
}var l=m.lastIndexOf("/");
return l>0?m.substring(0,l):""
};
var a=function(l){if(l.slice(-1)!="/"){l+="/"
}if(!this.files[l]){var m=j(l);
if(m){a.call(this,m)
}d.call(this,l,"",{dir:true})
}return this.files[l]
};
var h=function(q,r,n){var p=r!==q.name,s=q.data,m=q.options,u,v;
u=m.date.getHours();
u=u<<6;
u=u|m.date.getMinutes();
u=u<<5;
u=u|m.date.getSeconds()/2;
v=m.date.getFullYear()-1980;
v=v<<4;
v=v|m.date.getMonth()+1;
v=v<<5;
v=v|m.date.getDate();
if(m.base64===true){s=JSZipBase64.decode(s)
}if(m.binary===false){s=this.utf8encode(s)
}var w=JSZip.compressions[n];
var l=w.compress(s);
var t="";
t+="\n\0";
t+=p?"\0\b":"\0\0";
t+=w.magic;
t+=b(u,2);
t+=b(v,2);
t+=b(this.crc32(s),4);
t+=b(l.length,4);
t+=b(s.length,4);
t+=b(r.length,2);
t+="\0\0";
return{header:t,compressedData:l}
};
return{load:function(m,l){throw new Error("Load method is not defined. Is the file jszip-load.js included ?")
},filter:function(q){var l=[],n,m,p,o;
for(n in this.files){p=this.files[n];
o=new f(p.name,p.data,k(p.options));
m=n.slice(this.root.length,n.length);
if(n.slice(0,this.root.length)===this.root&&q(m,o)){l.push(o)
}}return l
},file:function(l,n,p){if(arguments.length===1){if(l instanceof RegExp){var m=l;
return this.filter(function(o,q){return !q.options.dir&&m.test(o)
})
}else{return this.filter(function(o,q){return !q.options.dir&&o===l
})[0]||null
}}else{l=this.root+l;
d.call(this,l,n,p)
}return this
},folder:function(l){if(!l){throw new Error("folder : wrong argument")
}if(l instanceof RegExp){return this.filter(function(p,q){return q.options.dir&&l.test(p)
})
}var n=this.root+l;
var o=a.call(this,n);
var m=this.clone();
m.root=o.name;
return m
},remove:function(m){m=this.root+m;
var o=this.files[m];
if(!o){if(m.slice(-1)!="/"){m+="/"
}o=this.files[m]
}if(o){if(!o.options.dir){delete this.files[m]
}else{var l=this.filter(function(p,q){return q.name.slice(0,m.length)===m
});
for(var n=0;
n<l.length;
n++){delete this.files[l[n].name]
}}}return this
},generate:function(B){B=k(B||{},{base64:true,compression:"STORE"});
var A=B.compression.toUpperCase();
var v=[],l=[],p=0;
if(!JSZip.compressions[A]){throw A+" is not a valid compression method !"
}for(var m in this.files){if(!this.files.hasOwnProperty(m)){continue
}var r=this.files[m];
var t=this.utf8encode(r.name);
var s="",z="",u=h.call(this,r,t,A);
s=JSZip.signature.LOCAL_FILE_HEADER+u.header+t+u.compressedData;
z=JSZip.signature.CENTRAL_FILE_HEADER+"\0"+u.header+"\0\0\0\0\0\0"+(this.files[m].dir===true?"\0\0\0":"\0\0\0\0")+b(p,4)+t;
p+=s.length;
l.push(s);
v.push(z)
}var w=l.join("");
var q=v.join("");
var o="";
o=JSZip.signature.CENTRAL_DIRECTORY_END+"\0\0\0\0"+b(l.length,2)+b(l.length,2)+b(q.length,4)+b(w.length,4)+"\0\0";
var n=w+q+o;
return B.base64?JSZipBase64.encode(n):n
},crc32:function(q,o){if(q===""||typeof q==="undefined"){return 0
}var n=[0,1996959894,3993919788,2567524794,124634137,1886057615,3915621685,2657392035,249268274,2044508324,3772115230,2547177864,162941995,2125561021,3887607047,2428444049,498536548,1789927666,4089016648,2227061214,450548861,1843258603,4107580753,2211677639,325883990,1684777152,4251122042,2321926636,335633487,1661365465,4195302755,2366115317,997073096,1281953886,3579855332,2724688242,1006888145,1258607687,3524101629,2768942443,901097722,1119000684,3686517206,2898065728,853044451,1172266101,3705015759,2882616665,651767980,1373503546,3369554304,3218104598,565507253,1454621731,3485111705,3099436303,671266974,1594198024,3322730930,2970347812,795835527,1483230225,3244367275,3060149565,1994146192,31158534,2563907772,4023717930,1907459465,112637215,2680153253,3904427059,2013776290,251722036,2517215374,3775830040,2137656763,141376813,2439277719,3865271297,1802195444,476864866,2238001368,4066508878,1812370925,453092731,2181625025,4111451223,1706088902,314042704,2344532202,4240017532,1658658271,366619977,2362670323,4224994405,1303535960,984961486,2747007092,3569037538,1256170817,1037604311,2765210733,3554079995,1131014506,879679996,2909243462,3663771856,1141124467,855842277,2852801631,3708648649,1342533948,654459306,3188396048,3373015174,1466479909,544179635,3110523913,3462522015,1591671054,702138776,2966460450,3352799412,1504918807,783551873,3082640443,3233442989,3988292384,2596254646,62317068,1957810842,3939845945,2647816111,81470997,1943803523,3814918930,2489596804,225274430,2053790376,3826175755,2466906013,167816743,2097651377,4027552580,2265490386,503444072,1762050814,4150417245,2154129355,426522225,1852507879,4275313526,2312317920,282753626,1742555852,4189708143,2394877945,397917763,1622183637,3604390888,2714866558,953729732,1340076626,3518719985,2797360999,1068828381,1219638859,3624741850,2936675148,906185462,1090812512,3747672003,2825379669,829329135,1181335161,3412177804,3160834842,628085408,1382605366,3423369109,3138078467,570562233,1426400815,3317316542,2998733608,733239954,1555261956,3268935591,3050360625,752459403,1541320221,2607071920,3965973030,1969922972,40735498,2617837225,3943577151,1913087877,83908371,2512341634,3803740692,2075208622,213261112,2463272603,3855990285,2094854071,198958881,2262029012,4057260610,1759359992,534414190,2176718541,4139329115,1873836001,414664567,2282248934,4279200368,1711684554,285281116,2405801727,4167216745,1634467795,376229701,2685067896,3608007406,1308918612,956543938,2808555105,3495958263,1231636301,1047427035,2932959818,3654703836,1088359270,936918000,2847714899,3736837829,1202900863,817233897,3183342108,3401237130,1404277552,615818150,3134207493,3453421203,1423857449,601450431,3009837614,3294710456,1567103746,711928724,3020668471,3272380065,1510334235,755167117];
if(typeof o=="undefined"){o=0
}var l=0;
var r=0;
o=o^-1;
for(var m=0,p=q.length;
m<p;
m++){r=(o^q.charCodeAt(m))&255;
l=n[r];
o=o>>>8^l
}return o^-1
},clone:function(){var l=new JSZip();
for(var m in this){if(typeof this[m]!=="function"){l[m]=this[m]
}}return l
},utf8encode:function(m){m=m.replace(/\r\n/g,"\n");
var l="";
for(var p=0;
p<m.length;
p++){var o=m.charCodeAt(p);
if(o<128){l+=String.fromCharCode(o)
}else{if(o>127&&o<2048){l+=String.fromCharCode(o>>6|192);
l+=String.fromCharCode(o&63|128)
}else{l+=String.fromCharCode(o>>12|224);
l+=String.fromCharCode(o>>6&63|128);
l+=String.fromCharCode(o&63|128)
}}}return l
},utf8decode:function(l){var n="";
var p=0;
var r=0,q=0,o=0,m=0;
while(p<l.length){r=l.charCodeAt(p);
if(r<128){n+=String.fromCharCode(r);
p++
}else{if(r>191&&r<224){o=l.charCodeAt(p+1);
n+=String.fromCharCode((r&31)<<6|o&63);
p+=2
}else{o=l.charCodeAt(p+1);
m=l.charCodeAt(p+2);
n+=String.fromCharCode((r&15)<<12|(o&63)<<6|m&63);
p+=3
}}}return n
}}
}();
JSZip.compressions={STORE:{magic:"\0\0",compress:function(a){return a
},uncompress:function(a){return a
}}};
var JSZipBase64=function(){var a="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";
return{encode:function(g,f){var b="";
var o,m,k,n,l,j,h;
var d=0;
while(d<g.length){o=g.charCodeAt(d++);
m=g.charCodeAt(d++);
k=g.charCodeAt(d++);
n=o>>2;
l=(o&3)<<4|m>>4;
j=(m&15)<<2|k>>6;
h=k&63;
if(isNaN(m)){j=h=64
}else{if(isNaN(k)){h=64
}}b=b+a.charAt(n)+a.charAt(l)+a.charAt(j)+a.charAt(h)
}return b
},decode:function(g,f){var b="";
var o,m,k;
var n,l,j,h;
var d=0;
g=g.replace(/[^A-Za-z0-9\+\/\=]/g,"");
while(d<g.length){n=a.indexOf(g.charAt(d++));
l=a.indexOf(g.charAt(d++));
j=a.indexOf(g.charAt(d++));
h=a.indexOf(g.charAt(d++));
o=n<<2|l>>4;
m=(l&15)<<4|j>>2;
k=(j&3)<<6|h;
b=b+String.fromCharCode(o);
if(j!=64){b=b+String.fromCharCode(m)
}if(h!=64){b=b+String.fromCharCode(k)
}}return b
}}
}();
if(!JSZip){throw"JSZip not defined"
}(function(){var ap=32768;
var aY=0;
var g=1;
var bt=2;
var bk=6;
var S=true;
var ba=32768;
var bi=64;
var by=1024*8;
var a2=2*ap;
var ac=3;
var bx=258;
var G=16;
var Z=8192;
var j=13;
if(Z>ba){alert("error: zip_INBUFSIZ is too small")
}if(ap<<1>1<<G){alert("error: zip_WSIZE is too large")
}if(j>G-1){alert("error: zip_HASH_BITS is too large")
}if(j<8||bx!=258){alert("error: Code too clever")
}var a6=Z;
var az=1<<j;
var bb=az-1;
var aX=ap-1;
var X=0;
var aa=4096;
var bv=bx+ac+1;
var E=ap-bv;
var s=1;
var bD=15;
var aQ=7;
var aF=29;
var P=256;
var U=256;
var aq=P+1+aF;
var bs=30;
var v=19;
var bl=16;
var aW=17;
var bz=18;
var br=2*aq+1;
var aI=parseInt((j+ac-1)/ac);
var aw;
var bC,l;
var Q;
var a4=null;
var a9,a8;
var f;
var bq;
var d;
var at;
var D;
var ao;
var av;
var bc;
var an;
var t;
var ae;
var af;
var aK;
var bm;
var T;
var u;
var C;
var ad;
var N;
var aH;
var n;
var q;
var K;
var aZ;
var I;
var o;
var ay;
var ak;
var J;
var m;
var H;
var bg;
var h;
var p;
var aN;
var bp;
var ab;
var bu;
var bw;
var aE;
var R;
var a;
var aB;
var a1;
var L;
var B;
var ai;
var aV;
var bj;
var b;
var bF=function(){this.fc=0;
this.dl=0
};
var r=function(){this.dyn_tree=null;
this.static_tree=null;
this.extra_bits=null;
this.extra_base=0;
this.elems=0;
this.max_length=0;
this.max_code=0
};
var W=function(bK,bJ,bM,bL){this.good_length=bK;
this.max_lazy=bJ;
this.nice_length=bM;
this.max_chain=bL
};
var bn=function(){this.next=null;
this.len=0;
this.ptr=new Array(by);
this.off=0
};
var aJ=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0);
var z=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13);
var O=new Array(0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,2,3,7);
var aL=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15);
var aU=new Array(new W(0,0,0,0),new W(4,4,8,4),new W(4,5,16,8),new W(4,6,32,32),new W(4,4,16,16),new W(8,16,32,32),new W(8,16,128,128),new W(8,32,128,256),new W(32,128,258,1024),new W(32,258,258,4096));
var ag=function(bK){var bJ;
if(!bK){bK=bk
}else{if(bK<1){bK=1
}else{if(bK>9){bK=9
}}}n=bK;
Q=false;
C=false;
if(a4!=null){return
}aw=bC=l=null;
a4=new Array(by);
bq=new Array(a2);
d=new Array(a6);
at=new Array(ba+bi);
D=new Array(1<<G);
aZ=new Array(br);
for(bJ=0;
bJ<br;
bJ++){aZ[bJ]=new bF()
}I=new Array(2*bs+1);
for(bJ=0;
bJ<2*bs+1;
bJ++){I[bJ]=new bF()
}o=new Array(aq+2);
for(bJ=0;
bJ<aq+2;
bJ++){o[bJ]=new bF()
}ay=new Array(bs);
for(bJ=0;
bJ<bs;
bJ++){ay[bJ]=new bF()
}ak=new Array(2*v+1);
for(bJ=0;
bJ<2*v+1;
bJ++){ak[bJ]=new bF()
}J=new r();
m=new r();
H=new r();
bg=new Array(bD+1);
h=new Array(2*aq+1);
bp=new Array(2*aq+1);
ab=new Array(bx-ac+1);
bu=new Array(512);
bw=new Array(aF);
aE=new Array(bs);
R=new Array(parseInt(Z/8))
};
var aD=function(){aw=bC=l=null;
a4=null;
bq=null;
d=null;
at=null;
D=null;
aZ=null;
I=null;
o=null;
ay=null;
ak=null;
J=null;
m=null;
H=null;
bg=null;
h=null;
bp=null;
ab=null;
bu=null;
bw=null;
aE=null;
R=null
};
var aA=function(bJ){bJ.next=aw;
aw=bJ
};
var Y=function(){var bJ;
if(aw!=null){bJ=aw;
aw=aw.next
}else{bJ=new bn()
}bJ.next=null;
bJ.len=bJ.off=0;
return bJ
};
var am=function(bJ){return D[ap+bJ]
};
var al=function(bJ,bK){return D[ap+bJ]=bK
};
var V=function(bJ){a4[a8+a9++]=bJ;
if(a8+a9==by){k()
}};
var aS=function(bJ){bJ&=65535;
if(a8+a9<by-2){a4[a8+a9++]=bJ&255;
a4[a8+a9++]=bJ>>>8
}else{V(bJ&255);
V(bJ>>>8)
}};
var aG=function(){an=(an<<aI^bq[T+ac-1]&255)&bb;
t=am(an);
D[T&aX]=t;
al(an,T)
};
var bh=function(bK,bJ){bA(bJ[bK].fc,bJ[bK].dl)
};
var aP=function(bJ){return(bJ<256?bu[bJ]:bu[256+(bJ>>7)])&255
};
var aj=function(bK,bL,bJ){return bK[bL].fc<bK[bJ].fc||bK[bL].fc==bK[bJ].fc&&bp[bL]<=bp[bJ]
};
var bf=function(bM,bK,bL){var bJ;
for(bJ=0;
bJ<bL&&b<bj.length;
bJ++){bM[bK+bJ]=bj.charCodeAt(b++)&255
}return bJ
};
var bE=function(){var bJ;
for(bJ=0;
bJ<az;
bJ++){D[ap+bJ]=0
}aH=aU[n].max_lazy;
q=aU[n].good_length;
if(!S){K=aU[n].nice_length
}N=aU[n].max_chain;
T=0;
bc=0;
ad=bf(bq,0,2*ap);
if(ad<=0){C=true;
ad=0;
return
}C=false;
while(ad<bv&&!C){ah()
}an=0;
for(bJ=0;
bJ<ac-1;
bJ++){an=(an<<aI^bq[bJ]&255)&bb
}};
var be=function(bO){var bQ=N;
var bL=T;
var bM;
var bP;
var bK=bm;
var bN=T>E?T-E:X;
var bJ=T+bx;
var bS=bq[bL+bK-1];
var bR=bq[bL+bK];
if(bm>=q){bQ>>=2
}do{bM=bO;
if(bq[bM+bK]!=bR||bq[bM+bK-1]!=bS||bq[bM]!=bq[bL]||bq[++bM]!=bq[bL+1]){continue
}bL+=2;
bM++;
do{}while(bq[++bL]==bq[++bM]&&bq[++bL]==bq[++bM]&&bq[++bL]==bq[++bM]&&bq[++bL]==bq[++bM]&&bq[++bL]==bq[++bM]&&bq[++bL]==bq[++bM]&&bq[++bL]==bq[++bM]&&bq[++bL]==bq[++bM]&&bL<bJ);
bP=bx-(bJ-bL);
bL=bJ-bx;
if(bP>bK){u=bO;
bK=bP;
if(S){if(bP>=bx){break
}}else{if(bP>=K){break
}}bS=bq[bL+bK-1];
bR=bq[bL+bK]
}}while((bO=D[bO&aX])>bN&&--bQ!=0);
return bK
};
var ah=function(){var bL,bJ;
var bK=a2-ad-T;
if(bK==-1){bK--
}else{if(T>=ap+E){for(bL=0;
bL<ap;
bL++){bq[bL]=bq[bL+ap]
}u-=ap;
T-=ap;
bc-=ap;
for(bL=0;
bL<az;
bL++){bJ=am(bL);
al(bL,bJ>=ap?bJ-ap:X)
}for(bL=0;
bL<ap;
bL++){bJ=D[bL];
D[bL]=bJ>=ap?bJ-ap:X
}bK+=ap
}}if(!C){bL=bf(bq,T+ad,bK);
if(bL<=0){C=true
}else{ad+=bL
}}};
var bB=function(){while(ad!=0&&bC==null){var bJ;
aG();
if(t!=X&&T-t<=E){aK=be(t);
if(aK>ad){aK=ad
}}if(aK>=ac){bJ=bo(T-u,aK-ac);
ad-=aK;
if(aK<=aH){aK--;
do{T++;
aG()
}while(--aK!=0);
T++
}else{T+=aK;
aK=0;
an=bq[T]&255;
an=(an<<aI^bq[T+1]&255)&bb
}}else{bJ=bo(0,bq[T]&255);
ad--;
T++
}if(bJ){w(0);
bc=T
}while(ad<bv&&!C){ah()
}}};
var a0=function(){while(ad!=0&&bC==null){aG();
bm=aK;
ae=u;
aK=ac-1;
if(t!=X&&bm<aH&&T-t<=E){aK=be(t);
if(aK>ad){aK=ad
}if(aK==ac&&T-u>aa){aK--
}}if(bm>=ac&&aK<=bm){var bJ;
bJ=bo(T-1-ae,bm-ac);
ad-=bm-1;
bm-=2;
do{T++;
aG()
}while(--bm!=0);
af=0;
aK=ac-1;
T++;
if(bJ){w(0);
bc=T
}}else{if(af!=0){if(bo(0,bq[T-1]&255)){w(0);
bc=T
}T++;
ad--
}else{af=1;
T++;
ad--
}}while(ad<bv&&!C){ah()
}}};
var aO=function(){if(C){return
}ao=0;
av=0;
a3();
bE();
bC=null;
a9=0;
a8=0;
if(n<=3){bm=ac-1;
aK=0
}else{aK=ac-1;
af=0
}f=false
};
var A=function(bM,bK,bJ){var bL;
if(!Q){aO();
Q=true;
if(ad==0){f=true;
return 0
}}if((bL=bG(bM,bK,bJ))==bJ){return bJ
}if(f){return bL
}if(n<=3){bB()
}else{a0()
}if(ad==0){if(af!=0){bo(0,bq[T-1]&255)
}w(1);
f=true
}return bL+bG(bM,bL+bK,bJ-bL)
};
var bG=function(bP,bN,bK){var bO,bL,bJ;
bO=0;
while(bC!=null&&bO<bK){bL=bK-bO;
if(bL>bC.len){bL=bC.len
}for(bJ=0;
bJ<bL;
bJ++){bP[bN+bO+bJ]=bC.ptr[bC.off+bJ]
}bC.off+=bL;
bC.len-=bL;
bO+=bL;
if(bC.len==0){var bM;
bM=bC;
bC=bC.next;
aA(bM)
}}if(bO==bK){return bO
}if(a8<a9){bL=bK-bO;
if(bL>a9-a8){bL=a9-a8
}for(bJ=0;
bJ<bL;
bJ++){bP[bN+bO+bJ]=a4[a8+bJ]
}a8+=bL;
bO+=bL;
if(a9==a8){a9=a8=0
}}return bO
};
var a3=function(){var bN;
var bL;
var bK;
var bJ;
var bM;
if(ay[0].dl!=0){return
}J.dyn_tree=aZ;
J.static_tree=o;
J.extra_bits=aJ;
J.extra_base=P+1;
J.elems=aq;
J.max_length=bD;
J.max_code=0;
m.dyn_tree=I;
m.static_tree=ay;
m.extra_bits=z;
m.extra_base=0;
m.elems=bs;
m.max_length=bD;
m.max_code=0;
H.dyn_tree=ak;
H.static_tree=null;
H.extra_bits=O;
H.extra_base=0;
H.elems=v;
H.max_length=aQ;
H.max_code=0;
bK=0;
for(bJ=0;
bJ<aF-1;
bJ++){bw[bJ]=bK;
for(bN=0;
bN<1<<aJ[bJ];
bN++){ab[bK++]=bJ
}}ab[bK-1]=bJ;
bM=0;
for(bJ=0;
bJ<16;
bJ++){aE[bJ]=bM;
for(bN=0;
bN<1<<z[bJ];
bN++){bu[bM++]=bJ
}}bM>>=7;
for(;
bJ<bs;
bJ++){aE[bJ]=bM<<7;
for(bN=0;
bN<1<<z[bJ]-7;
bN++){bu[256+bM++]=bJ
}}for(bL=0;
bL<=bD;
bL++){bg[bL]=0
}bN=0;
while(bN<=143){o[bN++].dl=8;
bg[8]++
}while(bN<=255){o[bN++].dl=9;
bg[9]++
}while(bN<=279){o[bN++].dl=7;
bg[7]++
}while(bN<=287){o[bN++].dl=8;
bg[8]++
}a7(o,aq+1);
for(bN=0;
bN<bs;
bN++){ay[bN].dl=5;
ay[bN].fc=au(bN,5)
}ax()
};
var ax=function(){var bJ;
for(bJ=0;
bJ<aq;
bJ++){aZ[bJ].fc=0
}for(bJ=0;
bJ<bs;
bJ++){I[bJ].fc=0
}for(bJ=0;
bJ<v;
bJ++){ak[bJ].fc=0
}aZ[U].fc=1;
ai=aV=0;
a=aB=a1=0;
L=0;
B=1
};
var M=function(bJ,bL){var bK=h[bL];
var bM=bL<<1;
while(bM<=p){if(bM<p&&aj(bJ,h[bM+1],h[bM])){bM++
}if(aj(bJ,bK,h[bM])){break
}h[bL]=h[bM];
bL=bM;
bM<<=1
}h[bL]=bK
};
var ar=function(bR){var bW=bR.dyn_tree;
var bM=bR.extra_bits;
var bJ=bR.extra_base;
var bS=bR.max_code;
var bU=bR.max_length;
var bV=bR.static_tree;
var bP;
var bK,bL;
var bT;
var bO;
var bQ;
var bN=0;
for(bT=0;
bT<=bD;
bT++){bg[bT]=0
}bW[h[aN]].dl=0;
for(bP=aN+1;
bP<br;
bP++){bK=h[bP];
bT=bW[bW[bK].dl].dl+1;
if(bT>bU){bT=bU;
bN++
}bW[bK].dl=bT;
if(bK>bS){continue
}bg[bT]++;
bO=0;
if(bK>=bJ){bO=bM[bK-bJ]
}bQ=bW[bK].fc;
ai+=bQ*(bT+bO);
if(bV!=null){aV+=bQ*(bV[bK].dl+bO)
}}if(bN==0){return
}do{bT=bU-1;
while(bg[bT]==0){bT--
}bg[bT]--;
bg[bT+1]+=2;
bg[bU]--;
bN-=2
}while(bN>0);
for(bT=bU;
bT!=0;
bT--){bK=bg[bT];
while(bK!=0){bL=h[--bP];
if(bL>bS){continue
}if(bW[bL].dl!=bT){ai+=(bT-bW[bL].dl)*bW[bL].fc;
bW[bL].fc=bT
}bK--
}}};
var a7=function(bK,bP){var bM=new Array(bD+1);
var bL=0;
var bN;
var bO;
for(bN=1;
bN<=bD;
bN++){bL=bL+bg[bN-1]<<1;
bM[bN]=bL
}for(bO=0;
bO<=bP;
bO++){var bJ=bK[bO].dl;
if(bJ==0){continue
}bK[bO].fc=au(bM[bJ]++,bJ)
}};
var bd=function(bO){var bR=bO.dyn_tree;
var bQ=bO.static_tree;
var bJ=bO.elems;
var bK,bM;
var bP=-1;
var bL=bJ;
p=0;
aN=br;
for(bK=0;
bK<bJ;
bK++){if(bR[bK].fc!=0){h[++p]=bP=bK;
bp[bK]=0
}else{bR[bK].dl=0
}}while(p<2){var bN=h[++p]=bP<2?++bP:0;
bR[bN].fc=1;
bp[bN]=0;
ai--;
if(bQ!=null){aV-=bQ[bN].dl
}}bO.max_code=bP;
for(bK=p>>1;
bK>=1;
bK--){M(bR,bK)
}do{bK=h[s];
h[s]=h[p--];
M(bR,s);
bM=h[s];
h[--aN]=bK;
h[--aN]=bM;
bR[bL].fc=bR[bK].fc+bR[bM].fc;
if(bp[bK]>bp[bM]+1){bp[bL]=bp[bK]
}else{bp[bL]=bp[bM]+1
}bR[bK].dl=bR[bM].dl=bL;
h[s]=bL++;
M(bR,s)
}while(p>=2);
h[--aN]=h[s];
ar(bO);
a7(bR,bP)
};
var aC=function(bR,bQ){var bK;
var bO=-1;
var bJ;
var bM=bR[0].dl;
var bN=0;
var bL=7;
var bP=4;
if(bM==0){bL=138;
bP=3
}bR[bQ+1].dl=65535;
for(bK=0;
bK<=bQ;
bK++){bJ=bM;
bM=bR[bK+1].dl;
if(++bN<bL&&bJ==bM){continue
}else{if(bN<bP){ak[bJ].fc+=bN
}else{if(bJ!=0){if(bJ!=bO){ak[bJ].fc++
}ak[bl].fc++
}else{if(bN<=10){ak[aW].fc++
}else{ak[bz].fc++
}}}}bN=0;
bO=bJ;
if(bM==0){bL=138;
bP=3
}else{if(bJ==bM){bL=6;
bP=3
}else{bL=7;
bP=4
}}}};
var aM=function(bR,bQ){var bK;
var bO=-1;
var bJ;
var bM=bR[0].dl;
var bN=0;
var bL=7;
var bP=4;
if(bM==0){bL=138;
bP=3
}for(bK=0;
bK<=bQ;
bK++){bJ=bM;
bM=bR[bK+1].dl;
if(++bN<bL&&bJ==bM){continue
}else{if(bN<bP){do{bh(bJ,ak)
}while(--bN!=0)
}else{if(bJ!=0){if(bJ!=bO){bh(bJ,ak);
bN--
}bh(bl,ak);
bA(bN-3,2)
}else{if(bN<=10){bh(aW,ak);
bA(bN-3,3)
}else{bh(bz,ak);
bA(bN-11,7)
}}}}bN=0;
bO=bJ;
if(bM==0){bL=138;
bP=3
}else{if(bJ==bM){bL=6;
bP=3
}else{bL=7;
bP=4
}}}};
var F=function(){var bJ;
aC(aZ,J.max_code);
aC(I,m.max_code);
bd(H);
for(bJ=v-1;
bJ>=3;
bJ--){if(ak[aL[bJ]].dl!=0){break
}}ai+=3*(bJ+1)+5+5+4;
return bJ
};
var bI=function(bK,bJ,bL){var bM;
bA(bK-257,5);
bA(bJ-1,5);
bA(bL-4,4);
for(bM=0;
bM<bL;
bM++){bA(ak[aL[bM]].dl,3)
}aM(aZ,bK-1);
aM(I,bJ-1)
};
var w=function(bJ){var bL,bK;
var bN;
var bO;
bO=T-bc;
R[a1]=L;
bd(J);
bd(m);
bN=F();
bL=ai+3+7>>3;
bK=aV+3+7>>3;
if(bK<=bL){bL=bK
}if(bO+4<=bL&&bc>=0){var bM;
bA((aY<<1)+bJ,3);
bH();
aS(bO);
aS(~bO);
for(bM=0;
bM<bO;
bM++){V(bq[bc+bM])
}}else{if(bK==bL){bA((g<<1)+bJ,3);
aR(o,ay)
}else{bA((bt<<1)+bJ,3);
bI(J.max_code+1,m.max_code+1,bN+1);
aR(aZ,I)
}}ax();
if(bJ!=0){bH()
}};
var bo=function(bN,bL){at[a++]=bL;
if(bN==0){aZ[bL].fc++
}else{bN--;
aZ[ab[bL]+P+1].fc++;
I[aP(bN)].fc++;
d[aB++]=bN;
L|=B
}B<<=1;
if((a&7)==0){R[a1++]=L;
L=0;
B=1
}if(n>2&&(a&4095)==0){var bJ=a*8;
var bM=T-bc;
var bK;
for(bK=0;
bK<bs;
bK++){bJ+=I[bK].fc*(5+z[bK])
}bJ>>=3;
if(aB<parseInt(a/2)&&bJ<parseInt(bM/2)){return true
}}return a==Z-1||aB==a6
};
var aR=function(bP,bN){var bR;
var bK;
var bL=0;
var bS=0;
var bO=0;
var bQ=0;
var bJ;
var bM;
if(a!=0){do{if((bL&7)==0){bQ=R[bO++]
}bK=at[bL++]&255;
if((bQ&1)==0){bh(bK,bP)
}else{bJ=ab[bK];
bh(bJ+P+1,bP);
bM=aJ[bJ];
if(bM!=0){bK-=bw[bJ];
bA(bK,bM)
}bR=d[bS++];
bJ=aP(bR);
bh(bJ,bN);
bM=z[bJ];
if(bM!=0){bR-=aE[bJ];
bA(bR,bM)
}}bQ>>=1
}while(bL<a)
}bh(U,bP)
};
var a5=16;
var bA=function(bK,bJ){if(av>a5-bJ){ao|=bK<<av;
aS(ao);
ao=bK>>a5-av;
av+=bJ-a5
}else{ao|=bK<<av;
av+=bJ
}};
var au=function(bL,bJ){var bK=0;
do{bK|=bL&1;
bL>>=1;
bK<<=1
}while(--bJ>0);
return bK>>1
};
var bH=function(){if(av>8){aS(ao)
}else{if(av>0){V(ao)
}}ao=0;
av=0
};
var k=function(){if(a9!=0){var bK,bJ;
bK=Y();
if(bC==null){bC=l=bK
}else{l=l.next=bK
}bK.len=a9-a8;
for(bJ=0;
bJ<bK.len;
bJ++){bK.ptr[bJ]=a4[a8+bJ]
}a9=a8=0
}};
var aT=function(bN,bP){var bL,bK;
bj=bN;
b=0;
if(typeof bP=="undefined"){bP=bk
}ag(bP);
var bO=new Array(1024);
var bM=[];
while((bL=A(bO,0,bO.length))>0){var bJ=new Array(bL);
for(bK=0;
bK<bL;
bK++){bJ[bK]=String.fromCharCode(bO[bK])
}bM[bM.length]=bJ.join("")
}bj=null;
return bM.join("")
};
if(!JSZip.compressions.DEFLATE){JSZip.compressions.DEFLATE={magic:"\b\0",compress:aT}
}else{JSZip.compressions.DEFLATE.compress=aT
}})();
if(!JSZip){throw"JSZip not defined"
}(function(){var T;
var q=32768;
var A=0;
var M=1;
var l=2;
var X=9;
var k=6;
var v=32768;
var a=64;
var G;
var n;
var V=null;
var b;
var Q,H;
var u;
var t;
var Z;
var R;
var Y;
var C;
var p,r;
var h,m;
var F;
var J;
var U=new Array(0,1,3,7,15,31,63,127,255,511,1023,2047,4095,8191,16383,32767,65535);
var d=new Array(3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,0,0);
var P=new Array(0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,99,99);
var N=new Array(1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577);
var D=new Array(0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13);
var s=new Array(16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15);
function B(){this.next=null;
this.list=null
}function L(){this.e=0;
this.b=0;
this.n=0;
this.t=null
}function o(aC,aq,al,aA,az,aw){this.BMAX=16;
this.N_MAX=288;
this.status=0;
this.root=null;
this.m=0;
var aD;
var aB=new Array(this.BMAX+1);
var aa;
var ay;
var ax;
var av;
var au;
var at;
var ar;
var ab=new Array(this.BMAX+1);
var ao;
var ac;
var an;
var am=new L();
var ak=new Array(this.BMAX);
var aj=new Array(this.N_MAX);
var ai;
var ag=new Array(this.BMAX+1);
var ah;
var af;
var ae;
var ap;
var ad;
ad=this.root=null;
for(au=0;
au<aB.length;
au++){aB[au]=0
}for(au=0;
au<ab.length;
au++){ab[au]=0
}for(au=0;
au<ak.length;
au++){ak[au]=null
}for(au=0;
au<aj.length;
au++){aj[au]=0
}for(au=0;
au<ag.length;
au++){ag[au]=0
}aa=aq>256?aC[256]:this.BMAX;
ao=aC;
ac=0;
au=aq;
do{aB[ao[ac]]++;
ac++
}while(--au>0);
if(aB[0]==aq){this.root=null;
this.m=0;
this.status=0;
return
}for(at=1;
at<=this.BMAX;
at++){if(aB[at]!=0){break
}}ar=at;
if(aw<at){aw=at
}for(au=this.BMAX;
au!=0;
au--){if(aB[au]!=0){break
}}ax=au;
if(aw>au){aw=au
}for(af=1<<at;
at<au;
at++,af<<=1){if((af-=aB[at])<0){this.status=2;
this.m=aw;
return
}}if((af-=aB[au])<0){this.status=2;
this.m=aw;
return
}aB[au]+=af;
ag[1]=at=0;
ao=aB;
ac=1;
ah=2;
while(--au>0){ag[ah++]=at+=ao[ac++]
}ao=aC;
ac=0;
au=0;
do{if((at=ao[ac++])!=0){aj[ag[at]++]=au
}}while(++au<aq);
aq=ag[ax];
ag[0]=au=0;
ao=aj;
ac=0;
av=-1;
ai=ab[0]=0;
an=null;
ae=0;
for(;
ar<=ax;
ar++){aD=aB[ar];
while(aD-->0){while(ar>ai+ab[1+av]){ai+=ab[1+av];
av++;
ae=(ae=ax-ai)>aw?aw:ae;
if((ay=1<<(at=ar-ai))>aD+1){ay-=aD+1;
ah=ar;
while(++at<ae){if((ay<<=1)<=aB[++ah]){break
}ay-=aB[ah]
}}if(ai+at>aa&&ai<aa){at=aa-ai
}ae=1<<at;
ab[1+av]=at;
an=new Array(ae);
for(ap=0;
ap<ae;
ap++){an[ap]=new L()
}if(ad==null){ad=this.root=new B()
}else{ad=ad.next=new B()
}ad.next=null;
ad.list=an;
ak[av]=an;
if(av>0){ag[av]=au;
am.b=ab[av];
am.e=16+at;
am.t=an;
at=(au&(1<<ai)-1)>>ai-ab[av];
ak[av-1][at].e=am.e;
ak[av-1][at].b=am.b;
ak[av-1][at].n=am.n;
ak[av-1][at].t=am.t
}}am.b=ar-ai;
if(ac>=aq){am.e=99
}else{if(ao[ac]<al){am.e=ao[ac]<256?16:15;
am.n=ao[ac++]
}else{am.e=az[ao[ac]-al];
am.n=aA[ao[ac++]-al]
}}ay=1<<ar-ai;
for(at=au>>ai;
at<ae;
at+=ay){an[at].e=am.e;
an[at].b=am.b;
an[at].n=am.n;
an[at].t=am.t
}for(at=1<<ar-1;
(au&at)!=0;
at>>=1){au^=at
}au^=at;
while((au&(1<<ai)-1)!=ag[av]){ai-=ab[av];
av--
}}}this.m=ab[1];
this.status=af!=0&&ax!=1?1:0
}function g(){if(F.length==J){return -1
}return F.charCodeAt(J++)&255
}function W(aa){while(t<aa){u|=g()<<t;
t+=8
}}function w(aa){return u&U[aa]
}function f(aa){u>>=aa;
t-=aa
}function j(af,ad,ab){var ac;
var aa;
var ae;
if(ab==0){return 0
}ae=0;
for(;
;
){W(h);
aa=p.list[w(h)];
ac=aa.e;
while(ac>16){if(ac==99){return -1
}f(aa.b);
ac-=16;
W(ac);
aa=aa.t[w(ac)];
ac=aa.e
}f(aa.b);
if(ac==16){n&=q-1;
af[ad+ae++]=G[n++]=aa.n;
if(ae==ab){return ab
}continue
}if(ac==15){break
}W(ac);
Y=aa.n+w(ac);
f(ac);
W(m);
aa=r.list[w(m)];
ac=aa.e;
while(ac>16){if(ac==99){return -1
}f(aa.b);
ac-=16;
W(ac);
aa=aa.t[w(ac)];
ac=aa.e
}f(aa.b);
W(ac);
C=n-aa.n-w(ac);
f(ac);
while(Y>0&&ae<ab){Y--;
C&=q-1;
n&=q-1;
af[ad+ae++]=G[n++]=G[C++]
}if(ae==ab){return ab
}}Z=-1;
return ae
}function z(ad,ab,aa){var ac;
ac=t&7;
f(ac);
W(16);
ac=w(16);
f(16);
W(16);
if(ac!=(~u&65535)){return -1
}f(16);
Y=ac;
ac=0;
while(Y>0&&ac<aa){Y--;
n&=q-1;
W(8);
ad[ab+ac++]=G[n++]=w(8);
f(8)
}if(Y==0){Z=-1
}return ac
}function O(af,ae,ac){if(V==null){var ab;
var aa=new Array(288);
var ad;
for(ab=0;
ab<144;
ab++){aa[ab]=8
}for(;
ab<256;
ab++){aa[ab]=9
}for(;
ab<280;
ab++){aa[ab]=7
}for(;
ab<288;
ab++){aa[ab]=8
}Q=7;
ad=new o(aa,288,257,d,P,Q);
if(ad.status!=0){alert("HufBuild error: "+ad.status);
return -1
}V=ad.root;
Q=ad.m;
for(ab=0;
ab<30;
ab++){aa[ab]=5
}T=5;
ad=new o(aa,30,0,N,D,T);
if(ad.status>1){V=null;
alert("HufBuild error: "+ad.status);
return -1
}b=ad.root;
T=ad.m
}p=V;
r=b;
h=Q;
m=T;
return j(af,ae,ac)
}function E(ak,ac,am){var ag;
var af;
var ad;
var ab;
var al;
var ai;
var aa;
var ae;
var aj=new Array(286+30);
var ah;
for(ag=0;
ag<aj.length;
ag++){aj[ag]=0
}W(5);
aa=257+w(5);
f(5);
W(5);
ae=1+w(5);
f(5);
W(4);
ai=4+w(4);
f(4);
if(aa>286||ae>30){return -1
}for(af=0;
af<ai;
af++){W(3);
aj[s[af]]=w(3);
f(3)
}for(;
af<19;
af++){aj[s[af]]=0
}h=7;
ah=new o(aj,19,19,null,null,h);
if(ah.status!=0){return -1
}p=ah.root;
h=ah.m;
ab=aa+ae;
ag=ad=0;
while(ag<ab){W(h);
al=p.list[w(h)];
af=al.b;
f(af);
af=al.n;
if(af<16){aj[ag++]=ad=af
}else{if(af==16){W(2);
af=3+w(2);
f(2);
if(ag+af>ab){return -1
}while(af-->0){aj[ag++]=ad
}}else{if(af==17){W(3);
af=3+w(3);
f(3);
if(ag+af>ab){return -1
}while(af-->0){aj[ag++]=0
}ad=0
}else{W(7);
af=11+w(7);
f(7);
if(ag+af>ab){return -1
}while(af-->0){aj[ag++]=0
}ad=0
}}}}h=X;
ah=new o(aj,aa,257,d,P,h);
if(h==0){ah.status=1
}if(ah.status!=0){if(ah.status==1){}return -1
}p=ah.root;
h=ah.m;
for(ag=0;
ag<ae;
ag++){aj[ag]=aj[ag+aa]
}m=k;
ah=new o(aj,ae,0,N,D,m);
r=ah.root;
m=ah.m;
if(m==0&&aa>257){return -1
}if(ah.status==1){}if(ah.status!=0){return -1
}return j(ak,ac,am)
}function S(){var aa;
if(G==null){G=new Array(2*q)
}n=0;
u=0;
t=0;
Z=-1;
R=false;
Y=C=0;
p=null
}function K(ae,ac,ab){var ad,aa;
ad=0;
while(ad<ab){if(R&&Z==-1){return ad
}if(Y>0){if(Z!=A){while(Y>0&&ad<ab){Y--;
C&=q-1;
n&=q-1;
ae[ac+ad++]=G[n++]=G[C++]
}}else{while(Y>0&&ad<ab){Y--;
n&=q-1;
W(8);
ae[ac+ad++]=G[n++]=w(8);
f(8)
}if(Y==0){Z=-1
}}if(ad==ab){return ad
}}if(Z==-1){if(R){break
}W(1);
if(w(1)!=0){R=true
}f(1);
W(2);
Z=w(2);
f(2);
p=null;
Y=0
}switch(Z){case 0:aa=z(ae,ac+ad,ab-ad);
break;
case 1:if(p!=null){aa=j(ae,ac+ad,ab-ad)
}else{aa=O(ae,ac+ad,ab-ad)
}break;
case 2:if(p!=null){aa=j(ae,ac+ad,ab-ad)
}else{aa=E(ae,ac+ad,ab-ad)
}break;
default:aa=-1;
break
}if(aa==-1){if(R){return 0
}return -1
}ad+=aa
}return ad
}function I(ad){var ab,ae;
var ac,aa;
S();
F=ad;
J=0;
ae=new Array(1024);
ab="";
while((ac=K(ae,0,ae.length))>0){for(aa=0;
aa<ac;
aa++){ab+=String.fromCharCode(ae[aa])
}}F=null;
return ab
}if(!JSZip.compressions.DEFLATE){JSZip.compressions.DEFLATE={magic:"\b\0",uncompress:I}
}else{JSZip.compressions.DEFLATE.uncompress=I
}})();
(function(){var d=function(l){var j="",k,h;
for(h=0;
h<l.length;
h++){k=l.charCodeAt(h);
j+="\\x"+(k<10?"0":"")+k.toString(16)
}return j
};
var b=function(h){for(var j in JSZip.compressions){if(JSZip.compressions[j].magic===h){return JSZip.compressions[j]
}}return null
};
function g(h){this.stream=h;
this.index=0
}g.prototype={checkOffset:function(h){this.checkIndex(this.index+h)
},checkIndex:function(h){if(this.stream.length<h||h<0){throw new Error("End of stream reached (stream length = "+this.stream.length+", asked index = "+h+"). Corrupted zip ?")
}},setIndex:function(h){this.checkIndex(h);
this.index=h
},eof:function(){return this.index>=this.stream.length
},byteAt:function(h){return this.stream.charCodeAt(h)&255
},readByte:function(){this.checkOffset(1);
return this.byteAt(1+this.index++)
},readInt:function(k){var h=0,j;
this.checkOffset(k);
for(j=k-1;
j>=0;
j--){h=(h<<8)+this.byteAt(this.index+j)
}this.index+=k;
return h
},readString:function(k){var h="",j,l;
this.checkOffset(k);
for(j=0;
j<k;
j++){l=this.byteAt(this.index+j);
h+=String.fromCharCode(l)
}this.index+=k;
return h
},readDate:function(){var h=this.readInt(4);
return new Date((h>>25&127)+1980,(h>>21&15)-1,h>>16&31,h>>11&31,h>>5&63,(h&31)<<1)
}};
function f(h,j){this.options=h;
this.loadOptions=j
}f.prototype={isEncrypted:function(){return(this.bitFlag&1)===1
},hasDataDescriptor:function(){return(this.bitFlag&8)===8
},useUTF8:function(){return(this.bitFlag&2048)===2048
},isZIP64:function(){return this.options.zip64
},readLocalPartHeader:function(h){this.versionNeeded=h.readInt(2);
this.bitFlag=h.readInt(2);
this.compressionMethod=h.readString(2);
this.date=h.readDate();
this.crc32=h.readInt(4);
this.compressedSize=h.readInt(4);
this.uncompressedSize=h.readInt(4);
this.fileNameLength=h.readInt(2);
this.extraFieldsLength=h.readInt(2);
if(this.isEncrypted()){throw new Error("Encrypted zip are not supported")
}},readLocalPart:function(h){var j;
this.readLocalPartHeader(h);
this.fileName=h.readString(this.fileNameLength);
this.readExtraFields(h);
if(!this.hasDataDescriptor()){this.compressedFileData=h.readString(this.compressedSize)
}else{this.compressedFileData=this.findDataUntilDataDescriptor(h);
this.crc32=h.readInt(4);
this.compressedSize=h.readInt(this.isZIP64()?8:4);
this.uncompressedSize=h.readInt(this.isZIP64()?8:4);
if(this.compressedFileData.length!==this.compressedSize){throw new Error("Bug : data descriptor incorrectly read (size mismatch)")
}}this.uncompressedFileData=null;
j=b(this.compressionMethod);
if(j===null){throw new Error("Corrupted zip : compression "+d(this.compressionMethod)+" unknown (inner file : "+this.fileName+")")
}this.uncompressedFileData=j.uncompress(this.compressedFileData);
if(this.loadOptions.checkCRC32&&JSZip.prototype.crc32(this.uncompressedFileData)!==this.crc32){throw new Error("Corrupted zip : CRC32 mismatch")
}if(this.useUTF8()){this.fileName=JSZip.prototype.utf8decode(this.fileName)
}},findDataUntilDataDescriptor:function(h){var k="",j=h.readString(4),l;
while(j!==JSZip.signature.DATA_DESCRIPTOR){l=h.readString(1);
k+=j.slice(0,1);
j=(j+l).slice(-4)
}return k
},readCentralPart:function(h){this.versionMadeBy=h.readString(2);
this.readLocalPartHeader(h);
this.fileCommentLength=h.readInt(2);
this.diskNumberStart=h.readInt(2);
this.internalFileAttributes=h.readInt(2);
this.externalFileAttributes=h.readInt(4);
this.localHeaderOffset=h.readInt(4);
this.fileName=h.readString(this.fileNameLength);
this.readExtraFields(h);
this.fileComment=h.readString(this.fileCommentLength);
if(this.useUTF8()){this.fileName=JSZip.prototype.utf8decode(this.fileName);
this.fileComment=JSZip.prototype.utf8decode(this.fileComment)
}this.dir=this.externalFileAttributes&16?true:false
},parseZIP64ExtraField:function(h){var j=new g(this.extraFields[1].value);
if(this.uncompressedSize===-1){this.uncompressedSize=j.readInt(8)
}if(this.compressedSize===-1){this.compressedSize=j.readInt(8)
}if(this.localHeaderOffset===-1){this.localHeaderOffset=j.readInt(8)
}if(this.diskNumberStart===-1){this.diskNumberStart=j.readInt(4)
}},readExtraFields:function(j){var m=j.index,k,l,h;
this.extraFields=this.extraFields||{};
while(j.index<m+this.extraFieldsLength){k=j.readInt(2);
l=j.readInt(2);
h=j.readString(l);
this.extraFields[k]={id:k,length:l,value:h}
}if(this.isZIP64()&&this.extraFields[1]){this.parseZIP64ExtraField(j)
}}};
function a(j,h){this.files=[];
this.loadOptions=h;
if(j){this.load(j)
}}a.prototype={checkSignature:function(j){var h=this.reader.readString(4);
if(h!==j){throw new Error("Corrupted zip or bug : unexpected signature ("+d(h)+", expected "+d(j)+")")
}},readBlockEndOfCentral:function(){this.diskNumber=this.reader.readInt(2);
this.diskWithCentralDirStart=this.reader.readInt(2);
this.centralDirRecordsOnThisDisk=this.reader.readInt(2);
this.centralDirRecords=this.reader.readInt(2);
this.centralDirSize=this.reader.readInt(4);
this.centralDirOffset=this.reader.readInt(4);
this.zipCommentLength=this.reader.readInt(2);
this.zipComment=this.reader.readString(this.zipCommentLength)
},readBlockZip64EndOfCentral:function(){this.zip64EndOfCentralSize=this.reader.readInt(8);
this.versionMadeBy=this.reader.readString(2);
this.versionNeeded=this.reader.readInt(2);
this.diskNumber=this.reader.readInt(4);
this.diskWithCentralDirStart=this.reader.readInt(4);
this.centralDirRecordsOnThisDisk=this.reader.readInt(8);
this.centralDirRecords=this.reader.readInt(8);
this.centralDirSize=this.reader.readInt(8);
this.centralDirOffset=this.reader.readInt(8);
this.zip64ExtensibleData={};
var m=this.zip64EndOfCentralSize-44,j=0,k,l,h;
while(j<m){k=this.reader.readInt(2);
l=this.reader.readInt(4);
h=this.reader.readString(l);
this.zip64ExtensibleData[k]={id:k,length:l,value:h}
}},readBlockZip64EndOfCentralLocator:function(){this.diskWithZip64CentralDirStart=this.reader.readInt(4);
this.relativeOffsetEndOfZip64CentralDir=this.reader.readInt(8);
this.disksCount=this.reader.readInt(4);
if(this.disksCount>1){throw new Error("Multi-volumes zip are not supported")
}},readLocalFiles:function(){var j,h;
for(j=0;
j<this.files.length;
j++){h=this.files[j];
this.reader.setIndex(h.localHeaderOffset);
this.checkSignature(JSZip.signature.LOCAL_FILE_HEADER);
h.readLocalPart(this.reader)
}},readCentralDir:function(){var h;
this.reader.setIndex(this.centralDirOffset);
while(this.reader.readString(4)===JSZip.signature.CENTRAL_FILE_HEADER){h=new f({zip64:this.zip64},this.loadOptions);
h.readCentralPart(this.reader);
this.files.push(h)
}},readEndOfCentral:function(){var h=this.reader.stream.lastIndexOf(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);
if(h===-1){this.zip64=false;
h=this.reader.stream.lastIndexOf(JSZip.signature.CENTRAL_DIRECTORY_END);
if(h===-1){throw new Error("Corrupted zip : can't find end of central directory")
}this.reader.setIndex(h);
this.checkSignature(JSZip.signature.CENTRAL_DIRECTORY_END);
this.readBlockEndOfCentral()
}else{this.zip64=true;
this.reader.setIndex(h);
this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_LOCATOR);
this.readBlockZip64EndOfCentralLocator();
this.reader.setIndex(this.relativeOffsetEndOfZip64CentralDir);
this.checkSignature(JSZip.signature.ZIP64_CENTRAL_DIRECTORY_END);
this.readBlockZip64EndOfCentral()
}},load:function(h){this.reader=new g(h);
this.readEndOfCentral();
this.readCentralDir();
this.readLocalFiles()
}};
JSZip.prototype.load=function(n,j){var m,l,k,h;
j=j||{};
if(j.base64){n=JSZipBase64.decode(n)
}l=new a(n,j);
m=l.files;
for(k in m){h=m[k];
this.file(h.fileName,h.uncompressedFileData,{binary:true,date:h.date,dir:h.dir})
}return this
}
})();
if(typeof exports!=="undefined"){exports.JSZip=JSZip
}var SSF=(function(){var d={};
String.prototype.reverse=function(){return this.split("").reverse().join("")
};
var j=function(t){return String(t).reverse()
};
function s(u,t){return new Array(t+1).join(u)
}function g(u,z){var w=String(u);
return w.length>=z?w:(s(0,z-w.length)+w)
}var l={};
function b(t){for(var u in l){if(t[u]===undefined){t[u]=l[u]
}}}d.opts=l;
l.date1904=0;
l.output="";
l.mode="";
var p={1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"mm/dd/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@"};
var r=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]];
var a=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];
var k=function(t){if(typeof t==="boolean"){return t?"TRUE":"FALSE"
}};
d._general=k;
var h=function h(u,A){var z=Math.floor(u),B=Math.round(86400*(u-z)),D=0;
var t=[],w={D:z,T:B};
b(A=(A||{}));
if(A.date1904){z+=1462
}if(z===60){(t=[1900,2,29],D=3)
}else{if(z>60){--z
}var C=new Date(1900,0,1);
C.setDate(C.getDate()+z-1);
t=[C.getFullYear(),C.getMonth()+1,C.getDate()];
D=C.getDay();
if(A.mode==="excel"&&z<60){D=(D+6)%7
}}w.y=t[0],w.m=t[1],w.d=t[2];
w.S=B%60;
B=Math.floor(B/60);
w.M=B%60;
B=Math.floor(B/60);
w.H=B;
w.q=D;
return w
};
d.parse_date_code=h;
var f=function(u,t,v){switch(u){case"y":switch(t){case"y":case"yy":return g(v.y%100,2);
default:return v.y
}break;
case"m":switch(t){case"m":return v.m;
case"mm":return g(v.m,2);
case"mmm":return a[v.m-1][1];
case"mmmm":return a[v.m-1][2];
case"mmmmm":return a[v.m-1][0];
default:throw"bad month format: "+t
}break;
case"d":switch(t){case"d":return v.d;
case"dd":return g(v.d,2);
case"ddd":return r[v.q][0];
case"dddd":return r[v.q][1];
default:throw"bad day format: "+t
}break;
case"h":switch(t){case"h":return 1+(v.H+11)%12;
case"hh":return g(1+(v.H+11)%12,2);
default:throw"bad hour format: "+t
}break;
case"H":switch(t){case"h":return v.H;
case"hh":return g(v.H,2);
default:throw"bad hour format: "+t
}break;
case"M":switch(t){case"m":return v.M;
case"mm":return g(v.M,2);
default:throw"bad minute format: "+t
}break;
case"s":switch(t){case"s":return v.S;
case"ss":return g(v.S,2);
default:throw"bad second format: "+t
}break;
case"e":return v.y;
break;
case"A":return(v.h>=12?"P":"A")+t.substr(1);
default:throw"bad format type "+u+" in "+t
}};
function q(t){return t.reverse().split(/;(?!\\)/).reverse().map(j)
}d._split=q;
function n(A,G,t){var B=[],z="",C=0,E="",D="t",u={},w;
b(t=(t||{}));
var F="H";
while(C<A.length){switch((E=A[C])){case'"':for(z="";
A[++C]!=='"';
){z+=A[(A[C]==="\\"?++C:C)]
}B.push({t:"t",v:z});
break;
case"\\":B.push({t:"t",v:A[++C]});
++C;
break;
case"@":B.push({t:"T",v:G});
++C;
break;
case"m":case"d":case"y":case"h":case"s":case"e":if(!w){w=h(G,t)
}z=A[C];
while(A[++C]===E){z+=E
}if(E==="m"&&D.toLowerCase()==="h"){E="M"
}if(E==="h"){E=F
}u={t:E,v:z};
B.push(u);
D=E;
break;
case"A":u={t:E,v:"A"};
if(A.substr(C,3)==="A/P"){(F="h",C+=3)
}else{if(A.substr(C,5)==="AM/PM"){u.v="AM";
C+=5;
F="h"
}else{u.t="t"
}}B.push(u);
D=E;
break;
case"[":while(A[C++]!=="]"){}break;
default:if("$-+/():!^&'~{}<>= ".indexOf(E)===-1){throw"unrecognized character "+A[C]+" in "+A
}B.push({t:"t",v:E});
++C;
break
}}for(C=B.length-1,D="t";
C>=0;
--C){switch(B[C].t){case"h":case"H":B[C].t=F;
D="h";
break;
case"d":case"y":case"s":case"M":case"e":D=B[C].t;
break;
case"m":if(D==="s"){B[C].t="M"
}break
}}for(C=0;
C<B.length;
++C){switch(B[C].t){case"t":case"T":break;
case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"A":case"e":B[C].v=f(B[C].t,B[C].v,w);
B[C].t="t";
break;
default:throw"unrecognized type "+B[C].t
}}return B.map(function(v){return v.v
}).join("")
}d._eval=n;
function m(t,u){if(typeof t==="string"){t=q(t)
}if(typeof u!=="number"){return t[3]
}return u>0?t[0]:u<0?t[1]:t[2]
}var o=function o(t,u,z){b(z=(z||{}));
if(t===0){return k(u,z)
}if(typeof t==="number"){t=p[t]
}var w=m(t,u,z);
return n(w,u,z)
};
d._choose=m;
d._table=p;
d.load=function(u,t){p[t]=u
};
d.format=o;
return d
})();
var XLSX=(function(){function M(N){var P=N.split(/\s+/);
var O={"0":P[0]};
if(P.length===1){return O
}N.match(/(\w+)="([^"]*)"/g).map(function(Q){var R=Q.match(/(\w+)="([^"]*)"/);
O[R[1]]=R[2]
});
return O
}var u={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"};
function h(O){var N=O+"";
for(var P in u){N=N.replace(new RegExp(P,"g"),u[P])
}return N.replace(/_x([0-9a-fA-F]*)_/g,function(Q,R){return _chr(parseInt(R,16))
})
}function b(O,N){switch(O){case"0":case 0:case"false":case"FALSE":return false;
case"1":case 1:case"true":case"TRUE":return true;
default:throw"bad boolean value "+O+" in "+(N||"?")
}}var D=function(T){var O="",Q=0,S=0,R=0,P=0,N=0;
while(Q<T.length){S=T.charCodeAt(Q++);
if(S<128){O+=_chr(S)
}else{P=T.charCodeAt(Q++);
if(S>191&&S<224){O+=_chr((S&31)<<6|P&63)
}else{N=T.charCodeAt(Q++);
O+=_chr((S&15)<<12|(P&63)<<6|N&63)
}}}return O
};
function L(O,N){return new RegExp("<"+O+'(?: xml:space="preserve")?>([^\u2603]*)</'+O+">",(N||"")+"m")
}function q(Q){var O=M(Q);
var P=Q.match(new RegExp("<vt:"+O.baseType+">(.*?)</vt:"+O.baseType+">","g"));
if(P.length!=O.size){throw"unexpected vector length "+P.length+" != "+O.size
}var N=[];
P.forEach(function(R){var S=R.replace(/<[/]?vt:variant>/g,"").match(/<vt:([^>]*)>(.*)</);
N.push({v:S[2],t:S[1]})
});
return N
}function J(N){return typeof N!=="undefined"&&N!==null
}var m=(function(){var N=L("t"),Q=L("rPr");
var O=(function(){var S=function(W,X,T){var U={};
W.match(/<[^>]*>/g).forEach(function(Y){var Z=M(Y);
switch(Z[0]){case"<condense":break;
case"<extend":break;
case"<shadow":break;
case"<charset":break;
case"<outline":break;
case"<rFont":U.name=Z.val;
break;
case"<sz":U.sz=Z.val;
break;
case"<strike":if(!Z.val){break
}case"<strike/>":U.strike=1;
break;
case"</strike>":break;
case"<u":if(!Z.val){break
}case"<u/>":U.u=1;
break;
case"</u>":break;
case"<b":if(!Z.val){break
}case"<b/>":U.b=1;
break;
case"</b>":break;
case"<i":if(!Z.val){break
}case"<i/>":U.i=1;
break;
case"</i>":break;
case"<color":if(Z.rgb){U.color=Z.rgb.substr(2,6)
}break;
case"<family":U.family=Z.val;
break;
case"<vertAlign":break;
case"<scheme":break;
default:if(Z[0][2]!=="/"){throw"Unrecognized rich format "+Z[0]
}}});
var V=[];
if(U.b){V.push("font-weight: bold;")
}if(U.i){V.push("font-style: italic;")
}X.push('<span style="'+V.join("")+'">');
T.push("</span>")
};
function R(W){var V=[[],"",[]];
var T=W.match(N);
if(!J(T)){return""
}V[1]=T[1];
var U=W.match(Q);
if(J(U)){S(U[1],V[0],V[2])
}return V[0].join("")+V[1].replace(/\r\n/g,"<br/>")+V[2].join("")
}return function(T){return T.replace(/<r>/g,"").split(/<\/r>/).map(R).join("")
}
})();
var P=function(R){var S={};
if(!R){return S
}var T;
if(R[1]==="t"){S.t=D(h(R.replace(/<[^>]*>/g,"")));
S.raw=R;
S.r=S.t
}else{if((T=R.match(/<r>/))){S.raw=R;
S.t=D(h(R.replace(/<[^>]*>/gm,"")));
S.r=O(R)
}}return S
};
return function(T){var S=[];
var R=T.match(new RegExp("<sst([^>]*)>([\\s\\S]*)</sst>","m"));
if(R){S=R[2].replace(/<si>/g,"").split(/<\/si>/).map(P);
R=M(R[1]);
S.Count=R.count;
S.Unique=R.uniqueCount
}return S
}
})();
var p={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.openxmlformats-officedocument.theme+xml":"themes",foo:"bar"};
var d={allowRefreshQuery:"0",autoCompressPictures:"1",backupFile:"0",checkCompatibility:"0",codeName:"",date1904:"0",dateCompatibility:"1",filterPrivacy:"0",hidePivotFieldList:"0",promptedSolutions:"0",publishItems:"0",refreshAllConnections:false,saveExternalLinkValues:"1",showBorderUnselectedTables:"1",showInkAnnotation:"1",showObjects:"all",showPivotChartFilter:"0"};
var s={activeTab:"0",autoFilterDateGrouping:"1",firstSheet:"0",minimized:"0",showHorizontalScroll:"1",showSheetTabs:"1",showVerticalScroll:"1",tabRatio:"600",visibility:"visible"};
var a={state:"visible"};
var r={calcCompleted:"true",calcMode:"auto",calcOnSave:"true",concurrentCalc:"true",fullCalcOnLoad:"false",fullPrecision:"true",iterate:"false",iterateCount:"100",iterateDelta:"0.001",refMode:"A1"};
var F={autoUpdate:"false",changesSavedWin:"false",includeHiddenRowCol:"true",includePrintSettings:"true",maximized:"false",minimized:"false",onlySync:"false",personalView:"false",showComments:"commIndicator",showFormulaBar:"true",showHorizontalScroll:"true",showObjects:"all",showSheetTabs:"true",showStatusbar:"true",showVerticalScroll:"true",tabRatio:"600",xWindow:"0",yWindow:"0"};
var C="http://schemas.openxmlformats.org/package/2006/content-types";
var I="http://schemas.openxmlformats.org/spreadsheetml/2006/main";
var A={};
var o={};
var w={};
function l(R){var N={};
var O=R.match(/<dimension ref="([^"]*)"\s*\/>/);
if(O&&O.indexOf(":")!==-1){N["!ref"]=O[1]
}var S={s:{r:1000000,c:1000000},e:{r:0,c:0}};
var Q=["v","f"];
var P=0;
if(!R.match(/<sheetData *\/>/)){R.match(/<sheetData>([^\u2603]*)<\/sheetData>/m)[1].split("</row>").forEach(function(T){if(T===""||T.trim()===""){return
}var V=M(T.match(/<row[^>]*>/)[0]);
if(S.s.r>V.r-1){S.s.r=V.r-1
}if(S.e.r<V.r-1){S.e.r=V.r-1
}var U=T.substr(T.indexOf(">")+1).split(/<c/);
U.forEach(function(ac,X){if(ac===""||ac.trim()===""){return
}ac="<c"+ac;
if(S.s.c>X-1){S.s.c=X-1
}if(S.e.c<X-1){S.e.c=X-1
}var W=M((ac.match(/<c[^>]*>/)||[ac])[0]);
delete W[0];
var ab=ac.substr(ac.indexOf(">")+1);
var aa={};
Q.forEach(function(ae){var ad=ab.match(L(ae));
if(ad){aa[ae]=h(ad[1])
}});
if(W.t===undefined&&aa.v===undefined){aa.t="str";
aa.v=undefined
}else{aa.t=(W.t?W.t:"n")
}switch(aa.t){case"n":aa.v=parseFloat(aa.v);
break;
case"s":P=parseInt(aa.v,10);
aa.v=A[P].t;
aa.r=A[P].r;
break;
case"str":if(aa.v){aa.v=D(aa.v)
}break;
case"inlineStr":aa.t="str";
aa.v=h(ab.match(L("t"))[1]);
break;
case"b":switch(aa.v){case"0":case"FALSE":case"false":case false:aa.v=false;
break;
case"1":case"TRUE":case"true":case true:aa.v=true;
break;
default:throw"Unrecognized boolean: "+aa.v
}break;
case"e":aa.raw=aa.v;
aa.v=undefined;
break;
default:throw"Unrecognized cell type: "+aa.t
}if(W.s){var Y=o.CellXf[W.s];
if(Y&&Y.numFmtId&&Y.numFmtId!==0){aa.raw=aa.v;
aa.rawt=aa.t;
try{aa.v=SSF.format(Y.numFmtId,aa.v,w);
aa.t="str"
}catch(Z){aa.v=aa.raw
}}}N[W.r]=aa
})
})
}if(!N["!ref"]){N["!ref"]=encode_range(S)
}return N
}function j(V){var Q={Company:""},P={};
var Z=["Application","DocSecurity","Company","AppVersion"];
var O=["HyperlinksChanged","SharedDoc","LinksUpToDate","ScaleCrop"];
var N=["HeadingPairs","TitlesOfParts"];
var W=["category","contentStatus","lastModifiedBy","lastPrinted","revision","version"];
var aa=["creator","description","identifier","language","subject","title"];
var R=["created","modified"];
N=N.concat(W.map(function(ab){return"cp:"+ab
}));
N=N.concat(aa.map(function(ab){return"dc:"+ab
}));
N=N.concat(R.map(function(ab){return"dcterms:"+ab
}));
Z.forEach(function(ab){Q[ab]=(V.match(L(ab))||[])[1]
});
O.forEach(function(ab){Q[ab]=(V.match(L(ab))||[])[1]=="true"
});
N.forEach(function(ab){var ac=V.match(new RegExp("<"+ab+"[^>]*>(.*)</"+ab+">"));
if(ac&&ac.length>0){P[ab]=ac[1]
}});
if(P.HeadingPairs&&P.TitlesOfParts){var Y=q(P.HeadingPairs);
var T=0,X=0;
for(var U=0;
U!==Y.length;
++U){switch(Y[U].v){case"Worksheets":X=T;
Q.Worksheets=+Y[++U];
break;
case"Named Ranges":++U;
break
}}var S=q(P.TitlesOfParts).map(D);
Q.SheetNames=S.slice(X,X+Q.Worksheets)
}Q.Creator=P["dc:creator"];
Q.LastModifiedBy=P["cp:lastModifiedBy"];
Q.CreatedDate=new Date(P["dcterms:created"]);
Q.ModifiedDate=new Date(P["dcterms:modified"]);
return Q
}function t(P){var Q=[];
var N=0,O=1;
P.match(/<[^>]*>/g).forEach(function(R){var S=M(R);
switch(S[0]){case"<?xml":break;
case"<calcChain":case"<calcChain>":case"</calcChain>":break;
case"<c":delete S[0];
if(S.i){O=S.i
}else{S.i=O
}Q.push(S);
break
}});
return Q
}var z={};
function K(O){if(!O){return O
}var N={workbooks:[],sheets:[],calcchains:[],themes:[],styles:[],coreprops:[],extprops:[],strs:[],xmlns:""};
O.match(/<[^>]*>/g).forEach(function(P){var Q=M(P);
switch(Q[0]){case"<?xml":break;
case"<Types":N.xmlns=Q.xmlns;
break;
case"<Default":z[Q.Extension]=Q.ContentType;
break;
case"<Override":if(Q.ContentType in p){N[p[Q.ContentType]].push(Q.PartName)
}break
}});
if(N.xmlns!==C){throw"Unknown Namespace: "+N.xmlns
}N.calcchain=N.calcchains.length>0?N.calcchains[0]:"";
N.sst=N.strs.length>0?N.strs[0]:"";
N.style=N.styles.length>0?N.styles[0]:"";
delete N.calcchains;
return N
}function g(P){var O={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""};
var N=false;
P.match(/<[^>]*>/g).forEach(function(R){var S=M(R);
switch(S[0]){case"<?xml":break;
case"<workbook":O.xmlns=S.xmlns;
break;
case"</workbook>":break;
case"<fileVersion":delete S[0];
O.AppVersion=S;
break;
case"<fileVersion/>":break;
case"<fileSharing":case"<fileSharing/>":break;
case"<workbookPr":delete S[0];
O.WBProps=S;
break;
case"<workbookPr/>":delete S[0];
O.WBProps=S;
break;
case"<workbookProtection/>":break;
case"<bookViews>":case"</bookViews>":break;
case"<workbookView":delete S[0];
O.WBView.push(S);
break;
case"<sheets>":case"</sheets>":break;
case"<sheet":delete S[0];
S.name=D(S.name);
O.Sheets.push(S);
break;
case"<functionGroups":case"<functionGroups/>":break;
case"<functionGroup":break;
case"<externalReferences":case"</externalReferences>":break;
case"<externalReference":break;
case"<definedNames/>":break;
case"<definedNames>":N=true;
break;
case"</definedNames>":N=false;
break;
case"<definedName":case"<definedName/>":case"</definedName>":break;
case"<calcPr":delete S[0];
O.CalcPr=S;
break;
case"<calcPr/>":delete S[0];
O.CalcPr=S;
break;
case"<oleSize":break;
case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;
case"<customWorkbookView":case"</customWorkbookView>":break;
case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;
case"<pivotCache":break;
case"<smartTagPr":case"<smartTagPr/>":break;
case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;
case"<smartTagType":break;
case"<webPublishing":case"<webPublishing/>":break;
case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;
case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;
case"<webPublishObject":break;
case"<extLst>":case"</extLst>":case"<extLst/>":break;
case"<ext":N=true;
break;
case"</ext>":N=false;
break;
case"<mx:ArchID":break;
case"<mc:AlternateContent":N=true;
break;
case"</mc:AlternateContent>":N=false;
break
}});
if(O.xmlns!==I){throw"Unknown Namespace: "+O.xmlns
}var Q;
for(Q in d){if(typeof O.WBProps[Q]==="undefined"){O.WBProps[Q]=d[Q]
}}for(Q in r){if(typeof O.CalcPr[Q]==="undefined"){O.CalcPr[Q]=r[Q]
}}O.WBView.forEach(function(R){for(var S in s){if(typeof R[S]==="undefined"){R[S]=s[S]
}}});
O.Sheets.forEach(function(R){for(var S in a){if(typeof R[S]==="undefined"){R[S]=a[S]
}}});
w.date1904=b(O.WBProps.date1904,"date1904");
return O
}function f(N){o.NumberFmt=[];
for(var O in SSF._table){o.NumberFmt[O]=SSF._table[O]
}N[0].match(/<[^>]*>/g).forEach(function(P){var S=M(P);
switch(S[0]){case"<numFmts":case"</numFmts>":case"<numFmts/>":break;
case"<numFmt":var R=h(S.formatCode),Q=parseInt(S.numFmtId,10);
o.NumberFmt[Q]=R;
SSF.load(R,Q);
break;
default:throw"unrecognized "+S[0]+" in numFmts"
}})
}function G(N){o.CellXf=[];
N[0].match(/<[^>]*>/g).forEach(function(O){var P=M(O);
switch(P[0]){case"<cellXfs":case"<cellXfs/>":case"</cellXfs>":break;
case"<xf":if(P.numFmtId){P.numFmtId=parseInt(P.numFmtId,10)
}o.CellXf.push(P);
break;
case"</xf>":break;
case"<alignment":break;
case"<protection":break;
case"<extLst":case"</extLst>":break;
case"<ext":break;
default:throw"unrecognized "+P[0]+" in cellXfs"
}})
}function E(O){var N;
if((N=O.match(/<numFmts([^>]*)>.*<\/numFmts>/))){f(N)
}if((N=O.match(/<cellXfs([^>]*)>.*<\/cellXfs>/))){G(N)
}return o
}function k(N){var V=Object.keys(N.files);
var Y=V.filter(function(Z){return Z.substr(-1)!="/"
}).sort();
var P=K((N.files["[Content_Types].xml"]||{}).data);
A={};
if(P.sst){A=m(N.files[P.sst.replace(/^\//,"")].data)
}o={};
if(P.style){o=E(N.files[P.style.replace(/^\//,"")].data)
}var Q=g(N.files[P.workbooks[0].replace(/^\//,"")].data);
var U=P.coreprops.length!==0?N.files[P.coreprops[0].replace(/^\//,"")].data:"";
U+=P.extprops.length!==0?N.files[P.extprops[0].replace(/^\//,"")].data:"";
var W=U!==""?j(U):{};
var X={};
if(P.calcchain){X=t(N.files[P.calcchain.replace(/^\//,"")].data)
}var T={},S=0;
if(!W.Worksheets){var O=Q.Sheets;
W.Worksheets=O.length;
W.SheetNames=[];
for(var R=0;
R!=O.length;
++R){W.SheetNames[R]=O[R].name
}for(S=0;
S!=W.Worksheets;
++S){T[W.SheetNames[S]]=l(N.files["xl/worksheets/sheet"+(S+1)+".xml"].data)
}}else{for(S=0;
S!=W.Worksheets;
++S){T[W.SheetNames[S]]=l(N.files[P.sheets[S].replace(/^\//,"")].data)
}}return{Directory:P,Workbook:Q,Props:W,Deps:X,Sheets:T,SheetNames:W.SheetNames,Strings:A,Styles:o,keys:Y,files:N.files}
}var H,n;
if(typeof JSZip!=="undefined"){n=JSZip
}if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){if(typeof n==="undefined"){n=require("./jszip").JSZip
}H=require("fs")
}}function v(P,N){var O,R=P;
var Q=N||{};
switch((Q.type||"base64")){case"file":R=H.readFileSync(P).toString("base64");
case"base64":O=new n(R,{base64:true});
break;
case"binary":O=new n(R,{base64:false});
break
}return k(O)
}function B(O,N){var P=N||{};
P.type="file";
return v(O,P)
}this.read=v;
this.readFile=B;
this.parseZip=k;
return this
})();
var _chr=function(a){return String.fromCharCode(a)
};
function encode_col(a){var b="";
for(++a;
a;
a=Math.floor((a-1)/26)){b=_chr(((a-1)%26)+65)+b
}return b
}function encode_row(a){return""+(a+1)
}function encode_cell(a){return encode_col(a.c)+encode_row(a.r)
}function decode_col(f){var b=0,a=0;
for(;
a!==f.length;
++a){b=26*b+f.charCodeAt(a)-64
}return b-1
}function decode_row(a){return Number(a)-1
}function split_cell(a){return a.replace(/(\$?[A-Z]*)(\$?[0-9]*)/,"$1,$2").split(",")
}function decode_cell(a){var b=split_cell(a);
return{c:decode_col(b[0]),r:decode_row(b[1])}
}function decode_range(b){var a=b.split(":").map(decode_cell);
return{s:a[0],e:a[a.length-1]}
}function encode_range(a){return encode_cell(a.s)+":"+encode_cell(a.e)
}function sheet_to_row_object_array(j){var d,g,h,a,l,b;
var k=[];
if(j["!ref"]){h=decode_range(j["!ref"]);
a={};
for(b=h.s.c;
b<=h.e.c;
++b){d=j[encode_cell({c:b,r:h.s.r})];
if(d){switch(d.t){case"s":case"str":a[b]=d.v;
break;
case"n":a[b]=d.v;
break
}}}for(var f=h.s.r+1;
f<=h.e.r;
++f){l=true;
g=Object.create({__rowNum__:f});
for(b=h.s.c;
b<=h.e.c;
++b){d=j[encode_cell({c:b,r:f})];
if(d!==undefined){switch(d.t){case"s":case"str":case"b":case"n":if(d.v!==undefined){g[a[b]]=d.v;
l=false
}break;
case"e":break;
default:throw"unrecognized type "+d.t
}}}if(!l){k.push(g)
}}}return k
}function sheet_to_csv(b){var k=function k(l){switch(l.t){case"n":return String(l.v);
case"s":case"str":if(typeof l.v==="undefined"){return""
}return JSON.stringify(l.v);
case"b":return l.v?"TRUE":"FALSE";
case"e":return"";
default:throw"unrecognized type "+l.t
}};
var a="";
if(b["!ref"]){var f=utils.decode_range(b["!ref"]);
for(var d=f.s.r;
d<=f.e.r;
++d){var j=[];
for(var h=f.s.c;
h<=f.e.c;
++h){var g=b[utils.encode_cell({c:h,r:d})];
j.push(g?k(g).replace(/\\r\\n/g,"\n").replace(/\\t/g,"\t").replace(/\\\\/g,"\\").replace('\\"','""'):"")
}a+=j.join(",")+"\n"
}}return a
}function get_formulae(d){var b=[];
for(var g in d){if(g[0]!=="!"&&d.hasOwnProperty(g)){var a=d[g];
var f="";
if(a.f){f=a.f
}else{if(typeof a.v==="number"){f=a.v
}else{f=a.v
}}b.push(g+"="+f)
}}return b
}var utils={encode_col:encode_col,encode_row:encode_row,encode_cell:encode_cell,encode_range:encode_range,decode_col:decode_col,decode_row:decode_row,split_cell:split_cell,decode_cell:decode_cell,decode_range:decode_range,sheet_to_csv:sheet_to_csv,get_formulae:get_formulae,sheet_to_row_object_array:sheet_to_row_object_array};
if(typeof require!=="undefined"&&typeof exports!=="undefined"){exports.read=XLSX.read;
exports.readFile=XLSX.readFile;
exports.utils=utils;
exports.main=function(a){var b=XLSX.read(a[0],{type:"file"});
console.log(b.Sheets)
};
if(typeof module!=="undefined"&&require.main===module){exports.main(process.argv.slice(2))
}}(function(b){function a(g){var f=this;
this._domSelector=g;
this.dragIcon="copy";
this.onDragenter=null;
this.onDragover=null;
this.onDragleave=null;
this.onDrop=null;
this.fileHandler=null;
this.enable=function(){var k=document.querySelectorAll(this._domSelector);
if(k.length==0){return
}for(var j=0;
j<k.length;
++j){var h=k[j];
h.removeEventListener("dragover",this._dragover);
h.addEventListener("dragover",this._dragover);
if(this.onDragenter){h.removeEventListener("dragenter",this.onDragenter);
h.addEventListener("dragenter",this.onDragenter)
}if(this.onDragleave){h.removeEventListener("dragleave",this.onDragleave);
h.addEventListener("dragleave",this.onDragleave)
}h.removeEventListener("drop",this._drop);
h.addEventListener("drop",this._drop)
}document.removeEventListener("dragenter",this._preventDrag);
document.addEventListener("dragenter",this._preventDrag);
document.removeEventListener("dragover",this._preventDrag);
document.addEventListener("dragover",this._preventDrag)
};
this.disable=function(){var k=document.querySelectorAll(this._domSelector);
if(k.length==0){return
}for(var j=0;
j<k.length;
++j){var h=k[j];
h.removeEventListener("dragover",this._dragover);
if(this.onDragenter){h.removeEventListener("dragenter",this.onDragenter)
}if(this.onDragleave){h.removeEventListener("dragleave",this.onDragleave)
}}};
this._dragover=function(h){h.stopPropagation();
h.preventDefault();
h.dataTransfer.dropEffect=f.dragIcon;
if(f.onDragover){f.onDragover(h)
}};
this._drop=function(h){h.stopPropagation();
h.preventDefault();
if(f.onDrop){f.onDrop(h)
}if(f.fileHandler){f.fileHandler.onFileDrop(h)
}};
this._preventDrag=function(j){j.stopPropagation();
j.preventDefault();
var h=j.dataTransfer;
h.effectAllowed=h.dropEffect="none"
}
}function d(f){var g=this;
this.allowedFileTypes="csv,xlsx";
this.maxAllowedFileSizeMB=10;
this.convertXLSXtoCSV=true;
this.arrangeCSVByHeaders="column";
this.file=null;
this.fileExt=null;
this.lines=null;
this.headers=null;
this.workbook=null;
this.onError=null;
this.onBeforeReadFile=null;
this.defaultOnLoadHandler=f;
this.onFileDrop=function(k){var j=k.dataTransfer.files;
var h="You may only drag-and-drop "+this._getFileTypeStr()+".";
if(!j){this._error("INVALID_FILE_TYPE",h);
return
}this.onFileUpload(k.dataTransfer.files[0])
};
this.onFileUpload=function(n){this.file=n;
var k=this.file.name.lastIndexOf(".");
this.fileExt=(k!=-1?this.file.name.substr(k+1).toLowerCase():"");
var j=false;
var p=this.allowedFileTypes.split(",");
for(var m=0;
m<p.length;
++m){var l=p[m].trim().toLowerCase();
if(this.fileExt==l){j=true;
break
}}if(this.file.size>(this.maxAllowedFileSizeMB*1024*1024)){this._error("INVALID_FILE_SIZE","The file exceeds the maximum size limit of "+this.maxAllowedFileSizeMB+"MB.");
return
}if(this.onBeforeReadFile){this.onBeforeReadFile(e)
}var h=new FileReader();
h.onload=this._processFile;
var o=this._registeredFileTypes[this.fileExt];
if(!o||!o.readType){this._error("NON_REGISTERED_FILE_TYPE","The file type "+this.fileExt.toUpperCase()+" is not registered.");
return
}else{switch(this._registeredFileTypes[this.fileExt].readType){case"array":h.readAsArrayBuffer(this.file);
break;
case"dataURL":h.readAsDataURL(this.file);
break;
case"binary":h.readAsBinaryString(this.file);
break;
case"text":default:h.readAsText(this.file);
break
}}};
this.registerFileType=function(k,j,m){var h=k.split(",");
for(var l=0;
l<h.length;
++l){this._registeredFileTypes[h[l]]={readType:j,handler:m}
}};
this._getFileTypeStr=function(){var k=this.allowedFileTypes.split(",");
if(k.length==1){return k[0].trim().toUpperCase()+" files"
}else{if(k.length==2){return k[0].trim().toUpperCase()+" or "+k[1].trim().toUpperCase()+" files"
}else{var h="";
for(var j=0;
j<k.length-1;
++j){h+=k[j].trim().toUpperCase()+", "
}return h+"or "+k[k.length-1].trim().toUpperCase()+" files"
}}};
this._processFile=function(h){if(g._registeredFileTypes[g.fileExt].handler){g._registeredFileTypes[g.fileExt].handler.call(g,h.target.result)
}};
this._processCSV=function(h){this.lines=this._CSVToArray(h);
this._arrangeCSVByHeaders(this.arrangeCSVByHeaders);
if(this.defaultOnLoadHandler){this.defaultOnLoadHandler(this)
}};
this._processXLSX=function(h){this.workbook=XLSX.read(h,{type:"binary"});
if(this.convertXLSXtoCSV){var j=this.workbook.SheetNames[0];
this._processCSV(XLSX.utils.sheet_to_csv(this.workbook.Sheets[j]))
}else{if(this.defaultOnLoadHandler){this.defaultOnLoadHandler(this)
}}};
this._CSVToArray=function(m,o){o=(o||",");
var n=new RegExp(("(\\"+o+'|\\r?\\n|\\r|^)(?:"([^"]*(?:""[^"]*)*)"|([^"\\'+o+"\\r\\n]*))"),"gi");
var j=[[]];
var l=null;
while(l=n.exec(m)){var h=l[1];
if(h.length&&(h!=o)){j.push([])
}if(l[2]){var k=l[2].replace(new RegExp('""',"g"),'"')
}else{var k=l[3]
}j[j.length-1].push(k)
}return(j)
};
this._arrangeCSVByHeaders=function(r){if(r=="column"){this.headers=this.lines[0];
var j=this.headers.length;
var q=0;
for(var o=0;
o<j;
++o){if(this.headers[o]==""){this.headers[o]="undefined"+(++q)
}}var k=this.lines.length;
for(var n=1;
n<k;
++n){var s=this.lines[n];
var m={};
for(var p=0;
p<j;
++p){m[this.headers[p]]=s[p]
}this.lines[n-1]=m
}this.lines.pop()
}};
this._error=function(j,h){if(this.onError){this.onError(j,h)
}};
this._registeredFileTypes={csv:{readType:"text",handler:this._processCSV},xlsx:{readType:"binary",handler:this._processXLSX}}
}if("function"===typeof define&&define.amd){define(function(){return{Dropzone:a,FileHandler:d}
})
}else{if("undefined"===typeof exports){b.Dropzone=a;
b.FileHandler=d
}else{exports.Dropzone=a;
exports.FileHandler=d
}}})(this);
(function(b,a){b.cardTypes.asset=new Class({extend:b.cardTypes.base,titleEditable:false,subtitleEditable:false,renderShare:function(f,g){var d=a("<img>").addClass("annotatable");
d.attr("src",f.data.url);
g.append(a("<span class='image'>").append(d))
},prepareActivity:function(d,f){f.object.id=decodeURIComponent(d.url);
f.object.image={url:d.data.url};
return f
},createPayload:function(f,g,d){return null
}})
})(tartan,jQuery);
(function(b,a){b.cardTypes.article=new Class({extend:b.cardTypes.base,titleEditable:false,subtitleEditable:false,renderShare:function(g,h){if(g.data.dataURL){var j=a('<div style="text-align:center;padding:8px;">');
var f=a('<img style="margin:auto">');
f.attr("src",g.data.dataURL);
j.append(f);
h.append(j)
}var d=a("<span>");
d.html(g.data.summary);
h.append(d)
},prepareActivity:function(d,f){f.object.id=decodeURIComponent(d.url);
f.object.image={url:d.data.dataUrl};
f.object.link=d.url;
return f
},createPayload:function(f,g,d){payload={"jcr:title":g,"jcr:description":d,summary:f.data.summary,link:f.url,imageUrl:f.data.dataURL,author:f.data.author,date:f.data.date,siteName:f.data.siteName,siteLink:f.data.siteLink};
return payload
}})
})(tartan,jQuery);
(function(b,a){b.cardTypes.firsttimeexperience=new Class({extend:b.cardTypes.base,renderNormal:function(d,f){a(document).on("click",".first-time-experience-tooltip",function(l){l.preventDefault();
var h=a(this),k=a(h.attr("href"));
if(k.length>0){h.removeClass("not-active");
var n=h.closest("ul").find("a").not(h);
n.addClass("not-active");
var j=k.data();
k.insertAfter(j.pointAt);
k.popover(j);
if(j.moveX||j.moveY){var m=k.offset();
if(j.moveX){m.left+=j.moveX
}if(j.moveY){m.top+=j.moveY
}k.offset(m)
}k.data("popover").show();
function g(){if(k.is(":hidden")){if(!h.hasClass("not-active")){n.removeClass("not-active")
}}else{window.setTimeout(arguments.callee,100)
}}g()
}f()
})
}})
})(tartan,jQuery);
var TestChart=function(d){this.options=d=$.extend({},this.defaults,d);
var h={experiences:[],lift:[],winner:d.data.winner.winningExperience,confidence:Math.round(d.data.winner.confidence*100),defaultExperience:"",defaultCR:0};
for(var g=0;
g<d.data.experiences.length;
g++){var f=d.data.experiences[g];
if(f.isControl){h.defaultExperience=f.name;
h.defaultCR=Math.round(f.conversionRate*100)
}else{h.experiences.push(f.name);
h.lift.push(Math.round(f.lift*100))
}}this.data=h;
this.count=this.data.experiences.length;
this.size=this.sizes[d.size];
if(this.options.size==="large"){this.size.height=this.count*this.size.rowHeight
}this.$el=$(d.el);
this.$el.addClass("test-chart");
this.$el.empty();
this.size.width=this.$el.innerWidth();
if(this.options.size==="large"){var j="Conversion Rate";
if(d.data.winner.metricName==="AOV"||d.data.winner.metricName==="RPV"||d.data.winner.metricName==="Sales"){j="Revenue"
}this.$el.append('<div class="test-key"><div class="test-key-item"><div class="test-key-box test-key-gray"></div> '+j+'</div><div class="test-key-item"><div class="test-key-box test-key-green"></div> Positive Lift</div><div class="test-key-item"><div class="test-key-box test-key-red"></div> Negative Lift</div></div><div class="test-header">'+this.data.defaultExperience+' (default) <span class="test-defaultCR">'+this.data.defaultCR+'% <span class="test-defaultCR-label">'+j+"</span></span></div>")
}else{this.$el.append('<div class="test-key"><div class="test-key-item"><div class="test-key-box test-key-green"></div> Positive Lift</div><div class="test-key-item"><div class="test-key-box test-key-red"></div> Negative Lift</div><div class="test-key-item"><div class="test-key-box test-key-gray"></div> Conversion Rate</div></div><div class="test-header">'+this.data.defaultExperience+' <span class="test-defaultCR-small">'+this.data.defaultCR+'% <span class="test-defaultCR-label">CR</span></span></div>')
}var a=this.colors;
var b=this;
this.chart=dv.chart().layers([dv.geom.bar().each("end",function(n,m){var k=null;
if(d.size==="small"){k=d3.select($(d.el).find("g").first()[0])
}else{k=d3.select(this.parentNode)
}var l=d3.select(this.parentNode).select(".test-label");
b.addPercentage(k,l,n)
})]).coord(dv.coord.cartesian().flip(true)).data(this.data).width("100%").height(this.size.height).map("x","experiences",dv.scale.ordinal().reverse(true).padding(this.size.rowPadding)).map("y","lift",dv.scale.linear()).set("fill",function(l,k){return(l.data.lift>0)?a.green:a.red
}).map("group","experiences").guide("x",dv.guide.axis().tickSize(0).tickDy(this.size.labelY).tickDx(this.size.tickDx)).guide("y",dv.guide.axis().orientation("right").tickValues([0]).tickFormat(function(m,k){var l=d3.select(this.parentNode);
var m=l.selectAll(".test-caret");
if(m.empty()){m=l.append("path").classed("test-caret",true)
}m.attr("d",d3.svg.symbol().type("triangle-down")).attr("transform","translate(0,0), scale(1.5,0.75)")
})).parent(d.el).duration(this.options.transitionTime).render()
};
TestChart.prototype.addPercentage=function(q,o,k){if(o.empty()){var l=this.size.labelY+(this.size.labelYOffset||0);
var m=this.options.size==="small"?this.size.width:this.size.pctXOffset;
var s=15;
var p=k.data.lift+"%";
if(k.data.lift>0){p="+"+p
}var g=q.append("text").classed("test-label",true).attr("x",m-s-4).attr("y",k.bounds.y0+l).text(p).style("opacity",0);
if(k.data.lift<0){g.classed("test-negative",true)
}else{g.classed("test-positive",true)
}g.transition().duration(this.options.transitionTime).style("opacity",1);
if(k.data.experiences===this.data.winner){var b=q.append("rect").classed("test-winningRect",true).attr("x",m-s).attr("y",k.bounds.y0+l-s+3).attr("width",s).attr("height",s).style("opacity",0);
var j=q.append("text").classed("test-winningText",true).attr("x",m-s+2).attr("y",k.bounds.y0+l).text("W").style("opacity",0);
var f=15;
var t=4;
var a=2;
var n=q.append("g").attr("transform","translate("+(m+8)+","+(k.bounds.y0+l+3)+")").style("opacity",0);
for(var h=0;
h<4;
h++){var r=f/4*(h+1);
if(this.data.confidence<60&&h>0){r=1
}else{if(this.data.confidence<75&&h>1){r=1
}else{if(this.data.confidence<90&&h>2){r=1
}}}n.append("rect").classed("test-confidenceBar",true).attr("x",h*(t+a)).attr("y",-r).attr("width",t).attr("height",r)
}n.transition().duration(this.options.transitionTime).style("opacity",1);
b.transition().duration(this.options.transitionTime).style("opacity",1);
j.transition().duration(this.options.transitionTime).style("opacity",1)
}}};
TestChart.prototype.colors={red:"rgb(252, 90, 77)",green:"rgb(121, 208, 40)"};
TestChart.prototype.sizes={small:{width:"auto",height:170,rowPadding:0.845,labelY:-15,labelYOffset:0,tickDx:-15,transitionTime:0},large:{width:"100%",height:"100%",rowHeight:40,rowPadding:0.65,labelY:2,labelYOffset:-2,tickDx:-100,pctXOffset:-15}};
TestChart.prototype.defaults={size:"small",transitionTime:400};
(function(a){a.cardTypes.abntest=new Class({extend:a.cardTypes["dv-report"],acceptedMimeTypes:undefined,handleDrop:undefined})
})(tartan);
(function(f,A,D,m){var v=".mac-apps-admin-downloadcli-activator";
var l=".mac-apps-admin-promoteapp-activator";
var s="mac-app-admin-modal";
var L="mac-app-admin-query-modal";
var O="mac-app-go-see";
var J="."+s+".success .primary";
var t="mac-app-promotion-proceed";
var u="phonegap-app";
var p="";
var C="default";
var q="success";
var I="error";
var r=null;
var z="clear";
var k=A.HTTP.externalize("/libs/cq/contentsync/console/configs.json");
var E=".apppromote.json";
var N=false;
var h=0;
var g=0;
var M=[];
var F=null;
var a=0;
function G(){D("."+s).hide().modal("hide").remove();
r=null
}function n(){var U=D("."+s);
var V=U.find(".spinner");
var T=U.find(".please-wait");
V.remove();
T.remove()
}function R(X,Z,W,Y){if(r==I&&X!=I){return
}r=X;
var U=D("."+s);
if(U===null||U.length===0){var ac='<div class="modal '+s+'"><div class="modal-header"><h2></h2></div><div class="modal-body"></div><div class="modal-footer">';
if(W!=m&&W!=null&&W.length>0){ac+="    "+W
}if(X!=C){ac+='    <button class="primary" data-dismiss="modal">'+A.I18n.get("Close")+"</button>"
}ac+="</div></div>";
D("body").append(D(ac));
U=D("."+s)
}else{if(X!=C&&U.find("button").length==0){var V=U.find(".modal-footer");
if(W!=m&&W!=null&&W.length>0){V.append(W)
}V.append(D('<button class="primary" data-dismiss="modal">'+A.I18n.get("Close")+"</button>"))
}}var ab;
var T;
if(X==I){ab=A.I18n.get("Error");
if(p=="#downloadcli"){T=A.I18n.get("An error occurred while initiating Phonegap CLI download")
}else{if(p=="#promoteApp"){T=U.find(".modal-body").html();
T+='<div class="promotion-error-message">';
T+="<h2>"+A.I18n.get('Error occurred promoting "');
T+=Y+'"</h2>';
T+=(Z.substr(0,150))+"</div>";
Z="";
var aa=parseInt(U.css("top"));
U.css("top",(aa>51?(aa-35):aa)+"px")
}}}else{if(X==q){ab=A.I18n.get("Success");
if(p=="#downloadcli"){T=A.I18n.get("Phonegap CLI download initiated")
}else{if(p=="#promoteApp"){T=A.I18n.get("App information promoted")
}}}else{if(p=="#downloadcli"){ab=A.I18n.get("Downloading");
T='<div class="spinner"/>&nbsp;&nbsp'+A.I18n.get("Initiating Phonegap CLI download.  Please wait...")
}else{if(p=="#promoteApp"){ab=A.I18n.get("Promoting");
T='<div class="spinner"/>';
T+='<span class="please-wait">&nbsp;&nbsp;';
T+=A.I18n.get("Promoting app information.  Please wait...")+"</span>"
}}}}if(Z!=m&&Z!=null&&Z.length!=0){T+=":<br/><br/>"+Z
}return U.modal({type:X,heading:ab,content:T,keyboard:(X!=C)}).modal("show").css("display","block")
}function S(V,T){D("."+L).remove();
var U='<div class="modal '+L+'"><div class="modal-header"><h2></h2></div><div class="modal-body">    <p></p></div><div class="modal-footer">    <button class="'+t+'" data-dismiss="modal">'+A.I18n.get("Continue")+'</button>    <button class="primary" data-dismiss="modal">'+A.I18n.get("Cancel")+"</button></div></div>";
D("body").append(D(U));
return A.$("."+L).modal({type:"notice",heading:V,content:T,keyboard:true}).modal("show")
}function d(X,U){var W=D("."+s);
if(W.length==0){return
}var T=A.I18n.get("Processed:")+" "+U+" "+A.I18n.get("out of")+" "+X;
var V=W.find(".modal-body .mofn");
if(V==null||V.length===0){W.find(".modal-body").prepend(D('<h1 class="mofn">'+T+"</h1>"))
}else{V.html(T)
}}function w(V,U,T){if(U.indexOf("/")!=0){R(I,A.I18n.get("Invalid Phonegap Export Template")+': "'+encodeURIComponent(U)+'"')
}else{D.ajax({url:A.HTTP.externalize(k),_charset_:"utf-8",type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{path:U,action:V}}).always(function(W,Z,Y){if(Z!=="success"){if(W.responseText){var X=W.responseText.substr(W.responseText.indexOf('id="Message">')+13);
X=X.substr(0,X.indexOf("</div>"));
R(I,A.I18n.get(X))
}else{R(I,Z)
}}else{if(T==m){R(q)
}else{T(U)
}}N=false
})
}}function o(T){R(C);
Q(T)
}function Q(U){var T=window.open(U+".zip","_blank");
F=window.setInterval(b,200,T)
}function b(T){if(T&&T.document){window.clearInterval(F);
F=null;
a=0;
var U=parseInt(D(T.document).find("title").text());
if(U>=400){var V=D(T.document).find("html").html();
V=V.substr(V.indexOf("<title>")+7);
V=V.substr(0,V.indexOf("</title>"));
V=A.I18n.get("Ensure popups are allowed from this host.")+"</br></br>"+V;
R(I,V)
}else{R(q)
}}else{a++;
if(a>50){window.clearInterval(F);
F=null;
a=0;
R(q,A.I18n.get("Unknown Result (timed out). Are popups allowed?"),true)
}}}function H(){S(A.I18n.get("Overwrite?"),A.I18n.get("This promotion action will copy the selected items and any children to the next environment.")+"<br/><br/>"+A.I18n.get("If the selected items have already been promoted, those copies (and their children) will be overwritten.")+"<br/><br/>"+A.I18n.get("Continue?"));
D(f).fipo("tap."+t,"click."+t,"."+t,function(T){P()
})
}function P(){if(N==true){return
}N=true;
M=[];
D("."+L).modal("hide").hide();
var T=D(".foundation-selections-item.selected");
R(C);
h=T.length;
g=0;
d(h,g);
T.each(function(U){B(D(this).data("path"),(D(this).data("type")==u))
})
}function K(U){U=U.substr(0,U.indexOf(E));
var T=D('.foundation-collection .foundation-selections-item.selected[data-path="'+U+'"]');
var V=T.find(".label h4").text();
if(V.length==0){V=U.substr(U.lastIndexOf("/")+1)
}return V
}function B(U,T){if(T){D(f).on("click",J,function(W){var V=D(".foundation-content").adaptTo("foundation-content");
V.refresh();
G()
})
}else{D(f).off("click",J)
}D.ajax({url:A.HTTP.externalize(U)+E,_charset_:"utf-8",type:"POST",contentType:"application/x-www-form-urlencoded; charset=UTF-8",data:{replaceContentSync:true,clearContentSync:true,promoteChildren:T}}).always(function(ag,Y,ac){g++;
d(h,g);
var ab=K(this.url);
if(Y!=="success"){if(ag.responseText){var ah=ag.responseText.substr(ag.responseText.indexOf("<h1>")+4);
ah=ah.substr(0,ah.indexOf("</h1>"));
R(I,A.I18n.get(ah),null,ab)
}else{R(I,Y,null,ab)
}N=false
}else{if(g==h){var aa="";
try{ag=JSON.parse(ag);
if(ag.promotedTo){aa='<button class="'+O+'" data-dismiss="modal" data-target="'+ag.promotedTo+'">'+A.I18n.get("Go See")+"</button>"
}var ad="";
var W=M.length;
if(ag.promotedFrom!=m||M.length>0){ad+="<ul>";
var Z;
for(Z=0;
Z<M.length;
Z++){ad+="<li>"+M[Z]+"</li>\n"
}if(ag.promotedFrom instanceof Array){W+=ag.promotedFrom.length;
for(Z=0;
Z<ag.promotedFrom.length;
Z++){ad+="<li>"+ag.promotedFrom[Z]+"</li>\n"
}}else{ad+="<li>"+ag.promotedFrom+"</li>\n"
}ad+="</ul><br/>"
}if(ag.promotionEnvironment){ad+=A.I18n.get("Promoted to environment")+' "'+ag.promotionEnvironment+'"'
}R(q,ad,aa);
var af=D("."+s);
var V=parseInt(af.css("margin-top"));
V=Math.max(V-(W*17),-175);
af.css("margin-top",af.css("margin-top",V+"px"));
if(aa.length>0){D(f).fipo("tap."+O,"click."+O,"."+O,function(aj){var ai="/assets.html"+D(this).data("target");
f.location.href=A.HTTP.externalize(ai);
G()
})
}}catch(ae){var X=ag.substr(ag.indexOf("<h1>")+4);
X=X.substr(0,X.indexOf("</h1>"));
R(I,A.I18n.get("Unexpected result:")+"<br/>"+A.I18n.get(X),null,ab)
}g=0;
h=0;
N=false
}else{try{ag=JSON.parse(ag);
M[M.length]=ag.promotedFrom
}catch(ae){}}}if(g==h){n();
r=null
}})
}function j(){var W=D(".foundation-collection .foundation-selections-item.selected");
var U=D(W).data("is-last-env");
var V=D(W).hasClass("card-phonegap-app");
var X=(W.length>0&&(U==m||U==false));
if(X&&W.data("type")==u){X=(W.length==1)
}if(X&&W.data("type")!=u){var T=W.filter(function(Y){return D(this).hasClass("phonegap-app-asset")
});
X=(T.length==W.length)
}D(l).removeClass("hide").toggleClass("hide",!X).removeAttr("disabled");
D(v).removeClass("hide").toggleClass("hide",(W.length!=1)||!V)
}D(f).on("click"+v,v,function(W){W.preventDefault();
W.stopPropagation();
var V=D(this).attr("href")||D(this).data("href");
var U=D(".foundation-selections-item.selected").first();
var T=U.data("pg-export-template");
if(V==="#downloadcli"){p=V;
o(A.HTTP.externalize(T))
}return false
});
D(f).on("click"+l,l,function(U){U.preventDefault();
U.stopPropagation();
G();
var T=D(this).attr("href")||D(this).data("href");
if(T=="#promoteApp"){p=T;
H()
}});
D(f).on("foundation-selections-change",".foundation-collection",function(T){j()
});
D(f).on("foundation-contentloaded",function(V){j();
var T=D(".toolbar .cq-damadmin-admin-actions-delete-activator");
if(T.length>0){var U=T.parent();
U.append(T.detach())
}})
})(document,Granite,Granite.$);
/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(h,b,j){var a=/\+/g;
function g(k){return k
}function d(k){return decodeURIComponent(k.replace(a," "))
}var f=h.cookie=function(r,q,w){if(q!==j){w=h.extend({},f.defaults,w);
if(q===null){w.expires=-1
}if(typeof w.expires==="number"){var s=w.expires,v=w.expires=new Date();
v.setDate(v.getDate()+s)
}q=f.json?JSON.stringify(q):String(q);
return(b.cookie=[encodeURIComponent(r),"=",f.raw?q:encodeURIComponent(q),w.expires?"; expires="+w.expires.toUTCString():"",w.path?"; path="+w.path:"",w.domain?"; domain="+w.domain:"",w.secure?"; secure":""].join(""))
}var k=f.raw?g:d;
var u=b.cookie.split("; ");
for(var p=0,n=u.length;
p<n;
p++){var o=u[p].split("=");
if(k(o.shift())===r){var m=k(o.join("="));
return f.json?JSON.parse(m):m
}}return null
};
f.defaults={};
h.removeCookie=function(l,k){if(h.cookie(l)!==null){h.cookie(l,null,k);
return true
}return false
}
})(jQuery,document);
(function(g,j,b){function o(r,p,q){var t;
return function s(){var w=this,v=arguments;
function u(){if(!q){r.apply(w,v)
}t=null
}if(t){clearTimeout(t)
}else{if(q){r.apply(w,v)
}}t=setTimeout(u,p||100)
}
}function f(p,q){g.cookie(p,q,{expires:7,path:"/"})
}function l(p){g.removeCookie(p,{path:"/"})
}function n(){g(".endor-Brand").toggleClass("is-closed");
return !g(".endor-Panel-header.endor-BreadcrumbBar").toggleClass("is-closed").hasClass("is-closed")
}function d(){var q=g(".endor-Crumbs");
var r=q.find(".endor-Crumbs-item");
var v=q.width()-100;
r.removeClass("is-collapsed");
var z=Array.prototype.reduce.call(r,function(A,w){return A+=g(w).outerWidth()
},0);
var p=z;
for(var s=1,u=r.length-1;
s<u&&p>v;
s++){var t=g(r[s]);
p-=t.width();
t.addClass("is-collapsed")
}}function m(){var p=g(".js-endor-page");
var q=g(".js-endor-navrail");
if(j.innerWidth<=1024&&p.hasClass("is-innerRailOpen")){h();
if(!q.hasClass("is-closed")){return true
}}q.toggleClass("is-closed");
g("#main-rail").toggleClass("is-closed");
g(".js-endor-navrail-toggle").toggleClass("is-active");
g(".endor-BreadcrumbBar").toggleClass("is-compact");
return !q.hasClass("is-closed")
}function h(s){var t=g(".js-endor-page");
var r=g(".endor-Page-sidepanel-view.is-active").first();
var q,p;
if(s){p=s.data("coralViewTarget");
var u=g('.endor-Page-sidepanel-view[data-coral-view-id="'+p+'"]').first();
if(!r.is(u)){q=u
}}g("[data-coral-view-target]").removeClass("is-active");
if(q){g("[data-coral-view-target='"+p+"']").addClass("is-active");
r.removeClass("is-active");
q.addClass("is-active");
t.addClass("is-innerRailOpen");
return p
}else{r.removeClass("is-active");
t.removeClass("is-innerRailOpen")
}}function a(q,r,p){q.removeClass("is-left is-right is-active");
if(p){q.addClass("is-right")
}else{q.addClass("is-left")
}r.removeClass("is-left is-right");
r.addClass("is-active")
}function k(v){var p=v.closest(".coral-ColumnView");
var t=v.closest(".coral-ColumnView-column");
var s=v.data("coral-columnview-target");
var r=v.hasClass("coral-ColumnView-item--back");
var u=p.find('.coral-ColumnView-column[data-coral-columnview-id="'+s+'"]');
if(u.length){a(t,u,r);
return
}var q=v.prop("href");
if(!q){return
}var w=g('<div class="wait large center"></div>').appendTo(t);
g.get(q).done(function(z){p.append(z);
u=p.find('.coral-ColumnView-column[data-coral-columnview-id="'+s+'"]');
if(u){a(t,u,r)
}}).always(function(){w.remove()
})
}g(document).on("click",".coral-ColumnView-item[data-coral-columnview-target]",function(p){p.preventDefault();
k(g(this))
});
g(document).on("click",".js-endor-navrail-toggle",function(q){q.preventDefault();
var p=m();
f("endor.navrail.open",p)
});
g(document).on("click","[data-coral-view-target]",function(q){q.preventDefault();
var p=h(g(this));
if(p){f("endor.innerrail.current",p)
}else{l("endor.innerrail.current")
}});
g(document).on("click",".endor-BreadcrumbBar, .endor-BlackBar-title",function(p){if(g(p.target).closest(".endor-Crumbs-item:not(.endor-Crumbs-item--noNavigation)").length){return
}p.preventDefault()
});
g(j).on("resize load",o(function(){d()
},500))
}(jQuery,window));
(function(b,a,d){CUI.ColumnView=new Class({toString:"ColumnView",extend:CUI.Widget,construct:function(f){if(this.options.path){var g=this._addColumn();
g.addClass("is-active");
this._loadColumn(g,this.options.url,this.options.path)
}this.applyOptions()
},defaults:{url:"{+path}",path:"",wrapLabels:true},applyOptions:function(){this._initialize();
this._initFoldable()
},getSelectedItems:function(){return this.getActiveColumn().children(".is-selected")
},getSelectedPaths:function(){var f=[];
this.getSelectedItems().each(function(){f.push(b(this).data("path"))
});
return f
},getBreadcrumbItems:function(){return this.getActiveColumn().prevAll().children(".is-selected")
},selectItemByPath:function(h,g){var f=this.getActiveColumn().children('.coral-ColumnView-item[data-path="'+h+'"]');
this._setActiveColumn(f,false);
f.addClass("is-selected")
},checkItemByPath:function(g,f){},getActiveColumn:function(){return this.$element.children(".is-active")
},getTargetColumn:function(){var g=this.getActiveColumn();
var f=this.getSelectedItems().filter(":not(.is-checked)");
if(f.length==1&&f.hasClass("coral-ColumnView-item--hasChildren")){return g.next()
}else{return g
}},_initialize:function(){if(!this.$element.hasClass("coral-ColumnView--navigation")){this.$element.on("click",".coral-ColumnView-item",this._selectItemHandler.bind(this));
this.$element.on("click",".coral-ColumnView-icon",this._checkItemHandler.bind(this))
}},_initFoldable:function(){var g="open",f="columnview-foldable-";
this.$element.find(".coral-ColumnView-foldable").each(function(k,o){var n=b(o),j=n.find("> .coral-ColumnView-item--header"),l=n.find("> .coral-ColumnView-item:not(.coral-ColumnView-item--header)"),m=f+(j.attr("href")||(" "+new Date().getTime()+"-"+k)).substring(1),h=n.hasClass(g);
n.attr("role","presentation");
j.attr({role:"button",id:j.attr("id")||m,"aria-controls":l.attr("id")||m+"-content",tabindex:0,"aria-expanded":h});
l.attr({id:l.attr("id")||m+"-content","aria-labelledby":j.attr("id"),"aria-hidden":!h,"aria-expanded":h})
});
this.$element.fipo("tap","click",".coral-ColumnView-foldable > .coral-ColumnView-item--header",function(l){var j=b(l.currentTarget),m=j.closest(".coral-ColumnView-foldable"),k=m.find("> .coral-ColumnView-item:not(.coral-ColumnView-item--header)"),h=m.toggleClass(g).hasClass(g);
j.attr({"aria-expanded":h});
k.attr({"aria-hidden":!h,"aria-expanded":h});
if(h&&l.type==="tap"){k.attr("tabindex","-1").trigger("focus");
j.trigger("focus");
k.removeAttr("tabindex")
}l.stopPropagation()
}).on("keydown","coral-ColumnView-foldable > .coral-ColumnView-item--header:not(button):not(a[href])",function(j){var h=b(j.currentTarget);
switch(j.which){case 13:case 32:h.trigger("click");
break
}})
},_addColumn:function(){var f=b('<div class="coral-ColumnView-column"><div class="wait small center"></div></div>');
this.$element.append(f);
return f
},_loadColumn:function(j,g,h){var f=this;
b.ajax({url:g.replace("{+path}",h)}).done(function(l){var k=b("<div />").append(l).find(".coral-ColumnView-column").html();
j.html(k);
if(f.options.wrapLabels===true){j.find(".coral-ColumnView-item").each(function(){var m=b(this);
m.addClass("coral-ColumnView-item--checkWrap");
if(this.scrollWidth>this.clientWidth){m.addClass("coral-ColumnView-item--doublespaced")
}m.removeClass("coral-ColumnView-item--checkWrap")
})
}}).always(function(){j.children(".wait").remove()
})
},_selectItemHandler:function(g){var f=b(g.target);
if(!f.hasClass("coral-ColumnView-item")){f=f.parents(".coral-ColumnView-item")
}this._setActiveColumn(f,false);
f.addClass("is-selected");
var h=this.getActiveColumn().next();
if(h.length==0){h=this._addColumn()
}this._loadColumn(h,f.data("url")||this.options.url,f.data("path"));
this._scrollToColumn()
},_checkItemHandler:function(g){g.stopPropagation();
var f=b(g.target).parents(".coral-ColumnView-item");
this._setActiveColumn(f,true);
f.toggleClass("is-selected is-checked");
if(this.getSelectedItems().length==0){var h=this.getActiveColumn();
var j=h.prev();
if(j.length!=0){h.removeClass("is-active");
j.addClass("is-active")
}}this._scrollToColumn()
},_log:function(){},_setActiveColumn:function(g,h){var f=this.getActiveColumn();
var j=g.parent();
if(h===true){j.children(".is-selected:not(.is-checked)").addClass("is-checked")
}else{j.children(".is-selected:not(.is-checked)").removeClass("is-selected")
}if(h===false||j.hasClass("is-active")===false){f.children(".is-checked").removeClass("is-selected is-checked")
}f.removeClass("is-active");
j.addClass("is-active").nextAll().html("")
},_scrollToColumn:function(){var j,h;
var g=this.getActiveColumn();
var k;
var f=this.getSelectedItems().filter(":not(.is-checked)");
if(f.length==1){k=g.next()
}else{k=g
}if(k.position()&&k.position().left+k.outerWidth()>=this.$element.width()){k.nextAll().remove();
j=this.$element[0].scrollWidth-this.$element.outerWidth();
h=(j-this.$element.scrollLeft())*1.5;
this.$element.animate({scrollLeft:j},h)
}else{if(g.position()&&g.position().left<0){j=0;
g.prevAll().each(function(){j+=b(this).outerWidth()
});
h=(this.$element.scrollLeft()-j)*1.5;
this.$element.animate({scrollLeft:j},h)
}}}});
CUI.Widget.registry.register("columnview",CUI.ColumnView);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){CUI.ColumnView.init(b("[data-init~=columnview]",f.target))
})
}}(jQuery,this));
tartan=window.tartan||{};
tartan.core={openDetails:function(d){$.quickaction();
var b=this;
b.preventRefreshNotification=true;
var a=$(".mc_report_dialog").hide();
$(".mc_dialogs").show();
return $.ajax({url:d,async:true,dataType:"html",success:function(f){a.html(f).show();
$("[data-dismiss='card-details']",a).on("click tap",function(){b.closeDetails()
});
$(".details-container",a).trigger("ready").focus();
$(window).on("keyup.dismiss.details",function(g){if(g.which==27){b.closeDetails()
}})
},error:function(f,h,g){if(f.status==404){window.alert(Granite.I18n.get("This card does not exist (anymore)."))
}else{window.alert(Granite.I18n.get("Error displaying card details ({0}/{1})",[h,g]))
}window.location.reload()
}})
},closeDetails:function(){var j=$(".mc_dialogs");
if(!j.is(":visible")){return
}var h=this,g=$("#card-content"),d=$(".add-comment textarea"),b=$(".add-comment [name='annotationData']");
if((d.val()&&$.trim(d.val()).length)||b.val().length){var f=$("<div>").addClass("modal").appendTo(j).modal({content:Granite.I18n.get("Your unsaved comment will be lost."),buttons:[{label:Granite.I18n.get("Cancel"),className:"primary",click:function(){f.modal("hide");
a()
}},{label:Granite.I18n.get("Continue"),click:function(){f.modal("hide");
k()
}}]});
$(window).off("keyup.dismiss.details");
$(window).on("keyup.dismiss.details",function(l){if(l.which==27){f.modal("hide");
a()
}});
f.find(".modal-header").remove();
f.find(".primary").focus();
f.modal("show")
}else{k()
}function a(){$(window).on("keyup.dismiss.details",function(l){if(l.which==27){h.closeDetails()
}})
}function k(){$(window).off("keyup.dismiss.details");
h.closeCardPinningDlg();
g.empty();
j.hide();
h.refreshCards()
}},unhideCard:function(b,d){var a=d+"/_jcr_content.pin.json";
$.ajax({url:a,type:"post",data:{cardPath:b,action:"unhide"},dataType:"json",success:tartan.core.ajaxSuccess,error:tartan.core.ajaxError,complete:function(){tartan.core.refreshCards()
}})
},deleteCard:function(f,b,g,j){var d=j+"/_jcr_content.pin.json";
var a=f=="feed";
if(a){$.ajax({url:d,type:"post",data:{cardPath:g,action:"unpin"},dataType:"json",success:tartan.core.ajaxSuccess,error:tartan.core.ajaxError,complete:function(){tartan.core.refreshCards()
}})
}else{if(!b){var h=$("#delete-card");
h.find("button.primary").off("click").one("click",function(){$.ajax({url:d,type:"post",data:{cardPath:g,action:"delete"},dataType:"json",success:tartan.core.ajaxSuccess,error:tartan.core.ajaxError,complete:function(){tartan.core.refreshCards({force:true})
}})
});
h.modal("show")
}else{$.ajax({url:d,type:"post",data:{cardPath:b,action:"unpin"},dataType:"json",success:tartan.core.ajaxSuccess,error:tartan.core.ajaxError,complete:function(){tartan.core.refreshCards()
}})
}}},toggleCardPinningDlg:function(d,b){var a=$("#mac-pinToBoard");
if(a.is(":visible")){this.closeCardPinningDlg()
}else{this.openCardPinningDlg(d,b)
}},closeCardPinningDlg:function(){var a=$("#mac-pinToBoard");
if(a.length){a.hide();
a.find("#arrow-style").remove();
$(document).off("tap.card-pinning-dialog keydown.card-pinning-dialog click.card-pinning-dialog");
$(".quickaction-bar").data("quickaction.internal.pinned",false)
}},loadCardPinningMenu:function(f,b,g){var d=this;
var a=$("#mac-pinToBoard");
$.ajax({url:f.replace("/jcr:","/_jcr_")+".boardsmenu.html",async:true,dataType:"html",success:function(h){$(".dropdown-list",a).html(h);
$(".dropdown-list input[type='checkbox']").on("change",function(j){d.togglePinToBoard(f,$(this).closest("li"))
});
$(".dropdown-list button.mac-view-button").fipo("tap","click",function(j){j.preventDefault();
j.stopImmediatePropagation();
window.location.href=Granite.HTTP.externalize($(this).closest("li").data("path")+".html");
return true
});
$("[data-target='mac-create-board']",a).fipo("tap","click",function(j){j.preventDefault();
j.stopImmediatePropagation();
$(".dropdown-list li.mac-pinmenu-create").removeClass("hide");
window.setTimeout(function(){$(".dropdown-list li.mac-pinmenu-create input").focus()
},100);
return true
});
$(".dropdown-list li.mac-pinmenu-create form").on("submit",function(j){j.preventDefault();
var m=$(this);
var k=$("input",m).val();
if(k==""){$(".dropdown-list li.mac-pinmenu-create").addClass("hide")
}var l=m.attr("action");
$.ajax({url:l+"/_jcr_content.save.toPinCard.json",type:"post",data:m.serializeArray(),async:false,dataType:"json",success:function(o){var n=o.path;
d.loadCardPinningMenu(f,n,function(){d.togglePinToBoard(f,a.find("li[data-path='"+n+"']"))
})
},error:function(n){},complete:function(){}});
return true
});
a.show();
g&&g();
if(b){$(".dropdown-list",a).scrollTop(10000)
}},error:function(h,k,j){if(h.status==404){window.alert(Granite.I18n.get("This card does not exist (anymore)."))
}else{window.alert(Granite.I18n.get("Error displaying card details ({0}/{1})",[k,j]))
}window.location.reload()
}})
},openCardPinningDlg:function(l,g){var k=this;
var b=$("#mac-pinToBoard");
var h=g.offset();
var j=b.width();
var f={top:g.height()+14,left:g.width()/2+12};
var d=h.left-j+f.left;
if(d<0){var a="#mac-pinToBoard:before {margin-left:"+(-30+d)+"px};";
$("<style id='arrow-style'>").text(a).prependTo(b)
}b.css({top:h.top+f.top,left:Math.max(d,0)});
this.loadCardPinningMenu(l);
window.setTimeout(function(){$(document).on("keydown.card-pinning-dialog",function(m){if(m.keyCode==27){k.closeCardPinningDlg();
return false
}});
$(document).on("tap.card-pinning-dialog click.card-pinning-dialog",function(n){var m=$(n.target);
if(m.closest(b).length==0){k.closeCardPinningDlg();
if(n.type=="tap"&&m.closest(".quickaction-circle").length==0){$.quickaction()
}}})
},500)
},togglePinToBoard:function(j,b){var k=b.data("path");
if(!k){return
}var d=$("[type=checkbox]",b);
var g=$("button",b);
if(!d.prop("disabled")){var a={};
var h=!g.hasClass("hidden");
var f=h?"unpin":"pin";
$.ajax({url:k+"/_jcr_content.pin.json",type:"post",data:{cardPath:j,action:f},dataType:"json",success:function(l){a=l;
a.status=true
},error:function(){a.status=false
},complete:function(){if(a.status){d.prop("checked",!h);
g.toggleClass("hidden",h)
}}})
}},toggleCardSelection:function(a){a.toggleClass("foundation-selections-item nocheck selected",!a.hasClass("selected"))
},refreshContent:function(f,d,b){var a=this;
b=b||".content-container, #board-container";
$.ajax({url:f,dataType:"html",cache:false,success:function(g){try{$(b).replaceWith(g)
}catch(h){window.console&&console.log("Refresh content error",h)
}initCards($)
},error:a.ajaxError,complete:d})
},createAjaxSuccess:function(b){var a=this;
return function(h,k,g){var f=this;
var d=arguments;
if(h&&h.redirect){window.location.href=Granite.HTTP.externalize(h.redirect);
return
}var j=function(){a.removeMessages();
if(h){if(h.message){a.addMessage(h.message,false)
}if(h.messages){a.addMessages(h.messages,false)
}}if(b){b.apply(f,d)
}};
if(h&&h.refresh){a.refreshContent(Granite.HTTP.externalize(h.refresh),j)
}else{j()
}}
},ajaxSuccess:function(){return tartan.core.createAjaxSuccess().apply(this,arguments)
},createAjaxError:function(b){var a=this;
return function(d,g,f){a.addErrorMessage(Granite.I18n.get("An error occurred with the request."));
if(window.console){console.error("Request error: "+g,f)
}if(b){b.apply(this,arguments)
}}
},ajaxError:function(a,d,b){return tartan.core.createAjaxError().apply(this,arguments)
},_getMessagesContainer:function(){var a=$(".modal .messages").filter(":visible");
if(a.length==0){a=$(".messages").filter(":visible")
}return a.first()
},removeMessages:function(){this._getMessagesContainer().children().not(".preserve").remove()
},addErrorMessage:function(b,a){this.addMessage({type:"error",content:b},a)
},addNoticeMessage:function(b,a){this.addMessage({type:"notice",content:b},a)
},addSuccessMessage:function(b,a){this.addMessage({type:"success",content:b},a)
},addInfoMessage:function(b,a){this.addMessage({type:"info",content:b},a)
},addHelpMessage:function(b,a){this.addMessage({type:"help",content:b},a)
},addMessage:function(b,a){if(a===undefined||a){this.removeMessages()
}if(b.closable===undefined){b.closable=true
}if(!b.heading){switch(b.type){case"error":b.heading=Granite.I18n.get("ERROR");
break;
case"notice":b.heading=Granite.I18n.get("NOTICE");
break;
case"success":b.heading=Granite.I18n.get("SUCCESS");
break;
case"info":b.heading=Granite.I18n.get("INFO");
break;
case"help":b.heading=Granite.I18n.get("HELP");
break
}}if(b.content&&b.escape!==false){b.content=$("<div/>").text(b.content).html()
}$("<div>").appendTo(this._getMessagesContainer()).alert(b)
},addMessages:function(d,b){for(var a=0;
a<d.length;
a++){this.addMessage(d[a],b);
b=false
}},addHTMLMessage:function(a){$(a).appendTo(this._getMessagesContainer())
},ajaxSubmitFileForm:function(d,b,a){var f;
if(a){f=b.find(a).not(":disabled").attr("disabled",true)
}if(window.FormData){var g=new FormData(b[0]);
if($.browser.msie){g.append("_ie_form_data_","")
}$.extend(d,{data:g,contentType:false,processData:false})
}else{$.extend(d,{dataType:"iframe "+d.dataType,fileInput:b.find(":file:enabled"),formData:b.find(":input:not(:file)").serializeArray()})
}if(f){f.removeAttr("disabled")
}$.ajax(d)
},refreshCards:function(b){if(this.isCardsRefreshing){return
}b=b||{};
var a=this;
a.isCardsRefreshing=a.preventRefreshNotification=true;
if(!$.support.transition){$.fn.transition=$.fn.animate
}var g=$("#board-refresh");
g.transition({y:-g.outerHeight()},function(){g.remove()
});
var d=$(".foundation-collection"),f=d.data("path");
$.ajax({url:f+".content.html",data:{showHiddenCards:tartan.core.showHiddenCards},dataType:"html",cache:false}).done(function(m){var k=$("<div>").hide().appendTo("body").html(m),l=k.find(".foundation-collection");
k.remove();
var s=(l.data("newest")<=d.data("newest"));
var r=(l.data("userupdate")<=d.data("userupdate"));
if(s&&r&&!b.force){a.isCardsRefreshing=a.preventRefreshNotification=false;
return
}l.css({visibility:"hidden",position:"absolute",left:0,top:d.position().top+d.parent().scrollTop()}).width(d.width()).insertAfter(d);
var o=false,p=false;
l.one("cui-gridlayout-initialized",function(){p=true;
j()
});
var n=l.find("img").on("load error",j);
Granite.UI.Foundation.Layouts.layout(l);
initCards($,l);
function j(t){if(!o&&p){n=n.filter(function(){return $(this).attr("src")&&!this.complete
});
if(n.length>0){if(!t){window.setTimeout(j,10)
}}else{o=true;
h()
}}}function h(){d.find(".mac-dv-chart").each(function(){var v=$(this).data("chart");
if(v&&v.destroy){v.destroy()
}});
d.css({overflow:"visible"});
d.children().css({minHeight:1});
var u=1000;
var t=d.find("article");
$(t.toArray().reverse()).each(function(){var w=$(this),A=w.position(),v=w.width(),z=l.find("article[data-path='"+w.data("path")+"']");
if(q(z)||q(w)){w.css({width:v,position:"absolute",left:A.left,top:A.top})
}else{w.remove();
z=null
}w.data("newThis",z)
});
t.each(function(){var w=$(this),z=w.data("newThis");
if(z){if(z.length>0){var A=w.position();
var v=z.position();
if(!_.isEqual(A,v)){w.transition({x:v.left-A.left,y:v.top-A.top},u)
}}else{w.transition({opacity:0},u)
}}});
t.promise().done(function(){l.css({opacity:0,visibility:"visible"}).transition({opacity:1},u,function(){var w=$(".content-container"),v=w.scrollTop();
d.remove();
l.removeAttr("style");
w.scrollTop(v);
a.isCardsRefreshing=a.preventRefreshNotification=false
})
})
}function q(v){if(v.length>0){var u=v.offset(),t=$(window).height();
return u.top+v.height()>0&&u.top<t
}else{return false
}}})
},prependCards:function(g){var f=$(".foundation-collection"),a=f.data("cuigridlayout");
var b=[];
for(var d=0;
d<g.length;
d++){var h=g[d];
h.hide().appendTo("body");
b.push({$el:h,w:h.width(),h:h.height()});
h.remove().show()
}a.items=b.concat(a.items);
a.numCols=-1;
a.layout()
},prelayoutGrid:function(){var b=$(".grid-0").last();
if(b.length>0){var g=15,f=240;
var h=Math.max(1,Math.floor((b.width()+g)/(f+g)));
var d=(b.width()-g)/h-g;
if($.browser.msie){d-=1
}var a=".grid-0 article {width: "+d+"px !important; margin-right: "+g+"px !important;}";
$("<style>").text(a).appendTo("head")
}},loadCardView:function(){if(location.hash&&location.hash.length>0){var b=location.hash;
var f=b.indexOf("#card");
if(f!=-1){b=b.substring("#card".length);
var a;
var d=b.indexOf("?comment");
if(d!=-1){a=b.substring(f,d)+".details.html";
if(a){var g=tartan.core.openDetails(a);
b=b.substr(d+"?comment".length);
g.done(function(){tartan.core.scrollToComment(b)
});
location.hash=""
}}}else{if(b.indexOf("#comment")!=-1){b=b.substring("#comment".length);
var a;
var h=b.indexOf("/comments");
if(h!=-1){a=b.substring(0,h)+".details.html";
if(a){var g=tartan.core.openDetails(a);
g.done(function(){tartan.core.scrollToComment(b)
});
location.hash=""
}}}}}},scrollToComment:function(g){var f=$(".details-container",".mc_report_dialog");
var a=f.find(".comments .list-comments");
var h=a.find(".comment");
var j,d=0;
for(var b=0;
b<h.length;
b++){j=$(h[b]);
if(j.data("comment-path")==g){break
}d+=j.height()
}a.animate({scrollTop:d},500,"swing")
},appendCards:function(g){var f=$(".foundation-collection"),a=f.data("cuigridlayout");
var b=[];
for(var d=0;
d<g.length;
d++){var h=$(g[d]);
h.hide().appendTo("body");
h.addClass("newlyAddedCard");
b.push({$el:h,w:h.width(),h:h.height()});
h.remove().show()
}a.items=a.items.concat(b);
a.numCols=-1;
a.layout();
$(".newlyAddedCard").css({opacity:0,visibility:"visible"}).animate({opacity:1},1500);
$(".newlyAddedCard").removeClass("newlyAddedCard")
},getMoreCards:function(a){var b=$(".foundation-collection"),d=b.data("path");
$.ajax({url:d+".content.html",data:{start:a.start,limit:a.limit},dataType:"html",cache:false}).done(function(j){var f=$("<div>").hide().appendTo("body").html(j);
var m=f.find("article").toArray();
f.remove();
var k=m.slice(0);
for(var h=0;
h<m.length;
h++){var g=m[h];
var l=$(g).attr("data-path");
if($("article[data-path='"+l+"']").length>0){k.splice(h,1)
}}if(!(k&&k.length==0)){tartan.core.appendCards($(k))
}tartan.core.doScroll=true
})
}};
(function(b,a,d){CUI.Usersuggestion=new Class({toString:"Usersuggestion",extend:CUI.Widget,construct:function(){this._setupHighlighter();
this._setupListeners();
this.reset()
},reset:function(){this._lastText="";
this._mentions=[];
this._resultCache={};
this._refresh()
},defaults:{mentionsChar:"@",userTemplate:"{{name}} {{#if email}} <{{email}}> {{/if}}",remoteUrls:["mac/components/cards/base"],remoteUserParamName:"q",remoteParams:{},maxSize:10,cacheResults:true,prefetchedUsers:[],mode:"contains"},_setupHighlighter:function(){var g=this;
var k=b("<div class=highlightcontainer style='position: absolute;' >").insertBefore(this.$element);
var j=b("<div class='userhighlight' style='position: absolute; top: 0px' >");
b("<div style='height: 100%; width: 100%; position: relative;'>").appendTo(k).append(j);
var h=["font-size","font-family","font-weight","line-height","text-rendering","padding-top","padding-right","padding-bottom","padding-left","margin","margin-top","margin-right","margin-bottom","margin-left","border","border-color","border-top-width","border-right-width","border-bottom-width","border-left-width","height","word-wrap","box-sizing","-webkit-box-sizing","-moz-box-sizing"];
h.forEach(function(m){var l=g.$element.css(m);
if(l){k.css(m,l)
}});
this._highlighter=j;
var f=b("<input type='hidden' name='encodedText'>").insertBefore(this.$element);
this._encodedTextField=f
},_setupListeners:function(){this.$element.on("keydown",this._handleKeyDown.bind(this));
this.$element.on("cut paste input",this._handleInput.bind(this));
this.$element.on("resize",this._handleResize.bind(this));
this.$element.on("scroll",this._handleScroll.bind(this))
},_handleKeyDown:function(f){setTimeout(this._refresh.bind(this),0);
if(f.which==13){if(this._selectList&&this._selectList.is(":visible")){this._selectList.find('[role="option"].focus').trigger("click");
f.preventDefault();
f.stopImmediatePropagation();
return
}}if(f.which==27){if(this._selectList&&this._selectList.is(":visible")){this._selectListWidget&&this._selectListWidget.hide();
f.preventDefault();
return
}f.preventDefault()
}if(f.which==38||f.which==40){if(this._selectList&&this._selectList.is(":visible")){var g=this._selectList.find('[role="option"].focus').removeClass("focus").index();
var h;
if(g==-1){if(f.which==40){h=this._selectList.find('[role="option"]').first()
}else{h=this._selectList.find('[role="option"]').last()
}}else{if(f.which==40){h=this._selectList.find('[role="option"]').eq(g+1)
}else{h=this._selectList.find('[role="option"]').eq(g-1)
}}h.addClass("focus");
f.preventDefault();
f.stopImmediatePropagation();
this._scrollToItem(h);
return
}}setTimeout(this._triggerSearch.bind(this),0)
},_handleInput:function(){var f=function(){var h=b("textarea")[0];
var j=h.value;
if(j==this._lastText){return
}var k=h.selectionStart;
var g=h.selectionEnd;
this._compare(this._lastText,j,k);
this._lastText=j;
this._triggerSearch()
};
setTimeout(f.bind(this),0)
},_compare:function(f,k,l){var m=f;
var h=k.substring(l);
k=k.substring(0,l);
var g=f.lastIndexOf(h);
f=f.substring(0,g);
for(var j=0;
j<f.length&&j<k.length;
j++){if(f[j]!=k[j]){break
}}f=f.substring(j);
k=k.substring(j);
if(f){this._handleDelete(m,j,j+f.length)
}if(k){this._handleInsert(k,j)
}},_triggerSearch:function(){var g=this.$element[0];
var j=g.value;
var m=g.selectionStart;
if(j!=null){var l=j.substring(0,m);
var f=this.options.mentionsChar;
var k=l.lastIndexOf((f));
if(k>-1){var h=l.substring(k+1,m);
this._fireQuery(h)
}else{this._selectListWidget&&this._selectListWidget.hide()
}}},_handleDelete:function(p,l,j){var k=j-l;
for(var u=this._mentions.length-1;
u>=0;
u--){var o=this._mentions[u];
var q=o.display;
var s=q.split(" ");
var m;
var h=l-o.index;
var v=j-o.index;
var n=q.substring(h,v);
m=q.substring(0,h)+q.substring(v);
var g=m.split(" ");
var w;
w=b.map(g,function(C){return b.inArray(C,s)<0?null:C
});
if(m==""){this._mentions.splice(u,1);
continue
}if(n==""){continue
}o.display=w.join(" ").trim();
this._mentions.forEach(function(C){if(C.index>o.index){C.index-=(q.length-o.display.length)
}});
var f=q.indexOf(o.display)==0;
var B=!f;
var t=l,A=j;
if(B){t=o.index=Math.min(l,o.index);
A=j+p.substring(j).indexOf(o.display)
}else{t=o.index+o.display.length;
A=Math.max(j,o.index+q.length)
}var z=p.substring(0,t)+p.substring(A);
var r=this;
setTimeout(function(){r.$element.val(z);
r._lastText=z
},0)
}this._mentions.forEach(function(C){if(C.index>=j){C.index-=(j-l)
}});
this._mentions=b.map(this._mentions,function(D,C){if(D.display!=null&&D.display.length>0){return D
}});
setTimeout(this._refresh.bind(this),0)
},_handleInsert:function(j,g){for(var h=this._mentions.length-1;
h>=0;
h--){var f=this._mentions[h];
if(f.index>=g){f.index+=j.length
}else{if(f.index+f.display.length>g){this._mentions.splice(h,1)
}}}setTimeout(this._refresh.bind(this),0)
},_fireQuery:function(m){var o=this;
if(m==""){if(this.options.prefetchedUsers&&this.options.prefetchedUsers.length>0){this._showUserList(this.options.prefetchedUsers,m);
return
}}if(this._resultCache[m]){this._showUserList(this._resultCache[m],m);
return
}var n=0;
var q={};
q[this.options.remoteUserParamName]=m;
var h=b(".details-container");
var p=h.attr("cq-path");
q.path=p;
var l=(this.options.remoteUrls||[]).slice();
var k=this.options.maxSize;
var f=this.options.prefetchedUsers;
while(l.length>0&&n<=k){var g=l.shift();
var j=b.extend({},q,this.options.remoteParams);
b.getJSON(g,j).done(function(r){var s=r.users;
if(f&&f.length>0){s=s&&s.filter(function(u){return f.some(function(v){return v.id!=u.id
})
})
}var t=[].concat(f,s);
o._resultCache[m]=t;
o._showUserList(t,m)
}).fail(function(){console.error("remoteQuery "+g+" FAILED! ",arguments)
})
}},_showUserList:function(m,l){var h=this;
var g=this.$element.parent();
b("ul",g).remove();
if(m&&m.length>0){var j=Handlebars.compile(this.options.userTemplate);
var k=b("<ul>").addClass("selectlist");
var f=0;
m.some(function(o){var n=j(o);
n=b("<p>").text(n).html();
var p=new RegExp("("+l+")","gi");
if(n.search(p)!=-1){if(l){n=n.replace(p,"<b>$1</b>")
}b("<li>").html(n).data("value",o).appendTo(k);
return(++f>=h.options.maxSize)
}});
if(k.children().length==0){return
}k.appendTo(g);
this._selectList=k.selectList({relatedElement:this.$element,autofocus:false,autohide:true});
this._selectList.on("selected",this._handleSelected.bind(this));
this._selectListWidget=this._selectList.data("selectList");
this._selectListWidget.show()
}},_handleSelected:function(o){var m=this.$element[0];
var p=m.value;
var k=m.selectionStart;
var f=o.selectedValue;
var l={user:f,display:f.name};
var h=p.substring(0,k);
var n=this.options.mentionsChar;
var j=h.lastIndexOf((n));
this._handleDelete(p,j,k);
this._handleInsert(f.name,j);
l.index=j;
this._mentions.push(l);
var g=p.substring(0,j)+f.name+p.substring(k);
this.$element.val(g);
this._lastText=g;
this._selectList.remove();
this._refresh()
},_refresh:function(){var k=this.$element.val();
var g=this._mentions.sort(function(m,l){return m.index<l.index
});
var j="";
var f="";
var h=this.$element.val();
g.forEach(function(l){f=h.substring(0,l.index);
f+=h.substring(l.index).replace(l.display,"@["+l.user.id+":"+l.display+"]");
h=f;
j=k.substring(0,l.index);
j+=k.substring(l.index).replace(l.display,"<span>"+l.display+"</span>");
k=j
});
this._highlighter.html(j);
this._encodedTextField.val(f)
},_handleResize:function(f){var g=this;
setTimeout(function(){var h=g._highlighter.closest(".highlightcontainer");
var j=g.$element.css("height");
h.css("height",j)
},0)
},_handleScroll:function(g){var h=this._highlighter.css("top");
var f=this.$element.prop("scrollTop");
this._highlighter.css("top",-f)
},_scrollToItem:function(f){if(!f.length){return
}var h=f.position().top,k=f.outerHeight(false),g=this._selectList[0];
var j=h+k-g.clientHeight;
if(j>0){g.scrollTop+=j
}else{if(h<0){g.scrollTop+=h
}}}});
CUI.util.plugClass(CUI.Usersuggestion);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(f){b("[data-init~=usersuggestion]",f.target).usersuggestion()
})
}}(jQuery,this));
if(window.Handlebars){Handlebars.registerHelper("ifCond",function(d,b,a){if(d===b){return a.fn(this)
}return a.inverse(this)
})
}jQuery(function(d){d.cookie("utcOffset",(-1*new Date().getTimezoneOffset()),{path:"/"});
var a=d("#main-rail");
function b(){if(a.hasClass("closed")){a.removeClass("closed");
a.trigger("open")
}else{a.addClass("closed");
a.trigger("close")
}d(window).resize()
}d(document).fipo("tap","click","[data-toggle='main-rail']",b);
a.on("open close toggle",function(){d(".foundation-collection").cuigridlayout("layout")
});
d(document).on("click","a.profile-mgmt.open-rail",function(g){var f=d(g.target).nextAll("a.profile-mgmt-child");
f.each(function(){var h=d(this);
h.slideToggle("slow");
h.css("display","block")
})
});
d(document).fipo("tap","click",".card-navigate a",function(){if(a.hasClass("closed")){b()
}else{a.css({position:"relative"});
var j=4;
for(var g=0;
g<j;
g++){var f=(g%2==0)?"-":"+";
var h=(g==0||g==j-1)?100:50;
a.animate({left:f+"=15px"},h)
}}});
d.ajaxPrefilter(function(f,h,g){if(f.type=="post"||f.type=="POST"){f.headers=d.extend(f.headers||{},{"cache-control":"no-cache"})
}});
if(d(".foundation-collection").data("newest")!==undefined){window.setInterval(function(){if(!tartan.core.preventRefreshNotification&&d("#board-refresh").length==0){var h=d(".foundation-collection"),g=h.data("path"),f=h.data("newest");
d.ajax({url:g+"/_jcr_content.refresh.json?since="+f,dataType:"json",success:function(j){if(j.count>0){tartan.core.preventRefreshNotification=true;
var k=Granite.I18n.get("There are changes. Click to refresh.");
if(CUI.util.isTouch){k=Granite.I18n.get("There are changes. Tap to refresh.")
}if(d(".toolbar").length>0){d("<a id='board-refresh'>").text(k).insertAfter(".toolbar:last").animate({top:0})
}else{d(".foundation-collection-container").prepend(d("<div class='foundation-layout-mode feed-message-layout'>").append(d("<a id='board-refresh' class='feed-refresh-message'>").text(k))).animate({top:0})
}}}})
}},15000);
d(document).on("click","#board-refresh",function(f){f.preventDefault();
tartan.core.refreshCards()
})
}if(Granite.TouchIndicator&&d.cookie("mcdemo_touch")){Granite.TouchIndicator.init()
}d(document).on("click",".alert button",function(f){f.preventDefault()
});
d(document).fipo("tap","click","[data-toggle='card-pin']",function(){var f=d(this).data("path");
tartan.core.toggleCardPinningDlg(f,d(this))
});
d(".mc_dialog_mate").fipo("tap","click",function(f){tartan.core.closeDetails()
});
d(document).fipo("tap.tartan-actions-pin-activator","click.tartan-actions-pin-activator",".tartan-actions-pin-activator",function(h){var g=d(this);
var f=g.data("path");
tartan.core.toggleCardPinningDlg(f,g)
});
d(document).fipo("tap.tartan-actions-info-activator","click.tartan-actions-info-activator",".tartan-actions-info-activator",function(h){var g=d(this);
var f=g.data("path");
tartan.core.openDetails(f+".details.html")
});
d(document).fipo("tap.tartan-actions-delete-activator","click.tartan-actions-delete-activator",".tartan-actions-delete-activator",function(l){var j=d(this);
var h=j.data("path");
var g=d("div#board-container");
var f=g.data("path");
var m=g.data("type");
var k=j.data("referrer");
d.quickaction();
tartan.core.deleteCard(m,k,h,f)
});
d(document).fipo("tap.tartan-actions-unhide-activator","click.tartan-actions-unhide-activator",".tartan-actions-unhide-activator",function(k){var j=d(this);
var h=j.data("path");
var g=d("div#board-container");
var f=g.data("path");
d.quickaction();
tartan.core.unhideCard(h,f)
});
d(document).fipo("tap.tartan-actions-refresh-activator","click.tartan-actions-refresh-activator",".tartan-actions-refresh-activator",function(j){var q=d(this);
var g=q.data("path");
var h=q.closest(".mc_report_dialog");
var o;
if(h.length>0){o=h.find("div[cq-path='"+g+"']")
}else{o=d("article[data-path='"+g+"']")
}var k=o.find(".mac-dv-chart, .mac-card-image");
d.quickaction();
var m=k.data("url");
if(!m){return
}var f=k.data("json")||{};
var l=k.data("chart-type")||"";
var p=k.data("chart-opts")||{};
var n=o.find(".chart-reload-mask");
n.show();
tartan.dv.refresh({card:(h.length==0),cardPath:g,parent:k,data:f,dataURL:m,chartType:l,chartOpts:p,onSuccess:function(r){n.hide()
},onError:function(r){n.hide()
}})
});
d(document).on("quickactionclosemenu",function(){tartan.core.closeCardPinningDlg()
});
initCards(d)
});
(function(a){a(document).on("cui-contentloaded",function(){a(this).find("div.tabs").tabs()
})
})(jQuery);
jQuery(function(a){_g.$(".modal.comment").on("shown",function(d){var b=a(this);
a("textarea",b).focus()
});
_g.$(".modal.comment").on("hidden",function(d){var b=a(this);
b.data({success:null})
});
a("body").on("click.activity.data-api",'[data-toggle="comment"]',function(g){g.preventDefault();
var b=a(this).closest(".comment");
var d=_g.$(this).closest(".modal");
if(b.length==0){return
}var f={path:b.find("[name='path']").val(),title:b.find("[name='title']").val(),msg:b.find("textarea").val()};
if(f.msg==""){return
}if(d.data().success){d.data().success.call(d,f);
return
}a(".spinner",b).show();
a.ajax({type:"POST",url:"/bin/granite/activitystreams",data:JSON.stringify({title:f.title,verb:"comment",object:{id:f.path,content:f.msg}}),complete:function(h){d.modal("hide");
a(".spinner",b).hide();
b.find("textarea").val("")
},contentType:"application/json;charset=UTF-8"})
});
tartan.core.loadCardView();
a(window).on("hashchange",tartan.core.loadCardView);
a("body").on("click.mentions-path","span[data-mentions-path]",function(d){var b=a(this).data("mentions-path");
location.href=b
});
a(document).on("click","span.clickable-link",function(f){var b=a(this).attr("href");
if(b){var d=window.open(b,"_blank");
d.focus()
}})
});
var initCards=function(a,b){if(!b){b=a("#board-container")
}if(b.data("cuigridlayout")==null){b.cuigridlayout()
}b.on("click","button.pdfDownload",function(f){var d=a(f.target).attr("data-path")+"/file.pdf";
window.open(d)
});
b.on("tap.tartan click.tartan","article > a",function(f){if(b.hasClass("mode-selection")){return
}var d=a(this);
if(d.data("target")=="card-details"){if(CUI.util.isTouch&&f.type=="click"){return false
}else{f.preventDefault();
if(!a(f.target).hasClass("clickable-link")){tartan.core.closeCardPinningDlg();
tartan.core.openDetails(d.attr("href"))
}}}});
b.find("article.card-mac-dv-report .mac-dv-chart").each(function(){var k=a(this);
var f=k.closest("article").data("path");
var d=k.data("json");
var j=k.data("url");
var g=k.data("chart-type")||"";
var h=k.data("chart-opts")||{};
if(!j){return
}k.on("render",function(m,l){k.data("chart",l)
});
tartan.dv.render({cardPath:f,parent:k,data:d,dataURL:j,chartType:g,chartOpts:h,card:true})
});
initCardsMove(b)
};
jQuery(function(h){function j(o){return new (tartan.cardTypes[o]||tartan.cardTypes.base)
}function b(o){g();
var s=h(".details-container");
var q=s.attr("cq-path")+".comments.html";
var p=s.find(".list-comments");
var r=p.find(".comment").length;
if(o&&o.loadAll){p.find(".commentstream").remove();
r=0
}h.ajax({url:q,dataType:"html",data:{offset:r},success:function(t){p.append(t);
k(true);
f()
}})
}function k(o){var q=h(".list-comments");
var p=q.prop("scrollHeight");
if(o){q.animate({scrollTop:p},"fast")
}else{q.prop("scrollTop",p)
}}function g(){h(".center-right").children().hide()
}h(document).on("click tap",".cardDetails .comment",function(){f(h(this))
});
h(document).on("click tap",".cardDetails .comment .icon-edit",function(){n(h(this),false)
});
h(document).on("click tap",".cardDetails .comment .icon-delete",function(){n(h(this),true)
});
h(document).on("click tap",".cardDetails .comment .icon-close",function(){a(h(this))
});
h(document).on("submit",".edit-comment",function(){var o=h(this);
h.ajax({url:this.getAttribute("action"),type:"post",data:h(this).serialize(),dataType:"json",error:function(p,r,q){d(q)
},complete:function(q,r){var p=o.parent(".comment");
if(r=="success"){p.remove();
b()
}else{p.find("p").attr("style","display:");
p.children("form").remove();
p.children(".person").find(".icon-close").attr("class","icon-edit right");
p.children(".person").find(".icon-delete").show()
}}});
return false
});
function d(p){var q=h(".mc_dialogs");
var o=h("<div>").addClass("modal").appendTo(q).modal({content:(p==undefined||p.trim()=="")?Granite.I18n.get("Unexpected error has occured, please try again. Click 'OK' to continue."):p,buttons:[{label:Granite.I18n.get("OK"),className:"warning",click:function(){o.modal("hide")
}}]});
o.find(".modal-header").remove();
o.find(".warning").focus();
o.modal("show")
}h(document).on("click",".cardDetails .comment .icon-delete",function(){var q=h(".mc_dialogs");
var p=h("<div>").addClass("modal").appendTo(q).modal({content:Granite.I18n.get("Are you sure, you want to delete this comment? "),buttons:[{label:Granite.I18n.get("Delete"),className:"warning",click:function(){p.modal("hide");
o()
}},{label:Granite.I18n.get("Cancel"),click:function(){p.modal("hide")
}}]});
p.find(".modal-header").remove();
p.find(".warning").focus();
p.modal("show");
function o(){var r=h(".comment .edit-comment")[0];
h.ajax({url:r.getAttribute("action"),type:"post",data:h(r).serialize(),dataType:"json",complete:function(){b({loadAll:true})
},error:function(s,u,t){d(t)
}})
}});
function n(t,s){var o=t.parent(".person").parent(".comment");
var r=h(".editComment").html();
h(r).appendTo(o);
var q=o.find("p").text();
o.children("form").children("textarea").text(q);
var p=h("<input/>",{type:"hidden",name:"commentPath",value:t.attr("commentPath")});
p.appendTo(o.children("form"));
var u=h("<input/>",{type:"hidden",name:"operation",value:"update"});
if(s){o.find("form").attr("style","display:none;");
u=h("<input/>",{type:"hidden",name:"operation",value:"delete"})
}else{o.find("p").attr("style","display:none;");
t.removeClass("icon-edit");
o.find(".icon-delete").hide();
t.addClass("icon-close")
}u.appendTo(o.children("form"))
}function a(p){var o=p.parent(".person").parent(".comment");
o.children("form").remove();
o.find("p").attr("style","display:");
p.removeClass("icon-close");
p.addClass("icon-edit");
o.find(".icon-delete").show()
}function f(q){var o=h("#card-content .annotatable");
if(o.length>0){var p=h(".cardDetails .comment");
if(!q){q=p.last()
}p.removeClass("selected");
q.addClass("selected");
var r=q.attr("data-annotation");
if(r){l(o,r)
}else{o.annotation({}).clear()
}}}function l(p,t){var o=p.annotation({resizeWatch:true});
o.clear();
var q=p.data("chart");
if(q&&q.plotBounds){var r=p.data("chart-type");
var s=r.indexOf("/trend/")<0;
o.setV2DMapping(function(u){return Granite.UI.Annotation.DV_V2DMapping(u,q,s)
});
o.setD2VMapping(function(u){return Granite.UI.Annotation.DV_D2VMapping(u,q,s)
})
}o.open();
o.fromJson(t);
o.show()
}h(".mc_report_dialog").on("ready",".details-container",function(){var z=h(this);
var t=h("#card-content");
var w=z.attr("cq-path");
h.post(w+".viewed.json");
var r=j(t.data("cardType"));
r.renderNormal(t,f);
var F=h(".list-comments",z),E=h(".add-comment",z),G=E.find("textarea"),B=E.find("[type='submit']"),D=E.find("[data-toggle='annotate']"),C=G.add(B).add(D),q=E.find(".spinner"),A=E.find("[name='annotationData']"),v=E.find("[name='annotationImage']");
C.prop("disabled",E.data("disabled"));
u();
k();
var p=[];
var s={};
F.find(".person").each(function(){var H={};
h.each(h(this).data(),function(I,J){I=I.replace(/^user/,"").toLowerCase();
H[I]=J
});
if(!s[H.id]){p.push(H)
}s[H.id]=H
});
G.usersuggestion({prefetchedUsers:p,remoteUrls:[w+".usersuggestions.json"]});
var o=E.find(".highlightcontainer");
G.on("keypress",function(H){if(H.which==13&&!(H.shiftKey||H.ctrlKey||H.altKey)){h(this.form).submit();
return false
}}).on("keyup",u).on("focus",function(I){var H=h(".comment").find(".icon-close");
if(H.length!=0){a(H)
}u(I)
}).on("blur",function(){window.setTimeout(u,500)
});
function u(N){var I=G.data("heightDiv");
if(!I){var I=h("<div>");
var J=["font-size","font-family","font-weight","line-height"];
J.forEach(function(O){I.css(O,G.css(O))
});
I.css({"word-wrap":"break-word","white-space":"pre-wrap"}).width(G.width()).hide().insertAfter(G);
G.data("heightDiv",I)
}I.text(G.val()+" PADDING");
G.height(I.height());
var M=h.trim(G.val()).length===0;
var L=G.hasClass("newannotation")&&A.val().length>0;
var H=(N&&N.type==="focus")||G.is(":focus")||!M||L||t.hasClass("annotate");
if(L){G.attr("placeholder",Granite.I18n.get("Comment on annotation ..."))
}else{G.attr("placeholder",Granite.I18n.get("Write a comment ..."))
}B.toggle(H).prop("disabled",M);
var K=G.innerWidth()-G.prop("clientWidth");
if(K<40){D.css("margin-left",-D.width()-1-K)
}F.css("max-height",F.parent().height()-E.outerHeight())
}E.on("submit",function(H){H.preventDefault();
if(h.trim(G.val()).length>0){q.show();
C.hide();
o.hide();
h.ajax({url:E.attr("action"),type:"post",data:E.serialize(),dataType:"json",complete:function(){q.hide();
C.show();
o.show();
G.blur().add(A).add(v).val("");
G.removeClass("newannotation");
G.attr("placeholder",Granite.I18n.get("Write a comment ..."));
u();
b()
}})
}h(".comment .person button").remove();
G.data("usersuggestion").reset();
return false
});
D.on("click",function(){var I=t.find(".annotatable");
if(I.length==0){return
}A.val("");
G.removeClass("newannotation");
if(t.hasClass("annotate")){t.add(D).removeClass("annotate");
I.annotation("clear");
u()
}else{t.add(D).addClass("annotate");
u();
I.bind("annotateEnd",function(K,J){t.add(D).removeClass("annotate");
A.val(J.toJson());
var L=J.ctx.canvas.toDataURL("image/png",1);
v.val(L);
G.addClass("newannotation");
G.focus();
u()
});
var H=I.annotation({resizeWatch:true});
H.clear();
r.prepareAnnotation(H,t);
H.open();
H.start()
}})
});
function m(){h("article.mac-product-card").each(function(r,t){var p=h(t);
var q=h(".product",p);
if(q.length>1){var w=p.data("mac-card-index")||0;
var s=(w+1)%q.length;
h(q[w]).removeClass("active");
h(q[s]).addClass("active");
p.data("mac-card-index",s);
var u=h(".mac-dv-chart",p);
var v=u.data("mac-dv-chart");
if(v){var o=v.wrapper;
o.data(v.self.generateData(s)).render(true)
}}});
setTimeout(m,5000)
}setTimeout(m,5000);
h(document).fipo("tap","click",".mac-product-overlay .legend",function(o){var r=h(o.currentTarget);
var q=r.closest(".mac-product-overlay");
var p=r.data("metric");
if(!r.hasClass("off")&&h(".legend.off",q).length>0){h(".legend",q).removeClass("off");
h(".mac-dv-chart",q).each(function(s,t){var u=h(t).data("mac-dv-chart");
var v=u.wrapper;
v.data(u.data).render(true)
})
}else{h(".legend",q).addClass("off");
r.removeClass("off");
h(".mac-dv-chart",q).each(function(s,t){var u=h(t).data("mac-dv-chart");
var v=u.wrapper;
v.data(u.self.filterData(u.data,p)).render(true)
})
}})
});
var initCardsMove=function(f){f=f?f.filter(".reorderable"):$(".grid.reorderable");
if(f.length>0){var m=10,n=100,t=50,b=50;
var j=$("<article class='card-placeholder'>"),w,h,p,k;
var D,v,C,z;
var r=0,a;
f.on("mousedown taphold","article",function(E){if(!h&&(E.type!="mousedown"||E.which==1)){h=$(this)
}});
if(CUI.util.isTouch){f.on("quickactionopenmenu",function(E,F){if(!h){h=$(F.target).closest("article")
}})
}$(document).on("mousemove touchmove",function(G){if(h){var I=C=A(G);
if(!D){D=I;
var H=h.offset();
v={x:D.x-H.left,y:D.y-H.top}
}var E=!!p;
if(!E){var F=Math.abs(D.x-I.x)+Math.abs(D.y-I.y);
E=F>m
}if(E){if(!p){s()
}B(I,z);
o(I)
}z=I;
return false
}}).on("mouseup touchend",function(F){if(p){r=0;
if(p.i!=k){d()
}h.removeClass("card-dragging selected").removeAttr("style").remove();
p.$el=h;
g(false);
var E=h;
E.click(false);
window.setTimeout(function(){E.off(false)
},10)
}h=p=w=C=z=D=null
}).on("dragstart drag dragenter dragover",false);
function s(){$.quickaction();
w=f.data("cuigridlayout");
h.width(h.width()).add(j).height(h.height()).end();
var F=h.offset();
h.addClass("card-dragging").offset(F);
var E=w.items;
k=u(h);
p=E[k];
p.$el=j;
g(true)
}function B(F,E){h.offset({left:F.x-v.x,top:F.y-v.y});
l(F,E)
}function l(L,K){if(!K){return
}var J=w.items;
for(var H=0;
H<J.length;
H++){var F=J[H];
var E=F.$el;
var G=E.offset();
if(L.x>=G.left&&L.y>=G.top&&L.x<=(G.left+E.outerWidth())&&L.y<=(G.top+E.outerHeight())){var I=j.offset();
var M=(I.top!=G.top)?I.top>G.top:L.x<K.x||L.y<K.y;
q(F,M);
break
}}}function q(G,H){if(h[0]!=G[0]){var E=w.items;
var F=H?G.i:G.i+1;
if(F!=p.i){j.height(Math.max(h.height(),G.$el.height()));
E.splice(F,0,p);
var I=p.i;
if(F<=I){I++
}E.splice(I,1);
g(true)
}}}function o(I){var F=f.parent();
var H=I.y-F.offset().top;
var E=H-n;
if(E>0){E=-F.height()+H+n;
if(E<0){E=0
}}r=Math.round(t*(E/n));
if(r!=0){if(!a){var G=F.prop("scrollHeight")-F.height();
a=window.setInterval(function(){if(r!=0){F.scrollTop(Math.min(F.scrollTop()+r,G));
B(C,z)
}else{window.clearInterval(a);
a=null
}},b)
}}}function d(){var J=h.data("referrer")||p.path;
var G=w.items,H=G[p.i==0?p.i+1:p.i-1],I=H.$el.data("referrer")||H.path,F=I.substring(I.lastIndexOf("/")+1);
var E=(p.i==0?"before":"after")+" "+F;
$.post(J,{":order":E});
$.post(f.data("path")+"/_jcr_content.touch.json")
}function A(E){var F=E.originalEvent.touches?E.originalEvent.touches[0]:E;
return{x:F.pageX,y:F.pageY}
}function u(G){var E=w.items;
for(var F=0;
F<E.length;
F++){if(E[F].$el[0]==G[0]){return F
}}return -1
}function g(G){var E=w.items;
for(var F=0;
F<E.length;
F++){E[F].i=F
}w.numCols=-1;
w.layout();
if(G){f.append(h)
}}}};
jQuery(function(b){var a=b("#report-container");
if(a.size()>0){a.cuigridlayout()
}else{a=b("#single-report-container")
}b(document).ready(function(){b(".cardcontent .dv",a).each(function(){var j=b(this);
var k=this.id;
var h=j.data("url");
if(!h){return
}var g=j.data("data");
var d=j.data("cache-path");
var f=j.data("chart-type")||"";
tartan.dv.render({resizeWatch:true,parent:j,dataURL:h,data:g,dataCachePath:d,chartType:f,card:false})
})
})
});
(function(){var A=this;
var m=A._;
var I={};
var H=Array.prototype,h=Object.prototype,t=Function.prototype;
var q=H.slice,E=H.unshift,d=h.toString,k=h.hasOwnProperty;
var Q=H.forEach,s=H.map,J=H.reduce,b=H.reduceRight,a=H.filter,F=H.every,r=H.some,o=H.indexOf,n=H.lastIndexOf,v=Array.isArray,g=Object.keys,K=t.bind;
var R=function(p){return new w(p)
};
if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=R
}exports._=R
}else{A._=R
}R.VERSION="1.3.3";
var N=R.each=R.forEach=function(W,V,U){if(W==null){return
}if(Q&&W.forEach===Q){W.forEach(V,U)
}else{if(W.length===+W.length){for(var T=0,p=W.length;
T<p;
T++){if(T in W&&V.call(U,W[T],T,W)===I){return
}}}else{for(var S in W){if(R.has(W,S)){if(V.call(U,W[S],S,W)===I){return
}}}}}};
R.map=R.collect=function(U,T,S){var p=[];
if(U==null){return p
}if(s&&U.map===s){return U.map(T,S)
}N(U,function(X,V,W){p[p.length]=T.call(S,X,V,W)
});
if(U.length===+U.length){p.length=U.length
}return p
};
R.reduce=R.foldl=R.inject=function(V,U,p,T){var S=arguments.length>2;
if(V==null){V=[]
}if(J&&V.reduce===J){if(T){U=R.bind(U,T)
}return S?V.reduce(U,p):V.reduce(U)
}N(V,function(Y,W,X){if(!S){p=Y;
S=true
}else{p=U.call(T,p,Y,W,X)
}});
if(!S){throw new TypeError("Reduce of empty array with no initial value")
}return p
};
R.reduceRight=R.foldr=function(V,U,p,T){var S=arguments.length>2;
if(V==null){V=[]
}if(b&&V.reduceRight===b){if(T){U=R.bind(U,T)
}return S?V.reduceRight(U,p):V.reduceRight(U)
}var W=R.toArray(V).reverse();
if(T&&!S){U=R.bind(U,T)
}return S?R.reduce(W,U,p,T):R.reduce(W,U)
};
R.find=R.detect=function(U,T,S){var p;
D(U,function(X,V,W){if(T.call(S,X,V,W)){p=X;
return true
}});
return p
};
R.filter=R.select=function(U,T,S){var p=[];
if(U==null){return p
}if(a&&U.filter===a){return U.filter(T,S)
}N(U,function(X,V,W){if(T.call(S,X,V,W)){p[p.length]=X
}});
return p
};
R.reject=function(U,T,S){var p=[];
if(U==null){return p
}N(U,function(X,V,W){if(!T.call(S,X,V,W)){p[p.length]=X
}});
return p
};
R.every=R.all=function(U,T,S){var p=true;
if(U==null){return p
}if(F&&U.every===F){return U.every(T,S)
}N(U,function(X,V,W){if(!(p=p&&T.call(S,X,V,W))){return I
}});
return !!p
};
var D=R.some=R.any=function(U,T,S){T||(T=R.identity);
var p=false;
if(U==null){return p
}if(r&&U.some===r){return U.some(T,S)
}N(U,function(X,V,W){if(p||(p=T.call(S,X,V,W))){return I
}});
return !!p
};
R.include=R.contains=function(T,S){var p=false;
if(T==null){return p
}if(o&&T.indexOf===o){return T.indexOf(S)!=-1
}p=D(T,function(U){return U===S
});
return p
};
R.invoke=function(S,T){var p=q.call(arguments,2);
return R.map(S,function(U){return(R.isFunction(T)?T||U:U[T]).apply(U,p)
})
};
R.pluck=function(S,p){return R.map(S,function(T){return T[p]
})
};
R.max=function(U,T,S){if(!T&&R.isArray(U)&&U[0]===+U[0]){return Math.max.apply(Math,U)
}if(!T&&R.isEmpty(U)){return -Infinity
}var p={computed:-Infinity};
N(U,function(Y,V,X){var W=T?T.call(S,Y,V,X):Y;
W>=p.computed&&(p={value:Y,computed:W})
});
return p.value
};
R.min=function(U,T,S){if(!T&&R.isArray(U)&&U[0]===+U[0]){return Math.min.apply(Math,U)
}if(!T&&R.isEmpty(U)){return Infinity
}var p={computed:Infinity};
N(U,function(Y,V,X){var W=T?T.call(S,Y,V,X):Y;
W<p.computed&&(p={value:Y,computed:W})
});
return p.value
};
R.shuffle=function(T){var p=[],S;
N(T,function(W,U,V){S=Math.floor(Math.random()*(U+1));
p[U]=p[S];
p[S]=W
});
return p
};
R.sortBy=function(T,U,p){var S=R.isFunction(U)?U:function(V){return V[U]
};
return R.pluck(R.map(T,function(X,V,W){return{value:X,criteria:S.call(p,X,V,W)}
}).sort(function(Y,X){var W=Y.criteria,V=X.criteria;
if(W===void 0){return 1
}if(V===void 0){return -1
}return W<V?-1:W>V?1:0
}),"value")
};
R.groupBy=function(T,U){var p={};
var S=R.isFunction(U)?U:function(V){return V[U]
};
N(T,function(X,V){var W=S(X,V);
(p[W]||(p[W]=[])).push(X)
});
return p
};
R.sortedIndex=function(W,V,T){T||(T=R.identity);
var p=0,U=W.length;
while(p<U){var S=(p+U)>>1;
T(W[S])<T(V)?p=S+1:U=S
}return p
};
R.toArray=function(p){if(!p){return[]
}if(R.isArray(p)){return q.call(p)
}if(R.isArguments(p)){return q.call(p)
}if(p.toArray&&R.isFunction(p.toArray)){return p.toArray()
}return R.values(p)
};
R.size=function(p){return R.isArray(p)?p.length:R.keys(p).length
};
R.first=R.head=R.take=function(T,S,p){return(S!=null)&&!p?q.call(T,0,S):T[0]
};
R.initial=function(T,S,p){return q.call(T,0,T.length-((S==null)||p?1:S))
};
R.last=function(T,S,p){if((S!=null)&&!p){return q.call(T,Math.max(T.length-S,0))
}else{return T[T.length-1]
}};
R.rest=R.tail=function(T,p,S){return q.call(T,(p==null)||S?1:p)
};
R.compact=function(p){return R.filter(p,function(S){return !!S
})
};
R.flatten=function(S,p){return R.reduce(S,function(T,U){if(R.isArray(U)){return T.concat(p?U:R.flatten(U))
}T[T.length]=U;
return T
},[])
};
R.without=function(p){return R.difference(p,q.call(arguments,1))
};
R.uniq=R.unique=function(V,U,T){var p=T?R.map(V,T):V;
var S=[];
if(V.length<3){U=true
}R.reduce(p,function(W,Y,X){if(U?R.last(W)!==Y||!W.length:!R.include(W,Y)){W.push(Y);
S.push(V[X])
}return W
},[]);
return S
};
R.union=function(){return R.uniq(R.flatten(arguments,true))
};
R.intersection=R.intersect=function(S){var p=q.call(arguments,1);
return R.filter(R.uniq(S),function(T){return R.every(p,function(U){return R.indexOf(U,T)>=0
})
})
};
R.difference=function(S){var p=R.flatten(q.call(arguments,1),true);
return R.filter(S,function(T){return !R.include(p,T)
})
};
R.zip=function(){var p=q.call(arguments);
var U=R.max(R.pluck(p,"length"));
var T=new Array(U);
for(var S=0;
S<U;
S++){T[S]=R.pluck(p,""+S)
}return T
};
R.indexOf=function(V,T,U){if(V==null){return -1
}var S,p;
if(U){S=R.sortedIndex(V,T);
return V[S]===T?S:-1
}if(o&&V.indexOf===o){return V.indexOf(T)
}for(S=0,p=V.length;
S<p;
S++){if(S in V&&V[S]===T){return S
}}return -1
};
R.lastIndexOf=function(T,S){if(T==null){return -1
}if(n&&T.lastIndexOf===n){return T.lastIndexOf(S)
}var p=T.length;
while(p--){if(p in T&&T[p]===S){return p
}}return -1
};
R.range=function(W,U,V){if(arguments.length<=1){U=W||0;
W=0
}V=arguments[2]||1;
var S=Math.max(Math.ceil((U-W)/V),0);
var p=0;
var T=new Array(S);
while(p<S){T[p++]=W;
W+=V
}return T
};
var L=function(){};
R.bind=function f(U,S){var T,p;
if(U.bind===K&&K){return K.apply(U,q.call(arguments,1))
}if(!R.isFunction(U)){throw new TypeError
}p=q.call(arguments,2);
return T=function(){if(!(this instanceof T)){return U.apply(S,p.concat(q.call(arguments)))
}L.prototype=U.prototype;
var W=new L;
var V=U.apply(W,p.concat(q.call(arguments)));
if(Object(V)===V){return V
}return W
}
};
R.bindAll=function(S){var p=q.call(arguments,1);
if(p.length==0){p=R.functions(S)
}N(p,function(T){S[T]=R.bind(S[T],S)
});
return S
};
R.memoize=function(T,S){var p={};
S||(S=R.identity);
return function(){var U=S.apply(this,arguments);
return R.has(p,U)?p[U]:(p[U]=T.apply(this,arguments))
}
};
R.delay=function(S,T){var p=q.call(arguments,2);
return setTimeout(function(){return S.apply(null,p)
},T)
};
R.defer=function(p){return R.delay.apply(R,[p,1].concat(q.call(arguments,1)))
};
R.throttle=function(T,U){var S,W,X,Y,V,Z;
var p=R.debounce(function(){V=Y=false
},U);
return function(){S=this;
W=arguments;
var aa=function(){X=null;
if(V){T.apply(S,W)
}p()
};
if(!X){X=setTimeout(aa,U)
}if(Y){V=true
}else{Z=T.apply(S,W)
}p();
Y=true;
return Z
}
};
R.debounce=function(S,U,p){var T;
return function(){var X=this,W=arguments;
var V=function(){T=null;
if(!p){S.apply(X,W)
}};
if(p&&!T){S.apply(X,W)
}clearTimeout(T);
T=setTimeout(V,U)
}
};
R.once=function(T){var p=false,S;
return function(){if(p){return S
}p=true;
return S=T.apply(this,arguments)
}
};
R.wrap=function(p,S){return function(){var T=[p].concat(q.call(arguments,0));
return S.apply(this,T)
}
};
R.compose=function(){var p=arguments;
return function(){var S=arguments;
for(var T=p.length-1;
T>=0;
T--){S=[p[T].apply(this,S)]
}return S[0]
}
};
R.after=function(S,p){if(S<=0){return p()
}return function(){if(--S<1){return p.apply(this,arguments)
}}
};
R.keys=g||function(T){if(T!==Object(T)){throw new TypeError("Invalid object")
}var S=[];
for(var p in T){if(R.has(T,p)){S[S.length]=p
}}return S
};
R.values=function(p){return R.map(p,R.identity)
};
R.functions=R.methods=function(T){var S=[];
for(var p in T){if(R.isFunction(T[p])){S.push(p)
}}return S.sort()
};
R.extend=function(p){N(q.call(arguments,1),function(S){for(var T in S){p[T]=S[T]
}});
return p
};
R.pick=function(S){var p={};
N(R.flatten(q.call(arguments,1)),function(T){if(T in S){p[T]=S[T]
}});
return p
};
R.defaults=function(p){N(q.call(arguments,1),function(S){for(var T in S){if(p[T]==null){p[T]=S[T]
}}});
return p
};
R.clone=function(p){if(!R.isObject(p)){return p
}return R.isArray(p)?p.slice():R.extend({},p)
};
R.tap=function(S,p){p(S);
return S
};
function O(U,T,S){if(U===T){return U!==0||1/U==1/T
}if(U==null||T==null){return U===T
}if(U._chain){U=U._wrapped
}if(T._chain){T=T._wrapped
}if(U.isEqual&&R.isFunction(U.isEqual)){return U.isEqual(T)
}if(T.isEqual&&R.isFunction(T.isEqual)){return T.isEqual(U)
}var X=d.call(U);
if(X!=d.call(T)){return false
}switch(X){case"[object String]":return U==String(T);
case"[object Number]":return U!=+U?T!=+T:(U==0?1/U==1/T:U==+T);
case"[object Date]":case"[object Boolean]":return +U==+T;
case"[object RegExp]":return U.source==T.source&&U.global==T.global&&U.multiline==T.multiline&&U.ignoreCase==T.ignoreCase
}if(typeof U!="object"||typeof T!="object"){return false
}var Y=S.length;
while(Y--){if(S[Y]==U){return true
}}S.push(U);
var W=0,p=true;
if(X=="[object Array]"){W=U.length;
p=W==T.length;
if(p){while(W--){if(!(p=W in U==W in T&&O(U[W],T[W],S))){break
}}}}else{if("constructor" in U!="constructor" in T||U.constructor!=T.constructor){return false
}for(var V in U){if(R.has(U,V)){W++;
if(!(p=R.has(T,V)&&O(U[V],T[V],S))){break
}}}if(p){for(V in T){if(R.has(T,V)&&!(W--)){break
}}p=!W
}}S.pop();
return p
}R.isEqual=function(S,p){return O(S,p,[])
};
R.isEmpty=function(S){if(S==null){return true
}if(R.isArray(S)||R.isString(S)){return S.length===0
}for(var p in S){if(R.has(S,p)){return false
}}return true
};
R.isElement=function(p){return !!(p&&p.nodeType==1)
};
R.isArray=v||function(p){return d.call(p)=="[object Array]"
};
R.isObject=function(p){return p===Object(p)
};
R.isArguments=function(p){return d.call(p)=="[object Arguments]"
};
if(!R.isArguments(arguments)){R.isArguments=function(p){return !!(p&&R.has(p,"callee"))
}
}R.isFunction=function(p){return d.call(p)=="[object Function]"
};
R.isString=function(p){return d.call(p)=="[object String]"
};
R.isNumber=function(p){return d.call(p)=="[object Number]"
};
R.isFinite=function(p){return R.isNumber(p)&&isFinite(p)
};
R.isNaN=function(p){return p!==p
};
R.isBoolean=function(p){return p===true||p===false||d.call(p)=="[object Boolean]"
};
R.isDate=function(p){return d.call(p)=="[object Date]"
};
R.isRegExp=function(p){return d.call(p)=="[object RegExp]"
};
R.isNull=function(p){return p===null
};
R.isUndefined=function(p){return p===void 0
};
R.has=function(S,p){return k.call(S,p)
};
R.noConflict=function(){A._=m;
return this
};
R.identity=function(p){return p
};
R.times=function(U,T,S){for(var p=0;
p<U;
p++){T.call(S,p)
}};
R.escape=function(p){return(""+p).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#x27;").replace(/\//g,"&#x2F;")
};
R.result=function(p,T){if(p==null){return null
}var S=p[T];
return R.isFunction(S)?S.call(p):S
};
R.mixin=function(p){N(R.functions(p),function(S){B(S,R[S]=p[S])
})
};
var C=0;
R.uniqueId=function(p){var S=C++;
return p?p+S:S
};
R.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};
var z=/.^/;
var j={"\\":"\\","'":"'",r:"\r",n:"\n",t:"\t",u2028:"\u2028",u2029:"\u2029"};
for(var M in j){j[j[M]]=M
}var l=/\\|'|\r|\n|\t|\u2028|\u2029/g;
var G=/\\(\\|'|r|n|t|u2028|u2029)/g;
var P=function(p){return p.replace(G,function(S,T){return j[T]
})
};
R.template=function(W,V,T){T=R.defaults(T||{},R.templateSettings);
var U="__p+='"+W.replace(l,function(X){return"\\"+j[X]
}).replace(T.escape||z,function(X,Y){return"'+\n_.escape("+P(Y)+")+\n'"
}).replace(T.interpolate||z,function(X,Y){return"'+\n("+P(Y)+")+\n'"
}).replace(T.evaluate||z,function(X,Y){return"';\n"+P(Y)+"\n;__p+='"
})+"';\n";
if(!T.variable){U="with(obj||{}){\n"+U+"}\n"
}U="var __p='';var print=function(){__p+=Array.prototype.join.call(arguments, '')};\n"+U+"return __p;\n";
var S=new Function(T.variable||"obj","_",U);
if(V){return S(V,R)
}var p=function(X){return S.call(this,X,R)
};
p.source="function("+(T.variable||"obj")+"){\n"+U+"}";
return p
};
R.chain=function(p){return R(p).chain()
};
var w=function(p){this._wrapped=p
};
R.prototype=w.prototype;
var u=function(S,p){return p?R(S).chain():S
};
var B=function(p,S){w.prototype[p]=function(){var T=q.call(arguments);
E.call(T,this._wrapped);
return u(S.apply(R,T),this._chain)
}
};
R.mixin(R);
N(["pop","push","reverse","shift","sort","splice","unshift"],function(p){var S=H[p];
w.prototype[p]=function(){var T=this._wrapped;
S.apply(T,arguments);
var U=T.length;
if((p=="shift"||p=="splice")&&U===0){delete T[0]
}return u(T,this._chain)
}
});
N(["concat","join","slice"],function(p){var S=H[p];
w.prototype[p]=function(){return u(S.apply(this._wrapped,arguments),this._chain)
}
});
w.prototype.chain=function(){this._chain=true;
return this
};
w.prototype.value=function(){return this._wrapped
}
}).call(this);
d3=function(){var hy={version:"3.3.13"};
if(!Date.now){Date.now=function(){return +new Date()
}
}var bS=[].slice,dY=function(ir){return bS.call(ir)
};
var bR=document,ej=bR.documentElement,fO=window;
try{dY(ej.childNodes)[0].nodeType
}catch(ho){dY=function(it){var ir=it.length,iu=new Array(ir);
while(ir--){iu[ir]=it[ir]
}return iu
}
}try{bR.createElement("div").style.setProperty("opacity",0,"")
}catch(fK){var dW=fO.Element.prototype,b5=dW.setAttribute,hg=dW.setAttributeNS,dI=fO.CSSStyleDeclaration.prototype,gZ=dI.setProperty;
dW.setAttribute=function(ir,it){b5.call(this,ir,it+"")
};
dW.setAttributeNS=function(iu,ir,it){hg.call(this,iu,ir,it+"")
};
dI.setProperty=function(ir,iu,it){gZ.call(this,ir,iu+"",it)
}
}hy.ascending=function(it,ir){return it<ir?-1:it>ir?1:it>=ir?0:NaN
};
hy.descending=function(it,ir){return ir<it?-1:ir>it?1:ir>=it?0:NaN
};
hy.min=function(ix,iv){var iu=-1,iw=ix.length,it,ir;
if(arguments.length===1){while(++iu<iw&&!((it=ix[iu])!=null&&it<=it)){it=undefined
}while(++iu<iw){if((ir=ix[iu])!=null&&it>ir){it=ir
}}}else{while(++iu<iw&&!((it=iv.call(ix,ix[iu],iu))!=null&&it<=it)){it=undefined
}while(++iu<iw){if((ir=iv.call(ix,ix[iu],iu))!=null&&it>ir){it=ir
}}}return it
};
hy.max=function(ix,iv){var iu=-1,iw=ix.length,it,ir;
if(arguments.length===1){while(++iu<iw&&!((it=ix[iu])!=null&&it<=it)){it=undefined
}while(++iu<iw){if((ir=ix[iu])!=null&&ir>it){it=ir
}}}else{while(++iu<iw&&!((it=iv.call(ix,ix[iu],iu))!=null&&it<=it)){it=undefined
}while(++iu<iw){if((ir=iv.call(ix,ix[iu],iu))!=null&&ir>it){it=ir
}}}return it
};
hy.extent=function(iy,iv){var iu=-1,ix=iy.length,it,ir,iw;
if(arguments.length===1){while(++iu<ix&&!((it=iw=iy[iu])!=null&&it<=it)){it=iw=undefined
}while(++iu<ix){if((ir=iy[iu])!=null){if(it>ir){it=ir
}if(iw<ir){iw=ir
}}}}else{while(++iu<ix&&!((it=iw=iv.call(iy,iy[iu],iu))!=null&&it<=it)){it=undefined
}while(++iu<ix){if((ir=iv.call(iy,iy[iu],iu))!=null){if(it>ir){it=ir
}if(iw<ir){iw=ir
}}}}return[it,iw]
};
hy.sum=function(ix,iv){var iu=0,iw=ix.length,ir,it=-1;
if(arguments.length===1){while(++it<iw){if(!isNaN(ir=+ix[it])){iu+=ir
}}}else{while(++it<iw){if(!isNaN(ir=+iv.call(ix,ix[it],it))){iu+=ir
}}}return iu
};
function hD(ir){return ir!=null&&!isNaN(ir)
}hy.mean=function(iy,iw){var ix=iy.length,it,ir=0,iv=-1,iu=0;
if(arguments.length===1){while(++iv<ix){if(hD(it=iy[iv])){ir+=(it-ir)/++iu
}}}else{while(++iv<ix){if(hD(it=iw.call(iy,iy[iv],iv))){ir+=(it-ir)/++iu
}}}return iu?ir:undefined
};
hy.quantile=function(it,ix){var iu=(it.length-1)*ix+1,iv=Math.floor(iu),ir=+it[iv-1],iw=iu-iv;
return iw?ir+iw*(it[iv]-ir):ir
};
hy.median=function(it,ir){if(arguments.length>1){it=it.map(ir)
}it=it.filter(hD);
return it.length?hy.quantile(it.sort(hy.ascending),0.5):undefined
};
hy.bisector=function(ir){return{left:function(iu,it,ix,iw){if(arguments.length<3){ix=0
}if(arguments.length<4){iw=iu.length
}while(ix<iw){var iv=ix+iw>>>1;
if(ir.call(iu,iu[iv],iv)<it){ix=iv+1
}else{iw=iv
}}return ix
},right:function(iu,it,ix,iw){if(arguments.length<3){ix=0
}if(arguments.length<4){iw=iu.length
}while(ix<iw){var iv=ix+iw>>>1;
if(it<ir.call(iu,iu[iv],iv)){iw=iv
}else{ix=iv+1
}}return ix
}}
};
var gC=hy.bisector(function(ir){return ir
});
hy.bisectLeft=gC.left;
hy.bisect=hy.bisectRight=gC.right;
hy.shuffle=function(iv){var ir=iv.length,iu,it;
while(ir){it=Math.random()*ir--|0;
iu=iv[ir],iv[ir]=iv[it],iv[it]=iu
}return iv
};
hy.permute=function(iv,it){var iu=it.length,ir=new Array(iu);
while(iu--){ir[iu]=iv[it[iu]]
}return ir
};
hy.pairs=function(ix){var ir=0,iw=ix.length-1,iv,iu=ix[0],it=new Array(iw<0?0:iw);
while(ir<iw){it[ir]=[iv=iu,iu=ix[++ir]]
}return it
};
hy.zip=function(){if(!(ix=arguments.length)){return[]
}for(var iv=-1,ir=hy.min(arguments,ft),iu=new Array(ir);
++iv<ir;
){for(var it=-1,ix,iw=iu[iv]=new Array(ix);
++it<ix;
){iw[it]=arguments[it][iv]
}}return iu
};
function ft(ir){return ir.length
}hy.transpose=function(ir){return hy.zip.apply(hy,ir)
};
hy.keys=function(iu){var it=[];
for(var ir in iu){it.push(ir)
}return it
};
hy.values=function(iu){var ir=[];
for(var it in iu){ir.push(iu[it])
}return ir
};
hy.entries=function(iu){var ir=[];
for(var it in iu){ir.push({key:it,value:iu[it]})
}return ir
};
hy.merge=function(iw){var iy=iw.length,it,iv=-1,iu=0,ir,ix;
while(++iv<iy){iu+=iw[iv].length
}ir=new Array(iu);
while(--iy>=0){ix=iw[iy];
it=ix.length;
while(--it>=0){ir[--iu]=ix[it]
}}return ir
};
var cN=Math.abs;
hy.range=function(iy,iw,ix){if(arguments.length<3){ix=1;
if(arguments.length<2){iw=iy;
iy=0
}}if((iw-iy)/ix===Infinity){throw new Error("infinite range")
}var it=[],ir=gx(cN(ix)),iv=-1,iu;
iy*=ir,iw*=ir,ix*=ir;
if(ix<0){while((iu=iy+ix*++iv)>iw){it.push(iu/ir)
}}else{while((iu=iy+ix*++iv)<iw){it.push(iu/ir)
}}return it
};
function gx(ir){var it=1;
while(ir*it%1){it*=10
}return it
}function ig(iu,it){try{for(var ir in it){Object.defineProperty(iu.prototype,ir,{value:it[ir],enumerable:false})
}}catch(iv){iu.prototype=it
}}hy.map=function(ir){var iu=new aN();
if(ir instanceof aN){ir.forEach(function(iv,iw){iu.set(iv,iw)
})
}else{for(var it in ir){iu.set(it,ir[it])
}}return iu
};
function aN(){}ig(aN,{has:function(ir){return ii+ir in this
},get:function(ir){return this[ii+ir]
},set:function(ir,it){return this[ii+ir]=it
},remove:function(ir){ir=ii+ir;
return ir in this&&delete this[ir]
},keys:function(){var ir=[];
this.forEach(function(it){ir.push(it)
});
return ir
},values:function(){var ir=[];
this.forEach(function(it,iu){ir.push(iu)
});
return ir
},entries:function(){var ir=[];
this.forEach(function(it,iu){ir.push({key:it,value:iu})
});
return ir
},forEach:function(it){for(var ir in this){if(ir.charCodeAt(0)===dM){it.call(this,ir.substring(1),this[ir])
}}}});
var ii="\x00",dM=ii.charCodeAt(0);
hy.nest=function(){var iv={},iu=[],iy=[],it,iw;
function ix(iA,iH,iF){if(iF>=iu.length){return iw?iw.call(iv,iH):it?iH.sort(it):iH
}var iG=-1,iz=iH.length,iJ=iu[iF++],iE,iD,iC,iB=new aN(),iI;
while(++iG<iz){if(iI=iB.get(iE=iJ(iD=iH[iG]))){iI.push(iD)
}else{iB.set(iE,[iD])
}}if(iA){iD=iA();
iC=function(iL,iK){iD.set(iL,ix(iA,iK,iF))
}
}else{iD={};
iC=function(iL,iK){iD[iL]=ix(iA,iK,iF)
}
}iB.forEach(iC);
return iD
}function ir(iA,iB){if(iB>=iu.length){return iA
}var iC=[],iz=iy[iB++];
iA.forEach(function(iD,iE){iC.push({key:iD,values:ir(iE,iB)})
});
return iz?iC.sort(function(iE,iD){return iz(iE.key,iD.key)
}):iC
}iv.map=function(iA,iz){return ix(iz,iA,0)
};
iv.entries=function(iz){return ir(ix(hy.map,iz,0),0)
};
iv.key=function(iz){iu.push(iz);
return iv
};
iv.sortKeys=function(iz){iy[iu.length-1]=iz;
return iv
};
iv.sortValues=function(iz){it=iz;
return iv
};
iv.rollup=function(iz){iw=iz;
return iv
};
return iv
};
hy.set=function(iv){var iu=new dA();
if(iv){for(var ir=0,it=iv.length;
ir<it;
++ir){iu.add(iv[ir])
}}return iu
};
function dA(){}ig(dA,{has:function(ir){return ii+ir in this
},add:function(ir){this[ii+ir]=true;
return ir
},remove:function(ir){ir=ii+ir;
return ir in this&&delete this[ir]
},values:function(){var ir=[];
this.forEach(function(it){ir.push(it)
});
return ir
},forEach:function(it){for(var ir in this){if(ir.charCodeAt(0)===dM){it.call(this,ir.substring(1))
}}}});
hy.behavior={};
hy.rebind=function(iu,it){var ir=1,iw=arguments.length,iv;
while(++ir<iw){iu[iv=arguments[ir]]=eJ(iu,it,it[iv])
}return iu
};
function eJ(it,ir,iu){return function(){var iv=iu.apply(ir,arguments);
return iv===ir?it:iv
}
}function dr(iu,it){if(it in iu){return it
}it=it.charAt(0).toUpperCase()+it.substring(1);
for(var iv=0,iw=Q.length;
iv<iw;
++iv){var ir=Q[iv]+it;
if(ir in iu){return ir
}}}var Q=["webkit","ms","moz","Moz","o","O"];
function aM(){}hy.dispatch=function(){var ir=new e5(),it=-1,iu=arguments.length;
while(++it<iu){ir[arguments[it]]=fw(ir)
}return ir
};
function e5(){}e5.prototype.on=function(iu,iv){var it=iu.indexOf("."),ir="";
if(it>=0){ir=iu.substring(it+1);
iu=iu.substring(0,it)
}if(iu){return arguments.length<2?this[iu].on(ir):this[iu].on(ir,iv)
}if(arguments.length===2){if(iv==null){for(iu in this){if(this.hasOwnProperty(iu)){this[iu].on(ir,null)
}}}return this
}};
function fw(ir){var iu=[],it=new aN();
function iv(){var iy=iu,ix=-1,iz=iy.length,iw;
while(++ix<iz){if(iw=iy[ix].on){iw.apply(this,arguments)
}}return ir
}iv.on=function(ix,iz){var iw=it.get(ix),iy;
if(arguments.length<2){return iw&&iw.on
}if(iw){iw.on=null;
iu=iu.slice(0,iy=iu.indexOf(iw)).concat(iu.slice(iy+1));
it.remove(ix)
}if(iz){iu.push(it.set(ix,{on:iz}))
}return ir
};
return iv
}hy.event=null;
function A(){hy.event.preventDefault()
}function al(){var it=hy.event,ir;
while(ir=it.sourceEvent){it=ir
}return it
}function ht(iu){var ir=new e5(),it=0,iv=arguments.length;
while(++it<iv){ir[arguments[it]]=fw(ir)
}ir.of=function(ix,iw){return function(iy){try{var iz=iy.sourceEvent=hy.event;
iy.target=iu;
hy.event=iy;
ir[iy.type].apply(ix,iw)
}finally{hy.event=iz
}}
};
return ir
}hy.requote=function(ir){return ir.replace(dh,"\\$&")
};
var dh=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g;
var ij={}.__proto__?function(it,ir){it.__proto__=ir
}:function(it,ir){for(var iu in ir){it[iu]=ir[iu]
}};
function ea(ir){ij(ir,d9);
return ir
}var dz=function(ir,it){return it.querySelector(ir)
},gl=function(ir,it){return it.querySelectorAll(ir)
},d=ej[dr(ej,"matchesSelector")],a=function(it,ir){return d.call(it,ir)
};
if(typeof Sizzle==="function"){dz=function(ir,it){return Sizzle(ir,it)[0]||null
};
gl=function(ir,it){return Sizzle.uniqueSort(Sizzle(ir,it))
};
a=Sizzle.matchesSelector
}hy.selection=function(){return g4
};
var d9=hy.selection.prototype=[];
d9.select=function(ix){var iu=[],iB,ir,iA,iv;
ix=D(ix);
for(var iy=-1,iw=this.length;
++iy<iw;
){iu.push(iB=[]);
iB.parentNode=(iA=this[iy]).parentNode;
for(var iz=-1,it=iA.length;
++iz<it;
){if(iv=iA[iz]){iB.push(ir=ix.call(iv,iv.__data__,iz,iy));
if(ir&&"__data__" in iv){ir.__data__=iv.__data__
}}else{iB.push(null)
}}}return ea(iu)
};
function D(ir){return typeof ir==="function"?ir:function(){return dz(ir,this)
}
}d9.selectAll=function(iw){var it=[],iA,iu;
iw=c9(iw);
for(var ix=-1,iv=this.length;
++ix<iv;
){for(var iz=this[ix],iy=-1,ir=iz.length;
++iy<ir;
){if(iu=iz[iy]){it.push(iA=dY(iw.call(iu,iu.__data__,iy,ix)));
iA.parentNode=iu
}}}return ea(it)
};
function c9(ir){return typeof ir==="function"?ir:function(){return gl(ir,this)
}
}var eq={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};
hy.ns={prefix:eq,qualify:function(ir){var it=ir.indexOf(":"),iu=ir;
if(it>=0){iu=ir.substring(0,it);
ir=ir.substring(it+1)
}return eq.hasOwnProperty(iu)?{space:eq[iu],local:ir}:ir
}};
d9.attr=function(ir,iu){if(arguments.length<2){if(typeof ir==="string"){var it=this.node();
ir=hy.ns.qualify(ir);
return ir.local?it.getAttributeNS(ir.space,ir.local):it.getAttribute(ir)
}for(iu in ir){this.each(bx(iu,ir[iu]))
}return this
}return this.each(bx(ir,iu))
};
function bx(iu,iy){iu=hy.ns.qualify(iu);
function it(){this.removeAttribute(iu)
}function iz(){this.removeAttributeNS(iu.space,iu.local)
}function ix(){this.setAttribute(iu,iy)
}function iw(){this.setAttributeNS(iu.space,iu.local,iy)
}function ir(){var iA=iy.apply(this,arguments);
if(iA==null){this.removeAttribute(iu)
}else{this.setAttribute(iu,iA)
}}function iv(){var iA=iy.apply(this,arguments);
if(iA==null){this.removeAttributeNS(iu.space,iu.local)
}else{this.setAttributeNS(iu.space,iu.local,iA)
}}return iy==null?iu.local?iz:it:typeof iy==="function"?iu.local?iv:ir:iu.local?iw:ix
}function cO(ir){return ir.trim().replace(/\s+/g," ")
}d9.classed=function(ir,iv){if(arguments.length<2){if(typeof ir==="string"){var iu=this.node(),iw=(ir=gI(ir)).length,it=-1;
if(iv=iu.classList){while(++it<iw){if(!iv.contains(ir[it])){return false
}}}else{iv=iu.getAttribute("class");
while(++it<iw){if(!g0(ir[it]).test(iv)){return false
}}}return true
}for(iv in ir){this.each(gR(iv,ir[iv]))
}return this
}return this.each(gR(ir,iv))
};
function g0(ir){return new RegExp("(?:^|\\s+)"+hy.requote(ir)+"(?:\\s+|$)","g")
}function gI(ir){return ir.trim().split(/^|\s+/)
}function gR(it,iv){it=gI(it).map(ie);
var iw=it.length;
function ir(){var ix=-1;
while(++ix<iw){it[ix](this,iv)
}}function iu(){var iy=-1,ix=iv.apply(this,arguments);
while(++iy<iw){it[iy](this,ix)
}}return typeof iv==="function"?iu:ir
}function ie(ir){var it=g0(ir);
return function(iu,iv){if(iw=iu.classList){return iv?iw.add(ir):iw.remove(ir)
}var iw=iu.getAttribute("class")||"";
if(iv){it.lastIndex=0;
if(!it.test(iw)){iu.setAttribute("class",cO(iw+" "+ir))
}}else{iu.setAttribute("class",cO(iw.replace(it," ")))
}}
}d9.style=function(ir,iu,it){var iv=arguments.length;
if(iv<3){if(typeof ir!=="string"){if(iv<2){iu=""
}for(it in ir){this.each(f1(it,ir[it],iu))
}return this
}if(iv<2){return fO.getComputedStyle(this.node(),null).getPropertyValue(ir)
}it=""
}return this.each(f1(ir,iu,it))
};
function f1(iu,ix,iv){function it(){this.style.removeProperty(iu)
}function iw(){this.style.setProperty(iu,ix,iv)
}function ir(){var iy=ix.apply(this,arguments);
if(iy==null){this.style.removeProperty(iu)
}else{this.style.setProperty(iu,iy,iv)
}}return ix==null?it:typeof ix==="function"?ir:iw
}d9.property=function(ir,it){if(arguments.length<2){if(typeof ir==="string"){return this.node()[ir]
}for(it in ir){this.each(hR(it,ir[it]))
}return this
}return this.each(hR(ir,it))
};
function hR(it,iv){function ir(){delete this[it]
}function iu(){this[it]=iv
}function iw(){var ix=iv.apply(this,arguments);
if(ix==null){delete this[it]
}else{this[it]=ix
}}return iv==null?ir:typeof iv==="function"?iw:iu
}d9.text=function(ir){return arguments.length?this.each(typeof ir==="function"?function(){var it=ir.apply(this,arguments);
this.textContent=it==null?"":it
}:ir==null?function(){this.textContent=""
}:function(){this.textContent=ir
}):this.node().textContent
};
d9.html=function(ir){return arguments.length?this.each(typeof ir==="function"?function(){var it=ir.apply(this,arguments);
this.innerHTML=it==null?"":it
}:ir==null?function(){this.innerHTML=""
}:function(){this.innerHTML=ir
}):this.node().innerHTML
};
d9.append=function(ir){ir=aI(ir);
return this.select(function(){return this.appendChild(ir.apply(this,arguments))
})
};
function aI(ir){return typeof ir==="function"?ir:(ir=hy.ns.qualify(ir)).local?function(){return this.ownerDocument.createElementNS(ir.space,ir.local)
}:function(){return this.ownerDocument.createElementNS(this.namespaceURI,ir)
}
}d9.insert=function(ir,it){ir=aI(ir);
it=D(it);
return this.select(function(){return this.insertBefore(ir.apply(this,arguments),it.apply(this,arguments)||null)
})
};
d9.remove=function(){return this.each(function(){var ir=this.parentNode;
if(ir){ir.removeChild(this)
}})
};
d9.data=function(iz,iB){var iw=-1,it=this.length,iA,iu;
if(!arguments.length){iz=new Array(it=(iA=this[0]).length);
while(++iw<it){if(iu=iA[iw]){iz[iw]=iu.__data__
}}return iz
}function ix(iL,iG){var iI,iD=iL.length,iF=iG.length,iK=Math.min(iD,iF),iP=new Array(iF),iM=new Array(iF),iJ=new Array(iD),iE,iC;
if(iB){var iQ=new aN(),iN=new aN(),iO=[],iH;
for(iI=-1;
++iI<iD;
){iH=iB.call(iE=iL[iI],iE.__data__,iI);
if(iQ.has(iH)){iJ[iI]=iE
}else{iQ.set(iH,iE)
}iO.push(iH)
}for(iI=-1;
++iI<iF;
){iH=iB.call(iG,iC=iG[iI],iI);
if(iE=iQ.get(iH)){iP[iI]=iE;
iE.__data__=iC
}else{if(!iN.has(iH)){iM[iI]=R(iC)
}}iN.set(iH,iC);
iQ.remove(iH)
}for(iI=-1;
++iI<iD;
){if(iQ.has(iO[iI])){iJ[iI]=iL[iI]
}}}else{for(iI=-1;
++iI<iK;
){iE=iL[iI];
iC=iG[iI];
if(iE){iE.__data__=iC;
iP[iI]=iE
}else{iM[iI]=R(iC)
}}for(;
iI<iF;
++iI){iM[iI]=R(iG[iI])
}for(;
iI<iD;
++iI){iJ[iI]=iL[iI]
}}iM.update=iP;
iM.parentNode=iP.parentNode=iJ.parentNode=iL.parentNode;
iy.push(iM);
iv.push(iP);
ir.push(iJ)
}var iy=bY([]),iv=ea([]),ir=ea([]);
if(typeof iz==="function"){while(++iw<it){ix(iA=this[iw],iz.call(iA,iA.parentNode.__data__,iw))
}}else{while(++iw<it){ix(iA=this[iw],iz)
}}iv.enter=function(){return iy
};
iv.exit=function(){return ir
};
return iv
};
function R(ir){return{__data__:ir}
}d9.datum=function(ir){return arguments.length?this.property("__data__",ir):this.property("__data__")
};
d9.filter=function(ir){var iu=[],iA,iz,iv;
if(typeof ir!=="function"){ir=bd(ir)
}for(var ix=0,iw=this.length;
ix<iw;
ix++){iu.push(iA=[]);
iA.parentNode=(iz=this[ix]).parentNode;
for(var iy=0,it=iz.length;
iy<it;
iy++){if((iv=iz[iy])&&ir.call(iv,iv.__data__,iy,ix)){iA.push(iv)
}}}return ea(iu)
};
function bd(ir){return function(){return a(this,ir)
}
}d9.order=function(){for(var it=-1,ir=this.length;
++it<ir;
){for(var ix=this[it],iu=ix.length-1,iv=ix[iu],iw;
--iu>=0;
){if(iw=ix[iu]){if(iv&&iv!==iw.nextSibling){iv.parentNode.insertBefore(iw,iv)
}iv=iw
}}}return this
};
d9.sort=function(it){it=gY.apply(this,arguments);
for(var iu=-1,ir=this.length;
++iu<ir;
){this[iu].sort(it)
}return this.order()
};
function gY(ir){if(!arguments.length){ir=hy.ascending
}return function(iu,it){return iu&&it?ir(iu.__data__,it.__data__):!iu-!it
}
}d9.each=function(ir){return cP(this,function(iv,iu,it){ir.call(iv,iv.__data__,iu,it)
})
};
function cP(it,iz){for(var iu=0,ir=it.length;
iu<ir;
iu++){for(var ix=it[iu],iv=0,iy=ix.length,iw;
iv<iy;
iv++){if(iw=ix[iv]){iz(iw,iv,iu)
}}}return it
}d9.call=function(it){var ir=dY(arguments);
it.apply(ir[0]=this,ir);
return this
};
d9.empty=function(){return !this.node()
};
d9.node=function(){for(var it=0,ir=this.length;
it<ir;
it++){for(var iw=this[it],iu=0,ix=iw.length;
iu<ix;
iu++){var iv=iw[iu];
if(iv){return iv
}}}return null
};
d9.size=function(){var ir=0;
this.each(function(){++ir
});
return ir
};
function bY(ir){ij(ir,fj);
return ir
}var fj=[];
hy.selection.enter=bY;
hy.selection.enter.prototype=fj;
fj.append=d9.append;
fj.empty=d9.empty;
fj.node=d9.node;
fj.call=d9.call;
fj.size=d9.size;
fj.select=function(ix){var iu=[],iC,ir,iA,iB,iw;
for(var iy=-1,iv=this.length;
++iy<iv;
){iA=(iB=this[iy]).update;
iu.push(iC=[]);
iC.parentNode=iB.parentNode;
for(var iz=-1,it=iB.length;
++iz<it;
){if(iw=iB[iz]){iC.push(iA[iz]=ir=ix.call(iB.parentNode,iw.__data__,iz,iy));
ir.__data__=iw.__data__
}else{iC.push(null)
}}}return ea(iu)
};
fj.insert=function(ir,it){if(arguments.length<2){it=gH(this)
}return d9.insert.call(this,ir,it)
};
function gH(iu){var ir,it;
return function(iz,iw,iv){var iy=iu[iv].update,iA=iy.length,ix;
if(iv!=it){it=iv,ir=0
}if(iw>=ir){ir=iw+1
}while(!(ix=iy[ir])&&++ir<iA){}return ix
}
}d9.transition=function(){var ir=ay||++hm,iu=[],iB,iv,iz=eg||{time:Date.now(),ease:aC,delay:0,duration:250};
for(var ix=-1,iw=this.length;
++ix<iw;
){iu.push(iB=[]);
for(var iA=this[ix],iy=-1,it=iA.length;
++iy<it;
){if(iv=iA[iy]){fR(iv,iy,ir,iz)
}iB.push(iv)
}}return g2(iu,ir)
};
d9.interrupt=function(){return this.each(c2)
};
function c2(){var ir=this.__transition__;
if(ir){++ir.active
}}hy.select=function(ir){var it=[typeof ir==="string"?dz(ir,bR):ir];
it.parentNode=ej;
return ea([it])
};
hy.selectAll=function(ir){var it=dY(typeof ir==="string"?gl(ir,bR):ir);
it.parentNode=ej;
return ea([it])
};
var g4=hy.select(ej);
d9.on=function(it,iu,ir){var iv=arguments.length;
if(iv<3){if(typeof it!=="string"){if(iv<2){iu=false
}for(ir in it){this.each(n(ir,it[ir],iu))
}return this
}if(iv<2){return(iv=this.node()["__on"+it])&&iv._
}ir=false
}return this.each(n(it,iu,ir))
};
function n(iA,iv,iB){var ir="__on"+iA,ix=iA.indexOf("."),it=fF;
if(ix>0){iA=iA.substring(0,ix)
}var iu=bO.get(iA);
if(iu){iA=iu,it=ax
}function iw(){var iC=this[ir];
if(iC){this.removeEventListener(iA,iC,iC.$);
delete this[ir]
}}function iz(){var iC=it(iv,dY(arguments));
iw.call(this);
this.addEventListener(iA,this[ir]=iC,iC.$=iB);
iC._=iv
}function iy(){var iF=new RegExp("^__on([^.]+)"+hy.requote(iA)+"$"),iE;
for(var iD in this){if(iE=iD.match(iF)){var iC=this[iD];
this.removeEventListener(iE[1],iC,iC.$);
delete this[iD]
}}}return ix?iv?iz:iw:iv?aM:iy
}var bO=hy.map({mouseenter:"mouseover",mouseleave:"mouseout"});
bO.forEach(function(ir){if("on"+ir in bR){bO.remove(ir)
}});
function fF(it,ir){return function(iu){var iv=hy.event;
hy.event=iu;
ir[0]=this.__data__;
try{it.apply(this,ir)
}finally{hy.event=iv
}}
}function ax(iu,ir){var it=fF(iu,ir);
return function(ix){var iw=this,iv=ix.relatedTarget;
if(!iv||iv!==iw&&!(iv.compareDocumentPosition(iw)&8)){it.call(iw,ix)
}}
}var cf="onselectstart" in bR?null:dr(ej.style,"userSelect"),gW=0;
function bP(){var iu=".dragsuppress-"+ ++gW,iw="click"+iu,it=hy.select(fO).on("touchmove"+iu,A).on("dragstart"+iu,A).on("selectstart"+iu,A);
if(cf){var iv=ej.style,ir=iv[cf];
iv[cf]="none"
}return function(ix){it.on(iu,null);
if(cf){iv[cf]=ir
}if(ix){function iy(){it.on(iw,null)
}it.on(iw,function(){A();
iy()
},true);
setTimeout(iy,0)
}}
}hy.mouse=function(ir){return a3(ir,al())
};
var cL=/WebKit/.test(fO.navigator.userAgent)?-1:0;
function a3(iu,ix){if(ix.changedTouches){ix=ix.changedTouches[0]
}var iv=iu.ownerSVGElement||iu;
if(iv.createSVGPoint){var ir=iv.createSVGPoint();
if(cL<0&&(fO.scrollX||fO.scrollY)){iv=hy.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");
var it=iv[0][0].getScreenCTM();
cL=!(it.f||it.e);
iv.remove()
}if(cL){ir.x=ix.pageX,ir.y=ix.pageY
}else{ir.x=ix.clientX,ir.y=ix.clientY
}ir=ir.matrixTransform(iu.getScreenCTM().inverse());
return[ir.x,ir.y]
}var iw=iu.getBoundingClientRect();
return[ix.clientX-iw.left-iu.clientLeft,ix.clientY-iw.top-iu.clientTop]
}hy.touches=function(ir,it){if(arguments.length<2){it=al().touches
}return it?dY(it).map(function(iv){var iu=a3(ir,iv);
iu.identifier=iv.identifier;
return iu
}):[]
};
hy.behavior.drag=function(){var iw=ht(iv,"drag","dragstart","dragend"),ir=null,it=iu(aM,hy.mouse,"mousemove","mouseup"),iz=iu(iy,ix,"touchmove","touchend");
function iv(){this.on("mousedown.drag",it).on("touchstart.drag",iz)
}function iy(){return hy.event.changedTouches[0].identifier
}function ix(iA,iB){return hy.touches(iA).filter(function(iC){return iC.identifier===iB
})[0]
}function iu(iD,iA,iC,iB){return function(){var iI=this,iP=iI.parentNode,iQ=iw.of(iI,arguments),iO=hy.event.target,iE=iD(),iG=iE==null?"drag":"drag-"+iE,iJ=iA(iP,iE),iL=0,iF,iN=hy.select(fO).on(iC+"."+iG,iK).on(iB+"."+iG,iM),iH=bP();
if(ir){iF=ir.apply(iI,arguments);
iF=[iF.x-iJ[0],iF.y-iJ[1]]
}else{iF=[0,0]
}iQ({type:"dragstart"});
function iK(){var iT=iA(iP,iE),iS=iT[0]-iJ[0],iR=iT[1]-iJ[1];
iL|=iS|iR;
iJ=iT;
iQ({type:"drag",x:iT[0]+iF[0],y:iT[1]+iF[1],dx:iS,dy:iR})
}function iM(){iN.on(iC+"."+iG,null).on(iB+"."+iG,null);
iH(iL&&hy.event.target===iO);
iQ({type:"dragend"})
}}
}iv.origin=function(iA){if(!arguments.length){return ir
}ir=iA;
return iv
};
return hy.rebind(iv,iw,"on")
};
var gr=Math.PI,gm=2*gr,eA=gr/2,gB=0.000001,eO=gB*gB,P=gr/180,hO=180/gr;
function cd(ir){return ir>0?1:ir<0?-1:0
}function ak(ir){return ir>1?0:ir<-1?gr:Math.acos(ir)
}function ci(ir){return ir>1?eA:ir<-1?-eA:Math.asin(ir)
}function d7(ir){return((ir=Math.exp(ir))-1/ir)/2
}function bH(ir){return((ir=Math.exp(ir))+1/ir)/2
}function fI(ir){return((ir=Math.exp(2*ir))-1)/(ir+1)
}function aJ(ir){return(ir=Math.sin(ir/2))*ir
}var gp=Math.SQRT2,ah=2,af=4;
hy.interpolateZoom=function(it,ir){var iD=it[0],iI=it[1],iB=it[2],iC=ir[0],iH=ir[1],iz=ir[2];
var iA=iC-iD,iy=iH-iI,iJ=iA*iA+iy*iy,iK=Math.sqrt(iJ),iw=(iz*iz-iB*iB+af*iJ)/(2*iB*ah*iK),iv=(iz*iz-iB*iB-af*iJ)/(2*iz*ah*iK),iG=Math.log(Math.sqrt(iw*iw+1)-iw),iF=Math.log(Math.sqrt(iv*iv+1)-iv),iE=iF-iG,iu=(iE||Math.log(iz/iB))/gp;
function ix(iM){var iN=iM*iu;
if(iE){var iO=bH(iG),iL=iB/(ah*iK)*(iO*fI(gp*iN+iG)-d7(iG));
return[iD+iL*iA,iI+iL*iy,iB*iO/bH(gp*iN+iG)]
}return[iD+iM*iA,iI+iM*iy,iB*Math.exp(gp*iN)]
}ix.duration=iu*1000;
return ix
};
hy.behavior.zoom=function(){var iD={x:0,y:0,k:1},iS,iU,iH=[960,500],iu=ga,iL="mousedown.zoom",iT="mousemove.zoom",iM="mouseup.zoom",iI,iQ="touchstart.zoom",iA,iN=ht(it,"zoomstart","zoom","zoomend"),iR,iP,iy,iw;
function it(iW){iW.on(iL,iv).on(hf+".zoom",iE).on(iT,iO).on("dblclick.zoom",iB).on(iQ,ix)
}it.event=function(iW){iW.each(function(){var iY=iN.of(this,arguments),iX=iD;
if(ay){hy.select(this).transition().each("start.zoom",function(){iD=this.__chart__||{x:0,y:0,k:1};
iJ(iY)
}).tween("zoom:zoom",function(){var i1=iH[0],i0=iH[1],iZ=i1/2,i3=i0/2,i2=hy.interpolateZoom([(iZ-iD.x)/iD.k,(i3-iD.y)/iD.k,i1/iD.k],[(iZ-iX.x)/iX.k,(i3-iX.y)/iX.k,i1/iX.k]);
return function(i6){var i4=i2(i6),i5=i1/i4[2];
this.__chart__=iD={x:iZ-i4[0]*i5,y:i3-i4[1]*i5,k:i5};
iG(iY)
}
}).each("end.zoom",function(){iF(iY)
})
}else{this.__chart__=iD;
iJ(iY);
iG(iY);
iF(iY)
}})
};
it.translate=function(iW){if(!arguments.length){return[iD.x,iD.y]
}iD={x:+iW[0],y:+iW[1],k:iD.k};
iC();
return it
};
it.scale=function(iW){if(!arguments.length){return iD.k
}iD={x:iD.x,y:iD.y,k:+iW};
iC();
return it
};
it.scaleExtent=function(iW){if(!arguments.length){return iu
}iu=iW==null?ga:[+iW[0],+iW[1]];
return it
};
it.center=function(iW){if(!arguments.length){return iU
}iU=iW&&[+iW[0],+iW[1]];
return it
};
it.size=function(iW){if(!arguments.length){return iH
}iH=iW&&[+iW[0],+iW[1]];
return it
};
it.x=function(iW){if(!arguments.length){return iP
}iP=iW;
iR=iW.copy();
iD={x:0,y:0,k:1};
return it
};
it.y=function(iW){if(!arguments.length){return iw
}iw=iW;
iy=iW.copy();
iD={x:0,y:0,k:1};
return it
};
function ir(iW){return[(iW[0]-iD.x)/iD.k,(iW[1]-iD.y)/iD.k]
}function iK(iW){return[iW[0]*iD.k+iD.x,iW[1]*iD.k+iD.y]
}function iz(iW){iD.k=Math.max(iu[0],Math.min(iu[1],iW))
}function iV(iX,iW){iW=iK(iW);
iD.x+=iX[0]-iW[0];
iD.y+=iX[1]-iW[1]
}function iC(){if(iP){iP.domain(iR.range().map(function(iW){return(iW-iD.x)/iD.k
}).map(iR.invert))
}if(iw){iw.domain(iy.range().map(function(iW){return(iW-iD.y)/iD.k
}).map(iy.invert))
}}function iJ(iW){iW({type:"zoomstart"})
}function iG(iW){iC();
iW({type:"zoom",scale:iD.k,translate:[iD.x,iD.y]})
}function iF(iW){iW({type:"zoomend"})
}function iv(){var iY=this,i3=iN.of(iY,arguments),i2=hy.event.target,i0=0,i4=hy.select(fO).on(iT,iZ).on(iM,i1),iW=ir(hy.mouse(iY)),iX=bP();
c2.call(iY);
iJ(i3);
function iZ(){i0=1;
iV(hy.mouse(iY),iW);
iG(i3)
}function i1(){i4.on(iT,fO===iY?iO:null).on(iM,null);
iX(i0&&hy.event.target===i2);
iF(i3)
}}function ix(){var i2=this,i8=iN.of(i2,arguments),i0={},i4=0,i1,iW=hy.event.changedTouches[0].identifier,iY="touchmove.zoom-"+iW,i9="touchend.zoom-"+iW,i7=hy.select(fO).on(iY,i5).on(i9,i6),ja=hy.select(i2).on(iL,null).on(iQ,i3),iZ=bP();
c2.call(i2);
i3();
iJ(i8);
function iX(){var jb=hy.touches(i2);
i1=iD.k;
jb.forEach(function(jc){if(jc.identifier in i0){i0[jc.identifier]=ir(jc)
}});
return jb
}function i3(){var jg=hy.event.changedTouches;
for(var jh=0,je=jg.length;
jh<je;
++jh){i0[jg[jh].identifier]=null
}var ji=iX(),jd=Date.now();
if(ji.length===1){if(jd-iA<500){var jc=ji[0],jf=i0[jc.identifier];
iz(iD.k*2);
iV(jc,jf);
A();
iG(i8)
}iA=jd
}else{if(ji.length>1){var jc=ji[0],jb=ji[1],jk=jc[0]-jb[0],jj=jc[1]-jb[1];
i4=jk*jk+jj*jj
}}}function i5(){var jf=hy.touches(i2),jj,jd,ji,jc;
for(var je=0,jb=jf.length;
je<jb;
++je,jc=null){ji=jf[je];
if(jc=i0[ji.identifier]){if(jd){break
}jj=ji,jd=jc
}}if(jc){var jh=(jh=ji[0]-jj[0])*jh+(jh=ji[1]-jj[1])*jh,jg=i4&&Math.sqrt(jh/i4);
jj=[(jj[0]+ji[0])/2,(jj[1]+ji[1])/2];
jd=[(jd[0]+jc[0])/2,(jd[1]+jc[1])/2];
iz(jg*i1)
}iA=null;
iV(jj,jd);
iG(i8)
}function i6(){if(hy.event.touches.length){var jd=hy.event.changedTouches;
for(var jc=0,je=jd.length;
jc<je;
++jc){delete i0[jd[jc].identifier]
}for(var jb in i0){return void iX()
}}i7.on(iY,null).on(i9,null);
ja.on(iL,iv).on(iQ,ix);
iZ();
iF(i8)
}}function iE(){var iX=iN.of(this,arguments);
if(iI){clearTimeout(iI)
}else{c2.call(this),iJ(iX)
}iI=setTimeout(function(){iI=null;
iF(iX)
},50);
A();
var iW=iU||hy.mouse(this);
if(!iS){iS=ir(iW)
}iz(Math.pow(2,cE()*0.002)*iD.k);
iV(iW,iS);
iG(iX)
}function iO(){iS=null
}function iB(){var iY=iN.of(this,arguments),iZ=hy.mouse(this),iW=ir(iZ),iX=Math.log(iD.k)/Math.LN2;
iJ(iY);
iz(Math.pow(2,hy.event.shiftKey?Math.ceil(iX)-1:Math.floor(iX)+1));
iV(iZ,iW);
iG(iY);
iF(iY)
}return hy.rebind(it,iN,"on")
};
var ga=[0,Infinity];
var cE,hf="onwheel" in bR?(cE=function(){return -hy.event.deltaY*(hy.event.deltaMode?120:1)
},"wheel"):"onmousewheel" in bR?(cE=function(){return hy.event.wheelDelta
},"mousewheel"):(cE=function(){return -hy.event.detail
},"MozMousePixelScroll");
function M(){}M.prototype.toString=function(){return this.rgb()+""
};
hy.hsl=function(iu,it,ir){return arguments.length===1?iu instanceof fG?eS(iu.h,iu.s,iu.l):a2(""+iu,gK,eS):eS(+iu,+it,+ir)
};
function eS(iu,it,ir){return new fG(iu,it,ir)
}function fG(iu,it,ir){this.h=iu;
this.s=it;
this.l=ir
}var eH=fG.prototype=new M();
eH.brighter=function(ir){ir=Math.pow(0.7,arguments.length?ir:1);
return eS(this.h,this.s,this.l/ir)
};
eH.darker=function(ir){ir=Math.pow(0.7,arguments.length?ir:1);
return eS(this.h,this.s,ir*this.l)
};
eH.rgb=function(){return bl(this.h,this.s,this.l)
};
function bl(ix,iw,ir){var iv,iu;
ix=isNaN(ix)?0:(ix%=360)<0?ix+360:ix;
iw=isNaN(iw)?0:iw<0?0:iw>1?1:iw;
ir=ir<0?0:ir>1?1:ir;
iu=ir<=0.5?ir*(1+iw):ir+iw-ir*iw;
iv=2*ir-iu;
function it(iz){if(iz>360){iz-=360
}else{if(iz<0){iz+=360
}}if(iz<60){return iv+(iu-iv)*iz/60
}if(iz<180){return iu
}if(iz<240){return iv+(iu-iv)*(240-iz)/60
}return iv
}function iy(iz){return Math.round(it(iz)*255)
}return eB(iy(ix+120),iy(ix),iy(ix-120))
}hy.hcl=function(it,iu,ir){return arguments.length===1?it instanceof cA?bF(it.h,it.c,it.l):it instanceof df?gU(it.l,it.a,it.b):gU((it=eb((it=hy.rgb(it)).r,it.g,it.b)).l,it.a,it.b):bF(+it,+iu,+ir)
};
function bF(it,iu,ir){return new cA(it,iu,ir)
}function cA(it,iu,ir){this.h=it;
this.c=iu;
this.l=ir
}var hr=cA.prototype=new M();
hr.brighter=function(ir){return bF(this.h,this.c,Math.min(100,this.l+bv*(arguments.length?ir:1)))
};
hr.darker=function(ir){return bF(this.h,this.c,Math.max(0,this.l-bv*(arguments.length?ir:1)))
};
hr.rgb=function(){return bG(this.h,this.c,this.l).rgb()
};
function bG(it,iu,ir){if(isNaN(it)){it=0
}if(isNaN(iu)){iu=0
}return cs(ir,Math.cos(it*=P)*iu,Math.sin(it)*iu)
}hy.lab=function(iu,it,ir){return arguments.length===1?iu instanceof df?cs(iu.l,iu.a,iu.b):iu instanceof cA?bG(iu.l,iu.c,iu.h):eb((iu=hy.rgb(iu)).r,iu.g,iu.b):cs(+iu,+it,+ir)
};
function cs(iu,it,ir){return new df(iu,it,ir)
}function df(iu,it,ir){this.l=iu;
this.a=it;
this.b=ir
}var bv=18;
var bm=0.95047,bk=1,bh=1.08883;
var gM=df.prototype=new M();
gM.brighter=function(ir){return cs(Math.min(100,this.l+bv*(arguments.length?ir:1)),this.a,this.b)
};
gM.darker=function(ir){return cs(Math.max(0,this.l-bv*(arguments.length?ir:1)),this.a,this.b)
};
gM.rgb=function(){return aH(this.l,this.a,this.b)
};
function aH(iv,iu,it){var ix=(iv+16)/116,ir=ix+iu/500,iw=ix-it/200;
ir=hc(ir)*bm;
ix=hc(ix)*bk;
iw=hc(iw)*bh;
return eB(f(3.2404542*ir-1.5371385*ix-0.4985314*iw),f(-0.969266*ir+1.8760108*ix+0.041556*iw),f(0.0556434*ir-0.2040259*ix+1.0572252*iw))
}function gU(iu,it,ir){return iu>0?bF(Math.atan2(ir,it)*hO,Math.sqrt(it*it+ir*ir),iu):bF(NaN,NaN,iu)
}function hc(ir){return ir>0.206893034?ir*ir*ir:(ir-4/29)/7.787037
}function gD(ir){return ir>0.008856?Math.pow(ir,1/3):7.787037*ir+4/29
}function f(ir){return Math.round(255*(ir<=0.00304?12.92*ir:1.055*Math.pow(ir,1/2.4)-0.055))
}hy.rgb=function(iu,it,ir){return arguments.length===1?iu instanceof fm?eB(iu.r,iu.g,iu.b):a2(""+iu,eB,bl):eB(~~iu,~~it,~~ir)
};
function dn(ir){return eB(ir>>16,ir>>8&255,ir&255)
}function dE(ir){return dn(ir)+""
}function eB(iu,it,ir){return new fm(iu,it,ir)
}function fm(iu,it,ir){this.r=iu;
this.g=it;
this.b=ir
}var eT=fm.prototype=new M();
eT.brighter=function(it){it=Math.pow(0.7,arguments.length?it:1);
var iw=this.r,iv=this.g,ir=this.b,iu=30;
if(!iw&&!iv&&!ir){return eB(iu,iu,iu)
}if(iw&&iw<iu){iw=iu
}if(iv&&iv<iu){iv=iu
}if(ir&&ir<iu){ir=iu
}return eB(Math.min(255,~~(iw/it)),Math.min(255,~~(iv/it)),Math.min(255,~~(ir/it)))
};
eT.darker=function(ir){ir=Math.pow(0.7,arguments.length?ir:1);
return eB(~~(ir*this.r),~~(ir*this.g),~~(ir*this.b))
};
eT.hsl=function(){return gK(this.r,this.g,this.b)
};
eT.toString=function(){return"#"+cC(this.r)+cC(this.g)+cC(this.b)
};
function cC(ir){return ir<16?"0"+Math.max(0,ir).toString(16):Math.min(255,ir).toString(16)
}function a2(ix,iv,iy){var ir=0,iu=0,iw=0,iA,iz,it;
iA=/([a-z]+)\((.*)\)/i.exec(ix);
if(iA){iz=iA[2].split(",");
switch(iA[1]){case"hsl":return iy(parseFloat(iz[0]),parseFloat(iz[1])/100,parseFloat(iz[2])/100);
case"rgb":return iv(e8(iz[0]),e8(iz[1]),e8(iz[2]))
}}if(it=au.get(ix)){return iv(it.r,it.g,it.b)
}if(ix!=null&&ix.charAt(0)==="#"){if(ix.length===4){ir=ix.charAt(1);
ir+=ir;
iu=ix.charAt(2);
iu+=iu;
iw=ix.charAt(3);
iw+=iw
}else{if(ix.length===7){ir=ix.substring(1,3);
iu=ix.substring(3,5);
iw=ix.substring(5,7)
}}ir=parseInt(ir,16);
iu=parseInt(iu,16);
iw=parseInt(iw,16)
}return iv(ir,iu,iw)
}function gK(ir,iw,iy){var iu=Math.min(ir/=255,iw/=255,iy/=255),iz=Math.max(ir,iw,iy),ix=iz-iu,iv,iA,it=(iz+iu)/2;
if(ix){iA=it<0.5?ix/(iz+iu):ix/(2-iz-iu);
if(ir==iz){iv=(iw-iy)/ix+(iw<iy?6:0)
}else{if(iw==iz){iv=(iy-ir)/ix+2
}else{iv=(ir-iw)/ix+4
}}iv*=60
}else{iv=NaN;
iA=it>0&&it<1?0:iv
}return eS(iv,iA,it)
}function eb(iv,iu,it){iv=dL(iv);
iu=dL(iu);
it=dL(it);
var ir=gD((0.4124564*iv+0.3575761*iu+0.1804375*it)/bm),ix=gD((0.2126729*iv+0.7151522*iu+0.072175*it)/bk),iw=gD((0.0193339*iv+0.119192*iu+0.9503041*it)/bh);
return cs(116*ix-16,500*(ir-ix),200*(ix-iw))
}function dL(ir){return(ir/=255)<=0.04045?ir/12.92:Math.pow((ir+0.055)/1.055,2.4)
}function e8(it){var ir=parseFloat(it);
return it.charAt(it.length-1)==="%"?Math.round(ir*2.55):ir
}var au=hy.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});
au.forEach(function(ir,it){au.set(ir,dn(it))
});
function Y(ir){return typeof ir==="function"?ir:function(){return ir
}
}hy.functor=Y;
function gy(ir){return ir
}hy.xhr=ae(gy);
function ae(ir){return function(it,iu,iv){if(arguments.length===2&&typeof iu==="function"){iv=iu,iu=null
}return ib(it,iu,ir,iv)
}
}function ib(ir,iu,iw,iA){var iB={},iz=hy.dispatch("beforesend","progress","load","error"),iv={},ix=new XMLHttpRequest(),iy=null;
if(fO.XDomainRequest&&!("withCredentials" in ix)&&/^(http(s)?:)?\/\//.test(ir)){ix=new XDomainRequest()
}"onload" in ix?ix.onload=ix.onerror=it:ix.onreadystatechange=function(){ix.readyState>3&&it()
};
function it(){var iD=ix.status,iC;
if(!iD&&ix.responseText||iD>=200&&iD<300||iD===304){try{iC=iw.call(iB,ix)
}catch(iE){iz.error.call(iB,iE);
return
}iz.load.call(iB,iC)
}else{iz.error.call(iB,ix)
}}ix.onprogress=function(iC){var iD=hy.event;
hy.event=iC;
try{iz.progress.call(iB,ix)
}finally{hy.event=iD
}};
iB.header=function(iC,iD){iC=(iC+"").toLowerCase();
if(arguments.length<2){return iv[iC]
}if(iD==null){delete iv[iC]
}else{iv[iC]=iD+""
}return iB
};
iB.mimeType=function(iC){if(!arguments.length){return iu
}iu=iC==null?null:iC+"";
return iB
};
iB.responseType=function(iC){if(!arguments.length){return iy
}iy=iC;
return iB
};
iB.response=function(iC){iw=iC;
return iB
};
["get","post"].forEach(function(iC){iB[iC]=function(){return iB.send.apply(iB,[iC].concat(dY(arguments)))
}
});
iB.send=function(iF,iD,iE){if(arguments.length===2&&typeof iD==="function"){iE=iD,iD=null
}ix.open(iF,ir,true);
if(iu!=null&&!("accept" in iv)){iv.accept=iu+",*/*"
}if(ix.setRequestHeader){for(var iC in iv){ix.setRequestHeader(iC,iv[iC])
}}if(iu!=null&&ix.overrideMimeType){ix.overrideMimeType(iu)
}if(iy!=null){ix.responseType=iy
}if(iE!=null){iB.on("error",iE).on("load",function(iG){iE(null,iG)
})
}iz.beforesend.call(iB,ix);
ix.send(iD==null?null:iD);
return iB
};
iB.abort=function(){ix.abort();
return iB
};
hy.rebind(iB,iz,"on");
return iA==null?iB:iB.get(ei(iA))
}function ei(ir){return ir.length===1?function(it,iu){ir(it==null?iu:null)
}:ir
}hy.dsv=function(ir,it){var iv=new RegExp('["'+ir+"\n]"),ix=ir.charCodeAt(0);
function iz(iB,iD,iE){if(arguments.length<3){iE=iD,iD=null
}var iC=ib(iB,it,iD==null?iw:iu(iD),iE);
iC.row=function(iF){return arguments.length?iC.response((iD=iF)==null?iw:iu(iF)):iD
};
return iC
}function iw(iB){return iz.parse(iB.responseText)
}function iu(iB){return function(iC){return iz.parse(iC.responseText,iB)
}
}iz.parse=function(iD,iB){var iC;
return iz.parseRows(iD,function(iG,iF){if(iC){return iC(iG,iF-1)
}var iE=new Function("d","return {"+iG.map(function(iH,iI){return JSON.stringify(iH)+": d["+iI+"]"
}).join(",")+"}");
iC=iB?function(iI,iH){return iB(iE(iI),iH)
}:iE
})
};
iz.parseRows=function(iK,iF){var iC={},iE={},iM=[],iG=iK.length,iJ=0,iB=0,iL,iH;
function iD(){if(iJ>=iG){return iE
}if(iH){return iH=false,iC
}var iO=iJ;
if(iK.charCodeAt(iO)===34){var iP=iO;
while(iP++<iG){if(iK.charCodeAt(iP)===34){if(iK.charCodeAt(iP+1)!==34){break
}++iP
}}iJ=iP+2;
var iQ=iK.charCodeAt(iP+1);
if(iQ===13){iH=true;
if(iK.charCodeAt(iP+2)===10){++iJ
}}else{if(iQ===10){iH=true
}}return iK.substring(iO+1,iP).replace(/""/g,'"')
}while(iJ<iG){var iQ=iK.charCodeAt(iJ++),iN=1;
if(iQ===10){iH=true
}else{if(iQ===13){iH=true;
if(iK.charCodeAt(iJ)===10){++iJ,++iN
}}else{if(iQ!==ix){continue
}}}return iK.substring(iO,iJ-iN)
}return iK.substring(iO)
}while((iL=iD())!==iE){var iI=[];
while(iL!==iC&&iL!==iE){iI.push(iL);
iL=iD()
}if(iF&&!(iI=iF(iI,iB++))){continue
}iM.push(iI)
}return iM
};
iz.format=function(iD){if(Array.isArray(iD[0])){return iz.formatRows(iD)
}var iC=new dA(),iB=[];
iD.forEach(function(iF){for(var iE in iF){if(!iC.has(iE)){iB.push(iC.add(iE))
}}});
return[iB.map(iy).join(ir)].concat(iD.map(function(iE){return iB.map(function(iF){return iy(iE[iF])
}).join(ir)
})).join("\n")
};
iz.formatRows=function(iB){return iB.map(iA).join("\n")
};
function iA(iB){return iB.map(iy).join(ir)
}function iy(iB){return iv.test(iB)?'"'+iB.replace(/\"/g,'""')+'"':iB
}return iz
};
hy.csv=hy.dsv(",","text/csv");
hy.tsv=hy.dsv("	","text/tab-separated-values");
var ec,am,cw,fv,dt,hE=fO[dr(fO,"requestAnimationFrame")]||function(ir){setTimeout(ir,17)
};
hy.timer=function(ix,ir,iu){var iw=arguments.length;
if(iw<2){ir=0
}if(iw<3){iu=Date.now()
}var it=iu+ir,iv={c:ix,t:it,f:false,n:null};
if(am){am.n=iv
}else{ec=iv
}am=iv;
if(!cw){fv=clearTimeout(fv);
cw=1;
hE(hF)
}};
function hF(){var it=bI(),ir=aj()-it;
if(ir>24){if(isFinite(ir)){clearTimeout(fv);
fv=setTimeout(hF,ir)
}cw=0
}else{cw=1;
hE(hF)
}}hy.timer.flush=function(){bI();
aj()
};
function bI(){var ir=Date.now();
dt=ec;
while(dt){if(ir>=dt.t){dt.f=dt.c(ir-dt.t)
}dt=dt.n
}return ir
}function aj(){var it,ir=ec,iu=Infinity;
while(ir){if(ir.f){ir=it?it.n=ir.n:ec=ir.n
}else{if(ir.t<iu){iu=ir.t
}ir=(it=ir).n
}}am=it;
return iu
}var g9=".",fg=",",k=[3,3],bL="$";
var cB=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(dX);
hy.formatPrefix=function(iu,ir){var it=0;
if(iu){if(iu<0){iu*=-1
}if(ir){iu=hy.round(iu,es(iu,ir))
}it=1+Math.floor(1e-12+Math.log(iu)/Math.LN10);
it=Math.max(-24,Math.min(24,Math.floor((it<=0?it+1:it-1)/3)*3))
}return cB[8+it/3]
};
function dX(iu,it){var ir=Math.pow(10,cN(8-it)*3);
return{scale:it>8?function(iv){return iv/ir
}:function(iv){return iv*ir
},symbol:iu}
}hy.round=function(ir,it){return it?Math.round(ir*(it=Math.pow(10,it)))/it:Math.round(ir)
};
hy.format=function(iD){var iA=cG.exec(iD),iF=iA[1]||" ",iB=iA[2]||">",it=iA[3]||"",iv=iA[4]||"",iw=iA[5],ir=+iA[6],iG=iA[7],iz=iA[8],iC=iA[9],iu=1,iE="",iy=false;
if(iz){iz=+iz.substring(1)
}if(iw||iF==="0"&&iB==="="){iw=iF="0";
iB="=";
if(iG){ir-=Math.floor((ir-1)/4)
}}switch(iC){case"n":iG=true;
iC="g";
break;
case"%":iu=100;
iE="%";
iC="f";
break;
case"p":iu=100;
iE="%";
iC="r";
break;
case"b":case"o":case"x":case"X":if(iv==="#"){iv="0"+iC.toLowerCase()
}case"c":case"d":iy=true;
iz=0;
break;
case"s":iu=-1;
iC="r";
break
}if(iv==="#"){iv=""
}else{if(iv==="$"){iv=bL
}}if(iC=="r"&&!iz){iC="g"
}if(iz!=null){if(iC=="g"){iz=Math.max(1,Math.min(21,iz))
}else{if(iC=="e"||iC=="f"){iz=Math.max(0,Math.min(20,iz))
}}}iC=B.get(iC)||br;
var ix=iw&&iG;
return function(iM){if(iy&&iM%1){return""
}var iH=iM<0||iM===0&&1/iM<0?(iM=-iM,"-"):it;
if(iu<0){var iL=hy.formatPrefix(iM,iz);
iM=iL.scale(iM);
iE=iL.symbol
}else{iM*=iu
}iM=iC(iM,iz);
var iI=iM.lastIndexOf("."),iK=iI<0?iM:iM.substring(0,iI),iO=iI<0?"":g9+iM.substring(iI+1);
if(!iw&&iG){iK=dq(iK)
}var iJ=iv.length+iK.length+iO.length+(ix?0:iH.length),iN=iJ<ir?new Array(iJ=ir-iJ+1).join(iF):"";
if(ix){iK=dq(iN+iK)
}iH+=iv;
iM=iK+iO;
return(iB==="<"?iH+iM+iN:iB===">"?iN+iH+iM:iB==="^"?iN.substring(0,iJ>>=1)+iH+iM+iN.substring(iJ):iH+(ix?iM:iN+iM))+iE
}
};
var cG=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i;
var B=hy.map({b:function(ir){return ir.toString(2)
},c:function(ir){return String.fromCharCode(ir)
},o:function(ir){return ir.toString(8)
},x:function(ir){return ir.toString(16)
},X:function(ir){return ir.toString(16).toUpperCase()
},g:function(ir,it){return ir.toPrecision(it)
},e:function(ir,it){return ir.toExponential(it)
},f:function(ir,it){return ir.toFixed(it)
},r:function(ir,it){return(ir=hy.round(ir,es(ir,it))).toFixed(Math.max(0,Math.min(20,es(ir*(1+1e-15),it))))
}});
function es(ir,it){return it-(ir?Math.ceil(Math.log(ir)/Math.LN10):1)
}function br(ir){return ir+""
}var dq=gy;
if(k){var cc=k.length;
dq=function(iw){var iu=iw.length,it=[],ir=0,iv=k[0];
while(iu>0&&iv>0){it.push(iw.substring(iu-=iv,iu+iv));
iv=k[ir=(ir+1)%cc]
}return it.reverse().join(fg)
}
}hy.geo={};
function fs(){}fs.prototype={s:0,t:0,add:function(ir){dy(ir,this.t,h1);
dy(h1.s,this.s,this);
if(this.s){this.t+=h1.t
}else{this.s=h1.t
}},reset:function(){this.s=this.t=0
},valueOf:function(){return this.s
}};
var h1=new fs();
function dy(iv,iu,ix){var it=ix.s=iv+iu,ir=it-iv,iw=it-ir;
ix.t=iv-iw+(iu-ir)
}hy.geo.stream=function(ir,it){if(ir&&E.hasOwnProperty(ir.type)){E[ir.type](ir,it)
}else{aW(ir,it)
}};
function aW(it,ir){if(it&&e2.hasOwnProperty(it.type)){e2[it.type](it,ir)
}}var E={Feature:function(ir,it){aW(ir.geometry,it)
},FeatureCollection:function(ir,iv){var iu=ir.features,it=-1,iw=iu.length;
while(++it<iw){aW(iu[it].geometry,iv)
}}};
var e2={Sphere:function(ir,it){it.sphere()
},Point:function(ir,it){ir=ir.coordinates;
it.point(ir[0],ir[1],ir[2])
},MultiPoint:function(ir,iu){var iv=ir.coordinates,it=-1,iw=iv.length;
while(++it<iw){ir=iv[it],iu.point(ir[0],ir[1],ir[2])
}},LineString:function(ir,it){ct(ir.coordinates,it,0)
},MultiLineString:function(ir,iu){var iv=ir.coordinates,it=-1,iw=iv.length;
while(++it<iw){ct(iv[it],iu,0)
}},Polygon:function(ir,it){hq(ir.coordinates,it)
},MultiPolygon:function(ir,iu){var iv=ir.coordinates,it=-1,iw=iv.length;
while(++it<iw){hq(iv[it],iu)
}},GeometryCollection:function(ir,iv){var iu=ir.geometries,it=-1,iw=iu.length;
while(++it<iw){aW(iu[it],iv)
}}};
function ct(iv,iu,ir){var it=-1,ix=iv.length-ir,iw;
iu.lineStart();
while(++it<ix){iw=iv[it],iu.point(iw[0],iw[1],iw[2])
}iu.lineEnd()
}function hq(iu,it){var ir=-1,iv=iu.length;
it.polygonStart();
while(++ir<iv){ct(iu[ir],it,1)
}it.polygonEnd()
}hy.geo.area=function(ir){be=0;
hy.geo.stream(ir,hw);
return be
};
var be,f5=new fs();
var hw={sphere:function(){be+=4*gr
},point:aM,lineStart:aM,lineEnd:aM,polygonStart:function(){f5.reset();
hw.lineStart=b9
},polygonEnd:function(){var ir=2*f5;
be+=ir<0?4*gr+ir:ir;
hw.lineStart=hw.lineEnd=hw.point=aM
}};
function b9(){var it,ir,iv,iu,iw;
hw.point=function(iz,iy){hw.point=ix;
iv=(it=iz)*P,iu=Math.cos(iy=(ir=iy)*P/2+gr/4),iw=Math.sin(iy)
};
function ix(iz,iy){iz*=P;
iy=iy*P/2+gr/4;
var iD=iz-iv,iF=Math.cos(iy),iE=Math.sin(iy),iB=iw*iE,iC=iu*iF+iB*Math.cos(iD),iA=iB*Math.sin(iD);
f5.add(Math.atan2(iA,iC));
iv=iz,iu=iF,iw=iE
}hw.lineEnd=function(){ix(it,ir)
}
}function aB(ir){var iu=ir[0],it=ir[1],iv=Math.cos(it);
return[iv*Math.cos(iu),iv*Math.sin(iu),Math.sin(it)]
}function aE(it,ir){return it[0]*ir[0]+it[1]*ir[1]+it[2]*ir[2]
}function c6(it,ir){return[it[1]*ir[2]-it[2]*ir[1],it[2]*ir[0]-it[0]*ir[2],it[0]*ir[1]-it[1]*ir[0]]
}function cI(it,ir){it[0]+=ir[0];
it[1]+=ir[1];
it[2]+=ir[2]
}function gt(ir,it){return[ir[0]*it,ir[1]*it,ir[2]*it]
}function fz(it){var ir=Math.sqrt(it[0]*it[0]+it[1]*it[1]+it[2]*it[2]);
it[0]/=ir;
it[1]/=ir;
it[2]/=ir
}function im(ir){return[Math.atan2(ir[1],ir[0]),ci(ir[2])]
}function e3(it,ir){return cN(it[0]-ir[0])<gB&&cN(it[1]-ir[1])<gB
}hy.geo.bounds=function(){var iv,iL,it,iJ,iw,iD,iF,ix,iA,iy,iB;
var ir={point:iG,lineStart:iC,lineEnd:iI,polygonStart:function(){ir.point=iH;
ir.lineStart=iz;
ir.lineEnd=iE;
iA=0;
hw.polygonStart()
},polygonEnd:function(){hw.polygonEnd();
ir.point=iG;
ir.lineStart=iC;
ir.lineEnd=iI;
if(f5<0){iv=-(it=180),iL=-(iJ=90)
}else{if(iA>gB){iJ=90
}else{if(iA<-gB){iL=-90
}}}iB[0]=iv,iB[1]=it
}};
function iG(iP,iO){iy.push(iB=[iv=iP,it=iP]);
if(iO<iL){iL=iO
}if(iO>iJ){iJ=iO
}}function iu(iS,iY){var iO=aB([iS*P,iY*P]);
if(ix){var iU=c6(ix,iO),iV=[iU[1],-iU[0],0],iT=c6(iV,iU);
fz(iT);
iT=im(iT);
var iW=iS-iw,iX=iW>0?1:-1,iP=iT[0]*hO*iX,iR=cN(iW)>180;
if(iR^(iX*iw<iP&&iP<iX*iS)){var iQ=iT[1]*hO;
if(iQ>iJ){iJ=iQ
}}else{if(iP=(iP+360)%360-180,iR^(iX*iw<iP&&iP<iX*iS)){var iQ=-iT[1]*hO;
if(iQ<iL){iL=iQ
}}else{if(iY<iL){iL=iY
}if(iY>iJ){iJ=iY
}}}if(iR){if(iS<iw){if(iK(iv,iS)>iK(iv,it)){it=iS
}}else{if(iK(iS,it)>iK(iv,it)){iv=iS
}}}else{if(it>=iv){if(iS<iv){iv=iS
}if(iS>it){it=iS
}}else{if(iS>iw){if(iK(iv,iS)>iK(iv,it)){it=iS
}}else{if(iK(iS,it)>iK(iv,it)){iv=iS
}}}}}else{iG(iS,iY)
}ix=iO,iw=iS
}function iC(){ir.point=iu
}function iI(){iB[0]=iv,iB[1]=it;
ir.point=iG;
ix=null
}function iH(iP,iO){if(ix){var iQ=iP-iw;
iA+=cN(iQ)>180?iQ+(iQ>0?360:-360):iQ
}else{iD=iP,iF=iO
}hw.point(iP,iO);
iu(iP,iO)
}function iz(){hw.lineStart()
}function iE(){iH(iD,iF);
hw.lineEnd();
if(cN(iA)>gB){iv=-(it=180)
}iB[0]=iv,iB[1]=it;
ix=null
}function iK(iP,iO){return(iO-=iP)<0?iO+360:iO
}function iN(iP,iO){return iP[0]-iO[0]
}function iM(iO,iP){return iP[0]<=iP[1]?iP[0]<=iO&&iO<=iP[1]:iO<iP[0]||iP[1]<iO
}return function(iT){iJ=it=-(iv=iL=Infinity);
iy=[];
hy.geo.stream(iT,ir);
var iV=iy.length;
if(iV){iy.sort(iN);
for(var iS=1,iQ=iy[0],iP,iO=[iQ];
iS<iV;
++iS){iP=iy[iS];
if(iM(iP[0],iQ)||iM(iP[1],iQ)){if(iK(iQ[0],iP[1])>iK(iQ[0],iQ[1])){iQ[1]=iP[1]
}if(iK(iP[0],iQ[1])>iK(iQ[0],iQ[1])){iQ[0]=iP[0]
}}else{iO.push(iQ=iP)
}}var iU=-Infinity,iR;
for(var iV=iO.length-1,iS=0,iQ=iO[iV],iP;
iS<=iV;
iQ=iP,++iS){iP=iO[iS];
if((iR=iK(iQ[1],iP[0]))>iU){iU=iR,iv=iP[0],it=iQ[1]
}}}iy=iB=null;
return iv===Infinity||iL===Infinity?[[NaN,NaN],[NaN,NaN]]:[[iv,iL],[it,iJ]]
}
}();
hy.geo.centroid=function(iu){eo=em=dU=dx=de=dT=dw=dc=dS=du=db=0;
hy.geo.stream(iu,gv);
var it=dS,iw=du,iv=db,ir=it*it+iw*iw+iv*iv;
if(ir<eO){it=dT,iw=dw,iv=dc;
if(em<gB){it=dU,iw=dx,iv=de
}ir=it*it+iw*iw+iv*iv;
if(ir<eO){return[NaN,NaN]
}}return[Math.atan2(iw,it)*hO,ci(iv/Math.sqrt(ir))*hO]
};
var eo,em,dU,dx,de,dT,dw,dc,dS,du,db;
var gv={sphere:aM,point:ce,lineStart:fy,lineEnd:aK,polygonStart:function(){gv.lineStart=bu
},polygonEnd:function(){gv.lineStart=fy
}};
function ce(it,ir){it*=P;
var iu=Math.cos(ir*=P);
gG(iu*Math.cos(it),iu*Math.sin(it),Math.sin(ir))
}function gG(ir,iu,it){++eo;
dU+=(ir-dU)/eo;
dx+=(iu-dx)/eo;
de+=(it-de)/eo
}function fy(){var ir,it,iv;
gv.point=function(ix,iw){ix*=P;
var iy=Math.cos(iw*=P);
ir=iy*Math.cos(ix);
it=iy*Math.sin(ix);
iv=Math.sin(iw);
gv.point=iu;
gG(ir,it,iv)
};
function iu(iz,iy){iz*=P;
var iA=Math.cos(iy*=P),iw=iA*Math.cos(iz),iC=iA*Math.sin(iz),iB=Math.sin(iy),ix=Math.atan2(Math.sqrt((ix=it*iB-iv*iC)*ix+(ix=iv*iw-ir*iB)*ix+(ix=ir*iC-it*iw)*ix),ir*iw+it*iC+iv*iB);
em+=ix;
dT+=ix*(ir+(ir=iw));
dw+=ix*(it+(it=iC));
dc+=ix*(iv+(iv=iB));
gG(ir,it,iv)
}}function aK(){gv.point=ce
}function bu(){var it,ir,iu,iv,ix;
gv.point=function(iz,iy){it=iz,ir=iy;
gv.point=iw;
iz*=P;
var iA=Math.cos(iy*=P);
iu=iA*Math.cos(iz);
iv=iA*Math.sin(iz);
ix=Math.sin(iy);
gG(iu,iv,ix)
};
gv.lineEnd=function(){iw(it,ir);
gv.lineEnd=aK;
gv.point=ce
};
function iw(iD,iK){iD*=P;
var iB=Math.cos(iK*=P),iG=iB*Math.cos(iD),iF=iB*Math.sin(iD),iE=Math.sin(iK),iC=iv*iE-ix*iF,iA=ix*iG-iu*iE,iz=iu*iF-iv*iG,iy=Math.sqrt(iC*iC+iA*iA+iz*iz),iJ=iu*iG+iv*iF+ix*iE,iI=iy&&-ak(iJ)/iy,iH=Math.atan2(iy,iJ);
dS+=iI*iC;
du+=iI*iA;
db+=iI*iz;
em+=iH;
dT+=iH*(iu+(iu=iG));
dw+=iH*(iv+(iv=iF));
dc+=iH*(ix+(ix=iE));
gG(iu,iv,ix)
}}function ao(){return true
}function cx(iy,it,iC,iA,iv){var iB=[],iw=[];
iy.forEach(function(iK){if((iN=iK.length-1)<=0){return
}var iN,iM=iK[0],iL=iK[iN];
if(e3(iM,iL)){iv.lineStart();
for(var iJ=0;
iJ<iN;
++iJ){iv.point((iM=iK[iJ])[0],iM[1])
}iv.lineEnd();
return
}var iI=new b(iM,iK,null,true),iH=new b(iM,null,iI,false);
iI.o=iH;
iB.push(iI);
iw.push(iH);
iI=new b(iL,iK,null,false);
iH=new b(iL,null,iI,true);
iI.o=iH;
iB.push(iI);
iw.push(iH)
});
iw.sort(it);
hU(iB);
hU(iw);
if(!iB.length){return
}for(var ix=0,iE=iC,iu=iw.length;
ix<iu;
++ix){iw[ix].e=iE=!iE
}var ir=iB[0],iF,iD;
while(1){var iz=ir,iG=true;
while(iz.v){if((iz=iz.n)===ir){return
}}iF=iz.z;
iv.lineStart();
do{iz.v=iz.o.v=true;
if(iz.e){if(iG){for(var ix=0,iu=iF.length;
ix<iu;
++ix){iv.point((iD=iF[ix])[0],iD[1])
}}else{iA(iz.x,iz.n.x,1,iv)
}iz=iz.n
}else{if(iG){iF=iz.p.z;
for(var ix=iF.length-1;
ix>=0;
--ix){iv.point((iD=iF[ix])[0],iD[1])
}}else{iA(iz.x,iz.p.x,-1,iv)
}iz=iz.p
}iz=iz.o;
iF=iz.z;
iG=!iG
}while(!iz.v);
iv.lineEnd()
}}function hU(iw){if(!(iv=iw.length)){return
}var iv,iu=0,it=iw[0],ir;
while(++iu<iv){it.n=ir=iw[iu];
ir.p=it;
it=ir
}it.n=ir=iw[0];
ir.p=it
}function b(it,iu,ir,iv){this.x=it;
this.z=iu;
this.o=ir;
this.e=iv;
this.v=false;
this.n=this.p=null
}function eu(ir,iv,it,iu){return function(iD,iy){var iM=iv(iy),ix=iD.invert(iu[0],iu[1]);
var iz={point:iK,lineStart:iG,lineEnd:iC,polygonStart:function(){iz.point=iI;
iz.lineStart=iH;
iz.lineEnd=iL;
iF=[];
iJ=[];
iy.polygonStart()
},polygonEnd:function(){iz.point=iK;
iz.lineStart=iG;
iz.lineEnd=iC;
iF=hy.merge(iF);
var iN=f2(ix,iJ);
if(iF.length){cx(iF,d6,iN,it,iy)
}else{if(iN){iy.lineStart();
it(null,null,1,iy);
iy.lineEnd()
}}iy.polygonEnd();
iF=iJ=null
},sphere:function(){iy.polygonStart();
iy.lineStart();
it(null,null,1,iy);
iy.lineEnd();
iy.polygonEnd()
}};
function iK(iP,iO){var iN=iD(iP,iO);
if(ir(iP=iN[0],iO=iN[1])){iy.point(iP,iO)
}}function iE(iP,iO){var iN=iD(iP,iO);
iM.point(iN[0],iN[1])
}function iG(){iz.point=iE;
iM.lineStart()
}function iC(){iz.point=iK;
iM.lineEnd()
}var iF;
var iB=W(),iw=iv(iB),iJ,iA;
function iI(iP,iO){iA.push([iP,iO]);
var iN=iD(iP,iO);
iw.point(iN[0],iN[1])
}function iH(){iw.lineStart();
iA=[]
}function iL(){iI(iA[0][0],iA[0][1]);
iw.lineEnd();
var iP=iw.clean(),iR=iB.buffer(),iQ,iS=iR.length;
iA.pop();
iJ.push(iA);
iA=null;
if(!iS){return
}if(iP&1){iQ=iR[0];
var iS=iQ.length-1,iO=-1,iN;
iy.lineStart();
while(++iO<iS){iy.point((iN=iQ[iO])[0],iN[1])
}iy.lineEnd();
return
}if(iS>1&&iP&2){iR.push(iR.pop().concat(iR.shift()))
}iF.push(iR.filter(eY))
}return iz
}
}function eY(ir){return ir.length>1
}function W(){var it=[],ir;
return{lineStart:function(){it.push(ir=[])
},point:function(iv,iu){ir.push([iv,iu])
},lineEnd:aM,buffer:function(){var iu=it;
it=[];
ir=null;
return iu
},rejoin:function(){if(it.length>1){it.push(it.pop().concat(it.shift()))
}}}
}function d6(it,ir){return((it=it.x)[0]<0?it[1]-eA-gB:eA-it[1])-((ir=ir.x)[0]<0?ir[1]-eA-gB:eA-ir[1])
}function f2(iJ,iF){var iR=iJ[0],iS=iJ[1],ir=[Math.sin(iR),-Math.cos(iR),0],iE=0,iP=0;
f5.reset();
for(var iO=0,iG=iF.length;
iO<iG;
++iO){var iA=iF[iO],iI=iA.length;
if(!iI){continue
}var ix=iA[0],iu=ix[0],iQ=ix[1]/2+gr/4,iz=Math.sin(iQ),it=Math.cos(iQ),iN=1;
while(true){if(iN===iI){iN=0
}iJ=iA[iN];
var iH=iJ[0],iD=iJ[1]/2+gr/4,iv=Math.sin(iD),iM=Math.cos(iD),iL=iH-iu,iw=cN(iL)>gr,iK=iz*iv;
f5.add(Math.atan2(iK*Math.sin(iL),it*iM+iK*Math.cos(iL)));
iE+=iw?iL+(iL>=0?gm:-gm):iL;
if(iw^iu>=iR^iH>=iR){var iB=c6(aB(ix),aB(iJ));
fz(iB);
var iC=c6(ir,iB);
fz(iC);
var iy=(iw^iL>=0?-1:1)*ci(iC[2]);
if(iS>iy||iS===iy&&(iB[0]||iB[1])){iP+=iw^iL>=0?1:-1
}}if(!iN++){break
}iu=iH,iz=iv,it=iM,ix=iJ
}}return(iE<-gB||iE<gB&&f5<0)^iP&1
}var m=eu(ao,eP,dl,[-gr,-gr/2]);
function eP(iw){var it=NaN,ir=NaN,iv=NaN,iu;
return{lineStart:function(){iw.lineStart();
iu=1
},point:function(iy,ix){var iA=iy>0?gr:-gr,iz=cN(iy-it);
if(cN(iz-gr)<gB){iw.point(it,ir=(ir+ix)/2>0?eA:-eA);
iw.point(iv,ir);
iw.lineEnd();
iw.lineStart();
iw.point(iA,ir);
iw.point(iy,ir);
iu=0
}else{if(iv!==iA&&iz>=gr){if(cN(it-iv)<gB){it-=iv*gB
}if(cN(iy-iA)<gB){iy-=iA*gB
}ir=z(it,ir,iy,ix);
iw.point(iv,ir);
iw.lineEnd();
iw.lineStart();
iw.point(iA,ir);
iu=0
}}iw.point(it=iy,ir=ix);
iv=iA
},lineEnd:function(){iw.lineEnd();
it=ir=NaN
},clean:function(){return 2-iu
}}
}function z(ix,iw,iv,iu){var it,ir,iy=Math.sin(ix-iv);
return cN(iy)>gB?Math.atan((Math.sin(iw)*(ir=Math.cos(iu))*Math.sin(iv)-Math.sin(iu)*(it=Math.cos(iw))*Math.sin(ix))/(it*ir*iy)):(iw+iu)/2
}function dl(ix,iw,iv,iu){var ir;
if(ix==null){ir=iv*eA;
iu.point(-gr,ir);
iu.point(0,ir);
iu.point(gr,ir);
iu.point(gr,0);
iu.point(gr,-ir);
iu.point(0,-ir);
iu.point(-gr,-ir);
iu.point(-gr,0);
iu.point(-gr,ir)
}else{if(cN(ix[0]-iw[0])>gB){var it=ix[0]<iw[0]?gr:-gr;
ir=iv*it/2;
iu.point(-it,ir);
iu.point(0,ir);
iu.point(it,ir)
}else{iu.point(iw[0],iw[1])
}}}function aR(iw){var ix=Math.cos(iw),iv=ix>0,iy=cN(ix)>gB,iz=b8(iw,6*P);
return eu(iu,iA,iz,iv?[0,-iw]:[-gr,iw-gr]);
function iu(iC,iB){return Math.cos(iC)*Math.cos(iB)>ix
}function iA(iG){var iF,iE,iB,iD,iC;
return{lineStart:function(){iD=iB=false;
iC=1
},point:function(iI,iH){var iM=[iI,iH],iL,iJ=iu(iI,iH),iN=iv?iJ?0:ir(iI,iH):iJ?ir(iI+(iI<0?gr:-gr),iH):0;
if(!iF&&(iD=iB=iJ)){iG.lineStart()
}if(iJ!==iB){iL=it(iF,iM);
if(e3(iF,iL)||e3(iM,iL)){iM[0]+=gB;
iM[1]+=gB;
iJ=iu(iM[0],iM[1])
}}if(iJ!==iB){iC=0;
if(iJ){iG.lineStart();
iL=it(iM,iF);
iG.point(iL[0],iL[1])
}else{iL=it(iF,iM);
iG.point(iL[0],iL[1]);
iG.lineEnd()
}iF=iL
}else{if(iy&&iF&&iv^iJ){var iK;
if(!(iN&iE)&&(iK=it(iM,iF,true))){iC=0;
if(iv){iG.lineStart();
iG.point(iK[0][0],iK[0][1]);
iG.point(iK[1][0],iK[1][1]);
iG.lineEnd()
}else{iG.point(iK[1][0],iK[1][1]);
iG.lineEnd();
iG.lineStart();
iG.point(iK[0][0],iK[0][1])
}}}}if(iJ&&(!iF||!e3(iF,iM))){iG.point(iM[0],iM[1])
}iF=iM,iB=iJ,iE=iN
},lineEnd:function(){if(iB){iG.lineEnd()
}iF=null
},clean:function(){return iC|(iD&&iB)<<1
}}
}function it(i2,i1,iF){var iD=aB(i2),iB=aB(i1);
var iK=[1,0,0],iH=c6(iD,iB),iN=aE(iH,iH),i0=iH[0],iT=iN-i0*i0;
if(!iT){return !iF&&i2
}var iW=ix*iN/iT,iV=-ix*i0/iT,i3=c6(iK,iH),iU=gt(iK,iW),iS=gt(iH,iV);
cI(iU,iS);
var iP=i3,iO=aE(iU,iP),iG=aE(iP,iP),iM=iO*iO-iG*(aE(iU,iU)-1);
if(iM<0){return
}var iQ=Math.sqrt(iM),iR=gt(iP,(-iO-iQ)/iG);
cI(iR,iU);
iR=im(iR);
if(!iF){return iR
}var iE=i2[0],iC=i1[0],iY=i2[1],iX=i1[1],iJ;
if(iC<iE){iJ=iE,iE=iC,iC=iJ
}var iI=iC-iE,i4=cN(iI-gr)<gB,iZ=i4||iI<gB;
if(!i4&&iX<iY){iJ=iY,iY=iX,iX=iJ
}if(iZ?i4?iY+iX>0^iR[1]<(cN(iR[0]-iE)<gB?iY:iX):iY<=iR[1]&&iR[1]<=iX:iI>gr^(iE<=iR[0]&&iR[0]<=iC)){var iL=gt(iP,(-iO+iQ)/iG);
cI(iL,iU);
return[iR,im(iL)]
}}function ir(iC,iB){var iE=iv?iw:gr-iw,iD=0;
if(iC<-iE){iD|=1
}else{if(iC>iE){iD|=2
}}if(iB<-iE){iD|=4
}else{if(iB>iE){iD|=8
}}return iD
}}function ar(it,iv,ir,iu){return function(iH){var iD=iH.a,iC=iH.b,ix=iD.x,iG=iD.y,iB=iC.x,iA=iC.y,iz=0,iy=1,iF=iB-ix,iE=iA-iG,iw;
iw=it-ix;
if(!iF&&iw>0){return
}iw/=iF;
if(iF<0){if(iw<iz){return
}if(iw<iy){iy=iw
}}else{if(iF>0){if(iw>iy){return
}if(iw>iz){iz=iw
}}}iw=ir-ix;
if(!iF&&iw<0){return
}iw/=iF;
if(iF<0){if(iw>iy){return
}if(iw>iz){iz=iw
}}else{if(iF>0){if(iw<iz){return
}if(iw<iy){iy=iw
}}}iw=iv-iG;
if(!iE&&iw>0){return
}iw/=iE;
if(iE<0){if(iw<iz){return
}if(iw<iy){iy=iw
}}else{if(iE>0){if(iw>iy){return
}if(iw>iz){iz=iw
}}}iw=iu-iG;
if(!iE&&iw<0){return
}iw/=iE;
if(iE<0){if(iw>iy){return
}if(iw>iz){iz=iw
}}else{if(iE>0){if(iw<iz){return
}if(iw<iy){iy=iw
}}}if(iz>0){iH.a={x:ix+iz*iF,y:iG+iz*iE}
}if(iy<1){iH.b={x:ix+iy*iF,y:iG+iy*iE}
}return iH
}
}var cQ=1000000000;
hy.geo.clipExtent=function(){var iu,ix,it,iv,iy,iw,ir={stream:function(iz){if(iy){iy.valid=false
}iy=iw(iz);
iy.valid=true;
return iy
},extent:function(iz){if(!arguments.length){return[[iu,ix],[it,iv]]
}iw=er(iu=+iz[0][0],ix=+iz[0][1],it=+iz[1][0],iv=+iz[1][1]);
if(iy){iy.valid=false,iy=null
}return ir
}};
return ir.extent([[0,0],[960,500]])
};
function er(it,iw,ir,iu){return function(iE){var iA=iE,iK=W(),iB=ar(it,iw,ir,iu),iS,iL,iI;
var iW={point:iR,lineStart:iO,lineEnd:iU,polygonStart:function(){iE=iK;
iS=[];
iL=[];
iT=true
},polygonEnd:function(){iE=iA;
iS=hy.merge(iS);
var iY=iN([it,iu]),iX=iT&&iY,iZ=iS.length;
if(iX||iZ){iE.polygonStart();
if(iX){iE.lineStart();
iJ(null,null,1,iE);
iE.lineEnd()
}if(iZ){cx(iS,ix,iY,iJ,iE)
}iE.polygonEnd()
}iS=iL=iI=null
}};
function iN(iX){var i5=0,iY=iL.length,i3=iX[1];
for(var i1=0;
i1<iY;
++i1){for(var i0=1,i6=iL[i1],iZ=i6.length,i4=i6[0],i2;
i0<iZ;
++i0){i2=i6[i0];
if(i4[1]<=i3){if(i2[1]>i3&&iF(i4,i2,iX)>0){++i5
}}else{if(i2[1]<=i3&&iF(i4,i2,iX)<0){--i5
}}i4=i2
}}return i5!==0
}function iF(iY,iX,iZ){return(iX[0]-iY[0])*(iZ[1]-iY[1])-(iZ[0]-iY[0])*(iX[1]-iY[1])
}function iJ(i2,i1,i0,iZ){var iY=0,iX=0;
if(i2==null||(iY=iv(i2,i0))!==(iX=iv(i1,i0))||iy(i2,i1)<0^i0>0){do{iZ.point(iY===0||iY===3?it:ir,iY>1?iu:iw)
}while((iY=(iY+i0+4)%4)!==iX)
}else{iZ.point(i1[0],i1[1])
}}function iM(iX,iY){return it<=iX&&iX<=ir&&iw<=iY&&iY<=iu
}function iR(iX,iY){if(iM(iX,iY)){iE.point(iX,iY)
}}var iQ,iG,iP,iV,iD,iC,iH,iT;
function iO(){iW.point=iz;
if(iL){iL.push(iI=[])
}iH=true;
iC=false;
iV=iD=NaN
}function iU(){if(iS){iz(iQ,iG);
if(iP&&iC){iK.rejoin()
}iS.push(iK.buffer())
}iW.point=iR;
if(iC){iE.lineEnd()
}}function iz(iX,i0){iX=Math.max(-cQ,Math.min(cQ,iX));
i0=Math.max(-cQ,Math.min(cQ,i0));
var iZ=iM(iX,i0);
if(iL){iI.push([iX,i0])
}if(iH){iQ=iX,iG=i0,iP=iZ;
iH=false;
if(iZ){iE.lineStart();
iE.point(iX,i0)
}}else{if(iZ&&iC){iE.point(iX,i0)
}else{var iY={a:{x:iV,y:iD},b:{x:iX,y:i0}};
if(iB(iY)){if(!iC){iE.lineStart();
iE.point(iY.a.x,iY.a.y)
}iE.point(iY.b.x,iY.b.y);
if(!iZ){iE.lineEnd()
}iT=false
}else{if(iZ){iE.lineStart();
iE.point(iX,i0);
iT=false
}}}}iV=iX,iD=i0,iC=iZ
}return iW
};
function iv(iA,iz){return cN(iA[0]-it)<gB?iz>0?0:3:cN(iA[0]-ir)<gB?iz>0?2:1:cN(iA[1]-iw)<gB?iz>0?1:0:iz>0?3:2
}function ix(iA,iz){return iy(iA.x,iz.x)
}function iy(iC,iA){var iB=iv(iC,1),iz=iv(iA,1);
return iB!==iz?iB-iz:iB===0?iA[1]-iC[1]:iB===1?iC[0]-iA[0]:iB===2?iC[1]-iA[1]:iA[0]-iC[0]
}}function fl(it,ir){function iu(iv,iw){return iv=it(iv,iw),ir(iv[0],iv[1])
}if(it.invert&&ir.invert){iu.invert=function(iv,iw){return iv=ir.invert(iv,iw),iv&&it.invert(iv[0],iv[1])
}
}return iu
}function ca(iv){var iu=0,it=gr/3,ir=fx(iv),iw=ir(iu,it);
iw.parallels=function(ix){if(!arguments.length){return[iu/gr*180,it/gr*180]
}return ir(iu=ix[0]*gr/180,it=ix[1]*gr/180)
};
return iw
}function T(it,ir){var iw=Math.sin(it),iy=(iw+Math.sin(ir))/2,ix=1+iw*(2*iy-iw),iv=Math.sqrt(ix)/iy;
function iu(iA,iz){var iB=Math.sqrt(ix-2*iy*Math.sin(iz))/iy;
return[iB*Math.sin(iA*=iy),iv-iB*Math.cos(iA)]
}iu.invert=function(iz,iB){var iA=iv-iB;
return[Math.atan2(iz,iA)/iy,ci((ix-(iz*iz+iA*iA)*iy*iy)/(2*iy))]
};
return iu
}(hy.geo.conicEqualArea=function(){return ca(T)
}).raw=T;
hy.geo.albers=function(){return hy.geo.conicEqualArea().rotate([96,0]).center([-0.6,38.7]).parallels([29.5,45.5]).scale(1070)
};
hy.geo.albersUsa=function(){var it=hy.geo.albers();
var ix=hy.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]);
var iu=hy.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]);
var iz,ir={point:function(iB,iC){iz=[iB,iC]
}},iw,iy,iv;
function iA(iC){var iB=iC[0],iD=iC[1];
iz=null;
(iw(iB,iD),iz)||(iy(iB,iD),iz)||iv(iB,iD);
return iz
}iA.invert=function(iE){var iC=it.scale(),iD=it.translate(),iB=(iE[0]-iD[0])/iC,iF=(iE[1]-iD[1])/iC;
return(iF>=0.12&&iF<0.234&&iB>=-0.425&&iB<-0.214?ix:iF>=0.166&&iF<0.234&&iB>=-0.214&&iB<-0.115?iu:it).invert(iE)
};
iA.stream=function(iD){var iC=it.stream(iD),iE=ix.stream(iD),iB=iu.stream(iD);
return{point:function(iF,iG){iC.point(iF,iG);
iE.point(iF,iG);
iB.point(iF,iG)
},sphere:function(){iC.sphere();
iE.sphere();
iB.sphere()
},lineStart:function(){iC.lineStart();
iE.lineStart();
iB.lineStart()
},lineEnd:function(){iC.lineEnd();
iE.lineEnd();
iB.lineEnd()
},polygonStart:function(){iC.polygonStart();
iE.polygonStart();
iB.polygonStart()
},polygonEnd:function(){iC.polygonEnd();
iE.polygonEnd();
iB.polygonEnd()
}}
};
iA.precision=function(iB){if(!arguments.length){return it.precision()
}it.precision(iB);
ix.precision(iB);
iu.precision(iB);
return iA
};
iA.scale=function(iB){if(!arguments.length){return it.scale()
}it.scale(iB);
ix.scale(iB*0.35);
iu.scale(iB);
return iA.translate(it.translate())
};
iA.translate=function(iD){if(!arguments.length){return it.translate()
}var iC=it.scale(),iB=+iD[0],iE=+iD[1];
iw=it.translate(iD).clipExtent([[iB-0.455*iC,iE-0.238*iC],[iB+0.455*iC,iE+0.238*iC]]).stream(ir).point;
iy=ix.translate([iB-0.307*iC,iE+0.201*iC]).clipExtent([[iB-0.425*iC+gB,iE+0.12*iC+gB],[iB-0.214*iC-gB,iE+0.234*iC-gB]]).stream(ir).point;
iv=iu.translate([iB-0.205*iC,iE+0.212*iC]).clipExtent([[iB-0.214*iC+gB,iE+0.166*iC+gB],[iB-0.115*iC-gB,iE+0.234*iC-gB]]).stream(ir).point;
return iA
};
return iA.scale(1070)
};
var f3,F,dJ={point:aM,lineStart:aM,lineEnd:aM,polygonStart:function(){F=0;
dJ.lineStart=cS
},polygonEnd:function(){dJ.lineStart=dJ.lineEnd=dJ.point=aM;
f3+=cN(F/2)
}};
function cS(){var iv,ir,it,iu;
dJ.point=function(ix,iy){dJ.point=iw;
iv=it=ix,ir=iu=iy
};
function iw(ix,iy){F+=iu*ix-it*iy;
it=ix,iu=iy
}dJ.lineEnd=function(){iw(iv,ir)
}
}var eW,ez,eU,ey;
var aD={point:c1,lineStart:aM,lineEnd:aM,polygonStart:aM,polygonEnd:aM};
function c1(ir,it){if(ir<eW){eW=ir
}if(ir>eU){eU=ir
}if(it<ez){ez=it
}if(it>ey){ey=it
}}function cn(){var iu=hi(4.5),it=[];
var iz={point:ir,lineStart:function(){iz.point=iy
},lineEnd:ix,polygonStart:function(){iz.lineEnd=iv
},polygonEnd:function(){iz.lineEnd=ix;
iz.point=ir
},pointRadius:function(iA){iu=hi(iA);
return iz
},result:function(){if(it.length){var iA=it.join("");
it=[];
return iA
}}};
function ir(iA,iB){it.push("M",iA,",",iB,iu)
}function iy(iA,iB){it.push("M",iA,",",iB);
iz.point=iw
}function iw(iA,iB){it.push("L",iA,",",iB)
}function ix(){iz.point=ir
}function iv(){it.push("Z")
}return iz
}function hi(ir){return"m0,"+ir+"a"+ir+","+ir+" 0 1,1 0,"+-2*ir+"a"+ir+","+ir+" 0 1,1 0,"+2*ir+"z"
}var hh={point:cW,lineStart:f8,lineEnd:cV,polygonStart:function(){hh.lineStart=b3
},polygonEnd:function(){hh.point=cW;
hh.lineStart=f8;
hh.lineEnd=cV
}};
function cW(ir,it){dU+=ir;
dx+=it;
++de
}function f8(){var ir,it;
hh.point=function(iv,iw){hh.point=iu;
cW(ir=iv,it=iw)
};
function iu(iv,iz){var ix=iv-ir,iw=iz-it,iy=Math.sqrt(ix*ix+iw*iw);
dT+=iy*(ir+iv)/2;
dw+=iy*(it+iz)/2;
dc+=iy;
cW(ir=iv,it=iz)
}}function cV(){hh.point=cW
}function b3(){var iv,ir,it,iu;
hh.point=function(ix,iy){hh.point=iw;
cW(iv=it=ix,ir=iu=iy)
};
function iw(ix,iB){var iz=ix-it,iy=iB-iu,iA=Math.sqrt(iz*iz+iy*iy);
dT+=iA*(it+ix)/2;
dw+=iA*(iu+iB)/2;
dc+=iA;
iA=iu*ix-it*iB;
dS+=iA*(it+ix);
du+=iA*(iu+iB);
db+=iA*3;
cW(it=ix,iu=iB)
}hh.lineEnd=function(){iw(iv,ir)
}
}function cM(it){var iw=4.5;
var iz={point:ir,lineStart:function(){iz.point=iy
},lineEnd:ix,polygonStart:function(){iz.lineEnd=iu
},polygonEnd:function(){iz.lineEnd=ix;
iz.point=ir
},pointRadius:function(iA){iw=iA;
return iz
},result:aM};
function ir(iA,iB){it.moveTo(iA,iB);
it.arc(iA,iB,iw,0,gm)
}function iy(iA,iB){it.moveTo(iA,iB);
iz.point=iv
}function iv(iA,iB){it.lineTo(iA,iB)
}function ix(){iz.point=ir
}function iu(){it.closePath()
}return iz
}function f4(iy){var iw=0.5,ix=Math.cos(30*P),iz=16;
function iu(iA){return(iz?iv:ir)(iA)
}function ir(iA){return eR(iA,function(iB,iC){iB=iy(iB,iC);
iA.point(iB[0],iB[1])
})
}function iv(iG){var iL,iR,iQ,iH,iU,iJ,iB,iC,iT,iD,iV,iI,iM;
var iE={point:iP,lineStart:iK,lineEnd:iS,polygonStart:function(){iG.polygonStart();
iE.lineStart=iF
},polygonEnd:function(){iG.polygonEnd();
iE.lineStart=iK
}};
function iP(iW,iX){iW=iy(iW,iX);
iG.point(iW[0],iW[1])
}function iK(){iT=NaN;
iE.point=iA;
iG.lineStart()
}function iA(iX,iW){var iZ=aB([iX,iW]),iY=iy(iX,iW);
it(iT,iD,iC,iV,iI,iM,iT=iY[0],iD=iY[1],iC=iX,iV=iZ[0],iI=iZ[1],iM=iZ[2],iz,iG);
iG.point(iT,iD)
}function iS(){iE.point=iP;
iG.lineEnd()
}function iF(){iK();
iE.point=iO;
iE.lineEnd=iN
}function iO(iX,iW){iA(iL=iX,iR=iW),iQ=iT,iH=iD,iU=iV,iJ=iI,iB=iM;
iE.point=iA
}function iN(){it(iT,iD,iC,iV,iI,iM,iQ,iH,iL,iU,iJ,iB,iz,iG);
iE.lineEnd=iS;
iS()
}return iE
}function it(iV,iG,iC,i2,iJ,iR,iU,iF,iB,i0,iI,iP,iZ,iH){var iN=iU-iV,iM=iF-iG,i1=iN*iN+iM*iM;
if(i1>4*iw&&iZ--){var iY=i2+i0,iX=iJ+iI,iW=iR+iP,iQ=Math.sqrt(iY*iY+iX*iX+iW*iW),iT=Math.asin(iW/=iQ),iA=cN(cN(iW)-1)<gB||cN(iC-iB)<gB?(iC+iB)/2:Math.atan2(iX,iY),iO=iy(iA,iT),iS=iO[0],iE=iO[1],iD=iS-iV,iL=iE-iG,iK=iM*iD-iN*iL;
if(iK*iK/i1>iw||cN((iN*iD+iM*iL)/i1-0.5)>0.3||i2*i0+iJ*iI+iR*iP<ix){it(iV,iG,iC,i2,iJ,iR,iS,iE,iA,iY/=iQ,iX/=iQ,iW,iZ,iH);
iH.point(iS,iE);
it(iS,iE,iA,iY,iX,iW,iU,iF,iB,i0,iI,iP,iZ,iH)
}}}iu.precision=function(iA){if(!arguments.length){return Math.sqrt(iw)
}iz=(iw=iA*iA)>0&&16;
return iu
};
return iu
}hy.geo.path=function(){var iy=4.5,it,iv,iw,ir,iu;
function iz(iA){if(iA){if(typeof iy==="function"){ir.pointRadius(+iy.apply(this,arguments))
}if(!iu||!iu.valid){iu=iw(ir)
}hy.geo.stream(iA,iu)
}return ir.result()
}iz.area=function(iA){f3=0;
hy.geo.stream(iA,iw(dJ));
return f3
};
iz.centroid=function(iA){dU=dx=de=dT=dw=dc=dS=du=db=0;
hy.geo.stream(iA,iw(hh));
return db?[dS/db,du/db]:dc?[dT/dc,dw/dc]:de?[dU/de,dx/de]:[NaN,NaN]
};
iz.bounds=function(iA){eU=ey=-(eW=ez=Infinity);
hy.geo.stream(iA,iw(aD));
return[[eW,ez],[eU,ey]]
};
iz.projection=function(iA){if(!arguments.length){return it
}iw=(it=iA)?iA.stream||hs(iA):gy;
return ix()
};
iz.context=function(iA){if(!arguments.length){return iv
}ir=(iv=iA)==null?new cn():new cM(iA);
if(typeof iy!=="function"){ir.pointRadius(iy)
}return ix()
};
iz.pointRadius=function(iA){if(!arguments.length){return iy
}iy=typeof iA==="function"?iA:(ir.pointRadius(+iA),+iA);
return iz
};
function ix(){iu=null;
return iz
}return iz.projection(hy.geo.albersUsa()).context(null)
};
function hs(it){var ir=f4(function(iu,iv){return it([iu*hO,iv*hO])
});
return function(iu){return ck(ir(iu))
}
}hy.geo.transform=function(ir){return{stream:function(iv){var iu=new en(iv);
for(var it in ir){iu[it]=ir[it]
}return iu
}}
};
function en(ir){this.stream=ir
}en.prototype={point:function(ir,it){this.stream.point(ir,it)
},sphere:function(){this.stream.sphere()
},lineStart:function(){this.stream.lineStart()
},lineEnd:function(){this.stream.lineEnd()
},polygonStart:function(){this.stream.polygonStart()
},polygonEnd:function(){this.stream.polygonEnd()
}};
function eR(it,ir){return{point:ir,sphere:function(){it.sphere()
},lineStart:function(){it.lineStart()
},lineEnd:function(){it.lineEnd()
},polygonStart:function(){it.polygonStart()
},polygonEnd:function(){it.polygonEnd()
}}
}hy.geo.projection=fQ;
hy.geo.projectionMutator=fx;
function fQ(ir){return fx(function(){return ir
})()
}function fx(iG){var iv,iL,iz,iI=f4(function(iQ,iR){iQ=iv(iQ,iR);
return[iQ[0]*iK+ix,iu-iQ[1]*iK]
}),iK=150,iE=480,iC=250,iJ=0,iD=0,iA=0,iw=0,iH=0,ix,iu,iP=m,iM=gy,ir=null,it=null,iy;
function iO(iQ){iQ=iz(iQ[0]*P,iQ[1]*P);
return[iQ[0]*iK+ix,iu-iQ[1]*iK]
}function iF(iQ){iQ=iz.invert((iQ[0]-ix)/iK,(iu-iQ[1])/iK);
return iQ&&[iQ[0]*hO,iQ[1]*hO]
}iO.stream=function(iQ){if(iy){iy.valid=false
}iy=ck(iP(iL,iI(iM(iQ))));
iy.valid=true;
return iy
};
iO.clipAngle=function(iQ){if(!arguments.length){return ir
}iP=iQ==null?(ir=iQ,m):aR((ir=+iQ)*P);
return iB()
};
iO.clipExtent=function(iQ){if(!arguments.length){return it
}it=iQ;
iM=iQ?er(iQ[0][0],iQ[0][1],iQ[1][0],iQ[1][1]):gy;
return iB()
};
iO.scale=function(iQ){if(!arguments.length){return iK
}iK=+iQ;
return iN()
};
iO.translate=function(iQ){if(!arguments.length){return[iE,iC]
}iE=+iQ[0];
iC=+iQ[1];
return iN()
};
iO.center=function(iQ){if(!arguments.length){return[iJ*hO,iD*hO]
}iJ=iQ[0]%360*P;
iD=iQ[1]%360*P;
return iN()
};
iO.rotate=function(iQ){if(!arguments.length){return[iA*hO,iw*hO,iH*hO]
}iA=iQ[0]%360*P;
iw=iQ[1]%360*P;
iH=iQ.length>2?iQ[2]%360*P:0;
return iN()
};
hy.rebind(iO,iI,"precision");
function iN(){iz=fl(iL=dP(iA,iw,iH),iv);
var iQ=iv(iJ,iD);
ix=iE-iQ[0]*iK;
iu=iC+iQ[1]*iK;
return iB()
}function iB(){if(iy){iy.valid=false,iy=null
}return iO
}return function(){iv=iG.apply(this,arguments);
iO.invert=iv.invert&&iF;
return iN()
}
}function ck(ir){return eR(ir,function(it,iu){ir.point(it*P,iu*P)
})
}function bB(it,ir){return[it,ir]
}(hy.geo.equirectangular=function(){return fQ(bB)
}).raw=bB.invert=bB;
hy.geo.rotation=function(it){it=dP(it[0]%360*P,it[1]*P,it.length>2?it[2]*P:0);
function ir(iu){iu=it(iu[0]*P,iu[1]*P);
return iu[0]*=hO,iu[1]*=hO,iu
}ir.invert=function(iu){iu=it.invert(iu[0]*P,iu[1]*P);
return iu[0]*=hO,iu[1]*=hO,iu
};
return ir
};
function bN(it,ir){return[it>gr?it-gm:it<-gr?it+gm:it,ir]
}bN.invert=bB;
function dP(iu,it,ir){return iu?it||ir?fl(fd(iu),bX(it,ir)):fd(iu):it||ir?bX(it,ir):bN
}function ha(ir){return function(iu,it){return iu+=ir,[iu>gr?iu-gm:iu<-gr?iu+gm:iu,it]
}
}function fd(it){var ir=ha(it);
ir.invert=ha(-it);
return ir
}function bX(ix,it){var iw=Math.cos(ix),iy=Math.sin(ix),ir=Math.cos(it),iu=Math.sin(it);
function iv(iB,iA){var iD=Math.cos(iA),iz=Math.cos(iB)*iD,iF=Math.sin(iB)*iD,iE=Math.sin(iA),iC=iE*iw+iz*iy;
return[Math.atan2(iF*ir-iC*iu,iz*iw-iE*iy),ci(iC*ir+iF*iu)]
}iv.invert=function(iB,iA){var iD=Math.cos(iA),iz=Math.cos(iB)*iD,iF=Math.sin(iB)*iD,iE=Math.sin(iA),iC=iE*ir-iF*iu;
return[Math.atan2(iF*ir+iE*iu,iz*iw+iC*iy),ci(iC*iw-iz*iy)]
};
return iv
}hy.geo.circle=function(){var it=[0,0],iw,ir=6,iu;
function iv(){var ix=typeof it==="function"?it.apply(this,arguments):it,iz=dP(-ix[0]*P,-ix[1]*P,0).invert,iy=[];
iu(null,null,1,{point:function(iA,iB){iy.push(iA=iz(iA,iB));
iA[0]*=hO,iA[1]*=hO
}});
return{type:"Polygon",coordinates:[iy]}
}iv.origin=function(ix){if(!arguments.length){return it
}it=ix;
return iv
};
iv.angle=function(ix){if(!arguments.length){return iw
}iu=b8((iw=+ix)*P,ir*P);
return iv
};
iv.precision=function(ix){if(!arguments.length){return ir
}iu=b8(iw*P,(ir=+ix)*P);
return iv
};
return iv.angle(90)
};
function b8(ir,it){var iv=Math.cos(ir),iu=Math.sin(ir);
return function(iC,iB,iA,iz){var iy=iA*it;
if(iC!=null){iC=h4(iv,iC);
iB=h4(iv,iB);
if(iA>0?iC<iB:iC>iB){iC+=iA*gm
}}else{iC=ir+iA*gm;
iB=ir-0.5*iy
}for(var iw,ix=iC;
iA>0?ix>iB:ix<iB;
ix-=iy){iz.point((iw=im([iv,-iu*Math.cos(ix),-iu*Math.sin(ix)]))[0],iw[1])
}}
}function h4(iu,ir){var it=aB(ir);
it[0]-=iu;
fz(it);
var iv=ak(-it[1]);
return((-it[2]<0?-iv:iv)+2*Math.PI-gB)%(2*Math.PI)
}hy.geo.distance=function(iz,iy){var iA=(iy[0]-iz[0])*P,iC=iz[1]*P,iB=iy[1]*P,iw=Math.sin(iA),it=Math.cos(iA),ix=Math.sin(iC),iu=Math.cos(iC),iv=Math.sin(iB),ir=Math.cos(iB),iD;
return Math.atan2(Math.sqrt((iD=ir*iw)*iD+(iD=iu*iv-ix*ir*it)*iD),ix*iv+iu*ir*it)
};
hy.geo.graticule=function(){var iG,iI,iJ,iK,iv,iw,ix,iz,iE=10,iD=iE,iA=90,iy=360,iC,iB,iu,it,iF=2.5;
function iH(){return{type:"MultiLineString",coordinates:ir()}
}function ir(){return hy.range(Math.ceil(iK/iA)*iA,iJ,iA).map(iu).concat(hy.range(Math.ceil(iz/iy)*iy,ix,iy).map(it)).concat(hy.range(Math.ceil(iI/iE)*iE,iG,iE).filter(function(iL){return cN(iL%iA)>gB
}).map(iC)).concat(hy.range(Math.ceil(iw/iD)*iD,iv,iD).filter(function(iL){return cN(iL%iy)>gB
}).map(iB))
}iH.lines=function(){return ir().map(function(iL){return{type:"LineString",coordinates:iL}
})
};
iH.outline=function(){return{type:"Polygon",coordinates:[iu(iK).concat(it(ix).slice(1),iu(iJ).reverse().slice(1),it(iz).reverse().slice(1))]}
};
iH.extent=function(iL){if(!arguments.length){return iH.minorExtent()
}return iH.majorExtent(iL).minorExtent(iL)
};
iH.majorExtent=function(iL){if(!arguments.length){return[[iK,iz],[iJ,ix]]
}iK=+iL[0][0],iJ=+iL[1][0];
iz=+iL[0][1],ix=+iL[1][1];
if(iK>iJ){iL=iK,iK=iJ,iJ=iL
}if(iz>ix){iL=iz,iz=ix,ix=iL
}return iH.precision(iF)
};
iH.minorExtent=function(iL){if(!arguments.length){return[[iI,iw],[iG,iv]]
}iI=+iL[0][0],iG=+iL[1][0];
iw=+iL[0][1],iv=+iL[1][1];
if(iI>iG){iL=iI,iI=iG,iG=iL
}if(iw>iv){iL=iw,iw=iv,iv=iL
}return iH.precision(iF)
};
iH.step=function(iL){if(!arguments.length){return iH.minorStep()
}return iH.majorStep(iL).minorStep(iL)
};
iH.majorStep=function(iL){if(!arguments.length){return[iA,iy]
}iA=+iL[0],iy=+iL[1];
return iH
};
iH.minorStep=function(iL){if(!arguments.length){return[iE,iD]
}iE=+iL[0],iD=+iL[1];
return iH
};
iH.precision=function(iL){if(!arguments.length){return iF
}iF=+iL;
iC=aQ(iw,iv,90);
iB=aO(iI,iG,iF);
iu=aQ(iz,ix,90);
it=aO(iK,iJ,iF);
return iH
};
return iH.majorExtent([[-180,-90+gB],[180,90-gB]]).minorExtent([[-180,-80-gB],[180,80+gB]])
};
function aQ(iu,it,ir){var iv=hy.range(iu,it-gB,ir).concat(it);
return function(iw){return iv.map(function(ix){return[iw,ix]
})
}
}function aO(iv,iu,it){var ir=hy.range(iv,iu-gB,it).concat(iu);
return function(iw){return ir.map(function(ix){return[ix,iw]
})
}
}function hT(ir){return ir.source
}function h2(ir){return ir.target
}hy.geo.greatArc=function(){var iu=hT,it,iv=h2,iw;
function ir(){return{type:"LineString",coordinates:[it||iu.apply(this,arguments),iw||iv.apply(this,arguments)]}
}ir.distance=function(){return hy.geo.distance(it||iu.apply(this,arguments),iw||iv.apply(this,arguments))
};
ir.source=function(ix){if(!arguments.length){return iu
}iu=ix,it=typeof ix==="function"?null:ix;
return ir
};
ir.target=function(ix){if(!arguments.length){return iv
}iv=ix,iw=typeof ix==="function"?null:ix;
return ir
};
ir.precision=function(){return arguments.length?ir:0
};
return ir
};
hy.geo.interpolate=function(ir,it){return h(ir[0]*P,ir[1]*P,it[0]*P,it[1]*P)
};
function h(iv,iG,iu,iE){var iy=Math.cos(iG),iF=Math.sin(iG),iw=Math.cos(iE),iD=Math.sin(iE),iA=iy*Math.cos(iv),it=iy*Math.sin(iv),iz=iw*Math.cos(iu),ir=iw*Math.sin(iu),iC=2*Math.asin(Math.sqrt(aJ(iE-iG)+iy*iw*aJ(iu-iv))),ix=1/Math.sin(iC);
var iB=iC?function(iJ){var iM=Math.sin(iJ*=iC)*ix,iI=Math.sin(iC-iJ)*ix,iH=iI*iA+iM*iz,iL=iI*it+iM*ir,iK=iI*iF+iM*iD;
return[Math.atan2(iL,iH)*hO,Math.atan2(iK,Math.sqrt(iH*iH+iL*iL))*hO]
}:function(){return[iv*hO,iG*hO]
};
iB.distance=iC;
return iB
}hy.geo.length=function(ir){d5=0;
hy.geo.stream(ir,gc);
return d5
};
var d5;
var gc={sphere:aM,point:aM,lineStart:hW,lineEnd:aM,polygonStart:aM,polygonEnd:aM};
function hW(){var it,iu,ir;
gc.point=function(ix,iw){it=ix*P,iu=Math.sin(iw*=P),ir=Math.cos(iw);
gc.point=iv
};
gc.lineEnd=function(){gc.point=gc.lineEnd=aM
};
function iv(ix,iw){var iA=Math.sin(iw*=P),iB=Math.cos(iw),iy=cN((ix*=P)-it),iz=Math.cos(iy);
d5+=Math.atan2(Math.sqrt((iy=iB*Math.sin(iy))*iy+(iy=ir*iA-iu*iB*iz)*iy),iu*iA+ir*iB*iz);
it=ix,iu=iA,ir=iB
}}function eI(iu,it){function ir(iw,iv){var iz=Math.cos(iw),iy=Math.cos(iv),ix=iu(iz*iy);
return[ix*iy*Math.sin(iw),ix*Math.sin(iv)]
}ir.invert=function(iv,iA){var iy=Math.sqrt(iv*iv+iA*iA),iz=it(iy),iw=Math.sin(iz),ix=Math.cos(iz);
return[Math.atan2(iv*iw,iy*ix),Math.asin(iy&&iA*iw/iy)]
};
return ir
}var by=eI(function(ir){return Math.sqrt(2/(1+ir))
},function(ir){return 2*Math.asin(ir/2)
});
(hy.geo.azimuthalEqualArea=function(){return fQ(by)
}).raw=by;
var bM=eI(function(ir){var it=Math.acos(ir);
return it&&it/Math.sin(it)
},gy);
(hy.geo.azimuthalEquidistant=function(){return fQ(bM)
}).raw=bM;
function fZ(iu,it){var ir=Math.cos(iu),iw=function(iz){return Math.tan(gr/4+iz/2)
},iy=iu===it?Math.sin(iu):Math.log(ir/Math.cos(it))/Math.log(iw(it)/iw(iu)),ix=ir*Math.pow(iw(iu),iy)/iy;
if(!iy){return aZ
}function iv(iA,iz){var iB=cN(cN(iz)-eA)<gB?0:ix/Math.pow(iw(iz),iy);
return[iB*Math.sin(iy*iA),ix-iB*Math.cos(iy*iA)]
}iv.invert=function(iz,iC){var iB=ix-iC,iA=cd(iy)*Math.sqrt(iz*iz+iB*iB);
return[Math.atan2(iz,iB)/iy,2*Math.atan(Math.pow(ix/iA,1/iy))-eA]
};
return iv
}(hy.geo.conicConformal=function(){return ca(fZ)
}).raw=fZ;
function hL(iu,it){var ir=Math.cos(iu),ix=iu===it?Math.sin(iu):(ir-Math.cos(it))/(it-iu),iw=ir/ix+iu;
if(cN(ix)<gB){return bB
}function iv(iz,iy){var iA=iw-iy;
return[iA*Math.sin(ix*iz),iw-iA*Math.cos(ix*iz)]
}iv.invert=function(iy,iA){var iz=iw-iA;
return[Math.atan2(iy,iz)/ix,iw-cd(ix)*Math.sqrt(iy*iy+iz*iz)]
};
return iv
}(hy.geo.conicEquidistant=function(){return ca(hL)
}).raw=hL;
var eQ=eI(function(ir){return 1/ir
},Math.atan);
(hy.geo.gnomonic=function(){return fQ(eQ)
}).raw=eQ;
function aZ(it,ir){return[it,Math.log(Math.tan(gr/4+ir/2))]
}aZ.invert=function(ir,it){return[ir,2*Math.atan(Math.exp(it))-eA]
};
function dd(ix){var ir=fQ(ix),iw=ir.scale,iv=ir.translate,it=ir.clipExtent,iu;
ir.scale=function(){var iy=iw.apply(ir,arguments);
return iy===ir?iu?ir.clipExtent(null):ir:iy
};
ir.translate=function(){var iy=iv.apply(ir,arguments);
return iy===ir?iu?ir.clipExtent(null):ir:iy
};
ir.clipExtent=function(iA){var iz=it.apply(ir,arguments);
if(iz===ir){if(iu=iA==null){var iy=gr*iw(),iB=iv();
it([[iB[0]-iy,iB[1]-iy],[iB[0]+iy,iB[1]+iy]])
}}else{if(iu){iz=null
}}return iz
};
return ir.clipExtent(null)
}(hy.geo.mercator=function(){return dd(aZ)
}).raw=aZ;
var ge=eI(function(){return 1
},Math.asin);
(hy.geo.orthographic=function(){return fQ(ge)
}).raw=ge;
var cg=eI(function(ir){return 1/(1+ir)
},function(ir){return 2*Math.atan(ir)
});
(hy.geo.stereographic=function(){return fQ(cg)
}).raw=cg;
function aq(it,ir){return[Math.log(Math.tan(gr/4+ir/2)),-it]
}aq.invert=function(ir,it){return[-it,2*Math.atan(Math.exp(ir))-eA]
};
(hy.geo.transverseMercator=function(){var it=dd(aq),ir=it.center,iu=it.rotate;
it.center=function(iv){return iv?ir([-iv[1],iv[0]]):(iv=ir(),[-iv[1],iv[0]])
};
it.rotate=function(iv){return iv?iu([iv[0],iv[1],iv.length>2?iv[2]+90:90]):(iv=iu(),[iv[0],iv[1],iv[2]-90])
};
return it.rotate([0,0])
}).raw=aq;
hy.geom={};
function h6(ir){return ir[0]
}function h5(ir){return ir[1]
}hy.geom.hull=function(it){var ir=h6,iv=h5;
if(arguments.length){return iu(it)
}function iu(iQ){if(iQ.length<3){return[]
}var iz=Y(ir),iy=Y(iv),iG=iQ.length,iB,iD=iG-1,iJ=[],iC=[],iO,iK,iH,iL=0,iN,ix,iM,iw,iF,iE,iP,iI;
if(iz===h6&&iv===h5){iB=iQ
}else{for(iK=0,iB=[];
iK<iG;
++iK){iB.push([+iz.call(this,iO=iQ[iK],iK),+iy.call(this,iO,iK)])
}}for(iK=1;
iK<iG;
++iK){if(iB[iK][1]<iB[iL][1]||iB[iK][1]==iB[iL][1]&&iB[iK][0]<iB[iL][0]){iL=iK
}}for(iK=0;
iK<iG;
++iK){if(iK===iL){continue
}ix=iB[iK][1]-iB[iL][1];
iN=iB[iK][0]-iB[iL][0];
iJ.push({angle:Math.atan2(ix,iN),index:iK})
}iJ.sort(function(iS,iR){return iS.angle-iR.angle
});
iP=iJ[0].angle;
iE=iJ[0].index;
iF=0;
for(iK=1;
iK<iD;
++iK){iH=iJ[iK].index;
if(iP==iJ[iK].angle){iN=iB[iE][0]-iB[iL][0];
ix=iB[iE][1]-iB[iL][1];
iM=iB[iH][0]-iB[iL][0];
iw=iB[iH][1]-iB[iL][1];
if(iN*iN+ix*ix>=iM*iM+iw*iw){iJ[iK].index=-1;
continue
}else{iJ[iF].index=-1
}}iP=iJ[iK].angle;
iF=iK;
iE=iH
}iC.push(iL);
for(iK=0,iH=0;
iK<2;
++iH){if(iJ[iH].index>-1){iC.push(iJ[iH].index);
iK++
}}iI=iC.length;
for(;
iH<iD;
++iH){if(iJ[iH].index<0){continue
}while(!dQ(iC[iI-2],iC[iI-1],iJ[iH].index,iB)){--iI
}iC[iI++]=iJ[iH].index
}var iA=[];
for(iK=iI-1;
iK>=0;
--iK){iA.push(iQ[iC[iK]])
}return iA
}iu.x=function(iw){return arguments.length?(ir=iw,iu):ir
};
iu.y=function(iw){return arguments.length?(iv=iw,iu):iv
};
return iu
};
function dQ(iu,it,ir,iB){var iC,iA,iz,iy,ix,iw,iv;
iC=iB[iu];
iA=iC[0];
iz=iC[1];
iC=iB[it];
iy=iC[0];
ix=iC[1];
iC=iB[ir];
iw=iC[0];
iv=iC[1];
return(iv-iz)*(iy-iA)-(ix-iz)*(iw-iA)>0
}hy.geom.polygon=function(ir){ij(ir,eC);
return ir
};
var eC=hy.geom.polygon.prototype=[];
eC.area=function(){var iu=-1,iw=this.length,it,ir=this[iw-1],iv=0;
while(++iu<iw){it=ir;
ir=this[iu];
iv+=it[1]*ir[0]-it[0]*ir[1]
}return iv*0.5
};
eC.centroid=function(iv){var iw=-1,iz=this.length,it=0,iy=0,iu,ir=this[iz-1],ix;
if(!arguments.length){iv=-1/(6*this.area())
}while(++iw<iz){iu=ir;
ir=this[iw];
ix=iu[0]*ir[1]-ir[0]*iu[1];
it+=(iu[0]+ir[0])*ix;
iy+=(iu[1]+ir[1])*ix
}return[it*iv,iy*iv]
};
eC.clip=function(iz){var iB,iw=g5(iz),iv=-1,ir=this.length-g5(this),iu,it,iC=this[ir-1],iA,iy,ix;
while(++iv<ir){iB=iz.slice();
iz.length=0;
iA=this[iv];
iy=iB[(it=iB.length-iw)-1];
iu=-1;
while(++iu<it){ix=iB[iu];
if(I(ix,iC,iA)){if(!I(iy,iC,iA)){iz.push(gz(iy,ix,iC,iA))
}iz.push(ix)
}else{if(I(iy,iC,iA)){iz.push(gz(iy,ix,iC,iA))
}}iy=ix
}if(iw){iz.push(iz[0])
}iC=iA
}return iz
};
function I(iu,it,ir){return(ir[0]-it[0])*(iu[1]-it[1])<(ir[1]-it[1])*(iu[0]-it[0])
}function gz(iy,iw,iC,iz){var iu=iy[0],ir=iC[0],iv=iw[0]-iu,iD=iz[0]-ir,iB=iy[1],ix=iC[1],iA=iw[1]-iB,iE=iz[1]-ix,it=(iD*(iB-ix)-iE*(iu-ir))/(iE*iv-iD*iA);
return[iu+it*iv,iB+it*iA]
}function g5(iu){var it=iu[0],ir=iu[iu.length-1];
return !(it[0]-ir[0]||it[1]-ir[1])
}var g1,eK,cY,dm=[],hp,ee,eE=[];
function gQ(){v(this);
this.edge=this.site=this.circle=null
}function e9(it){var ir=dm.pop()||new gQ();
ir.site=it;
return ir
}function gP(ir){eX(ir);
cY.remove(ir);
dm.push(ir);
v(ir)
}function hA(it){var ir=it.circle,iB=ir.x,iy=ir.cy,iw={x:iB,y:iy},ix=it.P,iv=it.N,iA=[it];
gP(it);
var iD=ix;
while(iD.circle&&cN(iB-iD.circle.x)<gB&&cN(iy-iD.circle.cy)<gB){ix=iD.P;
iA.unshift(iD);
gP(iD);
iD=ix
}iA.unshift(iD);
eX(iD);
var iu=iv;
while(iu.circle&&cN(iB-iu.circle.x)<gB&&cN(iy-iu.circle.cy)<gB){iv=iu.N;
iA.push(iu);
gP(iu);
iu=iv
}iA.push(iu);
eX(iu);
var iC=iA.length,iz;
for(iz=1;
iz<iC;
++iz){iu=iA[iz];
iD=iA[iz-1];
cu(iu.edge,iD.site,iu.site,iw)
}iD=iA[0];
iu=iA[iC-1];
iu.edge=hv(iD.site,iu.site,null,iw);
ad(iD);
ad(iu)
}function dD(iC){var iA=iC.x,iE=iC.y,iG,iD,iM,iH,iF=cY._;
while(iF){iM=dg(iF,iE)-iA;
if(iM>gB){iF=iF.L
}else{iH=iA-gs(iF,iE);
if(iH>gB){if(!iF.R){iG=iF;
break
}iF=iF.R
}else{if(iM>-gB){iG=iF.P;
iD=iF
}else{if(iH>-gB){iG=iF;
iD=iF.N
}else{iG=iD=iF
}}break
}}}var iv=e9(iC);
cY.insert(iG,iv);
if(!iG&&!iD){return
}if(iG===iD){eX(iG);
iD=e9(iG.site);
cY.insert(iv,iD);
iv.edge=iD.edge=hv(iG.site,iv.site);
ad(iG);
ad(iD);
return
}if(!iD){iv.edge=hv(iG.site,iv.site);
return
}eX(iG);
eX(iD);
var iy=iG.site,iB=iy.x,iz=iy.y,iK=iC.x-iB,iI=iC.y-iz,ir=iD.site,iu=ir.x-iB,it=ir.y-iz,iL=2*(iK*it-iI*iu),ix=iK*iK+iI*iI,iw=iu*iu+it*it,iJ={x:(it*ix-iI*iw)/iL+iB,y:(iK*iw-iu*ix)/iL+iz};
cu(iD.edge,iy,ir,iJ);
iv.edge=hv(iy,iC,null,iJ);
iD.edge=hv(iC,ir,null,iJ);
ad(iG);
ad(iD)
}function dg(iv,iw){var ir=iv.site,iD=ir.x,iC=ir.y,iB=iC-iw;
if(!iB){return iD
}var iE=iv.P;
if(!iE){return -Infinity
}ir=iE.site;
var iy=ir.x,ix=ir.y,iu=ix-iw;
if(!iu){return iy
}var it=iy-iD,iA=1/iB-1/iu,iz=it/iu;
if(iA){return(-iz+Math.sqrt(iz*iz-2*iA*(it*it/(-2*iu)-ix+iu/2+iC-iB/2)))/iA+iD
}return(iD+iy)/2
}function gs(it,iu){var iv=it.N;
if(iv){return dg(iv,iu)
}var ir=it.site;
return ir.y===iu?ir.x:Infinity
}function b1(ir){this.site=ir;
this.edges=[]
}b1.prototype.prepare=function(){var iu=this.edges,ir=iu.length,it;
while(ir--){it=iu[ir].edge;
if(!it.b||!it.a){iu.splice(ir,1)
}}iu.sort(w);
return iu.length
};
function bC(iI){var iy=iI[0][0],ix=iI[1][0],iE=iI[0][1],iD=iI[1][1],iv,iC,ir,iB,iH=eK,iu=iH.length,iG,iF,iA,it,iw,iz;
while(iu--){iG=iH[iu];
if(!iG||!iG.prepare()){continue
}iA=iG.edges;
it=iA.length;
iF=0;
while(iF<it){iz=iA[iF].end(),ir=iz.x,iB=iz.y;
iw=iA[++iF%it].start(),iv=iw.x,iC=iw.y;
if(cN(ir-iv)>gB||cN(iB-iC)>gB){iA.splice(iF,0,new id(hk(iG.site,iz,cN(ir-iy)<gB&&iD-iB>gB?{x:iy,y:cN(iv-iy)<gB?iC:iD}:cN(iB-iD)<gB&&ix-ir>gB?{x:cN(iC-iD)<gB?iv:ix,y:iD}:cN(ir-ix)<gB&&iB-iE>gB?{x:ix,y:cN(iv-ix)<gB?iC:iE}:cN(iB-iE)<gB&&ir-iy>gB?{x:cN(iC-iE)<gB?iv:iy,y:iE}:null),iG.site,null));
++it
}}}}function w(it,ir){return ir.angle-it.angle
}function a1(){v(this);
this.x=this.y=this.arc=this.site=this.cy=null
}function ad(iy){var iH=iy.P,iF=iy.N;
if(!iH||!iF){return
}var iA=iH.site,iK=iy.site,ir=iF.site;
if(iA===ir){return
}var iJ=iK.x,iI=iK.y,iD=iA.x-iJ,iB=iA.y-iI,iu=ir.x-iJ,it=ir.y-iI;
var iL=2*(iD*it-iB*iu);
if(iL>=-eO){return
}var ix=iD*iD+iB*iB,iw=iu*iu+it*it,iC=(it*ix-iB*iw)/iL,iz=(iD*iw-iu*ix)/iL,it=iz+iI;
var iv=eE.pop()||new a1();
iv.arc=iy;
iv.site=iK;
iv.x=iC+iJ;
iv.y=it+Math.sqrt(iC*iC+iz*iz);
iv.cy=it;
iy.circle=iv;
var iE=null,iG=ee._;
while(iG){if(iv.y<iG.y||iv.y===iG.y&&iv.x<=iG.x){if(iG.L){iG=iG.L
}else{iE=iG.P;
break
}}else{if(iG.R){iG=iG.R
}else{iE=iG;
break
}}}ee.insert(iE,iv);
if(!iE){hp=iv
}}function eX(ir){var it=ir.circle;
if(it){if(!it.P){hp=it.N
}ee.remove(it);
eE.push(it);
v(it);
ir.circle=null
}}function hN(iu){var ir=g1,iv=ar(iu[0][0],iu[0][1],iu[1][0],iu[1][1]),it=ir.length,iw;
while(it--){iw=ir[it];
if(!bs(iw,iu)||!iv(iw)||cN(iw.a.x-iw.b.x)<gB&&cN(iw.a.y-iw.b.y)<gB){iw.a=iw.b=null;
ir.splice(it,1)
}}}function bs(iD,iG){var ir=iD.b;
if(ir){return true
}var it=iD.a,iJ=iG[0][0],iI=iG[1][0],ix=iG[0][1],iv=iG[1][1],iF=iD.l,iu=iD.r,iA=iF.x,iz=iF.y,iC=iu.x,iB=iu.y,iy=(iA+iC)/2,iw=(iz+iB)/2,iE,iH;
if(iB===iz){if(iy<iJ||iy>=iI){return
}if(iA>iC){if(!it){it={x:iy,y:ix}
}else{if(it.y>=iv){return
}}ir={x:iy,y:iv}
}else{if(!it){it={x:iy,y:iv}
}else{if(it.y<ix){return
}}ir={x:iy,y:ix}
}}else{iE=(iA-iC)/(iB-iz);
iH=iw-iE*iy;
if(iE<-1||iE>1){if(iA>iC){if(!it){it={x:(ix-iH)/iE,y:ix}
}else{if(it.y>=iv){return
}}ir={x:(iv-iH)/iE,y:iv}
}else{if(!it){it={x:(iv-iH)/iE,y:iv}
}else{if(it.y<ix){return
}}ir={x:(ix-iH)/iE,y:ix}
}}else{if(iz<iB){if(!it){it={x:iJ,y:iE*iJ+iH}
}else{if(it.x>=iI){return
}}ir={x:iI,y:iE*iI+iH}
}else{if(!it){it={x:iI,y:iE*iI+iH}
}else{if(it.x<iJ){return
}}ir={x:iJ,y:iE*iJ+iH}
}}}iD.a=it;
iD.b=ir;
return true
}function L(it,ir){this.l=it;
this.r=ir;
this.a=this.b=null
}function hv(iw,ir,iv,it){var iu=new L(iw,ir);
g1.push(iu);
if(iv){cu(iu,iw,ir,iv)
}if(it){cu(iu,ir,iw,it)
}eK[iw.i].edges.push(new id(iu,iw,ir));
eK[ir.i].edges.push(new id(iu,ir,iw));
return iu
}function hk(iv,iu,ir){var it=new L(iv,null);
it.a=iu;
it.b=ir;
g1.push(it);
return it
}function cu(it,iv,ir,iu){if(!it.a&&!it.b){it.a=iu;
it.l=iv;
it.r=ir
}else{if(it.l===ir){it.b=iu
}else{it.a=iu
}}}function id(iv,iw,ir){var iu=iv.a,it=iv.b;
this.edge=iv;
this.site=iw;
this.angle=ir?Math.atan2(ir.y-iw.y,ir.x-iw.x):iv.l===iw?Math.atan2(it.x-iu.x,iu.y-it.y):Math.atan2(iu.x-it.x,it.y-iu.y)
}id.prototype={start:function(){return this.edge.l===this.site?this.edge.a:this.edge.b
},end:function(){return this.edge.l===this.site?this.edge.b:this.edge.a
}};
function bf(){this._=null
}function v(ir){ir.U=ir.C=ir.L=ir.R=ir.P=ir.N=null
}bf.prototype={insert:function(iw,iv){var iu,it,ir;
if(iw){iv.P=iw;
iv.N=iw.N;
if(iw.N){iw.N.P=iv
}iw.N=iv;
if(iw.R){iw=iw.R;
while(iw.L){iw=iw.L
}iw.L=iv
}else{iw.R=iv
}iu=iw
}else{if(this._){iw=dk(this._);
iv.P=null;
iv.N=iw;
iw.P=iw.L=iv;
iu=iw
}else{iv.P=iv.N=null;
this._=iv;
iu=null
}}iv.L=iv.R=null;
iv.U=iu;
iv.C=true;
iw=iv;
while(iu&&iu.C){it=iu.U;
if(iu===it.L){ir=it.R;
if(ir&&ir.C){iu.C=ir.C=false;
it.C=true;
iw=it
}else{if(iw===iu.R){ap(this,iu);
iw=iu;
iu=iw.U
}iu.C=false;
it.C=true;
e1(this,it)
}}else{ir=it.L;
if(ir&&ir.C){iu.C=ir.C=false;
it.C=true;
iw=it
}else{if(iw===iu.L){e1(this,iu);
iw=iu;
iu=iw.U
}iu.C=false;
it.C=true;
ap(this,it)
}}iu=iw.U
}this._.C=false
},remove:function(iw){if(iw.N){iw.N.P=iw.P
}if(iw.P){iw.P.N=iw.N
}iw.N=iw.P=null;
var iv=iw.U,iu,iy=iw.L,ir=iw.R,it,ix;
if(!iy){it=ir
}else{if(!ir){it=iy
}else{it=dk(ir)
}}if(iv){if(iv.L===iw){iv.L=it
}else{iv.R=it
}}else{this._=it
}if(iy&&ir){ix=it.C;
it.C=iw.C;
it.L=iy;
iy.U=it;
if(it!==ir){iv=it.U;
it.U=iw.U;
iw=it.R;
iv.L=iw;
it.R=ir;
ir.U=it
}else{it.U=iv;
iv=it;
iw=it.R
}}else{ix=iw.C;
iw=it
}if(iw){iw.U=iv
}if(ix){return
}if(iw&&iw.C){iw.C=false;
return
}do{if(iw===this._){break
}if(iw===iv.L){iu=iv.R;
if(iu.C){iu.C=false;
iv.C=true;
ap(this,iv);
iu=iv.R
}if(iu.L&&iu.L.C||iu.R&&iu.R.C){if(!iu.R||!iu.R.C){iu.L.C=false;
iu.C=true;
e1(this,iu);
iu=iv.R
}iu.C=iv.C;
iv.C=iu.R.C=false;
ap(this,iv);
iw=this._;
break
}}else{iu=iv.L;
if(iu.C){iu.C=false;
iv.C=true;
e1(this,iv);
iu=iv.L
}if(iu.L&&iu.L.C||iu.R&&iu.R.C){if(!iu.L||!iu.L.C){iu.R.C=false;
iu.C=true;
ap(this,iu);
iu=iv.L
}iu.C=iv.C;
iv.C=iu.L.C=false;
e1(this,iv);
iw=this._;
break
}}iu.C=true;
iw=iv;
iv=iv.U
}while(!iw.C);
if(iw){iw.C=false
}}};
function ap(ir,iu){var iw=iu,iv=iu.R,it=iw.U;
if(it){if(it.L===iw){it.L=iv
}else{it.R=iv
}}else{ir._=iv
}iv.U=it;
iw.U=iv;
iw.R=iv.L;
if(iw.R){iw.R.U=iw
}iv.L=iw
}function e1(ir,iu){var iw=iu,iv=iu.L,it=iw.U;
if(it){if(it.L===iw){it.L=iv
}else{it.R=iv
}}else{ir._=iv
}iv.U=it;
iw.U=iv;
iw.L=iv.R;
if(iw.L){iw.L.U=iw
}iv.R=iw
}function dk(ir){while(ir.L){ir=ir.L
}return ir
}function he(ix,iy){var it=ix.sort(bp).pop(),iu,iv,iw;
g1=[];
eK=new Array(ix.length);
cY=new bf();
ee=new bf();
while(true){iw=hp;
if(it&&(!iw||it.y<iw.y||it.y===iw.y&&it.x<iw.x)){if(it.x!==iu||it.y!==iv){eK[it.i]=new b1(it);
dD(it);
iu=it.x,iv=it.y
}it=ix.pop()
}else{if(iw){hA(iw.arc)
}else{break
}}}if(iy){hN(iy),bC(iy)
}var ir={cells:eK,edges:g1};
cY=ee=g1=eK=null;
return ir
}function bp(it,ir){return ir.y-it.y||ir.x-it.x
}hy.geom.voronoi=function(iv){var ir=h6,iz=h5,iw=ir,iu=iz,it=hQ;
if(iv){return iy(iv)
}function iy(iF){var iA=new Array(iF.length),iC=it[0][0],iE=it[0][1],iB=it[1][0],iD=it[1][1];
he(ix(iF),it).cells.forEach(function(iG,iK){var iH=iG.edges,iI=iG.site,iJ=iA[iK]=iH.length?iH.map(function(iM){var iL=iM.start();
return[iL.x,iL.y]
}):iI.x>=iC&&iI.x<=iB&&iI.y>=iE&&iI.y<=iD?[[iC,iD],[iB,iD],[iB,iE],[iC,iE]]:[];
iJ.point=iF[iK]
});
return iA
}function ix(iA){return iA.map(function(iC,iB){return{x:Math.round(iw(iC,iB)/gB)*gB,y:Math.round(iu(iC,iB)/gB)*gB,i:iB}
})
}iy.links=function(iA){return he(ix(iA)).edges.filter(function(iB){return iB.l&&iB.r
}).map(function(iB){return{source:iA[iB.l.i],target:iA[iB.r.i]}
})
};
iy.triangles=function(iB){var iA=[];
he(ix(iB)).cells.forEach(function(iK,iG){var iC=iK.site,iF=iK.edges.sort(w),iE=-1,iD=iF.length,iI,iL,iH=iF[iD-1].edge,iJ=iH.l===iC?iH.r:iH.l;
while(++iE<iD){iI=iH;
iL=iJ;
iH=iF[iE].edge;
iJ=iH.l===iC?iH.r:iH.l;
if(iG<iL.i&&iG<iJ.i&&gO(iC,iL,iJ)<0){iA.push([iB[iG],iB[iL.i],iB[iJ.i]])
}}});
return iA
};
iy.x=function(iA){return arguments.length?(iw=Y(ir=iA),iy):ir
};
iy.y=function(iA){return arguments.length?(iu=Y(iz=iA),iy):iz
};
iy.clipExtent=function(iA){if(!arguments.length){return it===hQ?null:it
}it=iA==null?hQ:iA;
return iy
};
iy.size=function(iA){if(!arguments.length){return it===hQ?null:it&&it[1]
}return iy.clipExtent(iA&&[[0,0],iA])
};
return iy
};
var hQ=[[-1000000,-1000000],[1000000,1000000]];
function gO(it,ir,iu){return(it.x-iu.x)*(ir.y-it.y)-(it.x-ir.x)*(iu.y-it.y)
}hy.geom.delaunay=function(ir){return hy.geom.voronoi().triangles(ir)
};
hy.geom.quadtree=function(iz,it,ix,ir,iw){var iy=h6,iv=h5,iA;
if(iA=arguments.length){iy=gi;
iv=gh;
if(iA===3){iw=ix;
ir=it;
ix=it=0
}return iu(iz)
}function iu(iT){var iQ,iF=Y(iy),iD=Y(iv),iH,iN,iO,iL,iB,iK,iG,iS;
if(it!=null){iB=it,iK=ix,iG=ir,iS=iw
}else{iG=iS=-(iB=iK=Infinity);
iH=[],iN=[];
iL=iT.length;
if(iA){for(iO=0;
iO<iL;
++iO){iQ=iT[iO];
if(iQ.x<iB){iB=iQ.x
}if(iQ.y<iK){iK=iQ.y
}if(iQ.x>iG){iG=iQ.x
}if(iQ.y>iS){iS=iQ.y
}iH.push(iQ.x);
iN.push(iQ.y)
}}else{for(iO=0;
iO<iL;
++iO){var iP=+iF(iQ=iT[iO],iO),iE=+iD(iQ,iO);
if(iP<iB){iB=iP
}if(iE<iK){iK=iE
}if(iP>iG){iG=iP
}if(iE>iS){iS=iE
}iH.push(iP);
iN.push(iE)
}}}var iJ=iG-iB,iI=iS-iK;
if(iJ>iI){iS=iK+iJ
}else{iG=iB+iI
}function iC(iW,i0,i4,i1,iV,i3,iU,i2){if(isNaN(i4)||isNaN(i1)){return
}if(iW.leaf){var iZ=iW.x,iY=iW.y;
if(iZ!=null){if(cN(iZ-i4)+cN(iY-i1)<0.01){iR(iW,i0,i4,i1,iV,i3,iU,i2)
}else{var iX=iW.point;
iW.x=iW.y=iW.point=null;
iR(iW,iX,iZ,iY,iV,i3,iU,i2);
iR(iW,i0,i4,i1,iV,i3,iU,i2)
}}else{iW.x=i4,iW.y=i1,iW.point=i0
}}else{iR(iW,i0,i4,i1,iV,i3,iU,i2)
}}function iR(iX,iZ,i5,i1,iW,i4,iV,i2){var i3=(iW+iV)*0.5,i0=(i4+i2)*0.5,i6=i5>=i3,iU=i1>=i0,iY=(iU<<1)+i6;
iX.leaf=false;
iX=iX.nodes[iY]||(iX.nodes[iY]=fX());
if(i6){iW=i3
}else{iV=i3
}if(iU){i4=i0
}else{i2=i0
}iC(iX,iZ,i5,i1,iW,i4,iV,i2)
}var iM=fX();
iM.add=function(iU){iC(iM,iU,+iF(iU,++iO),+iD(iU,iO),iB,iK,iG,iS)
};
iM.visit=function(iU){cT(iU,iM,iB,iK,iG,iS)
};
iO=-1;
if(it==null){while(++iO<iL){iC(iM,iT[iO],iH[iO],iN[iO],iB,iK,iG,iS)
}--iO
}else{iT.forEach(iM.add)
}iH=iN=iT=iQ=null;
return iM
}iu.x=function(iB){return arguments.length?(iy=iB,iu):iy
};
iu.y=function(iB){return arguments.length?(iv=iB,iu):iv
};
iu.extent=function(iB){if(!arguments.length){return it==null?null:[[it,ix],[ir,iw]]
}if(iB==null){it=ix=ir=iw=null
}else{it=+iB[0][0],ix=+iB[0][1],ir=+iB[1][0],iw=+iB[1][1]
}return iu
};
iu.size=function(iB){if(!arguments.length){return it==null?null:[ir-it,iw-ix]
}if(iB==null){it=ix=ir=iw=null
}else{it=ix=0,ir=+iB[0],iw=+iB[1]
}return iu
};
return iu
};
function gi(ir){return ir.x
}function gh(ir){return ir.y
}function fX(){return{leaf:true,nodes:[],point:null,x:null,y:null}
}function cT(iw,iv,it,iA,ir,iy){if(!iw(iv,it,iA,ir,iy)){var iz=(it+ir)*0.5,ix=(iA+iy)*0.5,iu=iv.nodes;
if(iu[0]){cT(iw,iu[0],it,iA,iz,ix)
}if(iu[1]){cT(iw,iu[1],iz,iA,ir,ix)
}if(iu[2]){cT(iw,iu[2],it,ix,iz,iy)
}if(iu[3]){cT(iw,iu[3],iz,ix,ir,iy)
}}}hy.interpolateRgb=aU;
function aU(it,ir){it=hy.rgb(it);
ir=hy.rgb(ir);
var iv=it.r,iu=it.g,iy=it.b,ix=ir.r-iv,iw=ir.g-iu,iz=ir.b-iy;
return function(iA){return"#"+cC(Math.round(iv+ix*iA))+cC(Math.round(iu+iw*iA))+cC(Math.round(iy+iz*iA))
}
}hy.interpolateObject=bQ;
function bQ(it,ir){var iv={},iw={},iu;
for(iu in it){if(iu in ir){iv[iu]=fS(it[iu],ir[iu])
}else{iw[iu]=it[iu]
}}for(iu in ir){if(!(iu in it)){iw[iu]=ir[iu]
}}return function(ix){for(iu in iv){iw[iu]=iv[iu](ix)
}return iw
}
}hy.interpolateNumber=bJ;
function bJ(it,ir){ir-=it=+it;
return function(iu){return it+ir*iu
}
}hy.interpolateString=b4;
function b4(iz,iy){var iv,ix,iw,iB=0,iA=0,iC=[],ir=[],iu,it;
iz=iz+"",iy=iy+"";
f7.lastIndex=0;
for(ix=0;
iv=f7.exec(iy);
++ix){if(iv.index){iC.push(iy.substring(iB,iA=iv.index))
}ir.push({i:iC.length,x:iv[0]});
iC.push(null);
iB=f7.lastIndex
}if(iB<iy.length){iC.push(iy.substring(iB))
}for(ix=0,iu=ir.length;
(iv=f7.exec(iz))&&ix<iu;
++ix){it=ir[ix];
if(it.x==iv[0]){if(it.i){if(iC[it.i+1]==null){iC[it.i-1]+=it.x;
iC.splice(it.i,1);
for(iw=ix+1;
iw<iu;
++iw){ir[iw].i--
}}else{iC[it.i-1]+=it.x+iC[it.i+1];
iC.splice(it.i,2);
for(iw=ix+1;
iw<iu;
++iw){ir[iw].i-=2
}}}else{if(iC[it.i+1]==null){iC[it.i]=it.x
}else{iC[it.i]=it.x+iC[it.i+1];
iC.splice(it.i+1,1);
for(iw=ix+1;
iw<iu;
++iw){ir[iw].i--
}}}ir.splice(ix,1);
iu--;
ix--
}else{it.x=bJ(parseFloat(iv[0]),parseFloat(it.x))
}}while(ix<iu){it=ir.pop();
if(iC[it.i+1]==null){iC[it.i]=it.x
}else{iC[it.i]=it.x+iC[it.i+1];
iC.splice(it.i+1,1)
}iu--
}if(iC.length===1){return iC[0]==null?(it=ir[0].x,function(iD){return it(iD)+""
}):function(){return iy
}
}return function(iD){for(ix=0;
ix<iu;
++ix){iC[(it=ir[ix]).i]=it.x(iD)
}return iC.join("")
}
}var f7=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;
hy.interpolate=fS;
function fS(it,ir){var iu=hy.interpolators.length,iv;
while(--iu>=0&&!(iv=hy.interpolators[iu](it,ir))){}return iv
}hy.interpolators=[function(it,ir){var iu=typeof ir;
return(iu==="string"?au.has(ir)||/^(#|rgb\(|hsl\()/.test(ir)?aU:b4:ir instanceof M?aU:iu==="object"?Array.isArray(ir)?eZ:bQ:bJ)(it,ir)
}];
hy.interpolateArray=eZ;
function eZ(iw,iu){var it=[],iz=[],iv=iw.length,ir=iu.length,iy=Math.min(iw.length,iu.length),ix;
for(ix=0;
ix<iy;
++ix){it.push(fS(iw[ix],iu[ix]))
}for(;
ix<iv;
++ix){iz[ix]=iw[ix]
}for(;
ix<ir;
++ix){iz[ix]=iu[ix]
}return function(iA){for(ix=0;
ix<iy;
++ix){iz[ix]=it[ix](iA)
}return iz
}
}var hu=function(){return gy
};
var ai=hy.map({linear:hu,poly:aY,quad:function(){return b2
},cubic:function(){return O
},sin:function(){return gq
},exp:function(){return fJ
},circle:function(){return eh
},elastic:ac,back:hb,bounce:function(){return cp
}});
var l=hy.map({"in":gy,out:H,"in-out":a7,"out-in":function(ir){return a7(H(ir))
}});
hy.ease=function(it){var iv=it.indexOf("-"),iu=iv>=0?it.substring(0,iv):it,ir=iv>=0?it.substring(iv+1):"in";
iu=ai.get(iu)||hu;
ir=l.get(ir)||gy;
return fP(ir(iu.apply(null,bS.call(arguments,1))))
};
function fP(ir){return function(it){return it<=0?0:it>=1?1:ir(it)
}
}function H(ir){return function(it){return 1-ir(1-it)
}
}function a7(ir){return function(it){return 0.5*(it<0.5?ir(2*it):2-ir(2-2*it))
}
}function b2(ir){return ir*ir
}function O(ir){return ir*ir*ir
}function aC(it){if(it<=0){return 0
}if(it>=1){return 1
}var iu=it*it,ir=iu*it;
return 4*(it<0.5?ir:3*(it-iu)+ir-0.75)
}function aY(ir){return function(it){return Math.pow(it,ir)
}
}function gq(ir){return 1-Math.cos(ir*eA)
}function fJ(ir){return Math.pow(2,10*(ir-1))
}function eh(ir){return 1-Math.sqrt(1-ir*ir)
}function ac(ir,iu){var it;
if(arguments.length<2){iu=0.45
}if(arguments.length){it=iu/gm*Math.asin(1/ir)
}else{ir=1,it=iu/4
}return function(iv){return 1+ir*Math.pow(2,-10*iv)*Math.sin((iv-it)*gm/iu)
}
}function hb(ir){if(!ir){ir=1.70158
}return function(it){return it*it*((ir+1)*it-ir)
}
}function cp(ir){return ir<1/2.75?7.5625*ir*ir:ir<2/2.75?7.5625*(ir-=1.5/2.75)*ir+0.75:ir<2.5/2.75?7.5625*(ir-=2.25/2.75)*ir+0.9375:7.5625*(ir-=2.625/2.75)*ir+0.984375
}hy.interpolateHcl=g3;
function g3(iu,ir){iu=hy.hcl(iu);
ir=hy.hcl(ir);
var it=iu.h,iw=iu.c,iy=iu.l,iv=ir.h-it,ix=ir.c-iw,iz=ir.l-iy;
if(isNaN(ix)){ix=0,iw=isNaN(iw)?ir.c:iw
}if(isNaN(iv)){iv=0,it=isNaN(it)?ir.h:it
}else{if(iv>180){iv-=360
}else{if(iv<-180){iv+=360
}}}return function(iA){return bG(it+iv*iA,iw+ix*iA,iy+iz*iA)+""
}
}hy.interpolateHsl=a8;
function a8(iv,ir){iv=hy.hsl(iv);
ir=hy.hsl(ir);
var iu=iv.h,it=iv.s,iy=iv.l,ix=ir.h-iu,iw=ir.s-it,iz=ir.l-iy;
if(isNaN(iw)){iw=0,it=isNaN(it)?ir.s:it
}if(isNaN(ix)){ix=0,iu=isNaN(iu)?ir.h:iu
}else{if(ix>180){ix-=360
}else{if(ix<-180){ix+=360
}}}return function(iA){return bl(iu+ix*iA,it+iw*iA,iy+iz*iA)+""
}
}hy.interpolateLab=hJ;
function hJ(it,ir){it=hy.lab(it);
ir=hy.lab(ir);
var iw=it.l,iv=it.a,iu=it.b,iz=ir.l-iw,iy=ir.a-iv,ix=ir.b-iu;
return function(iA){return aH(iw+iz*iA,iv+iy*iA,iu+ix*iA)+""
}
}hy.interpolateRound=fN;
function fN(it,ir){ir-=it;
return function(iu){return Math.round(it+ir*iu)
}
}hy.transform=function(ir){var it=bR.createElementNS(hy.ns.prefix.svg,"g");
return(hy.transform=function(iu){if(iu!=null){it.setAttribute("transform",iu);
var iv=it.transform.baseVal.consolidate()
}return new q(iv?iv.matrix:gn)
})(ir)
};
function q(ir){var iv=[ir.a,ir.b],it=[ir.c,ir.d],ix=fE(iv),iu=fa(iv,it),iw=fE(bW(it,iv,-iu))||0;
if(iv[0]*it[1]<it[0]*iv[1]){iv[0]*=-1;
iv[1]*=-1;
ix*=-1;
iu*=-1
}this.rotate=(ix?Math.atan2(iv[1],iv[0]):Math.atan2(-it[0],it[1]))*hO;
this.translate=[ir.e,ir.f];
this.scale=[ix,iw];
this.skew=iw?Math.atan2(iu,iw)*hO:0
}q.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"
};
function fa(it,ir){return it[0]*ir[0]+it[1]*ir[1]
}function fE(ir){var it=Math.sqrt(fa(ir,ir));
if(it){ir[0]/=it;
ir[1]/=it
}return it
}function bW(it,ir,iu){it[0]+=iu*ir[0];
it[1]+=iu*ir[1];
return it
}var gn={a:1,b:0,c:0,d:1,e:0,f:0};
hy.interpolateTransform=et;
function et(iF,iE){var iG=[],it=[],ix,iw=hy.transform(iF),iv=hy.transform(iE),iB=iw.translate,iA=iv.translate,iu=iw.rotate,ir=iv.rotate,iz=iw.skew,iy=iv.skew,iD=iw.scale,iC=iv.scale;
if(iB[0]!=iA[0]||iB[1]!=iA[1]){iG.push("translate(",null,",",null,")");
it.push({i:1,x:bJ(iB[0],iA[0])},{i:3,x:bJ(iB[1],iA[1])})
}else{if(iA[0]||iA[1]){iG.push("translate("+iA+")")
}else{iG.push("")
}}if(iu!=ir){if(iu-ir>180){ir+=360
}else{if(ir-iu>180){iu+=360
}}it.push({i:iG.push(iG.pop()+"rotate(",null,")")-2,x:bJ(iu,ir)})
}else{if(ir){iG.push(iG.pop()+"rotate("+ir+")")
}}if(iz!=iy){it.push({i:iG.push(iG.pop()+"skewX(",null,")")-2,x:bJ(iz,iy)})
}else{if(iy){iG.push(iG.pop()+"skewX("+iy+")")
}}if(iD[0]!=iC[0]||iD[1]!=iC[1]){ix=iG.push(iG.pop()+"scale(",null,",",null,")");
it.push({i:ix-4,x:bJ(iD[0],iC[0])},{i:ix-2,x:bJ(iD[1],iC[1])})
}else{if(iC[0]!=1||iC[1]!=1){iG.push(iG.pop()+"scale("+iC+")")
}}ix=it.length;
return function(iI){var iH=-1,iJ;
while(++iH<ix){iG[(iJ=it[iH]).i]=iJ.x(iI)
}return iG.join("")
}
}function hG(it,ir){ir=ir-(it=+it)?1/(ir-it):0;
return function(iu){return(iu-it)*ir
}
}function aF(it,ir){ir=ir-(it=+it)?1/(ir-it):0;
return function(iu){return Math.max(0,Math.min(1,(iu-it)*ir))
}
}hy.layout={};
hy.layout.bundle=function(){return function(ir){var iu=[],it=-1,iv=ir.length;
while(++it<iv){iu.push(eV(ir[it]))
}return iu
}
};
function eV(iv){var ix=iv.source,ir=iv.target,iw=f0(ix,ir),iu=[ix];
while(ix!==iw){ix=ix.parent;
iu.push(ix)
}var it=iu.length;
while(ir!==iw){iu.splice(it,0,ir);
ir=ir.parent
}return iu
}function fD(iu){var it=[],ir=iu.parent;
while(ir!=null){it.push(iu);
iu=ir;
ir=ir.parent
}it.push(iu);
return it
}function f0(iv,it){if(iv===it){return iv
}var iu=fD(iv),ir=fD(it),iw=iu.pop(),ix=ir.pop(),iy=null;
while(iw===ix){iy=iw;
iw=iu.pop();
ix=ir.pop()
}return iy
}hy.layout.chord=function(){var ix={},iy,iv,iC,iu,iB=0,ir,it,iw;
function iA(){var iH={},iK=[],iS=hy.range(iu),iO=[],iI,iQ,iG,iL,iJ;
iy=[];
iv=[];
iI=0,iL=-1;
while(++iL<iu){iQ=0,iJ=-1;
while(++iJ<iu){iQ+=iC[iL][iJ]
}iK.push(iQ);
iO.push(hy.range(iu));
iI+=iQ
}if(ir){iS.sort(function(iU,iT){return ir(iK[iU],iK[iT])
})
}if(it){iO.forEach(function(iU,iT){iU.sort(function(iW,iV){return it(iC[iT][iW],iC[iT][iV])
})
})
}iI=(gm-iB*iu)/iI;
iQ=0,iL=-1;
while(++iL<iu){iG=iQ,iJ=-1;
while(++iJ<iu){var iP=iS[iL],iN=iO[iP][iJ],iR=iC[iP][iN],iF=iQ,iE=iQ+=iR*iI;
iH[iP+"-"+iN]={index:iP,subindex:iN,startAngle:iF,endAngle:iE,value:iR}
}iv[iP]={index:iP,startAngle:iG,endAngle:iQ,value:(iQ-iG)/iI};
iQ+=iB
}iL=-1;
while(++iL<iu){iJ=iL-1;
while(++iJ<iu){var iD=iH[iL+"-"+iJ],iM=iH[iJ+"-"+iL];
if(iD.value||iM.value){iy.push(iD.value<iM.value?{source:iM,target:iD}:{source:iD,target:iM})
}}}if(iw){iz()
}}function iz(){iy.sort(function(iE,iD){return iw((iE.source.value+iE.target.value)/2,(iD.source.value+iD.target.value)/2)
})
}ix.matrix=function(iD){if(!arguments.length){return iC
}iu=(iC=iD)&&iC.length;
iy=iv=null;
return ix
};
ix.padding=function(iD){if(!arguments.length){return iB
}iB=iD;
iy=iv=null;
return ix
};
ix.sortGroups=function(iD){if(!arguments.length){return ir
}ir=iD;
iy=iv=null;
return ix
};
ix.sortSubgroups=function(iD){if(!arguments.length){return it
}it=iD;
iy=null;
return ix
};
ix.sortChords=function(iD){if(!arguments.length){return iw
}iw=iD;
if(iy){iz()
}return ix
};
ix.chords=function(){if(!iy){iA()
}return iy
};
ix.groups=function(){if(!iv){iA()
}return iv
};
return ix
};
hy.layout.force=function(){var it={},iG=hy.dispatch("start","tick","end"),iC=[1,1],iI,iw,iz=0.9,iJ=f6,iv=cz,iF=-30,ix=0.1,iA=0.8,iE=[],iu=[],iy,ir,iB;
function iH(iK){return function(iN,iS,iR,iQ){if(iN.point!==iK){var iP=iN.cx-iK.x,iM=iN.cy-iK.y,iL=1/Math.sqrt(iP*iP+iM*iM);
if((iQ-iS)*iL<iA){var iO=iN.charge*iL*iL;
iK.px-=iP*iO;
iK.py-=iM*iO;
return true
}if(iN.point&&isFinite(iL)){var iO=iN.pointCharge*iL*iL;
iK.px-=iP*iO;
iK.py-=iM*iO
}}return !iN.charge
}
}it.tick=function(){if((iw*=0.99)<0.005){iG.end({type:"end",alpha:iw=0});
return true
}var iM=iE.length,iN=iu.length,iK,iQ,iL,iU,iT,iO,iP,iS,iR;
for(iQ=0;
iQ<iN;
++iQ){iL=iu[iQ];
iU=iL.source;
iT=iL.target;
iS=iT.x-iU.x;
iR=iT.y-iU.y;
if(iO=iS*iS+iR*iR){iO=iw*ir[iQ]*((iO=Math.sqrt(iO))-iy[iQ])/iO;
iS*=iO;
iR*=iO;
iT.x-=iS*(iP=iU.weight/(iT.weight+iU.weight));
iT.y-=iR*iP;
iU.x+=iS*(iP=1-iP);
iU.y+=iR*iP
}}if(iP=iw*ix){iS=iC[0]/2;
iR=iC[1]/2;
iQ=-1;
if(iP){while(++iQ<iM){iL=iE[iQ];
iL.x+=(iS-iL.x)*iP;
iL.y+=(iR-iL.y)*iP
}}}if(iF){gN(iK=hy.geom.quadtree(iE),iw,iB);
iQ=-1;
while(++iQ<iM){if(!(iL=iE[iQ]).fixed){iK.visit(iH(iL))
}}}iQ=-1;
while(++iQ<iM){iL=iE[iQ];
if(iL.fixed){iL.x=iL.px;
iL.y=iL.py
}else{iL.x-=(iL.px-(iL.px=iL.x))*iz;
iL.y-=(iL.py-(iL.py=iL.y))*iz
}}iG.tick({type:"tick",alpha:iw})
};
it.nodes=function(iK){if(!arguments.length){return iE
}iE=iK;
return it
};
it.links=function(iK){if(!arguments.length){return iu
}iu=iK;
return it
};
it.size=function(iK){if(!arguments.length){return iC
}iC=iK;
return it
};
it.linkDistance=function(iK){if(!arguments.length){return iJ
}iJ=typeof iK==="function"?iK:+iK;
return it
};
it.distance=it.linkDistance;
it.linkStrength=function(iK){if(!arguments.length){return iv
}iv=typeof iK==="function"?iK:+iK;
return it
};
it.friction=function(iK){if(!arguments.length){return iz
}iz=+iK;
return it
};
it.charge=function(iK){if(!arguments.length){return iF
}iF=typeof iK==="function"?iK:+iK;
return it
};
it.gravity=function(iK){if(!arguments.length){return ix
}ix=+iK;
return it
};
it.theta=function(iK){if(!arguments.length){return iA
}iA=+iK;
return it
};
it.alpha=function(iK){if(!arguments.length){return iw
}iK=+iK;
if(iw){if(iK>0){iw=iK
}else{iw=0
}}else{if(iK>0){iG.start({type:"start",alpha:iw=iK});
hy.timer(it.tick)
}}return it
};
it.start=function(){var iO,iR=iE.length,iL=iu.length,iM=iC[0],iP=iC[1],iN,iQ;
for(iO=0;
iO<iR;
++iO){(iQ=iE[iO]).index=iO;
iQ.weight=0
}for(iO=0;
iO<iL;
++iO){iQ=iu[iO];
if(typeof iQ.source=="number"){iQ.source=iE[iQ.source]
}if(typeof iQ.target=="number"){iQ.target=iE[iQ.target]
}++iQ.source.weight;
++iQ.target.weight
}for(iO=0;
iO<iR;
++iO){iQ=iE[iO];
if(isNaN(iQ.x)){iQ.x=iK("x",iM)
}if(isNaN(iQ.y)){iQ.y=iK("y",iP)
}if(isNaN(iQ.px)){iQ.px=iQ.x
}if(isNaN(iQ.py)){iQ.py=iQ.y
}}iy=[];
if(typeof iJ==="function"){for(iO=0;
iO<iL;
++iO){iy[iO]=+iJ.call(this,iu[iO],iO)
}}else{for(iO=0;
iO<iL;
++iO){iy[iO]=iJ
}}ir=[];
if(typeof iv==="function"){for(iO=0;
iO<iL;
++iO){ir[iO]=+iv.call(this,iu[iO],iO)
}}else{for(iO=0;
iO<iL;
++iO){ir[iO]=iv
}}iB=[];
if(typeof iF==="function"){for(iO=0;
iO<iR;
++iO){iB[iO]=+iF.call(this,iE[iO],iO)
}}else{for(iO=0;
iO<iR;
++iO){iB[iO]=iF
}}function iK(iX,iV){if(!iN){iN=new Array(iR);
for(iU=0;
iU<iR;
++iU){iN[iU]=[]
}for(iU=0;
iU<iT;
++iU){var iY=iu[iU];
iN[iY.source.index].push(iY.target);
iN[iY.target.index].push(iY.source)
}}var iW=iN[iO],iU=-1,iT=iW.length,iS;
while(++iU<iT){if(!isNaN(iS=iW[iU][iX])){return iS
}}return Math.random()*iV
}return it.resume()
};
it.resume=function(){return it.alpha(0.1)
};
it.stop=function(){return it.alpha(0)
};
it.drag=function(){if(!iI){iI=hy.behavior.drag().origin(gy).on("dragstart.force",t).on("drag.force",iD).on("dragend.force",ep)
}if(!arguments.length){return iI
}this.on("mouseover.force",cD).on("mouseout.force",ew).call(iI)
};
function iD(iK){iK.px=hy.event.x,iK.py=hy.event.y;
it.resume()
}return hy.rebind(it,iG,"on")
};
function t(ir){ir.fixed|=2
}function ep(ir){ir.fixed&=~6
}function cD(ir){ir.fixed|=4;
ir.px=ir.x,ir.py=ir.y
}function ew(ir){ir.fixed&=~4
}function gN(iB,iw,iA){var ix=0,iu=0;
iB.charge=0;
if(!iB.leaf){var ir=iB.nodes,it=ir.length,iy=-1,iz;
while(++iy<it){iz=ir[iy];
if(iz==null){continue
}gN(iz,iw,iA);
iB.charge+=iz.charge;
ix+=iz.charge*iz.cx;
iu+=iz.charge*iz.cy
}}if(iB.point){if(!iB.leaf){iB.point.x+=Math.random()-0.5;
iB.point.y+=Math.random()-0.5
}var iv=iw*iA[iB.point.index];
iB.charge+=iB.pointCharge=iv;
ix+=iv*iB.point.x;
iu+=iv*iB.point.y
}iB.cx=ix/iB.charge;
iB.cy=iu/iB.charge
}var f6=20,cz=1;
hy.layout.hierarchy=function(){var iu=d0,it=bc,iw=hV;
function iv(iA,iC,iy){var iF=it.call(ir,iA,iC);
iA.depth=iC;
iy.push(iA);
if(iF&&(iz=iF.length)){var iD=-1,iz,iG=iA.children=new Array(iz),iH=0,iB=iC+1,iE;
while(++iD<iz){iE=iG[iD]=iv(iF[iD],iB,iy);
iE.parent=iA;
iH+=iE.value
}if(iu){iG.sort(iu)
}if(iw){iA.value=iH
}}else{delete iA.children;
if(iw){iA.value=+iw.call(ir,iA,iC)||0
}}return iA
}function ix(iC,iD){var iB=iC.children,iy=0;
if(iB&&(iE=iB.length)){var iA=-1,iE,iz=iD+1;
while(++iA<iE){iy+=ix(iB[iA],iz)
}}else{if(iw){iy=+iw.call(ir,iC,iD)||0
}}if(iw){iC.value=iy
}return iy
}function ir(iz){var iy=[];
iv(iz,0,iy);
return iy
}ir.sort=function(iy){if(!arguments.length){return iu
}iu=iy;
return ir
};
ir.children=function(iy){if(!arguments.length){return it
}it=iy;
return ir
};
ir.value=function(iy){if(!arguments.length){return iw
}iw=iy;
return ir
};
ir.revalue=function(iy){ix(iy,0);
return iy
};
return ir
};
function gF(it,ir){hy.rebind(it,ir,"sort","children","value");
it.nodes=it;
it.links=gJ;
return it
}function bc(ir){return ir.children
}function hV(ir){return ir.value
}function d0(it,ir){return ir.value-it.value
}function gJ(ir){return hy.merge(ir.map(function(it){return(it.children||[]).map(function(iu){return{source:it,target:iu}
})
}))
}hy.layout.partition=function(){var iu=hy.layout.hierarchy(),iv=[1,1];
function ir(iz,iD,iF,iE){var ix=iz.children;
iz.x=iD;
iz.y=iz.depth*iE;
iz.dx=iF;
iz.dy=iE;
if(ix&&(iy=ix.length)){var iA=-1,iy,iC,iB;
iF=iz.value?iF/iz.value:0;
while(++iA<iy){ir(iC=ix[iA],iD,iB=iC.value*iF,iE);
iD+=iB
}}}function iw(iz){var iy=iz.children,iA=0;
if(iy&&(iB=iy.length)){var ix=-1,iB;
while(++ix<iB){iA=Math.max(iA,iw(iy[ix]))
}}return 1+iA
}function it(iz,iy){var ix=iu.call(this,iz,iy);
ir(ix[0],0,iv[0],iv[1]/iw(ix[0]));
return ix
}it.size=function(ix){if(!arguments.length){return iv
}iv=ix;
return it
};
return gF(it,iu)
};
hy.layout.pie=function(){var iw=Number,iv=ab,iu=0,it=gm;
function ir(iC){var iz=iC.map(function(iE,iD){return +iw.call(ir,iE,iD)
});
var ix=+(typeof iu==="function"?iu.apply(this,arguments):iu);
var iy=((typeof it==="function"?it.apply(this,arguments):it)-ix)/hy.sum(iz);
var iA=hy.range(iC.length);
if(iv!=null){iA.sort(iv===ab?function(iE,iD){return iz[iD]-iz[iE]
}:function(iE,iD){return iv(iC[iE],iC[iD])
})
}var iB=[];
iA.forEach(function(iD){var iE;
iB[iD]={data:iC[iD],value:iE=iz[iD],startAngle:ix,endAngle:ix+=iE*iy}
});
return iB
}ir.value=function(ix){if(!arguments.length){return iw
}iw=ix;
return ir
};
ir.sort=function(ix){if(!arguments.length){return iv
}iv=ix;
return ir
};
ir.startAngle=function(ix){if(!arguments.length){return iu
}iu=ix;
return ir
};
ir.endAngle=function(ix){if(!arguments.length){return it
}it=ix;
return ir
};
return ir
};
var ab={};
hy.layout.stack=function(){var iv=gy,iu=bV,ix=fU,iw=fV,it=av,iy=at;
function ir(iG,iI){var iH=iG.map(function(iL,iK){return iv.call(ir,iL,iK)
});
var iJ=iH.map(function(iK){return iK.map(function(iL,iM){return[it.call(ir,iL,iM),iy.call(ir,iL,iM)]
})
});
var iD=iu.call(ir,iJ,iI);
iH=hy.permute(iH,iD);
iJ=hy.permute(iJ,iD);
var iC=ix.call(ir,iJ,iI);
var iA=iH.length,iB=iH[0].length,iF,iE,iz;
for(iE=0;
iE<iB;
++iE){iw.call(ir,iH[0][iE],iz=iC[iE],iJ[0][iE][1]);
for(iF=1;
iF<iA;
++iF){iw.call(ir,iH[iF][iE],iz+=iJ[iF-1][iE][1],iJ[iF][iE][1])
}}return iG
}ir.values=function(iz){if(!arguments.length){return iv
}iv=iz;
return ir
};
ir.order=function(iz){if(!arguments.length){return iu
}iu=typeof iz==="function"?iz:ba.get(iz)||bV;
return ir
};
ir.offset=function(iz){if(!arguments.length){return ix
}ix=typeof iz==="function"?iz:an.get(iz)||fU;
return ir
};
ir.x=function(iz){if(!arguments.length){return it
}it=iz;
return ir
};
ir.y=function(iz){if(!arguments.length){return iy
}iy=iz;
return ir
};
ir.out=function(iz){if(!arguments.length){return iw
}iw=iz;
return ir
};
return ir
};
function av(ir){return ir.x
}function at(ir){return ir.y
}function fV(it,ir,iu){it.y0=ir;
it.y=iu
}var ba=hy.map({"inside-out":function(iw){var iu=iw.length,ix,iv,iB=iw.map(b0),iy=iw.map(dC),iz=hy.range(iu).sort(function(iE,iD){return iB[iE]-iB[iD]
}),iA=0,ir=0,iC=[],it=[];
for(ix=0;
ix<iu;
++ix){iv=iz[ix];
if(iA<ir){iA+=iy[iv];
iC.push(iv)
}else{ir+=iy[iv];
it.push(iv)
}}return it.reverse().concat(iC)
},reverse:function(ir){return hy.range(ir.length).reverse()
},"default":bV});
var an=hy.map({silhouette:function(iw){var it=iw.length,iu=iw[0].length,iy=[],iz=0,ix,iv,ir,iA=[];
for(iv=0;
iv<iu;
++iv){for(ix=0,ir=0;
ix<it;
ix++){ir+=iw[ix][iv][1]
}if(ir>iz){iz=ir
}iy.push(ir)
}for(iv=0;
iv<iu;
++iv){iA[iv]=(iz-iy[iv])/2
}return iA
},wiggle:function(iy){var it=iy.length,iB=iy[0],iu=iB.length,iz,ix,iw,iE,iD,iA,iF,ir,iv,iC=[];
iC[0]=ir=iv=0;
for(ix=1;
ix<iu;
++ix){for(iz=0,iE=0;
iz<it;
++iz){iE+=iy[iz][ix][1]
}for(iz=0,iD=0,iF=iB[ix][0]-iB[ix-1][0];
iz<it;
++iz){for(iw=0,iA=(iy[iz][ix][1]-iy[iz][ix-1][1])/(2*iF);
iw<iz;
++iw){iA+=(iy[iw][ix][1]-iy[iw][ix-1][1])/iF
}iD+=iA*iy[iz][ix][1]
}iC[ix]=ir-=iE?iD/iE*iF:0;
if(ir<iv){iv=ir
}}for(ix=0;
ix<iu;
++ix){iC[ix]-=iv
}return iC
},expand:function(ix){var iz=ix.length,ir=ix[0].length,it=1/iz,iv,iu,iy,iw=[];
for(iu=0;
iu<ir;
++iu){for(iv=0,iy=0;
iv<iz;
iv++){iy+=ix[iv][iu][1]
}if(iy){for(iv=0;
iv<iz;
iv++){ix[iv][iu][1]/=iy
}}else{for(iv=0;
iv<iz;
iv++){ix[iv][iu][1]=it
}}}for(iu=0;
iu<ir;
++iu){iw[iu]=0
}return iw
},zero:fU});
function bV(ir){return hy.range(ir.length)
}function fU(iv){var it=-1,ir=iv[0].length,iu=[];
while(++it<ir){iu[it]=0
}return iu
}function b0(ix){var iv=1,iu=0,it=ix[0][1],ir,iw=ix.length;
for(;
iv<iw;
++iv){if((ir=ix[iv][1])>it){iu=iv;
it=ir
}}return iu
}function dC(ir){return ir.reduce(fT,0)
}function fT(ir,it){return ir+it[1]
}hy.layout.histogram=function(){var iw=true,it=Number,ir=bo,iu=hH;
function iv(iA,iB){var iG=[],iE=iA.map(it,this),iC=ir.call(this,iE,iB),iF=iu.call(this,iC,iE,iB),iH,iB=-1,ix=iE.length,iy=iF.length-1,iz=iw?1:1/ix,iD;
while(++iB<iy){iH=iG[iB]=[];
iH.dx=iF[iB+1]-(iH.x=iF[iB]);
iH.y=0
}if(iy>0){iB=-1;
while(++iB<ix){iD=iE[iB];
if(iD>=iC[0]&&iD<=iC[1]){iH=iG[hy.bisect(iF,iD,1,iy)-1];
iH.y+=iz;
iH.push(iA[iB])
}}}return iG
}iv.value=function(ix){if(!arguments.length){return it
}it=ix;
return iv
};
iv.range=function(ix){if(!arguments.length){return ir
}ir=Y(ix);
return iv
};
iv.bins=function(ix){if(!arguments.length){return iu
}iu=typeof ix==="number"?function(iy){return j(iy,ix)
}:Y(ix);
return iv
};
iv.frequency=function(ix){if(!arguments.length){return iw
}iw=!!ix;
return iv
};
return iv
};
function hH(it,ir){return j(it,Math.ceil(Math.log(ir.length)/Math.LN2+1))
}function j(iv,ix){var iu=-1,it=+iv[0],ir=(iv[1]-it)/ix,iw=[];
while(++iu<=ix){iw[iu]=ir*iu+it
}return iw
}function bo(ir){return[hy.min(ir),hy.max(ir)]
}hy.layout.tree=function(){var iu=hy.layout.hierarchy().sort(null).value(null),iw=dH,iv=[1,1],it=false;
function ir(iE,iC){var iy=iu.call(this,iE,iC),iG=iy[0];
function iD(iO,iK){var iM=iO.children,iR=iO._tree;
if(iM&&(iN=iM.length)){var iN,iT=iM[0],iS,iQ=iT,iL,iP=-1;
while(++iP<iN){iL=iM[iP];
iD(iL,iS);
iQ=ix(iL,iS,iQ);
iS=iL
}dK(iO);
var iU=0.5*(iT._tree.prelim+iL._tree.prelim);
if(iK){iR.prelim=iK._tree.prelim+iw(iO,iK);
iR.mod=iR.prelim-iU
}else{iR.prelim=iU
}}else{if(iK){iR.prelim=iK._tree.prelim+iw(iO,iK)
}}}function iF(iN,iK){iN.x=iN._tree.prelim+iK;
var iM=iN.children;
if(iM&&(iO=iM.length)){var iL=-1,iO;
iK+=iN._tree.mod;
while(++iL<iO){iF(iM[iL],iK)
}}}function ix(iO,iK,iR){if(iK){var iN=iO,iM=iO,iQ=iK,iP=iO.parent.children[0],iT=iN._tree.mod,iS=iM._tree.mod,iV=iQ._tree.mod,iU=iP._tree.mod,iL;
while(iQ=aG(iQ),iN=ia(iN),iQ&&iN){iP=ia(iP);
iM=aG(iM);
iM._tree.ancestor=iO;
iL=iQ._tree.prelim+iV-iN._tree.prelim-iT+iw(iQ,iN);
if(iL>0){ic(gd(iQ,iO,iR),iO,iL);
iT+=iL;
iS+=iL
}iV+=iQ._tree.mod;
iT+=iN._tree.mod;
iU+=iP._tree.mod;
iS+=iM._tree.mod
}if(iQ&&!aG(iM)){iM._tree.thread=iQ;
iM._tree.mod+=iV-iS
}if(iN&&!ia(iP)){iP._tree.thread=iN;
iP._tree.mod+=iT-iU;
iR=iO
}}return iR
}hP(iG,function(iL,iK){iL._tree={ancestor:iL,prelim:0,mod:0,change:0,shift:0,number:iK?iK._tree.number+1:0}
});
iD(iG);
iF(iG,-iG._tree.prelim);
var iB=ed(iG,bK),iJ=ed(iG,c8),iI=ed(iG,J),iA=iB.x-iw(iB,iJ)/2,iz=iJ.x+iw(iJ,iB)/2,iH=iI.depth||1;
hP(iG,it?function(iK){iK.x*=iv[0];
iK.y=iK.depth*iv[1];
delete iK._tree
}:function(iK){iK.x=(iK.x-iA)/(iz-iA)*iv[0];
iK.y=iK.depth/iH*iv[1];
delete iK._tree
});
return iy
}ir.separation=function(ix){if(!arguments.length){return iw
}iw=ix;
return ir
};
ir.size=function(ix){if(!arguments.length){return it?null:iv
}it=(iv=ix)==null;
return ir
};
ir.nodeSize=function(ix){if(!arguments.length){return it?iv:null
}it=(iv=ix)!=null;
return ir
};
return gF(ir,iu)
};
function dH(it,ir){return it.parent==ir.parent?1:2
}function ia(it){var ir=it.children;
return ir&&ir.length?ir[0]:it._tree.thread
}function aG(it){var ir=it.children,iu;
return ir&&(iu=ir.length)?ir[iu-1]:it._tree.thread
}function ed(iu,iv){var it=iu.children;
if(it&&(iw=it.length)){var ix,iw,ir=-1;
while(++ir<iw){if(iv(ix=ed(it[ir],iv),iu)>0){iu=ix
}}}return iu
}function c8(it,ir){return it.x-ir.x
}function bK(it,ir){return ir.x-it.x
}function J(it,ir){return it.depth-ir.depth
}function hP(it,iu){function ir(iz,iy){var ix=iz.children;
if(ix&&(iA=ix.length)){var iB,iw=null,iv=-1,iA;
while(++iv<iA){iB=ix[iv];
ir(iB,iw);
iw=iB
}}iu(iz,iy)
}ir(it,null)
}function dK(iv){var ir=0,ix=0,iu=iv.children,it=iu.length,iw;
while(--it>=0){iw=iu[it]._tree;
iw.prelim+=ir;
iw.mod+=ir;
ir+=iw.shift+(ix+=iw.change)
}}function ic(it,iu,ir){it=it._tree;
iu=iu._tree;
var iv=ir/(iu.number-it.number);
it.change+=iv;
iu.change-=iv;
iu.shift+=ir;
iu.prelim+=ir;
iu.mod+=ir
}function gd(ir,iu,it){return ir._tree.ancestor.parent==iu.parent?ir._tree.ancestor:it
}hy.layout.pack=function(){var it=hy.layout.hierarchy().sort(eL),iw=0,iv=[1,1],ir;
function iu(iE,iA){var iz=it.call(this,iE,iA),iy=iz[0],ix=iv[0],iB=iv[1],iC=ir==null?Math.sqrt:typeof ir==="function"?ir:function(){return ir
};
iy.x=iy.y=0;
hP(iy,function(iF){iF.r=+iC(iF.value)
});
hP(iy,aa);
if(iw){var iD=iw*(ir?1:Math.max(2*iy.r/ix,2*iy.r/iB))/2;
hP(iy,function(iF){iF.r+=iD
});
hP(iy,aa);
hP(iy,function(iF){iF.r-=iD
})
}fC(iy,ix/2,iB/2,ir?1:1/Math.max(2*iy.r/ix,2*iy.r/iB));
return iz
}iu.size=function(ix){if(!arguments.length){return iv
}iv=ix;
return iu
};
iu.radius=function(ix){if(!arguments.length){return ir
}ir=ix==null||typeof ix==="function"?ix:+ix;
return iu
};
iu.padding=function(ix){if(!arguments.length){return iw
}iw=+ix;
return iu
};
return gF(iu,it)
};
function eL(it,ir){return it.value-ir.value
}function bU(it,ir){var iu=it._pack_next;
it._pack_next=ir;
ir._pack_prev=it;
ir._pack_next=iu;
iu._pack_prev=ir
}function bj(it,ir){it._pack_next=ir;
ir._pack_prev=it
}function ex(iu,ir){var iv=ir.x-iu.x,it=ir.y-iu.y,iw=iu.r+ir.r;
return 0.999*iw*iw>iv*iv+it*it
}function aa(iD){if(!(iC=iD.children)||!(iB=iC.length)){return
}var iC,iH=Infinity,iL=-Infinity,ir=Infinity,iw=-Infinity,iK,iJ,iI,iG,iF,iE,iB;
function iu(iM){iH=Math.min(iM.x-iM.r,iH);
iL=Math.max(iM.x+iM.r,iL);
ir=Math.min(iM.y-iM.r,ir);
iw=Math.max(iM.y+iM.r,iw)
}iC.forEach(aX);
iK=iC[0];
iK.x=-iK.r;
iK.y=0;
iu(iK);
if(iB>1){iJ=iC[1];
iJ.x=iJ.r;
iJ.y=0;
iu(iJ);
if(iB>2){iI=iC[2];
bi(iK,iJ,iI);
iu(iI);
bU(iK,iI);
iK._pack_prev=iI;
bU(iI,iJ);
iJ=iK._pack_next;
for(iG=3;
iG<iB;
iG++){bi(iK,iJ,iI=iC[iG]);
var it=0,ix=1,iv=1;
for(iF=iJ._pack_next;
iF!==iJ;
iF=iF._pack_next,ix++){if(ex(iF,iI)){it=1;
break
}}if(it==1){for(iE=iK._pack_prev;
iE!==iF._pack_prev;
iE=iE._pack_prev,iv++){if(ex(iE,iI)){break
}}}if(it){if(ix<iv||ix==iv&&iJ.r<iK.r){bj(iK,iJ=iF)
}else{bj(iK=iE,iJ)
}iG--
}else{bU(iK,iI);
iJ=iI;
iu(iI)
}}}}var iz=(iH+iL)/2,iy=(ir+iw)/2,iA=0;
for(iG=0;
iG<iB;
iG++){iI=iC[iG];
iI.x-=iz;
iI.y-=iy;
iA=Math.max(iA,iI.r+Math.sqrt(iI.x*iI.x+iI.y*iI.y))
}iD.r=iA;
iC.forEach(e0)
}function aX(ir){ir._pack_next=ir._pack_prev=ir
}function e0(ir){delete ir._pack_next;
delete ir._pack_prev
}function fC(iw,ir,iy,it){var iv=iw.children;
iw.x=ir+=it*iw.x;
iw.y=iy+=it*iw.y;
iw.r*=it;
if(iv){var iu=-1,ix=iv.length;
while(++iu<ix){fC(iv[iu],ir,iy,it)
}}}function bi(iw,iu,ir){var iy=iw.r+ir.r,iB=iu.x-iw.x,iz=iu.y-iw.y;
if(iy&&(iB||iz)){var iA=iu.r+ir.r,ix=iB*iB+iz*iz;
iA*=iA;
iy*=iy;
var iv=0.5+(iy-iA)/(2*ix),it=Math.sqrt(Math.max(0,2*iA*(iy+ix)-(iy-=ix)*iy-iA*iA))/(2*ix);
ir.x=iw.x+iv*iB+it*iz;
ir.y=iw.y+iv*iz-it*iB
}else{ir.x=iw.x+iy;
ir.y=iw.y
}}hy.layout.cluster=function(){var iu=hy.layout.hierarchy().sort(null).value(null),iw=dH,iv=[1,1],it=false;
function ir(iC,iB){var ix=iu.call(this,iC,iB),iD=ix[0],iE,iF=0;
hP(iD,function(iI){var iH=iI.children;
if(iH&&iH.length){iI.x=bA(iH);
iI.y=bz(iH)
}else{iI.x=iE?iF+=iw(iI,iE):0;
iI.y=0;
iE=iI
}});
var iA=eN(iD),iG=dO(iD),iz=iA.x-iw(iA,iG)/2,iy=iG.x+iw(iG,iA)/2;
hP(iD,it?function(iH){iH.x=(iH.x-iD.x)*iv[0];
iH.y=(iD.y-iH.y)*iv[1]
}:function(iH){iH.x=(iH.x-iz)/(iy-iz)*iv[0];
iH.y=(1-(iD.y?iH.y/iD.y:1))*iv[1]
});
return ix
}ir.separation=function(ix){if(!arguments.length){return iw
}iw=ix;
return ir
};
ir.size=function(ix){if(!arguments.length){return it?null:iv
}it=(iv=ix)==null;
return ir
};
ir.nodeSize=function(ix){if(!arguments.length){return it?iv:null
}it=(iv=ix)!=null;
return ir
};
return gF(ir,iu)
};
function bz(ir){return 1+hy.max(ir,function(it){return it.y
})
}function bA(ir){return ir.reduce(function(it,iu){return it+iu.x
},0)/ir.length
}function eN(it){var ir=it.children;
return ir&&ir.length?eN(ir[0]):it
}function dO(it){var ir=it.children,iu;
return ir&&(iu=ir.length)?dO(ir[iu-1]):it
}hy.layout.treemap=function(){var iA=hy.layout.hierarchy(),iE=Math.round,iG=[1,1],iB=null,ir=fo,iC=false,iy,ix="squarify",iz=0.5*(1+Math.sqrt(5));
function it(iJ,iH){var iI=-1,iM=iJ.length,iL,iK;
while(++iI<iM){iK=(iL=iJ[iI]).value*(iH<0?0:iH);
iL.area=isNaN(iK)||iK<=0?0:iK
}}function iv(iL){var iI=iL.children;
if(iI&&iI.length){var iO=ir(iL),iQ=[],iN=iI.slice(),iH,iM=Infinity,iK,iP=ix==="slice"?iO.dx:ix==="dice"?iO.dy:ix==="slice-dice"?iL.depth&1?iO.dy:iO.dx:Math.min(iO.dx,iO.dy),iJ;
it(iN,iO.dx*iO.dy/iL.value);
iQ.area=0;
while((iJ=iN.length)>0){iQ.push(iH=iN[iJ-1]);
iQ.area+=iH.area;
if(ix!=="squarify"||(iK=iu(iQ,iP))<=iM){iN.pop();
iM=iK
}else{iQ.area-=iQ.pop().area;
iw(iQ,iP,iO,false);
iP=Math.min(iO.dx,iO.dy);
iQ.length=iQ.area=0;
iM=Infinity
}}if(iQ.length){iw(iQ,iP,iO,true);
iQ.length=iQ.area=0
}iI.forEach(iv)
}}function iF(iK){var iH=iK.children;
if(iH&&iH.length){var iJ=ir(iK),iI=iH.slice(),iM,iL=[];
it(iI,iJ.dx*iJ.dy/iK.value);
iL.area=0;
while(iM=iI.pop()){iL.push(iM);
iL.area+=iM.area;
if(iM.z!=null){iw(iL,iM.z?iJ.dx:iJ.dy,iJ,!iI.length);
iL.length=iL.area=0
}}iH.forEach(iF)
}}function iu(iM,iI){var iK=iM.area,iL,iO=0,iH=Infinity,iJ=-1,iN=iM.length;
while(++iJ<iN){if(!(iL=iM[iJ].area)){continue
}if(iL<iH){iH=iL
}if(iL>iO){iO=iL
}}iK*=iK;
iI*=iI;
return iK?Math.max(iI*iO*iz/iK,iK/(iI*iH*iz)):Infinity
}function iw(iQ,iP,iL,iO){var iJ=-1,iI=iQ.length,iM=iL.x,iK=iL.y,iN=iP?iE(iQ.area/iP):0,iH;
if(iP==iL.dx){if(iO||iN>iL.dy){iN=iL.dy
}while(++iJ<iI){iH=iQ[iJ];
iH.x=iM;
iH.y=iK;
iH.dy=iN;
iM+=iH.dx=Math.min(iL.x+iL.dx-iM,iN?iE(iH.area/iN):0)
}iH.z=true;
iH.dx+=iL.x+iL.dx-iM;
iL.y+=iN;
iL.dy-=iN
}else{if(iO||iN>iL.dx){iN=iL.dx
}while(++iJ<iI){iH=iQ[iJ];
iH.x=iM;
iH.y=iK;
iH.dx=iN;
iK+=iH.dy=Math.min(iL.y+iL.dy-iK,iN?iE(iH.area/iN):0)
}iH.z=false;
iH.dy+=iL.y+iL.dy-iK;
iL.x+=iN;
iL.dx-=iN
}}function iD(iJ){var iI=iy||iA(iJ),iH=iI[0];
iH.x=0;
iH.y=0;
iH.dx=iG[0];
iH.dy=iG[1];
if(iy){iA.revalue(iH)
}it([iH],iH.dx*iH.dy/iH.value);
(iy?iF:iv)(iH);
if(iC){iy=iI
}return iI
}iD.size=function(iH){if(!arguments.length){return iG
}iG=iH;
return iD
};
iD.padding=function(iH){if(!arguments.length){return iB
}function iK(iL){var iM=iH.call(iD,iL,iL.depth);
return iM==null?fo(iL):a5(iL,typeof iM==="number"?[iM,iM,iM,iM]:iM)
}function iJ(iL){return a5(iL,iH)
}var iI;
ir=(iB=iH)==null?fo:(iI=typeof iH)==="function"?iK:iI==="number"?(iH=[iH,iH,iH,iH],iJ):iJ;
return iD
};
iD.round=function(iH){if(!arguments.length){return iE!=Number
}iE=iH?Math.round:Number;
return iD
};
iD.sticky=function(iH){if(!arguments.length){return iC
}iC=iH;
iy=null;
return iD
};
iD.ratio=function(iH){if(!arguments.length){return iz
}iz=iH;
return iD
};
iD.mode=function(iH){if(!arguments.length){return ix
}ix=iH+"";
return iD
};
return gF(iD,iA)
};
function fo(ir){return{x:ir.x,y:ir.y,dx:ir.dx,dy:ir.dy}
}function a5(iv,iw){var ir=iv.x+iw[3],ix=iv.y+iw[0],iu=iv.dx-iw[1]-iw[3],it=iv.dy-iw[0]-iw[2];
if(iu<0){ir+=iu/2;
iu=0
}if(it<0){ix+=it/2;
it=0
}return{x:ir,y:ix,dx:iu,dy:it}
}hy.random={normal:function(it,ir){var iu=arguments.length;
if(iu<2){ir=1
}if(iu<1){it=0
}return function(){var iv,ix,iw;
do{iv=Math.random()*2-1;
ix=Math.random()*2-1;
iw=iv*iv+ix*ix
}while(!iw||iw>1);
return it+ir*iv*Math.sqrt(-2*Math.log(iw)/iw)
}
},logNormal:function(){var ir=hy.random.normal.apply(hy,arguments);
return function(){return Math.exp(ir())
}
},bates:function(ir){var it=hy.random.irwinHall(ir);
return function(){return it()/ir
}
},irwinHall:function(ir){return function(){for(var iu=0,it=0;
it<ir;
it++){iu+=Math.random()
}return iu
}
}};
hy.scale={};
function eD(it){var iu=it[0],ir=it[it.length-1];
return iu<ir?[iu,ir]:[ir,iu]
}function a4(ir){return ir.rangeExtent?ir.rangeExtent():eD(ir.range())
}function aL(iw,ir,ix,iu){var it=ix(iw[0],iw[1]),iv=iu(ir[0],ir[1]);
return function(iy){return iv(it(iy))
}
}function gw(iy,iw){var ix=0,iv=iy.length-1,iu=iy[ix],it=iy[iv],ir;
if(it<iu){ir=ix,ix=iv,iv=ir;
ir=iu,iu=it,it=ir
}iy[ix]=iw.floor(iu);
iy[iv]=iw.ceil(it);
return iy
}function bb(ir){return ir?{floor:function(it){return Math.floor(it/ir)*ir
},ceil:function(it){return Math.ceil(it/ir)*ir
}}:eM
}var eM={floor:gy,ceil:gy};
function S(iy,it,iz,iw){var iv=[],ix=[],iu=0,ir=Math.min(iy.length,it.length)-1;
if(iy[ir]<iy[0]){iy=iy.slice().reverse();
it=it.slice().reverse()
}while(++iu<=ir){iv.push(iz(iy[iu-1],iy[iu]));
ix.push(iw(it[iu-1],it[iu]))
}return function(iA){var iB=hy.bisect(iy,iA,1,ir)-1;
return ix[iB](iv[iB](iA))
}
}hy.scale.linear=function(){return ev([0,1],[0,1],fS,false)
};
function ev(ix,iv,iw,iz){var iu,it;
function ir(){var iA=Math.min(ix.length,iv.length)>2?S:aL,iB=iz?aF:hG;
iu=iA(ix,iv,iB,iw);
it=iA(iv,ix,iB,fS);
return iy
}function iy(iA){return iu(iA)
}iy.invert=function(iA){return it(iA)
};
iy.domain=function(iA){if(!arguments.length){return ix
}ix=iA.map(Number);
return ir()
};
iy.range=function(iA){if(!arguments.length){return iv
}iv=iA;
return ir()
};
iy.rangeRound=function(iA){return iy.range(iA).interpolate(fN)
};
iy.clamp=function(iA){if(!arguments.length){return iz
}iz=iA;
return ir()
};
iy.interpolate=function(iA){if(!arguments.length){return iw
}iw=iA;
return ir()
};
iy.ticks=function(iA){return fe(ix,iA)
};
iy.tickFormat=function(iA,iB){return fq(ix,iA,iB)
};
iy.nice=function(iA){aT(ix,iA);
return ir()
};
iy.copy=function(){return ev(ix,iv,iw,iz)
};
return ir()
}function go(it,ir){return hy.rebind(it,ir,"range","rangeRound","interpolate","clamp")
}function aT(it,ir){return gw(it,bb(s(it,ir)[2]))
}function s(ix,ir){if(ir==null){ir=10
}var iu=eD(ix),it=iu[1]-iu[0],iw=Math.pow(10,Math.floor(Math.log(it/ir)/Math.LN10)),iv=ir/it*iw;
if(iv<=0.15){iw*=10
}else{if(iv<=0.35){iw*=5
}else{if(iv<=0.75){iw*=2
}}}iu[0]=Math.ceil(iu[0]/iw)*iw;
iu[1]=Math.floor(iu[1]/iw)*iw+iw*0.5;
iu[2]=iw;
return iu
}function fe(it,ir){return hy.range.apply(hy,s(it,ir))
}function fq(iu,ir,iv){var it=s(iu,ir);
return hy.format(iv?iv.replace(cG,function(iF,iE,iD,iC,iB,iA,iz,iy,ix,iw){return[iE,iD,iC,iB,iA,iz,iy,ix||"."+C(iw,it),iw].join("")
}):",."+g7(it[2])+"f")
}var h9={s:1,g:1,p:1,r:1,e:1};
function g7(ir){return -Math.floor(Math.log(ir)/Math.LN10+0.01)
}function C(it,ir){var iu=g7(ir[2]);
return it in h9?Math.abs(iu-g7(Math.max(Math.abs(ir[0]),Math.abs(ir[1]))))+ +(it!=="e"):iu-(it==="%")*2
}hy.scale.log=function(){return gT(hy.scale.linear().domain([0,1]),10,true,[1,10])
};
function gT(it,ix,ir,iw){function iu(iz){return(ir?Math.log(iz<0?0:iz):-Math.log(iz>0?0:-iz))/Math.log(ix)
}function iv(iz){return ir?Math.pow(ix,iz):-Math.pow(ix,-iz)
}function iy(iz){return it(iu(iz))
}iy.invert=function(iz){return iv(it.invert(iz))
};
iy.domain=function(iz){if(!arguments.length){return iw
}ir=iz[0]>=0;
it.domain((iw=iz.map(Number)).map(iu));
return iy
};
iy.base=function(iz){if(!arguments.length){return ix
}ix=+iz;
it.domain(iw.map(iu));
return iy
};
iy.nice=function(){var iz=gw(iw.map(iu),ir?Math:gX);
it.domain(iz);
iw=iz.map(iv);
return iy
};
iy.ticks=function(){var iE=eD(iw),iF=[],iC=iE[0],iA=iE[1],iD=Math.floor(iu(iC)),iB=Math.ceil(iu(iA)),iG=ix%1?2:ix;
if(isFinite(iB-iD)){if(ir){for(;
iD<iB;
iD++){for(var iz=1;
iz<iG;
iz++){iF.push(iv(iD)*iz)
}}iF.push(iv(iD))
}else{iF.push(iv(iD));
for(;
iD++<iB;
){for(var iz=iG-1;
iz>0;
iz--){iF.push(iv(iD)*iz)
}}}for(iD=0;
iF[iD]<iC;
iD++){}for(iB=iF.length;
iF[iB-1]>iA;
iB--){}iF=iF.slice(iD,iB)
}return iF
};
iy.tickFormat=function(iD,iC){if(!arguments.length){return dB
}if(arguments.length<2){iC=dB
}else{if(typeof iC!=="function"){iC=hy.format(iC)
}}var iz=Math.max(0.1,iD/iy.ticks().length),iA=ir?(iB=1e-12,Math.ceil):(iB=-1e-12,Math.floor),iB;
return function(iE){return iE/iv(iA(iu(iE)+iB))<=iz?iC(iE):""
}
};
iy.copy=function(){return gT(it.copy(),ix,ir,iw)
};
return go(iy,it)
}var dB=hy.format(".0e"),gX={floor:function(ir){return -Math.ceil(-ir)
},ceil:function(ir){return -Math.floor(-ir)
}};
hy.scale.pow=function(){return gE(hy.scale.linear(),1,[0,1])
};
function gE(ir,iv,iu){var it=f9(iv),iw=f9(1/iv);
function ix(iy){return ir(it(iy))
}ix.invert=function(iy){return iw(ir.invert(iy))
};
ix.domain=function(iy){if(!arguments.length){return iu
}ir.domain((iu=iy.map(Number)).map(it));
return ix
};
ix.ticks=function(iy){return fe(iu,iy)
};
ix.tickFormat=function(iy,iz){return fq(iu,iy,iz)
};
ix.nice=function(iy){return ix.domain(aT(iu,iy))
};
ix.exponent=function(iy){if(!arguments.length){return iv
}it=f9(iv=iy);
iw=f9(1/iv);
ir.domain(iu.map(it));
return ix
};
ix.copy=function(){return gE(ir.copy(),iv,iu)
};
return go(ix,ir)
}function f9(ir){return function(it){return it<0?-Math.pow(-it,ir):Math.pow(it,ir)
}
}hy.scale.sqrt=function(){return hy.scale.pow().exponent(0.5)
};
hy.scale.ordinal=function(){return cy([],{t:"range",a:[[]]})
};
function cy(ix,iu){var iw,it,iv;
function iy(iz){return it[((iw.get(iz)||iu.t==="range"&&iw.set(iz,ix.push(iz)))-1)%it.length]
}function ir(iA,iz){return hy.range(ix.length).map(function(iB){return iA+iz*iB
})
}iy.domain=function(iz){if(!arguments.length){return ix
}ix=[];
iw=new aN();
var iB=-1,iC=iz.length,iA;
while(++iB<iC){if(!iw.has(iA=iz[iB])){iw.set(iA,ix.push(iA))
}}return iy[iu.t].apply(iy,iu.a)
};
iy.range=function(iz){if(!arguments.length){return it
}it=iz;
iv=0;
iu={t:"range",a:arguments};
return iy
};
iy.rangePoints=function(iz,iC){if(arguments.length<2){iC=0
}var iD=iz[0],iA=iz[1],iB=(iA-iD)/(Math.max(1,ix.length-1)+iC);
it=ir(ix.length<2?(iD+iA)/2:iD+iB*iC/2,iB);
iv=0;
iu={t:"rangePoints",a:arguments};
return iy
};
iy.rangeBands=function(iA,iE,iz){if(arguments.length<2){iE=0
}if(arguments.length<3){iz=iE
}var iB=iA[1]<iA[0],iF=iA[iB-0],iC=iA[1-iB],iD=(iC-iF)/(ix.length-iE+2*iz);
it=ir(iF+iD*iz,iD);
if(iB){it.reverse()
}iv=iD*(1-iE);
iu={t:"rangeBands",a:arguments};
return iy
};
iy.rangeRoundBands=function(iA,iF,iz){if(arguments.length<2){iF=0
}if(arguments.length<3){iz=iF
}var iC=iA[1]<iA[0],iG=iA[iC-0],iD=iA[1-iC],iE=Math.floor((iD-iG)/(ix.length-iF+2*iz)),iB=iD-iG-(ix.length-iF)*iE;
it=ir(iG+Math.round(iB/2),iE);
if(iC){it.reverse()
}iv=Math.round(iE*(1-iF));
iu={t:"rangeRoundBands",a:arguments};
return iy
};
iy.rangeBand=function(){return iv
};
iy.rangeExtent=function(){return eD(iu.a[0])
};
iy.copy=function(){return cy(ix,iu)
};
return iy.domain(ix)
}hy.scale.category10=function(){return hy.scale.ordinal().range(cH)
};
hy.scale.category20=function(){return hy.scale.ordinal().range(cm)
};
hy.scale.category20b=function(){return hy.scale.ordinal().range(hn)
};
hy.scale.category20c=function(){return hy.scale.ordinal().range(hl)
};
var cH=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(dE);
var cm=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(dE);
var hn=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(dE);
var hl=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(dE);
hy.scale.quantile=function(){return G([],[])
};
function G(iu,it){var iv;
function ir(){var ix=0,iy=it.length;
iv=[];
while(++ix<iy){iv[ix-1]=hy.quantile(iu,ix/iy)
}return iw
}function iw(ix){if(!isNaN(ix=+ix)){return it[hy.bisect(iv,ix)]
}}iw.domain=function(ix){if(!arguments.length){return iu
}iu=ix.filter(function(iy){return !isNaN(iy)
}).sort(hy.ascending);
return ir()
};
iw.range=function(ix){if(!arguments.length){return it
}it=ix;
return ir()
};
iw.quantiles=function(){return iv
};
iw.invertExtent=function(ix){ix=it.indexOf(ix);
return ix<0?[NaN,NaN]:[ix>0?iv[ix-1]:iu[0],ix<iv.length?iv[ix]:iu[iu.length-1]]
};
iw.copy=function(){return G(iu,it)
};
return ir()
}hy.scale.quantize=function(){return dN(0,1,[0,1])
};
function dN(iw,iu,it){var ix,iv;
function iy(iz){return it[Math.max(0,Math.min(iv,Math.floor(ix*(iz-iw))))]
}function ir(){ix=it.length/(iu-iw);
iv=it.length-1;
return iy
}iy.domain=function(iz){if(!arguments.length){return[iw,iu]
}iw=+iz[0];
iu=+iz[iz.length-1];
return ir()
};
iy.range=function(iz){if(!arguments.length){return it
}it=iz;
return ir()
};
iy.invertExtent=function(iz){iz=it.indexOf(iz);
iz=iz<0?NaN:iz/ix+iw;
return[iz,iz+1/ix]
};
iy.copy=function(){return dN(iw,iu,it)
};
return ir()
}hy.scale.threshold=function(){return gj([0.5],[0,1])
};
function gj(it,ir){function iu(iv){if(iv<=iv){return ir[hy.bisect(it,iv)]
}}iu.domain=function(iv){if(!arguments.length){return it
}it=iv;
return iu
};
iu.range=function(iv){if(!arguments.length){return ir
}ir=iv;
return iu
};
iu.invertExtent=function(iv){iv=ir.indexOf(iv);
return[it[iv-1],it[iv]]
};
iu.copy=function(){return gj(it,ir)
};
return iu
}hy.scale.identity=function(){return e4([0,1])
};
function e4(it){function ir(iu){return +iu
}ir.invert=ir;
ir.domain=ir.range=function(iu){if(!arguments.length){return it
}it=iu.map(ir);
return ir
};
ir.ticks=function(iu){return fe(it,iu)
};
ir.tickFormat=function(iu,iv){return fq(it,iu,iv)
};
ir.copy=function(){return e4(it)
};
return ir
}hy.svg={};
hy.svg.arc=function(){var iw=bE,iv=cZ,iu=gu,ir=aw;
function it(){var iA=iw.apply(this,arguments),iz=iv.apply(this,arguments),iy=iu.apply(this,arguments)+hS,ix=ir.apply(this,arguments)+hS,iG=(ix<iy&&(iG=iy,iy=ix,ix=iG),ix-iy),iD=iG<gr?"0":"1",iC=Math.cos(iy),iF=Math.sin(iy),iB=Math.cos(ix),iE=Math.sin(ix);
return iG>=hX?iA?"M0,"+iz+"A"+iz+","+iz+" 0 1,1 0,"+-iz+"A"+iz+","+iz+" 0 1,1 0,"+iz+"M0,"+iA+"A"+iA+","+iA+" 0 1,0 0,"+-iA+"A"+iA+","+iA+" 0 1,0 0,"+iA+"Z":"M0,"+iz+"A"+iz+","+iz+" 0 1,1 0,"+-iz+"A"+iz+","+iz+" 0 1,1 0,"+iz+"Z":iA?"M"+iz*iC+","+iz*iF+"A"+iz+","+iz+" 0 "+iD+",1 "+iz*iB+","+iz*iE+"L"+iA*iB+","+iA*iE+"A"+iA+","+iA+" 0 "+iD+",0 "+iA*iC+","+iA*iF+"Z":"M"+iz*iC+","+iz*iF+"A"+iz+","+iz+" 0 "+iD+",1 "+iz*iB+","+iz*iE+"L0,0Z"
}it.innerRadius=function(ix){if(!arguments.length){return iw
}iw=Y(ix);
return it
};
it.outerRadius=function(ix){if(!arguments.length){return iv
}iv=Y(ix);
return it
};
it.startAngle=function(ix){if(!arguments.length){return iu
}iu=Y(ix);
return it
};
it.endAngle=function(ix){if(!arguments.length){return ir
}ir=Y(ix);
return it
};
it.centroid=function(){var iy=(iw.apply(this,arguments)+iv.apply(this,arguments))/2,ix=(iu.apply(this,arguments)+ir.apply(this,arguments))/2+hS;
return[Math.cos(ix)*iy,Math.sin(ix)*iy]
};
return it
};
var hS=-eA,hX=gm-gB;
function bE(ir){return ir.innerRadius
}function cZ(ir){return ir.outerRadius
}function gu(ir){return ir.startAngle
}function aw(ir){return ir.endAngle
}function fp(it){var ir=h6,iz=h5,iy=ao,iv=h3,ix=iv.key,iw=0.7;
function iu(iD){var iF=[],iI=[],iE=-1,iA=iD.length,iH,iC=Y(ir),iB=Y(iz);
function iG(){iF.push("M",iv(it(iI),iw))
}while(++iE<iA){if(iy.call(this,iH=iD[iE],iE)){iI.push([+iC.call(this,iH,iE),+iB.call(this,iH,iE)])
}else{if(iI.length){iG();
iI=[]
}}}if(iI.length){iG()
}return iF.length?iF.join(""):null
}iu.x=function(iA){if(!arguments.length){return ir
}ir=iA;
return iu
};
iu.y=function(iA){if(!arguments.length){return iz
}iz=iA;
return iu
};
iu.defined=function(iA){if(!arguments.length){return iy
}iy=iA;
return iu
};
iu.interpolate=function(iA){if(!arguments.length){return ix
}if(typeof iA==="function"){ix=iv=iA
}else{ix=(iv=ch.get(iA)||h3).key
}return iu
};
iu.tension=function(iA){if(!arguments.length){return iw
}iw=iA;
return iu
};
return iu
}hy.svg.line=function(){return fp(gy)
};
var ch=hy.map({linear:h3,"linear-closed":ag,step:di,"step-before":bq,"step-after":hI,basis:fu,"basis-open":bn,"basis-closed":cU,bundle:cX,cardinal:d4,"cardinal-open":b7,"cardinal-closed":u,monotone:ds});
ch.forEach(function(ir,it){it.key=ir;
it.closed=/-closed$/.test(ir)
});
function h3(ir){return ir.join("L")
}function ag(ir){return h3(ir)+"Z"
}function di(it){var ir=0,iw=it.length,iv=it[0],iu=[iv[0],",",iv[1]];
while(++ir<iw){iu.push("H",(iv[0]+(iv=it[ir])[0])/2,"V",iv[1])
}if(iw>1){iu.push("H",iv[0])
}return iu.join("")
}function bq(it){var ir=0,iw=it.length,iv=it[0],iu=[iv[0],",",iv[1]];
while(++ir<iw){iu.push("V",(iv=it[ir])[1],"H",iv[0])
}return iu.join("")
}function hI(it){var ir=0,iw=it.length,iv=it[0],iu=[iv[0],",",iv[1]];
while(++ir<iw){iu.push("H",(iv=it[ir])[0],"V",iv[1])
}return iu.join("")
}function b7(it,ir){return it.length<4?h3(it):it[1]+c5(it.slice(1,it.length-1),bZ(it,ir))
}function u(it,ir){return it.length<3?h3(it):it[0]+c5((it.push(it[0]),it),bZ([it[it.length-2]].concat(it,[it[1]]),ir))
}function d4(it,ir){return it.length<3?h3(it):it[0]+c5(it,bZ(it,ir))
}function c5(iy,ix){if(ix.length<1||iy.length!=ix.length&&iy.length!=ix.length+2){return h3(iy)
}var iz=iy.length!=ix.length,iC="",iA=iy[0],ir=iy[1],iw=ix[0],iB=iw,iu=1;
if(iz){iC+="Q"+(ir[0]-iw[0]*2/3)+","+(ir[1]-iw[1]*2/3)+","+ir[0]+","+ir[1];
iA=iy[1];
iu=2
}if(ix.length>1){iB=ix[1];
ir=iy[iu];
iu++;
iC+="C"+(iA[0]+iw[0])+","+(iA[1]+iw[1])+","+(ir[0]-iB[0])+","+(ir[1]-iB[1])+","+ir[0]+","+ir[1];
for(var it=2;
it<ix.length;
it++,iu++){ir=iy[iu];
iB=ix[it];
iC+="S"+(ir[0]-iB[0])+","+(ir[1]-iB[1])+","+ir[0]+","+ir[1]
}}if(iz){var iv=iy[iu];
iC+="Q"+(ir[0]+iB[0]*2/3)+","+(ir[1]+iB[1]*2/3)+","+iv[0]+","+iv[1]
}return iC
}function bZ(iy,iw){var iu=[],iv=(1-iw)/2,iA,iz=iy[0],ix=iy[1],it=1,ir=iy.length;
while(++it<ir){iA=iz;
iz=ix;
ix=iy[it];
iu.push([iv*(ix[0]-iA[0]),iv*(ix[1]-iA[1])])
}return iu
}function fu(iz){if(iz.length<3){return h3(iz)
}var iu=1,it=iz.length,iv=iz[0],ir=iv[0],ix=iv[1],iy=[ir,ir,ir,(iv=iz[1])[0]],iw=[ix,ix,ix,iv[1]],iA=[ir,",",ix,"L",gA(hx,iy),",",gA(hx,iw)];
iz.push(iz[it-1]);
while(++iu<=it){iv=iz[iu];
iy.shift();
iy.push(iv[0]);
iw.shift();
iw.push(iv[1]);
bT(iA,iy,iw)
}iz.pop();
iA.push("L",iv);
return iA.join("")
}function bn(iv){if(iv.length<4){return h3(iv)
}var ix=[],iu=-1,iy=iv.length,iw,it=[0],ir=[0];
while(++iu<3){iw=iv[iu];
it.push(iw[0]);
ir.push(iw[1])
}ix.push(gA(hx,it)+","+gA(hx,ir));
--iu;
while(++iu<iy){iw=iv[iu];
it.shift();
it.push(iw[0]);
ir.shift();
ir.push(iw[1]);
bT(ix,it,ir)
}return ix.join("")
}function cU(iw){var iy,iv=-1,iz=iw.length,ir=iz+4,ix,iu=[],it=[];
while(++iv<4){ix=iw[iv%iz];
iu.push(ix[0]);
it.push(ix[1])
}iy=[gA(hx,iu),",",gA(hx,it)];
--iv;
while(++iv<ir){ix=iw[iv%iz];
iu.shift();
iu.push(ix[0]);
it.shift();
it.push(ix[1]);
bT(iy,iu,it)
}return iy.join("")
}function cX(iy,ix){var iu=iy.length-1;
if(iu){var it=iy[0][0],iw=iy[0][1],iB=iy[iu][0]-it,iA=iy[iu][1]-iw,iv=-1,ir,iz;
while(++iv<=iu){ir=iy[iv];
iz=iv/iu;
ir[0]=ix*ir[0]+(1-ix)*(it+iz*iB);
ir[1]=ix*ir[1]+(1-ix)*(iw+iz*iA)
}}return fu(iy)
}function gA(it,ir){return it[0]*ir[0]+it[1]*ir[1]+it[2]*ir[2]+it[3]*ir[3]
}var hB=[0,2/3,1/3,0],hz=[0,1/3,2/3,0],hx=[0,1/6,2/3,1/6];
function bT(it,ir,iu){it.push("C",gA(hB,ir),",",gA(hB,iu),",",gA(hz,ir),",",gA(hz,iu),",",gA(hx,ir),",",gA(hx,iu))
}function ih(it,ir){return(ir[1]-it[1])/(ir[0]-it[0])
}function ek(iv){var iu=0,it=iv.length-1,ir=[],iy=iv[0],ix=iv[1],iw=ir[0]=ih(iy,ix);
while(++iu<it){ir[iu]=(iw+(iw=ih(iy=ix,ix=iv[iu+1])))/2
}ir[iu]=iw;
return ir
}function aA(iz){var iw=[],iv,iy,ix,iA,ir=ek(iz),iu=-1,it=iz.length-1;
while(++iu<it){iv=ih(iz[iu],iz[iu+1]);
if(cN(iv)<gB){ir[iu]=ir[iu+1]=0
}else{iy=ir[iu]/iv;
ix=ir[iu+1]/iv;
iA=iy*iy+ix*ix;
if(iA>9){iA=iv*3/Math.sqrt(iA);
ir[iu]=iA*iy;
ir[iu+1]=iA*ix
}}}iu=-1;
while(++iu<=it){iA=(iz[Math.min(it,iu+1)][0]-iz[Math.max(0,iu-1)][0])/(6*(1+ir[iu]*ir[iu]));
iw.push([iA||0,ir[iu]*iA||0])
}return iw
}function ds(ir){return ir.length<3?h3(ir):ir[0]+c5(ir,aA(ir))
}hy.svg.line.radial=function(){var ir=fp(V);
ir.radius=ir.x,delete ir.x;
ir.angle=ir.y,delete ir.y;
return ir
};
function V(iv){var ir,iu=-1,ix=iv.length,iw,it;
while(++iu<ix){ir=iv[iu];
iw=ir[0];
it=ir[1]+hS;
ir[0]=iw*Math.cos(it);
ir[1]=iw*Math.sin(it)
}return iv
}function ik(iw){var iu=h6,it=h6,iC=0,iA=h5,iv=ao,ix=h3,iD=ix.key,iz=ix,iy="L",iB=0.7;
function ir(iI){var iK=[],iE=[],iR=[],iJ=-1,iF=iI.length,iM,iH=Y(iu),iQ=Y(iC),iG=iu===it?function(){return iO
}:Y(it),iP=iC===iA?function(){return iN
}:Y(iA),iO,iN;
function iL(){iK.push("M",ix(iw(iR),iB),iy,iz(iw(iE.reverse()),iB),"Z")
}while(++iJ<iF){if(iv.call(this,iM=iI[iJ],iJ)){iE.push([iO=+iH.call(this,iM,iJ),iN=+iQ.call(this,iM,iJ)]);
iR.push([+iG.call(this,iM,iJ),+iP.call(this,iM,iJ)])
}else{if(iE.length){iL();
iE=[];
iR=[]
}}}if(iE.length){iL()
}return iK.length?iK.join(""):null
}ir.x=function(iE){if(!arguments.length){return it
}iu=it=iE;
return ir
};
ir.x0=function(iE){if(!arguments.length){return iu
}iu=iE;
return ir
};
ir.x1=function(iE){if(!arguments.length){return it
}it=iE;
return ir
};
ir.y=function(iE){if(!arguments.length){return iA
}iC=iA=iE;
return ir
};
ir.y0=function(iE){if(!arguments.length){return iC
}iC=iE;
return ir
};
ir.y1=function(iE){if(!arguments.length){return iA
}iA=iE;
return ir
};
ir.defined=function(iE){if(!arguments.length){return iv
}iv=iE;
return ir
};
ir.interpolate=function(iE){if(!arguments.length){return iD
}if(typeof iE==="function"){iD=ix=iE
}else{iD=(ix=ch.get(iE)||h3).key
}iz=ix.reverse||ix;
iy=ix.closed?"M":"L";
return ir
};
ir.tension=function(iE){if(!arguments.length){return iB
}iB=iE;
return ir
};
return ir
}bq.reverse=hI;
hI.reverse=bq;
hy.svg.area=function(){return ik(gy)
};
hy.svg.area.radial=function(){var ir=ik(V);
ir.radius=ir.x,delete ir.x;
ir.innerRadius=ir.x0,delete ir.x0;
ir.outerRadius=ir.x1,delete ir.x1;
ir.angle=ir.y,delete ir.y;
ir.startAngle=ir.y0,delete ir.y0;
ir.endAngle=ir.y1,delete ir.y1;
return ir
};
hy.svg.chord=function(){var ir=hT,iz=h2,iy=N,iA=gu,iw=aw;
function ix(iF,iD){var iE=iB(this,ir,iF,iD),iC=iB(this,iz,iF,iD);
return"M"+iE.p0+it(iE.r,iE.p1,iE.a1-iE.a0)+(iu(iE,iC)?iv(iE.r,iE.p1,iE.r,iE.p0):iv(iE.r,iE.p1,iC.r,iC.p0)+it(iC.r,iC.p1,iC.a1-iC.a0)+iv(iC.r,iC.p1,iE.r,iE.p0))+"Z"
}function iB(iF,iI,iJ,iG){var iE=iI.call(iF,iJ,iG),iH=iy.call(iF,iE,iG),iD=iA.call(iF,iE,iG)+hS,iC=iw.call(iF,iE,iG)+hS;
return{r:iH,a0:iD,a1:iC,p0:[iH*Math.cos(iD),iH*Math.sin(iD)],p1:[iH*Math.cos(iC),iH*Math.sin(iC)]}
}function iu(iD,iC){return iD.a0==iC.a0&&iD.a1==iC.a1
}function it(iD,iE,iC){return"A"+iD+","+iD+" 0 "+ +(iC>gr)+",1 "+iE
}function iv(iD,iF,iC,iE){return"Q 0,0 "+iE
}ix.radius=function(iC){if(!arguments.length){return iy
}iy=Y(iC);
return ix
};
ix.source=function(iC){if(!arguments.length){return ir
}ir=Y(iC);
return ix
};
ix.target=function(iC){if(!arguments.length){return iz
}iz=Y(iC);
return ix
};
ix.startAngle=function(iC){if(!arguments.length){return iA
}iA=Y(iC);
return ix
};
ix.endAngle=function(iC){if(!arguments.length){return iw
}iw=Y(iC);
return ix
};
return ix
};
function N(ir){return ir.radius
}hy.svg.diagonal=function(){var iu=hT,iv=h2,ir=o;
function it(iA,ix){var iB=iu.call(this,iA,ix),iy=iv.call(this,iA,ix),iw=(iB.y+iy.y)/2,iz=[iB,{x:iB.x,y:iw},{x:iy.x,y:iw},iy];
iz=iz.map(ir);
return"M"+iz[0]+"C"+iz[1]+" "+iz[2]+" "+iz[3]
}it.source=function(iw){if(!arguments.length){return iu
}iu=Y(iw);
return it
};
it.target=function(iw){if(!arguments.length){return iv
}iv=Y(iw);
return it
};
it.projection=function(iw){if(!arguments.length){return ir
}ir=iw;
return it
};
return it
};
function o(ir){return[ir.x,ir.y]
}hy.svg.diagonal.radial=function(){var iu=hy.svg.diagonal(),ir=o,it=iu.projection;
iu.projection=function(iv){return arguments.length?it(p(ir=iv)):ir
};
return iu
};
function p(ir){return function(){var iv=ir.apply(this,arguments),iu=iv[0],it=iv[1]+hS;
return[iu*Math.cos(it),iu*Math.sin(it)]
}
}hy.svg.symbol=function(){var it=a0,ir=fk;
function iu(iw,iv){return(hZ.get(it.call(this,iw,iv))||cj)(ir.call(this,iw,iv))
}iu.type=function(iv){if(!arguments.length){return it
}it=Y(iv);
return iu
};
iu.size=function(iv){if(!arguments.length){return ir
}ir=Y(iv);
return iu
};
return iu
};
function fk(){return 64
}function a0(){return"circle"
}function cj(ir){var it=Math.sqrt(ir/gr);
return"M0,"+it+"A"+it+","+it+" 0 1,1 0,"+-it+"A"+it+","+it+" 0 1,1 0,"+it+"Z"
}var hZ=hy.map({circle:cj,cross:function(ir){var it=Math.sqrt(ir/5)/2;
return"M"+-3*it+","+-it+"H"+-it+"V"+-3*it+"H"+it+"V"+-it+"H"+3*it+"V"+it+"H"+it+"V"+3*it+"H"+-it+"V"+it+"H"+-3*it+"Z"
},diamond:function(ir){var it=Math.sqrt(ir/(2*cr)),iu=it*cr;
return"M0,"+-it+"L"+iu+",0 0,"+it+" "+-iu+",0Z"
},square:function(ir){var it=Math.sqrt(ir)/2;
return"M"+-it+","+-it+"L"+it+","+-it+" "+it+","+it+" "+-it+","+it+"Z"
},"triangle-down":function(ir){var iu=Math.sqrt(ir/cb),it=iu*cb/2;
return"M0,"+it+"L"+iu+","+-it+" "+-iu+","+-it+"Z"
},"triangle-up":function(ir){var iu=Math.sqrt(ir/cb),it=iu*cb/2;
return"M0,"+-it+"L"+iu+","+it+" "+-iu+","+it+"Z"
}});
hy.svg.symbolTypes=hZ.keys();
var cb=Math.sqrt(3),cr=Math.tan(30*P);
function g2(ir,it){ij(ir,eF);
ir.id=it;
return ir
}var eF=[],hm=0,ay,eg;
eF.call=d9.call;
eF.empty=d9.empty;
eF.node=d9.node;
eF.size=d9.size;
hy.transition=function(ir){return arguments.length?ay?ir.transition():ir:g4.transition()
};
hy.transition.prototype=eF;
eF.select=function(iy){var ir=this.id,iv=[],iC,it,iw;
iy=D(iy);
for(var iz=-1,ix=this.length;
++iz<ix;
){iv.push(iC=[]);
for(var iB=this[iz],iA=-1,iu=iB.length;
++iA<iu;
){if((iw=iB[iA])&&(it=iy.call(iw,iw.__data__,iA,iz))){if("__data__" in iw){it.__data__=iw.__data__
}fR(it,iA,ir,iw.__transition__[ir]);
iC.push(it)
}else{iC.push(null)
}}}return g2(iv,ir)
};
eF.selectAll=function(iA){var it=this.id,ix=[],iG,ir,iz,iu,iE;
iA=c9(iA);
for(var iC=-1,iy=this.length;
++iC<iy;
){for(var iF=this[iC],iD=-1,iw=iF.length;
++iD<iw;
){if(iz=iF[iD]){iE=iz.__transition__[it];
ir=iA.call(iz,iz.__data__,iD,iC);
ix.push(iG=[]);
for(var iB=-1,iv=ir.length;
++iB<iv;
){if(iu=ir[iB]){fR(iu,iB,it,iE)
}iG.push(iu)
}}}}return g2(ix,it)
};
eF.filter=function(ir){var iu=[],iA,iz,iv;
if(typeof ir!=="function"){ir=bd(ir)
}for(var ix=0,iw=this.length;
ix<iw;
ix++){iu.push(iA=[]);
for(var iz=this[ix],iy=0,it=iz.length;
iy<it;
iy++){if((iv=iz[iy])&&ir.call(iv,iv.__data__,iy,ix)){iA.push(iv)
}}}return g2(iu,this.id)
};
eF.tween=function(ir,it){var iu=this.id;
if(arguments.length<2){return this.node().__transition__[iu].tween.get(ir)
}return cP(this,it==null?function(iv){iv.__transition__[iu].tween.remove(ir)
}:function(iv){iv.__transition__[iu].tween.set(ir,it)
})
};
function hY(ir,it,iv,iu){var iw=ir.id;
return cP(ir,typeof iv==="function"?function(iz,iy,ix){iz.__transition__[iw].tween.set(it,iu(iv.call(iz,iz.__data__,iy,ix)))
}:(iv=iu(iv),function(ix){ix.__transition__[iw].tween.set(it,iv)
}))
}eF.attr=function(ir,ix){if(arguments.length<2){for(ix in ir){this.attr(ix,ir[ix])
}return this
}var iv=ir=="transform"?et:fS,iu=hy.ns.qualify(ir);
function it(){this.removeAttribute(iu)
}function iz(){this.removeAttributeNS(iu.space,iu.local)
}function iw(iA){return iA==null?it:(iA+="",function(){var iB=this.getAttribute(iu),iC;
return iB!==iA&&(iC=iv(iB,iA),function(iD){this.setAttribute(iu,iC(iD))
})
})
}function iy(iA){return iA==null?iz:(iA+="",function(){var iB=this.getAttributeNS(iu.space,iu.local),iC;
return iB!==iA&&(iC=iv(iB,iA),function(iD){this.setAttributeNS(iu.space,iu.local,iC(iD))
})
})
}return hY(this,"attr."+ir,ix,iu.local?iy:iw)
};
eF.attrTween=function(ir,iu){var it=hy.ns.qualify(ir);
function iv(iz,ix){var iy=iu.call(this,iz,ix,this.getAttribute(it));
return iy&&function(iA){this.setAttribute(it,iy(iA))
}
}function iw(iz,ix){var iy=iu.call(this,iz,ix,this.getAttributeNS(it.space,it.local));
return iy&&function(iA){this.setAttributeNS(it.space,it.local,iy(iA))
}
}return this.tween("attr."+ir,it.local?iw:iv)
};
eF.style=function(iu,iw,iv){var ix=arguments.length;
if(ix<3){if(typeof iu!=="string"){if(ix<2){iw=""
}for(iv in iu){this.style(iv,iu[iv],iw)
}return this
}iv=""
}function it(){this.style.removeProperty(iu)
}function ir(iy){return iy==null?it:(iy+="",function(){var iz=fO.getComputedStyle(this,null).getPropertyValue(iu),iA;
return iz!==iy&&(iA=fS(iz,iy),function(iB){this.style.setProperty(iu,iA(iB),iv)
})
})
}return hY(this,"style."+iu,iw,ir)
};
eF.styleTween=function(ir,iu,it){if(arguments.length<3){it=""
}function iv(iy,iw){var ix=iu.call(this,iy,iw,fO.getComputedStyle(this,null).getPropertyValue(ir));
return ix&&function(iz){this.style.setProperty(ir,ix(iz),it)
}
}return this.tween("style."+ir,iv)
};
eF.text=function(ir){return hY(this,"text",ir,iq)
};
function iq(ir){if(ir==null){ir=""
}return function(){this.textContent=ir
}
}eF.remove=function(){return this.each("end.transition",function(){var ir;
if(this.__transition__.count<2&&(ir=this.parentNode)){ir.removeChild(this)
}})
};
eF.ease=function(ir){var it=this.id;
if(arguments.length<1){return this.node().__transition__[it].ease
}if(typeof ir!=="function"){ir=hy.ease.apply(hy,arguments)
}return cP(this,function(iu){iu.__transition__[it].ease=ir
})
};
eF.delay=function(ir){var it=this.id;
return cP(this,typeof ir==="function"?function(iw,iv,iu){iw.__transition__[it].delay=+ir.call(iw,iw.__data__,iv,iu)
}:(ir=+ir,function(iu){iu.__transition__[it].delay=ir
}))
};
eF.duration=function(ir){var it=this.id;
return cP(this,typeof ir==="function"?function(iw,iv,iu){iw.__transition__[it].duration=Math.max(1,ir.call(iw,iw.__data__,iv,iu))
}:(ir=Math.max(1,ir),function(iu){iu.__transition__[it].duration=ir
}))
};
eF.each=function(it,iu){var iw=this.id;
if(arguments.length<2){var ir=eg,iv=ay;
ay=iw;
cP(this,function(iz,iy,ix){eg=iz.__transition__[iw];
it.call(iz,iz.__data__,iy,ix)
});
eg=ir;
ay=iv
}else{cP(this,function(ix){var iy=ix.__transition__[iw];
(iy.event||(iy.event=hy.dispatch("start","end"))).on(it,iu)
})
}return this
};
eF.transition=function(){var iC=this.id,iB=++hm,it=[],iA,iz,iv,iy;
for(var iw=0,iu=this.length;
iw<iu;
iw++){it.push(iA=[]);
for(var iz=this[iw],ix=0,ir=iz.length;
ix<ir;
ix++){if(iv=iz[ix]){iy=Object.create(iv.__transition__[iC]);
iy.delay+=iy.duration;
fR(iv,ix,iB,iy)
}iA.push(iv)
}}return g2(it,iB)
};
function fR(iv,iu,iy,ir){var it=iv.__transition__||(iv.__transition__={active:0,count:0}),ix=it[iy];
if(!ix){var iw=ir.time;
ix=it[iy]={tween:new aN(),time:iw,ease:ir.ease,delay:ir.delay,duration:ir.duration};
++it.count;
hy.timer(function(iI){var iF=iv.__data__,iB=ix.ease,iD=ix.delay,iC=ix.duration,iz=dt,iH=[];
iz.t=iD+iw;
if(iD<=iI){return iA(iI-iD)
}iz.c=iA;
function iA(iJ){if(it.active>iy){return iG()
}it.active=iy;
ix.event&&ix.event.start.call(iv,iF,iu);
ix.tween.forEach(function(iK,iL){if(iL=iL.call(iv,iF,iu)){iH.push(iL)
}});
hy.timer(function(){iz.c=iE(iJ||1)?ao:iE;
return 1
},0,iw)
}function iE(iJ){if(it.active!==iy){return iG()
}var iK=iJ/iC,iL=iB(iK),iM=iH.length;
while(iM>0){iH[--iM].call(iv,iL)
}if(iK>=1){ix.event&&ix.event.end.call(iv,iF,iu);
return iG()
}}function iG(){if(--it.count){delete it[iy]
}else{delete iv.__transition__
}return 1
}},0,iw)
}}hy.svg.axis=function(){var iu=hy.scale.linear(),iw=h8,ir=6,ix=6,iA=3,iz=[10],iv=null,iy;
function it(iB){iB.each(function(){var iS=hy.select(this);
var iP=this.__chart__||iu,iO=this.__chart__=iu.copy();
var iU=iv==null?iO.ticks?iO.ticks.apply(iO,iz):iO.domain():iv,iN=iy==null?iO.tickFormat?iO.tickFormat.apply(iO,iz):gy:iy,iQ=iS.selectAll(".tick").data(iU,iO),iK=iQ.enter().insert("g",".domain").attr("class","tick").style("opacity",gB),iM=hy.transition(iQ.exit()).style("opacity",gB).remove(),iE=hy.transition(iQ).style("opacity",1),iC;
var iJ=a4(iO),iL=iS.selectAll(".domain").data([0]),iV=(iL.enter().append("path").attr("class","domain"),hy.transition(iL));
iK.append("line");
iK.append("text");
var iD=iK.select("line"),iT=iE.select("line"),iI=iQ.select("text").text(iN),iF=iK.select("text"),iR=iE.select("text");
switch(iw){case"bottom":iC=fB;
iD.attr("y2",ir);
iF.attr("y",Math.max(ir,0)+iA);
iT.attr("x2",0).attr("y2",ir);
iR.attr("x",0).attr("y",Math.max(ir,0)+iA);
iI.attr("dy",".71em").style("text-anchor","middle");
iV.attr("d","M"+iJ[0]+","+ix+"V0H"+iJ[1]+"V"+ix);
break;
case"top":iC=fB;
iD.attr("y2",-ir);
iF.attr("y",-(Math.max(ir,0)+iA));
iT.attr("x2",0).attr("y2",-ir);
iR.attr("x",0).attr("y",-(Math.max(ir,0)+iA));
iI.attr("dy","0em").style("text-anchor","middle");
iV.attr("d","M"+iJ[0]+","+-ix+"V0H"+iJ[1]+"V"+-ix);
break;
case"left":iC=fA;
iD.attr("x2",-ir);
iF.attr("x",-(Math.max(ir,0)+iA));
iT.attr("x2",-ir).attr("y2",0);
iR.attr("x",-(Math.max(ir,0)+iA)).attr("y",0);
iI.attr("dy",".32em").style("text-anchor","end");
iV.attr("d","M"+-ix+","+iJ[0]+"H0V"+iJ[1]+"H"+-ix);
break;
case"right":iC=fA;
iD.attr("x2",ir);
iF.attr("x",Math.max(ir,0)+iA);
iT.attr("x2",ir).attr("y2",0);
iR.attr("x",Math.max(ir,0)+iA).attr("y",0);
iI.attr("dy",".32em").style("text-anchor","start");
iV.attr("d","M"+ix+","+iJ[0]+"H0V"+iJ[1]+"H"+ix);
break
}if(iO.rangeBand){var iG=iO,iH=iG.rangeBand()/2;
iP=iO=function(iW){return iG(iW)+iH
}
}else{if(iP.rangeBand){iP=iO
}else{iM.call(iC,iO)
}}iK.call(iC,iP);
iE.call(iC,iO)
})
}it.scale=function(iB){if(!arguments.length){return iu
}iu=iB;
return it
};
it.orient=function(iB){if(!arguments.length){return iw
}iw=iB in ff?iB+"":h8;
return it
};
it.ticks=function(){if(!arguments.length){return iz
}iz=arguments;
return it
};
it.tickValues=function(iB){if(!arguments.length){return iv
}iv=iB;
return it
};
it.tickFormat=function(iB){if(!arguments.length){return iy
}iy=iB;
return it
};
it.tickSize=function(iB){var iC=arguments.length;
if(!iC){return ir
}ir=+iB;
ix=+arguments[iC-1];
return it
};
it.innerTickSize=function(iB){if(!arguments.length){return ir
}ir=+iB;
return it
};
it.outerTickSize=function(iB){if(!arguments.length){return ix
}ix=+iB;
return it
};
it.tickPadding=function(iB){if(!arguments.length){return iA
}iA=+iB;
return it
};
it.tickSubdivide=function(){return arguments.length&&it
};
return it
};
var h8="bottom",ff={top:1,right:1,bottom:1,left:1};
function fB(it,ir){it.attr("transform",function(iu){return"translate("+ir(iu)+",0)"
})
}function fA(ir,it){ir.attr("transform",function(iu){return"translate(0,"+it(iu)+")"
})
}hy.svg.brush=function(){var it=ht(iA,"brushstart","brush","brushend"),iD=null,iB=null,iu=[0,0],iz=[0,0],iC,iw,ir=true,iy=true,iE=az[0];
function iA(iH){iH.each(function(){var iN=hy.select(this).style("pointer-events","all").style("-webkit-tap-highlight-color","rgba(0,0,0,0)").on("mousedown.brush",iF).on("touchstart.brush",iF);
var iM=iN.selectAll(".background").data([0]);
iM.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair");
iN.selectAll(".extent").data([0]).enter().append("rect").attr("class","extent").style("cursor","move");
var iL=iN.selectAll(".resize").data(iE,gy);
iL.exit().remove();
iL.enter().append("g").attr("class",function(iO){return"resize "+iO
}).style("cursor",function(iO){return e7[iO]
}).append("rect").attr("x",function(iO){return/[ew]$/.test(iO)?-3:null
}).attr("y",function(iO){return/^[ns]/.test(iO)?-3:null
}).attr("width",6).attr("height",6).style("visibility","hidden");
iL.style("display",iA.empty()?"none":null);
var iK=hy.transition(iN),iI=hy.transition(iM),iJ;
if(iD){iJ=a4(iD);
iI.attr("x",iJ[0]).attr("width",iJ[1]-iJ[0]);
ix(iK)
}if(iB){iJ=a4(iB);
iI.attr("y",iJ[0]).attr("height",iJ[1]-iJ[0]);
iv(iK)
}iG(iK)
})
}iA.event=function(iH){iH.each(function(){var iI=it.of(this,arguments),iJ={x:iu,y:iz,i:iC,j:iw},iK=this.__chart__||iJ;
this.__chart__=iJ;
if(ay){hy.select(this).transition().each("start.brush",function(){iC=iK.i;
iw=iK.j;
iu=iK.x;
iz=iK.y;
iI({type:"brushstart"})
}).tween("brush:brush",function(){var iL=eZ(iu,iJ.x),iM=eZ(iz,iJ.y);
iC=iw=null;
return function(iN){iu=iJ.x=iL(iN);
iz=iJ.y=iM(iN);
iI({type:"brush",mode:"resize"})
}
}).each("end.brush",function(){iC=iJ.i;
iw=iJ.j;
iI({type:"brush",mode:"resize"});
iI({type:"brushend"})
})
}else{iI({type:"brushstart"});
iI({type:"brush",mode:"resize"});
iI({type:"brushend"})
}})
};
function iG(iH){iH.selectAll(".resize").attr("transform",function(iI){return"translate("+iu[+/e$/.test(iI)]+","+iz[+/^s/.test(iI)]+")"
})
}function ix(iH){iH.select(".extent").attr("x",iu[0]);
iH.selectAll(".extent,.n>rect,.s>rect").attr("width",iu[1]-iu[0])
}function iv(iH){iH.select(".extent").attr("y",iz[0]);
iH.selectAll(".extent,.e>rect,.w>rect").attr("height",iz[1]-iz[0])
}function iF(){var i0=this,iI=hy.select(hy.event.target),iP=it.of(i0,arguments),iV=hy.select(i0),iX=iI.datum(),iT=!/^(n|s)$/.test(iX)&&iD,iR=!/^(e|w)$/.test(iX)&&iB,iS=iI.classed("extent"),iK=bP(),iY,iZ=hy.mouse(i0),iJ;
var iN=hy.select(fO).on("keydown.brush",iQ).on("keyup.brush",iM);
if(hy.event.changedTouches){iN.on("touchmove.brush",iO).on("touchend.brush",iH)
}else{iN.on("mousemove.brush",iO).on("mouseup.brush",iH)
}iV.interrupt().selectAll("*").interrupt();
if(iS){iZ[0]=iu[0]-iZ[0];
iZ[1]=iz[0]-iZ[1]
}else{if(iX){var iW=+/w$/.test(iX),iU=+/^n/.test(iX);
iJ=[iu[1-iW]-iZ[0],iz[1-iU]-iZ[1]];
iZ[0]=iu[iW];
iZ[1]=iz[iU]
}else{if(hy.event.altKey){iY=iZ.slice()
}}}iV.style("pointer-events","none").selectAll(".resize").style("display",null);
hy.select("body").style("cursor",iI.style("cursor"));
iP({type:"brushstart"});
iO();
function iQ(){if(hy.event.keyCode==32){if(!iS){iY=null;
iZ[0]-=iu[1];
iZ[1]-=iz[1];
iS=2
}A()
}}function iM(){if(hy.event.keyCode==32&&iS==2){iZ[0]+=iu[1];
iZ[1]+=iz[1];
iS=0;
A()
}}function iO(){var i1=hy.mouse(i0),i2=false;
if(iJ){i1[0]+=iJ[0];
i1[1]+=iJ[1]
}if(!iS){if(hy.event.altKey){if(!iY){iY=[(iu[0]+iu[1])/2,(iz[0]+iz[1])/2]
}iZ[0]=iu[+(i1[0]<iY[0])];
iZ[1]=iz[+(i1[1]<iY[1])]
}else{iY=null
}}if(iT&&iL(i1,iD,0)){ix(iV);
i2=true
}if(iR&&iL(i1,iB,1)){iv(iV);
i2=true
}if(i2){iG(iV);
iP({type:"brush",mode:iS?"move":"resize"})
}}function iL(i9,i3,i5){var i6=a4(i3),i2=i6[0],i1=i6[1],i7=iZ[i5],ja=i5?iz:iu,jb=ja[1]-ja[0],i4,i8;
if(iS){i2-=i7;
i1-=jb+i7
}i4=(i5?iy:ir)?Math.max(i2,Math.min(i1,i9[i5])):i9[i5];
if(iS){i8=(i4+=i7)+jb
}else{if(iY){i7=Math.max(i2,Math.min(i1,2*iY[i5]-i4))
}if(i7<i4){i8=i4;
i4=i7
}else{i8=i7
}}if(ja[0]!=i4||ja[1]!=i8){if(i5){iw=null
}else{iC=null
}ja[0]=i4;
ja[1]=i8;
return true
}}function iH(){iO();
iV.style("pointer-events","all").selectAll(".resize").style("display",iA.empty()?"none":null);
hy.select("body").style("cursor",null);
iN.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);
iK();
iP({type:"brushend"})
}}iA.x=function(iH){if(!arguments.length){return iD
}iD=iH;
iE=az[!iD<<1|!iB];
return iA
};
iA.y=function(iH){if(!arguments.length){return iB
}iB=iH;
iE=az[!iD<<1|!iB];
return iA
};
iA.clamp=function(iH){if(!arguments.length){return iD&&iB?[ir,iy]:iD?ir:iB?iy:null
}if(iD&&iB){ir=!!iH[0],iy=!!iH[1]
}else{if(iD){ir=!!iH
}else{if(iB){iy=!!iH
}}}return iA
};
iA.extent=function(iM){var iJ,iH,iL,iK,iI;
if(!arguments.length){if(iD){if(iC){iJ=iC[0],iH=iC[1]
}else{iJ=iu[0],iH=iu[1];
if(iD.invert){iJ=iD.invert(iJ),iH=iD.invert(iH)
}if(iH<iJ){iI=iJ,iJ=iH,iH=iI
}}}if(iB){if(iw){iL=iw[0],iK=iw[1]
}else{iL=iz[0],iK=iz[1];
if(iB.invert){iL=iB.invert(iL),iK=iB.invert(iK)
}if(iK<iL){iI=iL,iL=iK,iK=iI
}}}return iD&&iB?[[iJ,iL],[iH,iK]]:iD?[iJ,iH]:iB&&[iL,iK]
}if(iD){iJ=iM[0],iH=iM[1];
if(iB){iJ=iJ[0],iH=iH[0]
}iC=[iJ,iH];
if(iD.invert){iJ=iD(iJ),iH=iD(iH)
}if(iH<iJ){iI=iJ,iJ=iH,iH=iI
}if(iJ!=iu[0]||iH!=iu[1]){iu=[iJ,iH]
}}if(iB){iL=iM[0],iK=iM[1];
if(iD){iL=iL[1],iK=iK[1]
}iw=[iL,iK];
if(iB.invert){iL=iB(iL),iK=iB(iK)
}if(iK<iL){iI=iL,iL=iK,iK=iI
}if(iL!=iz[0]||iK!=iz[1]){iz=[iL,iK]
}}return iA
};
iA.clear=function(){if(!iA.empty()){iu=[0,0],iz=[0,0];
iC=iw=null
}return iA
};
iA.empty=function(){return !!iD&&iu[0]==iu[1]||!!iB&&iz[0]==iz[1]
};
return hy.rebind(iA,it,"on")
};
var e7={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};
var az=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];
var fW=hy.time={},hC=Date,r=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];
function co(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])
}co.prototype={getDate:function(){return this._.getUTCDate()
},getDay:function(){return this._.getUTCDay()
},getFullYear:function(){return this._.getUTCFullYear()
},getHours:function(){return this._.getUTCHours()
},getMilliseconds:function(){return this._.getUTCMilliseconds()
},getMinutes:function(){return this._.getUTCMinutes()
},getMonth:function(){return this._.getUTCMonth()
},getSeconds:function(){return this._.getUTCSeconds()
},getTime:function(){return this._.getTime()
},getTimezoneOffset:function(){return 0
},valueOf:function(){return this._.valueOf()
},setDate:function(){gg.setUTCDate.apply(this._,arguments)
},setDay:function(){gg.setUTCDay.apply(this._,arguments)
},setFullYear:function(){gg.setUTCFullYear.apply(this._,arguments)
},setHours:function(){gg.setUTCHours.apply(this._,arguments)
},setMilliseconds:function(){gg.setUTCMilliseconds.apply(this._,arguments)
},setMinutes:function(){gg.setUTCMinutes.apply(this._,arguments)
},setMonth:function(){gg.setUTCMonth.apply(this._,arguments)
},setSeconds:function(){gg.setUTCSeconds.apply(this._,arguments)
},setTime:function(){gg.setTime.apply(this._,arguments)
}};
var gg=Date.prototype;
var X="%a %b %e %X %Y",e6="%m/%d/%Y",dj="%H:%M:%S";
var cq=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],c0=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],cv=["January","February","March","April","May","June","July","August","September","October","November","December"],aP=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];
function c7(ix,ir,it){function iA(iB){var iD=ix(iB),iC=iv(iD,1);
return iB-iD<iC-iB?iD:iC
}function iz(iB){ir(iB=ix(new hC(iB-1)),1);
return iB
}function iv(iC,iB){ir(iC=new hC(+iC),iB);
return iC
}function iw(iD,iC,iB){var iE=iz(iD),iF=[];
if(iB>1){while(iE<iC){if(!(it(iE)%iB)){iF.push(new Date(+iE))
}ir(iE,1)
}}else{while(iE<iC){iF.push(new Date(+iE)),ir(iE,1)
}}return iF
}function iu(iE,iD,iC){try{hC=co;
var iB=new co();
iB._=iE;
return iw(iB,iD,iC)
}finally{hC=Date
}}ix.floor=ix;
ix.round=iA;
ix.ceil=iz;
ix.offset=iv;
ix.range=iw;
var iy=ix.utc=d2(ix);
iy.floor=iy;
iy.round=d2(iA);
iy.ceil=d2(iz);
iy.offset=d2(iv);
iy.range=iu;
return ix
}function d2(ir){return function(iu,it){try{hC=co;
var iv=new co();
iv._=iu;
return ir(iv,it)._
}finally{hC=Date
}}
}fW.year=c7(function(ir){ir=fW.day(ir);
ir.setMonth(0,1);
return ir
},function(ir,it){ir.setFullYear(ir.getFullYear()+it)
},function(ir){return ir.getFullYear()
});
fW.years=fW.year.range;
fW.years.utc=fW.year.utc.range;
fW.day=c7(function(it){var ir=new hC(2000,0);
ir.setFullYear(it.getFullYear(),it.getMonth(),it.getDate());
return ir
},function(ir,it){ir.setDate(ir.getDate()+it)
},function(ir){return ir.getDate()-1
});
fW.days=fW.day.range;
fW.days.utc=fW.day.utc.range;
fW.dayOfYear=function(ir){var it=fW.year(ir);
return Math.floor((ir-it-(ir.getTimezoneOffset()-it.getTimezoneOffset())*60000)/86400000)
};
r.forEach(function(it,iu){it=it.toLowerCase();
iu=7-iu;
var ir=fW[it]=c7(function(iv){(iv=fW.day(iv)).setDate(iv.getDate()-(iv.getDay()+iu)%7);
return iv
},function(iv,iw){iv.setDate(iv.getDate()+Math.floor(iw)*7)
},function(iw){var iv=fW.year(iw).getDay();
return Math.floor((fW.dayOfYear(iw)+(iv+iu)%7)/7)-(iv!==iu)
});
fW[it+"s"]=ir.range;
fW[it+"s"].utc=ir.utc.range;
fW[it+"OfYear"]=function(iw){var iv=fW.year(iw).getDay();
return Math.floor((fW.dayOfYear(iw)+(iv+iu)%7)/7)
}
});
fW.week=fW.sunday;
fW.weeks=fW.sunday.range;
fW.weeks.utc=fW.sunday.utc.range;
fW.weekOfYear=fW.sundayOfYear;
fW.format=ip;
function ip(ir){var iu=ir.length;
function it(ix){var iw=[],iy=-1,iv=0,iB,iA,iz;
while(++iy<iu){if(ir.charCodeAt(iy)===37){iw.push(ir.substring(iv,iy));
if((iA=aS[iB=ir.charAt(++iy)])!=null){iB=ir.charAt(++iy)
}if(iz=gL[iB]){iB=iz(ix,iA==null?iB==="e"?" ":"0":iA)
}iw.push(iB);
iv=iy+1
}}iw.push(ir.substring(iv,iy));
return iw.join("")
}it.parse=function(ix){var iz={y:1900,m:0,d:1,H:0,M:0,S:0,L:0,Z:null},iy=ef(iz,ir,ix,0);
if(iy!=ix.length){return null
}if("p" in iz){iz.H=iz.H%12+iz.p*12
}var iv=iz.Z!=null&&hC!==co,iw=new (iv?co:hC)();
if("j" in iz){iw.setFullYear(iz.y,0,iz.j)
}else{if("w" in iz&&("W" in iz||"U" in iz)){iw.setFullYear(iz.y,0,1);
iw.setFullYear(iz.y,0,"W" in iz?(iz.w+6)%7+iz.W*7-(iw.getDay()+5)%7:iz.w+iz.U*7-(iw.getDay()+6)%7)
}else{iw.setFullYear(iz.y,iz.m,iz.d)
}}iw.setHours(iz.H+Math.floor(iz.Z/100),iz.M+iz.Z%100,iz.S,iz.L);
return iv?iw._:iw
};
it.toString=function(){return ir
};
return it
}function ef(iv,iA,iy,iw){var iz,ir,iB,ix=0,it=iA.length,iu=iy.length;
while(ix<it){if(iw>=iu){return -1
}iz=iA.charCodeAt(ix++);
if(iz===37){iB=iA.charAt(ix++);
ir=h0[iB in aS?iA.charAt(ix++):iB];
if(!ir||(iw=ir(iv,iy,iw))<0){return -1
}}else{if(iz!=iy.charCodeAt(iw++)){return -1
}}}return iw
}function cR(ir){return new RegExp("^(?:"+ir.map(hy.requote).join("|")+")","i")
}function g6(iu){var it=new aN(),ir=-1,iv=iu.length;
while(++ir<iv){it.set(iu[ir].toLowerCase(),ir)
}return it
}function dG(iw,ix,iu){var ir=iw<0?"-":"",it=(ir?-iw:iw)+"",iv=it.length;
return ir+(iv<iu?new Array(iu-iv+1).join(ix)+it:it)
}var hM=cR(cq),bg=g6(cq),fY=cR(c0),el=g6(c0),hj=cR(cv),fL=g6(cv),fb=cR(aP),fi=g6(aP),fn=/^%/;
var aS={"-":"",_:" ","0":"0"};
var gL={a:function(ir){return c0[ir.getDay()]
},A:function(ir){return cq[ir.getDay()]
},b:function(ir){return aP[ir.getMonth()]
},B:function(ir){return cv[ir.getMonth()]
},c:ip(X),d:function(it,ir){return dG(it.getDate(),ir,2)
},e:function(it,ir){return dG(it.getDate(),ir,2)
},H:function(it,ir){return dG(it.getHours(),ir,2)
},I:function(it,ir){return dG(it.getHours()%12||12,ir,2)
},j:function(it,ir){return dG(1+fW.dayOfYear(it),ir,3)
},L:function(it,ir){return dG(it.getMilliseconds(),ir,3)
},m:function(it,ir){return dG(it.getMonth()+1,ir,2)
},M:function(it,ir){return dG(it.getMinutes(),ir,2)
},p:function(ir){return ir.getHours()>=12?"PM":"AM"
},S:function(it,ir){return dG(it.getSeconds(),ir,2)
},U:function(it,ir){return dG(fW.sundayOfYear(it),ir,2)
},w:function(ir){return ir.getDay()
},W:function(it,ir){return dG(fW.mondayOfYear(it),ir,2)
},x:ip(e6),X:ip(dj),y:function(it,ir){return dG(it.getFullYear()%100,ir,2)
},Y:function(it,ir){return dG(it.getFullYear()%10000,ir,4)
},Z:gb,"%":function(){return"%"
}};
var h0={a:hd,A:cK,b:a6,B:fc,c:eG,d:b6,e:b6,H:aV,I:aV,j:K,L:g8,m:gV,M:c4,p:hK,S:d8,U:bw,w:d1,W:dR,x:il,X:gS,y:U,Y:bD,Z:a9,"%":fH};
function hd(it,ir,iu){fY.lastIndex=0;
var iv=fY.exec(ir.substring(iu));
return iv?(it.w=el.get(iv[0].toLowerCase()),iu+iv[0].length):-1
}function cK(it,ir,iu){hM.lastIndex=0;
var iv=hM.exec(ir.substring(iu));
return iv?(it.w=bg.get(iv[0].toLowerCase()),iu+iv[0].length):-1
}function d1(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+1));
return iv?(it.w=+iv[0],iu+iv[0].length):-1
}function bw(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu));
return iv?(it.U=+iv[0],iu+iv[0].length):-1
}function dR(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu));
return iv?(it.W=+iv[0],iu+iv[0].length):-1
}function a6(it,ir,iu){fb.lastIndex=0;
var iv=fb.exec(ir.substring(iu));
return iv?(it.m=fi.get(iv[0].toLowerCase()),iu+iv[0].length):-1
}function fc(it,ir,iu){hj.lastIndex=0;
var iv=hj.exec(ir.substring(iu));
return iv?(it.m=fL.get(iv[0].toLowerCase()),iu+iv[0].length):-1
}function eG(it,ir,iu){return ef(it,gL.c.toString(),ir,iu)
}function il(it,ir,iu){return ef(it,gL.x.toString(),ir,iu)
}function gS(it,ir,iu){return ef(it,gL.X.toString(),ir,iu)
}function bD(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+4));
return iv?(it.y=+iv[0],iu+iv[0].length):-1
}function U(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+2));
return iv?(it.y=da(+iv[0]),iu+iv[0].length):-1
}function a9(it,ir,iu){return/^[+-]\d{4}$/.test(ir=ir.substring(iu,iu+5))?(it.Z=+ir,iu+5):-1
}function da(ir){return ir+(ir>68?1900:2000)
}function gV(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+2));
return iv?(it.m=iv[0]-1,iu+iv[0].length):-1
}function b6(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+2));
return iv?(it.d=+iv[0],iu+iv[0].length):-1
}function K(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+3));
return iv?(it.j=+iv[0],iu+iv[0].length):-1
}function aV(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+2));
return iv?(it.H=+iv[0],iu+iv[0].length):-1
}function c4(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+2));
return iv?(it.M=+iv[0],iu+iv[0].length):-1
}function d8(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+2));
return iv?(it.S=+iv[0],iu+iv[0].length):-1
}function g8(it,ir,iu){gk.lastIndex=0;
var iv=gk.exec(ir.substring(iu,iu+3));
return iv?(it.L=+iv[0],iu+iv[0].length):-1
}var gk=/^\s*\d+/;
function hK(it,ir,iu){var iv=g.get(ir.substring(iu,iu+=2).toLowerCase());
return iv==null?-1:(it.p=iv,iu)
}var g=hy.map({am:0,pm:1});
function gb(iw){var iv=iw.getTimezoneOffset(),iu=iv>0?"-":"+",it=~~(cN(iv)/60),ir=cN(iv)%60;
return iu+dG(it,"0",2)+dG(ir,"0",2)
}function fH(it,ir,iu){fn.lastIndex=0;
var iv=fn.exec(ir.substring(iu,iu+1));
return iv?iu+iv[0].length:-1
}ip.utc=dp;
function dp(it){var ir=ip(it);
function iu(iv){try{hC=co;
var iw=new hC();
iw._=iv;
return ir(iw)
}finally{hC=Date
}}iu.parse=function(iw){try{hC=co;
var iv=ir.parse(iw);
return iv&&iv._
}finally{hC=Date
}};
iu.toString=ir.toString;
return iu
}var dZ=dp("%Y-%m-%dT%H:%M:%S.%LZ");
ip.iso=Date.prototype.toISOString&&+new Date("2000-01-01T00:00:00.000Z")?dF:dZ;
function dF(ir){return ir.toISOString()
}dF.parse=function(it){var ir=new Date(it);
return isNaN(ir)?null:ir
};
dF.toString=dZ.toString;
fW.second=c7(function(ir){return new hC(Math.floor(ir/1000)*1000)
},function(ir,it){ir.setTime(ir.getTime()+Math.floor(it)*1000)
},function(ir){return ir.getSeconds()
});
fW.seconds=fW.second.range;
fW.seconds.utc=fW.second.utc.range;
fW.minute=c7(function(ir){return new hC(Math.floor(ir/60000)*60000)
},function(ir,it){ir.setTime(ir.getTime()+Math.floor(it)*60000)
},function(ir){return ir.getMinutes()
});
fW.minutes=fW.minute.range;
fW.minutes.utc=fW.minute.utc.range;
fW.hour=c7(function(ir){var it=ir.getTimezoneOffset()/60;
return new hC((Math.floor(ir/3600000-it)+it)*3600000)
},function(ir,it){ir.setTime(ir.getTime()+Math.floor(it)*3600000)
},function(ir){return ir.getHours()
});
fW.hours=fW.hour.range;
fW.hours.utc=fW.hour.utc.range;
fW.month=c7(function(ir){ir=fW.day(ir);
ir.setDate(1);
return ir
},function(ir,it){ir.setMonth(ir.getMonth()+it)
},function(ir){return ir.getMonth()
});
fW.months=fW.month.range;
fW.months.utc=fW.month.utc.range;
function bt(ir,it,iu){function iv(ix){return ir(ix)
}iv.invert=function(ix){return gf(ir.invert(ix))
};
iv.domain=function(ix){if(!arguments.length){return ir.domain().map(gf)
}ir.domain(ix);
return iv
};
function iw(iz,iA){var iy=iz[1]-iz[0],iB=iy/iA,ix=hy.bisect(fr,iB);
return ix==fr.length?[it.year,s(iz.map(function(iC){return iC/31536000000
}),iA)[2]]:!ix?[cF,s(iz,iA)[2]]:it[iB/fr[ix-1]<fr[ix]/iB?ix-1:ix]
}iv.nice=function(iy,iA){var iB=iv.domain(),iz=eD(iB),iC=iy==null?iw(iz,10):typeof iy==="number"&&iw(iz,iy);
if(iC){iy=iC[0],iA=iC[1]
}function ix(iD){return !isNaN(iD)&&!iy.range(iD,gf(+iD+1),iA).length
}return iv.domain(gw(iB,iA>1?{floor:function(iD){while(ix(iD=iy.floor(iD))){iD=gf(iD-1)
}return iD
},ceil:function(iD){while(ix(iD=iy.ceil(iD))){iD=gf(+iD+1)
}return iD
}}:iy))
};
iv.ticks=function(ix,iz){var iy=eD(iv.domain()),iA=ix==null?iw(iy,10):typeof ix==="number"?iw(iy,ix):!ix.range&&[{range:ix},iz];
if(iA){ix=iA[0],iz=iA[1]
}return ix.range(iy[0],gf(+iy[1]+1),iz<1?1:iz)
};
iv.tickFormat=function(){return iu
};
iv.copy=function(){return bt(ir.copy(),it,iu)
};
return go(iv,ir)
}function gf(ir){return new Date(ir)
}function c3(ir){return function(it){var iu=ir.length-1,iv=ir[iu];
while(!iv[1](it)){iv=ir[--iu]
}return iv[0](it)
}
}var fr=[1000,5000,15000,30000,60000,300000,900000,1800000,3600000,10800000,21600000,43200000,86400000,172800000,604800000,2592000000,7776000000,31536000000];
var cJ=[[fW.second,1],[fW.second,5],[fW.second,15],[fW.second,30],[fW.minute,1],[fW.minute,5],[fW.minute,15],[fW.minute,30],[fW.hour,1],[fW.hour,3],[fW.hour,6],[fW.hour,12],[fW.day,1],[fW.day,2],[fW.week,1],[fW.month,1],[fW.month,3],[fW.year,1]];
var fM=[[ip("%Y"),ao],[ip("%B"),function(ir){return ir.getMonth()
}],[ip("%b %d"),function(ir){return ir.getDate()!=1
}],[ip("%a %d"),function(ir){return ir.getDay()&&ir.getDate()!=1
}],[ip("%I %p"),function(ir){return ir.getHours()
}],[ip("%I:%M"),function(ir){return ir.getMinutes()
}],[ip(":%S"),function(ir){return ir.getSeconds()
}],[ip(".%L"),function(ir){return ir.getMilliseconds()
}]];
var Z=c3(fM);
cJ.year=fW.year;
fW.scale=function(){return bt(hy.scale.linear(),cJ,Z)
};
var cF={range:function(iu,ir,it){return hy.range(+iu,+ir,it).map(gf)
},floor:gy,ceil:gy};
var h7=cJ.map(function(ir){return[ir[0].utc,ir[1]]
});
var cl=[[dp("%Y"),ao],[dp("%B"),function(ir){return ir.getUTCMonth()
}],[dp("%b %d"),function(ir){return ir.getUTCDate()!=1
}],[dp("%a %d"),function(ir){return ir.getUTCDay()&&ir.getUTCDate()!=1
}],[dp("%I %p"),function(ir){return ir.getUTCHours()
}],[dp("%I:%M"),function(ir){return ir.getUTCMinutes()
}],[dp(":%S"),function(ir){return ir.getUTCSeconds()
}],[dp(".%L"),function(ir){return ir.getUTCMilliseconds()
}]];
var fh=c3(cl);
h7.year=fW.year.utc;
fW.scale.utc=function(){return bt(hy.scale.linear(),h7,fh)
};
hy.text=ae(function(ir){return ir.responseText
});
hy.json=function(ir,it){return ib(ir,"application/json",dV,it)
};
function dV(ir){return JSON.parse(ir.responseText)
}hy.html=function(ir,it){return ib(ir,"text/html",io,it)
};
function io(it){var ir=bR.createRange();
ir.selectNode(bR.body);
return ir.createContextualFragment(it.responseText)
}hy.xml=ae(function(ir){return ir.responseXML
});
return hy
}();
(function(g,b){var k="jwv7ouu";
if(g.CUI&&g.CUI.options&&g.CUI.options.typeKitId){k=g.CUI.options.typeKitId
}var a={kitId:k,scriptTimeout:3000};
if(!g.Typekit){var f=document.getElementsByTagName("html")[0];
f.className+=" wf-loading";
var l=setTimeout(function(){f.className=f.className.replace(/(\s|^)wf-loading(\s|$)/g," ");
f.className+=" wf-inactive"
},a.scriptTimeout);
var n=document.createElement("script"),j=false;
n.src="//use.typekit.net/"+a.kitId+".js";
n.type="text/javascript";
n.async="true";
n.onload=n.onreadystatechange=function(){var h=this.readyState;
if(j||h&&h!="complete"&&h!="loaded"){return
}j=true;
clearTimeout(l);
try{Typekit.load(a)
}catch(d){}};
var m=document.getElementsByTagName("script")[0];
m.parentNode.insertBefore(n,m)
}}(this));
(function(){var W=d3.selection.prototype,d=W.on;
var m={tap:[["touchstart","touchend","touchmove"],Q]};
var o=null,t=false,Z=0,Y=0,J=0,I=0;
W.on=function(ah,aj,ae){var ai=ah.split("."),ag=ai.shift(),ak=m[ag];
if(ak){var af=ak[0],ad=this;
aj=ak[1].call(null,aj);
af.forEach(function(an,am){var al=[an,ai].join(".");
d.call(ad,al,aj,ae)
});
return d
}else{return d.apply(this,arguments)
}};
function Q(ad){return function(){if(d3.event.type==="touchstart"){o=g(d3.event);
J=Z=o.pageX;
I=Y=o.pageY;
t=true;
var ae=d3.event;
setTimeout(function(){if((J===Z)&&!t&&(I===Y)){d3.event=ae;
ad.apply(this,arguments)
}},200)
}if(d3.event.type==="touchend"&&t){t=false
}if(d3.event.type==="touchmove"&&t){o=g(d3.event);
Z=o.pageX;
Y=o.pageY
}}
}function g(ad){return ad.touches?ad.touches[0]:ad
}dv=function(){};
dv.version="3.1.0";
dv.ANIMATION=true;
var k=false,D=/xyz/.test(function(){xyz
})?/\b_super\b/:/.*/;
dv.extend=function(ag){var af=this.prototype;
k=true;
var ae=new this();
ag=ag();
ag.init=ag;
k=false;
for(var ah in ag){ae[ah]=typeof ag[ah]=="function"&&typeof af[ah]=="function"&&D.test(ag[ah])?(function(aj,ai){return function(){var al=this._super;
this._super=af[aj];
var ak=ai.apply(this,arguments);
this._super=al;
return ak
}
})(ah,ag[ah]):ag[ah]
}function ad(){if(!k){k=true;
var ai=new arguments.callee();
k=false;
ai.init.apply(ai,arguments);
return ai
}}ad.prototype=ae;
ad.mixin=function(ai,aj){if(dv.util.isObject(ai)){dv.util.each(ai,function(ak,al){ae[al]=aj
})
}else{ae[ai]=aj
}};
ad.extend=arguments.callee;
return ad
};
dv.DEFAULT_COLORS=["#1f77b4","#ff7f0e","#2ca02c","#d62728","#9467bd","#8c564b","#e377c2","#7f7f7f","#bcbd22","#17becf"];
dv.DEFAULT_CATEGORICAL_AES=["color","fill","stroke","shape","size","linetype"];
dv.absoluteCoordinates=function(af,ai,ae){if(af.coord() instanceof dv.coord.polar){var ah=af.coord().flip()?ae.yOuterScale():ae.xOuterScale(),ag=af.coord().flip()?ae.xOuterScale():ae.yOuterScale(),ad=dv.util.scaleRangeNoReverse(ah),aj=dv.util.scaleRangeNoReverse(ag);
ai[0]+=(ad[0]+ad[1])/2;
ai[1]+=(aj[0]+aj[1])/2
}return ai
};
dv.showTooltip=function(ae,ak,al,ag,ap,aq){var ai=aq.selectAll(".dv-tooltip").data([ae]);
ae.cx=ae.cx||ae.x+ae.width/2;
ae.cy=ae.cy||ae.y+ae.height/2;
ae.dx=ae.dx||ae.x+ae.width;
ae.dy=ae.dy||ae.y+ae.height;
ak.dx=ak.dy||ak.x+ak.width;
ak.dy=ak.dy||ak.y+ak.height;
var am=ai.enter().append("div").classed("dv-tooltip",true).style("top",0).style("left",0);
am.append("div").classed("content",true);
am.append("b").classed("notch",true);
ai.select(".content").html(al);
var ao=ai.select(".notch");
var ad=ai.node(),af=ad.offsetWidth,ar=ad.offsetHeight,an=0,ah=0,aj=function(av,au,at){return Math.min(Math.max(au,av),at)
};
switch(ag){case"left":ah=ae.x-af-ap;
an=ae.cy-ar/2;
if(ah<ak.x){ah=ae.dx+ap;
ag="right"
}if(an<ak.y){an=ak.y
}if(an+ar>ak.dy){an=ak.dy-ar
}ao.style("top",aj(ae.cy-an-5,3,ar-13)+"px");
break;
case"right":ah=ae.x+ae.width+ap;
an=ae.cy-ar/2;
if(ah+af>ak.dx){ah=ae.x-af-ap;
ag="left"
}if(an<ak.y){an=ak.y
}if(an+ar>ak.dy){an=ak.dy-ar
}ao.style("top",aj(ae.cy-an-5,3,ar-13)+"px");
break;
case"top":ah=ae.cx-af/2;
an=ae.y-ar-ap;
if(an<ak.y){an=ae.dy+ap;
ag="bottom"
}if(ah<ak.x){ah=ak.x
}if(ah+af>ak.dx){ah=ak.dx-af
}ao.style("left",aj(ae.cx-ah-5,3,af-13)+"px");
break;
case"bottom":ah=ae.cx-af/2;
an=ae.dy+ap;
if(an+ar>ak.dy){an=ae.y-ar-ap;
ag="top"
}if(ah<ak.x){ah=ak.x
}if(ah+af>ak.dx){ah=ak.dx-af
}ao.style("left",aj(ae.cx-ah-5,3,af-13)+"px");
break;
default:ag=null;
break
}an=Math.round(an);
ah=Math.round(ah);
ai.classed("top right left bottom hide",false).classed(ag,true);
am.style("top",an+"px").style("left",ah+"px");
ai.style("top",an+"px").style("left",ah+"px")
};
dv.removeTooltip=function(ad){ad.selectAll(".dv-tooltip").classed("hide",true)
};
dv.cancelEvent=function(ad){ad.stopPropagation();
ad.preventDefault()
};
dv.windowDimensions=function(){var ad={width:640,height:480};
if(document.body&&document.body.offsetWidth){ad.width=document.body.offsetWidth;
ad.height=document.body.offsetHeight
}if(document.compatMode=="CSS1Compat"&&document.documentElement&&document.documentElement.offsetWidth){ad.width=document.documentElement.offsetWidth;
ad.height=document.documentElement.offsetHeight
}if(window.innerWidth&&window.innerHeight){ad.width=window.innerWidth;
ad.height=window.innerHeight
}return ad
};
dv.addWindowResizeHandler=function(ad){window.addEventListener("resize",ad)
};
dv.removeWindowResizeHandler=function(ad){window.removeEventListener("resize",ad)
};
dv.scale=dv.extend(function(){function ad(ae){this._d3Scale=ae;
this._reverse=false;
this._parse=dv.util.identity;
this._includeInDomain=function(){return true
}
}ad._mapToD3Scale=function(ae){return this._d3Scale(ae)
};
ad.trainingProperties=function(ae){if(!arguments.length){if(this._trainingProperties){return this._trainingProperties
}if(this._property){return[this._property]
}return undefined
}if(!dv.util.isValidValue(ae,["isUndefined","isArray"])){dv.log.error({msg:"The supplied properties is not an array",data:{range:ae}})
}this._trainingProperties=ae;
return this
};
ad.trainDomain=function(ag,ae){var af=this.calculateDomain(ag,ae);
this.domain(af);
return af
};
ad.parse=function(ae){if(!arguments.length){return this._parse
}this._parse=ae;
return this
};
ad.applyRangePadding=function(){};
ad.validateDomain=function(){};
ad.mapToProp=function(af){var ag=af[this.property()],ae=this;
if(dv.util.isArray(ag)){return dv.util.map(ag,function(ah){return ae._mapToD3Scale.call(ae,ah)
})
}return this._mapToD3Scale.call(this,ag)
};
ad.mapPropToPercent=function(ae){return this.mapValueToPercent(this.mapToProp(ae))
};
ad.mapValueToPercent=function(ag){var af=dv.util.scaleRange(this),ae=af[1]-af[0];
if(dv.util.isArray(ag)){return dv.util.map(ag,function(ah){return ae?(ah-af[0])/ae:0
})
}return ae?(ag-af[0])/ae:0
};
ad.mapValue=function(af){if(dv.util.isArray(af)){var ae=this;
return dv.util.map(af,function(ag){return ae._mapToD3Scale.call(ae,ag)
})
}return this._mapToD3Scale.call(this,af)
};
ad.invertValue=function(ae){return this._d3Scale.invert(ae)
};
ad.rangeBand=function(ae){return 0
};
ad.reverse=function(af){if(!arguments.length){return this._reverse
}if(this._reverse!=af){this._reverse=af;
var ae=this._d3Scale.domain()||[];
this._d3Scale.domain(ae.reverse())
}return this
};
ad.property=function(ae){if(!arguments.length){return this._property
}this._property=ae;
return this
};
ad.mapping=function(ae){if(!arguments.length){return this._mapping
}this._mapping=ae;
return this
};
ad.domain=function(ae){if(!arguments.length){return this._d3Scale.domain()
}if(!this._d3Scale){return this
}ae=this._reverse?ae.reverse():ae;
this._d3Scale.domain(ae);
return this
};
ad.hasSameDomain=function(ah){var ag=true,af=this.domain();
if(af.length!=ah.length){ag=false
}else{for(var ae=0;
ae<ah.length;
ae++){if(ah[ae]!=af[ae]){ag=false;
break
}}}return ag
};
ad.range=function(ae){if(!arguments.length){return this._d3Scale.range()
}if(!this._d3Scale){return this
}if(!dv.util.isValidValue(ae,["isArray"])){dv.log.error({msg:"The supplied range is not an array",data:{range:ae}})
}this._d3Scale.range(ae);
return this
};
ad.expand=function(ae){if(!arguments.length){return this._expand
}this._expand=ae;
return this
};
ad.limits=function(ae){if(!arguments.length){return this._limits
}this._limits=ae;
return this
};
ad.breaks=function(ae){if(!arguments.length){return this._breaks
}this._breaks=ae;
return this
};
ad.orientation=function(ae){if(!arguments.length){return this._orientation
}this._orientation=ae;
return this
};
ad.includeInDomain=function(ae){if(!arguments.length){return this._includeInDomain
}this._includeInDomain=ae;
return this
};
ad.scaleIndex=function(ae){if(!arguments.length){return this._scaleIndex
}this._scaleIndex=ae;
return this
};
ad._copy=function(){dv.log.error({msg:"A copy function was not specified for the scale subclass."})
};
ad.copy=ad._copy;
ad.isDefault=function(ae){if(!arguments.length){return this._isDefault
}this._isDefault=ae;
return this
};
return ad
});
dv.scale.constant=dv.scale.extend(function(){function ad(){this._super(null)
}ad.trainDomain=function(ae){return
};
ad.map=function(ae){return this._value
};
ad.mapToProp=function(ae){return this._value
};
ad.value=function(ae){if(!arguments.length){return this._value
}this._value=ae;
return this
};
ad._copy=function(af){var ae=this.trainingProperties();
if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}return dv.scale.constant().isDefault(this.isDefault()).value(this.value()).property(this.property()).trainingProperties(ae).scaleIndex(this._scaleIndex)
};
ad.copy=ad._copy;
return ad
});
dv.scale.continuous=dv.scale.extend(function(){function ad(ae){this._super(ae?ae:d3.scale.linear());
this.to=this.range;
this._parse=function(af){return parseFloat(af)
}
}ad.calculateDomain=function(au,af){var av=[],aj=this,ar,at,ai=function(ax){return aj._parse.call(this,ax)
};
if(!this.trainingProperties()){this.trainingProperties([this.property()])
}var ak=this.trainingProperties();
if(!af){af={}
}if(!au){au=[]
}for(var al=0;
al<ak.length;
al++){var ae=ak[al];
for(var ao=0;
ao<au.length;
ao++){if(!af.filter||!af.filter.call(this,au[ao].key)){var ah=au[ao].values;
for(var ap=0;
ap<ah.length;
ap++){var an=ah[ap];
if(!this._includeInDomain(an,ap)){continue
}if(this.scaleIndex()!==0){an[this.property()+"-index"]=this.scaleIndex()
}var aw=(af.stack)?an.y0:an[ae];
if(!dv.util.isArray(aw)){aw=this._parse.call(this,aw)
}var aq=dv.util.isArray(aw)?d3.min(aw,ai):aw;
ar=(dv.util.isUndefined(ar)||aq<ar)?aq:ar;
if(af.stack){var am=an[ae];
aw+=dv.util.isArray(am)?d3.max(am,ai):aj._parse.call(this,am)
}var ag=dv.util.isArray(aw)?d3.max(aw,ai):aw;
at=(dv.util.isUndefined(at)||ag>at)?ag:at
}}}}if(isNaN(ar)&&isNaN(at)){av=[];
this._naturalDomain=[]
}else{av=[ar,at];
this._naturalDomain=[ar,at]
}if(af.fill){av=[0,100]
}if(!dv.util.isUndefined(this._upperLimit)&&!dv.util.isFunction(this._upperLimit)&&!dv.util.isUndefined(this._lowerLimit)&&!dv.util.isFunction(this._lowerLimit)){av=this.limits()
}else{this._reconcileLimits(av)
}return av
};
ad.unionDomain=function(aj,ai){if(!aj||!(aj instanceof dv.scale.continuous)){dv.log.error({msg:"The supplied scale is not continuous.",data:{scale:aj,isReversed:ai}})
}var ah=aj.domain(),af=aj.naturalDomain(),ag=this.domain()?d3.extent(this.domain().concat(ah)):d3.extent(ah),ae=this._naturalDomain?d3.extent(this._naturalDomain.concat(af)):d3.extent(af);
if(isNaN(ag[0])&&isNaN(ag[1])){ag=[]
}if(isNaN(ae[0]&&isNaN(ae[1]))){ae=[]
}this.reverse(ai||this._reverse);
this.domain(ag);
this._naturalDomain=ae;
return this
};
ad.validateDomain=function(){var ae=this.domain();
if(!ae||!ae.length){this.domain([0,1])
}};
ad.unionRange=function(ae){if(!dv.util.isValidValue(ae,["isArray"])){dv.log.error({msg:"The supplied range is not an array",data:{range:ae}})
}this.range(this.range()?d3.extent(this.range().concat(ae)):ae);
return this
};
ad.applyRangePadding=function(){var ai=this.domain(),ag=this.range();
if(this._lowerRangePadding){var ae=ag[0]-ag[1],af=Math.min(Math.abs(ae)-1,this._lowerRangePadding);
ai[0]=this.invertValue(ae/(Math.abs(ae)-af)*af+ag[0])
}if(this._upperRangePadding){var ah=ag[1]-ag[0],aj=Math.min(Math.abs(ah)-1,this._upperRangePadding);
ai[1]=this.invertValue(ah/(Math.abs(ah)-aj)*aj+ag[1])
}this.domain(ai);
return this
};
ad.upperLimit=function(ae){if(!arguments.length){return this._upperLimit
}if(dv.util.isValidValue(ae,["isUndefined","isFinite","isDate","isFunction"])){this._upperLimit=ae
}else{dv.log.error({msg:"Invalid value, cannot set upperLimit with: "+ae})
}return this
};
ad.lowerLimit=function(ae){if(!arguments.length){return this._lowerLimit
}if(dv.util.isValidValue(ae,["isUndefined","isFinite","isDate","isFunction"])){this._lowerLimit=ae
}else{dv.log.error({msg:"Invalid value, cannot set lowerLimit with: "+ae})
}return this
};
ad.limits=function(ae){if(!arguments.length){return[this._lowerLimit,this._upperLimit]
}if(!ae||ae.length!=2){dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"})
}this.lowerLimit(ae[0]);
this.upperLimit(ae[1]);
return this
};
ad.naturalDomain=function(){return this._naturalDomain
};
ad.upperRangePadding=function(ae){if(!arguments.length){return this._upperRangePadding
}if(dv.util.isValidValue(ae,["isUndefined","isFinite","isDate","isFunction"])){this._upperRangePadding=ae
}else{dv.log.error({msg:"Invalid value, cannot set upperRangePadding with: "+ae})
}return this
};
ad.lowerRangePadding=function(ae){if(!arguments.length){return this._lowerRangePadding
}if(dv.util.isValidValue(ae,["isUndefined","isFinite","isDate","isFunction"])){this._lowerRangePadding=ae
}else{dv.log.error({msg:"Invalid value, cannot set lowerRangePadding with: "+ae})
}return this
};
ad.rangePadding=function(ae){if(!arguments.length){return[this._lowerRangePadding,this._upperRangePadding]
}if(!ae||ae.length!=2){dv.log.error({msg:"Incorrect number of arguments, the limits function must supply an array containing both a lower and upper limit"})
}this.lowerRangePadding(ae[0]);
this.upperRangePadding(ae[1]);
return this
};
ad.softLowerLimit=function(ae){if(!arguments.length){return this._softLowerLimit
}this._softLowerLimit=ae;
return this
};
ad._reconcileLimits=function(ae){if(!ae.length){return
}if(!dv.util.isUndefined(this._softLowerLimit)){ae[0]=Math.min(ae[0],this._softLowerLimit);
ae[1]=Math.max(ae[1],this._softLowerLimit)
}if(!dv.util.isUndefined(this._lowerLimit)){ae[0]=dv.util.isFunction(this._lowerLimit)?this._lowerLimit(ae[0],ae[1]):this._lowerLimit
}if(!dv.util.isUndefined(this._upperLimit)){ae[1]=dv.util.isFunction(this._upperLimit)?this._upperLimit(ae[0],ae[1]):this._upperLimit
}};
ad.labels=function(ae){if(!arguments.length){return this._labels
}this._labels=ae;
return this
};
ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}var ag=dv.scale.continuous().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).reverse(this.reverse()).domain(af).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).trainingProperties(ae).scaleIndex(this._scaleIndex);
ag._naturalDomain=this._naturalDomain;
return ag
};
ad.invert=function(ae){return this._d3Scale.invert(ae[this.mapping()])
};
ad.invertFromProp=function(ae){return this._d3Scale.invert(ae[this.property()])
};
ad.copy=ad._copy;
return ad
});
dv.scale.linear=dv.scale.continuous.extend(function(){function ad(){this._super(d3.scale.linear())
}ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}var ag=dv.scale.linear().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(af).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(ae).scaleIndex(this._scaleIndex);
ag._naturalDomain=this._naturalDomain;
return ag
};
ad.copy=ad._copy;
return ad
});
dv.scale.gradient=dv.scale.continuous.extend(function(){function ad(){this._super(d3.scale.linear());
this._innerScale=d3.scale.linear().range([0,1]);
this.colors=this.range;
this._controlPoints=["0%","50%","100%"];
this.colors(["#FA5A50","#E1E1E1","#5FAF69"])
}ad._adjustOuterDomain=function(){var ae=this;
this._d3Scale.domain(dv.util.map(this._controlPoints,function(ag,af){return dv.util.isPercentString(ag)?ae._innerScale.invert(parseInt(ag,10)/100):ag
}))
};
ad.controlPoints=function(ae){if(!arguments.length){return this._controlPoints
}this._controlPoints=ae;
this._adjustOuterDomain();
return this
};
ad.domain=function(ae){if(!arguments.length){return this._innerScale.domain()
}if(!this._innerScale){return this
}ae=this._reverse?ae.reverse():ae;
this._innerScale.domain(ae);
this._adjustOuterDomain();
return this
};
ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}var ag=dv.scale.gradient().property(this.property()).mapping(this.mapping()).domain(af).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).includeInDomain(this.includeInDomain()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).controlPoints(this.controlPoints()).reverse(this.reverse()).trainingProperties(ae).scaleIndex(this._scaleIndex);
ag._naturalDomain=this._naturalDomain;
return ag
};
ad.copy=ad._copy;
return ad
});
dv.scale.time=dv.scale.continuous.extend(function(){function ad(){this._super(d3.time.scale());
this._parse=function(ae){return(ae instanceof Date)?ae:Date.parse(ae)
}
}ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}var ag=dv.scale.time().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(af).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(ae).scaleIndex(this._scaleIndex);
ag._naturalDomain=this._naturalDomain;
return ag
};
ad.copy=ad._copy;
ad._reconcileLimits=function(ag,af,ae){if(!dv.util.isUndefined(this._softLowerLimit)){ag[0]=Math.min(ag[0],this._softLowerLimit);
ag[1]=Math.max(ag[1],this._softLowerLimit)
}if(!dv.util.isUndefined(this._lowerLimit)){ag[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(af),new Date(ae))):this._lowerLimit
}if(!dv.util.isUndefined(this._upperLimit)){ag[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(af),new Date(ae))):this._upperLimit
}};
return ad
});
dv.scale.time.utc=dv.scale.continuous.extend(function(){function ad(){this._super(d3.time.scale.utc());
this._parse=function(ae){return(ae instanceof Date)?ae:Date.parse(ae)
}
}ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}var ag=dv.scale.time.utc().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(af).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(ae).scaleIndex(this._scaleIndex);
ag._naturalDomain=this._naturalDomain;
return ag
};
ad.copy=ad._copy;
ad._reconcileLimits=function(ag,af,ae){if(!dv.util.isUndefined(this._softLowerLimit)){ag[0]=Math.min(ag[0],this._softLowerLimit);
ag[1]=Math.max(ag[1],this._softLowerLimit)
}if(!dv.util.isUndefined(this._lowerLimit)){ag[0]=dv.util.isFunction(this._lowerLimit)?this._parse(this._lowerLimit(new Date(af),new Date(ae))):this._lowerLimit
}if(!dv.util.isUndefined(this._upperLimit)){ag[1]=dv.util.isFunction(this._upperLimit)?this._parse(this._upperLimit(new Date(af),new Date(ae))):this._upperLimit
}};
return ad
});
dv.scale.ordinal=dv.scale.extend(function(){function ad(){this._super(d3.scale.ordinal());
this._defaultPadding=0.1;
this._defaultOuterPadding=0;
this._rangeExtent=[];
this._rangeBandsSet=false
}ad._mapToD3Scale=function(ai){var ag=this.domain(),af=-1,aj=ag.length,ae=-1;
while(++af<aj){var ah=ag[af];
if(ah===ai||dv.util.isDate(ah)&&ah.getTime()===ai.getTime()){ae=af;
break
}}return(ae<0)?undefined:this._d3Scale(ai)
};
ad.calculateDomain=function(al,ap){var ag={};
var an=[],am=this.trainingProperties();
ap=ap||{};
for(var ah=0;
ah<am.length;
ah++){var af=am[ah];
for(var aj=0;
aj<al.length;
aj++){var ao=al[aj].values;
if(!ap.filter||!ap.filter.call(this,al[aj].key)){for(var ak=0;
ak<ao.length;
ak++){var ae=ao[ak];
if(!this._includeInDomain(ae,ak)){continue
}if(this.scaleIndex()!==0){ae[this.property()+"-index"]=this.scaleIndex()
}var ai=this._parse.call(this,ae[af]);
if(!dv.util.isUndefined(ai)&&!ag.hasOwnProperty(ai)){ag[ai]=ai;
an.push(ai)
}}}}}return an.length?an:[]
};
ad.unionDomain=function(ag,af){if(!ag||!(ag instanceof dv.scale.ordinal)){dv.log.error({msg:"The supplied scale is not ordinal.",data:{scale:ag,isReversed:af}})
}var ae=ag.domain();
if(ae&&!dv.util.isArray(ae)){throw new Error("The supplied domain is not an array")
}if(ae){this.reverse(af||this._reverse);
this.domain(this.domain()?dv.util.union(this.domain(),ae):ae)
}return this
};
ad.unionRange=function(ae){if(ae&&!dv.util.isArray(ae)){throw new Error("The supplied range is not an array")
}if(ae){this.range(this.range()?dv.util.union(this.range(),ae):ae)
}return this
};
ad.invertValue=function(ag){var ae=this.range().indexOf(ag),af=this.domain();
if(ae<0){throw new Error("The supplied value does not exist in the specified range.")
}return af[ae%af.length]
};
ad.reverse=function(af){if(!arguments.length){return this._reverse
}if(this._reverse!=af){this._reverse=af;
var ae=this._d3Scale.domain()||[];
this._d3Scale.domain(ae.reverse())
}return this
};
ad.padding=function(ae){if(!arguments.length){return dv.util.isUndefined(this._padding)?this._defaultPadding:this._padding
}this._padding=ae;
if(this._rangeBandsSet){this._d3Scale.rangeBands(this.rangeExtent(),this._padding,this.outerPadding())
}return this
};
ad.outerPadding=function(ae){if(!arguments.length){return dv.util.isUndefined(this._outerPadding)?(dv.util.isUndefined(this._padding)?this._defaultOuterPadding:this.padding()):this._outerPadding
}this._outerPadding=ae;
if(this._rangeBandsSet){this._d3Scale.rangeBands(this.rangeExtent(),this.padding(),this._outerPadding)
}return this
};
ad.rangeBands=function(ae){if(!arguments.length){return this._d3Scale.range()
}this._rangeBandsSet=true;
this._d3Scale.rangeBands(ae,this.padding(),this.outerPadding());
this.rangeExtent(ae);
return this
};
ad.rangeBand=function(){return this._d3Scale.rangeBand()
};
ad.range=function(ae){if(!arguments.length){return this._d3Scale.range()
}if(!this._d3Scale){return this
}if(!dv.util.isValidValue(ae,["isArray"])){dv.log.error({msg:"The supplied range is not an array",data:{range:ae}})
}this._d3Scale.range(ae);
this.rangeExtent([ae[0],ae[ae.length-1]]);
return this
};
ad.rangeExtent=function(ae){if(!arguments.length){return this._rangeExtent
}if(!dv.util.isValidValue(ae,["isArray"])){dv.log.error({msg:"The supplied range extent is not an array",data:{range:ae}})
}this._rangeExtent=ae;
return this
};
ad.values=function(ae){if(!arguments.length){return this._d3Scale.range()
}if(!dv.util.isValidValue(ae,["isArray"])){dv.log.error({msg:"The supplied values is not an array",data:{range:ae}})
}return this.range(ae)
};
ad.drop=function(ae){if(!arguments.length){return this._drop
}this._drop=ae;
return this
};
ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}var ag=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(af).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(ae).scaleIndex(this._scaleIndex);
if(this._rangeBandsSet){ag.rangeBands(this.rangeExtent().slice(0))
}return ag
};
ad.copy=ad._copy;
return ad
});
dv.scale.color=dv.scale.ordinal.extend(function(){var ae=["#8CC350","#5A6EAA","#D755A5","#1EBED7","#F0A01E","#9B8CE6","#3CB5A0","#3287D2","#F0557D","#C3D250","#EB782D","#78B4F5","#5FAF69","#AA5FA5","#FA5A50","#F5C841"];
function ad(){this._super();
this.range(ae)
}ad._copy=function(){var ag=this.domain().slice(0),af=this.trainingProperties();
if(this.reverse()){ag.reverse()
}if(!dv.util.isUndefined(af)){af=af.slice(0)
}var ah=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(ag).range(this.range()).rangeExtent(this.rangeExtent()).includeInDomain(this.includeInDomain()).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(af).scaleIndex(this._scaleIndex);
if(this._rangeBandsSet){ah.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding)
}return ah
};
ad.copy=ad._copy;
return ad
});
dv.scale.shape=dv.scale.ordinal.extend(function(){var ae=["circle","cross","diamond","square","triangle-down","triangle-up"];
function ad(){this._super();
this.range(ae)
}ad._copy=function(){var ag=this.domain().slice(0),af=this.trainingProperties();
if(this.reverse()){ag.reverse()
}if(!dv.util.isUndefined(af)){af=af.slice(0)
}var ah=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(ag).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(af).scaleIndex(this._scaleIndex);
if(this._rangeBandsSet){ah.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding)
}return ah
};
ad.copy=ad._copy;
return ad
});
dv.scale.linetype=dv.scale.ordinal.extend(function(){var ae=["solid","dashed","dotted","dotdash","longdash","twodash"];
function ad(){this._super();
this.range(ae)
}ad._copy=function(){var ag=this.domain().slice(0),af=this.trainingProperties();
if(this.reverse()){ag.reverse()
}if(!dv.util.isUndefined(af)){af=af.slice(0)
}var ah=dv.scale.ordinal().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(ag).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).rangeExtent(this.rangeExtent().slice(0)).reverse(this.reverse()).padding(this._padding).outerPadding(this._outerPadding).trainingProperties(af).scaleIndex(this._scaleIndex);
if(this._rangeBandsSet){ah.rangeBands(this.rangeExtent().slice(0)).padding(this._padding).outerPadding(this._outerPadding)
}return ah
};
ad.copy=ad._copy;
return ad
});
dv.scale.size=dv.scale.continuous.extend(function(){function ad(){this._super();
this.to([2,10])
}ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}var ag=dv.scale.size().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(af).includeInDomain(this.includeInDomain()).upperLimit(this.upperLimit()).lowerLimit(this.lowerLimit()).upperRangePadding(this.upperRangePadding()).lowerRangePadding(this.lowerRangePadding()).softLowerLimit(this.softLowerLimit()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(ae).scaleIndex(this._scaleIndex);
ag._naturalDomain=this._naturalDomain;
return ag
};
ad.copy=ad._copy;
return ad
});
dv.scale.identity=dv.scale.ordinal.extend(function(){function ad(ae){this._super(d3.scale.ordinal())
}ad.mapToProp=function(ae){return ae[this.property()]
};
ad.domain=function(ae){if(!arguments.length){return this._d3Scale.domain()
}if(!this._d3Scale){return this
}ae=this._reverse?ae.reverse():ae;
this._d3Scale.domain(ae);
this._d3Scale.range(ae);
return this
};
ad.range=function(){if(!arguments.length){return this._d3Scale.range()
}return this
};
ad.labels=function(ae){if(!arguments.length){return this._labels
}this._labels=ae;
return this
};
ad._copy=function(){var af=this.domain().slice(0),ae=this.trainingProperties();
if(this.reverse()){af.reverse()
}if(!dv.util.isUndefined(ae)){ae=ae.slice(0)
}return dv.scale.identity().isDefault(this.isDefault()).property(this.property()).mapping(this.mapping()).domain(af).includeInDomain(this.includeInDomain()).range(this.range().slice(0)).reverse(this.reverse()).trainingProperties(ae).scaleIndex(this._scaleIndex)
};
ad.copy=ad._copy;
return ad
});
dv.svg=dv.svg||{};
dv.svg.text=function(){var ad=L,ai=K,ae=B,ah=v,af=E;
function ag(aj){return aj.select(function(al,ak){return ah.call(this,al,ak)?this:null
}).attr("x",function(al,ak){return ad.call(this,al,ak)
}).attr("y",function(al,ak){return ai.call(this,al,ak)
}).text(function(al,ak){return ae.call(this,al,ak)
})
}ag.x=function(aj){if(!arguments.length){return ad
}ad=aj;
return ag
};
ag.y=function(aj){if(!arguments.length){return ai
}ai=aj;
return ag
};
ag.label=function(aj){if(!arguments.length){return ae
}ae=aj;
return ag
};
ag.defined=function(aj){if(!arguments.length){return ah
}ah=aj;
return ag
};
ag.duration=function(aj){if(!arguments.length){return af
}af=aj;
return ag
};
return ag
};
dv.svg.text.radial=function(){var ai=L,ad=K,ae=B,ah=v,af=E;
function ag(ak){var aj=function(an,am){return ai.call(this,an,am)+j
},al=function(an,am){return ad.call(this,an,am)
};
return ak.select(function(an,am){return ah.call(this,an,am)?this:null
}).attr("x",function(an,am){return al(an,am)*Math.cos(aj(an,am))
}).attr("y",function(an,am){return al(an,am)*Math.sin(aj(an,am))
}).text(function(an,am){return ae.call(this,an,am)
})
}ag.angle=function(aj){if(!arguments.length){return ai
}ai=aj;
return ag
};
ag.radius=function(aj){if(!arguments.length){return ad
}ad=aj;
return ag
};
ag.label=function(aj){if(!arguments.length){return ae
}ae=aj;
return ag
};
ag.defined=function(aj){if(!arguments.length){return ah
}ah=aj;
return ag
};
ag.duration=function(aj){if(!arguments.length){return af
}af=aj;
return ag
};
return ag
};
function L(ad){return ad[0]
}function K(ad){return ad[1]
}function B(ad){return ad[2]
}function v(){return true
}function E(){return 0
}dv.svg.rect=function(){var ae=S,ad=R,ah=r,af=q,ai=H;
function ag(ak,aj){if(ai.call(this,ak,aj)){return M(ae.call(this,ak,aj),ad.call(this,ak,aj),ah.call(this,ak,aj),af.call(this,ak,aj))
}return null
}ag.x0=function(aj){if(!arguments.length){return ae
}ae=aj;
return ag
};
ag.x1=function(aj){if(!arguments.length){return ad
}ad=aj;
return ag
};
ag.y0=function(aj){if(!arguments.length){return ah
}ah=aj;
return ag
};
ag.y1=function(aj){if(!arguments.length){return af
}af=aj;
return ag
};
ag.defined=function(aj){if(!arguments.length){return ai
}ai=aj;
return ag
};
return ag
};
function S(ad){return ad[0]
}function R(ad){return ad[1]
}function r(ad){return ad[2]
}function q(ad){return ad[3]
}function H(){return true
}function M(ae,ad,ag,af){return"M"+ae+","+ag+"L"+ad+","+ag+"L"+ad+","+af+"L"+ae+","+af+"Z"
}dv.svg.symbol=function(){var af=O,ae=V,ad=ab,ai=aa,ah=h;
function ag(ak,aj){if(ah.call(this,ak,aj)){return(N[af.call(this,ak,aj)]||N.circle)(ae.call(this,ak,aj),ad.call(this,ak,aj),ai.call(this,ak,aj))
}return null
}ag.x=function(aj){if(!arguments.length){return ad
}ad=aj;
return ag
};
ag.y=function(aj){if(!arguments.length){return ai
}ai=aj;
return ag
};
ag.type=function(aj){if(!arguments.length){return af
}af=d3.functor(aj);
return ag
};
ag.size=function(aj){if(!arguments.length){return ae
}ae=d3.functor(aj);
return ag
};
ag.defined=function(aj){if(!arguments.length){return ah
}ah=aj;
return ag
};
return ag
};
dv.svg.symbol.radial=function(){var af=O,ae=V,ai=ab,ad=aa,ah=h;
function ag(an,al){if(ah.call(this,an,al)){var ak=ai.call(this,an,al)+j,am=ad.call(this,an,al),aj=am*Math.cos(ak),ao=am*Math.sin(ak);
return(N[af.call(this,an,al)]||N.circle)(ae.call(this,an,al),aj,ao)
}return null
}ag.angle=function(aj){if(!arguments.length){return ai
}ai=aj;
return ag
};
ag.radius=function(aj){if(!arguments.length){return ad
}ad=aj;
return ag
};
ag.type=function(aj){if(!arguments.length){return af
}af=d3.functor(aj);
return ag
};
ag.size=function(aj){if(!arguments.length){return ae
}ae=d3.functor(aj);
return ag
};
ag.defined=function(aj){if(!arguments.length){return ah
}ah=aj;
return ag
};
return ag
};
d3.svg.symbolTypes=d3.keys(N);
var N={circle:function(ae,ad,ag){var af=Math.sqrt(ae/Math.PI);
return"M"+ad+","+(ag+af)+"A"+af+","+af+" 0 1,1 "+ad+","+(ag-af)+"A"+af+","+af+" 0 1,1 "+ad+","+(ag+af)+"Z"
},cross:function(ae,ad,ag){var af=Math.sqrt(ae/5)/2;
return"M"+(ad+-3*af)+","+(ag-af)+"H"+(ad-af)+"V"+(ag+-3*af)+"H"+(ad+af)+"V"+(ag-af)+"H"+(ad+3*af)+"V"+(ag+af)+"H"+(ad+af)+"V"+(ag+3*af)+"H"+(ad-af)+"V"+(ag+af)+"H"+(ad-3*af)+"Z"
},diamond:function(ae,ad,ah){var af=Math.sqrt(ae/(2*w)),ag=af*w;
return"M"+ad+","+(ah-af)+"L"+(ad+ag)+","+ah+" "+ad+","+(ah+af)+" "+(ad-ag)+","+ah+"Z"
},square:function(ae,ad,ag){var af=Math.sqrt(ae)/2;
return"M"+(ad-af)+","+(ag-af)+"L"+(ad+af)+","+(ag-af)+" "+(ad+af)+","+(ag+af)+" "+(ad-af)+","+(ag+af)+"Z"
},"triangle-down":function(ae,ad,ah){var ag=Math.sqrt(ae/F),af=ag*F/2;
return"M"+ad+","+(ah+af)+"L"+(ad+ag)+","+(ah-af)+" "+(ad-ag)+","+(ah-af)+"Z"
},"triangle-up":function(ae,ad,ah){var ag=Math.sqrt(ae/F),af=ag*F/2;
return"M"+ad+","+(ah-af)+"L"+(ad+ag)+","+(ah+af)+" "+(ad-ag)+","+(ah+af)+"Z"
}};
function V(){return 64
}function O(){return"circle"
}function ab(ad){return ad[0]
}function aa(ad){return ad[1]
}function h(ad){return true
}dv.svg.errorBar=function(){var af=U,ae=T,ah=u,ag=s,ai=A;
function ad(ak,aj){if(ai.call(this,ak,aj)){return f(af.call(this,ak,aj),ae.call(this,ak,aj),ah.call(this,ak,aj),ag.call(this,ak,aj))
}return null
}ad.x0=function(aj){if(!arguments.length){return af
}af=aj;
return ad
};
ad.x1=function(aj){if(!arguments.length){return ae
}ae=aj;
return ad
};
ad.y0=function(aj){if(!arguments.length){return ah
}ah=aj;
return ad
};
ad.y1=function(aj){if(!arguments.length){return ag
}ag=aj;
return ad
};
ad.defined=function(aj){if(!arguments.length){return ai
}ai=aj;
return ad
};
return ad
};
function U(ad){return ad[0]
}function T(ad){return ad[1]
}function u(ad){return ad[2]
}function s(ad){return ad[3]
}function A(){return true
}function f(af,ae,ah,ag){var ad=af+((ae-af)/2);
return"M"+af+","+ah+"L"+ae+","+ah+"M"+ad+","+ah+"L"+ad+","+ag+"M"+af+","+ag+"L"+ae+","+ag
}var F=Math.sqrt(3),w=Math.tan(30*Math.PI/180);
var j=-Math.PI/2;
dv.svg.poly=function(){var ag=b,ad=G,ae=n;
function af(ai,ah){if(ag.call(this,ai,ah)){return P(ad.call(this,ai,ah),ae.call(this,ai,ah))
}return null
}af.xs=function(ah){if(!arguments.length){return ad
}ad=ah;
return af
};
af.ys=function(ah){if(!arguments.length){return ae
}ae=ah;
return af
};
af.defined=function(ah){if(!arguments.length){return ag
}ag=ah;
return ag
};
return af
};
dv.svg.poly.radial=function(){var ag=b,af=G,ae=n;
function ad(am,aj){if(ag.call(this,am,aj)){var aq=af.call(this,am,aj);
var al=ae.call(this,am,aj);
var an=d3.max([aq.length,al.length]);
var ak="M";
for(var ai=0;
ai<an;
ai++){if(ai>0){ak+="L"
}var ar=aq[ai]+j,ah=al[ai],ap=ah*Math.cos(ar),ao=ah*Math.sin(ar);
ak+=(ai<aq.length?ap:"0");
ak+=",";
ak+=(ai<al.length?ao:"0")
}ak+="Z";
return ak
}return null
}ad.angles=function(ah){if(!arguments.length){return af
}af=ah;
return ad
};
ad.radii=function(ah){if(!arguments.length){return ae
}ae=ah;
return ad
};
ad.defined=function(ah){if(!arguments.length){return ag
}ag=ah;
return ag
};
return ad
};
function b(ad){return true
}function G(ad){return ad[0]
}function n(ad){return ad[1]
}function P(ae,ag){var ad=d3.max([ae.length,ag.length]);
var ah="M";
for(var af=0;
af<ad;
af++){if(af>0){ah+="L"
}ah+=(af<ae.length?ae[af]:"0");
ah+=",";
ah+=(af<ag.length?ag[af]:"0")
}ah+="Z";
return ah
}dv.util={};
dv.util.filterAndZip=function(ae,al,ak){var am=[],ao=[];
if(!al){for(var ad in ae){am=ae[ad];
break
}}else{am=ae[al]
}var af=-1,ah=am.length;
while(++af<ah){var an=am[af];
if(!ak||an==ak){var aj={};
for(var ai in ae){if(ai==="data"){aj[ai]={};
for(var ag in ae[ai]){aj[ai][ag]=ae[ai][ag][af]
}}else{aj[ai]=ae[ai][af]
}}ao.push(aj)
}}return ao
};
dv.util.binaryCompare=function(ae,ad,ai,ah,ag){var aj=ah;
if(arguments.length<4){aj=0
}if(arguments.length<5){ag=ae.length
}while(aj<ag){var af=(aj+ag)>>1;
if(ad<ai(ae[af])){ag=af
}else{aj=af+1
}}if(aj==ah||Math.abs(ai(ae[aj])-ad)<Math.abs(ai(ae[aj-1])-ad)){return aj
}else{return aj-1
}};
dv.util.uniqueValues=function(af,ad){var ae=[];
dv.util.each(af,function(ak,ah){var ai=-1,al=ae.length,aj=false;
while(++ai<al){var ag=ae[ai];
if(ad(ak,ag)){aj=true;
break
}}if(!aj){ae.push(af[ai])
}});
return ae
};
dv.util.scaleRange=function(ae,ad){if(arguments.length===1){return ae.rangeExtent?ae.rangeExtent():ae.range()
}if(ae.rangeExtent){ae.rangeBands(ad)
}else{ae.range(ad)
}return ae
};
dv.util.minRangeDistance=function(ah,ae){var ag=Number.MAX_VALUE,af,ad;
dv.util.each(ae,function(ai){dv.util.each(ai.values,function(aj){af=aj.panel.xScale(aj).mapValue(aj[ah]);
if(!dv.util.isUndefined(ad)){ag=Math.min(ag,Math.abs(af-ad))
}ad=af
})
});
return ag
};
dv.util.scaleRangeNoReverse=function(ad){return ad.rangeExtent?ad.rangeExtent():dv.util.scaleExtent(ad.range())
};
dv.util.scaleExtent=function(ae){var af=ae[0],ad=ae[ae.length-1];
return af<ad?[af,ad]:[ad,af]
};
dv.util.merge=function(af,ae){var ad={};
var ag;
for(ag in af){ad[ag]=af[ag]
}for(ag in ae){ad[ag]=ae[ag]
}return ad
};
dv.util.getPercentValue=function(ae,ad){return(dv.util.isPercentString(ae))?(ad*parseInt(ae,10)/100):ae
};
dv.util.isPercentString=function(ad){return(typeof ad==="string"&&/^(-?[0-9]+)%$/.test(ad))
};
dv.util.isValidValue=function(af,ae){for(var ad=0;
ad<ae.length;
ad++){if(dv.util[ae[ad]](af)){return true
}}return false
};
dv.util.identity=function(ad){return ad
};
dv.util.clamp=function(af,ae,ad){return Math.min(Math.max(af,ae),ad)
};
dv.util.clone=function(ad){if(!dv.util.isObject(ad)){return ad
}return dv.util.isArray(ad)?ad.slice():dv.util.extend({},ad)
};
dv.util.isArray=function(ad){if(Array.isArray){return Array.isArray(ad)
}return Object.prototype.toString.call(ad)=="[object Array]"
};
dv.util.isObject=function(ad){return ad===Object(ad)
};
dv.util.isFunction=function(ad){return Object.prototype.toString.call(ad)=="[object Function]"
};
dv.util.isUndefined=function(ad){return ad===void 0
};
dv.util.isFinite=function(ad){return isFinite(ad)&&!isNaN(parseFloat(ad))
};
dv.util.isDate=function(ad){return ad instanceof Date
};
dv.util.isEmpty=function(ad){return Object.keys(ad).length===0
};
dv.util.extend=function(ad){dv.util.each(Array.prototype.slice.call(arguments,1),function(ae){for(var af in ae){ad[af]=ae[af]
}});
return ad
};
dv.util.each=function(ai,ah,ag){if(ai==null){return
}if(Array.prototype.forEach&&ai.forEach===Array.prototype.forEach){ai.forEach(ah,ag)
}else{if(ai.length===+ai.length){for(var af=0,ad=ai.length;
af<ad;
af++){if(ah.call(ag,ai[af],af,ai)==={}){return
}}}else{for(var ae in ai){if(dv.util.has(ai,ae)){if(ah.call(ag,ai[ae],ae,ai)==={}){return
}}}}}};
dv.util.has=function(ae,ad){return Object.prototype.hasOwnProperty.call(ae,ad)
};
dv.util.uniq=function(aj,ai,ah,ag){if(dv.util.isFunction(ai)){ag=ah;
ah=ai;
ai=false
}var ae=ah?dv.util.map(aj,ah,ag):aj;
var af=[];
var ad=[];
dv.util.each(ae,function(al,ak){if(ai?(!ak||ad[ad.length-1]!==al):!dv.util.contains(ad,al)){ad.push(al);
af.push(aj[ak])
}});
return af
};
dv.util.union=function(){return dv.util.uniq(Array.prototype.concat.apply(Array.prototype,arguments))
};
dv.util.contains=function(ae,ad){if(ae==null){return false
}if(Array.prototype.indexOf&&ae.indexOf===Array.prototype.indexOf){return ae.indexOf(ad)!=-1
}return dv.util.any(ae,function(af){return af===ad
})
};
dv.util.any=function(ag,af,ae){if(!af){af=dv.util.identity
}var ad=false;
if(ag==null){return ad
}if(Array.prototype.some&&ag.some===Array.prototype.some){return ag.some(af,ae)
}dv.util.each(ag,function(aj,ah,ai){if(ad||(ad=af.call(ae,aj,ah,ai))){return{}
}})
};
dv.util.sortBy=function(ah,ag,ad){var af=function(ai){return dv.util.isFunction(ai)?ai:function(aj){return aj[ai]
}
};
var ae=af(ag);
return dv.util.pluck(dv.util.map(ah,function(ak,ai,aj){return{value:ak,index:ai,criteria:ae.call(ad,ak,ai,aj)}
}).sort(function(al,ak){var aj=al.criteria;
var ai=ak.criteria;
if(aj!==ai){if(aj>ai||aj===void 0){return 1
}if(aj<ai||ai===void 0){return -1
}}return al.index<ak.index?-1:1
}),"value")
};
dv.util.pluck=function(ae,ad){return dv.util.map(ae,function(af){return af[ad]
})
};
dv.util.map=function(ag,af,ae){var ad=[];
if(ag===null){return ad
}if(Array.prototype.map&&ag.map===Array.prototype.map){return ag.map(af,ae)
}dv.util.each(ag,function(aj,ah,ai){ad[ad.length]=af.call(ae,aj,ah,ai)
});
return ad
};
dv.util.reduce=function(ah,ag,ad,af){var ae=arguments.length>2;
if(ah===null){ah=[]
}if(Array.prototype.reduce&&ah.reduce===Array.prototype.reduce){if(af){ag=dv.util.bind(ag,af)
}return ae?ah.reduce(ag,ad):ah.reduce(ag)
}dv.util.each(ah,function(ak,ai,aj){if(!ae){ad=ak;
ae=true
}else{ad=ag.call(af,ad,ak,ai,aj)
}});
if(!ae){throw new TypeError("Reduce of empty array with no initial value")
}return ad
};
dv.util.bind=function(af,ae){if(af.bind===Function.prototype.bind&&Function.prototype.bind){return Function.prototype.bind.apply(af,Array.prototype.slice.call(arguments,1))
}var ad=Array.prototype.slice.call(arguments,2);
return function(){return af.apply(ae,ad.concat(Array.prototype.slice.call(arguments)))
}
};
dv.util.noop=function(){};
dv.util.each(["Arguments","String","Number","RegExp"],function(ad){dv.util["is"+ad]=function(ae){return toString.call(ae)=="[object "+ad+"]"
}
});
dv.util.validateParam=function(ag,af,ae,ai){if(af==="isString"){if(dv.util.isString(ag)){if(dv.util.isArray(ae)&&(ae.indexOf(ag.toLowerCase())!==-1)){return ag.toLowerCase()
}}return ai
}else{if(af==="isNumber"){if(dv.util.isNumber(ag)){if(dv.util.isArray(ae)&&(ag<=ae[1]&&ag>=ae[0])){return ag
}}return ai
}else{if(af==="isFunction"){if(dv.util.isFunction(ag)){return ag
}return ai
}else{if(af==="isDimension"){if(ag==="x"||ag==="X"){return"x"
}if(ag==="y"||ag==="Y"){return"y"
}if(ag===["x","y"]||ag===["X","y"]||ag===["x","Y"]||ag===["X","Y"]){return["x","y"]
}return ai
}else{if(af==="isRange"){var ad=ae[0],ah=ae[1];
if(dv.util.isArray(ag)&&ag.length===2){if(dv.util.isNumber(ag[0])&&dv.util.isNumber(ag[1])){ad=Math.max(Math.min(ag[0],ag[1]),ae[0]);
ah=Math.min(Math.max(ag[0],ag[1]),ae[1])
}return[ad,ah]
}return ai
}}}}}};
dv.util=dv.util||{};
dv.util.svg={};
dv.util.svg.getDasharray=function(ad){if(ad.indexOf(",")!=-1||ad.indexOf(" ")!=-1){return ad
}if(p.hasOwnProperty(ad)){return p[ad]
}throw new Error("The dashed line format is invalid")
};
var p={solid:"",dashed:"7,4",dotted:"2,3",dotdash:"2,3,7,4",longdash:"11,4",twodash:"5,2,11,2"};
dv.container=dv.extend(function(){var ae={x:dv.scale.linear,y:dv.scale.linear,yMin:dv.scale.linear,yMax:dv.scale.linear,xMin:dv.scale.linear,xMax:dv.scale.linear,color:dv.scale.color,fill:dv.scale.color,stroke:dv.scale.color,alpha:dv.scale.linear,shape:dv.scale.shape,size:dv.scale.size,radius:dv.scale.linear,group:dv.scale.ordinal,linetype:dv.scale.linetype,label:dv.scale.identity};
function ad(){this._aes={}
}ad.render=function(){throw new Error("render() must be implemented in a subclass")
};
ad._calculateStats=function(){throw new Error("_calculateStats() must be implemented in a subclass")
};
ad._handlePositions=function(){throw new Error("_handlePositions() must be implemented in a subclass")
};
ad.getTrainedScale=function(af){throw new Error("getTrainedScale() must be implemented in a subclass")
};
ad.getExplicitScalesMap=function(){return this._aes
};
ad._normalizeData=function(ag){if(ag.hasOwnProperty("data")&&!dv.util.isArray(ag.data)){return ag
}var aj={},ah=this.getExplicitScalesMap(),ai,af=this;
dv.util.each(ah,function(an,al){for(var am in an){ai=an[am];
if(!(ai instanceof dv.scale.constant)){var ak=ag[ai.mapping()];
if(dv.util.isArray(ak)){aj[ai.property()]=ak
}}}});
aj.data=ag;
return aj
};
ad.map=function(ah,af,ai,ag){if(!ai){ai=ae[ah]().copy().isDefault(true)
}if(!ai){throw new Error("There is no default scale associated with this property. Either the property isn't valid or the scale default doesn't exist.")
}if(arguments.length<4){ag=0
}if(!this._aes[ah]){this._aes[ah]={}
}this._aes[ah][ag]=ai.property(ah).mapping(af).scaleIndex(ag);
return this
};
ad.set=function(af,ah){if(!this._aes[af]){this._aes[af]={}
}var ag=this._aes[af][0]=dv.scale.constant();
if(dv.util.isFunction(ah)){ag.map=ag.mapToProp=ah
}else{ag.value(ah)
}return this
};
ad.on=function(ah,ai,ag){if(arguments.length<3){ag=false
}var af=ai&&dv.util.isFunction(ai);
if(af){this.eventMap=this.eventMap||{};
this.eventMap[ah]={callback:ai,capture:ag}
}else{if(this.eventMap){delete this.eventMap[ah]
}this.unregisterEventMap=this.unregisterEventMap||{};
this.unregisterEventMap[ah]=ag
}this._removeRegisteredEvents();
this._addRegisteredEvents();
return this
};
ad.position=function(af){if(!arguments.length){return(this._chart&&!this._position)?this._chart.position():this._position
}this._position=af;
return this
};
ad.delay=function(af){if(!arguments.length){return(this._chart&&dv.util.isUndefined(this._delay))?this._chart.delay():this._delay
}this._delay=d3.functor(af);
return this
};
ad.duration=function(af){if(!arguments.length){return(this._chart&&dv.util.isUndefined(this._duration))?this._chart.duration():this._duration
}this._duration=d3.functor(af);
return this
};
ad.ease=function(af){if(!arguments.length){return(this._chart&&dv.util.isUndefined(this._ease))?this._chart.ease():this._ease
}this._ease=af;
return this
};
return ad
});
dv.coord=dv.extend(function(){function ad(){this._flip=false
}ad.flip=function(ae){if(!arguments.length){return this._flip
}this._flip=ae;
return this
};
ad.startX=function(ae){if(!arguments.length){return this._startX
}if(!dv.util.isValidValue(ae,["isFinite","isPercentString"])){dv.log.error({msg:"Invalid value type, startX/startAngle must be a number or percent string",data:{val:ae}})
}this._startX=ae;
return this
};
ad.endX=function(ae){if(!arguments.length){return this._endX
}if(!dv.util.isValidValue(ae,["isFinite","isPercentString"])){dv.log.error({msg:"Invalid value type, endX/endAngle must be a number or percent string",data:{val:ae}})
}this._endX=ae;
return this
};
ad.startY=function(ae){if(!arguments.length){return this._startY
}if(!dv.util.isValidValue(ae,["isFinite","isPercentString"])){dv.log.error({msg:"Invalid value type, startY/innerRadius must be a number or percent string",data:{val:ae}})
}this._startY=ae;
return this
};
ad.endY=function(ae){if(!arguments.length){return this._endY
}if(!dv.util.isValidValue(ae,["isFinite","isPercentString"])){dv.log.error({msg:"Invalid value type, endY/outerRadius must be a number or percent string",data:{val:ae}})
}this._endY=ae;
return this
};
return ad
});
dv.coord.cartesian=dv.coord.extend(function(){function ad(){this._super();
this.startX(0);
this.endX(0);
this.startY(0);
this.endY(0);
this._type="cartesian"
}ad._translatePercentToX=function(ai,ag){var ae=dv.util.scaleRange(ai),ah=this._translatePercent(ag,ae,this.startX(),this.endX()),af=Math.abs(ae[1]-ae[0])*3;
return dv.util.clamp(ah,ae[0]-af,ae[1]+af)
};
ad._translatePercentToY=function(ai,ag){var ae=dv.util.scaleRange(ai),ah=this._translatePercent(ag,ae,this.startY(),this.endY()),af=Math.abs(ae[1]-ae[0])*3;
return dv.util.clamp(ah,ae[1]-af,ae[0]+af)
};
ad._translatePercent=function(ag,af,ah,ae){return(((af[1]-af[0])-ae-ah)*ag+ah+af[0])
};
ad._translatePercentArrToY=function(ag,af){var ae=this;
return dv.util.map(af,function(ah){return ae._translatePercentToY(ag,ah)
})
};
ad._translatePercentArrToX=function(ag,af){var ae=this;
return dv.util.map(af,function(ah){return ae._translatePercentToX(ag,ah)
})
};
ad._text=function(){var ae=this;
function af(){var ag=dv.svg.text();
if(ae._flip){return ag.x(function(ai,ah){return ae._translatePercentToY(ai.panel.yOuterScale(),af.y()(ai,ah))
}).y(function(ai,ah){return ae._translatePercentToX(ai.panel.xOuterScale(),af.x()(ai,ah))
})
}else{return ag.x(function(ai,ah){return ae._translatePercentToX(ai.panel.xOuterScale(),af.x()(ai,ah))
}).y(function(ai,ah){return ae._translatePercentToY(ai.panel.yOuterScale(),af.y()(ai,ah))
})
}}af.x=function(ag){if(!arguments.length){return this._x
}this._x=ag;
return this
};
af.y=function(ag){if(!arguments.length){return this._y
}this._y=ag;
return this
};
return af
};
ad._point=function(){var af=this,ae={};
ae.renderer=dv.svg.symbol().x(function(ah,ag){return ah.bounds.x
}).y(function(ah,ag){return ah.bounds.y
});
ae.getBounds=function(ah,ag){if(!ah.hasOwnProperty("y")){ah.y=0
}if(!ah.hasOwnProperty("x")){ah.x=0
}if(!ae._defined(ah,ag)){return null
}if(af._flip){ah.bounds={x:af._translatePercentToY(ah.panel.yOuterScale(),ae.y()(ah,ag)),y:af._translatePercentToX(ah.panel.xOuterScale(),ae.x()(ah,ag))}
}else{ah.bounds={x:af._translatePercentToX(ah.panel.xOuterScale(),ae.x()(ah,ag)),y:af._translatePercentToY(ah.panel.yOuterScale(),ae.y()(ah,ag))}
}return ah
};
ae.getPath=function(ag){return(ag===null||ag.bounds===undefined)?null:ae.renderer(ag)
};
ae.x=function(ag){if(!arguments.length){return this._x
}this._x=ag;
return ae
};
ae.y=function(ag){if(!arguments.length){return this._y
}this._y=ag;
return ae
};
ae.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return ae
};
ad._line=function(){var af=this,ae={};
ae.renderer=d3.svg.line().x(function(ah,ag){return ah.bounds.x
}).y(function(ah,ag){return ah.bounds.y
});
ae.getBounds=function(ai,ag){var ah=[];
dv.util.each(ai,function(ak,aj){if(!ak.hasOwnProperty("y")){ak.y=0
}if(!ak.hasOwnProperty("x")){ak.x=0
}if(ae._defined(ak,aj)){if(af._flip){ak.bounds={x:af._translatePercentToY(ak.panel.yOuterScale(),ae.y()(ak,aj)),y:af._translatePercentToX(ak.panel.xOuterScale(),ae.x()(ak,aj))}
}else{ak.bounds={x:af._translatePercentToX(ak.panel.xOuterScale(),ae.x()(ak,aj)),y:af._translatePercentToY(ak.panel.yOuterScale(),ae.y()(ak,aj))}
}ah.push(ai[aj])
}});
return ah
};
ae.getPath=function(ag){return(ag===null)?null:ae.renderer(ag)
};
ae.x=function(ag){if(!arguments.length){return this._x
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.x must be a function",data:{val:ag}})
}this._x=ag;
return this
};
ae.y=function(ag){if(!arguments.length){return this._y
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.y must be a function",data:{val:ag}})
}this._y=ag;
return this
};
ae.defined=function(ag){if(!arguments.length){return this._defined
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:ag}})
}this._defined=ag;
return this
};
return ae
};
ad._area=function(){var ae=this,af={};
af.renderer=d3.svg.area();
af.getBounds=function(ai,ag){var ah=[];
af.setupRenderer();
dv.util.each(ai,function(al,aj){if(!al.hasOwnProperty("y")){al.y=0
}if(!al.hasOwnProperty("x")){al.x=0
}if(af._defined(al,aj)){var ak=dv.util.clone(al);
ak.bounds={x:ae._translatePercentToX(al.panel.xOuterScale(),af.x()(al,aj)),y0:ae._translatePercentToY(al.panel.yOuterScale(),af.y0()(al,aj)),y1:ae._translatePercentToY(al.panel.yOuterScale(),af.y1()(al,aj))};
ah.push(ak)
}});
return ah
};
af.getPath=function(ag){af.setupRenderer();
return(ag===null)?null:af.renderer(ag)
};
af.setupRenderer=function(){if(ae._flip){af.renderer.x(null).y0(null).y1(null).y(function(ah,ag){return ah.bounds.x
}).x0(function(ah,ag){return ah.bounds.y0
}).x1(function(ah,ag){return ah.bounds.y1
})
}else{af.renderer.y(null).x0(null).x1(null).x(function(ah,ag){return ah.bounds.x
}).y0(function(ah,ag){return ah.bounds.y0
}).y1(function(ah,ag){return ah.bounds.y1
})
}};
af.x=function(ag){if(!arguments.length){return this._x
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, area.x must be a function",data:{val:ag}})
}this._x=ag;
return this
};
af.y0=function(ag){if(!arguments.length){return this._y0
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, area.y0 must be a function",data:{val:ag}})
}this._y0=ag;
return this
};
af.y1=function(ag){if(!arguments.length){return this._y1
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, area.y1 must be a function",data:{val:ag}})
}this._y1=ag;
return this
};
af.defined=function(ag){if(!arguments.length){return this._defined
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, area.defined must be a function",data:{val:ag}})
}this._defined=ag;
return this
};
return af
};
ad._rect=function(){var ae=this,af={};
af.renderer=dv.svg.rect().x0(function(ah,ag){return ah.bounds.x0
}).x1(function(ah,ag){return ah.bounds.x1
}).y0(function(ah,ag){return ah.bounds.y0
}).y1(function(ah,ag){return ah.bounds.y1
});
af.getBounds=function(ak,ag){var ai=dv.util.clone(ak);
var aj=ai[ak.panel.xScale(ak).property()];
if(dv.util.isArray(aj)){ai.x0=aj[0];
ai.x1=aj[1]
}var ah=ai[ak.panel.yScale(ak).property()];
if(dv.util.isArray(ah)){ai.y0=ah[0];
ai.y1=ah[1]
}if(!af._defined(ai,ag)){return null
}if(ae._flip){ai.bounds={x0:ae._translatePercentToY(ak.panel.yOuterScale(),af.y0()(ai,ag)),x1:ae._translatePercentToY(ak.panel.yOuterScale(),af.y1()(ai,ag)),y0:ae._translatePercentToX(ak.panel.xOuterScale(),af.x0()(ai,ag)),y1:ae._translatePercentToX(ak.panel.xOuterScale(),af.x1()(ai,ag))}
}else{ai.bounds={x0:ae._translatePercentToX(ak.panel.xOuterScale(),af.x0()(ai,ag)),x1:ae._translatePercentToX(ak.panel.xOuterScale(),af.x1()(ai,ag)),y0:ae._translatePercentToY(ak.panel.yOuterScale(),af.y0()(ai,ag)),y1:ae._translatePercentToY(ak.panel.yOuterScale(),af.y1()(ai,ag))}
}return ai
};
af.getPath=function(ag){return(ag===null)?null:af.renderer(ag)
};
af.x0=function(ag){if(!arguments.length){return this._x0
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.x0 must be a function",data:{val:ag}})
}this._x0=ag;
return this
};
af.x1=function(ag){if(!arguments.length){return this._x1
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.x1 must be a function",data:{val:ag}})
}this._x1=ag;
return this
};
af.y0=function(ag){if(!arguments.length){return this._y0
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.y0 must be a function",data:{val:ag}})
}this._y0=ag;
return this
};
af.y1=function(ag){if(!arguments.length){return this._y1
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.y1 must be a function",data:{val:ag}})
}this._y1=ag;
return this
};
af.defined=function(ag){if(!arguments.length){return this._defined
}if(!dv.util.isValidValue(ag,["isFunction"])){dv.log.error({msg:"Invalid value, line.defined must be a function",data:{val:ag}})
}this._defined=ag;
return this
};
return af
};
ad._errorBar=function(){var ae=this,af={};
af.renderer=dv.svg.errorBar().x0(function(ah,ag){return ah.bounds.x0
}).x1(function(ah,ag){return ah.bounds.x1
}).y0(function(ah,ag){return ah.bounds.y0
}).y1(function(ah,ag){return ah.bounds.y1
});
af.getBounds=function(ai,ag){var ah=dv.util.clone(ai);
if(!af._defined(ah,ag)){return null
}if(ae._flip){ah.bounds={x0:ae._translatePercentToY(ai.panel.yOuterScale(),af.y0()(ah,ag)),x1:ae._translatePercentToY(ai.panel.yOuterScale(),af.y1()(ah,ag)),y0:ae._translatePercentToX(ai.panel.xOuterScale(),af.x0()(ah,ag)),y1:ae._translatePercentToX(ai.panel.xOuterScale(),af.x1()(ah,ag))}
}else{ah.bounds={x0:ae._translatePercentToX(ai.panel.xOuterScale(),af.x0()(ah,ag)),x1:ae._translatePercentToX(ai.panel.xOuterScale(),af.x1()(ah,ag)),y0:ae._translatePercentToY(ai.panel.yOuterScale(),af.y0()(ah,ag)),y1:ae._translatePercentToY(ai.panel.yOuterScale(),af.y1()(ah,ag))}
}return ah
};
af.getPath=function(ag){return(ag===null)?null:af.renderer(ag)
};
af.x0=function(ag){if(!arguments.length){return this._x0
}this._x0=ag;
return this
};
af.x1=function(ag){if(!arguments.length){return this._x1
}this._x1=ag;
return this
};
af.y0=function(ag){if(!arguments.length){return this._y0
}this._y0=ag;
return this
};
af.y1=function(ag){if(!arguments.length){return this._y1
}this._y1=ag;
return this
};
af.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return af
};
ad._poly=function(){var ae=this,af={};
af.renderer=dv.svg.poly().xs(function(ah,ag){return ah.bounds.x
}).ys(function(ah,ag){return ah.bounds.y
});
af.getBounds=function(ai,ag){var ah=dv.util.clone(ai);
if(af._defined(ai,ag)){if(ae._flip){ah.bounds={x:ae._translatePercentArrToY(ai.panel.yOuterScale(),af.ys()(ai,ag)),y:ae._translatePercentArrToX(ai.panel.xOuterScale(),af.xs()(ai,ag))}
}else{ah.bounds={x:ae._translatePercentArrToX(ai.panel.xOuterScale(),af.xs()(ai,ag)),y:ae._translatePercentArrToY(ai.panel.yOuterScale(),af.ys()(ai,ag))}
}}return ah
};
af.getPath=function(ag){return(ag===null)?null:af.renderer(ag)
};
af.xs=function(ag){if(!arguments.length){return this._xs
}this._xs=ag;
return this
};
af.ys=function(ag){if(!arguments.length){return this._ys
}this._ys=ag;
return this
};
af.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return af
};
return ad
});
dv.coord.polar=dv.coord.extend(function(){function ad(){this._super();
this.innerRadius=this.startY;
this.outerRadius=this.endY;
this.startAngle=this.startX;
this.endAngle=this.endX;
this.innerRadius(0);
this.outerRadius(0);
this.startAngle(0);
this.endAngle(360);
this._type="polar"
}ad._transformAngleRadiusToXY=function(af,ae){af+=-1.570796327;
return[ae*Math.cos(af),ae*Math.sin(af)]
};
ad._translatePercentToRadius=function(af,ag){var ae=Math.abs(af[1]-af[0])/2,ai=dv.util.getPercentValue(this.innerRadius(),ae),ah=dv.util.getPercentValue(this.outerRadius(),ae);
return(ae-ah-ai)*ag+ai
};
ad._translatePercentToTheta=function(ai,ag){var aj=360,ae=dv.util.getPercentValue(this.startAngle(),aj),af=dv.util.getPercentValue(this.endAngle(),aj),ah=(af-ae)*ag+ae;
return ah*0.017453293
};
ad._translatePercentArrToRadius=function(af,ag){var ae=this;
return dv.util.map(ag,function(ah){return ae._translatePercentToRadius(af,ah)
})
};
ad._translatePercentArrToTheta=function(ag,af){var ae=this;
return dv.util.map(af,function(ah){return ae._translatePercentToTheta(ag,ah)
})
};
ad._getRadiusRange=function(ah,ag){var af=dv.util.scaleRange(ah),ae=dv.util.scaleRange(ag);
return[0,Math.min(Math.abs(af[1]-af[0]),Math.abs(ae[1]-ae[0]))]
};
ad._text=function(){var ae=this;
function af(){var ag=dv.svg.text.radial();
if(ae._flip){return ag.angle(function(ai,ah){return ae._translatePercentToTheta(ai.panel.yOuterScale(),af.y()(ai,ah))
}).radius(function(ai,ah){return ae._translatePercentToRadius(ae._getRadiusRange(ai.panel.xOuterScale(),ai.panel.yOuterScale()),af.x()(ai,ah))
})
}else{return ag.angle(function(ai,ah){return ae._translatePercentToTheta(ai.panel.xOuterScale(),af.x()(ai,ah))
}).radius(function(ai,ah){return ae._translatePercentToRadius(ae._getRadiusRange(ai.panel.xOuterScale(),ai.panel.yOuterScale()),af.y()(ai,ah))
})
}}af.x=function(ag){if(!arguments.length){return this._x
}this._x=ag;
return this
};
af.y=function(ag){if(!arguments.length){return this._y
}this._y=ag;
return this
};
return af
};
ad._point=function(){var af=this,ae={};
ae.renderer=dv.svg.symbol.radial().angle(function(ah,ag){return ah.bounds.x
}).radius(function(ah,ag){return ah.bounds.y
});
ae.getBounds=function(ai,ah){if(!ai.hasOwnProperty("y")){ai.y=0
}if(!ai.hasOwnProperty("x")){ai.x=0
}if(ae._defined(ai,ah)){var ag=af._getRadiusRange(ai.panel.xOuterScale(),ai.panel.yOuterScale());
if(af._flip){ai.bounds={x:af._translatePercentToTheta(ai.panel.xOuterScale(),ae.y()(ai,ah)),y:af._translatePercentToRadius(ag,ae.x()(ai,ah))}
}else{ai.bounds={x:af._translatePercentToTheta(ai.panel.xOuterScale(),ae.x()(ai,ah)),y:af._translatePercentToRadius(ag,ae.y()(ai,ah))}
}}return ai
};
ae.getPath=function(ag){return(ag===null||dv.util.isUndefined(ag.bounds))?null:ae.renderer(ag)
};
ae.x=function(ag){if(!arguments.length){return this._x
}this._x=ag;
return this
};
ae.y=function(ag){if(!arguments.length){return this._y
}this._y=ag;
return this
};
ae.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return ae
};
ad._line=function(){var af=this,ae={};
ae.renderer=d3.svg.line.radial().angle(function(ah,ag){return ah.bounds.x
}).radius(function(ah,ag){return ah.bounds.y
});
ae.getBounds=function(ai,ag){var ah=[];
dv.util.each(ai,function(al,ak){var aj=af._getRadiusRange(al.panel.xOuterScale(),al.panel.yOuterScale());
if(!al.hasOwnProperty("y")){al.y=0
}if(!al.hasOwnProperty("x")){al.x=0
}if(ae._defined(al,ak)){if(af._flip){al.bounds={x:af._translatePercentToTheta(al.panel.xOuterScale(),ae.y()(al,ak)),y:af._translatePercentToRadius(aj,ae.x()(al,ak))}
}else{al.bounds={x:af._translatePercentToTheta(al.panel.xOuterScale(),ae.x()(al,ak)),y:af._translatePercentToRadius(aj,ae.y()(al,ak))}
}ah.push(ai[ak])
}});
return ah
};
ae.getPath=function(ag){return(ag===null)?null:ae.renderer(ag)
};
ae.x=function(ag){if(!arguments.length){return this._x
}this._x=ag;
return this
};
ae.y=function(ag){if(!arguments.length){return this._y
}this._y=ag;
return this
};
ae.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return ae
};
ad._area=function(){var ae=this,af={};
af.renderer=d3.svg.area.radial();
af.getBounds=function(ai,ag){var ah=[];
af.setupRenderer();
dv.util.each(ai,function(am,ak){var aj=ae._getRadiusRange(am.panel.xOuterScale(),am.panel.yOuterScale());
if(!am.hasOwnProperty("y")){am.y=0
}if(!am.hasOwnProperty("x")){am.x=0
}if(af._defined(am,ak)){var al=dv.util.clone(am);
if(ae._flip){al.bounds={x:ae._translatePercentToRadius(aj,af.x()(am,ak)),y0:ae._translatePercentToTheta(am.panel.xOuterScale(),af.y0()(am,ak)),y1:ae._translatePercentToTheta(am.panel.xOuterScale(),af.y1()(am,ak))}
}else{al.bounds={x:ae._translatePercentToTheta(am.panel.xOuterScale(),af.x()(am,ak)),y0:ae._translatePercentToRadius(aj,af.y0()(am,ak)),y1:ae._translatePercentToRadius(aj,af.y1()(am,ak))}
}ah.push(al)
}});
return ah
};
af.getPath=function(ag){af.setupRenderer();
return(ag===null)?null:af.renderer(ag)
};
af.setupRenderer=function(){if(ae._flip){af.renderer.angle(null).innerRadius(null).outerRadius(null).radius(function(ah,ag){return ah.bounds.x
}).startAngle(function(ah,ag){return ah.bounds.y0
}).endAngle(function(ah,ag){return ah.bounds.y1
})
}else{af.renderer.radius(null).startAngle(null).endAngle(null).angle(function(ah,ag){return ah.bounds.x
}).innerRadius(function(ah,ag){return ah.bounds.y0
}).outerRadius(function(ah,ag){return ah.bounds.y1
})
}};
af.x=function(ag){if(!arguments.length){return this._x
}this._x=ag;
return this
};
af.y0=function(ag){if(!arguments.length){return this._y0
}this._y0=ag;
return this
};
af.y1=function(ag){if(!arguments.length){return this._y1
}this._y1=ag;
return this
};
af.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return af
};
ad._rect=function(){var ae=this,af={};
af.renderer=d3.svg.arc().startAngle(function(ah,ag){return ah.bounds.x0
}).endAngle(function(ah,ag){return ah.bounds.x1
}).innerRadius(function(ah,ag){return ah.bounds.y0
}).outerRadius(function(ah,ag){return ah.bounds.y1
});
af.getBounds=function(aj,ah){var ai=dv.util.clone(aj);
if(!af._defined(ai,ah)){return null
}var ag=ae._getRadiusRange(aj.panel.xOuterScale(),aj.panel.yOuterScale());
if(ae._flip){ai.bounds={x0:ae._translatePercentToTheta(aj.panel.yOuterScale(),af.y0()(ai,ah)),x1:ae._translatePercentToTheta(aj.panel.yOuterScale(),af.y1()(ai,ah)),y0:ae._translatePercentToRadius(ag,af.x0()(ai,ah)),y1:ae._translatePercentToRadius(ag,af.x1()(ai,ah))}
}else{ai.bounds={x0:ae._translatePercentToTheta(aj.panel.xOuterScale(),af.x0()(ai,ah)),x1:ae._translatePercentToTheta(aj.panel.xOuterScale(),af.x1()(ai,ah)),y0:ae._translatePercentToRadius(ag,af.y0()(ai,ah)),y1:ae._translatePercentToRadius(ag,af.y1()(ai,ah))}
}return ai
};
af.getPath=function(ag){return(ag===null)?null:af.renderer(ag)
};
af.x0=function(ag){if(!arguments.length){return this._x0
}this._x0=ag;
return this
};
af.x1=function(ag){if(!arguments.length){return this._x1
}this._x1=ag;
return this
};
af.y0=function(ag){if(!arguments.length){return this._y0
}this._y0=ag;
return this
};
af.y1=function(ag){if(!arguments.length){return this._y1
}this._y1=ag;
return this
};
af.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return af
};
ad._poly=function(){var ae=this,af={};
af.renderer=dv.svg.poly.radial().angles(function(ah,ag){return ah.bounds.x
}).radii(function(ah,ag){return ah.bounds.y
});
af.getBounds=function(aj,ah){var ai=dv.util.clone(aj);
if(af._defined(aj,ah)){var ag=ae._getRadiusRange(aj.panel.xOuterScale(),aj.panel.yOuterScale());
if(ae._flip){ai.bounds={x:ae._translatePercentArrToTheta(aj.panel.xOuterScale(),af.ys()(aj,ah)),y:ae._translatePercentArrToRadius(ag,af.xs()(aj,ah))}
}else{ai.bounds={x:ae._translatePercentArrToTheta(aj.panel.xOuterScale(),af.xs()(aj,ah)),y:ae._translatePercentArrToRadius(ag,af.ys()(aj,ah))}
}}return ai
};
af.getPath=function(ag){return(ag===null)?null:af.renderer(ag)
};
af.xs=function(ag){if(!arguments.length){return this._xs
}this._xs=ag;
return this
};
af.ys=function(ag){if(!arguments.length){return this._ys
}this._ys=ag;
return this
};
af.defined=function(ag){if(!arguments.length){return this._defined
}this._defined=ag;
return this
};
return af
};
return ad
});
dv.guide=dv.extend(function(){function ad(){this._renderer=null
}ad._render=function(){dv.log.warn({msg:"dv.guide._render should not be called directly, try using dv.guide.legend.render or dv.guide.axis.render"})
};
ad._scale=function(ae){if(!arguments.length){return this.__scale
}this.__scale=ae;
return this
};
ad.orientation=function(ae){if(!arguments.length){return this._orientation
}this._orientation=ae;
return this
};
ad._parent=function(ae){if(!arguments.length){return this.__parent
}this.__parent=ae;
return this
};
ad.scaleIndex=function(ae){if(!arguments.length){return this._scaleIndex
}this._scaleIndex=ae;
return this
};
ad.title=function(ae){if(!arguments.length){return this._title
}this._title=ae;
return this
};
return ad
});
dv.guide.axes=dv.extend(function(){function ad(){this._axes={};
this._emptyTickFormat=function(){return""
}
}ad._initializeAxisRenderers=function(){this._eachAxis(function(ag,af,ae){if(!ae.hasOwnProperty("_orientation")&&ag==="x"){ae._orientation="bottom"
}if(!ae.hasOwnProperty("_orientation")&&ag==="y"){ae._orientation="left"
}if(this._chart._coord.flip()){switch(ae._orientation){case"top":ae._orientation="right";
break;
case"right":ae._orientation="top";
break;
case"bottom":ae._orientation="left";
break;
case"left":ae._orientation="bottom";
break
}}})
};
ad._measure=function(af){var ag=this._chart._g.select(".panels"),ae=this._chart._axisLabelContainer;
this._eachAxis(function(ak,aj,ai){var ah=this._changeScaleRangeToLocal(af.getOuterScale(ak));
if(!(this._chart._coord instanceof dv.coord.polar)&&ai!=="none"){ai._chart(this._chart)._scale(ah[aj])._parent(ag)._labelParent(ae);
af.margins(ai._measure(af.margins(),af.bounds(),af))
}});
return this
};
ad._getAllOrientations=function(){var ae={};
this._eachAxis(function(ah,ag,af){ae[af._orientation]=ah
});
return ae
};
ad._render=function(ag,af,ae){this._eachAxis(function(ak,aj,ai){var ah=this._changeScaleRangeToLocal(ae.getOuterScale(ak));
if(this._chart._coord instanceof dv.coord.polar||ai==="none"){ag.selectAll(".axis-"+ak+".axis-index-"+aj).transition().duration(this._chart._duration).style("opacity",0).remove();
this._chart._chartContainer.select(".axes-labels .axis-"+ak+".axis-index-"+aj).transition().duration(this._chart._duration).style("opacity",0).remove()
}else{ai._chart(this._chart)._parent(ag)._scale(ah[aj])._labelParent(af)._render(ag,ae,ae.bounds())
}});
return this
};
ad._measureTitles=function(af){var ae=this._chart._axisLabelContainer;
this._eachAxis(function(aj,ai,ah){if(ah!=="none"){var ag=ah._chart(this._chart)._measureAxisTitle(ae,aj,ai);
af.left+=ag.left;
af.top+=ag.top;
af.right-=ag.right;
af.bottom-=ag.bottom
}});
return af
};
ad._renderTitles=function(ae){var af=this._chart._axisLabelContainer;
this._eachAxis(function(ai,ah,ag){if(ag==="none"||!ag.title()){af.selectAll(".axis-title-"+ai+".axis-title-index-"+ah).transition().duration(this._chart._duration).style("opacity",0).remove()
}else{ag._chart(this._chart)._renderAxisTitle(af,ae,ai,ah)
}})
};
ad._changeScaleRangeToLocal=function(af){var ag=af.range();
var ae=af.innerScaleGroup();
for(var ah in ae){dv.util.scaleRange(ae[ah],[ag[0],ag[1]])
}return ae
};
ad._eachAxis=function(af){for(var ah in this._axes){var ag=this._axes[ah];
for(var ae in ag){af.call(this,ah,+ae,ag[ae])
}}};
ad._add=function(ae,af,ag){ag=ag===undefined?0:ag;
var ah=this._axes[ae];
if(!ah){this._axes[ae]=ah={}
}ah[ag]=af;
return this
};
ad._axes=function(ae){if(!arguments.length){return this._axes
}this._axes=ae;
return this
};
ad._get=function(ae){return this._axes[ae]
};
ad._empty=function(){for(var ae in this._axes){delete this._axes[ae]
}this._axes={};
return this
};
ad._chart=function(ae){if(!arguments.length){return this._chart
}this._chart=ae;
return this
};
return ad
});
dv.guide.axis=dv.guide.extend(function(){function ae(){this._ticks=d3.functor(5);
this._tickInterval=undefined;
this._labelGroup=null;
this._htmlLabels=false
}function ad(ag,af){return ag+"%"
}ae._measure=function(ah,af,ag){var an=this._getAxisOffset(af),aj=dv.util.scaleRange(this._scale()),ao=this._ticks.call(this,Math.abs(aj[1]-aj[0])),ak,ar=this;
var al=this._parent().append("g").classed("temp-axis",true);
if(this._shouldDrawAxisLabels(ag)){ak=this._constructLabelGroup(this.__labelParent,an,true)
}var ap=this._constructD3Axis(ak,af,ao,ag);
var ai=this._measureAxis(al,an,ap);
var am={left:ai.x+an[0],top:ai.y+an[1],right:ai.x+ai.width+an[0],bottom:ai.y+ai.height+an[1]};
if(ak){ak.selectAll("span").each(function(){var ax=this,at=d3.select(this),aw=ar._htmlLabels?at.html():at.text();
if(aw){var av=ar._orientation==="right"?ax.offsetWidth/2:0,au=ar._orientation==="bottom"?ax.offsetHeight/2:0,ay=[ax.parentNode.parentNode.offsetLeft+ax.parentNode.offsetLeft+av,ax.parentNode.parentNode.offsetTop+ax.parentNode.offsetTop+au];
am.left=Math.min(ay[0],am.left);
am.top=Math.min(ay[1],am.top);
am.right=Math.max(ay[0]+av,am.right);
am.bottom=Math.max(ay[1]+au,am.bottom)
}})
}al.remove();
if(ak){ak.remove()
}var aq={};
aq.left=Math.abs(Math.min(am.left-af.left,0));
aq.top=Math.abs(Math.min(am.top-af.top,0));
aq.right=Math.max(am.right-af.right,0);
aq.bottom=Math.max(am.bottom-af.bottom,0);
return this._unionAxisPadding(aq,ah)
};
ae._render=function(ak,ag,am){if(!this._scale()){throw new Error("The axis does not have a scale associated with it.")
}var aj=dv.util.scaleRange(this._scale()),al=this._ticks.call(this,Math.abs(aj[1]-aj[0])),ai;
var ah=this._getAxisOffset(am);
if(this._shouldDrawAxisLabels(ag)){ai=this._constructLabelGroup(this.__labelParent,ah)
}else{this.__labelParent.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).remove()
}var af=this._constructD3Axis(ai,am,al,ag);
this._renderAxis(this._parent(),ag.bounds(),ah,af,ai);
return this
};
ae._shouldDrawAxisLabels=function(af){var ai=af.facet(),ah=this._scale().property(),ag=this.orientation();
return(ai._isFree(ah)&&ai._showAllPanelLabelsIfFree())||af.visibleAxisLabelOrientations()[ag]
};
ae._unionAxisPadding=function(af,ag){ag.left=Math.max(ag.left,af.left);
ag.top=Math.max(ag.top,af.top);
ag.right=Math.max(ag.right,af.right);
ag.bottom=Math.max(ag.bottom,af.bottom);
return ag
};
ae._constructLabelGroup=function(ah,ag,ai){var aj=".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()+(ai?" .temp-axis":"");
var af=ah.selectAll(aj).data([0]);
af.enter().append("div").classed("axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),true).classed("temp-axis",ai).style("left",ag[0]+"px").style("top",ag[1]+"px");
if(dv.ANIMATION){af.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease()).style("left",ag[0]+"px").style("top",ag[1]+"px")
}else{af.style("left",ag[0]+"px").style("top",ag[1]+"px")
}return af
};
ae._getAxisOffset=function(af){switch(this._orientation){case"bottom":return[0,af.bottom];
case"left":return[af.left,0];
case"top":return[0,af.top];
case"right":return[af.right,0]
}};
ae._constructD3Axis=function(aj,am,al,af){var ak=dv.util.isUndefined(this._tickSize)?this._getDefaultTickSize(am):this._tickSize,ai=dv.util.isUndefined(this._minorTickSize)?this._getDefaultTickSize(am):this._minorTickSize,ah;
if(this._orientation==="left"){ah="right"
}if(this._orientation==="right"){ah="left"
}if(this._orientation==="top"){ah="bottom"
}if(this._orientation==="bottom"){ah="top"
}if(this._scale().property()==="x"){var ag=dv.util.scaleRange(this._scale());
ag[0]+=this._chart().coord().startX();
ag[1]-=this._chart().coord().endX();
if(this._scale() instanceof dv.scale.ordinal){this._scale().rangeBands(ag)
}else{this._scale().range(ag)
}}return dv.svg.axis()._orient(ah)._labelParent(aj)._panel(af)._ticks(dv.util.isUndefined(al)?5:al,this._tickInterval)._tickSize(ak,ai,ak)._tickDx(dv.util.isUndefined(this._tickDx)?this._getDefaultTickDx():this._tickDx)._tickDy(dv.util.isUndefined(this._tickDy)?this._getDefaultTickDy():this._tickDy)._tickAnchor(dv.util.isUndefined(this._tickAnchor)?this._getDefaultTickAnchor():this._tickAnchor)._tickFormat(dv.util.isUndefined(this._tickFormat)&&this._chart().position()==="fill"&&this._scale().property()==="y"?ad:this._tickFormat)._tickValues(this._tickValues)._htmlLabels(this._htmlLabels)._tickSubdivide(this._tickSubdivide)._scale(this._scale()._d3Scale)
};
ae._renderAxis=function(ak,aj,ah,af,ag){var ai=ak.selectAll(".axis-"+this._scale().property()+".axis-index-"+this._scale().scaleIndex()).data([0]);
af._labelParent(ag);
ai.enter().append("g").classed("axis axis-"+this._scale().property()+" axis-index-"+this._scale().scaleIndex(),true).attr("transform","translate("+ah[0]+","+ah[1]+")");
if(dv.ANIMATION){ai=ai.transition().delay(this._chart().delay()).duration(this._chart().duration()).ease(this._chart().ease())
}ai.attr("transform","translate("+ah[0]+","+ah[1]+")").call(af)
};
ae._measureAxis=function(ah,ag,af){ah.attr("transform","translate("+ag[0]+","+ag[1]+")").call(af);
return ah.node().getBBox()
};
ae._measureAxisTitle=function(ah,am,aj){var ai={left:0,top:0,right:0,bottom:0};
if(this._title){var ak=ah.append("div").classed("temp-axis-title",true),ag=this._titleOrientation||this._orientation,al=this._createAxisTitle(ak,ag,am,aj),af=al.node().getBoundingClientRect();
if(ag==="top"||ag==="bottom"){ai[ag]+=af.height
}else{ai[ag]+=af.width
}ak.remove()
}return ai
};
ae._renderAxisTitle=function(ap,am,ag,an){var af,ao=6,al=0,ah=this._titleOrientation||this._orientation,ak;
if(!this._title){return
}var aj=ap.selectAll(".axis-title-"+ag+".axis-title-index-"+an).empty(),ai=this._createAxisTitle(ap,ah,ag,an);
if(dv.ANIMATION){ak=ai.transition().duration(this._chart().duration()).delay(this._chart().delay()).ease(this._chart().ease())
}this._positionAxisTitle((aj||!dv.ANIMATION)?ai:ak,am[ah],ah);
if(ak){ak.style("opacity",1)
}else{ai.style("opacity",1)
}};
ae._createAxisTitle=function(ag,af,aj,ah){var ai=ag.selectAll(".axis-title-"+aj+".axis-title-index-"+ah).data([ae]);
ai.enter().append("div").classed("axis-title axis-title-"+aj+" axis-title-index-"+ah,true).style("opacity",dv.ANIMATION?0:1).style("position","absolute");
return ai.text(this._title).classed({top:af==="top",bottom:af==="bottom",left:af==="left",right:af==="right"})
};
ae._positionAxisTitle=function(ah,ag,af){ah.style("left",function(){var ai=0;
return ag[0]+ai+"px"
}).style("top",function(){var ai=0;
if(af==="top"){ai=-this.offsetHeight
}if(af==="right"||af==="left"){ai=-this.offsetHeight/2
}return ag[1]+ai+"px"
})
};
ae._getDefaultTickSize=function(af){if(this._orientation==="bottom"){return d3.functor(af.bottom-af.top)
}else{if(this._orientation==="left"){return d3.functor(af.right-af.left)
}else{if(this._orientation==="top"){return d3.functor(af.bottom-af.top)
}else{return d3.functor(af.right-af.left)
}}}};
ae._getDefaultTickDx=function(){return(this._orientation==="bottom"||this._orientation==="top")?d3.functor(0):d3.functor(-12)
};
ae._getDefaultTickDy=function(){return(this._orientation==="bottom"||this._orientation==="top")?d3.functor(-12):d3.functor(0)
};
ae._getDefaultTickAnchor=function(){if(this._orientation==="left"){return d3.functor("end")
}if(this._orientation==="right"){return d3.functor("start")
}return d3.functor("middle")
};
ae._labelParent=function(af){if(!arguments.length){return this.__labelParent
}this.__labelParent=af;
return this
};
ae.ticks=function(ag,af){if(!arguments.length){return dv.util.isFinite(this._tickInterval)?[this._ticks,this._tickInterval]:this._ticks
}if(arguments.length>1){this._ticks=function(){return ag
};
this._tickInterval=af
}else{this._ticks=d3.functor(ag);
this._tickInterval=undefined
}return this
};
ae.tickSubdivide=function(af){if(!arguments.length){return this._tickSubdivide
}this._tickSubdivide=af;
return this
};
ae.tickSize=function(af){if(!arguments.length){return this._tickSize
}this._tickSize=d3.functor(af);
return this
};
ae.minorTickSize=function(af){if(!arguments.length){return this._minorTickSize
}this._minorTickSize=d3.functor(af);
return this
};
ae.tickDx=function(af){if(!arguments.length){return this._tickDx
}this._tickDx=d3.functor(af);
return this
};
ae.htmlLabels=function(af){if(!arguments.length){return this._htmlLabels
}this._htmlLabels=af;
return this
};
ae.tickDy=function(af){if(!arguments.length){return this._tickDy
}this._tickDy=d3.functor(af);
return this
};
ae.tickAnchor=function(af){if(!arguments.length){return this._tickAnchor
}this._tickAnchor=d3.functor(af);
return this
};
ae.tickFormat=function(ag){if(!arguments.length){var af=this._scale()._d3Scale;
if(this._tickFormat){return this._tickFormat
}if(af.tickFormat){return af.tickFormat(af)
}return function(ah){return ah
}
}this._tickFormat=ag;
return this
};
ae.tickValues=function(af){if(!arguments.length){return this._tickValues
}this._tickValues=af;
return this
};
ae.titleOrientation=function(af){if(!arguments.length){return this._titleOrientation
}this._titleOrientation=af;
return this
};
ae._chart=function(af){if(!arguments.length){return this.__chart
}this.__chart=af;
return this
};
return ae
});
dv.svg.axis=function(){var aw=d3.scale.linear(),am="bottom",at=d3.functor(6),ar=d3.functor(6),al=d3.functor(6),ao=d3.functor(0),an=d3.functor(0),aj=d3.functor("start"),af=[10],ad=null,ae=false,ax,ap=0,au;
function ai(az,ay){az.attr("transform",function(aA){return"translate("+ay(aA)+",0)"
})
}function ah(ay,az){ay.attr("transform",function(aA){return"translate(0,"+az(aA)+")"
})
}function av(aB,az,ay){var aA=d3.select(aB).select("span").node().offsetWidth;
var aC=ay==="end"?-aA:ay==="middle"?-aA/2:0;
return az+aC
}function aq(aC,aA,az){var ay=d3.select(aC).select("span").node().offsetHeight;
var aB=az==="top"?0:az==="middle"?-ay/2:-ay;
return aA+aB
}function ak(aA,aE,az){var aF=[];
if(az&&aE.length>1){var aH=dv.util.scaleExtent(aA.domain()),aC=-1,ay=aE.length,aD=(aE[1]-aE[0])/++az,aB,aG;
while(++aC<ay){for(aB=az;
--aB>0;
){if((aG=+aE[aC]-aB*aD)>=aH[0]){aF.push(aG)
}}}for(--aC,aB=0;
++aB<az&&(aG=+aE[aC]+aB*aD)<aH[1];
){aF.push(aG)
}}return aF
}function ag(aA){var ay=function(aE,aH,aF,aG,aD){var aI={};
switch(aD){case"top":aI.top=aq(aE,-an.call(aE,aH,aF),"top");
aI.left=aG(aH)+av(aE,ao.call(aE,aH,aF),aj.call(aE,aH,aF));
break;
case"bottom":aI.top=aq(aE,an.call(aE,aH,aF),"bottom");
aI.left=aG(aH)+av(aE,ao.call(aE,aH,aF),aj.call(aE,aH,aF));
break;
case"right":aI.top=aG(aH)+aq(aE,an.call(aE,aH,aF),"middle");
aI.left=av(aE,ao.call(aE,aH,aF),aj.call(aE,aH,aF));
break;
case"left":aI.top=aG(aH)+aq(aE,an.call(aE,aH,aF),"middle");
aI.left=av(aE,-ao.call(aE,aH,aF),aj.call(aE,aH,aF));
break
}aI.top=(isNaN(aI.top)?0:aI.top)+"px";
aI.left=(isNaN(aI.left)?0:aI.left)+"px";
var aC=aj.call(aE,aH,aF);
d3.select(aE).classed({start:aC==="start",middle:aC==="middle",end:aC==="end"});
return aI
};
var az=function(aD,aC){["top","left"].forEach(function(aE){aD.style(aE,function(aG,aF){return aC[aF][aE]
})
})
};
var aB=function(aO,aJ,aL){if(!au){return
}var aI=ax==null?(aw.tickFormat?aw.tickFormat.apply(aw,af):String):ax,aN,aG,aK,aF;
au.style("position","absolute");
aN=au.selectAll(".axis-label").data(aO,String);
aG=aN.enter().append("div").classed("axis-label",true).style("opacity",0.000001).style("position","absolute");
aK=d3.transition(aN.exit()).style("opacity",0.000001).remove();
aF=d3.transition(aN).style("opacity",1);
aG.append("span");
var aE=aN.selectAll("span"),aR=function(aU,aT,aS){return aI.call(this,aU,aS)
};
if(ae){aE.html(aR)
}else{aE.text(aR)
}var aQ=[],aH=[],aC=[],aP=[];
var aM;
if(!aw.ticks){var aD=aw.rangeBand()/2;
aM=function(aS){return aL(aS)+aD
}
}aG.each(function(aT,aS){aQ[aS]=ay(this,aT,aS,aM||aJ,am)
});
aF.each(function(aT,aS){aH[aS]=ay(this,aT,aS,aM||aJ,am);
aC[aS]=ay(this,aT,aS,aM||aL,am)
});
if(aw.ticks){aK.each(function(aT,aS){aP[aS]=ay(this,aT,aS,aL,am)
})
}az(aG,aQ);
az(aN,aH);
az(aF,aC);
if(aw.ticks){az(aK,aP)
}};
aA.each(function(){var aS=d3.select(this);
var aU=ad==null?(aw.ticks?aw.ticks.apply(aw,af):aw.domain()):ad;
var aG=ak(aw,aU,ap),aE=aS.selectAll(".minor").data(aG,String),aO=aE.enter().insert("line","g").attr("class","tick minor").style("opacity",0.000001),aN=d3.transition(aE.exit()).style("opacity",0.000001).remove(),aD=d3.transition(aE).style("opacity",1);
var aR=aS.selectAll(".axis-tick").data(aU,String),aL=aR.enter().insert("g","path").classed("axis-tick",true).style("opacity",0.000001),aM=d3.transition(aR.exit()).style("opacity",0.000001).remove(),aH=d3.transition(aR).style("opacity",1),aC;
var aK=dv.util.scaleRangeNoReverse(aw);
path=aS.selectAll(".domain").data([0]);
pathEnter=path.enter().append("path").attr("class","domain");
pathUpdate=d3.transition(path);
var aP=aw.copy(),aQ=this.__chart__||aP;
this.__chart__=aP;
aL.append("line").attr("class","tick");
var aF=aL.select("line"),aT=aH.select("line");
switch(am){case"bottom":aC=ai;
aO.attr("y2",function(aW,aV){return ar.call(this,aW,aV,panel)
});
aD.attr("x2",0).attr("y2",function(aW,aV){return ar.call(this,aW,aV,panel)
});
aF.attr("y2",function(aW,aV){return at.call(this,aW,aV,panel)
});
aT.attr("x2",0).attr("y2",function(aW,aV){return at.call(this,aW,aV,panel)
});
pathUpdate.attr("d",function(aW,aV){return"M"+aK[0]+","+al.call(this,aW,aV,panel)+"V0H"+aK[1]+"V"+al.call(this,aW,aV,panel)
});
break;
case"top":aC=ai;
aO.attr("y2",function(aW,aV){return -ar.call(this,aW,aV,panel)
});
aD.attr("x2",0).attr("y2",function(aW,aV){return -ar.call(this,aW,aV,panel)
});
aF.attr("y2",function(aW,aV){return -at.call(this,aW,aV,panel)
});
aT.attr("x2",0).attr("y2",function(aW,aV){return -at.call(this,aW,aV,panel)
});
pathUpdate.attr("d",function(aW,aV){return"M"+aK[0]+","+-al.call(this,aW,aV,panel)+"V0H"+aK[1]+"V"+-al.call(this,aW,aV,panel)
});
break;
case"left":aC=ah;
aO.attr("x2",function(aW,aV){return -ar.call(this,aW,aV,panel)
});
aD.attr("x2",function(aW,aV){return -ar.call(this,aW,aV,panel)
}).attr("y2",0);
aF.attr("x2",function(aW,aV){return -at.call(this,aW,aV,panel)
});
aT.attr("x2",function(aW,aV){return -at.call(this,aW,aV,panel)
}).attr("y2",0);
pathUpdate.attr("d",function(aW,aV){return"M"+-al.call(this,aW,aV,panel)+","+aK[0]+"H0V"+aK[1]+"H"+-al.call(this,aW,aV,panel)
});
break;
case"right":aC=ah;
aO.attr("x2",function(aW,aV){return ar.call(this,aW,aV,panel)
});
aD.attr("x2",function(aW,aV){return ar.call(this,aW,aV,panel)
}).attr("y2",0);
aF.attr("x2",function(aW,aV){return at.call(this,aW,aV,panel)
});
aT.attr("x2",function(aW,aV){return at.call(this,aW,aV,panel)
}).attr("y2",0);
pathUpdate.attr("d",function(aW,aV){return"M"+al.call(this,aW,aV,panel)+","+aK[0]+"H0V"+aK[1]+"H"+al.call(this,aW,aV,panel)
});
break
}if(aw.ticks){aL.call(aC,aQ);
aH.call(aC,aP);
aM.call(aC,aP);
aO.call(aC,aQ);
aD.call(aC,aP);
aN.call(aC,aP)
}else{var aJ=aP.rangeBand()/2,aI=function(aV){return aP(aV)+aJ
};
aL.call(aC,aI);
aH.call(aC,aI)
}aB(aU,aQ,aP)
})
}ag._scale=function(ay){if(!arguments.length){return aw
}aw=ay;
return ag
};
ag._orient=function(ay){if(!arguments.length){return am
}am=ay;
return ag
};
ag._ticks=function(){if(!arguments.length){return af
}af=arguments;
return ag
};
ag._tickValues=function(ay){if(!arguments.length){return ad
}ad=ay;
return ag
};
ag._tickFormat=function(ay){if(!arguments.length){return ax
}ax=ay;
return ag
};
ag._htmlLabels=function(ay){if(!arguments.length){return ae
}ae=ay;
return ag
};
ag._tickSize=function(ay,aB,az){if(!arguments.length){return at
}var aA=arguments.length-1;
at=d3.functor(ay);
ar=aA>1?d3.functor(aB):at;
al=aA>0?d3.functor(arguments[aA]):at;
return ag
};
ag._tickDx=function(ay){if(!arguments.length){return ao
}ao=ay;
return ag
};
ag._tickDy=function(ay){if(!arguments.length){return an
}an=ay;
return ag
};
ag._tickAnchor=function(ay){if(!arguments.length){return aj
}aj=ay;
return ag
};
ag._tickSubdivide=function(ay){if(!arguments.length){return ap
}ap=+ay;
return ag
};
ag._panel=function(ay){if(!arguments.length){return panel
}panel=ay;
return ag
};
ag._labelParent=function(ay){if(!arguments.length){return au
}au=ay;
return ag
};
return ag
};
dv.guide.legends=dv.extend(function(){function ad(){this._legArr=[];
this.__hide=false;
this._ad={left:0,right:0,width:0,height:0}
}ad._render=function(ag){this._w=0;
this._h=0;
if(!this.__hide){var ah=ag.el.select(".legends"),af=this;
var ae=ah.selectAll(".legend").data(this._legArr);
ae.exit().transition().duration(ag.duration).style("opacity",0).remove();
var ai=ae.enter().append("g").classed("legend",true);
if(dv.ANIMATION){ai.style("opacity",0)
}ae.each(function(ap,ao){var aq={},aj=ap.props[0],al=af._getScale(ag,ap.props[0]),am=al.domain();
for(var an=0;
an<ap.props.length;
an++){var ak=ap.props[an],ar=af._getScale(ag,ap.props[an]);
if(ar.hasSameDomain(am)){aq[ak]=ag.scales[ak]
}else{throw new Error("Can't render single legend from multiple domains")
}}ap.guide._render(d3.select(this),aq,{dims:af._ad,renderOpts:ag});
af._w+=ap.guide._getUsedWidth();
af._h+=ap.guide._getUsedHeight();
af._ad=ap.guide._getAdjustedDimensions(af._ad)
})
}return this
};
ad._getScale=function(af,ah){var ae=af.scales[ah],ag;
if(ah===undefined||ae===undefined||ae[0]===undefined){throw new Error("A '"+ah+"'' legend has been called for, but '"+ah+" hasn't been mapped to data.")
}return ae[0]
};
ad._add=function(ae){this._legArr.push(ae);
return this
};
ad._remove=function(ah){for(var aj in ah){var ak=ah[aj];
for(var ag=0;
ag<this._legArr.length;
ag++){var ai=this._legArr[ag].props,ae=true;
for(var af=0;
af<ai.length;
af++){if(ai[af]===ak){ai.splice(af,1);
af--
}if(ai.length===0){ae=false
}}if(!ae){this._legArr.splice(ag,1);
ag--
}}}};
ad._legends=function(ae){if(!arguments.length){return this._legArr
}this._legArr=ae;
return this
};
ad._allowedDimensions=function(ae){if(!arguments.length){return this._ad
}this._ad=ae;
return this
};
ad._getWidth=function(){return this._w
};
ad._getHeight=function(){return this._h
};
ad._hide=function(ae){if(!arguments.length){return this.__hide
}this.__hide=ae;
return this
};
ad._empty=function(){for(var ae=0;
ae<this._legArr.length;
ae++){delete this._legArr[ae]
}this._legArr=[];
return this
};
return ad
});
dv.guide.legend=dv.guide.extend(function(){function ah(){this._overlay=false;
this._orientation="top";
this._vGap=5;
this._hGap=15;
this._defaultPadding=this._padding={top:10,left:10,right:10,bottom:10};
this._swatchWidth=15;
this._swatchHeight=10;
this._innerPadding=5;
this._spanPercent=0.75;
this._lineHeight=0;
this._entriesWidth=[]
}ah._render=function(ak,at,aw){var al=ak,ap=aw.dims,av=this;
this._renderingOptions=aw.renderOpts;
this._scales=at;
this._transformData=[];
this._width=ap.width-this._padding.left-this._padding.right;
this._height=ap.height-this._padding.top-this._padding.bottom;
var aq=this._drawEntries(ak);
this._legendWidths=ae.call(this,aq);
var ar=af.call(this,Math.min(this._legendWidths.length,Math.floor(this._width/this._swatchWidth)));
var am=ag.call(this,ar);
var ao=am.offsets;
ar=am.cols;
this._width=this._width-ar.padding+(this._hGap*(ar.data.length-1));
this._height=this._lineHeight+ao[ao.length-1].y;
aq.each(function(az,ax){var ay=d3.select(this);
if(dv.ANIMATION){ay=ay.transition().duration(av._renderingOptions.duration).delay(av._renderingOptions.delay).ease(av._renderingOptions.ease)
}ay.attr("transform","translate("+ao[ax].x+", "+ao[ax].y+")")
});
if(!this._renderingOptions.firstRender){al=ak.transition().duration(this._renderingOptions.duration).style("opacity",1)
}var an=(this._orientation==="right")?ap.left+ap.width-this._width-this._padding.right:ap.left+this._padding.left;
var au=(this._orientation==="bottom")?ap.top+ap.height-this._height-this._padding.bottom:ap.top+this._padding.top;
al.attr("transform","translate("+(an)+","+(au)+")");
if(this._renderingOptions.firstRender){al.transition().duration(this._renderingOptions.duration).style("opacity",1)
}};
ah._drawEntries=function(ao){var al=this,an=[];
this._entryWidths=[];
for(var ap in this._scales){an=this._scales[ap][0].domain();
break
}var ak=ao.selectAll(".legend-entry").data(an);
ak.exit().transition().duration(this._renderingOptions.duration).style("opacity",0).remove();
var am=ak.enter().append("g").classed("legend-entry",true);
am.append("path");
am.append("text").classed("legend-entry-label",true);
am.append("text").classed("legend-entry-value",true);
ak.select("path").attr("d",function(ar,aq){return ai.call(al,ar,aq)
}).call(function(aq){aq.attr("style","");
if(al._scales.hasOwnProperty("fill")){aq.style("fill",function(at,ar){return al._scales.fill[0].mapValue(at)
})
}if(al._scales.hasOwnProperty("stroke")){aq.style("stroke",function(at,ar){return al._scales.stroke[0].mapValue(at)
}).style("stroke-width",2)
}if(al._scales.hasOwnProperty("linetype")){aq.style("stroke-dasharray",function(at,ar){return dv.util.svg.getDasharray(al._scales.linetype[0].mapValue(at))
});
if(!al._scales.hasOwnProperty("stroke")){aq.style("stroke","#000")
}aq.style("stroke-width",2)
}if(al._scales.hasOwnProperty("size")){aq.style("stroke-width",function(at,ar){return al._scales.size[0].mapValue(at)
})
}}).each(function(ar,aq){al._entryWidths[aq]=this.getBBox().width
});
ak.select("text.legend-entry-label").attr("x",this._swatchWidth+this._innerPadding).attr("y",10).text(function(ar,aq){if(dv.util.isUndefined(al._labels)){return ar
}else{return al._labels[aq%al._labels.length]
}}).each(function(ar,aq){al._entryWidths[aq]+=al._innerPadding+this.getBBox().width
});
ak.select("text.legend-entry-value").attr("y",10).attr("x",function(ar,aq){return al._entryWidths[aq]+al._innerPadding
}).text(function(ar,aq){if(dv.util.isUndefined(al._values)){return""
}else{return al._values[aq]
}}).style("fill",function(ar,aq){if(!dv.util.isUndefined(al._scales.stroke)){return al._scales.stroke[0].mapValue(ar)
}else{if(!dv.util.isUndefined(al._scales.fill)){return al._scales.fill[0].mapValue(ar)
}}return
}).each(function(at,aq){var ar=this.getBBox().width;
al._entryWidths[aq]+=ar+((ar>0)?al._innerPadding:0)
});
return ak
};
function ae(ak){var al=this;
ak.each(function(an,am){al._entryWidths[am]=Math.min(al._entryWidths[am],al._width);
al._lineHeight=Math.max(al._lineHeight,this.getBBox().height)
});
return al._entryWidths
}function ag(ar){var au=0,at=0,aq,al=0,am=false,ap=0,ak=0,an=[];
for(var ao=0;
ao<this._legendWidths.length;
ao++){au+=((at===0)?0:this._hGap)+this._legendWidths[ao];
if(at<ar.data.length&&au<=this._width){if(this._legendWidths[ao]<=ar.data[at]+al){ak+=((at===0)?0:this._hGap);
an.push({x:ak,y:ap});
ak+=ar.data[at]+al;
al=0
}else{if((aq=this._legendWidths[ao]-ar.data[at])<=ar.padding){ar.padding-=aq;
ar.data[at]=this._legendWidths[ao];
return ag.call(this,ar)
}else{if((at+1<ar.data.length)&&this._legendWidths[ao]>=ar.data[at]+(ar.data[at+1]*this._spanPercent)+al){if(at+1<=ar.data.length){al+=((at===0)?0:this._hGap)+ar.data[at];
au-=((at===0)?0:this._hGap)+this._legendWidths[ao];
ao--
}else{au=au-this._legendWidths[ao]+al+ar.data[at];
al=0;
ak+=((at===0)?0:this._hGap);
an.push({x:ak,y:ap});
ak+=ar.data[at]+al;
at++
}}else{ar=af.call(this,ar.data.length-1);
return ag.call(this,ar)
}}}at++
}else{if(at+1===ar.data.length&&ar.data.length>1){ar=af.call(this,ar.data.length-1);
return ag.call(this,ar)
}else{if(at===ar.data.length){am=true
}ap+=this._lineHeight+this._vGap;
au=ak=0;
at=0;
al=0;
ao--
}}}if(at===ar.data.length){am=true
}if(!am){ar=af.call(this,ar.data.length-1);
return ag.call(this,ar)
}return{offsets:an,cols:ar}
}function af(am){var an={data:[],padding:this._width},al=0,ak=0;
if(this._isVAligned()){am=Math.ceil(this._legendWidths.length/Math.floor(this._height/(this._lineHeight+this._vGap)))
}for(ak=0;
ak<am;
ak++){al+=this._legendWidths[ak]+this._hGap
}al-=this._hGap;
if(al>this._width&&am>1){return af.call(this,am-1)
}an.data=this._legendWidths.slice(0,am);
an.padding-=al;
if(an.padding<0){an.padding=0
}return an
}function aj(ak,an,al,am){return"M"+ak+","+an+"L"+(ak+al)+","+an+"L"+(ak+al)+","+(an+am)+"L"+ak+","+(an+am)+"Z"
}function ad(al,an,ak,am){var ao=((an+am)>>1);
return"M"+al+","+ao+"L"+ak+","+ao
}function ai(al,ak){if(this._scales.hasOwnProperty("fill")){return aj.call(this,0,0,this._swatchWidth,this._swatchHeight)
}else{return ad.call(this,0,0,this._swatchWidth,this._swatchHeight)
}}ah._getAdjustedDimensions=function(am){if(this._overlay){return am
}var ak=this._padding.left+this._width+this._padding.right,al=this._padding.top+this._height+this._padding.bottom;
if(this._orientation==="left"){am.left+=ak;
am.width-=ak
}else{if(this._orientation==="top"){am.top+=al;
am.height-=al
}else{if(this._orientation==="right"){am.width-=ak
}else{if(this._orientation==="bottom"){am.height-=al
}}}}return am
};
ah._getUsedWidth=function(){if(this._overlay){return 0
}else{return(this._isVAligned()?this._width+this._padding.left+this._padding.right:0)
}};
ah._getUsedHeight=function(){if(this._overlay){return 0
}else{return(this._isVAligned()?0:this._height+this._padding.top+this._padding.bottom)
}};
ah._isVAligned=function(){return(this._orientation==="left"||this._orientation==="right")
};
ah.vGap=function(ak){if(!arguments.length){return this._vGap
}this._vGap=ak;
return this
};
ah.hGap=function(ak){if(!arguments.length){return this._hGap
}this._hGap=ak;
return this
};
ah.padding=function(ak){if(!arguments.length){return this._padding
}this._padding=dv.util.merge(this._defaultPadding,ak);
return this
};
ah.align=function(ak){if(!arguments.length){return this._align
}this._align=ak;
return this
};
ah.labels=function(ak){if(!arguments.length){return this._labels
}this._labels=ak;
return this
};
ah.values=function(ak){if(!arguments.length){return this._values
}this._values=ak;
return this
};
ah.overlay=function(ak){if(!arguments.length){return this._overlay
}this._overlay=ak;
return this
};
return ah
});
dv.guide.custom=dv.guide.extend(function(){function ad(ae){this._render=function(){dv.log.warn({msg:"empty render function on custom guide"});
return this
};
this._getAdjustedDimensions=function(af){return af
};
this._getUsedWidth=function(){return 0
};
this._getUsedHeight=function(){return 0
}
}ad.setFunc=function(af,ae){this[af]=ae;
return this
};
return ad
});
dv.geom=dv.container.extend(function(){function ad(){this._super();
this._defaultAes={};
this._behaviorsLayer=null;
this._dodgePadding=0;
this._initializeDefaultAes()
}ad._initializeDefaultAes=function(){this._defaultAes.x=1;
this._defaultAes.y=1;
this._defaultAes.shape="circle";
this._defaultAes.linetype="solid"
};
ad._prerender=function(ae){this._trainedScales={};
this._chart=ae;
this.normalizedData(this._normalizeData(this.data()));
this._calculateStats();
this._inheritChartAesthetics(ae)
};
ad._inheritChartAesthetics=function(ae){for(var ah in ae._aes){var ag=ae._aes[ah];
if(!this._aes[ah]){this._aes[ah]={}
}for(var af in ag){if(!this._aes[ah][af]){this._aes[ah][af]=ag[af]
}}}};
ad._trainScales=function(){};
ad._createDefaultScales=function(){for(var ae in this._defaultAes){if(!this._aes.hasOwnProperty(ae)){this._aes[ae]={};
this._aes[ae][0]=dv.scale.constant().value(this._defaultAes[ae]).property(ae)
}delete this._defaultAes[ae]
}};
ad._render=function(af){var ae=this;
this._geomGroup=d3.select(af);
var ag=this._geomGroup.selectAll(".series").data(this._nestData);
ag.exit().call(ae.exitSeriesGroup,ae);
ag.enter().append("g").classed("series",true);
ag.call(ae.updateGroups,ae.enterPen,ae.pen,ae.enterPen,ae).call(ae.updateDataPoints,ae.enterPen,ae.pen,ae.enterPen,ae);
ae._renderBehaviors(ae._geomGroup);
ae.unregisterEventMap=null
};
ad._renderBehaviors=function(af){var ae=this;
if(this._behaviors&&this._behaviors.length){this._behaviorsLayer=af.select(".behavior-layer");
if(this._behaviorsLayer.empty()){this._behaviorsLayer=af.append("g").classed("behavior-layer",true)
}else{this._behaviorsLayer.node().parentNode.appendChild(this._behaviorsLayer.node())
}dv.util.each(this._behaviors,function(ag){ag._geom(ae)._render(ae._behaviorsLayer)
})
}};
ad.updateGroups=function(ah,ai,ag,ae,af){ah.each(function(an,am){var aq=0,ap=0,ar=d3.select(this),ak=ar.attr("transform");
if(af._chart._coord instanceof dv.coord.polar){var at=an.values[0],aj=dv.util.scaleRange(at.panel.xOuterScale()),al=dv.util.scaleRange(at.panel.yOuterScale()),av=(aj[0]+aj[1])/2,ao=(al[0]+al[1])/2,au=af._chart._coord.flip();
aq=au?ao:av;
ap=au?av:ao
}if(ak&&dv.ANIMATION){ar=ar.transition().duration(function(ax,aw){return af.duration().call(this,ax,aw)
})
}ar.attr("transform","translate("+aq+","+ap+")")
})
};
ad.updateDataPoints=function(ah,af,ai,am,an){var ag=af.call(an),aj=ai.call(an),ak=am.call(an);
var ae=ah.selectAll("."+an._dataPointStyleClass).data(function(ao){return an.getValues(ao)
});
ae.exit().transition().delay(function(aq,ap,ao){return an.delay().call(this,aq,ap,ao)
}).duration(function(aq,ap,ao){return an.duration().call(this,aq,ap,ao)
}).ease(an.ease()).each(function(){this.__exiting__=true
}).attrTween("d",ak.pathTween).remove();
ae.enter().append("path").each(function(aq,ap,ao){an.setPreviousState.call(this,ag,ak,aq,ap,ao)
}).attr("class",function(aq,ap,ao){return"datum-"+ap+" series-"+ao
}).call(an.attributes,an).attr("d",ag.path);
var al=ae.call(an.attributes,an).call(an._removeRegisteredEvents,an).call(an._addRegisteredEvents,an).each(function(){this.__exiting__=false
});
if(dv.ANIMATION){al=al.transition().delay(function(aq,ap,ao){return an.delay().call(this,aq,ap,ao)
}).duration(function(aq,ap,ao){return an.duration().call(this,aq,ap,ao)
}).ease(an.ease()).attrTween("d",aj.pathTween)
}else{al.each(function(ar,ap,ao){var aq=aj.bounds(ar,ap,ao);
if(aq){ar.bounds=aq.bounds
}}).attr("d",aj.path)
}al.call(an.addEachFunction,an)
};
ad.addEachFunction=function(af,ae){if(ae._each){if(!dv.util.isUndefined(ae._each.start)){if(dv.ANIMATION){af.each("start",function(ai,ah,ag){ae._each.start.call(this,ai,ah,ag)
})
}else{af.each(function(ai,ah,ag){ae._each.start.call(this,ai,ah,ag)
})
}}if(!dv.util.isUndefined(ae._each.end)){if(dv.ANIMATION){af.each("end",function(ai,ah,ag){ae._each.end.call(this,ai,ah,ag)
})
}else{af.each(function(ai,ah,ag){ae._each.end.call(this,ai,ah,ag)
})
}}}};
ad.exitSeriesGroup=function(af,ae){ae.exitSeries(af,ae.enterPen,ae)
};
ad.setPreviousState=function(ah,ae,ai,af){var ag=ah.bounds(ai,af);
this.__previousBounds__=ag;
this.__exitTransition__=ae
};
ad.pathTween=function(af,ah,ak,ag,ae){var aj,ai=d3.select(ah);
if(ah.__exiting__){aj=ah.__exitTransition__.path(ak,ag);
ah.__exiting__=false
}else{aj=af.getPath(af.getBounds(ak,ag))
}if(aj===null){ai.remove();
return null
}return d3.interpolate(ai.attr("d"),aj)
};
ad._calculateStats=function(){};
ad._handlePositions=function(){if(this.position()!=="stack"&&this.position()!=="fill"&&this.position()!=="dodge"){return
}var ae=this.position(),ai=this._addGroupLayerToNestedData(),af=this._chart.coord().flip(),ah=function(al){var ak=ag.getExplicitScales(al)[al],aj=false;
return function(ao,am){for(var an in ak){aj=ak[an]._includeInDomain(ao,am);
if(aj){break
}}return aj?ao[al]:0
}
},ag=this;
dv.util.each(ai,function(am){var al=ah("x"),ak=ah("y");
if(ae==="stack"){d3.layout.stack().x(al).y(ak).values(function(an){return an.values
})(am.values)
}else{if(ae==="fill"){d3.layout.stack().x(al).y(ak).offset(function(at){var av=at.length,an=at[0].length,ao=1/av,aq,ap,au,ar=[];
for(ap=0;
ap<an;
++ap){for(aq=0,au=0;
aq<av;
aq++){au+=at[aq][ap][1]
}if(au){for(aq=0;
aq<av;
aq++){at[aq][ap][1]/=au
}}else{for(aq=0;
aq<av;
aq++){at[aq][ap][1]=0
}}}for(ap=0;
ap<an;
++ap){ar[ap]=0
}return ar
}).values(function(an){return an.values
})(am.values)
}else{if(ae==="dodge"){var aj=am.values.length;
dv.util.each(am.values,function(ao,an){dv.util.each(ao.values,function(ap){ap.dodge={groupIndex:an,numGroups:aj}
})
})
}}}})
};
ad._addGroupLayerToNestedData=function(){var af=[],ag={},ae={};
dv.util.each(this._nestData,function(ak,ai){var am=/(.*) ~ .*/g.exec(ak.key)[1],ah=/.* ~ (.*)/g.exec(ak.key)[1],al,aj;
if(!ag.hasOwnProperty(am)){af.push({key:am,values:[]});
ag[am]=af.length-1
}al=af[ag[am]];
if(!ae.hasOwnProperty(ak.key)){al.values.push({key:ah,values:[]});
ae[ak.key]=al.values.length-1
}aj=al.values[ae[ak.key]];
aj.values=aj.values.concat(ak.values)
});
return af
};
ad.exit=function(ae){d3.select(ae).selectAll(".series").call(this.exitSeriesGroup,this)
};
ad.exitSeries=function(ag,ae,af){ag.selectAll("."+af._dataPointStyleClass).transition().delay(function(aj,ai,ah){return af.delay().call(this,aj,ai,ah)
}).duration(function(aj,ai,ah){return af.duration().call(this,aj,ai,ah)
}).ease(af.ease()).each(function(){this.__exiting__=true
}).attrTween("d",ae.call(af).pathTween).remove().each("end",function(ak,aj){var ai=this.parentNode;
if(ai&&ai.childNodes&&!ai.childNodes.length){var ah=ai.parentNode;
if(ah&&ah.childNodes&&ah.childNodes.length<=1){d3.select(ah).remove()
}else{d3.select(ai).remove()
}}})
};
ad.coord=function(){return this.chart().coord()
};
ad._addRegisteredEvents=function(af,ae){if(!ae){ae=this
}if(!ae._geomGroup){return
}af=(!af?ae._geomGroup.selectAll(".series").selectAll("."+this._dataPointStyleClass):af);
ae=ae||this;
dv.util.each(ae.eventMap,function(ah,ag){af.on(ag,function(ak,aj,ai){ae.eventMap[ag].callback.call(this,ak,aj,ai,d3.event)
},ah.capture)
});
dv.util.each(ae._chart.eventMap,function(ah,ag){af.on(ag+".dvchart",function(al,aj){var ak=d3.event,ai=ae._chart._interactionGroup.select(".interaction-canvas").node();
if(ae._shouldDispatchChartEvent(ak,ai)){ae._chart.eventMap[ag].callback.call(ai,ak)
}},ah.capture)
});
dv.util.each(ae._behaviors,function(ag){if(ag._addRegisteredEvents){ag._addRegisteredEvents()
}})
};
ad._removeRegisteredEvents=function(af,ae){if(!ae){ae=this
}if(!ae._geomGroup){return
}af=af||ae._geomGroup.selectAll("."+this._dataPointStyleClass);
ae=ae||this;
dv.util.each(ae.unregisterEventMap,function(ag,ah){af.on(ah,null,ag)
});
dv.util.each(ae._chart.unregisterEventMap,function(ag,ah){af.on(ah+".dvchart",null,ag)
});
dv.util.each(ae._behaviors,function(ag){if(ag._removeRegisteredEvents){ag._removeRegisteredEvents()
}})
};
ad._shouldDispatchChartEvent=function(aj,ag){var ae=true;
if(aj.type==="mouseout"||aj.type==="mouseover"){var af=aj.relatedTarget;
if(!af){af=(aj.type==="mouseout")?aj.toElement:aj.fromElement
}var ai=d3.select(af);
if(ai&&!ai.empty()){var ah=ai.attr("class");
ae=!((ai.node()===ag)||(ah&&ah.indexOf("-geom")>=0))
}}return ae
};
ad.getExplicitScalesMap=function(){var ag=dv.util.clone(this._chart.getExplicitScalesMap());
for(var ai in this._aes){var ae=this._aes[ai],ah=ag[ai]||{},af=dv.util.extend({},ah,ae);
ag[ai]=af
}return ag
};
ad.getExplicitScale=function(ag,af){if(ag==="group"){return this._getGroup()
}var ae=this._aes[ag];
var ah=this.chart()._aes[ag];
if(af!==undefined&&ae&&ae[af]){return ae[af]
}if(af!==undefined&&ah&&ah[af]){return ah[af]
}if(ae&&ae[0]!==undefined){return ae[0]
}if(ah&&ah[0]!==undefined){return ah[0]
}return null
};
ad.getExplicitScales=function(ah){if(!dv.util.isArray(ah)){ah=[ah]
}var ae={},ag=-1,ak=ah.length;
while(++ag<ak){var aj=ah[ag],af=this._aes[aj],ai=this.chart()._aes[aj]||{};
ae[aj]=dv.util.extend({},ai,af)
}return ae
};
ad.getTrainedScale=function(af,ae){return this.chart().getTrainedScale(af,ae)
};
ad.getScale=function(af,ae){return this.getExplicitScale(af,ae)
};
ad.getScales=function(ae){return this.getExplicitScales(ae)
};
ad.hasScale=function(af,ae){if(this.getExplicitScale(af,ae)){return true
}return false
};
ad._dodgeAdjust=function(aj){var ae=aj.dodge.groupIndex,ah=aj.dodge.numGroups,af=aj.panel.xScale(aj).rangeBand(),ag=(ah>1)?af/(ah-1)*this._dodgePadding:0,ai=(af-(ag*(ah-1)))/ah;
return(ai+ag)*ae+(ai/2)
};
ad.applyAttributeValue=function(ag,af,ae,ai){var ah=af.getScale(ai,0);
ag.style(ae,function(al,ak,aj){return ah?ah.mapToProp(dv.util.isArray(al)?al[0]:al,ak,aj):null
})
};
ad._getGroup=function(){if(this._aes.hasOwnProperty("group")){return this._aes.group[0]
}var ah=this.chart()._getGroup();
if(ah&&ah.property()==="group"){return ah
}var af=-1,ae=dv.DEFAULT_CATEGORICAL_AES.length-1;
while(af++<ae){var ag=this._aes[dv.DEFAULT_CATEGORICAL_AES[af]];
if(ag&&ag[0]&&!dv.util.isUndefined(ag[0].mapping())){return ag[0]
}}return ah
};
ad.each=function(af,ae){var ag,ah;
if(!arguments.length){return this._each
}this._each=this._each||{};
if(arguments.length<2){ah=af;
ag="end"
}else{ah=ae;
ag=af
}this._each[ag]=ah;
return this
};
ad.dodgePadding=function(ae){if(!arguments){return this._dodgePadding
}this._dodgePadding=ae;
return this
};
ad.behaviors=function(ae){if(!arguments.length){return this._behaviors
}this._behaviors=ae;
return this
};
ad.stat=function(ae){if(!arguments.length){return this._stat
}this._stat=ae;
return this
};
ad.chart=function(ae){if(!arguments.length){return this._chart
}this._chart=ae;
return this
};
ad.normalizedData=function(ae){if(!arguments.length){return this._normalizedData
}this._normalizedData=ae;
return this
};
ad.data=function(ae){if(!arguments.length){return this._data?this._data:this.chart().data()
}this._data=ae;
return this
};
return ad
});
dv.geom.point=dv.geom.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.point
}ad._dataPointStyleClass="point-geom";
ad._initializeDefaultAes=function(){this._super();
this._defaultAes.shape="circle";
this._defaultAes.size=7
};
ad.getValues=function(ae){return ae.values
};
ad.exitSeriesGroup=function(af,ae){ae.exitSeries(af,ae.enterPen,ae)
};
ad.attributes=function(af,ae){af.attr("style","").classed(ae._dataPointStyleClass,true).call(ae.applyAttributeValue,ae,"opacity","alpha").call(ae.applyAttributeValue,ae,"stroke","stroke").call(ae.applyAttributeValue,ae,"fill","fill")
};
ad.getHighlightColor=function(ah,af){var ag=this.getScale("fill"),ae=this.getScale("stroke");
if(ae&&!(ae instanceof dv.scale.constant)){return ae.mapToProp(ah,af)
}if(ag&&!(ag instanceof dv.scale.constant)){return ag.mapToProp(ah,af)
}return ae?ae.mapToProp(ah,af):"#8CC350"
};
ad.enterPen=function(){var af=this,ae,ag=function(ai,ah){return ai.panel.yScale(ai).reverse()?1:0
};
if(this.position()==="dodge"){ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+af._dodgeAdjust(aj),ai)
}
}else{ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand()/2,ai)
}
}return this._decoratePen(ae,ag)
};
ad.pen=function(){var af=this,ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand()/2,ai)
},ag;
switch(this.position()){case"identity":ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapToProp(ai,ah)+aj.rangeBand()/2,ah)
};
break;
case"stack":ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapValue(ai.y0+ai.y),ah)
};
break;
case"dodge":ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+af._dodgeAdjust(aj),ai)
};
ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapToProp(ai,ah)+aj.rangeBand()/2,ah)
};
break;
case"fill":ag=function(ai,ah){return(ai.y+ai.y0)
};
break
}return this._decoratePen(ae,ag)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.xScale(af).mapToProp(af,ae))&&dv.util.isFinite(af.panel.yScale(af).mapToProp(af,ae))
};
ad._decoratePen=function(af,aj){var ai=this.getScale("shape"),ae=this.getScale("size"),ag=this;
var ah=this.coord()._point().x(af).y(aj).defined(this._defined);
ah.renderer.type(function(al,ak){return ai.mapToProp(al,ak)
}).size(function(al,ak){return Math.pow(ae.mapToProp(al,ak),2)
});
return{bounds:function(al,ak){return ah.getBounds(al,ak)
},pathTween:function(al,ak){return ag.pathTween(ah,this,al,ak)
},path:function(al,ak){return ah.getPath(ah.getBounds(al,ak))
}}
};
return ad
});
dv.geom.text=dv.geom.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.text;
this._dx=d3.functor(0);
this._dy=d3.functor(0);
this._textFormat=function(ae){return ae
};
this._textAnchor="start"
}ad._dataPointStyleClass="text-geom";
ad.dx=function(ae){if(!arguments.length){return this._dx
}this._dx=d3.functor(ae);
return this
};
ad.dy=function(ae){if(!arguments.length){return this._dy
}this._dy=d3.functor(ae);
return this
};
ad.textAnchor=function(ae){if(!arguments.length){return this._textAnchor
}this._textAnchor=ae;
return this
};
ad.textFormat=function(ae){if(!arguments.length){return this._textFormat
}this._textFormat=d3.functor(ae);
return this
};
ad.getValues=function(ae){return ae.values
};
ad.updateDataPoints=function(ah,af,ai,am,ao){var an=ao.getScale("alpha"),ag=af.call(ao),aj=ai.call(ao),ak=am.call(ao);
var ae=ah.selectAll("."+ao._dataPointStyleClass).data(function(ap){return ao.getValues(ap)
});
ae.exit().transition().delay(function(ar,aq,ap){return ao.delay().call(this,ar,aq,ap)
}).duration(function(ar,aq,ap){return ao.duration().call(this,ar,aq,ap)
}).ease(ao.ease()).call(ak).each("end.transition",function(ar,aq){var ap=this.parentNode;
if(ap){ap.removeChild(this)
}});
ae.enter().append("text").attr("class",function(ar,aq,ap){return"datum-"+aq+" series-"+ap
}).call(ao.attributes,ao).call(ag);
var al=ae.call(ao.attributes,ao).call(ao._removeRegisteredEvents,ao).call(ao._addRegisteredEvents,ao);
if(dv.ANIMATION){al=al.transition().delay(function(ar,aq,ap){return ao.delay().call(this,ar,aq,ap)
}).duration(function(ar,aq,ap){return ao.duration().call(this,ar,aq,ap)
}).ease(ao.ease())
}al.call(aj).call(ao.addEachFunction,ao)
};
ad.exitSeriesGroup=function(af,ae){ae.exitSeries(af,ae.enterPen,ae)
};
ad.exitSeries=function(ag,ae,af){ag.selectAll("."+af._dataPointStyleClass).transition().delay(function(aj,ai,ah){return af.delay().call(this,aj,ai,ah)
}).duration(function(aj,ai,ah){return af.duration().call(this,aj,ai,ah)
}).ease(af.ease()).call(ae.call(af)).remove().each("end.transition",function(aj,ai){var ah=this.parentNode;
if(ah.parentNode){ah.removeChild(this)
}if(ah&&ah.childNodes&&!ah.childNodes.length){d3.select(ah).remove()
}})
};
ad.attributes=function(af,ae){af.attr("style","").classed(ae._dataPointStyleClass,true).call(ae.applyAttributeValue,ae,"stroke","stroke").call(ae.applyAttributeValue,ae,"fill","fill").call(ae.applyAttributeValue,ae,"opacity","alpha").call(ae.applyAttributeValue,ae,"font-size","size").attr("text-anchor",ae._textAnchor)
};
ad.enterPen=function(){var ag=this,af=this._dx,ah=function(aj,ai){return aj.panel.yScale(aj).reverse()?1:0
},ae;
if(this.position()==="dodge"){ae=function(al,ak,aj){var ai=al.panel.xScale(al);
return ai.mapValueToPercent(ai.mapToProp(al,ak)+ag._dodgeAdjust(al)+af(al,ak,aj),ak)
}
}else{ae=function(al,ak,aj){var ai=al.panel.xScale(al);
return ai.mapValueToPercent(ai.mapToProp(al,ak)+ai.rangeBand()/2+af(al,ak,aj),ak)
}
}return this._decoratePen(ae,ah)
};
ad.pen=function(){var ah=this,ag=this._dx,af=this._dy,ae=function(am,al,ak){var aj=am.panel.xScale(am);
return aj.mapValueToPercent(aj.mapToProp(am,al)+aj.rangeBand()/2+ag(am,al,ak),al)
},ai;
switch(this.position()){case"identity":ai=function(al,ak,aj){var am=al.panel.yScale(al);
return am.mapValueToPercent(am.mapToProp(al,ak)+af(al,ak,aj)+am.rangeBand()/2,ak)
};
break;
case"stack":ai=function(al,ak,aj){var am=al.panel.yScale(al);
return am.mapValueToPercent(am.mapValue(al.y0+al.y,ak)+af(al,ak,aj),ak)
};
break;
case"dodge":ae=function(am,al,ak){var aj=am.panel.xScale(am);
return aj.mapValueToPercent(aj.mapToProp(am,al)+ah._dodgeAdjust(am)+ag(am,al,ak),al)
};
ai=function(al,ak,aj){var am=al.panel.yScale(al);
return am.mapValueToPercent(am.mapToProp(al,ak)+af(al,ak,aj)+am.rangeBand()/2,ak)
};
break;
case"fill":ai=function(al,ak,aj){var am=al.panel.yScale(al);
return(al.y+al.y0)+am.mapValueToPercent(af(al,ak,aj)+dv.util.scaleRange(am)[0],ak)
};
break
}return this._decoratePen(ae,ai)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.xScale(af).mapToProp(af,ae))&&dv.util.isFinite(af.panel.yScale(af).mapToProp(af,ae))
};
ad._decoratePen=function(ae,ai){var ag=this.getScale("label"),af=this;
var ah=this.coord()._text().x(ae).y(ai);
return ah().label(function(al,ak,aj){return af._textFormat.call(this,ag.mapToProp(al,ak),ak,aj)
}).defined(this._defined)
};
return ad
});
dv.geom.line=dv.geom.extend(function(){function ad(){this._super();
this._tension=0.7;
this._interpolate="linear";
this._rendererClass=dv.geom.line
}ad._dataPointStyleClass="line-geom";
ad.tension=function(ae){if(!arguments.length){return this._tension
}this._tension=ae;
return this
};
ad.interpolate=function(ae){if(!arguments.length){return this._interpolate
}this._interpolate=ae;
return this
};
ad._render=function(af){this._super(af);
var ae=this.getScale("size");
if(ae&&ae.to&&!ae.to()){ae.to([2,8])
}};
ad.getValues=function(ae){return[ae.values]
};
ad.exitSeriesGroup=function(af,ae){ae.exitSeries(af,ae.enterPen,ae)
};
ad.attributes=function(af,ae){var ag=ae.getScale("linetype",0);
af.attr("style","").classed(ae._dataPointStyleClass,true).call(ae.applyAttributeValue,ae,"stroke","stroke").call(ae.applyAttributeValue,ae,"opacity","alpha").call(ae.applyAttributeValue,ae,"stroke-width","size").style("stroke-dasharray",function(aj,ai,ah){return ag?dv.util.svg.getDasharray(ag.mapToProp(aj[0],ai,ah)):null
}).style("fill","none")
};
ad.getHighlightColor=function(ag,af){var ae=this.getScale("stroke",0);
return ae?ae.mapToProp(ag,af):"#8CC350"
};
ad.enterPen=function(){var af=this,ae,ag=function(ai,ah){return ai.panel.yScale(ai).reverse()?1:0
};
if(this.position()==="dodge"){ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+af._dodgeAdjust(aj),ai)
}
}else{ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand()/2,ai)
}
}return this._decoratePen(ae,ag)
};
ad.pen=function(){var af=this,ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand()/2,ai)
},ag;
switch(this.position()){case"identity":ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapToProp(ai,ah)+aj.rangeBand()/2,ah)
};
break;
case"stack":ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapValue(ai.y0+ai.y),ah)
};
break;
case"dodge":ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+af._dodgeAdjust(aj),ai)
};
ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapToProp(ai,ah)+aj.rangeBand()/2,ah)
};
break;
case"fill":ag=function(ai,ah){return(ai.y+ai.y0)
};
break
}return this._decoratePen(ae,ag)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.xScale(af).mapToProp(af,ae))&&dv.util.isFinite(af.panel.yScale(af).mapToProp(af,ae))
};
ad._decoratePen=function(ae,ah){var af=this;
var ag=this.coord()._line().x(ae).y(ah).defined(this._defined);
ag.renderer.tension(this.tension()).interpolate(this.interpolate());
return{bounds:function(aj,ai){return ag.getBounds(aj,ai)
},pathTween:function(aj,ai){return af.pathTween(ag,this,aj,ai)
},path:function(aj,ai){return ag.getPath(ag.getBounds(aj,ai))
}}
};
return ad
});
dv.geom.area=dv.geom.extend(function(){function ad(){this._super();
this._tension=0.7;
this._interpolate="linear";
this._rendererClass=dv.geom.area;
this._baseline=0
}ad._dataPointStyleClass="area-geom";
ad._initializeDefaultAes=function(){this._super()
};
ad._trainScales=function(){if(this._baseline!==undefined){var ae=this.getExplicitScales("y")["y"];
for(var ag in ae){var af=ae[ag];
if(af instanceof dv.scale.continuous){af.softLowerLimit(this._baseline)
}}}this._super()
};
ad.tension=function(ae){if(!arguments.length){return this._tension
}this._tension=ae;
return this
};
ad.interpolate=function(ae){if(!arguments.length){return this._interpolate
}this._interpolate=ae;
return this
};
ad.getValues=function(ae){return[ae.values]
};
ad.pathTween=function(at,aq,an,ai,ag){var ah=an,af,ar=aq.__previousBounds__,ap=[],ak,ae=this.enterPen.call(this,ag),am,aj,al=this.getScale("x").domain(),ao=-1;
af=at.getBounds(an,ai);
af.coord=this.coord();
if(ar&&ar.coord&&(af.coord._type!==ar.coord._type)||af.coord.flip()!=ar.coord.flip()){ar=this.enterPen.call(this,ag).bounds(an,ai)
}ak=Math.max(af.length,ar.length);
while(++ao<ak){am=(ao<af.length)?af[ao]:null;
aj=(ao<ar.length)?ar[ao]:null;
if(!aj){am.x=al[al.length-1];
aj=ae.bounds([am],ai)[0]
}else{if(!am){am=ae.bounds([aj],ai)[0]
}}ap.push(d3.interpolateObject(aj.bounds,am.bounds))
}aq.__previousBounds__=af;
return function(au){if(au===1){ap=ap.splice(0,af.length)
}var av=[];
dv.util.each(ap,function(aw,ay){var ax={};
ax.bounds=aw(au);
av.push(ax)
});
return at.getPath(av)
}
};
ad.exitSeriesGroup=function(af,ae){ae.exitSeries(af,ae.enterPen,ae)
};
ad.attributes=function(af,ae){af.attr("style","").classed(ae._dataPointStyleClass,true).call(ae.applyAttributeValue,ae,"opacity","alpha").call(ae.applyAttributeValue,ae,"fill","fill")
};
ad.getHighlightColor=function(ag,ae){var af=this.getScale("fill");
return af?af.mapToProp(ag,ae):"#8CC350"
};
ad.getBaseline=function(af){var ae=af.domain()[0];
if(self._baseline!==undefined){return self._baseline
}return ae<0?0:ae
};
ad.enterPen=function(){var af=this,ae,ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapValue(af.getBaseline(aj)),ah)
};
if(this.position()==="dodge"){ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+af._dodgeAdjust(aj),ai)
}
}else{ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand()/2,ai)
}
}return this._decoratePen(ae,ag,ag)
};
ad.pen=function(){var ae=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+ai.rangeBand()/2,aj)
},ah,ag,af=this;
switch(this.position()){case"identity":ah=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(af.getBaseline(ak)),ai)
};
ag=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapPropToPercent(aj,ai)
};
break;
case"stack":ah=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(aj.y0),ai)
};
ag=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(aj.y0+aj.y),ai)
};
break;
case"dodge":ae=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+af._dodgeAdjust(ak),aj)
};
ah=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(af.getBaseline(ak)),ai)
};
ag=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapPropToPercent(aj,ai)
};
break;
case"fill":ah=function(aj,ai){return aj.y0
};
ag=function(aj,ai){return(aj.y+aj.y0)
};
break
}return this._decoratePen(ae,ah,ag)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.xScale(af).mapToProp(af,ae))&&dv.util.isFinite(af.panel.yScale(af).mapToProp(af))
};
ad._decoratePen=function(ae,ai,ah){var af=this;
var ag=this.coord()._area().x(ae).y0(ai).y1(ah).defined(this._defined);
ag.renderer.tension(this.tension()).interpolate(this.interpolate());
return{bounds:function(al,aj){var ak=ag.getBounds(al,aj);
if(ak){ak.coord=af.coord()
}return ak
},pathTween:function(ak,aj){return af.pathTween(ag,this,ak,aj)
},path:function(ak,aj){return ag.getPath(ag.getBounds(ak,aj))
}}
};
ad.baseline=function(ae){if(!arguments.length){return this._baseline
}this._baseline=ae;
return this
};
return ad
});
dv.geom.rect=dv.geom.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.rect
}ad._dataPointStyleClass="bar-geom";
ad._initializeDefaultAes=function(){this._super();
this._defaultAes.yMin=1;
this._defaultAes.yMax=1;
this._defaultAes.xMin=1;
this._defaultAes.xMax=1;
delete this._defaultAes.x;
delete this._defaultAes.y
};
ad._trainScales=function(){var af=this.getExplicitScales(["yMin","xMin"]),ah=af.yMin,aj=af.xMin,ai;
for(ai in ah){var ag=this._aes.y;
if(!ag){this._aes.y=ag={}
}if(!ag[ai]){ag[ai]=ah[ai].copy().property("y").mapping("y")
}ag[ai].trainingProperties(["yMin","yMax"])
}for(ai in aj){var ae=this._aes.x;
if(!ae){this._aes.x=ae={}
}if(!ae[ai]){ae[ai]=aj[ai].copy().property("x").mapping("x")
}ae[ai].trainingProperties(["xMin","xMax"])
}};
ad.getValues=function(ae){return ae.values
};
ad._render=function(aj){var ak=this.getExplicitScales(["yMin","yMax","y","xMin","xMax","x"]),ah;
for(ah in ak.yMin){var ag=ak.yMin[ah],ae=ak.yMax[ah],af=ak.y[ah];
if(af){ae.range(af.range()).domain(af.domain());
ag.range(af.range()).domain(af.domain())
}}for(ah in ak.xMin){var am=ak.xMin[ah],ai=ak.xMax[ah],al=ak.x[ah];
if(al){ai.range(al.range()).domain(al.domain());
am.range(al.range()).domain(al.domain())
}}this._super(aj)
};
ad.pathTween=function(an,al,ak,ah,af){var ag=ak,ae,am=al.__previousBounds__,aj=this.coord()._type;
if(al.__exiting__){ae=al.__exitTransition__.bounds(ak,ah)
}else{ae=an.getBounds(ak,ah)
}if((am&&am.coord&&aj!==am.coord)){am=al.__exitTransition__.bounds(ak,ah)
}if(!ae||!am){return null
}ae.coord=aj;
var ai=d3.interpolateObject(am.bounds,ae.bounds);
al.__previousBounds__=ae;
return function(ao){ag.bounds=ai(ao);
return an.getPath(ag)
}
};
ad.attributes=function(af,ae){af.attr("style","").classed(ae._dataPointStyleClass,true).call(ae.applyAttributeValue,ae,"fill","fill").call(ae.applyAttributeValue,ae,"stroke","stroke").call(ae.applyAttributeValue,ae,"opacity","alpha")
};
ad.enterPen=function(){var ag=function(ai,ah){return ai.panel.yScale(ai).reverse()?1:0
},af=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapValue(dv.util.isArray(aj.x)?aj.x[0]:aj.xMin,ai))
},ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapValue(dv.util.isArray(aj.x)?aj.x[1]:aj.xMax,ai))
};
return this._decoratePen(af,ae,ag,ag)
};
ad.pen=function(){var af=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapValue(dv.util.isArray(ak.x)?ak.x[0]:ak.xMin,aj))
},ae=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapValue(dv.util.isArray(ak.x)?ak.x[1]:ak.xMax,aj))
},ah=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(dv.util.isArray(aj.y)?aj.y[0]:aj.yMin,ai))
},ag=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(dv.util.isArray(aj.y)?aj.y[1]:aj.yMax,ai))
};
return this._decoratePen(af,ae,ah,ag)
};
ad._defined=function(ag,af){var ae=ag.panel.xScale(ag),ah=ag.panel.yScale(ag);
return dv.util.isFinite(ae.mapValue(dv.util.isArray(ag.x)?ag.x[0]:ag.xMin,af))&&dv.util.isFinite(ae.mapValue(dv.util.isArray(ag.x)?ag.x[1]:ag.xMax,af))&&dv.util.isFinite(ah.mapValue(dv.util.isArray(ag.y)?ag.y[0]:ag.yMin,af))&&dv.util.isFinite(ah.mapValue(dv.util.isArray(ag.y)?ag.y[1]:ag.yMax,af))
};
ad._decoratePen=function(ah,ag,aj,ai){var ae=this;
var af=this.coord()._rect().x0(ah).x1(ag).y0(aj).y1(ai).defined(this._defined);
return{bounds:function(am,ak){var al=af.getBounds(am,ak);
if(al){al.bounds.coord=ae.coord()._type
}return al
},pathTween:function(am,al,ak){return ae.pathTween(af,this,am,al,ak)
},path:function(al,ak){return af.getPath(af.getBounds(al,ak))
}}
};
return ad
});
dv.geom.tile=dv.geom.rect.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.tile
}ad._dataPointStyleClass="tile-geom";
ad._initializeDefaultAes=function(){this._super();
this._defaultAes.y=1;
this._defaultAes.x=1
};
ad.getValues=function(ae){return ae.values
};
ad.enterPen=function(){var ag=function(ai,ah){return ai.panel.yScale(ai).reverse()?1:0
},af=function(ai,ah){return ai.panel.xScale(ai).mapPropToPercent(ai,ah)
},ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand(),ai)
};
return this._decoratePen(af,ae,ag,ag)
};
ad.pen=function(){var af=function(aj,ai){return aj.panel.xScale(aj).mapPropToPercent(aj,ai)
},ae=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+ai.rangeBand(),aj)
},ah=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapPropToPercent(aj,ai)
},ag=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapToProp(aj,ai)+ak.rangeBand(),ai)
};
return this._decoratePen(af,ae,ah,ag)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.xScale(af).mapToProp(af,ae))&&dv.util.isFinite(af.panel.yScale(af).mapToProp(af,ae))
};
ad._decoratePen=function(ah,ag,aj,ai){var ae=this;
var af=this.coord()._rect().x0(ah).x1(ag).y0(aj).y1(ai).defined(this._defined);
return{bounds:function(am,ak){var al=af.getBounds(am,ak);
if(al){al.bounds.coord=ae.coord()._type
}return al
},pathTween:function(am,al,ak){return ae.pathTween(af,this,am,al,ak)
},path:function(al,ak){return af.getPath(af.getBounds(al,ak))
}}
};
return ad
});
dv.geom.bar=dv.geom.rect.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.bar;
this._baseline=0
}ad._dataPointStyleClass="bar-geom";
ad._initializeDefaultAes=function(){this._super();
this._defaultAes.y=1;
this._defaultAes.x=1
};
ad._trainScales=function(){if(this._baseline!==undefined){var ae=this.getExplicitScales("y")["y"];
for(var ag in ae){var af=ae[ag];
if(af instanceof dv.scale.continuous){af.softLowerLimit(this._baseline)
}}}};
ad.getValues=function(ae){return ae.values
};
ad.getBaseline=function(af){var ae=af.domain()[0];
if(self._baseline!==undefined){return self._baseline
}return ae<0?0:ae
};
ad.enterPen=function(){var ae=this,ah=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(ae.getBaseline(ak)),ai)
},ag,af;
if(this.position()==="dodge"){ag=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+ae._dodgeAdjust(ak),aj)
};
af=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+ae._dodgeAdjust(ak,true),aj)
}
}else{ag=function(aj,ai){return aj.panel.xScale(aj).mapPropToPercent(aj,ai)
};
af=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+ai.rangeBand(),aj)
}
}return this._decoratePen(ag,af,ah,ah)
};
ad.pen=function(){var ag,af,ai,ah,ae=this;
switch(this.position()){case"identity":ag=function(ak,aj){return ak.panel.xScale(ak).mapPropToPercent(ak,aj)
};
af=function(al,ak){var aj=al.panel.xScale(al);
return aj.mapValueToPercent(aj.mapToProp(al,ak)+aj.rangeBand(),ak)
};
ai=function(ak,aj){var al=ak.panel.yScale(ak);
return al.mapValueToPercent(al.mapValue(ae.getBaseline(al)),aj)
};
ah=function(ak,aj){return ak.panel.yScale(ak).mapPropToPercent(ak,aj)
};
break;
case"stack":ag=function(ak,aj){return ak.panel.xScale(ak).mapPropToPercent(ak,aj)
};
af=function(al,ak){var aj=al.panel.xScale(al);
return aj.mapValueToPercent(aj.mapToProp(al,ak)+aj.rangeBand(),ak)
};
ai=function(ak,aj){var al=ak.panel.yScale(ak);
return al.mapValueToPercent(al.mapValue(ak.y0),aj)
};
ah=function(ak,aj){var al=ak.panel.yScale(ak);
return al.mapValueToPercent(al.mapValue(ak.y0+ak.y),aj)
};
break;
case"dodge":ag=function(al,ak){var aj=al.panel.xScale(al);
return aj.mapValueToPercent(aj.mapToProp(al,ak)+ae._dodgeAdjust(al),ak)
};
af=function(al,ak){var aj=al.panel.xScale(al);
return aj.mapValueToPercent(aj.mapToProp(al,ak)+ae._dodgeAdjust(al,true),ak)
};
ai=function(ak,aj){var al=ak.panel.yScale(ak);
return al.mapValueToPercent(al.mapValue(ae.getBaseline(al)),aj)
};
ah=function(ak,aj){return ak.panel.yScale(ak).mapPropToPercent(ak,aj)
};
break;
case"fill":ag=function(ak,aj){return ak.panel.xScale(ak).mapPropToPercent(ak,aj)
};
af=function(al,ak){var aj=al.panel.xScale(al);
return aj.mapValueToPercent(aj.mapToProp(al,ak)+aj.rangeBand(),ak)
};
ai=function(ak,aj){return ak.y0
};
ah=function(ak,aj){return(ak.y+ak.y0)
};
break
}return this._decoratePen(ag,af,ai,ah)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.xScale(af).mapToProp(af,ae))&&dv.util.isFinite(af.panel.yScale(af).mapToProp(af,ae))
};
ad._decoratePen=function(ah,ag,aj,ai){var ae=this;
var af=this.coord()._rect().x0(ah).x1(ag).y0(aj).y1(ai).defined(this._defined);
return{bounds:function(am,ak){var al=af.getBounds(am,ak);
if(al){al.bounds.coord=ae.coord()._type
}return al
},pathTween:function(am,al,ak){return ae.pathTween(af,this,am,al,ak)
},path:function(al,ak){return af.getPath(af.getBounds(al,ak))
}}
};
ad._dodgeAdjust=function(ak,aj){var ae=ak.dodge.groupIndex,ah=ak.dodge.numGroups,af=ak.panel.xScale(ak).rangeBand(),ag=(ah>1)?af/(ah-1)*this._dodgePadding:0,ai=(af-(ag*(ah-1)))/ah;
return(ai+ag)*ae+(aj?ai:0)
};
ad.baseline=function(ae){if(!arguments.length){return this._baseline
}this._baseline=ae;
return this
};
return ad
});
dv.geom.barrange=dv.geom.bar.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.barrange
}ad._initializeDefaultAes=function(){this._super();
this._defaultAes.yMin=1;
this._defaultAes.yMax=1;
delete this._defaultAes.y
};
ad._trainScales=function(){var ae=this.getExplicitScales("yMin")["yMin"],ah,ag;
for(var af in ae){if(!this._aes.y){this._aes.y={}
}ah=this._aes.y;
ag=ah[af];
if(!ag){ah[af]=ag=ae[af].copy().property("y").mapping("y")
}ag.trainingProperties(["yMin","yMax"])
}};
ad._render=function(af){var ae=this.getExplicitScales(["yMin","yMax","y"]),ai=ae.yMin;
for(var ak in ai){var ag=ai[ak],ah=ae.yMax[ak],aj=ae.y[ak];
ah.range(aj.range()).domain(aj.domain());
ag.range(aj.range()).domain(aj.domain())
}this._super(af)
};
ad.enterPen=function(){var ag=function(ai,ah){return ai.panel.yScale(ai).reverse()?1:0
},af=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapPropToPercent(aj,ai)
},ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand(),ai)
};
return this._decoratePen(af,ae,ag,ag)
};
ad.pen=function(){var af=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapPropToPercent(ak,aj)
},ae=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+ai.rangeBand(),aj)
},ah=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(aj.yMin,ai),ai)
},ag=function(aj,ai){var ak=aj.panel.yScale(aj);
return ak.mapValueToPercent(ak.mapValue(aj.yMax,ai),ai)
};
return this._decoratePen(af,ae,ah,ag)
};
ad._defined=function(ag,af){var ae=ag.panel.xScale(ag),ah=ag.panel.yScale(ag);
return dv.util.isFinite(ae.mapToProp(ag,af))&&dv.util.isFinite(ah.mapValue(ag.yMin,af))&&dv.util.isFinite(ah.mapValue(ag.yMax,af))
};
ad._decoratePen=function(ah,ag,aj,ai){var ae=this;
var af=this.coord()._rect().x0(ah).x1(ag).y0(aj).y1(ai).defined(this._defined);
return{bounds:function(am,ak){var al=af.getBounds(am,ak);
if(al){al.bounds.coord=ae.coord()._type
}return al
},pathTween:function(am,al,ak){return ae.pathTween(af,this,am,al,ak)
},path:function(al,ak){return af.getPath(af.getBounds(al,ak))
}}
};
return ad
});
dv.geom.segment=dv.geom.line.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.segment
}ad.getValues=function(ae){return ae.values
};
ad.enterPen=function(){var ae=function(ai,ah){var ag=ai.panel.xScale(ai);
return ag.mapValueToPercent(ag.mapToProp(ai,ah)+ag.rangeBand()/2,ah)
},af=function(ah,ag){return ah.panel.yScale(ah).reverse()?1:0
};
return this._decoratePen(ae,af)
};
ad.pen=function(){var ae=function(ai,ah){var ag=ai.panel.xScale(ai);
return ag.mapValueToPercent(ag.mapToProp(ai,ah)+ag.rangeBand()/2,ah)
},af=function(ah,ag){return ah.panel.yScale(ah).mapPropToPercent(ah,ag)
};
return this._decoratePen(ae,af)
};
return ad
});
dv.geom.vline=dv.geom.segment.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.vline
}ad._dataPointStyleClass="vline-geom";
ad._render=function(af){var ae=this;
dv.util.each(this._nestData,function(ai,ah){var ag=[];
dv.util.each(ai.values,function(ap,al){var ao=ap.panel.xScale(ap),an=ap.panel.yScale(ap),am=an.domain(),aj=ap[ao.property()];
if(dv.util.isArray(ap)){ap[0].x=aj;
ap[1].x=aj
}else{var ak=[];
ap.x=aj;
ak.push(ap);
ak.push(dv.util.clone(ap));
ag.push(ak)
}});
ae._nestData[ah].values=ag
});
this._super(af)
};
ad.enterPen=function(){var ae=function(ai,ah){var ag=ai.panel.xScale(ai);
return ag.mapValueToPercent(ag.mapToProp(ai,ah)+ag.rangeBand()/2,ah)
},af=function(ah,ag){return 0
};
return this._decoratePen(ae,af)
};
ad.pen=function(){var ae=function(ai,ah){var ag=ai.panel.xScale(ai);
return ag.mapValueToPercent(ag.mapToProp(ai,ah)+ag.rangeBand()/2,ah)
},af=function(ah,ag){return ag===0?0:1
};
return this._decoratePen(ae,af)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.xScale(af).mapToProp(af,ae))
};
return ad
});
dv.geom.hline=dv.geom.segment.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.hline
}ad._dataPointStyleClass="hline-geom";
ad._render=function(af){var ae=this;
dv.util.each(this._nestData,function(ai,ah){var ag=[];
dv.util.each(ai.values,function(ao,al){var an=ao.panel.xScale(ao),am=ao.panel.yScale(ao),ak=an.domain(),ap=ao[am.property()];
if(dv.util.isArray(ao)){ao[0].y=ap;
ao[1].y=ap
}else{var aj=[];
ao.y=ap;
aj.push(ao);
aj.push(dv.util.clone(ao));
ag.push(aj)
}});
ae._nestData[ah].values=ag
});
this._super(af)
};
ad.enterPen=function(){var ae=function(ah,ag){return ag===0?0:1
},af=function(ah,ag){return ah.panel.yScale(ah).reverse()?1:0
};
return this._decoratePen(ae,af)
};
ad.pen=function(){var ae=function(ah,ag){return ag===0?0:1
},af=function(ah,ag){return ah.panel.yScale(ah).mapPropToPercent(ah,ag)
};
return this._decoratePen(ae,af)
};
ad._defined=function(af,ae){return dv.util.isFinite(af.panel.yScale(af).mapToProp(af,ae))
};
return ad
});
dv.geom.ribbon=dv.geom.area.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.ribbon
}ad._initializeDefaultAes=function(){this._super();
this._defaultAes.yMin=1;
this._defaultAes.yMax=1;
delete this._defaultAes.y
};
ad._trainScales=function(){var ae=this.getExplicitScales("yMin")["yMin"],ah,ag;
for(var af in ae){if(!this._aes.y){this._aes.y={}
}ah=this._aes.y;
ag=ah[af];
if(!ag){ah[af]=ag=ae[af].copy().property("y").mapping("y")
}ag.trainingProperties(["yMin","yMax"])
}};
ad._render=function(af){var ae=this.getExplicitScales(["yMin","yMax","y"]),ai=ae.yMin;
for(var ak in ai){var ag=ai[ak],ah=ae.yMax[ak],aj=ae.y[ak];
ah.range(aj.range()).domain(aj.domain());
ag.range(aj.range()).domain(aj.domain())
}this._super(af)
};
ad.enterPen=function(){var af=this,ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand()/2,ai)
},ag=function(ai,ah){return ai.panel.yScale(ai).reverse()?1:0
};
return this._decoratePen(ae,ag,ag)
};
ad.pen=function(){var ae=function(aj,ai){var ah=aj.panel.xScale(aj);
return ah.mapValueToPercent(ah.mapToProp(aj,ai)+ah.rangeBand()/2,ai)
},ag=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapValue(ai.yMin,ah))
},af=function(ai,ah){var aj=ai.panel.yScale(ai);
return aj.mapValueToPercent(aj.mapValue(ai.yMax,ah))
};
return this._decoratePen(ae,ag,af)
};
ad._defined=function(ag,af){var ae=ag.panel.xScale(ag),ah=ag.panel.yScale(ag);
return dv.util.isFinite(ae.mapToProp(ag,af))&&dv.util.isFinite(ah.mapValue(ag.yMin,af))&&dv.util.isFinite(ah.mapValue(ag.yMax,af))
};
ad._decoratePen=function(ae,ai,ah){var af=this;
var ag=this.coord()._area().x(ae).y0(ai).y1(ah).defined(this._defined);
ag.renderer.tension(this.tension()).interpolate(this.interpolate());
return{bounds:function(al,aj){var ak=ag.getBounds(al,aj);
if(ak){ak.coord=af.coord()
}return ak
},pathTween:function(ak,aj){return af.pathTween(ag,this,ak,aj)
},path:function(ak,aj){return ag.getPath(ag.getBounds(ak,aj))
}}
};
return ad
});
dv.geom.errorbar=dv.geom.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.errorbar;
this._width=1
}ad._dataPointStyleClass="errorbar-geom";
ad._initializeDefaultAes=function(){this._super();
this._defaultAes.yMin=1;
this._defaultAes.yMax=1;
delete this._defaultAes.y
};
ad._trainScales=function(){var ae=this.getExplicitScales("yMin")["yMin"],ag;
for(var af in ae){if(!this._aes.y){this._aes.y={}
}yScales=this._aes.y;
ag=yScales[af];
if(!ag){yScales[af]=ag=ae[af].copy().property("y").mapping("y")
}ag.trainingProperties(["yMin","yMax"])
}};
ad.getValues=function(ae){return ae.values
};
ad.width=function(ae){if(!arguments.length){return this._width
}this._width=ae;
return this
};
ad.attributes=function(af,ae){var ag=ae.getScale("linetype");
af.attr("style","").classed(ae._dataPointStyleClass,true).call(ae.applyAttributeValue,ae,"stroke","stroke").call(ae.applyAttributeValue,ae,"opacity","alpha").call(ae.applyAttributeValue,ae,"stroke-width","size").style("stroke-dasharray",function(aj,ai,ah){return ag?dv.util.svg.getDasharray(ag.mapToProp(aj[0],ai,ah)):null
}).style("fill","none")
};
ad._render=function(ak){var an=this.getScale("x");
if(!(an instanceof dv.scale.ordinal)){var af=Number.MAX_VALUE,am,ah;
dv.util.each(this._nestData,function(ao){dv.util.each(ao.values,function(ap){am=ap.panel.xScale(ap).mapValue(ap.x);
if(!dv.util.isUndefined(ah)){af=Math.min(af,Math.abs(am-ah))
}ah=am
})
});
this._maxWidthPixels=af
}var al=this.getExplicitScales(["yMin","yMax","y"]),aj=al.yMin;
for(var ai in aj){var ag=aj[ai],ae=al.yMax[ai];
yScale=al.y[ai];
ae.range(yScale.range()).domain(yScale.domain());
ag.range(yScale.range()).domain(yScale.domain())
}this._super(ak)
};
ad.enterPen=function(){var ae=this,ag=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)-(ae._isOrdinal(ak)?0:ae._rangeBand(ak)/2),aj)
},af=function(ak,aj){var ai=ak.panel.xScale(ak);
return ai.mapValueToPercent(ai.mapToProp(ak,aj)+(ae._isOrdinal(ak)?ae._rangeBand(ak):ae._rangeBand(ak)/2),aj)
},ah=function(aj,ai){return aj.panel.yScale(aj).reverse()?1:0
};
return this._decoratePen(ag,af,ah,ah)
};
ad.pen=function(){var ae=this,ag=function(al,ak){var aj=al.panel.xScale(al);
return aj.mapValueToPercent(aj.mapToProp(al,ak)-(ae._isOrdinal(al)?0:ae._rangeBand(al)/2),ak)
},af=function(al,ak){var aj=al.panel.xScale(al);
return aj.mapValueToPercent(aj.mapToProp(al,ak)+(ae._isOrdinal(al)?ae._rangeBand(al):ae._rangeBand(al)/2),ak)
},ai=function(ak,aj){var al=ak.panel.yScale(ak);
return al.mapValueToPercent(al.mapValue(ak.yMin,aj))
},ah=function(ak,aj){var al=ak.panel.yScale(ak);
return al.mapValueToPercent(al.mapValue(ak.yMax,aj))
};
return this._decoratePen(ag,af,ai,ah)
};
ad._isOrdinal=function(ae){return ae.panel.xScale(ae) instanceof dv.scale.ordinal
};
ad._rangeBand=function(af){var ae=af.panel.xScale(af);
return(ae instanceof dv.scale.ordinal)?ae.range():this._maxWidthPixels*this._width
};
ad._defined=function(ag,af){var ae=ag.panel.xScale(ag),ah=ag.panel.yScale(ag);
return dv.util.isFinite(ae.mapToProp(ag,af))&&dv.util.isFinite(ah.mapValue(ag.yMin,af))&&dv.util.isFinite(ah.mapValue(ag.yMax,af))
};
ad._decoratePen=function(ah,ag,aj,ai){var ae=this;
var af=this.coord()._errorBar().x0(ah).x1(ag).y0(aj).y1(ai).defined(this._defined);
return{bounds:function(al,ak){return af.getBounds(al,ak)
},pathTween:function(al,ak){return ae.pathTween(af,this,al,ak)
},path:function(al,ak){return af.getPath(af.getBounds(al,ak))
}}
};
return ad
});
dv.geom.poly=dv.geom.extend(function(){function ad(){this._super();
this._rendererClass=dv.geom.poly
}ad._dataPointStyleClass="poly-geom";
ad._initializeDefaultAes=function(){this._super();
this._defaultAes.size=1;
delete this._defaultAes.shape;
delete this._defaultAes.x;
delete this._defaultAes.y
};
ad._trainScales=function(){var af=this.getExplicitScales(["yMin","xMin"]),ah;
for(ah in af.yMin){var ag=this._aes.y;
if(!ag){this._aes.y=ag={}
}if(!ag[ah]){ag[ah]=yMinScale.copy().property("y").mapping("y")
}ag[ah].trainingProperties(["yMin","yMax"])
}for(ah in af.xMin){var ae=this._aes.x;
if(!ae){this._aes.x=ae={}
}if(!ae[ah]){ae[ah]=xMinScale.copy().property("x").mapping("x")
}ae[ah].trainingProperties(["xMin","xMax"])
}};
ad.getValues=function(ae){return ae.values
};
ad.attributes=function(ah,af){var ai=af.getScale("fill"),ag=af.getScale("stroke"),ae=af.getScale("alpha");
ah.attr("style","").classed(af._dataPointStyleClass,true).call(af.applyAttributeValue,af,"stroke","stroke").call(af.applyAttributeValue,af,"fill","fill").call(af.applyAttributeValue,af,"opacity","alpha")
};
ad.exitSeriesGroup=function(af,ae){ae.exitSeries(af,ae.enterPen,ae)
};
ad.getHighlightColor=function(ah,af){var ag=this.getScale("fill"),ae=this.getScale("stroke");
if(!(ae instanceof dv.scale.constant)){return ae.mapToProp(ah,af)
}if(!(ag instanceof dv.scale.constant)){return ag.mapToProp(ah,af)
}return ae.mapToProp(ah,af)
};
ad.enterPen=function(){var ae=function(ah,ag){return ah.panel.xScale(ah).mapPropToPercent(ah,ag)
},af=function(ah,ag){var ai=ah.panel.yScale(ah);
return dv.util.map(ah[ai.property()],function(){return ai.reverse()?1:0
})
};
return this._decoratePen(ae,af)
};
ad.pen=function(){var ae=function(ah,ag){return ah.panel.xScale(ah).mapPropToPercent(ah,ag)
},af=function(ah,ag){return ah.panel.yScale(ah).mapPropToPercent(ah,ag)
};
return this._decoratePen(ae,af)
};
ad._defined=function(ak,ah){var ag=ak.panel.xScale(ak).mapToProp(ak,ah),ai=ak.panel.yScale(ak).mapToProp(ak,ah),ae=d3.max([ag.length,ai.length]),aj=true;
for(var af=0;
af<ae&&aj;
af++){aj=dv.util.isFinite(ag[af])&&dv.util.isFinite(ai[af])
}return aj
};
ad._decoratePen=function(ae,ah){var af=this;
var ag=this.coord()._poly().xs(ae).ys(ah).defined(this._defined);
return{bounds:function(aj,ai){return ag.getBounds(aj,ai)
},pathTween:function(ak,aj,ai){return af.pathTween(ag,this,ak,aj,ai)
},path:function(aj,ai){return ag.getPath(ag.getBounds(aj,ai))
}}
};
return ad
});
dv.behavior=dv.extend(function(){function ae(){}var ad;
ae._testAndroidChromeBug141840=function(){if(ad===undefined){var af=navigator.userAgent;
ad=/Android .* Chrome\/18+/.exec(af)!==null||/Silk\/2./.exec(af)!==null
}return ad
};
return ae
});
dv.behavior.inspector=dv.behavior.extend(function(){function aj(){this._size=undefined;
this._lastX=NaN;
this._visible=false;
this._inspector=null;
this._thickness=3;
this._orientation="bottom";
this._currentValue=null;
this._gutterPadding=-7;
this._calloutPadding={left:8,top:7,right:8,bottom:7};
this._label=this._defaultLabel();
this._underGeoms=false;
this._dragInspect=true;
this._pressTimer=null
}aj._render=function(al){this._domain=ag.call(this);
var an=0,am=this._chart.facet().getPanel(0)._bounds;
if(this._size===undefined){this._size=am.bottom-am.top
}this._xGuide=dv.util.clone(this._chart._axes._get("x")[0]);
this._selection=al;
this._inspector=al.selectAll(".inspector").data([0]);
this._inspector.call(this._createInspector,this._orientation,am,this._calloutPadding,this._thickness)
};
aj._createInspector=function(au,an,am,ap,ar){var av=au,al=au.enter();
al=al.append("g").classed("inspector",true);
av.style("pointer-events","none").attr("opacity",0.000001).attr("transform","translate(0,"+am.top+")");
var aq=al.append("g").classed("inspector-marker",true);
var ao=aq.append("g").classed("inspector-line-container",true);
ao.append("path").classed("inspector-callout",true);
av.select(".inspector-callout").attr("d",function(){var ax=-3,aw=ax+5;
if(an==="bottom"){ax=am.bottom-am.top+2;
aw=ax-5
}return"M-5,"+ax+"L5,"+ax+"L0,"+aw+"Z"
});
ao.append("line").classed("inspector-line",true);
av.select(".inspector-line").attr("y1",an==="bottom"?0:4).attr("y2",an==="bottom"?am.bottom-am.top-6:am.bottom-am.top).style("stroke-width",ar);
var at=aq.append("g").classed("inspector-tip",true);
av.select(".inspector-tip").attr("transform","translate(0,"+(an==="bottom"?am.bottom-am.top+2:-30)+")");
at.append("rect").classed("inspector-tip-background",true);
at.append("text").classed("inspector-tip-label",true);
av.select(".inspector-tip-label").attr("x",ap.left).attr("y","1em").attr("dy",ap.top)
};
aj.moveToIndex=function(am){var ao=this._chart.getTrainedScale("x"),an=this._domain[am],al=this._label.call(this,an,am),ap=ao.mapValue(an);
ae.call(this,an,al,ap)
};
aj.hide=function(){this._inspector.attr("opacity",0.000001);
this._visible=false;
return this
};
aj.show=function(){this._inspector.attr("opacity",1);
this._visible=true;
return this
};
aj._removeEvents=function(){this._chart.on("mousemove.inspector",null);
this._chart.on("mouseout.inspector",null);
this._chart.on("touchstart.inspector",null);
this._chart.on("touchmove.inspector",null);
this._chart.on("touchend.inspector",null)
};
aj.inspectorMove=function(al){if(!arguments.length){return this._inspectorMove
}this._inspectorMove=al;
return this
};
aj.inspectorOut=function(al){if(!arguments.length){return this._inspectorOut
}this._inspectorOut=al;
return this
};
aj.label=function(al){if(!arguments.length){return this._label
}this._label=d3.functor(al);
return this
};
aj.thickness=function(al){if(!arguments.length){return this._thickness
}this._thickness=al;
return this
};
aj.size=function(al){if(!arguments.length){return this._size
}this._size=al;
return this
};
aj.chart=function(al){if(!arguments.length){return this._chart
}if(this._chart){this._removeEvents()
}this._chart=al;
if(this._chart){af.call(this)
}return this
};
aj.orientation=function(al){if(!arguments.length){return this._orientation
}this._orientation=al;
return this
};
function ag(){var al=[],ap=this._chart.getTrainedScale("x"),av,au=false,ao=function(az,ay){return au&&az&&ay?az.getTime()===ay.getTime():az===ay
},ax=function(ay){return ap.mapValue(ay)
},aq=this._chart.data(),ar=-1,an=this._chart._layers.length;
if(aq.length){al.concat(aq[ap.property()])
}while(++ar<an){var aw=this._chart._layers[ar],am=aw.getTrainedScale("x"),at=aw.data()[am.property()];
if(at&&at!==aq){al=al.concat(at)
}au=au||(am instanceof dv.scale.time||am instanceof dv.scale.time.utc)
}return al.length?dv.util.sortBy(dv.util.uniqueValues(al,ao),ax):al
}function af(){this._chart.on("mousemove.inspector",dv.util.bind(ah,this));
this._chart.on("mouseout.inspector",dv.util.bind(ai,this));
this._chart.on("touchstart.inspector",dv.util.bind(ak,this));
this._chart.on("touchmove.inspector",dv.util.bind(ah,this));
this._chart.on("touchend.inspector",dv.util.bind(ad,this))
}aj._defaultLabel=function(){var al=this;
return function(an){var am=(al._xGuide.tickFormat)?al._xGuide.tickFormat():function(ao){return ao
};
return am(an)
}
};
aj.label=function(al){if(!arguments.length){return this._label
}this._label=d3.functor(al);
return this
};
aj.underGeoms=function(al){if(!arguments.length){return this._underGeoms
}this._underGeoms=al;
return this
};
aj.gutterPadding=function(al){if(!arguments.length){return this._gutterPadding
}this._gutterPadding=al;
return this
};
function ae(ap,an,ar){var aq=0,am=0;
if(this._lastX===ar){return
}this._inspector.attr("opacity",1);
this._inspector.select(".inspector-tip-label").text(an).each(function(){var au=this.getBBox();
aq=Math.max(au.width,aq);
am=Math.max(au.height,am)
});
var at=this._chart.facet().getPanel(0).bounds(),ao;
aq+=this._calloutPadding.left+this._calloutPadding.right;
am+=this._calloutPadding.top+this._calloutPadding.bottom;
ao=ar-aq/2;
if(ao<at.left+this._gutterPadding){ao=at.left+this._gutterPadding
}if(ao+aq>at.right-this._gutterPadding){ao=at.right-this._gutterPadding-aq
}this._inspector.select(".inspector-marker").attr("transform","translate("+ao+",0)");
this._inspector.select(".inspector-tip-background").attr("width",aq).attr("height",am);
var al=ar-ao;
this._inspector.select(".inspector-line-container").attr("transform","translate("+al+",0)")
}function ak(am){if(!am){return
}var al=this;
this._dragInspect=false;
clearTimeout(this._pressTimer);
this._pressTimer=setTimeout(function(){al._dragInspect=true;
ah.call(al,am)
},500);
return false
}function ad(al){clearTimeout(this._pressTimer);
if(this._dragInspect){this._dragInspect=false
}ai.call(this,al)
}function ah(aq){if(!aq){return
}if(!this._dragInspect){clearTimeout(this._pressTimer);
return
}var ap=aq.touches?aq.touches[0]:aq;
var av=this._chart.getTrainedScale("x"),am=this._testAndroidChromeBug141840()?ap.screenX:ap.clientX,al=am-ap.target.getBoundingClientRect().left+ap.target.getBBox().x,ao=dv.util.binaryCompare(this._domain,al,function(aw){return av.mapValue(aw)
}),at=Math.min(Math.max(ao||0,0),this._domain.length-1),au=this._domain[at],ar=this._label.call(this,au,at),an=av.mapValue(au);
if(this._currentValue!=au){if(this._inspectorMove){this._inspectorMove.call(this,ar,at,an,au)
}ae.call(this,au,ar,an)
}this._currentValue=au;
dv.cancelEvent(aq)
}function ai(al){this._inspector.attr("opacity",0.000001);
if(this._inspectorOut){this._inspectorOut.call(this)
}this._currentValue=null;
dv.cancelEvent(al)
}return aj
});
dv.behavior.brush=dv.behavior.extend(function(){function ad(ae){if(arguments.length&&!dv.util.isArray(ae)){this._dimensions=[this._dimensions]
}this._fluidDimensions=ae||["x","y"];
this._snap=false;
this._resizing=false
}ad.initializeBrush=function(af){var ae=this;
this._brush=dv.brush(af).on("brushstart.brush",function(){ae._onBrushStart.call(ae);
if(ae._brushStart){ae._brushStart.call(this,"start",ae._brush.extent(),ae)
}}).on("brush.brush",function(ag){ae._onBrushMove.call(ae);
if(ae._brushMove){ae._brushMove.call(this,"move",ae._brush.extent(),ae)
}}).on("brushend.brush",function(){ae._onBrushEnd.call(ae);
if(ae._brushEnd){ae._brushEnd.call(this,"end",ae._brush.extent(),ae)
}})
};
ad._removeEvents=function(){this._brush.on("brushstart.brush",null).on("brush.brush",null).on("brushend.brush",null)
};
ad._onBrushStart=function(){if(!this.snap()||this._fluidDimensions.length>1){return
}this._startPos=d3.mouse(this._brushContainer.node());
this._moving=d3.select(d3.event.sourceEvent.target).classed("extent")
};
ad._onBrushMove=function(){if(!this.snap()||this._fluidDimensions.length>1){return
}var ae=d3.mouse(this._brushContainer.node());
if(this._startPos[0]!==ae[0]||this._startPos[1]!==ae[1]){this._snapToDataPoints()
}};
ad._onBrushEnd=function(){if(!this.snap()||this._fluidDimensions.length>1){return
}var ae=d3.mouse(this._brushContainer.node());
if(!this._moving&&this._startPos[0]===ae[0]&&this._startPos[1]===ae[1]){this.clear()
}else{this._brushContainer.selectAll(".resize").style("display",null)
}};
ad._snapToDataPoints=function(){var ai=this._brush.extent(),ae=[],ag=this._chart.getTrainedScale(this._fluidDimensions[0]),af=[this._snapToNearestPoint(ag,ai[0],0),this._snapToNearestPoint(ag,ai[1],1)];
this._brush.extent([af[0].value,af[1].value]);
var ah=this._chart.plotBounds();
if(this._fluidDimensions==="x"){ae[0]=[af[0].rangeValue,0];
ae[1]=[af[1].rangeValue,ah.bottom-ah.top]
}else{ae[0]=[0,af[0].rangeValue];
ae[1]=[ah.right-ah.left,af[1].rangeValue]
}this._adjustBounds(this._brushContainer,ae)
};
ad._snapToNearestPoint=function(af,ap,al){var ag={},am;
if(af instanceof dv.scale.ordinal||af instanceof dv.scale.identity){var ah=dv.util.scaleRangeNoReverse(af);
var an=ah[1]-ah[0];
domain=af.domain();
am=Math.round(af.invertValue(ap)/an-1)
}else{domain=dv.util.uniq(this._chart.data()[af.mapping()]);
index=dv.util.binaryCompare(domain,ap,function(aq){return aq
});
am=Math.min(Math.max(index||0,0),domain.length-1)
}var ao=domain[am];
ag.value=ao;
if(al===0){if(am===0){ag.rangeValue=af.mapValue(ao)
}else{var ae=domain[am-1],aj=af.mapValue(ae);
valueRange=af.mapValue(ao);
ag.rangeValue=valueRange-(valueRange-aj)/2
}}else{if(am===domain.length-1){ag.rangeValue=af.mapValue(ao)
}else{var ak=domain[am+1],ai=af.mapValue(ak);
valueRange=af.mapValue(ao);
ag.rangeValue=valueRange+(ai-valueRange)/2
}}return ag
};
ad._adjustBounds=function(af,ae){if(this._fluidDimensions==="x"){this._adjustBoundsX(af,ae)
}if(this._fluidDimensions==="y"){this._adjustBoundsY(af,ae)
}af.selectAll(".resize").attr("transform",function(ag){return"translate("+ae[+(/e$/).test(ag)][0]+","+ae[+(/^s/).test(ag)][1]+")"
})
};
ad._adjustBoundsX=function(af,ae){af.select(".extent").attr("x",ae[0][0]);
af.selectAll(".extent,.n>rect,.s>rect").attr("width",ae[1][0]-ae[0][0])
};
ad._adjustBoundsY=function(af,ae){af.select(".extent").attr("y",ae[0][1]);
af.selectAll(".extent,.e>rect,.w>rect").attr("height",ae[1][1]-ae[0][1])
};
ad._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var ae=this._chart.getTrainedScale("x");
this._brush.x(ae._d3Scale)
}if(this._fluidDimensions.indexOf("y")>=0){var af=this._chart.getTrainedScale("y");
this._brush.y(af._d3Scale)
}};
ad._render=function(){this._brushContainer=this._chart._parent.select(".interaction-group");
if(this._brush.empty()){this._brushContainer.classed("brush",true).call(this._brush)
}var ag=this._chart.plotBounds();
if(!this._brush.y()){var ae=ag.bottom-ag.top;
this._brushContainer.selectAll(".extent").attr("height",ae).attr("y",0);
this._brushContainer.selectAll(".resize rect").attr("height",ae).attr("y",0)
}if(!this._brush.x()){var af=ag.right-ag.left;
this._brushContainer.selectAll(".extent").attr("width",af).attr("x",0);
this._brushContainer.selectAll(".resize rect").attr("width",af).attr("x",0)
}};
ad.empty=function(){return this._brush.empty()
};
ad.clear=function(){this._brushContainer.call(this._brush.clear())
};
ad.extent=function(ae){if(!arguments.length){return(this._brush)?this._brush.extent():null
}this._brushContainer.call(this._brush.extent(ae));
return this
};
ad.snap=function(ae){if(!arguments.length){return this._snap
}this._snap=(this._fluidDimensions.length>1)?false:ae;
return this
};
ad.brushStart=function(ae){if(!arguments.length){return this._brushStart
}this._brushStart=ae;
return this
};
ad.brushMove=function(ae){if(!arguments.length){return this._brushMove
}this._brushMove=ae;
return this
};
ad.brushEnd=function(ae){if(!arguments.length){return this._brushEnd
}this._brushEnd=ae;
return this
};
ad.chart=function(ae){if(!arguments.length){return this._chart
}this._chart=ae;
this.initializeBrush(this._chart);
if(this._chart){this._setScales()
}return this
};
return ad
});
dv.brush=function(ah){var ad=C(ai,"brushstart","brush","brushend"),ak=null,aj=null,al=ac[0],ao=[[0,0],[0,0]],ae;
function ai(ap){ap.each(function(){var at=d3.select(this),ar=at.selectAll(".background").data([0]),aq=at.selectAll(".extent").data([0]),av=at.selectAll(".resize").data(al,String),au;
ah.on("mousedown.brush",am).on("touchstart.brush",am)._g.style("cursor","crosshair");
at.style("pointer-events","all");
aq.enter().append("rect").attr("class","extent").style("cursor","move");
av.enter().append("g").attr("class",function(aw){return"resize "+aw
}).style("cursor",function(aw){return l[aw]
}).append("rect").attr("x",function(aw){return(/[e]$/).test(aw)?-10:(/[w]$/).test(aw)?2:null
}).attr("y",function(aw){return(/^[ns]/).test(aw)?-3:null
}).attr("width",10).attr("height",6).style("visibility","hidden");
av.style("display",ai.empty()?"none":null);
av.exit().remove();
if(ak){au=dv.util.scaleRangeNoReverse(ak);
ar.attr("x",au[0]).attr("width",au[1]-au[0]);
ag(at)
}if(aj){au=dv.util.scaleRangeNoReverse(aj);
ar.attr("y",au[0]).attr("height",au[1]-au[0]);
af(at)
}an(at)
})
}function an(ap){ap.selectAll(".resize").attr("transform",function(aq){return"translate("+ao[+/e$/.test(aq)][0]+","+ao[+/^s/.test(aq)][1]+")"
})
}function ag(ap){ap.select(".extent").attr("x",ao[0][0]);
ap.selectAll(".extent,.n>rect,.s>rect").attr("width",ao[1][0]-ao[0][0])
}function af(ap){ap.select(".extent").attr("y",ao[0][1]);
ap.selectAll(".extent,.e>rect,.w>rect").attr("height",ao[1][1]-ao[0][1])
}function am(){var aJ=this,aq=d3.select(d3.event.target),ax=ad.of(aJ,arguments),aE=d3.select(aJ),aG=aq.datum(),aC=!/^(n|s)$/.test(aG)&&ak,aA=!/^(e|w)$/.test(aG)&&aj,aB=aq.classed("extent"),aH,aI=ay(),ar;
var av=d3.select(window).on("mousemove.brush",aw).on("mouseup.brush",ap).on("touchmove.brush",aw).on("touchend.brush",ap).on("keydown.brush",az).on("keyup.brush",au);
if(aB){aI[0]=ao[0][0]-aI[0];
aI[1]=ao[0][1]-aI[1]
}else{if(aG&&(aG==="e"||aG==="w"||aG==="s"||aG==="n"||aG==="nw"||aG==="ne"||aG==="sw"||aG==="se")){var aF=+/w$/.test(aG),aD=+/^n/.test(aG);
ar=[ao[1-aF][0]-aI[0],ao[1-aD][1]-aI[1]];
aI[0]=ao[aF][0];
aI[1]=ao[aD][1]
}else{if(d3.event.altKey){aH=aI.slice()
}}}aE.style("pointer-events","none").selectAll(".resize").style("display",null);
d3.select("body").style("cursor",aq.style("cursor"));
ax({type:"brushstart"});
aw();
a();
function ay(){var aK=d3.event.changedTouches;
return aK?d3.touches(aJ,aK)[0]:d3.mouse(aJ)
}function az(){if(d3.event.keyCode==32){if(!aB){aH=null;
aI[0]-=ao[1][0];
aI[1]-=ao[1][1];
aB=2
}a()
}}function au(){if(d3.event.keyCode==32&&aB==2){aI[0]+=ao[1][0];
aI[1]+=ao[1][1];
aB=0;
a()
}}function aw(){var aK=ay(),aL=false;
if(ar){aK[0]+=ar[0];
aK[1]+=ar[1]
}if(!aB){if(d3.event.altKey){if(!aH){aH=[(ao[0][0]+ao[1][0])/2,(ao[0][1]+ao[1][1])/2]
}aI[0]=ao[+(aK[0]<aH[0])][0];
aI[1]=ao[+(aK[1]<aH[1])][1]
}else{aH=null
}}if(aC&&at(aK,ak,0)){ag(aE);
aL=true
}if(aA&&at(aK,aj,1)){af(aE);
aL=true
}if(aL){an(aE);
ax({type:"brush",mode:aB?"move":"resize"})
}}function at(aS,aM,aO){var aP=dv.util.scaleRangeNoReverse(aM),aL=aP[0],aK=aP[1],aQ=aI[aO],aT=ao[1][aO]-ao[0][aO],aN,aR;
if(aB){aL-=aQ;
aK-=aT+aQ
}aN=Math.max(aL,Math.min(aK,aS[aO]));
if(aB){aR=(aN+=aQ)+aT
}else{if(aH){aQ=Math.max(aL,Math.min(aK,2*aH[aO]-aN))
}if(aQ<aN){aR=aN;
aN=aQ
}else{aR=aQ
}}if(ao[0][aO]!==aN||ao[1][aO]!==aR){ae=null;
ao[0][aO]=aN;
ao[1][aO]=aR;
return true
}}function ap(){aw();
aE.style("pointer-events","all").selectAll(".resize").style("display",ai.empty()?"none":null);
d3.select("body").style("cursor",null);
av.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null);
ax({type:"brushend"});
a()
}}ai.x=function(ap){if(!arguments.length){return ak
}ak=ap;
al=ac[!ak<<1|!aj];
return ai
};
ai.y=function(ap){if(!arguments.length){return aj
}aj=ap;
al=ac[!ak<<1|!aj];
return ai
};
ai.extent=function(av){var ar,ap,au,at,aq;
if(!arguments.length){av=ae||ao;
if(ak){ar=av[0][0],ap=av[1][0];
if(!ae){ar=ao[0][0],ap=ao[1][0];
if(ak.invert){ar=ak.invert(ar),ap=ak.invert(ap)
}if(ap<ar){aq=ar,ar=ap,ap=aq
}}}if(aj){au=av[0][1],at=av[1][1];
if(!ae){au=ao[0][1],at=ao[1][1];
if(aj.invert){au=aj.invert(au),at=aj.invert(at)
}if(at<au){aq=au,au=at,at=aq
}}}return ak&&aj?[[ar,au],[ap,at]]:ak?[ar,ap]:aj&&[au,at]
}ae=[[0,0],[0,0]];
if(ak){ar=av[0],ap=av[1];
if(aj){ar=ar[0],ap=ap[0]
}ae[0][0]=ar,ae[1][0]=ap;
if(ak.invert){ar=ak(ar),ap=ak(ap)
}if(ap<ar){aq=ar,ar=ap,ap=aq
}ao[0][0]=ar|0,ao[1][0]=ap|0
}if(aj){au=av[0],at=av[1];
if(ak){au=au[1],at=at[1]
}ae[0][1]=au,ae[1][1]=at;
if(aj.invert){au=aj(au),at=aj(at)
}if(at<au){aq=au,au=at,at=aq
}ao[0][1]=au|0,ao[1][1]=at|0
}return ai
};
ai.clear=function(){ae=null;
ao[0][0]=ao[0][1]=ao[1][0]=ao[1][1]=0;
return ai
};
ai.empty=function(){return(ak&&ao[0][0]===ao[1][0])||(aj&&ao[0][1]===ao[1][1])
};
return d3.rebind(ai,ad,"on")
};
var l={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"};
var ac=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];
function z(){}function X(ad){function ag(){var aj=af,ai=-1,ak=aj.length,ah;
while(++ai<ak){if(ah=aj[ai].on){ah.apply(this,arguments)
}}return ad
}var af=[],ae=new d3.map();
ag.on=function(ai,ak){var ah=ae.get(ai),aj;
if(arguments.length<2){return ah&&ah.on
}if(ah){ah.on=null;
af=af.slice(0,aj=af.indexOf(ah)).concat(af.slice(aj+1));
ae.remove(ai)
}if(ak){af.push(ae.set(ai,{on:ak}))
}return ad
};
return ag
}z.prototype.on=function(af,ag){var ae=af.indexOf("."),ad="";
if(ae>0){ad=af.substring(ae+1);
af=af.substring(0,ae)
}return arguments.length<2?this[af].on(ad):this[af].on(ad,ag)
};
function C(af){var ad=new z(),ae=0,ag=arguments.length;
while(++ae<ag){ad[arguments[ae]]=X(ad)
}ad.of=function(ai,ah){return function(aj){var ak;
try{ak=aj.sourceEvent=d3.event;
aj.target=af;
d3.event=aj;
ad[aj.type].apply(ai,ah)
}finally{d3.event=ak
}}
};
return ad
}function a(){d3.event.stopPropagation();
d3.event.preventDefault()
}dv.behavior.zoom=dv.behavior.extend(function(){function ad(ae){if(arguments.length&&!dv.util.isArray(ae)){this._dimensions=[this._dimensions]
}this._fluidDimensions=ae||["x","y"];
this._zoom=d3.behavior.zoom();
this.scaleExtent([0,Infinity]);
this._underGeoms=false
}ad.initializeZoom=function(af){var ae=this;
this._cacheAxes();
this._zoom.on("zoomstart.zoom",function(){if(ae._zoomStart){ae._zoomStart.call(this,"start",d3.event.scale,d3.event.translate,ae)
}}).on("zoom.zoom",function(){if(ae._zoomMove){ae._zoomMove.call(this,"move",d3.event.scale,d3.event.translate,ae)
}ae._refresh(d3.event.scale,d3.event.translate)
}).on("zoomend.zoom",function(){if(ae._zoomEnd){ae._zoomEnd.call(this,"end",d3.event.scale,d3.event.translate,ae)
}})
};
ad.underGeoms=function(ae){if(!arguments.length){return this._underGeoms
}this._underGeoms=ae;
return this
};
ad._cacheAxes=function(){this._axisCache={};
for(var ae in this._chart._axes._axes){this._axisCache[ae]=this._chart._axes._axes[ae]
}};
ad._removeEvents=function(){this._zoom.on("zoomstart.zoom",null).on("zoom.zoom",null).on("zoomend.zoom",null)
};
ad._refresh=function(ai,ah){var af=this,ae=[0,this._bounds.width-this._bounds.width*ai],ag=[0,this._bounds.height-this._bounds.height*ai];
if(ai>=1){ah[0]=Math.min(ae[0],Math.max(ah[0],ae[1]));
ah[1]=Math.min(ag[0],Math.max(ah[1],ag[1]))
}else{ah[0]=(ah[0]<ae[0])?ae[0]:(ah[0]>ae[1])?ae[1]:ah[0];
ah[1]=(ah[1]<ag[0])?ag[0]:(ah[1]>ag[1])?ag[1]:ah[1]
}this._zoom.translate(ah);
setTimeout(function(){af._chart._axes._axes=af._axisCache;
af._chart.duration(0);
af._chart._finalizePlotBounds();
af._chart._facet._render()
},0)
};
ad._setScales=function(){if(this._fluidDimensions.indexOf("x")>=0){var ae=this._chart.getTrainedScale("x");
this._zoom.x(ae._d3Scale)
}if(this._fluidDimensions.indexOf("y")>=0){var af=this._chart.getTrainedScale("y");
this._zoom.y(af._d3Scale)
}};
ad._render=function(af){this._zoomContainer=af.selectAll(".zoom-container").data([0]);
this._zoomContainer.enter().append("g").classed("zoom-container");
var ag=this._zoomContainer.selectAll(".zoom-pane").data([0]);
ag.enter().append("rect").classed("zoom-pane",true);
var ae=this._chart.facet().getPanel(0),ah=ae.bounds();
ag.attr("x",ah.left).attr("y",ah.top).attr("width",ah.width).attr("height",ah.height).call(this._zoom);
this._bounds=ah
};
ad.scale=function(ae){if(!arguments.length){return this._zoom.scale()
}this._zoom.scale(ae);
this._refresh(ae,this._zoom.translate());
return this
};
ad.scaleExtent=function(ae){if(!arguments.length){return this._zoom.scaleExtent()
}this._zoom.scaleExtent(ae);
return this
};
ad.translate=function(ae){if(!arguments.length){return this._zoom.translate()
}this._zoom.translate(ae);
this._refresh(this._zoom.scale(),ae);
return this
};
ad.zoomStart=function(ae){if(!arguments.length){return this._zoomStart
}this._zoomStart=ae;
return this
};
ad.zoomMove=function(ae){if(!arguments.length){return this._zoomMove
}this._zoomMove=ae;
return this
};
ad.zoomEnd=function(ae){if(!arguments.length){return this._zoomEnd
}this._zoomEnd=ae;
return this
};
ad.chart=function(ae){if(!arguments.length){return this._chart
}this._chart=ae;
this.initializeZoom(this._chart);
if(this._chart){this._setScales();
this._chart.clipPlot(true)
}return this
};
return ad
});
dv.behavior.rollover=dv.behavior.extend(function(){function ad(){this._selection=null;
this._showTooltip=this._defaultShowTooltip;
this._hideTooltip=this._defaultHideTooltip;
this._orientation="right";
this._tooltipPadding=10;
this._content=this._defaultContent;
this._lastSelectedTarget=null;
this._timer=null;
this._pressTimer=null;
this._dragInspect=true
}ad._render=function(ae){this._xGuides=this.__geom._chart._axes._get("x");
this._yGuides=this.__geom._chart._axes._get("y");
this._isPolar=(this.__geom.coord() instanceof dv.coord.polar);
this._selection=ae;
this._addEvents()
};
ad._addEvents=function(){var ae=this;
this.__geom.on("mouseover.rollover",function(ah,ag,af){return ae._onMouseOver.call(this,ah,ag,af,ae)
}).on("mouseout.rollover",function(ah,ag,af){return ae._onMouseOut.call(this,ah,ag,af,ae)
});
this.__geom._chart.on("tap.rollover",function(){return ae._onTap.call(ae,d3.event)
}).on("touchstart.rollover",function(){return ae._onTouchStart.call(ae,d3.event)
}).on("touchmove.rollover",function(){return ae._onTouchMove.call(ae,d3.event)
}).on("touchend.rollover",function(){return ae._onTouchEnd.call(ae,d3.event)
})
};
ad._removeEvents=function(){this.__geom.on("mouseover.rollover",null).on("mouseout.rollover",null);
this.__geom._chart.on("tap.rollover",null).on("touchstart.rollover",null).on("touchmove.rollover",null).on("touchend.rollover",null)
};
ad._getElementMetadata=function(af,ag){var ae={d:ag.datum(),i:0,j:0};
af._geomGroup.selectAll(".series ."+af._dataPointStyleClass).each(function(aj,ai,ah){if(ae.d===aj){ae.i=ai;
ae.j=ah
}});
return ae
};
ad._defaultShowTooltip=function(ai,ag,af,ah,ae){ae._darkenGeom.call(this,ai,ae);
ae._showTip.call(this,ai,ag,af,ae)
};
ad._defaultHideTooltip=function(ai,ag,af,ah,ae){ae._brightenGeom.call(this,ai,ae);
ae._removeTip.call(this,ai,ag,af,ae)
};
ad._darkenGeom=function(aj,ae){var ag=d3.select(this),ai,ah,af=function(ak,an,am){if(an[ak]){var al=ae.__geom.getScale(ak).mapValue(an[ak]);
am.style(ak,d3.rgb(al).darker(1).toString())
}};
af("fill",aj,ag);
af("stroke",aj,ag)
};
ad._brightenGeom=function(aj,ae){var ag=d3.select(this),ai,ah,af=function(ak,an,am){if(an[ak]){var al=ae.__geom.getScale(ak).mapValue(an[ak]);
am.style(ak,al)
}};
af("fill",aj,ag);
af("stroke",aj,ag)
};
ad._showTip=function(ak,ah,ag,ae){var ai=ae.__geom.chart()._chartContainer,aj=this.getBBox(),al=dv.absoluteCoordinates(ae.__geom.chart(),[aj.x,aj.y],ak.panel),af={height:aj.height,width:aj.width,x:al[0],y:al[1]};
dv.showTooltip(af,ai.select(".plot").node().getBBox(),ae.content().call(ae,ak,ah,ag),ae._orientation,ae._tooltipPadding,ai)
};
ad._removeTip=function(ah,ag,af,ae){dv.removeTooltip(ae.__geom.chart()._chartContainer)
};
ad._defaultContent=function(ak,ah,af){var al=this.__geom.getExplicitScale("group"),ag=ak[0]?ak[0]:ak,ao=ag.panel.xScale(ag),am=ag.panel.yScale(ag),an=this._xGuides[ao.scaleIndex()],ae=this._yGuides[am.scaleIndex()],ap=(an.__scale&&an.tickFormat()?an.tickFormat():String),ai=(ae.__scale&&ae.tickFormat()?ae.tickFormat():String),aj='<span class="metric-value">'+ai(ag.data[am.mapping()])+'</span><span class="metric-name">'+am.mapping()+'</span><span class="metric-value">'+ap(ag.data[ao.mapping()])+'</span><span class="metric-name">'+ao.mapping()+"</span>";
if(al&&al.mapping()){aj='<span class="series-name">'+ag.data[al.mapping()]+"</span>"+aj
}return aj
};
ad._onMouseOver=function(ah,ag,af,ae){ae._showTooltip.call(this,ah,ag,af,d3.event,ae);
if(this._mouseOver){this._mouseOver.call(this,ah,ag,af,d3.event)
}};
ad._onMouseOut=function(ah,ag,af,ae){ae._hideTooltip.call(this,ah,ag,af,d3.event,ae);
if(ae._mouseOut){ae._mouseOut.call(this,ah,ag,af,d3.event)
}};
ad._onTap=function(ae){this._dragInspect=true;
this._onTouchMove.call(this,ae);
this._onTouchEnd.call(this,ae)
};
ad._onTouchStart=function(af){var ae=this;
if(this._lastSelectedTarget){clearTimeout(ae._timer);
this._onTouchEnd.call(this,af,0)
}this._dragInspect=false;
clearTimeout(this._pressTimer);
this._pressTimer=setTimeout(function(){ae._dragInspect=true;
ae._onTouchMove.call(ae,af)
},500);
return false
};
ad._onTouchMove=function(ah){if(!this._dragInspect){clearTimeout(this._pressTimer);
return
}var ag=ah.touches?ah.touches[0]:ah,aj=d3.select(this._elementFromPoint(ag)),ae=this._lastSelectedTarget&&this._lastSelectedTarget.node()===aj.node();
if(!aj.empty()&&aj.classed(this.__geom._dataPointStyleClass)){if(this._lastSelectedTarget&&!ae){var ai=this._lastSelectedTarget.datum();
this._brightenGeom.call(this._lastSelectedTarget.node(),ai,this)
}if(!ae){var af=this._getElementMetadata(this.__geom,aj);
this._showTooltip.call(aj.node(),af.d,af.i,af.j,ah,this);
if(this._mouseOver){this._mouseOver.call(aj.node(),af.d,af.i,af.j,ah)
}this._lastSelectedTarget=aj
}}dv.cancelEvent(ah)
};
ad._onTouchEnd=function(ai,af){var ae=this;
clearTimeout(this._pressTimer);
this._dragInspect=false;
var ah=ai.touches?ai.touches[0]:ai;
if(arguments.length<2){af=500
}if(this._lastSelectedTarget){var ag=function(){if(!ae._lastSelectedTarget){return
}var aj=ae._getElementMetadata(ae.__geom,ae._lastSelectedTarget);
ae._hideTooltip.call(ae._lastSelectedTarget.node(),aj.d,aj.i,aj.j,ai,ae);
if(ae._mouseOut){ae._mouseOut.call(ae._lastSelectedTarget.node(),aj.d,aj.i,aj.j,ai)
}ae._lastSelectedTarget=null
};
if(af){timer=setTimeout(ag,af)
}else{ag.call(this)
}}dv.cancelEvent(ai)
};
ad._elementFromPoint=function(af){var ae=[af.clientX,af.clientY];
if(this._testAndroidChromeBug141840()){ae=[af.screenX,af.screenY]
}return document.elementFromPoint(ae[0],ae[1])
};
ad.content=function(ae){if(!arguments.length){return this._content
}this._content=d3.functor(ae);
return this
};
ad.tooltipPadding=function(ae){if(!arguments.length){return this._tooltipPadding
}this._tooltipPadding=ae;
return this
};
ad.orientation=function(ae){if(!arguments.length){return this._orientation
}this._orientation=ae;
return this
};
ad.mouseOver=function(ae){if(!arguments.length){return this._mouseOver
}this._mouseOver=ae;
return this
};
ad.mouseOut=function(ae){if(!arguments.length){return this._mouseOut
}this._mouseOut=ae;
return this
};
ad.showTooltip=function(ae){if(!arguments.length){return this._showTooltip
}this._showTooltip=ae;
return this
};
ad.hideTooltip=function(ae){if(!arguments.length){return this._hideTooltip
}this._hideTooltip=ae;
return this
};
ad._geom=function(ae){if(!arguments.length){return this.__geom
}if(this.__geom&&this.__geom!==ae){this._removeEvents()
}this.__geom=ae;
return this
};
return ad
});
dv.behavior.voronoiRollover=dv.behavior.rollover.extend(function(){function ad(){this._super();
this._voronoiContainer=null;
this._points=null;
this._pointDetectionRadius=20;
this._numHitAreaVertices=12;
this._isPolar=false
}ad._render=function(ae){this._xGuides=this.__geom._chart._axes._get("x");
this._yGuides=this.__geom._chart._axes._get("y");
this._isPolar=(this.__geom.coord() instanceof dv.coord.polar);
this._selection=ae;
this._createTooltipContainer();
this._renderPolygons(this._getPolygonData(),ae);
this._addEvents()
};
ad._addEvents=function(){var ae=this;
this.__geom._chart.on("tap.rollover",function(){return ae._onTap.call(ae,d3.event)
}).on("touchstart.rollover",function(){return ae._onTouchStart.call(ae,d3.event)
}).on("touchmove.rollover",function(){return ae._onTouchMove.call(ae,d3.event)
}).on("touchend.rollover",function(){return ae._onTouchEnd.call(ae,d3.event)
})
};
ad._removeEvents=function(){this.__geom._chart.on("tap.rollover",null).on("touchstart.rollover",null).on("touchmove.rollover",null).on("touchend.rollover",null)
};
ad._createTooltipContainer=function(){this._voronoiContainer=this._selection.selectAll(".voronoiSelection-container").data([this]);
this._voronoiContainer.enter().append("g").classed("voronoiSelection-container",true)
};
ad._getPolygonData=function(){var ag=[],ah=this.__geom._nestData,ae=this;
this._points=[];
var af=ae.__geom.coord()._point().x(function(aj,ai){return aj.x
}).y(function(aj,ai){return aj.y
}).defined(function(aj,ai){return true
});
dv.util.each(this.__geom._nestData,function(aj,ai){dv.util.each(aj.values,function(aq,al){var ap={},ao=aq[0]?aq[0]:aq,ak=ao.panel.xScale(ao),ar=ao.panel.yScale(ao);
ap.x=ak.mapValueToPercent(ak.mapToProp(ao,al)+ak.rangeBand()/2,al)||0;
ap.y=ar.mapValueToPercent(ar.mapValue(ao.hasOwnProperty("y0")?(ao.y+ao.y0):ao.y),al)||0;
ap.panel=ao.panel;
var an=af.getBounds(ap,al);
if(ae._isPolar){var am=ae.__geom.coord()._transformAngleRadiusToXY(an.bounds.x,an.bounds.y);
range.bounds.x=am[0];
range.bounds.y=am[1]
}ae._points.push({data:an,rawData:ao,seriesIndex:ai,index:al});
ag.push([an.bounds.x,an.bounds.y])
})
});
return d3.geom.voronoi(ag)
};
ad._renderPolygons=function(aj,ao){var ap=this,ag=this.__geom._nestData.length,ai=this.__geom._nestData[0].values.length,af=d3.select(ao.node().parentNode),an=0,am=0,al;
if(this._isPolar){var ak=this.__geom._nestData[0].values[0].panel,ae=dv.util.scaleRangeNoReverse(ak.xOuterScale()),ah=dv.util.scaleRangeNoReverse(ak.yOuterScale());
an=(ae[0]+ae[1])/2;
am=(ah[0]+ah[1])/2
}this._voronoiContainer.attr("transform","translate("+an+","+am+")");
var aq=this._voronoiContainer.selectAll("path").data(aj);
aq.exit().remove();
aq.enter().append("path").attr("id",function(at,ar){return"path-"+ar
}).classed("voronoi-overlay",true);
aq.attr("d",function(at,ar){return ap._getPolygonPath(at,ar,ap)
}).on("mouseover.rollover",function(au,at,ar){return ap._onMouseOver.call(this,au.data,at,ar,ap)
}).on("mouseout.rollover",function(au,at,ar){return ap._onMouseOut.call(this,au.data,at,ar,ap)
}).call(this._removeRegisteredEvents,this).call(this._addRegisteredEvents,this);
aq.exit().on("mouseover.rollover",null).on("mouseout.rollover",null).remove()
};
ad._addRegisteredEvents=function(af,ae){if(!ae){ae=this
}if(!ae.__geom){return
}af=af||ae._voronoiContainer.selectAll(".voronoi-overlay");
dv.util.each(ae.__geom.eventMap,function(ah,ag){af.on(ag,function(aj,ai){ae.__geom.eventMap[ag].callback.call(this,aj,ai,d3.event)
},ah.capture)
});
dv.util.each(ae.__geom._chart.eventMap,function(ah,ag){af.on(ag+".dvchart",function(al,aj){var ak=d3.event,ai=ae.__geom._chart._interactionGroup.node();
if(ae._shouldDispatchChartEvent(ak,ai)){ae.__geom._chart.eventMap[ag].callback.call(ai,ak)
}},ah.capture)
})
};
ad._removeRegisteredEvents=function(af,ae){if(!ae){ae=this
}if(!ae.__geom){return
}af=af||ae._voronoiContainer.selectAll(".voronoi-overlay");
dv.util.each(ae.unregisterEventMap,function(ag,ah){af.on(ah,null,ag)
});
dv.util.each(ae.__geom._chart.unregisterEventMap,function(ag,ah){af.on(ah+".dvchart",null,ag)
})
};
ad._shouldDispatchChartEvent=function(aj,ag){var ae=true;
if(aj.type==="mouseout"||aj.type==="mouseover"){var af=aj.relatedTarget;
if(!af){af=(aj.type==="mouseout")?aj.toElement:aj.fromElement
}var ai=d3.select(af);
if(ai&&!ai.empty()){var ah=ai.attr("class");
ae=!((ai.node()===ag)||ai.classed("voronoi-overlay"))
}}return ae
};
ad._getPolygonPath=function(ak,aj,ag){if(!ak){return null
}ak.data=ag._points[aj];
var af=dv.util.clone(ak),ae=ag._points[aj],ai=d3.geom.polygon(ag._getPolygonPoints(ae.data.bounds.x,ae.data.bounds.y)),ah=ai.clip(ak);
return(ah.length)?("M"+ah.join("L")+"Z"):null
};
ad._getPolygonPoints=function(aj,ah){var ag=[];
for(var af=360;
af>0;
af-=360/this._numHitAreaVertices){var ai=af*Math.PI/180,ae=Math.cos(ai)*this._pointDetectionRadius+aj,ak=Math.sin(ai)*this._pointDetectionRadius+ah;
ag.push([ae,ak])
}return ag
};
ad._defaultShowTooltip=function(ai,ag,af,ah,ae){ae._showPoint.call(this,ai,ag,af,ae);
ae._showTip.call(this,ai,ag,af,ae)
};
ad._defaultHideTooltip=function(ai,ag,af,ah,ae){ae._removePoint.call(this,ai,ag,af,ae);
ae._removeTip.call(this,ai,ag,af,ae)
};
ad._showPoint=function(ak,ai,ah,am){var aj=10,al=ak.rawData,ag=am.getGeomFromVoronoiIndex.call(am,al,ai,ah);
if(!ag.empty()){var ae=ag.node().getBoundingClientRect(),af={height:ae.height,width:ae.width,x:ae.x,y:ae.y};
aj=Math.max(af.height,af.width)/2+2.5
}am._voronoiContainer.append("circle").classed("hover-point",true).attr("id","point-"+ah+"-"+ai).attr("cx",ak.data.bounds.x).attr("cy",ak.data.bounds.y).attr("r",0).style("stroke",function(){return am.__geom.getHighlightColor(ak.rawData,ai)
}).style("pointer-events","none").transition().duration(350).attr("r",aj)
};
ad._removePoint=function(ah,ag,af,ae){ae._voronoiContainer.selectAll("#point-"+af+"-"+ag).transition().duration(350).attr("r",0).remove()
};
ad._showTip=function(am,aj,ai,aq){var an=aq.__geom.chart()._chartContainer,ag,al=am.data,ao=am.rawData;
var ah=aq.getGeomFromVoronoiIndex.call(aq,ao,aj,ai);
if(ah.empty()){var ak=dv.absoluteCoordinates(aq.__geom.chart(),[al.bounds.x,al.bounds.y],ao.panel),ap=10,af=10;
ag={height:ap,width:af,y:ak[1]-ap/2,x:ak[0]-af/2}
}else{var ae=ah.node().getBBox();
ag={height:ae.height,width:ae.width,x:ae.x,y:ae.y}
}dv.showTooltip(ag,an.select(".panels").node().getBBox(),aq.content().call(aq,ao,aj,ai),aq._orientation,aq._tooltipPadding,an)
};
ad.getGeomFromVoronoiIndex=function(ag,af,ae){return this.__geom.chart()._g.selectAll(".datum-"+af+".series-"+ae).filter(function(ah){return ag===ah
})
};
ad._onMouseOver=function(ah,ag,af,ae){ae._showTooltip.call(this,ah,ah.index,ah.seriesIndex,d3.event,ae);
if(ae._mouseOver){ae._mouseOver.call(this,ah.rawData,ah.index,ah.seriesIndex,d3.event)
}};
ad._onMouseOut=function(ah,ag,af,ae){ae._hideTooltip.call(this,ah,ah.index,ah.seriesIndex,d3.event,ae);
if(ae._mouseOut){ae._mouseOut.call(this,ah.rawData,ah.index,ah.seriesIndex,d3.event)
}};
ad._onTouchMove=function(ag){if(!this._dragInspect){clearTimeout(this._pressTimer);
return
}var af=ag.touches?ag.touches[0]:ag,ai=d3.select(this._elementFromPoint(af)),ae=this._lastSelectedTarget&&this._lastSelectedTarget.node()===ai.node();
if(!ai.empty()&&ai.classed("voronoi-overlay")){if(this._lastSelectedTarget&&!ae){var ah=this._lastSelectedTarget.datum().data;
this._removePoint.call(ai.node(),ah.rawData,ah.index,ah.seriesIndex,this)
}if(!ae){var aj=ai.datum().data;
this._showTooltip.call(ai.node(),aj,aj.index,aj.seriesIndex,ag,this);
if(this._mouseOver){this._mouseOver.call(ai.node(),aj.rawData,aj.index,aj.seriesIndex,ag)
}this._lastSelectedTarget=ai
}}dv.cancelEvent(ag)
};
ad._onTouchEnd=function(ah,af){var ae=this;
clearTimeout(this._pressTimer);
if(this._dragInspect){this._dragInspect=false
}if(arguments.length<2){af=500
}if(this._lastSelectedTarget){var ag=function(){if(!ae._lastSelectedTarget){return
}var ai=ae._lastSelectedTarget.datum().data;
ae._hideTooltip.call(ae._lastSelectedTarget.node(),ai,ai.index,ai.seriesIndex,ah,ae);
if(ae._mouseOut){ae._mouseOut.call(ae._lastSelectedTarget.node(),ai.rawData,ai.index,ai.seriesIndex,ah)
}ae._lastSelectedTarget=null
};
if(af){timer=setTimeout(ag,af)
}else{ag.call(this)
}}dv.cancelEvent(ah)
};
ad.pointDetectionRadius=function(ae){if(!arguments.length){return this._pointDetectionRadius
}this._pointDetectionRadius=ae;
return this
};
ad.numHitAreaVertices=function(ae){if(!arguments.length){return this._numHitAreaVertices
}this._numHitAreaVertices=ae;
return this
};
return ad
});
dv.log=dv.log||{};
dv.log.NOCONSOLE=false;
dv.log.LVL_ERROR=0;
dv.log.ERROR="error";
dv.log.LVL_WARN=1;
dv.log.WARN="warn";
dv.log.LVL_DEBUG=2;
dv.log.DEBUG="debug";
dv.log.LOGLEVEL=dv.log.LVL_DEBUG;
dv.log.error=function(ad){return dv.log._message(dv.log.ERROR,ad)
};
dv.log.warn=function(ad){return dv.log._message(dv.log.WARN,ad)
};
dv.log.debug=function(ad){return dv.log._message(dv.log.DEBUG,ad)
};
dv.log.noConsole=function(ad){dv.log.NOCONSOLE=ad||false;
dv.log.console=window.console||dv.util.noop;
if(!dv.log.console.log||dv.log.NOCONSOLE){dv.log.console.log=dv.util.noop
}if(!dv.log.console.error||dv.log.NOCONSOLE){dv.log.console.error=dv.log.console.log
}if(!dv.log.console.warn||dv.log.NOCONSOLE){dv.log.console.warn=dv.log.console.log
}if(!dv.log.console.debug||dv.log.NOCONSOLE){dv.log.console.debug=dv.log.console.log
}};
dv.log._message=function(ae,ad){if(dv.log._isValidType(ae)){if(dv.log.LOGLEVEL>=dv.log["LVL_"+ae.toUpperCase()]){dv.log.console[ae](ad.msg,ad.data)
}if(ae===dv.log.ERROR){throw ad.msg+" Context Data: "+JSON.stringify(ad.data)
}}else{dv.log.console.log("Logging message with invalid type: "+ae)
}};
dv.log._isValidType=function(ad){return ad===dv.log.ERROR||ad===dv.log.WARN||ad===dv.log.DEBUG
};
dv.log.noConsole(false);
dv.panel=dv.extend(function(){function ad(){this._margins={left:0,top:0,right:0,bottom:0};
this._trainedScales={}
}ad.getTrainedScale=function(ae){if(ae==="x"){return this.xScale()
}if(ae==="y"){return this.yScale()
}return this._trainedScales[ae]
};
ad.getOuterScale=function(ae){if(ae==="x"){return this._xScale
}if(ae==="y"){return this._yScale
}return null
};
ad._updateRanges=function(af){var ae=[af.left,af.right],ag=[af.bottom,af.top];
if(this._facet._chart.coord().flip()){this._xScale.range(ag);
this._yScale.range(ae)
}else{this._xScale.range(ae);
this._yScale.range(ag)
}};
ad.bounds=function(ae){if(!arguments.length){return this._bounds
}this._bounds=ae;
this._updateRanges(this._bounds);
return this
};
ad.margins=function(ae){if(!arguments.length){return this._margins
}this._margins=ae;
return this
};
ad.visibleAxisLabelOrientations=function(ae){if(!arguments.length){return this._visibleAxisLabelOrientations
}this._visibleAxisLabelOrientations=ae;
return this
};
ad.columnIndex=function(ae){if(!arguments.length){return this._columnIndex
}this._columnIndex=ae;
return this
};
ad.rowIndex=function(ae){if(!arguments.length){return this._rowIndex
}this._rowIndex=ae;
return this
};
ad.facetIndex=function(ae){if(!arguments.length){return this._facetIndex
}this._facetIndex=ae;
return this
};
ad.facetKey=function(ae){if(!arguments.length){return this._facetKey
}this._facetKey=ae;
return this
};
ad.xFacetTitle=function(ae){if(!arguments.length){return this._xFacetTitle
}this._xFacetTitle=ae;
return this
};
ad.yFacetTitle=function(ae){if(!arguments.length){return this._yFacetTitle
}this._yFacetTitle=ae;
return this
};
ad.xOuterScale=function(ae){if(!arguments.length){return this._xScale
}this._xScale=ae;
return this
};
ad.yOuterScale=function(ae){if(!arguments.length){return this._yScale
}this._yScale=ae;
return this
};
ad.xScale=function(af){var ae=0;
if(af&&af.hasOwnProperty("x-index")){ae=af["x-index"]
}return this._xScale.innerScaleGroup()[ae]
};
ad.yScale=function(af){var ae=0;
if(af&&af.hasOwnProperty("y-index")){ae=af["y-index"]
}return this._yScale.innerScaleGroup()[ae]
};
ad.facet=function(ae){if(!arguments.length){return this._facet
}this._facet=ae;
this._trainedScales={};
return this
};
return ad
});
dv.facet=dv.extend(function(){function ad(){this._numColumns=0;
this._numRows=0;
this._hGap=10;
this._vGap=10
}ad._prerender=function(){var ae=this;
this._trainedScales={};
this._panels=[];
this._rows=[];
this._columns=[];
this._panelsWithAxisLabels=[];
dv.util.each(ae._chart._layers,function(af){af._prerender(ae._chart);
ae._trainFacetGroups(af)
});
this._configureFacets();
dv.util.each(ae._chart._layers,function(af){af._nestData=ae._nestFacet(af);
af._handlePositions();
af._trainScales();
af._createDefaultScales()
});
this._trainScales()
};
ad._trainScales=function(){var af=this,ae,ak,ai,ah,aj=function(al){return function(am){return af._getFacetFromFacetKey(am)!==al.facetKey()
}
},ag=function(al){return function(ao,am,an){if(arguments.length<2){am=0
}if(arguments.length<3){return(this._globalScales[ao]===undefined)?null:this._globalScales[ao][am]
}if(!this._globalScales[ao]){this._globalScales[ao]={}
}this._globalScales[ao][am]=an;
return an
}
};
this._globalScales={};
this._positionScales={};
dv.util.each(this._panels,function(al,am){dv.util.each(af._chart._layers,function(ao){for(var aq in ao._aes){var ar=ao._aes[aq];
for(var ap in ar){var an=ao.getScale(aq,ap);
if(!(an instanceof dv.scale.constant)){if(af._isFree.call(af,aq)){ae=af._trainFreeScale(ao,al,aq,ap,aj(al))
}else{ae=af._trainScale(ao,ag(ao),aq,ap)
}if(!al._trainedScales[aq]){al._trainedScales[aq]={}
}al._trainedScales[aq][ap]=ae;
ar[ap].unionDomain(ae,ae.reverse());
ar[ap].range(ae.range())
}}}})
});
dv.util.each(this._globalScales,function(al,am){dv.util.each(al,function(ao,an){ao.validateDomain()
})
})
};
ad._isFree=function(ag){var ae=ag==="x"||ag==="xMin"||ag==="xMax",af=ag==="y"||ag==="yMin"||ag==="yMax";
return((ae&&(this._scales==="free"||this._scales==="free_x"))||(af&&(this._scales==="free"||this._scales==="free_y")))
};
ad._trainScale=function(ah,ag,ak,aj,ai){var ae=ag.call(this,ak,aj),af={stack:ah.position()==="stack"&&ak==="y",fill:ah.position()==="fill"&&ak==="y",filter:ai},al;
if(ae){al=ah._aes[ak][aj];
al.domain(al.calculateDomain(ah._nestData,af));
ae.unionDomain(al,ae.reverse());
ae.unionRange(al.range())
}else{ah._aes[ak][aj].trainDomain(ah._nestData,af);
ae=ah._aes[ak][aj].copy();
ag.call(this,ak,aj,ae)
}return ae
};
ad._render=function(){this._axes=this._chart._axes;
var af=this._ensureColumnsAndRows();
this._adjustPlotBounds(af[0],af[1]);
this._configurePanels(af[0],af[1]);
this._axes._initializeAxisRenderers();
this._axes._measureTitles(this._chart._plotBounds);
var ae=this._measureMargins(af[0],af[1]);
this._layoutPanels(af[0],af[1],ae);
this._renderAxisTitles();
this._renderPanels()
};
ad._setVisibleAxisLabelOrientations=function(af,ae,aj,ai){var ak=af.rowIndex(),ah=af.columnIndex(),ag={left:ah===0,top:ak===0,right:(ah===aj)||(af.facetIndex()===(ai-1)),bottom:(ak===ae)||(ah>aj&&ak===ae-1)};
af.visibleAxisLabelOrientations(ag)
};
ad._changeScaleRangeToLocal=function(ae){var af=ae.range(),ag=ae.innerScaleGroup();
for(var ah in ag){dv.util.scaleRange(ag[ah],[af[0],af[1]]).applyRangePadding()
}return ag
};
ad._measureMargins=function(an,al){var ak=this._panels.length,af=~~((ak-1)/an),ah=(ak-1)%an,au=this._axes._getAllOrientations(),ax={rows:[],cols:[]},ag=this._isFree("x"),at=this._isFree("y"),aq=this,ai=this._panels[0];
if(ai){this._changeScaleRangeToLocal(ai.getOuterScale("x"));
this._changeScaleRangeToLocal(ai.getOuterScale("y"))
}var aw=-1;
while(++aw<ak){var ao=this._panels[aw],ar=ao.columnIndex(),am=ao.rowIndex();
this._setVisibleAxisLabelOrientations(ao,af,ah,ak);
ao.margins({left:0,top:0,right:0,bottom:0});
if(am>=ax.rows.length){ax.rows[am]={left:0,top:0,right:0,bottom:0}
}if(ar>=ax.cols.length){ax.cols[ar]={left:0,top:0,right:0,bottom:0}
}this._panelsWithAxisLabels.push(ao);
this._axes._measure(ao);
var ap=ao.margins();
if(au.right!==undefined&&!at&&(aw===(ak-1)&&ar<an-1)){ap.right=0
}if(au.bottom!==undefined&&!ag&&(ar>=ah&&am===af-1)){ap.bottom=0
}for(var av in ax){var aj=av==="rows"?am:ar;
var ae=ax[av][aj];
ae.left=Math.max(ap.left,ae.left);
ae.top=Math.max(ap.top,ae.top);
ae.right=Math.max(ap.right,ae.right);
ae.bottom=Math.max(ap.bottom,ae.bottom)
}}return ax
};
ad._layoutPanels=function(al,at,ah){var am=this._chart._plotBounds,aq=(am.right-am.left)-(al-1)*this._hGap,ae=(am.bottom-am.top)-(at-1)*this._vGap,ag,ao,ap={x:0,y:0},ar=this,ai,af;
ai=-1;
af=ah.cols.length;
while(++ai<af){aq-=ah.cols[ai].left+ah.cols[ai].right
}ai=-1;
af=ah.rows.length;
while(++ai<af){ae-=ah.rows[ai].bottom+ah.rows[ai].top
}ag=Math.max(aq/al,0);
ao=Math.max(ae/at,0);
var an=this._chart._chartContainer.select(".axes-labels");
var ak=an.selectAll(".panel-labels").data(this._panelsWithAxisLabels);
ak.enter().append("div");
ak.exit().remove();
ak.attr("class",function(av,au){return"panel-labels panel-"+av.facetIndex()
});
var aj=this._chart._panelContainer.selectAll(".panel").data(this._panels);
aj.enter().append("g").classed("panel",true);
aj.exit().remove();
aj.each(function(av,au){ar._drawPanel.call(this,ar,av,au,am,ah,ag,ao,al,at,ap);
ar._axes._render.call(ar._axes,d3.select(this),an.select(".panel-labels.panel-"+av.facetIndex()),av)
})
};
ad._renderAxisTitles=function(){var ae=this.getColumn(0)[0].bounds(),ak=this.getRow(0)[0].bounds(),aj=this.getColumn(this._columns.length-1)[0].bounds(),ah=this.getRow(this._rows.length-1)[0].bounds(),af=(ah.bottom-ak.top)/2+ak.top,ag=(aj.right-ae.left)/2+ae.left,ai=this._chart.plotBounds();
this._axes._renderTitles({left:[ai.left,af],right:[ai.right,af],top:[ag,ai.top],bottom:[ag,ai.bottom]})
};
ad._renderPanels=function(){var ag=this._chart,ah=ag._plotBounds,aj=ag._g.select(".plot"),ak=ag._plotBounds;
var ae=function(al){al.attr("transform","translate(0,0)").each(function(am){if(this.__previousData__&&(this.__previousData__._dataPointStyleClass!=am._dataPointStyleClass)){this.__previousData__.exit(this)
}am._render(this);
this.__previousData__=am
})
};
var af=function(al){al.each(function(am){am.exit(this,function(){al.remove()
})
})
};
var ai=aj.selectAll(".geom").data(ag._layers);
ai.exit().call(af);
ai.enter().append("g").classed("geom",true);
ai.call(ae)
};
ad._updatePanelTitle=function(av,aq,ag,ai,ao,af,at){var an={left:0,top:0,width:0,height:0},ah=d3.select(this);
if(dv.util.isUndefined(aq)){av._removePanelTitle.call(this,ag);
return an
}var ap=ah.selectAll(".panel-title."+ag).data([0]);
var ar=ap.enter().append("g").classed("panel-title "+ag,true).attr("transform","translate("+ai+","+ao+")");
var aj=ar.append("rect").classed("panel-title-bg",true);
var am=ar.append("text").classed("panel-title-label",true).attr("text-anchor","middle");
if(dv.ANIMATION){ap.transition().duration(av._chart._duration).attr("transform","translate("+ai+","+ao+")")
}else{ap.attr("transform","translate("+ai+","+ao+")")
}var al=ap.selectAll(".panel-title-label").text(aq);
var ak=ap.selectAll(".panel-title-bg");
var ae=al.node().getBBox(),au=0;
if(dv.ANIMATION){al=al.transition().duration(av._chart._duration);
ak=ak.transition().duration(av._chart._duration)
}switch(ag){case"top":x=af/2;
y=ae.height;
an.left=0;
an.top=0;
an.width=af;
an.height=ae.height+6;
break;
case"right":x=at/2;
y=-af+ae.height;
an.left=af-(ae.height+6);
an.top=0;
an.width=ae.height+6;
an.height=at;
au=90;
break;
case"bottom":x=af/2;
y=at-6;
an.left=0;
an.top=at-(ae.height+6);
an.width=af;
an.height=ae.height+6;
break;
case"left":x=-at/2;
y=0+(ae.height);
an.left=0;
an.top=0;
an.width=ae.height+6;
an.height=at;
au=270;
break
}aj.attr("x",an.left).attr("y",an.top).attr("width",an.width).attr("height",an.height);
am.attr("transform","rotate("+au+" 0,0)").attr("x",x).attr("y",y);
al.attr("transform","rotate("+au+" 0,0)").attr("x",x).attr("y",y);
ak.attr("x",an.left).attr("y",an.top).attr("width",an.width).attr("height",an.height);
return an
};
ad._removePanelTitle=function(ae){d3.select(this).selectAll(".panel-title."+ae).remove()
};
ad._updatePanelBackground=function(aj,ai,ah,ag,ae){var af=d3.select(this).selectAll(".plot-bg").data([0]);
af.enter().append("rect").classed("plot-bg",true).style("opacity",0.000001).attr("x",ai).attr("y",ah).attr("width",ag).attr("height",ae);
if(dv.ANIMATION){af=af.transition().duration(aj._chart._duration)
}af.attr("x",ai).attr("width",ag).attr("height",ae).style("opacity",1)
};
ad._addToCollection=function(ae,ag,af){if(!ae[ag]){ae[ag]=[]
}ae[ag].push(af)
};
ad.getPanel=function(ae){return this._panels&&ae<this._panels.length?this._panels[ae]:null
};
ad.getRow=function(ae){return this._rows[ae]
};
ad.getColumn=function(ae){return this._columns[ae]
};
ad.getTrainedScale=function(ae){if(this._panels.length>0){return this.getPanel(0).getTrainedScale(ae)
}return this._trainedScales[ae]
};
ad.scales=function(ae){if(!arguments.length){return this._scales
}this._scales=ae;
return this
};
ad.space=function(ae){if(!arguments.length){return this._space
}this._space=ae;
return this
};
ad.titleFormat=function(ae){if(!arguments.length){return this._titleFormat
}this._titleFormat=d3.functor(ae);
return this
};
ad.hGap=function(ae){if(!arguments.length){return this._hGap
}this._hGap=ae;
return this
};
ad.vGap=function(ae){if(!arguments.length){return this._vGap
}this._vGap=ae;
return this
};
ad.chart=function(ae){if(!arguments.length){return this._chart
}this._chart=ae;
return this
};
return ad
});
dv.facet.scale=dv.extend(function(){function ad(){}ad.domain=function(){return this._innerScale.domain()
};
ad.range=function(ae){if(!arguments.length){return this._range
}this._range=ae;
return this
};
ad._applyPercentage=function(ae,af){return this._range[0]+(this._range[1]-this._range[0])*ae.apply(this._innerScale,af)
};
ad.mapPropToPercent=function(af,ae){return this._innerScale.mapPropToPercent(af)
};
ad.mapValueToPercent=function(af,ae){return this._innerScale.mapValueToPercent(af)
};
ad.mapToProp=function(af,ae){return this._applyPercentage(this._innerScale.mapPropToPercent,[af,ae])
};
ad.mapValue=function(af,ae){return this._applyPercentage(this._innerScale.mapValueToPercent,[af,ae])
};
ad.rangeBand=function(){return this._applyPercentage(this._innerScale.rangeBand)
};
ad.innerScaleGroup=function(ae){if(!arguments.length){return this._innerScaleGroup
}this._innerScaleGroup=ae;
return this
};
return ad
});
dv.facet.wrap=dv.facet.extend(function(){function ad(){this._super();
this._facetScale=null;
this._preferredAspectRatio=1;
this._titleOrientation="top"
}ad._prerender=function(){this._facetScale=dv.scale.ordinal().mapping(this._group).domain([]);
this._super()
};
ad._trainFacetGroups=function(ae){var af=ae.data()[this._facetScale.mapping()];
if(af){this._facetScale.domain(this._facetScale.domain().concat(af))
}};
ad._trainFreeScale=function(ag,ae,aj,ah,ai){var af=function(am,ak,al){if(arguments.length<2){ak=0
}if(arguments.length<3){if(!ae._trainedScales[am]){return undefined
}return ae._trainedScales[am][ak]
}if(!ae._trainedScales[am]){ae._trainedScales[am]={}
}ae._trainedScales[am][ak]=al;
return al
};
return this._trainScale(ag,af,aj,ah,ai)
};
ad._showAllPanelLabelsIfFree=function(){return true
};
ad._configureFacets=function(){this._facetKeys=this._facetScale.domain();
this._facetMap={}
};
ad._nestFacet=function(an){var ar=this,am=an.normalizedData(),ah=dv.util.filterAndZip(am),aq=an.getScale("group"),af=this._group,al=this._facetScale.domain(),ak,ap;
if(aq){ak=aq.property();
ap=ak?am[ak]:null
}var aj=-1,ag=ah.length;
while(++aj<ag){var ao=0,at,ai=ah[aj];
if(ai.data.hasOwnProperty(af)){ao=al.indexOf(ai.data[af]);
if(ao>=0){at=al[ao]+""
}}var ae=this._facetMap[ao];
if(!ae){ae=dv.panel().facetIndex(ao).facetKey(at).xFacetTitle(at).facet(this);
this._facetMap[ao]=ae;
this._panels.push(ae)
}ai.panel=ae
}return d3.nest().key(function(au){var av="";
av+=(au.data.hasOwnProperty(af)?au.data[af]:".")+" ~ ";
av+=(au.hasOwnProperty(ak)?au[ak]:".");
return av
}).sortKeys(function(aw,au){var az=ar._getGroupFromFacetKey(aw),ay=ar._getGroupFromFacetKey(au),ax=-1,av=-1;
if(az!=="."){ax=ap.indexOf(az);
if(ax<0){ax=ap.indexOf(Number(az))
}}if(ay!=="."){av=ap.indexOf(ay);
if(av<0){av=ap.indexOf(Number(ay))
}}return av<ax?1:-1
}).entries(ah)
};
ad._getGroupFromFacetKey=function(ae){return(/.* ~ (.*)/g).exec(ae)[1]
};
ad._getFacetFromFacetKey=function(ae){return(/(.*) ~ .*/g).exec(ae)[1]
};
ad._ensureColumnsAndRows=function(){var ai=this._panels.length,aj=Math.min(this._numColumns,ai),ah=Math.min(this._numRows,ai);
if(aj<1&&ah<1){var ak=this._chart._plotBounds,ag=ak.right-ak.left,af=ak.bottom-ak.top,ae=Math.min(ai,Math.ceil(Math.sqrt((ai*1*ag)/(af*this._preferredAspectRatio))));
ae=isNaN(ae)?1:ae;
return[ae,Math.ceil(ai/ae)]
}if(aj<1&&ah>=1){aj=Math.ceil(ai/ah)
}if(aj>=1&&ah<1){ah=Math.ceil(ai/aj)
}return[aj,ah]
};
ad._adjustPlotBounds=function(af,ae){return
};
ad._configurePanels=function(an,at){var aq=this._chart._plotBounds,ak=aq.right-aq.left,al=aq.bottom-aq.top,ah=(ak-((an-1)*this._hGap))/an,ar=(al-((at-1)*this._vGap))/at;
var ai=-1,ag=this._panels.length;
while(++ai<ag){var ae=this._panels[ai],af=dv.facet.scale().innerScaleGroup(ae._trainedScales.x),ap=dv.facet.scale().innerScaleGroup(ae._trainedScales.y),aj=ai%an,am=~~(ai/an),ao={left:0,top:0,right:ah,bottom:ar,width:ah,height:ar};
this._panels[ai].xOuterScale(af).yOuterScale(ap).columnIndex(aj).rowIndex(am).bounds(ao);
this._addToCollection(this._rows,am,ae);
this._addToCollection(this._columns,aj,ae)
}};
ad._drawPanel=function(aq,av,at,am,au,aw,ai,al,aj,ah){var ar=av.columnIndex(),ak=av.rowIndex(),ao=au.rows[ak],an=au.cols[ar],af=aq._titleOrientation;
if(ar===0){ah.x+=am.left;
if(ak===0){ah.y+=am.top
}}var ap=ah.y+ao.top,ag=ah.x+an.left,ax=(aq._titleFormat?aq._titleFormat.call(this,av.xFacetTitle(),at):av.xFacetTitle());
var ae=aq._updatePanelTitle.call(this,aq,ax,af,ag,ap,aw,ai);
av.bounds({width:aw,height:ai,top:ap+(af==="top"?ae.height:0),left:ag+(af==="left"?ae.width:0),right:ag+aw+(af==="right"?-ae.width:0),bottom:ap+ai+(af==="bottom"?-ae.height:0)});
aq._updatePanelBackground.call(this,aq,ag,ap,aw,ai);
if(ar===al-1){ah.x=0;
ah.y+=ao.top+ai+ao.bottom+aq._vGap
}else{ah.x+=an.left+aw+an.right+aq._hGap
}};
ad.group=function(ae){if(!arguments.length){return this._group
}this._group=ae;
return this
};
ad.numColumns=function(ae){if(!arguments.length){return this._numColumns
}this._numColumns=ae;
return this
};
ad.numRows=function(ae){if(!arguments.length){return this._numRows
}this._numRows=ae;
return this
};
ad.preferredAspectRatio=function(ae){if(!arguments.length){return this._preferredAspectRatio
}this._preferredAspectRatio=ae;
return this
};
return ad
});
dv.facet.grid=dv.facet.extend(function(){function ad(){this._super();
this._xFacetScale=null;
this._yFacetScale=null
}ad._prerender=function(){this._xFacetScale=dv.scale.ordinal().mapping(this._xGroup).domain([]);
this._yFacetScale=dv.scale.ordinal().mapping(this._yGroup).domain([]);
this._super()
};
ad._trainFacetGroups=function(ae){var ag=ae.data()[this._xFacetScale.mapping()];
if(ag){this._xFacetScale.domain(this._xFacetScale.domain().concat(ag))
}var af=ae.data()[this._yFacetScale.mapping()];
if(af){this._yFacetScale.domain(this._yFacetScale.domain().concat(af))
}};
ad._trainFreeScale=function(ah,ae,ak,ai,aj){var af=this;
var ag=function(aq,ao,ap){if(arguments.length<2){ao=0
}if(!af._positionScales[aq]){af._positionScales[aq]={}
}var al=af._positionScales[aq];
if(!al[ao]){al[ao]=[]
}var an=al[ao],am=(aq.indexOf("x")>=0)?ae.columnIndex():ae.rowIndex();
if(arguments.length<3){return an[am][ao]
}an[am][ao]=ap;
return ap
};
return this._trainScale(ah,ag,ak,aj)
};
ad._showAllPanelLabelsIfFree=function(){return false
};
ad._configureFacets=function(){var ak,ah,ag=this._xFacetScale.domain(),al=this._yFacetScale.domain(),am;
this._numColumns=Math.max(this._xFacetScale.domain().length,1);
this._numRows=Math.max(this._yFacetScale.domain().length,1);
var aj=-1,af=this._numRows,ao=0;
while(++aj<af){yFacetIndex=aj;
if(al&&al.length>aj){ah=al[aj]
}var ai=-1,an=this._numColumns;
while(++ai<an){xFacetIndex=ai;
if(ag&&ag.length>ai){ak=ag[ai]
}am=(al.length?ah:".")+" ~ "+(ag.length?ak:".");
var ae=dv.panel().facetIndex(ao++).facetKey(am).columnIndex(xFacetIndex).rowIndex(yFacetIndex).xFacetTitle(ak).yFacetTitle(ah).facet(this);
this._panels.push(ae);
this._addToCollection(this._rows,yFacetIndex,ae);
this._addToCollection(this._columns,xFacetIndex,ae)
}}};
ad._nestFacet=function(ap){var at=this,ao=ap.normalizedData(),aj=dv.util.filterAndZip(ao),ar=ap.getScale("group"),ag=this._xFacetScale.domain(),an=this._yFacetScale.domain(),am,aq;
if(ar){am=ar.property();
aq=am?ao[am]:null
}var al=-1,ah=aj.length;
while(++al<ah){var ak=aj[al],af=0,ai=0;
if(ak.data.hasOwnProperty(this._xGroup)){ai=ag.indexOf(ak.data[this._xGroup]);
if(ai<0){ai=0
}}if(ak.data.hasOwnProperty(this._yGroup)){af=an.indexOf(ak.data[this._yGroup]);
if(af<0){af=0
}}panelIndex=(af*this._numColumns)+ai;
var ae=this._panels[panelIndex];
ak.panel=ae
}return d3.nest().key(function(au){var av="";
av+=(au.data.hasOwnProperty(at._yGroup)?au.data[at._yGroup]:".")+" ~ ";
av+=(au.data.hasOwnProperty(at._xGroup)?au.data[at._xGroup]:".")+" ~ ";
av+=(au.hasOwnProperty(am)?au[am]:".");
return av
}).sortKeys(function(aw,au){var az=at._getGroupFromFacetKey(aw),ay=at._getGroupFromFacetKey(au),ax=-1,av=-1;
if(az!=="."){ax=aq.indexOf(az);
if(ax<0){ax=aq.indexOf(Number(az))
}}if(ay!=="."){av=aq.indexOf(ay);
if(av<0){av=aq.indexOf(Number(ay))
}}return av<ax?1:-1
}).entries(aj)
};
ad._getGroupFromFacetKey=function(ae){return(/.* ~ .* ~ (.*)/g).exec(ae)[1]
};
ad._getFacetFromFacetKey=function(ae){return(/(.* ~ .*) ~ .*/g).exec(ae)[1]
};
ad._ensureColumnsAndRows=function(){return[this._numColumns,this._numRows]
};
ad._adjustPlotBounds=function(ah,ag){var ae=this._measureTitles(this._xFacetScale.domain(),"temp-column-titles",this._chart._g)+3,af=this._measureTitles(this._yFacetScale.domain(),"temp-row-titles",this._chart._g)+3,ai=this._chart._plotBounds;
this._xTitleHeight=ae;
this._yTitleWidth=af;
this._chart._plotBounds.top+=ae;
this._chart._plotBounds.right-=af
};
ad._measureTitles=function(af,ae,ah){var aj=this._createTitlesContainer(ae,this._chart._g);
var ag=aj.selectAll(".panel-title").data(af);
ag.enter().append("text").text(function(al,ak){return al
});
var ai=aj.node().getBBox();
aj.remove();
return ai.height
};
ad._createTitlesContainer=function(af,ae){var ag=ae.selectAll("."+af).data([0]);
ag.enter().append("g").classed(af,true);
ag.exit().remove();
return ag
};
ad._configurePanels=function(ao,au){var ar=this._chart._plotBounds,am=ar.right-ar.left,an=ar.bottom-ar.top,ai=(am-((ao-1)*this._hGap))/ao,at=(an-((au-1)*this._vGap))/au,ag=0,al=0,ak=0;
var aj=-1,ah=this._panels.length;
while(++aj<ah){var ae=this._panels[aj],af=dv.facet.scale().innerScaleGroup(ae._trainedScales.x),aq=dv.facet.scale().innerScaleGroup(ae._trainedScales.y),ap={left:0,top:0,right:0+ai,bottom:0+at,width:ai,height:at};
this._panels[aj].xOuterScale(af).yOuterScale(aq).bounds(ap);
ag+=ai+this._hGap;
ak++;
if(ak>=ao){ag=0;
al+=at+this._vGap;
ak=0
}}};
ad._drawPanel=function(at,ak,ai,an,ah,ag,aq,am,au,ar){var ap=ak.columnIndex(),al=ak.rowIndex(),ao=ah.rows[al],ae=ah.cols[ap];
ar.x+=ae.left;
if(ap===0){ar.x+=an.left
}if(al===0){var af=(at._titleFormat?at._titleFormat.call(this,ak.xFacetTitle(),ai):ak.xFacetTitle());
ar.y=ao.top+an.top;
at._updatePanelTitle.call(this,at,af,"top",ar.x,ar.y-at._xTitleHeight,ag,aq)
}else{at._removePanelTitle.call(this,"top")
}if(ap===at._numColumns-1){var aj=(at._titleFormat?at._titleFormat.call(this,ak.yFacetTitle(),ai):ak.yFacetTitle());
at._updatePanelTitle.call(this,at,aj,"right",ar.x+at._yTitleWidth,ar.y,ag,aq)
}else{at._removePanelTitle.call(this,"right")
}ak.bounds({width:ag,height:aq,top:ar.y,left:ar.x,right:ar.x+ag,bottom:ar.y+aq});
at._updatePanelBackground.call(this,at,ar.x,ar.y,ag,aq);
ar.x+=ag+ae.right+at._hGap;
if(ap===at._numColumns-1){ar.x=0;
ar.y+=ao.top+aq+ao.bottom+at._vGap
}};
ad.xGroup=function(ae){if(!arguments.length){return this._xGroup
}this._xGroup=ae;
return this
};
ad.yGroup=function(ae){if(!arguments.length){return this._yGroup
}this._yGroup=ae;
return this
};
ad.aggregate=function(ae){if(!arguments.length){return this._aggregate
}this._aggregate=ae;
return this
};
return ad
});
dv.chart=dv.container.extend(function(){function ad(){this._super();
this._firstRender=false;
this._data={};
this._coord=dv.coord.cartesian();
this._facet=dv.facet.wrap().chart(this);
this._layers=[];
this._behaviors=[];
this._legends=dv.guide.legends();
this._axes=dv.guide.axes()._chart(this);
this._delay=d3.functor(0);
this._duration=d3.functor(1000);
this._ease="cubic-in-out";
this._parent=null;
this._chartContainer=null;
this._svgContainer=null;
this._g=null;
this._axisLabelContainer=null;
this._panelContainer=null;
this._interactionGroup=null;
this._prerenderFunc=null;
this._postrenderFunc=null;
this._clipPlot=false;
this._width=NaN;
this._height=NaN;
this._plotWidth=NaN;
this._plotHeight=NaN;
this._calcWidth=NaN;
this._calcHeight=NaN;
this._calcPlotWidth=NaN;
this._calcPlotHeight=NaN;
this._defaultPadding=this._padding=this._plotBounds=this._guidesBounds={top:0,left:0,right:0,bottom:0};
this._position="identity"
}ad.render=function(){if(dv.util.isUndefined(this._data)||dv.util.isEmpty(this._data)){for(var ae=0;
ae<this._layers.length;
ae++){if(dv.util.isUndefined(this._layers[ae]._data)||dv.util.isEmpty(this._layers[ae]._data)){dv.log.error({msg:"Cannot render a chart with no data provided.",data:{chartData:this._data,geom:this._layers[ae]}})
}}}this._resolvePercentDimensions();
this._createChartContainer();
this._prerender();
this._renderLegends();
if(this._prerenderFunc){this._prerenderFunc.call(this)
}this._facet._render();
if(this._postrenderFunc){this._postrenderFunc.call(this)
}this._renderBehaviors();
this._clipGeoms();
this._cleanupGuides();
this.unregisterEventMap=null;
return this
};
ad._resolvePercentDimensions=function(){this._calcWidth=dv.util.getPercentValue(this._width,this._parent.node().offsetWidth);
this._calcHeight=dv.util.getPercentValue(this._height,this._parent.node().offsetHeight);
if(!dv.util.isFinite(this._calcWidth)){this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._parent.node().offsetWidth);
if(!dv.util.isFinite(this._calcPlotWidth)){this._calcWidth=this._parent.node().offsetWidth
}}else{this._calcPlotWidth=dv.util.getPercentValue(this._plotWidth,this._calcWidth)
}if(!dv.util.isFinite(this._calcHeight)){this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._parent.node().offsetHeight);
if(!dv.util.isFinite(this._calcPlotHeight)){this._calcHeight=this._parent.node().offsetHeight
}}else{this._calcPlotHeight=dv.util.getPercentValue(this._plotHeight,this._calcHeight)
}};
ad._finalizePlotBounds=function(){var ah=this._legends._allowedDimensions(),af=this._legends._getWidth(),ag=this._legends._getHeight(),ae={left:Math.max(ah.left,this._padding.left),top:Math.max(ah.top,this._padding.top)};
if(!dv.util.isFinite(this._calcWidth)){this._calcWidth=this._calcPlotWidth+af+this._padding.left+this._padding.right
}else{if(!dv.util.isFinite(this._calcPlotWidth)){this._calcPlotWidth=this._calcWidth-this._padding.left-this._padding.right-af
}}if(!dv.util.isFinite(this._calcHeight)){this._calcHeight=this._calcPlotHeight+ag+this._padding.top+this._padding.bottom
}else{if(!dv.util.isFinite(this._calcPlotHeight)){this._calcPlotHeight=this._calcHeight-this._padding.top-this._padding.bottom-ag
}}this._calcPlotWidth=Math.min(this._calcPlotWidth,this._calcWidth-this._padding.left-this._padding.right-af);
this._calcPlotHeight=Math.min(this._calcPlotHeight,this._calcHeight-this._padding.top-this._padding.bottom-ag);
ae.right=ae.left+this._calcPlotWidth;
ae.bottom=ae.top+this._calcPlotHeight;
this.plotBounds(ae);
if(this._coord instanceof dv.coord.cartesian){this._plotBounds.right-=this._coord.endX();
this._plotBounds.left+=this._coord.startX()
}this._chartContainer.style("width",this._calcWidth+"px").style("height",this._calcHeight+"px")
};
ad._prerender=function(){this._trainedScales={};
this._calculateStats();
this._facet._prerender();
var ae=this._normalizeData(this.data());
this.data(ae);
if(!this._axes._get("x")){this._axes._add("x",dv.guide.axis())
}if(!this._axes._get("y")){this._axes._add("y",dv.guide.axis())
}};
ad._createChartContainer=function(){this._chartContainer=this._parent.selectAll(".dv-chart-container").data([0]);
this._chartContainer.enter().append("div").classed("dv-chart-container",true);
this._svgContainer=this._chartContainer.selectAll("svg").data([0]);
this._svgContainer.enter().append("svg").style("height","100%").style("width","100%");
this._g=this._svgContainer.select(".group");
if(this._g.empty()){this._firstRender=true;
this._g=this._svgContainer.append("g").classed("group",true);
this._panelContainer=this._g.append("g").classed("panels",true);
this._interactionGroup=this._g.append("g").classed("interaction-group",true);
this._g.append("g").classed("behavior-under-geom",true);
this._g.append("g").classed("plot",true);
this._g.append("g").classed("behavior",true);
this._g.append("g").classed("legends",true);
this._interactionGroup.append("rect").classed("interaction-canvas",true).classed("background",true)
}if(!this._panelContainer){this._panelContainer=this._g.select(".panels")
}if(!this._interactionGroup){this._interactionGroup=this._g.select(".interaction-group")
}this._axisLabelContainer=this._chartContainer.selectAll(".axes-labels").data([0]);
this._axisLabelContainer.enter().append("div").classed("axes-labels",true)
};
ad._addRegisteredEvents=function(){var ae=this;
dv.util.each(ae.eventMap,function(ag,af){ae._interactionGroup.on(af,function(){var ai=d3.event,ah=ae._interactionGroup.node();
if(ae._shouldDispatchChartEvent(ai,ah)){ae.eventMap[af].callback.call(ae._interactionGroup.node(),d3.event)
}},ag.capture)
});
dv.util.each(ae._layers,function(af){af._addRegisteredEvents()
})
};
ad._removeRegisteredEvents=function(){var ae=this;
dv.util.each(ae.unregisterEventMap,function(af,ag){if(ae._interactionGroup){ae._interactionGroup.on(ag,null,af)
}});
dv.util.each(ae._layers,function(af){af._removeRegisteredEvents()
})
};
ad._shouldDispatchChartEvent=function(ai,af){var ae=true;
if(ai.type==="mouseout"||ai.type==="mouseover"){var ah=d3.select(ai.relatedTarget);
if(ah&&!ah.empty()){var ag=ah.attr("class");
ae=!(ag&&ag.indexOf("-geom")>=0)
}}return ae
};
ad._calculateStats=function(){};
ad._renderLegends=function(){var ag=(dv.util.isFinite(this._calcWidth)?this._calcWidth-this._padding.left-this._padding.right:this._calcPlotWidth),ae=(dv.util.isFinite(this._calcHeight)?this._calcHeight-this._padding.top-this._padding.bottom:this._calcPlotHeight),af={left:this._padding.left,top:this._padding.top,width:ag,height:ae},ah={el:this._g,scales:this._facet._globalScales,firstRender:this._firstRender,duration:this._duration,delay:this._delay,ease:this._ease};
this._legends._allowedDimensions(af)._render(ah);
this._finalizePlotBounds()
};
ad._cleanupGuides=function(){this._legends._empty();
this._axes._empty()
};
ad._setRanges=function(){var ag=this.plotBounds(),af=this.getTrainedScale("y"),ah=this.getTrainedScale("x");
var ae=this.coord().flip()?[ag.bottom-ag.top,0]:[0,ag.right-ag.left],ai=this.coord().flip()?[0,ag.right-ag.left]:[ag.bottom-ag.top,0];
dv.util.scaleRange(ah,ae);
dv.util.scaleRange(af,ai)
};
ad.plotBounds=function(ae){if(!arguments.length){return this._plotBounds
}this._plotBounds=ae;
return this
};
ad._renderBehaviors=function(){var ae=this._facet.getPanel(0),ah=ae._bounds,ag=this._g.select(".behavior").attr("transform","translate(0,0)"),ai=this._g.select(".behavior-under-geom").attr("transform","translate(0, 0)");
this._interactionGroup.attr("transform","translate(0,0)").select(".interaction-canvas").attr("visibility","hidden").attr("width",ah.right-ah.left).attr("height",ah.bottom-ah.top).attr("x",ah.left).attr("y",ah.top);
var af=this;
dv.util.each(this._behaviors,function(aj){if(aj.underGeoms&&aj.underGeoms()){aj.chart(af)._render(ai)
}else{aj.chart(af)._render(ag)
}})
};
ad.guide=function(al,ae,ak){if(!al||al===""){throw new Error("Property argument cannot be null or empty")
}if(al==="all"){if(ae!=="none"){throw new Error("'all' can only be used to set all guides to 'none' (e.g. turn off all guides)")
}this._legends._hide(true);
this._axes._add("x","none",0);
this._axes._add("y","none",0)
}al=dv.util.isArray(al)?al:[al];
ak=dv.util.isUndefined(ak)?0:ak;
var aj=dv.guide.legend(),ag="";
for(var af=0;
af<al.length;
af++){var ai=ae,ah=this._isPositionProperty(al[af]);
if(!ag){ag=ah?"axis":"legend"
}else{if(ah&&ag!="axis"){throw new Error("Cannot mix positional and non-positional guide types")
}}if(!ai){ai=ah?dv.guide.axis():aj
}else{if(!this._isValidGuideType(al[af],ai)&&dv.util.isObject(ai)){ai=this._buildCustomGuide(ai)
}}if(this._isValidGuideType(al[af],ai)){if(ai!=="none"){ai.scaleIndex(ak)
}if(ah){this._axes._add(al[af],ai,ak)
}else{if(ai!=="none"){this._legends._add({props:al,guide:ai});
break
}else{this._legends._remove(al)
}}}}return this
};
ad._isPositionProperty=function(ae){return(ae==="x"||ae==="y")
};
ad._isValidGuideType=function(ag,ae){var af=this._isPositionProperty(ag);
return ae&&(ae==="none"||ae instanceof dv.guide.custom)||(af&&ae instanceof dv.guide.axis)||(!af&&ae instanceof dv.guide.legend)
};
ad._buildCustomGuide=function(ae){var af=dv.guide.custom();
for(var ag in ae){af.setFunc(ag,ae[ag])
}return af
};
ad.getScale=function(af,ae){if(arguments.length<2){ae=0
}if(af==="group"){return this._getGroup()
}if(this._aes.hasOwnProperty(af)){return this._aes[af][ae]
}};
ad._getGroup=function(){if(this._aes.hasOwnProperty("group")){return this._aes.group[0]
}var af=-1,ae=dv.DEFAULT_CATEGORICAL_AES.length-1;
while(af++<ae){var ag=this._aes[dv.DEFAULT_CATEGORICAL_AES[af]];
if(ag&&ag[0]&&!dv.util.isUndefined(ag[0].mapping())){return ag[0]
}}return null
};
ad._clipGeoms=function(){var af=this;
var ah=this._parent.selectAll(".panel").selectAll("defs").data(function(aj){return af._clipPlot?[aj]:[]
});
ah.enter().append("defs");
ah.exit().remove();
var ae=ah.selectAll("clipPath").data(function(aj){return[aj]
});
ae.enter().append("clipPath").classed("dv-clip",true);
ae.exit().remove();
ae.attr("id",function(aj){return"dv-clip"+aj._facetIndex
});
var ai=ae.selectAll("rect").data(function(aj){return[aj]
});
ai.enter().append("rect");
ai.exit().remove();
ai.attr("x",function(aj){return aj._bounds.left
}).attr("y",function(aj){return aj._bounds.top
}).attr("width",function(aj){return aj._bounds.width
}).attr("height",function(aj){return aj._bounds.height
});
if(af._clipPlot){var ag=this._parent.selectAll(".series");
ag.attr("clip-path",function(al){var ak=al.values[0],aj=dv.util.isArray(ak)?ak[0].panel:ak.panel;
return"url(#dv-clip"+aj._facetIndex+")"
})
}};
ad.getTrainedScale=function(ae){return this._facet.getTrainedScale(ae)
};
ad.getExplicitScale=function(af,ae){if(ae===undefined){ae=0
}return this._aes[af][ae]
};
ad.parent=function(ae){if(!arguments.length){return this._parent?this._parent.node():null
}this._parent=d3.select(ae);
if(this._parent.empty()){throw new Error("The DV parent element was not found.")
}return this
};
ad.layers=function(ae){if(!arguments.length){return this._layers
}this._layers=ae;
return this
};
ad.behaviors=function(ae){if(!arguments.length){return this._behaviors
}this._behaviors=ae;
return this
};
ad.data=function(ae){if(!arguments.length){return this._data
}this._data=ae;
return this
};
ad.coord=function(ae){if(!arguments.length){return this._coord
}this._coord=ae;
return this
};
ad.facet=function(ae){if(!arguments.length){return this._facet
}this._facet=ae;
this._facet.chart(this);
return this
};
ad.getPlotBounds=function(ae){return this._plotBounds
};
ad.plotWidth=function(ae){if(!arguments.length){return this._plotWidth
}this._plotWidth=ae;
return this
};
ad.plotHeight=function(ae){if(!arguments.length){return this._plotHeight
}this._plotHeight=ae;
return this
};
ad.width=function(ae){if(!arguments.length){return this._width
}this._width=ae;
return this
};
ad.height=function(ae){if(!arguments.length){return this._height
}this._height=ae;
return this
};
ad.padding=function(ae){if(!arguments.length){return this._padding
}this._padding=dv.util.merge(this._defaultPadding,ae);
return this
};
ad.prerender=function(ae){if(!arguments.length){return this._prerenderFunc
}this._prerenderFunc=ae;
return this
};
ad.postrender=function(ae){if(!arguments.length){return this._postrenderFunc
}this._postrenderFunc=ae;
return this
};
ad.clipPlot=function(ae){if(!arguments.length){return this._clipPlot
}this._clipPlot=ae;
return this
};
return ad
})
})();
(function(d){function a(t,E){if(this instanceof a){return this
}var C=E||{},V=0,k=C.displayCount||-1,n=C.showNone,T={},w=(T.value=[]),Z=(T.origValue=[]),R=(T.lowerBound=[]),G=(T.upperBound=[]),z=(T.series=[]),P=(T.series_name=[]),q=(T.metric_series=[]),N=(T.metric_series_name=[]),D=(T.date=[]),Q=(T.category=[]),A=(T.label=[]),B=(T.groups=[]),p=(T.facets=[]),o=(T.cell=[]),W=(T.filter=[]),j=C.showMetrics||false,ae=(T.metric=[]);
var v,h,I,O,M,ab,F,X,K,S,s,Y,J,ac,u,U,ad,L,r,af,g,aa=t.metrics.length>1,H=false,l=false;
if(t.filters.length>1){t.filters.some(function(m,f,ag){if(f>0&&!l){l=(m.data_store!==ag[f-1].data_store)
}if(f>0&&!H){H=((m.info&&m.info.name||"")!==(ag[f-1].info&&ag[f-1].info.name||""))
}return H&&l
})
}for(S=0,s=t.metrics.length;
S<s;
++S){O=t.metrics[S];
F=(O.name||O.id||"")+"";
v=O.filter_ref;
h=O.date_ref;
J=(k>=0)?Math.min(k,v.length):v.length;
for(Y=0;
Y<J;
++Y){M=t.filters[v[Y]];
if(!M.facet_ref){M.facet_ref=[]
}af=[];
g=[];
for(ad=0,L=M.facet_ref.length;
ad<L;
++ad){r=t.facets[M.facet_ref[ad]];
af.push(r);
g.push(r.info&&r.info.name||"")
}if((M.info&&M.info.id===0)&&!n){if(J<v.length){++J
}continue
}ab=(M.info&&M.info.name||"")+"";
K=M.data_store_name||(M.data_store&&M.data_store.replace("dms/","")||"");
for(ac=0,u=h.length;
ac<u;
++ac){X=t.dates[h[ac]];
I=t.data[v[Y]][h[ac]][S];
w[V]=("invalid"===I.status||"transform_error"===I.status||"calc_error"===I.status)?undefined:(+I.val||0);
Z[V]="invalid"===I.status?undefined:(+I.orig_val||0);
R[V]=("invalid"===I.status||"transform_error"===I.status)?undefined:(+I.lower_bound||0);
G[V]=("invalid"===I.status||"transform_error"===I.status)?undefined:(+I.upper_bound||0);
D[V]=new Date(X.val);
Q[V]=ab;
A[V]=F;
N[V]=((l)?K+"   ":"")+F;
q[V]=N[V]+":m"+O.ref_id;
U=[];
if(l){U.push(K)
}if(Q[V].length){U.push(Q[V])
}P[V]=U.join("   ");
if(P[V].length===0){P[V]=F
}else{if((j||aa||!H)&&F.length){P[V]+=" ("+F+")"
}}z[V]=P[V]+":m"+O.ref_id+"f"+M.ref_id;
B[V]=g;
W[V]=M;
ae[V]=O;
o[V]=I;
p[V]=af;
++V
}}}return T
}var b=d.rs2dv;
a.noConflict=function(){d.rs2dv=b;
return this
};
a.prototype.convert=function(){return a.apply(null,arguments)
};
d.rs2dv=a;
if("function"===typeof define&&define.amd){define(function(){return a
})
}else{if("undefined"===typeof exports){d.rs2dv=a
}else{if("object"!==typeof module||!module.exports){exports.rs2dv=a
}else{module.exports=a
}}}}(this));
(function(f){var g={},b=f.dv||{},d=f.d3||{};
var a={};
a._options=null;
a._eventMap={};
a._changedOptions=null;
a.init=function(h){this._initDefaultOptions();
this.setOptions(h);
return this
};
a._initDefaultOptions=function(h){var k={dataAdapter:"standard",data:null,height:null,parent:null,width:null,autoResize:false,locale:"en-US",l10n:{}};
if(h){this._mergeOptions(k,h)
}this._options=k;
this._changedOptions={};
for(var j in k){this._changedOptions[j]=k[j]
}return this._options
};
a._mergeOption=function(j,h,k){switch(h){case"mappings":case"formats":j[h]=j[h]||{};
this._mergeOptions(j[h],k);
break;
default:j[h]=k;
break
}return j
};
a._mergeOptions=function(h,k){for(var j in k){this._mergeOption(h,j,k[j])
}return h
};
a._truncateLabel=function(j,k){var h=k||this.X_AXIS_LABEL_MAXLENGTH;
return(j.length>h)?j.substring(0,h)+"...":j
};
a._formatNumber=function(j,r,k){var h="",q,l,s=this._dataAdapter.l10n.numberFormat,p,m,n;
if(j=="currency"||j=="percent"){h=s[j].symbol;
if(r>=0){p=s[j].positivePattern
}else{p=s[j].negativePattern
}}else{if(r>=0){p="{number}"
}else{p=s.negativePattern
}}if(j=="percent"){r*=100
}r=Math.abs(r);
if(r>=100){n=3
}else{if(r>=10){n=(r%1)?3:2
}else{if(r>=1){n=(r%1)?3:1
}else{n=(r%1)?2:1
}}}if(k!=null){var o=d.formatPrefix(r);
m=o.scale(r).toFixed(k)+o.symbol
}else{if(r>=1000&&r<10000){m=d.format(",.0f")(r)
}else{m=d.format("."+n+"s")(r)
}}if(k&&r<Math.pow(10,-k)&&r>0){l=true;
m=Math.pow(10,-k)+""
}else{if(k==null&&r<0.01&&r>0){l=true;
m="0.01"
}}q=p.replace(/\{number\}/i,m).replace(/\{symbol\}/i,h).replace(/,/g,s.groupSeparator).replace(/\./,s.decimalSeparator);
if(l){q="<"+q
}return q
};
a._getPropMapping=function(h){return this._dataAdapter.mappings()[h]
};
a.setOption=function(h,j){if(!(h in this._options)){return false
}if("dataAdapter"===h&&"rs2dv"===j){j="rs"
}if("clickHandler"===h){this.on("click",j)
}this._mergeOption(this._options,h,j);
if(!this._changedOptions){this._changedOptions={}
}this._changedOptions[h]=j;
return true
};
a.getOption=function(j){var h=this._options;
if(j in h){return h[j]
}return null
};
a.setOptions=function(j){for(var h in j){this.setOption(h,j[h])
}};
a._preRender=function(){this._clearErrorMessage();
if("autoResize" in this._changedOptions){this._updateWindowResize()
}if("dataAdapter" in this._changedOptions){var k=this._changedOptions.dataAdapter;
if(!this._dataAdapter||(this._options.dataAdapter!==k)){var j=g.dataAdapter[k];
if(!j){throw new Error("No data adapters were found for data adapter type "+k)
}var h=j[this._type]||j.base||g.dataAdapter.standard.base;
this._dataAdapter=h()
}}this._dataAdapter.process(this._options,this._changedOptions)
};
a._render=function(){};
a._postRender=function(){this._changedOptions={}
};
a.render=function(){this.reset();
this._preRender();
this._render();
this._postRender();
return this
};
a.reset=function(){};
a._updateWindowResize=function(){if(this._options.autoResize){this._autoResizeHandler=this._autoResizeHandler||b.util.bind(this._onAutoResize,this);
g.windowResize.addHandler(this._autoResizeHandler)
}else{g.windowResize.removeHandler(this._autoResizeHandler)
}};
a._onAutoResize=function(){};
a.RESPONSIVE_WIDTH_THRESHOLD=400;
a._isSmallChart=function(h){return h<a.RESPONSIVE_WIDTH_THRESHOLD
};
a.handleError=function(j){var k=this._dataAdapter.l10n;
var h=k.labels.core.erroronrender;
if("invaliddata"===j.code){h=k.labels.core.nodata
}this._setErrorMessage(h);
return this
};
a._setErrorMessage=function(h){if(h&&h.length){d.select(this._options.parent).html('<div class="cv-error">'+h+"</div>")
}else{this._clearErrorMessage()
}};
a._clearErrorMessage=function(){d.select(this._options.parent).select(".cv-error").remove()
};
a.destroy=function(){this.reset();
g.windowResize.removeHandler(this._autoResizeHandler)
};
a.on=function(j,k){var h=k&&b.util.isFunction(k);
if(h){this._eventMap=this._eventMap||{};
this._eventMap[j]=k
}else{if(this._eventMap){delete this._eventMap[j]
}}return this
};
f.cloudViz=g;
g.d3=d;
g.dv=b;
g.rs2dv=f.rs2dv||{};
g.core=a;
g.localeDefinition=function(h,m,l){var n,j,k,o;
h=h.toLowerCase();
g._localeDefinitions=n=g._localeDefinitions||{};
if(arguments.length>1){j=h.split("-");
if(j.length<=1){throw new Error("A registered CloudViz locale must be a hyphenated language culture code (e.g. en-US).")
}k=[h,j[0],j.join("_")];
k.forEach(function(p){if(l==null){n[p]=m
}else{n[p]=n[h]||{};
n[p][l]=m
}})
}else{o=n[h];
if(!o){throw new Error("Locale definition for "+h+" not found.")
}return o
}};
if("function"===typeof define&&define.amd){define(function(){return g
})
}else{if("undefined"===typeof exports){f.cloudViz=g
}else{if("object"!==typeof module||!module.exports){exports.cloudViz=g
}else{module.exports=g
}}}}(this));
(function(a){a.cloudViz.seriesState=function(){var f={},b=[],d={};
f.isSeriesEnabled=function(l,g){if(!b){return true
}var h,j=b.length,k;
for(h=0;
h<j;
h++){k=b[h];
if(k.id===l&&k.type===g){return k.enabled
}}return false
};
f.doesSeriesStateExist=function(l,g){if(!b){return false
}var h,j=b.length,k;
for(h=0;
h<j;
h++){k=b[h];
if(k.id===l&&k.type===g){return true
}}return false
};
f._createStateObject=function(j,l,k,h){var g;
if(arguments.length<3){throw new Error("A state object requires a label and stateType.")
}if(arguments.length<4){h=true
}g={name:j,id:l,type:k,enabled:h};
this.dispatch("create",g);
return g
};
f.insertState=function(h,k,j,g){b.unshift(this._createStateObject.apply(this,arguments))
};
f.appendState=function(h,k,j,g){b.push(this._createStateObject.apply(this,arguments))
};
f.enableStateByIndex=function(h,g){if(h<b.length){var j=b[h];
if(j.enabled!==g){j.enabled=g;
this.dispatch("enableChange",j)
}}};
f.enableStateByTypeAndId=function(l,m,g){var h,j=b.length,k;
for(h=0;
h<j;
h++){k=b[h];
if(k.id===m&&k.type===l){this.enableStateByIndex(h,g)
}}};
f.removeStatesByType=function(h){var g=this;
if(b&&b.length){b=b.filter(function(j){if(j.type===h){g.dispatch("remove",j);
return false
}return true
})
}};
f.on=function(j,l){if(arguments.length<1){throw new Error("series state listeners require an eventType to be specified.")
}var h=j.indexOf("."),g="",k;
if(h>0){g=j.substring(h+1);
j=j.substring(0,h)
}k=d[j]||{};
if(!l){delete k[g]
}else{k[g]=l;
d[j]=k
}};
f.dispatch=function(g,k){var h=d[g];
if(h){for(var j in h){h[j].call(this,g,k)
}}};
f.getStateObjects=function(){return b
};
f.areSomeSeriesDisabled=function(){if(!b){return false
}return(Math.min.apply(null,b.map(function(g){return +g.enabled
}))===0)
};
f.areAllSeriesDisabled=function(){if(!b){return false
}return(Math.max.apply(null,b.map(function(g){return +g.enabled
}))===0)
};
return f
}
})(this);
(function(b){var d=b.cloudViz||{};
var a=d.util=d.util||{};
a.deepExtend=function(g){var f=Array.prototype.slice.call(arguments,1);
var h=-1,l=f.length;
while(++h<l){var j=f[h];
if(j){for(var k in j){if(j[k]&&j[k].constructor&&j[k].constructor===Object){g[k]=g[k]||{};
a.deepExtend(g[k],j[k])
}else{g[k]=j[k]
}}}}return g
};
a.createConstructor=function(f){function g(){var h=Object.create(f);
if("function"==typeof h.init){h.init.apply(h,arguments)
}return h
}g.prototype=f;
return g
};
a.namespace=function(j,h){var g=j.split(".");
var f=h||b;
g.forEach(function(k){var l=f[k];
if(!l){l=f[k]={}
}f=l
});
return f
}
}(this));
(function(g){var h=g.cloudViz||{},a=h.core||{},b=g.dv||{},d=g.d3||{},f=Object.create(a);
f.X_AXIS_LABEL_MAXLENGTH=25;
f.LEGEND_ORIENTATIONS=["top","right","left"];
f._chart=null;
f.clipIdCounter={count:0};
f._legend=null;
f._seriesState=null;
f.init=function(j){Object.getPrototypeOf(f).init.apply(this,arguments);
this._seriesState=h.seriesState();
return this
};
f._initDefaultOptions=function(j){var k={aspectRatio:null,colors:["#8cc350","#5a6eaa","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841"],dateGranularity:undefined,flip:false,interactive:false,legendOrientation:null,legendVerticalWidth:110,legendVisible:true,targetValues:null,targetLabel:undefined,mappings:{x:"x",y:"y",series:"series",seriesLabel:"series"},plotHeight:null,plotWidth:null,preRender:null,xAxisTitle:"",yAxisTitle:"",precision:null};
if(j){this._mergeOptions(k,j)
}return Object.getPrototypeOf(f)._initDefaultOptions.call(this,k)
};
f.getChart=function(){return this._chart
};
f.enableSeriesByIndex=function(k,j){this._seriesState.enableStateByIndex(k,j)
};
f._highlight=function(k,j){k.classed("cv-highlight",j)
};
f._getYTitleFromLabels=function(k){var j=b.util.uniq(k);
if(j&&j.length===1){return j[0]
}return null
};
f._preRender=function(){Object.getPrototypeOf(f)._preRender.call(this);
try{this._createSeriesStates()
}catch(k){var j=new Error("The chart data is invalid");
j.code="invaliddata";
this.handleError(j)
}};
f._postRender=function(){Object.getPrototypeOf(f)._postRender.call(this);
var k=this._options,j=d.select(k.parent);
this._updateYAxisHitBox(j);
this._colorDualYAxes(k,j)
};
f._removeYAxisHitBox=function(j){j.selectAll(".axis-y .cv-axis-hitbox").remove()
};
f._colorDualYAxes=function(k,j){if(k.dualYAxis&&(!this._isNormalized||!this._isNormalized())&&(this._options.position==="identity"||this._options.position==="dodge")){j.selectAll(".axis-y.axis-index-0 span").style("color",k.colors[0]);
j.selectAll(".axis-y.axis-index-1 span").style("color",k.colors[1]);
j.selectAll(".axis-title-y.axis-title-index-0").style("color",k.colors[0]);
j.selectAll(".axis-title-y.axis-title-index-1").style("color",k.colors[1])
}};
f._createSeriesStates=function(){var m=this._options;
if("data" in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");
var k=this._dataAdapter.data()[this._getPropMapping("series")],o=this._dataAdapter.data()[this._getPropMapping("seriesLabel")];
if(k){var l=k.reduce(function(q,s,r){if(q.ids.indexOf(s)<0){q.ids.push(s);
q.names.push(o?o[r]:s)
}return q
},{names:[],ids:[]}),n=l.ids.length;
while(n--){var j=l.names[n],p=l.ids[n];
this._seriesState.insertState(j||p,p,"standard")
}}}if("targetValues" in this._changedOptions){if(m.targetValues){this._seriesState.removeStatesByType("target");
this._seriesState.appendState(m.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target")
}}};
f._createTargetHLines=function(){var s=this._options,p=this._chart,r=this;
if(s.targetValues&&s.targetValues.length){var k=p.layers(),q=b.geom.hline(),n=r._seriesState.isSeriesEnabled("target","target"),l={y:[],name:[]},m,j=s.targetValues.length,o=[0,this._isSmallChart()?24:6];
for(m=0;
m<j;
m++){l.y.push(s.targetValues[m])
}q.data(l).position("identity").map("y","y",b.scale.linear().includeInDomain(function(){if(!r._valuesAreFilterable()){return true
}return n
}).rangePadding(o)).each("start",function(u,t){d.select(this).attr("legend-type","target")
});
if(this._type==="line"){k.unshift(q)
}else{k.push(q)
}p.layers(k)
}};
f._updateYAxisHitBox=function(r){var t=this,v=this._options,k=this._chart.facet().getPanel(0);
if(k){var o=this._isSmallChart(),s=this._isNormalized&&this._isNormalized(),m=this._chart.getTrainedScale("y"),l=m&&m.naturalDomain()[0]<=0,n=k.bounds().left,q=m.range()[1],j=m.range()[0],p=r.selectAll(".axes-labels .axis-y.axis-index-0"),u=p.selectAll(".cv-axis-hitbox").data([0]);
if(v.interactive&&!o&&!s&&!l&&v.position==="identity"){u.enter().append("div").classed("cv-axis-hitbox",true);
u.on("click",function(){if(v.interactive&&!o){t._dataAdapter._forceZero=!t._dataAdapter._forceZero;
t._render(true);
t._postRender()
}});
if(this._legend!=="none"&&this._legend.isVertical()){n-=this._legend.orientation()==="left"?this._legend._getUsedWidth():0
}u.style("width",n+"px").style("height",(j-q)+"px").style("top",q+"px").style("left",(-n)+"px");
u.exit().on("click",null)
}else{this._removeYAxisHitBox(r)
}}else{this._removeYAxisHitBox(r)
}};
f._render=function(j){Object.getPrototypeOf(f)._render.apply(this,arguments);
var l=this._options,k;
try{if(!this._dataAdapter.isDataValid()){k=new Error("The chart data is invalid");
k.code="invaliddata";
throw k
}if(!l.parent){throw new Error("The chart options did not contain a parent")
}return this._draw(j)
}catch(m){this.handleError(m)
}};
f.reset=function(){Object.getPrototypeOf(f).reset.apply(this,arguments)
};
f.destroy=function(){Object.getPrototypeOf(f).destroy.apply(this,arguments);
if(this._options&&this._options.parent){d.select(this._options.parent).select(".cv-wrapper").remove()
}return this
};
f._isMappedAndExistsInData=function(k){var j=this._getPropMapping(k);
return j&&this._options.data[j]
};
f._setChartCoreOptions=function(){var r=this._options,l=this._chart,q=this,o=r.aspectRatio,k=r.width,p=r.height,n=d.select(r.parent);
l.data(this._dataAdapter.data()).width((o!==null&&p!==null)?p*o:k).height((o!==null&&k!==null)?k/o:p);
var j=n.selectAll(".cv-wrapper").data([0]);
j.enter().insert("div",":first-child").classed("cv-wrapper",true);
j.attr("data-chart-type",this._type);
j.classed({interactive:r.interactive,"right-overflow":(this._adjustClipWidth),"cv-small-chart":(this._isSmallChart())});
l.parent(j.node());
this._legend=this._buildLegend();
this._seriesState.on("enableChange.paths",function(s,t){q._preRender();
q._render(true);
q._postRender();
setTimeout(function(){q._updatePathStates()
},10)
});
if(!this._isSmallChart()){var m={left:10};
if(r.dualYAxis){m.right=10
}l.padding(m)
}else{l.padding({})
}};
f._draw=function(j){var m=this._chart,l=this._options,k=(j===undefined)?false:j;
if(!m){throw new Error("DV Chart was not created")
}this._setChartCoreOptions();
this._setChartTypeOptions();
this._createTargetHLines();
if(this._isSmallChart()){this._drawSmall()
}else{this._drawLarge()
}if(!k){m.duration(0)
}else{m.duration(1000)
}this._renderChart();
return this
};
f._drawBackground=function(){var n=this._options;
if(n.interactive){var s=d.select(n.parent).select(".cv-wrapper"),l=s.selectAll(".cv-bg").data([0]),m=this._legend==="none"?null:this._legend.orientation();
l.enter().insert("div",":first-child").classed("cv-bg",true);
var w=this._chart,k=d.select(n.parent).select(".cv-legend"),A=((this._legend!=="none"&&this._legend.isVertical())||k.empty())?0:1,E=1,t=w.padding(),o=w.facet().getPanel(w.facet()._panels.length-1).bounds(),r=w.plotBounds(),v=this._chart._legends&&this._chart._legends.hasOwnProperty("_w")?this._chart._legends._w:0,q=m==="left"||(!m&&this._legend.isVertical())?v:0,p=r.top-A-t.top,C=w._calcWidth-q-(m==="right"?v:0),z=(o.top+o.height)-r.top+A+t.top;
l.style("top",p+"px").style("left",q+"px").style("height",(z+E)+"px").style("width",C+"px");
if(this._legend!=="none"&&this._legend.isVertical()){var D=1,B=d.select(n.parent).selectAll(".cv-legend"),u=!k.empty()&&B.node().offsetHeight||0,j=(u>=z-D);
B.style("height",j?(z-D)+"px":null).classed("clipped",j)
}}};
f._drawClipping=function(){var p=this._chart,w=this._options,o=p._svgContainer,n=o.selectAll("defs").data([0]);
n.enter().insert("defs",":first-child");
var k="cv-clip"+(this.clipIdCounter.count++),m=n.selectAll(".cv-clip").data([0]);
m.enter().append("clipPath").classed("cv-clip",true).append("rect");
m.attr("id",k);
var r=m.selectAll("rect"),t=p.padding(),l=p.facet().getPanel(p.facet()._panels.length-1).bounds(),u=p.plotBounds(),s=u.left-t.left,q=u.top,j=u.right-s+t.right,v=(l.top+l.height)-u.top+1;
if(w.interactive){j-=1;
v-=1
}if(this._adjustClipHeight){v+=this._adjustClipHeight
}if(this._adjustClipWidth){j+=this._adjustClipWidth
}r.attr("x",s).attr("y",q).attr("width",Math.max(j,0)).attr("height",Math.max(v,0));
o.selectAll(".geom").attr("clip-path",null);
o.selectAll(".geom:not(.no-clip)").attr("clip-path","url(#"+k+")")
};
f._renderChart=function(){var j=this,k=this._options;
if("function"==typeof k.preRender){k.preRender(this.getChart())
}this._chart.render();
this._drawBackground();
this._drawClipping();
setTimeout(function(){j._updatePathStates()
},10)
};
f._onAutoResize=function(){this._draw(false)
};
f._setChartTypeOptions=function(){};
f._drawSmall=function(j){};
f._drawLarge=function(j){};
f._isSmallChart=function(){return Object.getPrototypeOf(f)._isSmallChart.apply(this,[this._getChartWidth()])
};
f._getChartWidth=function(){var k=this._options,j=d.select(k.parent),n=j.select(".cv-wrapper");
if(n.empty()){n=j
}if(k.plotWidth!==null&&!b.util.isPercentString(k.plotWidth)){return k.plotWidth
}else{if(k.width!==null&&!b.util.isPercentString(k.width)){return k.width
}}var m=n.node().offsetWidth;
var l=n.node().offsetHeight;
if(k.plotWidth!==null){return parseInt(k.plotWidth,10)/100*m
}else{if(k.width!==null){return parseInt(k.width,10)/100*m
}else{return(k.aspectRatio!==null&&l!==null)?l*k.aspectRatio:m
}}};
f._getChartHeight=function(){var j=this._options;
if(j.plotHeight!==null&&!b.util.isPercentString(j.plotHeight)){return j.plotWidth
}else{if(j.height!==null&&!b.util.isPercentString(j.height)){return j.height
}}var l=d.select(j.parent).node().offsetWidth;
var k=d.select(j.parent).node().offsetHeight;
if(j.plotHeight!==null){return parseInt(j.plotHeight,10)/100*k
}else{if(j.height!==null){return parseInt(j.height,10)/100*k
}else{return(j.aspectRatio!==null&&l!==null)?l/j.aspectRatio:k
}}};
f._constructScale=function(k,m){var l=m||b.scale.linear(),j=this._options;
if(j.interactive){l=this._adjustLimits(l)
}if(k==="y"&&this._dataAdapter._forceZero){this._applyForceZero(l)
}return l
};
f._applyForceZero=function(j){j.lowerLimit(function(l,k){return l<0?l:0
});
j.upperLimit(function(l,k){return k>0?k:0
});
return j
};
f._adjustLimits=function(l){var j=this,k=this._options;
l.includeInDomain(function(n,m){if(!j._valuesAreFilterable()){return true
}return j._seriesState.isSeriesEnabled(n.data[j._legend.mapping()],"standard")
});
return l
};
f._valuesAreFilterable=function(){return(this._options.interactive&&this._seriesState.areSomeSeriesDisabled()&&!this._seriesState.areAllSeriesDisabled())
};
f._getEnabledValues=function(n){var k=this,m=this._options,j=this._dataAdapter.data()[this._getPropMapping(n)];
if(!this._valuesAreFilterable()){return j
}var l=this._dataAdapter.data()[this._legend.mapping()];
j=j.filter(function(o,p){return(l[p]&&k._seriesState.isSeriesEnabled(l[p],"standard"))
});
return j
};
f._updatePathStates=function(){var j=this,k=this._options,l=d.select(k.parent);
l.selectAll(".plot .series [legend-group]").classed("path-inactive",function(){if(!k.interactive){return false
}var n=d.select(this),o=n.datum(),m=b.util.isArray(o)?o[0].data:o.data,p=m[j._getPropMapping("series")];
if(j._seriesState.doesSeriesStateExist(p,"standard")){return !j._seriesState.isSeriesEnabled(p,"standard")
}return n.classed("path-inactive")
});
if(k.targetValues){l.selectAll(".plot .series [legend-type]").classed("path-inactive",function(){if(!k.interactive){return false
}var n=d.select(this),m=n.attr("legend-type");
if(j._seriesState.doesSeriesStateExist("target",m)){return !j._seriesState.isSeriesEnabled("target",m)
}return n.classed("path-inactive")
})
}};
f._buildLegend=function(r,m){var p=null,s=this._options,j=d.select(s.parent).select(".cv-wrapper"),k=this._getPropMapping(r||"series"),l=this._getPropMapping(m||"seriesLabel");
if(k&&l&&k!==l){var o=this._dataAdapter.data(),n=o[k],q=o[l]||n;
p=[];
n.forEach(function(u,w,t){if(t.indexOf(u)===w){p.push(q[w])
}})
}if(!s.legendVisible){j.selectAll(".cv-legend").remove();
j.selectAll(".cv-bg").remove();
return"none"
}if(s.interactive){return this._buildInteractiveLegend(p)
}else{return this._buildStandardLegend(p)
}};
f._buildStandardLegend=function(o){var l=this._options,j=d.select(l.parent).select(".cv-wrapper");
this._legend=null;
j.selectAll(".cv-legend").remove();
j.selectAll(".cv-bg").remove();
var n,k=this.LEGEND_ORIENTATIONS.indexOf(l.legendOrientation)>-1?l.legendOrientation:"top";
switch(this._calculatedLegendOrientation){case"top":case"bottom":n={top:5,bottom:5,left:0,right:0};
break;
case"left":case"right":n={top:0,bottom:0,left:5,right:5};
break
}var m=b.guide.legend().orientation(k).padding(n);
if(o){m.labels(o)
}if(this._isSmallChart()){m.hGap(10).vGap(2)
}return m
};
f._buildInteractiveLegend=function(o){var m=this._options,l=this,k=d.select(m.parent).select(".cv-wrapper");
if(!this._legend){this._legend=h.interactiveLegend()
}var j=this._dataAdapter.data()[this._getPropMapping("series")],n=j.some(function(p,q,r){return p!==r[q-1]
});
if(!n){this._legend.remove();
k.selectAll(".path-inactive").classed("path-inactive",false);
return"none"
}this._legend.parent(k.node()).orientation(m.legendOrientation).chartWidth(this._getChartWidth()).chartHeight(this._getChartHeight()).chartPadding(this._chart.padding()).validOrientations(this.LEGEND_ORIENTATIONS).legendVerticalWidth(m.legendVerticalWidth).type(this._type).seriesState(this._seriesState);
if(o){if(this._getCategoryTotal){this._legend.totals(o.map(function(p){return this._getCategoryTotal(p)
}))
}}return this._legend
};
f._numXTicks=function(){return function(j){return Math.max(j/120,2)
}
};
f._yTitleFormat=function(m,k){var j=this._dataAdapter,q=j.yAxisTitle(),l=j.l10n,p=this._getYFormatType(m),o,n;
if("time"===p){if(!k){k=this._getEnabledValues("y")
}o=this._yTimeGranularity(k,b.guide.axis().ticks()());
o=l.time.plural[o.gran];
n=(q)?l.labels.dvcore.yAxisTimeWithTitle:l.labels.dvcore.yAxisTimeNoTitle;
q=n.replace(/\{time\}/i,o).replace(/\{title\}/i,q)
}return q
};
f._formatYValue=function(l,k,m,j){if(m&&m.divisor>0){l=l/m.divisor
}return this._formatNumber(k,l,j)
};
f._getYFormatType=function(j){var k=this._dataAdapter.formats().y;
if(!k){return"decimal"
}if(b.util.isArray(k)){if(!k[j]){return"decimal"
}return k[j]
}return k
};
f._yLabelFormat=function(n){var l=this._getYFormatType(n),j=this._dataAdapter,m=this._options,k=this;
return function(s,p){var r,q,o=j.l10n.time;
if("time"===l){q=j.getTimeGranularity(s,true);
o=(1!==+s)?o.plural:o.singular
}r=k._formatYValue(s,l,q,m.precision);
if(q&&q.gran){r+=" "+o[q.gran]
}return r
}
};
f._yTickFormat=function(n,k){var j=this,l=this._getYFormatType(n),m=this._options,o;
if("time"===l){if(!k){k=this._getEnabledValues("y")
}o=j._yTimeGranularity(k,b.guide.axis().ticks()())
}return function(q,p){if(!q){return""
}return j._formatYValue(q,l,o,m.precision)
}
};
f._yTimeGranularity=function(l,o){l=l&&l.filter(function(q){return isFinite(q)
})||[];
o=o||1;
if(!l.length){return null
}var k=Math.max.apply(null,l),m=Math.min.apply(null,l),j=d.scale.linear().domain([m,k]).ticks(o),p=j.length?(j.length>1)?j[1]-j[0]:k-j[0]:k,n=j.length?(p/j.length):p;
return this._dataAdapter.getTimeGranularity(n)
};
f._xTickAnchor=function(j){return function(q,l,r){var p=j.getTrainedScale("x"),k=b.util.scaleRange(p),o=20;
var m=p.mapValue(q)+p.rangeBand()/2;
if(m-k[0]<o){return"start"
}if(k[1]-m<o){return"end"
}return"middle"
}
};
f._checkNormalized=function(){var k=this._chart,j=this._dataAdapter.l10n;
if(this._isNormalized&&this._isNormalized()){k.guide("y","none",1);
k.guide("y",b.guide.axis().ticks(0).tickFormat(function(m,l){return""
}).title(j.labels.core.normalized));
k.padding({})
}};
f._formatTime=function(l,v,q){var w=this._dataAdapter.l10n.calendar;
var o={a:function(j){return w.weekdayAbbreviations[j.getDay()]
},A:function(j){return w.weekdays[j.getDay()]
},b:function(j){return w.monthAbbreviations[j.getMonth()]
},B:function(j){return w.months[j.getMonth()]
},p:function(j){return w.ampm[Math.floor(j.getHours()/12)]
}};
var u="",t=-1,p=0,k=v.length;
var s=function(){var j=v.substring(p,t);
if(j.length){u+=d.time.format(j)(l)
}};
while(++t<k){if(v.charCodeAt(t)==37){var m=v.charAt(t+1);
var r=o[m];
if(r){s();
u+=r(l);
t++;
p=t+1
}}}s();
if("hour"===q&&0===u.indexOf("0")){u=u.slice(1)
}return u
};
f._timeGranTemplate=function(j,l){var k;
switch(j){case"hour":k=l.hour;
break;
case"day":k=l.day;
break;
case"week":k=l.week;
break;
case"month":k=l.month;
break;
case"quarter":k=l.quarter;
break;
case"year":k=l.year;
break;
default:k=l.fallback;
break
}return k
};
f._timeSmallXFormat=function(){var k=this,j=k._dataAdapter,l=j.l10n.dateFormat.fullFormat;
return function(n,m){return k._formatTime(n,l.condensed)
}
};
f._timeXTickFormat=function(r){var t=this,u=t._options,p=this._chart,s=t._dataAdapter,m=new Date(0),q="",j="",k=s.l10n.dateFormat,o=k.mediumFormat,n=s?s.dateGranularity():"*",l=this._timeGranTemplate(n,k.shortFormat);
return function(C,z){var A,B,v,w;
C=new Date(C);
if(0===z){m=new Date(0);
q=null;
j=null
}if(r&&!r.call(this,C,z)){return""
}if("hour"===n&&m.getDate()!==C.getDate()){A=o.day
}if(("day"===n||"week"===n)&&m.getMonth()!==C.getMonth()){A=o.month
}if(("month"===n||"quarter"===n)&&m.getYear()!==C.getYear()){A=o.year
}m=C;
B=t._formatTime(C,l,n);
if(A){v="<br/>"+t._formatTime(C,A)
}else{v="<br/>&nbsp;"
}if(B===q&&(v===j||!A)){w=""
}else{w=(v)?B+v:B
}q=B;
j=v;
return w
}
};
g.cloudViz.dvcore=f
}(this));
(function(h){var g,d=[];
var b=function(k,l){var m=-1;
return function(){if(m>-1){window.clearTimeout(m)
}m=window.setTimeout(k,l)
}
};
var f=b(function(){d.forEach(function(k){k()
})
},30);
var j=function(k){if(d.indexOf(k)==-1){d.push(k)
}if(!g){window.addEventListener("resize",f);
g=true
}};
var a=function(l){var k=d.indexOf(l);
if(k>-1){d.splice(k,1)
}if(d.length===0&&g){window.removeEventListener("resize",f);
g=false
}};
h.cloudViz.windowResize={addHandler:j,removeHandler:a}
}(this));
(function(g){var h=g.cloudViz||{},f=h.dvcore||{},b=g.dv||{},d=g.d3||{},a=Object.create(f),j=-1;
a.init=function(k){Object.getPrototypeOf(a).init.apply(this,arguments);
this._type="line";
this._chart=b.chart();
this._displayPoints=null;
this._adjustClipHeight=6;
this._adjustClipWidth=6;
this._minTrendTickSpace=135;
this._showRibbons=false;
this._uniqueGroups=null;
return this
};
a._initDefaultOptions=function(){var k={normalized:false,filled:false,position:"identity",forceZero:null,dualYAxis:false,showAnomalies:false,mappings:{upperRangeBand:"upper",lowerRangeBand:"lower",forecast:"forecast"},formats:{x:"decimal",y:"decimal"}};
return Object.getPrototypeOf(a)._initDefaultOptions.call(this,k)
};
a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments);
var l=this._options;
var k=d.select(l.parent);
k.selectAll(".behavior").text("");
k.selectAll(".behavior-under-geom").text("");
this._chart.on("mousemove.inspector",null);
this._chart.on("mouseout.inspector",null);
k.selectAll(".axis-y.axis-index-1").remove()
};
a._setChartTypeOptions=function(){var n=this._chart,m=this._options,k=this,p=[b.geom.line().each("start",function(r,q){d.select(this).attr("legend-group",r[0]["stroke"])
}).map("stroke",this._getPropMapping("series"),b.scale.color().values(m.colors))];
this._uniqueGroups=b.util.uniq(n.data()[this._getPropMapping("series")]);
this._showRibbons=(this._uniqueGroups.length==1&&this._isMappedAndExistsInData("upperRangeBand")&&this._isMappedAndExistsInData("lowerRangeBand"));
if(this._showRibbons){p.unshift(b.geom.ribbon().map("yMin",this._getPropMapping("lowerRangeBand")).map("yMax",this._getPropMapping("upperRangeBand")).set("alpha",0.15).interpolate("cardinal"));
m.filled=false
}if(this._showRibbons&&this._isMappedAndExistsInData("forecast")){p.push(b.geom.line().map("y",this._getPropMapping("forecast")).set("alpha",0.5).set("linetype","dotted").interpolate("cardinal"))
}if(m.filled){p.push(b.geom.area().baseline(undefined).each("start",function(r,q){d.select(this).attr("legend-group",r[0]["fill"])
}).map("fill",this._getPropMapping("series"),b.scale.color().values(m.colors)).set("alpha",0.2))
}var o=b.geom.point().map("stroke",this._getPropMapping("series"),b.scale.color().values(m.colors)).set("fill","#fff").set("size",7);
p.push(o);
var l=this._getPropMapping("group")||this._getPropMapping("series");
n.layers(p).guide("stroke",this._legend).map("group",l).set("linetype",function(s,r,q){return(/::incomplete::$/).test(s.data[l])?"0,4,7,0":"solid"
}).position(m.position);
o.each("start",function(r,q){d.select(this).classed("point-hidden",!k._shouldDisplayPoint.call(k,r)).attr("legend-group",r.stroke).classed("line-point",true)
});
this._addBehaviors(n,m);
this._mapPositionScales(n,m)
};
a._shouldDisplayPoint=function(k){return(this._showRibbons)?this._isAnomalousDataPoint(k):this._shouldDisplayPoints()
};
a._shouldDisplayPoints=function(){if(this._displayPoints!==null){return this._displayPoints
}var m=this._options,n=this._chart,o=n.layers()[1]._nestData,k=Math.max.apply(null,o.map(function(p){return p.values.length
})),l=n.getTrainedScale("x").range();
return this._displayPoints=(m.showAnomalies&&this._showRibbons)||(((l[1]-l[0])/k)>=60)
};
a._isAnomalousDataPoint=function(k){return(k.data[this._getPropMapping("y")]>k.data[this._getPropMapping("upperRangeBand")]||k.data[this._getPropMapping("y")]<k.data[this._getPropMapping("lowerRangeBand")])
};
a._addBehaviors=function(p,n){var m=this,k=d.select(n.parent),l=this._dataAdapter,o=l.formats().x;
if(n.interactive){p.behaviors([b.behavior.inspector().gutterPadding(0).orientation("bottom").thickness(2).label(function(s){if(l.isOvertime()){var q=l.dateGranularity(),r=l.l10n.dateFormat.fullFormat;
return m._formatTime(s,m._timeGranTemplate(q,r),q)
}return m._formatNumber(o,s,n.precision)
}).inspectorMove(function(s,q,u,t){var r=p.getTrainedScale("stroke")[0];
m._highlightHoveredPoints.call(m,k,t,r);
k.selectAll(".axis-x .axis-label").style("opacity",0);
k.selectAll(".axis-x-title").style("opacity",0);
k.selectAll(".text-geom").style("opacity",0);
if(m._eventMap.mouseover){m._eventMap.mouseover.call(this,s,q,u,t,d.event)
}}).inspectorOut(function(){var q=p.getTrainedScale("stroke")[0];
m._highlightHoveredPoints.call(m,k,null,q);
k.selectAll(".axis-x .axis-label").style("opacity",1);
k.selectAll(".axis-x-title").style("opacity",1);
k.selectAll(".text-geom").style("opacity",1);
if(m._eventMap.mouseout){m._eventMap.mouseout.call(this,d.event)
}}).underGeoms(true)])
}};
a._highlightHoveredPoints=function(n,q,m){var l={},k=this,p=m.domain(),o=this._options;
n.selectAll(".line-point").each(function(w){var t=d.select(this),s=m.mapValue(w.stroke),u=k._dataValuesEqual.call(k,w.x,q),r=t.datum();
t.classed("point-hidden",u?false:!k._shouldDisplayPoint.call(k,w));
t.style("fill",u?s:"#FFF").style("opacity",u?1:"");
if(u){var v=t.datum().data[k._getPropMapping("series")];
l[v]={yVal:r.y,scaleIndex:p.indexOf(w.stroke)}
}});
n.selectAll(".cv-legend-entry").each(function(w){var B=w.id,t=l[B],s=d.select(this).select(".cv-legend-num");
if(!t){return s.text("")
}var z=k._getYFormatType(t.scaleIndex),A=t.yVal,C;
if("time"===z){var D=k._dataAdapter.l10n,v=k._yTimeGranularity(k._dataAdapter.getUniqueStrokeExtentByStroke(B),b.guide.axis().ticks()()),r=D.time.plural[v.gran],u=D.labels.dvcore.legendTime;
if(v&&v.divisor>0){A=A/v.divisor
}C=u.replace(/\{time\}/i,r).replace(/\{value\}/i,k._formatNumber(z,A,o.precision))
}else{C=k._formatNumber(z,A,o.precision)
}s.text(C)
})
};
a._dataValuesEqual=function(l,k){if(!l||!k){return false
}if(this._dataAdapter.isOvertime()&&l.getTime()===k.getTime()){return true
}return l===k
};
a._mapPositionScales=function(p,u){var o=[0,this._isSmallChart()?24:6],m=this._constructScale("y").rangePadding(o),l=this._getPropMapping("series"),s=this._getPropMapping("y"),k=this._getPropMapping("x"),t=this;
if(t._dataAdapter._forceZero===null&&u.filled){t._dataAdapter._forceZero=true;
this._applyForceZero(m)
}if(u.normalized||(u.dualYAxis&&(u.position==="identity"||u.position==="dodge"))){var q=t._dataAdapter.uniqueStrokeValues();
q.forEach(function(z,w){var v=(0===w)?m:m.copy();
v.includeInDomain(function(B,A){return B.data[l]===t._dataAdapter.uniqueStrokeValues()[w]
});
if(w>0){p.map("y",s,v,w)
}})
}else{var n=p.getExplicitScalesMap().y;
if(n){delete n[1]
}}var r=this._dataAdapter.isOvertime()?b.scale.time():b.scale.linear();
r.rangePadding([10,10]);
p.map("y",s,m,0);
p.map("x",k,this._constructScale("x",r))
};
a._xTickFormat=function(){var l=this,k=this._dataAdapter,m=this._options,n=k.formats().x;
return function(p,o){return l._formatNumber(n,p,m.precision)
}
};
a._drawSmall=function(){var w=this._options,r=this._chart,u=this,q=this._computeExtents(),n=d.extent(this._getEnabledValues("x")),p=this._getYFormatType(0),t=function(A,z){return A?u._formatNumber(p,A,w.precision):"0"
},m=b.guide.axis().tickSize(0).title(this._dataAdapter.xAxisTitle()).tickDy(q.y.length>1?-26:-14).tickAnchor(function(A,z){return z>0?"end":"start"
}),k=b.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()),v=w.dualYAxis||(w.position==="stack"&&this._uniqueGroups.length>1);
if(!v){var o=[b.geom.point().data(q).set("stroke","none").map("y","y",b.scale.linear()).map("x","x",this._dataAdapter.isOvertime()?b.scale.time():b.scale.linear()).each("start",function(C,z){var B=C.panel.getTrainedScale("fill")[0],A=d.select(this);
A.style("fill",B.mapValue(C.data.fill)).attr("legend-group",C.data.fill)
}).map("group","fill").set("size",6),b.geom.text().data(q).set("stroke","none").map("y","y",b.scale.linear()).map("x","x",this._dataAdapter.isOvertime()?b.scale.time():b.scale.linear()).each("start",function(C,z){var B=C.panel.getTrainedScale("fill")[0],A=d.select(this);
A.style("fill",B.mapValue(C.data.fill)).attr("legend-group",C.data.fill);
if(this.parentNode){d.select(this.parentNode.parentNode).classed("no-clip",true).attr("clip-path",null)
}}).map("group","fill").set("size","11px").set("label",function(F,C,B){var A=F.panel.getTrainedScale("fill")[0].domain(),z=A.indexOf(F.data.fill),D=u._yTickFormat(z)(F.y);
if("time"===p){var E=u._yTimeGranularity(u._getEnabledValues("y"),b.guide.axis().ticks()());
D+=" "+u._dataAdapter.l10n.time.plural[E.gran]
}return D
}).textAnchor(function(A,z){return A.data&&A.data.anchor||"middle"
}).dy(function(A,z){return(q.y.length===1||A.y===q.y[1])?-8:15
}).dx(function(A,z){return(A.data&&A.data.anchor=="end")?3:0
})];
r.layers(r.layers().concat(o))
}r.map("fill",this._getPropMapping("series"),b.scale.color().values(w.colors));
if(this._dataAdapter.isOvertime()){m.tickValues(n).tickFormat(u._timeSmallXFormat());
if(v){k.tickFormat(this._yTickFormat(0))
}else{k.tickFormat(function(){return""
})
}}else{if(w.dualYAxis){var s=b.guide.axis().tickFormat(this._yTickFormat(1)).orientation("right").tickSize(15).tickDy(-8).tickAnchor("end").tickDx(4).ticks(3);
k.tickSize(15).tickDy(-8).tickAnchor("start").tickDx(4).ticks(3);
r.guide("y",s,1)
}else{var l=d.extent(this._dataAdapter.data()[this._getPropMapping("x")]);
m.tickValues(l).tickFormat(this._xTickFormat());
k.tickFormat(this._yTickFormat(0));
r.guide("y","none",1)
}}r.guide("x",m).guide("y",k);
this._checkNormalized()
};
a._numXTicks=function(){var k=this;
if(this._dataAdapter.isOvertime()){var l=this._chart._data[this._getPropMapping("x")].length;
return function(m){var o=0;
var n=Math.max(m/l,k._minTrendTickSpace);
return Math.max(Math.min(Math.floor(m/n),l),2)
}
}return Object.getPrototypeOf(a)._numXTicks.call(this)
};
a._drawLarge=function(){var t=this._options,p=this._chart,r=d.select(t.parent),q=false,n=this._dataAdapter.getUniqueStrokeExtent(0),m=this._dataAdapter.getUniqueStrokeExtent(1),o,l=b.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickDy(-8).tickAnchor(this._xTickAnchor(p)),k=b.guide.axis().htmlLabels(true);
if(this._dataAdapter.isOvertime()){l.tickFormat(this._timeXTickFormat()).htmlLabels(true)
}else{l.tickFormat(this._xTickFormat())
}if(t.dualYAxis&&(t.position==="identity"||t.position==="dodge")){o=this._yTickFormat(0,n);
k.title(this._yTitleFormat(0,n));
var s=b.guide.axis().tickFormat(this._yTickFormat(1,m)).title(this._yTitleFormat(1,m)).orientation("right").tickSize(15);
k.tickSize(15);
p.guide("y",s,1)
}else{o=this._yTickFormat(0);
k.title(this._yTitleFormat(0));
p.guide("y","none",1)
}k.tickFormat(function(z,v){var u=d.select(this),w=k._scale();
if(w instanceof b.scale.linear&&z>0&&(v===0||(v===1&&q))){if(w.mapValue(z)<w.range()[0]-10||!t.interactive){u.classed("arrow-container",true)
}else{q=true;
u.classed("arrow-container",false);
return""
}}else{u.classed("arrow-container",false)
}return o.call(this,z,v)
});
p.guide("x",l).guide("y",k);
this._checkNormalized()
};
a._preRender=function(){Object.getPrototypeOf(a)._preRender.call(this);
this._displayPoints=null
};
a._computeExtents=function(){var p=-1,w=this._options,r=this._getEnabledValues("y"),m=this._getEnabledValues("x"),o=this._getEnabledValues("series"),k=r.length,v={x:[undefined,undefined],y:[undefined,undefined],fill:[undefined,undefined],anchor:[undefined,undefined]},q=null,t=null;
m.forEach(function(n,z){q=(q===null||q>n)?n:q;
t=(t===null||t<n)?n:t
});
while(++p<k){var s=r[p],u=m[p],l=o?o[p]:w.colors[0];
if(v.y[0]===undefined||s<v.y[0]){v.y[0]=s;
v.x[0]=u;
v.fill[0]=l;
v.anchor[0]=(+u==+q)?"start":(+u==+t)?"end":"middle"
}if(v.y[1]===undefined||s>v.y[1]){v.y[1]=s;
v.x[1]=u;
v.fill[1]=l;
v.anchor[1]=(+u==+q)?"start":(+u==+t)?"end":"middle"
}}if(v.y[0]===0){v.y.splice(0,1);
v.x.splice(0,1);
v.fill.splice(0,1);
v.anchor.splice(0,1)
}return v
};
a._isNormalized=function(){var l=this._options,k=this._isSmallChart()?1:2;
return l.normalized||(l.dualYAxis&&this._dataAdapter.uniqueStrokeValues().length>k&&(l.position==="identity"||l.position==="dodge"))
};
g.cloudViz.line=h.util.createConstructor(a)
}(this));
(function(g){var h=g.cloudViz||{},f=h.dvcore||{},b=g.dv||{},d=g.d3||{},a=Object.create(f);
a.init=function(j){Object.getPrototypeOf(a).init.apply(this,arguments);
this._type="point";
this._chart=b.chart();
return this
};
a.getSelected=function(){var k=[],j=d.select(this._options.parent).selectAll(".point-geom.cv-highlight");
j.each(function(l){k.push(l)
});
return k
};
a.setSelected=function(m){var j=this,l=[],k=d.select(this._options.parent).selectAll(".point-geom").filter(m);
k.each(function(n){l.push(n)
});
j._selectPoints(l);
return j
};
a._selectPoints=function(k,l){var j=this;
if(!l||!l.accumulate){if(!l||k.length!==0){d.select(j._options.parent).selectAll(".point-geom").each(function(m){if(k.indexOf(m)>=0){j._highlight(d.select(this),true)
}else{j._highlight(d.select(this),false)
}})
}else{if(l.noneSelected==="selectAll"){j._highlight(d.select(j._options.parent).selectAll(".point-geom"),true)
}}}else{if(l.action==="add"){d.select(j._options.parent).selectAll(".point-geom").each(function(m){if(k.indexOf(m)>=0){j._highlight(d.select(this),true)
}})
}else{if(l.action==="remove"){d.select(j._options.parent).selectAll(".point-geom").each(function(m){if(k.indexOf(m)>=0){j._highlight(d.select(this),false)
}})
}}}return j
};
a._initDefaultOptions=function(){var j={mappings:{size:"size"},sizeTitle:"",formats:{x:"decimal",y:"decimal",size:"decimal"},selectionEnabled:false,selectPolicyCB:function(){return{start:null,end:null,move:null}
},tooltipContent:null};
return Object.getPrototypeOf(a)._initDefaultOptions.call(this,j)
};
a._setChartTypeOptions=function(){var l=this._chart,k=this._options,m=[],j=this;
m[0]=b.geom.point().each("start",function(o,n){d.select(this).attr("legend-group",o.fill)
});
l.layers(m).map("x",this._getPropMapping("x"),this._constructScale("x").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("y",this._getPropMapping("y"),this._constructScale("y").rangePadding([this._isSmallChart()?10:20,this._isSmallChart()?10:20])).map("fill",this._getPropMapping("series"),b.scale.color().values(k.colors)).guide("fill",this._legend).padding({left:10});
if(this._dataAdapter.isBubble()){m[0].map("size",this._getPropMapping("size"),b.scale.linear().to([9,60]))
}else{m[0].set("size",10).set("alpha",0.6)
}this._addBehaviors(l,m[0],k)
};
a._addBehaviors=function(m,o,r){var p=d.select(r.parent),k,q=this,l=this._getYFormatType(),n=function(v,u,s,t){if(!v.data.hasOwnProperty(u.mapping())){return""
}return'<span class="metric-value">'+s(v.data[u.mapping()])+'</span><span class="metric-name">'+t+"</span>"
},j=function(v,u,s){var w=[];
d.select(r.parent).selectAll(".point-geom").each(function(A,z){if(u[0][0]<=A.x&&u[1][0]>=A.x&&u[0][1]<=A.y&&u[1][1]>=A.y){if(q._seriesState.isSeriesEnabled(A.data.group,"standard")||q._seriesState.isSeriesEnabled(A.data[q._getPropMapping("series")],"standard")){w.push(A)
}}});
var t=q._options.selectPolicyCB.call();
q._selectPoints(w,t[v]);
if(q._eventMap.selectionStart&&v==="start"){q._eventMap.selectionStart.call(q,w)
}if(q._eventMap.selectionEnd&&v==="end"){q._eventMap.selectionEnd.call(q,w)
}};
if(r.selectionEnabled){m.behaviors([b.behavior.brush().brushStart(j).brushMove(j).brushEnd(j)])
}else{m.behaviors([])
}if(!this._isSmallChart()&&r.interactive){o.behaviors([b.behavior.voronoiRollover().pointDetectionRadius(25).content(function(z,u,t){if(r.tooltipContent){return r.tooltipContent.call(this,z,u,t)
}var A=this.__geom.getExplicitScale("group"),D=z.panel.xScale(z),B=z.panel.yScale(z),C=this._xGuides[D.scaleIndex()],s=this._yGuides[B.scaleIndex()],G=q._dataAdapter.l10n,E=(C.__scale&&C.tickFormat()?C.tickFormat():String),v=function(H){return q._formatNumber(l,H,r.precision)
},w=n(z,B,v,q._dataAdapter.yAxisTitle()||G.labels.point.yScale)+n(z,D,E,q._dataAdapter.xAxisTitle()||G.labels.point.xScale);
if(q._dataAdapter.isBubble()){var F=z.panel.getTrainedScale("size")[0];
w+=n(z,F,String,q._dataAdapter.sizeMetricName()||G.labels.point.sizeScale)
}if(A&&A.mapping()){w='<span class="series-name">'+z.data[A.mapping()]+"</span>"+w
}return w
}).mouseOver(function(v,t,s,u){clearTimeout(k);
p.selectAll(".point-geom").classed("cv-medium-duration",false).classed("cv-unselected",function(w){return v!==w
});
p.selectAll(".cv-legend-marker").classed("cv-unselected",function(w){return w.id!==v.fill
}).classed("cv-medium-duration",false);
if(q._eventMap.mouseover){q._eventMap.mouseover.call(this,v,t,s,u)
}}).mouseOut(function(v,t,s,u){k=setTimeout(function(){p.selectAll(".point-geom, .cv-legend-marker").classed("cv-unselected",false).classed("cv-medium-duration",true);
if(q._eventMap.mouseout){q._eventMap.mouseout.call(this,v,t,s,u)
}},400)
})])
}};
a._drawSmall=function(){var n=this._chart,k=d.extent(this._getEnabledValues("x")),l=this,j=this._dataAdapter,p=this._options,m=j.formats().x,o=this._getYFormatType();
n.guide("x",b.guide.axis().tickSize(0).tickValues(k).title(this._dataAdapter.xAxisTitle()).tickFormat(function(q){return l._formatNumber(m,q,p.precision)
}).tickAnchor(function(r,q){return q>0?"end":"start"
})).guide("y",b.guide.axis().ticks(2).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(q){return !q?"":l._formatNumber(o,q,p.precision)
}))
};
a._drawLarge=function(){var n=this._chart,l=function(q){return Math.max(2,Math.min(5,q/70))
},k=this,j=this._dataAdapter,p=this._options,m=j.formats().x,o=this._getYFormatType();
n.guide("x",b.guide.axis().ticks(this._numXTicks()).title(this._dataAdapter.xAxisTitle()).tickFormat(function(q){return k._formatNumber(m,q,p.precision)
})).guide("y",b.guide.axis().ticks(l).title(this._dataAdapter.yAxisTitle()).tickDy(-8).tickFormat(function(q){return !q?"":k._formatNumber(o,q,p.precision)
}))
};
a._postRender=function(){Object.getPrototypeOf(a)._postRender.call(this);
var m=this._options,n=this._chart,k=5,j=d.select(m.parent).select(".cv-wrapper"),l=j.selectAll(".cv-bubble-size-metric").data([0]);
if(this._dataAdapter.sizeMetricName()){l.enter().append("div").classed("cv-bubble-size-metric",true).html("<span>"+this._dataAdapter.sizeMetricName()+"</span>  <i></i> &ndash; <i></i>");
setTimeout(function(){var t=n.padding(),s=n.facet().getPanel(n.facet()._panels.length-1).bounds(),v=n.plotBounds(),r=l.selectAll("span"),q=v.right+t.right,p=s.top+s.height,o=q-l.node().offsetWidth-k,u=p-l.node().offsetHeight;
l.style("top",u+"px").style("left",o+"px")
},300)
}else{l.remove()
}};
g.cloudViz.point=h.util.createConstructor(a)
}(this));
(function(g){var h=g.cloudViz||{},f=h.dvcore||{},a=g.dv||{},b=g.d3||{},d=Object.create(f);
d.init=function(j){Object.getPrototypeOf(d).init.apply(this,arguments);
this._type="bar";
this._chart=a.chart();
this._minTickSpace=60;
return this
};
d._initDefaultOptions=function(){var j={normalized:false,position:"dodge",dualYAxis:false,clickHandler:null,formats:{x:"decimal",y:"decimal"},tooltipContent:null};
return Object.getPrototypeOf(d)._initDefaultOptions.call(this,j)
};
d.reset=function(){Object.getPrototypeOf(d).reset.apply(this,arguments);
var k=this._options,j=b.select(k.parent);
j.selectAll(".axis-y.axis-index-1").remove()
};
d._setChartTypeOptions=function(){var k=this._chart,j=this._options;
k.layers([a.geom.bar().each("start",function(m,l){b.select(this).attr("legend-group",m.fill)
})]).map("fill",this._getPropMapping("series"),a.scale.color().values(j.colors)).guide("fill",this._legend).position(j.position).coord(a.coord.cartesian().flip(j.flip));
k._layers[0].on("click",this._eventMap.click?this._eventMap.click:null);
this._addBehaviors(k.layers()[0],j);
this._mapPositionScales(k,j)
};
d._mapPositionScales=function(p,v){var l=this._isSmallChart(),o=[0,l?10:15],k=this._applyForceZero(this._constructScale("y")).rangePadding(o),m=this._getPropMapping("series"),u=this._getPropMapping("y"),j=this._getPropMapping("x"),r=l?Math.max(0.3,Math.min(0.6,this._getChartWidth()/this._dataAdapter.uniqueXValues().length/200)):Math.min(0.6,Math.max(0.05,this._getChartWidth()/4000)),q=l?0.3:0.5,t=this;
if(this._dataAdapter.isOvertime()){r=0.05
}if(v.normalized||(v.dualYAxis&&(this._options.position==="identity"||this._options.position==="dodge"))){var s=t._dataAdapter.uniqueFillValues();
s.forEach(function(A,w){var z=(0===w)?k:k.copy();
z.includeInDomain(function(C,B){return C.data[m]===t._dataAdapter.uniqueFillValues()[w]
});
if(w>0){p.map("y",u,z,w)
}})
}else{var n=p.getExplicitScalesMap().y;
if(n){delete n[1]
}}p.map("y",u,k,0);
p.map("x",this._getPropMapping("x"),a.scale.ordinal().padding(r).outerPadding(q).reverse(v.flip))
};
d._addBehaviors=function(n,m){var j=b.select(m.parent),o,k=this._dataAdapter,l=this;
if(!this._isSmallChart()&&m.interactive){n.behaviors([a.behavior.rollover().orientation(m.flip?"top":"right").content(function(v,s,q){if(m.tooltipContent){return m.tooltipContent.call(this,v,s,q)
}var w=this.__geom.getExplicitScale("group"),z=v.panel.yScale(v),t=l._yLabelFormat(z.scaleIndex()),u='<span class="metric-value">'+t(v.y)+'</span><span class="metric-name">'+v.data[l._getPropMapping("seriesLabel")]+"</span>",r=k.dateGranularity(),A=k.l10n.dateFormat.fullFormat,p=k.isOvertime()?l._formatTime(new Date(v.x),l._timeGranTemplate(r,A),r):v.x;
if(w&&w.mapping()){u='<span class="series-name">'+p+"</span>"+u
}return u
}).showTooltip(function(u,q,p,t,s){var r=b.select(this);
if(!r.classed("path-inactive")){s._showTip.call(this,u,q,p,s);
clearTimeout(o);
j.selectAll(".bar-geom").classed("cv-medium-duration",false).classed("cv-unselected",function(v){return u!==v
});
j.selectAll(".cv-legend-marker").classed("cv-unselected",function(v){return v.id!==u.fill
}).classed("cv-medium-duration",false);
if(l._eventMap.mouseover){l._eventMap.mouseover.call(this,u,q,p,t)
}}}).hideTooltip(function(u,q,p,t,s){var r=b.select(this);
if(!r.classed("path-inactive")){s._removeTip.call(this,u,q,p,s);
o=setTimeout(function(){j.selectAll(".bar-geom, .cv-legend-marker").classed("cv-unselected",false).classed("cv-medium-duration",true);
if(l._eventMap.mouseout){l._eventMap.mouseout.call(this,u,q,p,t)
}},400)
}})])
}};
d._drawSmall=function(){var m=this._chart,l=this._options,n,j=(l.flip)?undefined:10,k=this;
if(l.flip){n=a.guide.axis().tickDx(function(p,o){return b.select(this).select("span").node().offsetWidth
}).tickDy(function(p,o){return -b.select(this).select("span").node().offsetHeight
}).tickSize(0)
}else{n=a.guide.axis().tickSize(0).tickDy(function(p,o){return(o%2===0)?-8:-26
})
}if(this._dataAdapter.isOvertime()){n.tickValues(b.extent(this._dataAdapter.data()[this._getPropMapping("x")])).tickFormat(k._timeSmallXFormat()).tickAnchor(function(p,o){return o>0?"end":"start"
}).tickDx(function(q,p){var o=m.getTrainedScale("x").rangeBand()/2;
return p>0?o:-o
}).tickDy(-8)
}else{n.tickFormat(function(p,o){return k._truncateLabel(p,j)
})
}m.guide("x",n.title(this._dataAdapter.xAxisTitle())).guide("y",a.guide.axis().ticks(0).tickSize(0).tickFormat(function(p,o){return""
}).title(this._dataAdapter.yAxisTitle()));
this._checkNormalized()
};
d._drawLarge=function(){var p=this._chart,t=this._options,s=this,o=function(u){return Math.max(2,Math.min(5,u/75))
},l=a.guide.axis().tickSize(0),k=a.guide.axis().ticks(o),q;
if(t.dualYAxis&&(this._options.position==="identity"||this._options.position==="dodge")){var n=s._dataAdapter.getUniqueFillExtent(0),m=s._dataAdapter.getUniqueFillExtent(1);
k.tickSize(15).tickFormat(this._yTickFormat(0,n)).title(this._yTitleFormat(0,n));
q=a.guide.axis().ticks(o).tickFormat(this._yTickFormat(1,m)).title(this._yTitleFormat(1,m)).orientation("right").tickSize(15);
p.guide("y",q,1)
}else{k.tickFormat(this._yTickFormat(0)).title(this._yTitleFormat(0));
p.guide("y","none",1)
}if(t.flip){l.tickDx(-10)
}else{l.tickDy(function(v,u){return(u%2===0)?-8:-26
});
k.tickDx(-10);
if(q){q.tickDx(-10)
}}if(this._dataAdapter.isOvertime()){var j={},r=0;
p._data[this._getPropMapping("x")].forEach(function(v,u){if(!j[+new Date(v)]){r++;
j[+new Date(v)]=1
}});
l.tickDy(-8).tickFormat(this._timeXTickFormat(r)).htmlLabels(true)
}else{l.tickFormat(function(v,u){return s._truncateLabel(v)
})
}p.guide("x",l.title(this._dataAdapter.xAxisTitle())).guide("y",k);
this._checkNormalized()
};
d._timeXTickValidator=function(k){var j=this;
return function(q,m){var o=j._chart.getTrainedScale("x"),l=a.util.scaleRange(o),n=l[1]-l[0],p=Math.ceil(j._minTickSpace/(n/k));
return m%p===0
}
};
d._timeXTickFormat=function(j){return Object.getPrototypeOf(d)._timeXTickFormat.call(this,this._timeXTickValidator(j))
};
d._isNormalized=function(){var k=this._options,j=this._isSmallChart()?1:2;
return k.normalized||(k.dualYAxis&&this._dataAdapter.uniqueFillValues().length>j&&(k.position==="identity"||k.position==="dodge"))
};
g.cloudViz.bar=h.util.createConstructor(d)
}(this));
(function(f){var g=f.cloudViz||{},d=g.dvcore||{},a=f.dv||{},b=f.d3||{},h=Object.create(d);
h.init=function(j){Object.getPrototypeOf(h).init.apply(this,arguments);
this._type="donut";
this._chart=a.chart();
return this
};
h._initDefaultOptions=function(){var j={maxSlices:6,innerRadius:"45%",outerRadius:"35%",clickHandler:null,formats:{x:"decimal",y:"decimal"},tooltipContent:null};
return Object.getPrototypeOf(h)._initDefaultOptions.call(this,j)
};
h._buildLegend=function(){var j=this,k=this._options,m=Object.getPrototypeOf(h)._buildLegend.call(this,"x","x");
this._dataAdapter.processLabelData(m);
if(m!=="none"){if(this._dataAdapter.numberOfFacets()==1){var l=this._dataAdapter.labelData().cvtextvallabel.map(function(o,n){return j._yLabelFormat(0)(o)
});
m.values(l)
}if(!k.interactive&&(!k.legendOrientation||k.legendOrientation==="top")){m.padding({bottom:20})
}}return m
};
h._getSeriesTotal=function(m){var j=this._dataAdapter,p=j.data(),k=p[this._getPropMapping("y")],q=p[this._getPropMapping("series")],l,n=q.length,o=0;
for(l=0;
l<n;
++l){if(q[l]+""===m+""){o+=k[l]
}}return o
};
h._createSeriesStates=function(){var k=this._options;
if("data" in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");
var m=a.util.uniq(this._dataAdapter.data()[this._getPropMapping("x")]);
var l=m.length;
while(l--){var j=m[l];
this._seriesState.insertState(j,j,"standard")
}}if("targetValues" in this._changedOptions){if(k.targetValues){this._seriesState.removeStatesByType("target");
this._seriesState.appendState(k.targetLabel||this._dataAdapter.l10n.labels.dvcore.target,"target","target")
}}};
h._getCategoryTotal=function(j){if(this._dataAdapter.numberOfFacets()!==1){return""
}var p=this._dataAdapter.data(),k=p[this._getPropMapping("y")],l=p[this._getPropMapping("x")],m,n=l.length,o=0;
for(m=0;
m<n;
++m){if(l[m]+""===j+""){o+=k[m]
}}return o
};
h._shouldHideLabels=function(j){var k=j.panel.bounds();
return j.y<=0.05||(Math.min(k.width,k.height)/2<80)
};
h._setChartTypeOptions=function(){var p=this._chart,l=this._dataAdapter,n=this._options,j=b.select(n.parent),m=this,k=n.colors.slice(0);
if(n.interactive){p.padding({top:10})
}if(l.showOtherCategory()){k.splice(n.maxSlices-1,0,"#ccc")
}var q=[a.geom.bar().position("fill").set("stroke","#fff").each("start",function(s,r){b.select(this).attr("legend-group",s.fill)
})];
q[0].on("click",this._eventMap.click?this._eventMap.click:null);
var o=m._dataAdapter.labelData();
q.push(a.geom.text().data(o).map("label","cvtextperclabel").set("stroke","none").position("fill").textAnchor(function(t,r){var s=(t.y0+t.y/2)*100;
if(s<50){return"start"
}if(s>50){return"end"
}return"middle"
}).each("start",function(s,r){b.select(this).classed("slice-label",true).classed("hidden",m._shouldHideLabels.call(m,s)).attr("dy",".35em").attr("legend-group",s.fill)
}).set("alpha",function(t,s,r){return m._shouldHideLabels.call(m,t)?0:1
}).dx(function(A,t){var u=A.panel.xOuterScale().range(),s=u[1]-u[0],r=s?s/2:0,v=a.util.getPercentValue(n.outerRadius,r),w=30,z=(A.y0+A.y/2)*100;
return r+v-w
}).dy(function(u,s){var r=-u.panel._bounds.width/2*u.y,t=(u.y0+u.y/2)*100;
if(t<10){r-=(10-t)/2
}if(t>90){r+=(10-(100-t))/2
}if(t<=50&&t>40){r+=(10-(50-t))/2
}if(t>50&&t<60){r-=(10-(t-50))/2
}return r
}));
p.layers(q).map("group","cvdonutorder").map("x",this._getPropMapping("series"),a.scale.ordinal()).map("y",this._getPropMapping("y"),this._constructScale("y")).map("fill",this._getPropMapping("x"),a.scale.color().values(k)).guide("fill",this._legend).guide(["x","y"],"none").coord(a.coord.polar().flip(true).innerRadius(n.innerRadius).outerRadius(n.outerRadius)).postrender(function(){var s=b.select(n.parent).select(".cv-wrapper"),t=s.selectAll(".cv-donut-facet-labels").data([0]),r=m._dataAdapter;
t.enter().append("div").classed("cv-donut-facet-labels",true);
t.exit().remove();
var u=t.selectAll(".cv-donut-facet-label").data(this.facet()._panels),v=u.enter().append("div").classed("cv-donut-facet-label",true);
u.each(function(F,B){var w=F.bounds(),J=b.select(this),E=Math.min(w.width,w.height)/2,D=w.height/2-E,G=a.util.getPercentValue(n.innerRadius,E),L=G<25?"small":G>50?"large":"medium",z=L==="large"?G*2:w.width,A=L==="large"?w.left+(w.width/2)-(z/2):w.left,H=(L==="large")?w.top+(w.height/2)-27:w.top+D-10;
J.style("top",H+"px").style("width",z+"px").style("left",A+"px").classed("cv-donut-small-facet cv-donut-medium-facet cv-donut-large-facet",false).classed("cv-donut-"+L+"-facet",true);
var C=J.selectAll(".cv-donut-label-number").data([0]);
C.enter().append("div").classed("cv-donut-label-number",true);
var K=m._getSeriesTotal(F.xFacetTitle());
C.text(m._yLabelFormat(F._facetIndex)(K));
var I=J.selectAll(".cv-donut-label-title").data([0]);
I.enter().append("div").classed("cv-donut-label-title",true);
I.text(r.yAxisTitle(F._facetIndex));
if(L==="medium"){C.style("top",w.height/2-D+"px")
}});
u.exit().remove()
});
this._addBehaviors(q[0],n)
};
h._addBehaviors=function(n,m){var j=b.select(m.parent),p,k=this._dataAdapter,l=this,o=function(s,r,q){if(!s.data.hasOwnProperty(r.mapping())){return""
}return'<span class="metric-value">'+q(s.data[r.mapping()])+'</span><span class="metric-name">'+r.mapping()+"</span>"
};
if(!this._isSmallChart()&&m.interactive){n.behaviors([a.behavior.rollover().content(function(w,t,r){if(m.tooltipContent){return m.tooltipContent.call(this,w,t,r)
}var z=this.__geom.getExplicitScale("group"),A=w.panel.yScale(w),u=l._yLabelFormat(A.scaleIndex()),v='<span class="metric-value">'+u(w.data[l._getPropMapping("y")])+'</span><span class="metric-name">'+w.data[l._getPropMapping("seriesLabel")]+"</span>",s=l._dataAdapter.dateGranularity(),B=k.l10n.dateFormat.fullFormat,q=a.util.isDate(w.fill)?l._formatTime(w.fill,l._timeGranTemplate(s,B),s):w.fill;
if(z&&z.mapping()){v='<span class="series-name">'+q+"</span>"+v
}return v
}).showTooltip(function(v,r,q,u,t){var s=b.select(this);
if(!s.classed("path-inactive")){t._showTip.call(this,v,r,q,t);
clearTimeout(p);
j.selectAll(".bar-geom").classed("cv-medium-duration",false).classed("cv-unselected",function(w){return v!==w
});
j.selectAll(".text-geom").classed("cv-medium-duration",false).classed("cv-unselected",function(w){return v.group!==w.group
}).classed("cv-selected",function(w){return v.group===w.group
});
j.selectAll(".cv-legend-marker").classed("cv-unselected",function(w){return w.id!==v.fill
}).classed("cv-medium-duration",false);
if(l._eventMap.mouseover){l._eventMap.mouseover.call(this,v,r,q,u)
}}}).hideTooltip(function(v,r,q,u,t){var s=b.select(this);
if(!s.classed("path-inactive")){t._removeTip.call(this,v,r,q,t);
p=setTimeout(function(){j.selectAll(".bar-geom, .cv-legend-marker").classed("cv-unselected",false).classed("cv-medium-duration",true);
j.selectAll(".text-geom").classed("cv-unselected cv-selected",false).classed("cv-medium-duration",true);
if(l._eventMap.mouseout){l._eventMap.mouseout.call(this,v,r,q,u)
}},400)
}})])
}};
h._drawSmall=function(){var k=this._chart,j=this._options;
k.facet(a.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(1).titleFormat(undefined))
};
h._drawLarge=function(){var j=this._chart;
j.facet(a.facet.wrap().group(this._getPropMapping("series")).scales("free").numColumns(3).titleFormat(undefined))
};
f.cloudViz.donut=g.util.createConstructor(h)
}(this));
(function(a){a.cloudViz.interactiveLegend=function(){var A=10,B=110,t=110,q,g,h=["top","right","left"],v,l,f,o,d,k,n,s,z=true,j,r,b,w=null,m=null,p,u={};
u._render=function(C,E,D){this._initSVG(E);
this._sizeAndPositionLegendEntries();
this._positionLegend()
};
u._initSVG=function(D){b=d3.select(q).selectAll(".cv-legend").data([0]);
b.enter().append("div").classed("cv-legend",true);
r=this._createLegendEntries(b,D);
j=Math.floor(this._getLegendContainingWidth()/r.size());
if(h.indexOf(g)>-1){this._calculatedLegendOrientation=g
}else{this._calculatedLegendOrientation="top"
}var C=a.cloudViz.core._isSmallChart(v);
if(j<B&&!C&&(this._calculatedLegendOrientation=="top"||this._calculatedLegendOrientation=="bottom")){this._calculatedLegendOrientation="left"
}switch(this._calculatedLegendOrientation){case"top":case"bottom":j=Math.max(j,B);
b.style("height",null);
o=false;
break;
case"left":case"right":j=t;
o=true;
break
}h.forEach(dv.util.bind(function(E){b.classed(E,this._calculatedLegendOrientation===E)
},this))
};
u._getAdjustedDimensions=function(D){var C=b.node();
switch(this._calculatedLegendOrientation){case"top":D.top+=this._getUsedHeight();
break;
case"right":D.width-=this._getUsedWidth();
break;
case"left":D.left+=this._getUsedWidth();
break;
case"bottom":D.height-=this._getUsedHeight();
break
}return D
};
u._createLegendEntries=function(H,G){var J=this,K=s.getStateObjects(),E,F,D,C;
for(D in G){C=G[D][0];
p=C._mapping
}E=H.selectAll(".cv-legend-entry").data(K);
F=E.enter().append("div").attr("class",function(L){return"cv-legend-entry cv-legend-"+L.type+"-entry"
});
F.append("div").classed("cv-legend-title",true);
var I=F.append("div").classed("cv-legend-details",true);
I.append("div").classed("cv-legend-marker",true);
I.append("div").classed("cv-legend-num",true);
E.exit().on("click",null).remove();
E.each(function(N,L){var M=d3.select(this);
M.select(".cv-legend-title").text(N.name);
M.select(".cv-legend-num").text((d&&d.length>L)?d[L]:"");
M.select(".cv-legend-marker").attr("class","cv-legend-marker "+k).style("background-color",function(P){var O=C.mapValue(P.id);
return O?O:null
})
});
E.classed("inactive",function(M,L){return z&&!M.enabled
});
E.on("click",function(M,L){if(z){s.enableStateByIndex(L,!M.enabled)
}});
return E
};
u._onSeriesEnableChange=function(C,D){if(z){r.filter(function(E){return E.id===D.id&&E.type===D.type
}).classed("inactive",!D.enabled)
}};
u._positionLegend=function(){var C={top:0,left:0};
switch(this._calculatedLegendOrientation){case"bottom":C.top=l-b.node().offsetHeight;
break;
case"right":C.left=v-t;
break
}b.style("top",C.top+"px").style("left",C.left+"px")
};
u._sizeAndPositionLegendEntries=function(){if(o){r.each(function(M,K,L){d3.select(this).style("width",j+"px").select(".cv-legend-title").style("height",null)
})
}else{var F,C,J=0,D=false;
var I=r[0].length;
var H=I*j;
var E=this._getLegendContainingWidth();
var G=0;
if(H<E&&H+I>E){G=E-H
}b.style("width",(H>E&&!o)?E+"px":"");
r.each(function(N,L,M){F=d3.select(this);
var K=j;
if(G>0){K+=1;
G-=1
}F.style("width",K+"px");
C=F.select(".cv-legend-title").style("height",null).node().offsetHeight;
if(C!==J){D=true;
J=Math.max(C,J)
}});
if(D){r.selectAll(".cv-legend-title").style("height",J+"px")
}}};
u._getLegendContainingWidth=function(){return v
};
u._getUsedWidth=function(){return o?t+A:0
};
u._getUsedHeight=function(){if(o){return 0
}else{return b.node().offsetHeight||0
}};
u.destroy=function(){b.remove()
};
u.parent=function(C){if(!arguments.length){return q
}q=C;
return u
};
u.minLegendEntryWidth=function(C){if(!arguments.length){return B
}B=C;
return u
};
u.legendVerticalWidth=function(C){if(!arguments.length){return t
}t=+C;
return u
};
u.values=function(C){if(!arguments.length){return d
}d=C;
return u
};
u.type=function(C){if(!arguments.length){return k
}k=C;
return u
};
u.chartWidth=function(C){if(!arguments.length){return v
}v=C;
return u
};
u.chartHeight=function(C){if(!arguments.length){return l
}l=C;
return u
};
u.chartPadding=function(C){if(!arguments.length){return f
}f=C;
return u
};
u.seriesState=function(C){if(!arguments.length){return s
}s=C;
s.on("enableChange.legend",this._onSeriesEnableChange);
return u
};
u.validOrientations=function(C){if(!arguments.length){return h
}h=C;
return u
};
u.orientation=function(C){if(!arguments.length){return g
}g=C;
return u
};
u.interactive=function(C){if(!arguments.length){return z
}z=C;
return u
};
u.mapping=function(){return p
};
u.isVertical=function(){return o
};
return u
}
}(this));
(function(a){d3.anomaly=function(){var U={},ap,M={x:"date",y:"deviation"},ai,v=[50,25],q=true,at=6,f=false,ad=null,ag,au,L=7,al,ae,l,ab=d3.dispatch("select","mouseover","mouseout"),ar,aa=d3.time.scale(),Z=d3.scale.linear(),F,g,d,n,G,Y,ac,h,af,am,j,o,A;
var aq=8,K=1,u=86400000;
d3.rebind(U,ab,"on");
U.data=function(p){if(!arguments.length){return ap
}ap=p;
A=null;
return U
};
U.mappings=function(p){if(!arguments.length){return M
}M=B(M,p);
return U
};
U.xUpperLimit=function(p){if(!arguments.length){return ae
}ae=p;
return U
};
U.xLowerLimit=function(p){if(!arguments.length){return l
}l=p;
return U
};
U.normalizePositive=function(p){if(!arguments.length){return f
}f=p;
return U
};
U.xTicks=function(av,p){if(!arguments.length){return p!==undefined?[L,al]:this.xTicks
}var aw=!!(av&&av.constructor&&av.call&&av.apply);
L=(aw)?d3.functor(av):av;
al=aw?p:undefined;
return this
};
U.bins=function(p){if(!arguments.length){return at
}at=p;
return U
};
U.size=function(p){if(!arguments.length){return v
}v=p;
return U
};
U.interactive=function(p){if(!arguments.length){return q
}q=p;
return U
};
U.parent=function(p){if(!arguments.length){return ad
}ad=p;
return U
};
U.anomalyWidth=function(){return ag
};
U.anomalyHeight=function(){return au
};
U.layout=function(){if(!U.data()||!U.data().length){throw new D()
}if(!U.parent()){throw new N()
}af=an("x");
am=an("y");
T();
P();
o=k();
n=O();
Z.domain([Y[0],Y[Y.length-1]]);
W();
o.attr("transform","translate("+ai.left+","+ai.top+")");
z(o,d,g);
V();
ak();
return U
};
U.nodes=function(p){if(!j){throw new Error("layout must be called before nodes may be requested.")
}j.selectAll(".anom-anomaly").each(p)
};
function B(p,av){for(var aw in av){p[aw]=av[aw]
}return p
}function W(){var p=o.append("g").classed("temp-axis",true);
z(p,v[0],v[1]);
ai=X(p);
d=v[0]-ai.left-ai.right;
g=v[1]-ai.top-ai.bottom;
p.remove()
}function X(aw){var ax=aw.node().getBBox(),av=Math.abs(ax.x),p=Math.abs(ax.y);
return{left:av,top:p,right:ax.width-v[0]-av,bottom:ax.height-v[1]-p}
}function T(){var p=m(ap,function(az){return Date.parse(az[af])
},[l,ae]);
var av=m(ap,function(az){return az[am]
});
aa.domain(p);
var ay=aa.ticks(L,al);
var ax=(+ay[1])-(+ay[0]);
p[1]=ax+(+ay[ay.length-1]);
p[0]=(+ay[0]>p[0])?(+ay[0]-ax):p[0];
aa.domain(p);
h=aa.ticks(L,al);
var aw=Math.max(Math.abs(av[0]),Math.abs(av[1]));
if(f){Z.domain([0,aw]);
F=d3.scale.linear().domain([-aw,aw])
}else{Z.domain([-aw,aw]);
F=d3.scale.linear().domain(Z.domain())
}F.domain([0,1/10,1/5,3/10,2/5,0.5,3/5,7/10,4/5,9/10,1].map(F.invert));
F.range(["#3C476F","#485485","#53659C","#6C7CAF","#99A2BC","#C5C5C5","#ACC997","#90C867","#7CBC4B","#6FA744","#64913E"])
}function m(ax,p,aw){var av=[];
if(arguments.length<3||(aw[0]===undefined&&aw[1]===undefined)){av=d3.extent(ax,p)
}else{av[0]=(aw[0]===undefined)?d3.min(ax,p):aw[0];
av[1]=(aw[1]===undefined)?d3.max(ax,p):aw[1]
}return av
}function P(){ac=d3.svg.brush().x(aa).y(Z).on("brushstart",Q).on("brush",s).on("brushend",ao)
}function Q(av){H()
}function s(av){o.selectAll(".extent").style("opacity",1);
H()
}function ao(av){o.selectAll(".extent").style("opacity",0);
H()
}function H(){var av=ac.extent(),p={left:Math.min(aa(av[0][0]),aa(av[1][0])),right:Math.max(aa(av[0][0]),aa(av[1][0])),top:Math.min(Z(av[0][1]),Z(av[1][1])),bottom:Math.max(Z(av[0][1]),Z(av[1][1]))};
var aw=o.selectAll(".anom-anomaly").filter(function(ay,ax){return R({left:ay.bounds.x,right:ay.bounds.x+ay.bounds.width,top:ay.bounds.y,bottom:ay.bounds.y+ay.bounds.height},p)
});
if(A&&b(aw[0],A[0])){return
}A=aw;
ab.select(aw)
}function b(ax,aw){if(ax.length!=aw.length){return false
}for(var p=0,av=ax.length;
p<av;
p++){if(aw.indexOf(ax[p])===-1){return false
}}return true
}function R(av,p){return !(p.left>av.right||p.right<av.left||p.top>av.bottom||p.bottom<av.top)
}function k(){j=d3.select(ad);
var av=j.selectAll("svg").data([ap]);
av.enter().append("svg");
av.exit().remove();
av.attr("width",v[0]).attr("height",v[1]);
var p=av.selectAll(".anom-container").data([0]);
p.enter().append("g").classed("anom-container",true);
return p
}function O(){Y=Z.ticks(at);
var p=Y[1]-Y[0];
Y.push(p+Y[Y.length-1]);
if(!f){Y.unshift(Y[0]-p)
}ap=J(ap);
r(ap);
var av=E(ap);
I(Y,av);
return av
}function J(aw,p){var av=aa.domain();
return aw.filter(function(ay){var ax=new Date(ay[af]);
return ax>=av[0]&&ax<av[1]
})
}function r(p){p.sort(function(aw,av){aw=new Date(aw[af]);
av=new Date(av[af]);
return aw<av?-1:aw>av?1:0
})
}function E(p){return d3.nest().key(function(ay){var av=Date.parse(ay[af]),ax=0;
var aw=-1,az=h.length;
while(++aw<az){if(+h[aw]>+av){break
}ax=aw
}return +h[ax]
}).entries(p)
}function I(p,av){av.forEach(function(aw){aw.values=d3.layout.histogram().bins(p).value(function(ax){return f?Math.abs(ax[am]):ax[am]
})(aw.values);
G=aw.values[0].dx
})
}function S(av){var aB=new Date(0),ay=h.length,aA=Math.max(Math.ceil((h.length-1)/(av/70)),1),az=d3.time.format("%b %e, %Y"),ax=d3.time.format("%b %e"),p=d3.time.format("%a %e"),aw=d3.time.format("%I:%M %p");
return function(aE,aC){var aD="";
if(aC===ay-1||(aC%aA!==0)){return""
}else{if(aC===0||aB.getYear()!==aE.getYear()){aD=az(aE)
}else{if(aB.getMonth()!==aE.getMonth()){aD=ax(aE)
}else{if(aB.getDate()!==aE.getDate()){aD=p(aE)
}else{if(aB.getHours()!==aE.getHours()){aD=aw(aE)
}}}}}aB=aE;
return aD
}
}function z(av,aC,aA){var az=h.length,aD=(h.length>1&&(+h[1]-+h[0]<=u)),ax;
aa.rangeRound([0,aC]);
Z.rangeRound([aA,0]);
var aB=av.selectAll(".anom-axes").data([0]);
aB.enter().append("g").classed("anom-axes",true);
var ay=aB.selectAll(".anom-axis").data(["x","y"]);
ay.enter().append("g").attr("class",function(aE){return"anom-"+aE+" anom-axis"
});
var aw=aB.selectAll(".anom-x").attr("transform","translate(0,"+aA+")").call(d3.svg.axis().scale(aa).ticks(L,al).orient("bottom").tickSize(-aA).tickPadding(20).tickFormat(S(aC)));
aw.selectAll("text").style("text-anchor","start");
aw.selectAll("line").style("opacity",function(aF,aE){if(aE===az-1){return 0
}if(aD&&(aF.getDay()===6||aF.getDay()===1)&&aF.getHours()===0&&aE<az-1){return 0.3
}return null
});
var p=aB.selectAll(".anom-y").call(d3.svg.axis().scale(Z).tickValues(Y).orient("left").tickSize(-aC).tickPadding(10).tickFormat(function(aF,aE){if(aE===0||aE===Math.floor(Y.length/2)||aE===(Y.length-1)){return(Math.round(aF*100000)/100000)+"%"
}return""
}));
if(!f){p.selectAll("line").filter(function(aF,aE){return aF===0
}).style("stroke-dasharray","4 4").style("opacity",0.7)
}}function ak(){var ay=Math.round((Y.length>1)?Z(Y[0])-Z(Y[1]):g)-1,aC=Math.round(ah(ay))-1;
var aA=o.selectAll(".anom-plot").data([n]);
aA.enter().append("g").classed("anom-plot",true);
aA.exit().remove();
var az=aA.selectAll(".anom-column").data(function(aE){return aE
});
az.enter().append("g").classed("anom-column",true);
az.exit().remove();
az.attr("transform",function(aE){return"translate("+aa(+aE.key)+",0)"
});
var aD=az.selectAll(".anom-row").data(function(aE){return aE.values
});
aD.enter().append("g").classed("anom-row",true);
aD.exit().remove();
aD.attr("transform",function(aF,aE){return"translate(0,"+(Z(Y[aE])-ay)+")"
});
var av=aD.selectAll(".anom-anomaly").data(function(aE){return aE
});
var aB=av.enter().append("g").classed("anom-anomaly",true);
av.attr("transform",function(aF,aE){var aG=w(f?Math.abs(aF[am]):aF[am]);
if(aF[am]>=0){aG+=G
}aF.bounds={x:aa(Date.parse(aF[af]))+(aE*(aC+K)+K),y:Z(aG),width:aC,height:ay};
return"translate("+(aE*(aC+K)+K)+",0)"
});
av.exit().remove();
aB.append("rect").classed("anom-cell",true).attr("x",aC/2).attr("y",ay/2).attr("width",0).attr("height",0);
av.selectAll(".anom-cell").attr("fill",function(aE){var aF=w(f?Math.abs(aE[am]):aE[am]);
if(f&&aE[am]<0){aF*=-1
}return F(aF)
}).transition().duration(500).attr("x",0).attr("y",0).attr("width",aC).attr("height",ay);
var ax=aB.append("g").classed("anom-select",true);
ax.append("path").classed("outer-border",true);
ax.append("path").classed("inner-border",true);
var aw=av.selectAll(".anom-select");
aw.select(".outer-border").attr("d",t(0,0,aC+0.5,ay+0.5,1));
if(aC>3){aw.select(".inner-border").attr("d",t(0,0,aC+1,ay+1,2))
}var p=aB.append("rect").classed("anom-hit-area",true);
p.on("mouseover",function(aF,aE){ab.mouseover(this,aF,aE)
}).on("mouseout",function(aF,aE){ab.mouseout(this,aF,aE)
}).on("mousedown",function(aH,aE){ac.clear();
var aG=d3.mouse(o.node()),aI=aa.invert(aG[0]),aF=Z.invert(aG[1]);
ac.extent([[aI,aF],[aI,aF]])
}).on("click",function(aF,aE){ab.select(d3.select(this))
}).style("cursor","crosshair").style("opacity",0).attr("x",0).attr("y",0).attr("width",aC).attr("height",ay)
}function V(){var p=o.selectAll(".anom-plot").data([0]);
p.enter().append("g").classed("anom-plot",true);
p.exit().remove();
p.call(ac)
}function t(av,ay,ax,p,aw){return"M"+aw+","+aw+"L"+(ax-aw*2)+","+aw+"L"+(ax-aw*2)+","+(p-aw*2)+"L"+aw+","+(p-aw*2)+"z"
}function w(aw){var p=-1,av=Y.length;
while(++p<av){if(aw>=0&&Y[p]+G>aw){return Y[p]
}if(aw<0&&Y[p]+G>aw){return Y[p]+G
}}return Y[0]
}function ah(av){var p=((h.length>1)?aa(h[1])-aa(h[0]):d)-aq,aw=C();
ag=p/aw;
return(ag>av)?av:ag
}function C(){var p=0;
n.forEach(function(av){av.values.forEach(function(aw){p=Math.max(aw.length,p)
})
});
return p
}function an(p){if(M[p]===undefined){throw new aj(p)
}return M[p]
}function aj(p){this.type="MappingNotDefinedException";
this.message="The mapping for property "+p+" was not defined.";
this.toString=function(){return this.type+" - "+this.message
}
}function D(){this.type="EmptyDataException";
this.message="The data is empty or null";
this.toString=function(){return this.type+" - "+this.message
}
}function N(){this.type="ParentNotSpecifiedException";
this.message="A p was not specified for this visualization";
this.toString=function(){return this.type+" - "+this.message
}
}return U
}
}(this));
(function(g){var j=g.cloudViz||{},a=j.core||{},d=g.dv||{},f=g.d3||{},b=Object.create(a),h=400;
b.init=function(k){this._type="pathing";
this._initDefaultOptions();
this.setOptions(k);
this._pathLocked=null;
this._pathedObj=null;
this._activePaths=[];
this._lineLocked=null;
this._lastSide=0;
return this
};
b._initDefaultOptions=function(){var l="Visits",k={mappings:{},colors:["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],nodeWidth:100,minNodeHeight:1,avgNodeHeight:30,padding:{top:80,left:30,right:30,bottom:20},metricName:l,minNodeHorzPadding:80,nodeVertPadding:34,iterations:32,pivotNode:null,collapseNode:null,expandNode:null,pathSelected:null};
return Object.getPrototypeOf(b)._initDefaultOptions.call(this,k)
};
b._onAutoResize=function(){this.render()
};
b.reset=function(){Object.getPrototypeOf(b).reset.apply(this,arguments)
};
b._preRender=function(){Object.getPrototypeOf(b)._preRender.apply(this);
var z=this._options,v=f.select(z.parent),u=z.padding;
var s=v.selectAll(".pathing-cv-info-wrapper").data([0]);
s.enter().insert("div",":first-child").classed("pathing-cv-info-wrapper",true);
var k=s.selectAll(".pathing-cv-wrapper").data([0]);
k.enter().insert("div",":first-child").classed("pathing-cv-wrapper",true);
var l=k.selectAll(".pathing-cv-container").data([0]);
l.enter().insert("div",":first-child").classed("pathing-cv-container",true);
var q=l.selectAll(".pathing-svg").data([0]);
q.enter().append("svg").classed("pathing-svg",true);
var w=q.selectAll(".pathing-svg-container").data([0]);
w.enter().append("g").classed("pathing-svg-container",true);
w.attr("transform","translate("+u.left+","+u.top+")");
var m=s.selectAll(".pathing-cv-info-pane").data([0]);
m.enter().append("div").classed("pathing-cv-info-pane",true);
m.exit().remove();
var p=m.selectAll(".info-pane-content").data([0]);
p.enter().append("div").classed("info-pane-content",true);
p.exit().remove();
var n=p.selectAll(".pathing-cv-info-title").data([0]);
n.enter().append("div").classed("pathing-cv-info-title",true);
n.exit().remove();
var o=p.selectAll(".pathing-cv-info-value").data([0]);
o.enter().append("div").classed("pathing-cv-info-value",true);
o.exit().remove();
var r=p.selectAll(".pathing-cv-info-paths").data([0]);
r.enter().append("div").classed("pathing-cv-info-paths",true);
r.exit().remove();
this._sizeChart();
this._createGradients(q);
var t=this._pathedObj;
if(this._changedOptions&&this._changedOptions.data&&t){if(this._isDataObjNode(t.data)){this._unlockNode(t.data,t.elem)()
}else{this._unlockLink(t.data,t.elem)()
}}else{l.on("mousemove.node",null).on("click.node",null).on("click.link",null);
this._removePathOverlays(l);
this._removeNodeOptions(true);
this._defaultInformation()
}},b._render=function(){Object.getPrototypeOf(b)._render.apply(this);
if(!this._dataAdapter.isValidPathingData()){return
}this._createDiagram();
var k=this._pathedObj;
if(this._activePaths.length&&k){if(this._isDataObjNode(k.data)){this._renderNodePaths(k.data,k.elem,true);
this._showNodeOptions(k.data,k.elem)
}else{this._renderLinkPaths(k.data,k.elem,true)
}}};
b._postRender=function(){Object.getPrototypeOf(b)._postRender.apply(this)
};
b._sizeChart=function(A){clearTimeout(this._wrapperAnimation);
clearTimeout(this._scrollAnimation);
var n=this._options,K=this._dataAdapter.data(),s=f.select(n.parent),E=this,z=s.selectAll(".pathing-cv-info-wrapper"),p=z.selectAll(".pathing-cv-wrapper"),v=p.selectAll(".pathing-cv-container"),m=z.selectAll(".pathing-cv-info-pane"),u=n.parent.offsetWidth,l=n.parent.offsetHeight,G=d.util.getPercentValue(n.width,u),B=d.util.getPercentValue(n.height,l),w=G-parseInt(m.style("width"),10),C=n.padding;
var F=K&&K.nodes||[],o=this._numColumns=F.length&&(Math.max.apply(null,F.map(function(L){return L.column
}))+1)||1,J=[],H=0;
K.nodes.forEach(function(M,L){if(J[M.column]){J[M.column]++
}else{J[M.column]=1
}});
H=J.length&&Math.max.apply(null,J)||0;
var t=w-2,D=B-2,k=(o*n.nodeWidth)+((o-1)*n.minNodeHorzPadding)+C.left+C.right,q=(H*n.avgNodeHeight)+(H*n.nodeVertPadding)+C.top+C.bottom,r=k>w,I=q>B;
p.classed("is-wider",r);
if(r){t=k;
D-=20
}p.classed("is-taller",I);
if(I){D=q;
t-=20
}z.style("width",G+"px").style("height",B+"px");
p.style("width",w+"px").style("height",B+"px");
v.style("width",t+"px").style("height",D+"px")
};
b._getInnerDimensions=function(){var m=this._options,o=m.padding,l=f.select(m.parent).select(".pathing-cv-container"),n=parseInt(l.style("width"),10),k=parseInt(l.style("height"),10);
return[n-o.right-o.left,k-o.top-o.bottom]
};
b._createDiagram=function(){var u=this._options,l=this._dataAdapter.data(),k=f.select(u.parent).selectAll(".pathing-cv-container"),q=parseInt(k.style("width"),10),t=parseInt(k.style("height"),10),s=this._path=f.pathing().nodeWidth(u.nodeWidth).nodePadding(u.nodeVertPadding).size(this._getInnerDimensions()).nodes(l.nodes).links(l.links).minNodeHeight(u.minNodeHeight).layout(u.interations);
if(!l.nodes.some(function(v){return v.column!==0
})){var r=s.nodeWidth(),p=u.padding;
l.nodes.forEach(function(v){v.x+=((q-p.left-p.right)/2)-(r/2)
})
}var o=this._updateLinks(s,l.links);
this._updateNodes(s,l.nodes,o,t);
var n=f.select(u.parent).select(".pathing-svg").node();
n.style.display="none";
var m=n.offsetHeight;
n.style.display=""
};
b._updateNodes=function(B,l,s,z){var A=this,C=this._options,p=f.select(C.parent).select(".pathing-svg-container"),o=this._options.onNodeSelect,u=this._options.padding,t=(!this._changedOptions||!this._changedOptions.data),k=(t)?0:h;
function w(E){var D=z-this.getBBox().height-u.bottom;
f.select(this).attr("transform","translate("+E.x+","+(E.y=Math.max(0,Math.min(D,f.event.y)))+")");
B.relayout();
s.attr("d",B.link())
}var r=p.selectAll(".node-container").data([0]);
r.enter().append("g").classed("node-container",true);
r.exit().remove();
var m=r.selectAll(".node").data(l,this._dataAdapter.nodeKey()),v=B.nodeWidth();
m.enter().append("g").classed("hide-node",true).attr("transform",function(D){return"translate("+D.x+",0)"
});
m.on("mouseover.node",function(E,D){A._showNodePaths(E,this)
}).on("mouseout.node",function(E,D){A._hideNodePaths()
}).on("click.node",function(E,D){A._activateNode(E,this)
});
var q=m.exit();
q.classed("hide-node",true).on("mouseover.node",null).on("mouseout.node",null).on("click.node",null).transition().duration(k).style("opacity",0).attr("transform",function(D){return"translate("+D.x+",0)"
});
setTimeout(function(){q.remove()
},k);
m.transition().duration(k).attr("transform",function(D){return"translate("+D.x+","+D.y+")"
});
var n=this._numColumns;
m.each(function(I,E){var H=f.select(this),G=H.classed("hide-node");
H.attr("class","node");
H.classed("hide-node",G);
H.classed("filter",I.id==="E_0");
H.classed("exit-filter",I.id==="X_0");
if(I.classname){H.classed(I.classname,true)
}var K=H.selectAll(".node-bg").data([I]);
K.enter().append("rect").classed("node-bg",true);
K.exit().remove();
K.attr("width",v);
K.transition().duration(k).attr("height",function(N){return N.dy
});
function M(Q){var O=true,P=false,N=false;
if(n>1){P=(0===Q.column);
N=(n-1===Q.column);
O=!(P||N)
}f.select(this).attr("x",(O)?v/2:(P)?2:v-4).attr("text-anchor",(O)?"middle":(P)?"start":"end")
}function J(P){var O=20,Q=10,N="\u2026";
if(P.length<O){return P
}return P.slice(0,O-Q)+N+P.slice(P.length-Q)
}var L=H.selectAll(".node-title").data([I]);
L.enter().append("text").classed("node-title",true).attr("y",-5).attr("transform",null);
L.exit().remove();
L.each(M);
L.text(function(N){return J(N.label)
});
var F=H.selectAll(".node-total").data([I]);
F.enter().append("text").classed("node-total",true).attr("y",15).attr("transform",null);
F.exit().remove();
F.each(M);
F.text(function(N){return f.format(",.0f")(N.value)
});
var D=H.selectAll(".node-hit-area").data([I]);
D.enter().append("rect").classed("node-hit-area",true);
D.exit().remove();
D.attr("height",function(N){return N.dy+4
}).attr("y",-4).attr("width",B.nodeWidth()).style("opacity",0);
setTimeout(function(){H.classed("hide-node",false)
},k)
})
};
b.gradientCounter={count:0};
b._updateLinks=function(z,s){var A=this._options,w=this,q=f.select(A.parent).select(".pathing-svg-container"),m=f.select(A.parent).selectAll("svg"),o=m.selectAll("defs").data([0]),t=(!this._changedOptions||!this._changedOptions.data),l=(t)?0:h;
o.enter().append("defs");
var u=o.selectAll(".path-fills").data([0]),v=u.enter().append("g").classed("path-fills",true);
var k=q.selectAll(".link-container").data([0]);
k.enter().append("g").classed("link-container",true);
k.exit().remove();
var n=q.selectAll(".path-overlay-container").data([0]);
n.enter().append("g").classed("path-overlay-container",true);
n.exit().remove();
var r=k.selectAll("path").data(s,this._dataAdapter.linkKey());
r.enter().append("path").classed("hide-link",true);
r.on("mouseover.link",function(C,B){w._showLinkPaths(C,this)
}).on("mouseout.link",function(C,B){w._hideLinkPaths()
}).on("click.link",function(C,B){w._activateLink(C,this)
});
var p=r.exit();
p.classed("hide-link",true).on("click.link",null).on("mouseover.link",null).on("mouseout.link",null);
setTimeout(function(){p.remove()
},l);
r.each(function(G,D){var F=f.select(this),B=F.classed("hide-link");
F.attr("class",function(H){return !H.source?"entry":!H.target?"exit":"link"
});
F.classed("hide-link",B);
if(F.classed("hide-link")){F.attr("d",z.link()(G));
setTimeout(function(){F.classed("hide-link",false)
},l)
}else{F.transition().duration(l).attr("d",z.link()(G))
}if(G.source&&"E_0"===G.source.id){F.classed("entry-path",true)
}else{if(G.target&&"X_0"===G.target.id){F.classed("exit-path",true)
}}var E=G.source&&"E_0"===G.source.id,C=G.target&&"X_0"===G.target.id;
F.classed("filter",E);
F.classed("exit-filter",C)
});
return r
};
b._createGradients=function(p){var w=p.selectAll("style").data([0]);
w.enter().append("style");
w.text(function(C){var B=".pathing-svg .exit { fill: url(#exitFill); } \n";
B+=".pathing-svg .entry { fill: url(#entryFill); } \n";
B+=".pathing-svg .exit:hover { fill: url(#exitHighlightFill); } \n";
B+=".pathing-svg .entry:hover { fill: url(#entryHighlightFill); } \n";
B+=".pathing-svg .pivot-entry { mask: url(#pivotEnterMask); } \n";
B+=".pathing-svg .pivot-exit { mask: url(#pivotExitMask); } \n";
B+=".pathing-svg .link-container .entry-path { fill: url(#entryGradient); } \n";
B+=".pathing-svg .link-container .exit-path { fill: url(#exitGradient); } \n";
return B
});
var m=p.selectAll("defs").data([0]);
m.enter().append("defs");
var v=m.selectAll(".bounce-fills").data([0]),z=v.enter().append("g").classed("bounce-fills",true);
var r=z.append("linearGradient").attr("id","pivotEnterGrad");
r.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0);
r.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0);
r.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",0.5);
r.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);
var t=z.append("mask").attr("id","pivotEnterMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");
t.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotEnterGrad)");
var n=z.append("linearGradient").attr("id","pivotExitGrad").attr("x1","100%").attr("y1","0%").attr("x2","0%").attr("y2","0%");
n.append("stop").attr("offset","0%").style("stop-color","#fff").style("stop-opacity",0);
n.append("stop").attr("offset","50%").style("stop-color","#fff").style("stop-opacity",0);
n.append("stop").attr("offset","70%").style("stop-color","#fff").style("stop-opacity",0.5);
n.append("stop").attr("offset","100%").style("stop-color","#fff").style("stop-opacity",1);
var q=z.append("mask").attr("id","pivotExitMask").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("maskUnits","objectBoundingBox").attr("maskContentUnits","objectBoundingBox");
q.append("rect").attr("x","0").attr("y","0").attr("width","1").attr("height","1").attr("fill","url(#pivotExitGrad)");
var l=z.append("linearGradient").attr("id","entryGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");
l.append("stop").attr("offset","0%").style("stop-color","#8cc350");
l.append("stop").attr("offset","100%").style("stop-color","#3287D2");
var s=z.append("linearGradient").attr("id","exitGradient").attr("x1","0%").attr("y1","100%").attr("x2","100%").attr("y2","100%");
s.append("stop").attr("offset","0%").style("stop-color","#3287D2");
s.append("stop").attr("offset","100%").style("stop-color","#cc2539");
var o=z.append("linearGradient").attr("id","exitFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");
o.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",0.5);
o.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",0.5);
o.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",0.1);
var A=z.append("linearGradient").attr("id","exitHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");
A.append("stop").attr("offset","0%").style("stop-color","#FA5A50").style("stop-opacity",1);
A.append("stop").attr("offset","85%").style("stop-color","#FA5A50").style("stop-opacity",1);
A.append("stop").attr("offset","100%").style("stop-color","#FA5A50").style("stop-opacity",0.1);
var u=z.append("linearGradient").attr("id","entryFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");
u.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",0.1);
u.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",0.5);
u.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",0.5);
var k=z.append("linearGradient").attr("id","entryHighlightFill").attr("x1","0%").attr("y1","0%").attr("x2","0%").attr("y2","100%");
k.append("stop").attr("offset","0%").style("stop-color","#58AF5E").style("stop-opacity",0.1);
k.append("stop").attr("offset","15%").style("stop-color","#58AF5E").style("stop-opacity",1);
k.append("stop").attr("offset","100%").style("stop-color","#58AF5E").style("stop-opacity",1)
};
b._setOptionContainerContent=function(k,n){var v=this._options,p="",l,t=0,r=k.classed("is-last-column"),q=this._dataAdapter,u=q.l10n.labels.pathing,o=[{id:"expand",label:u.expand,valid:(v.expandNode&&q.canExpandNode(n))},{id:"pivot",label:u.focus,valid:(v.pivotNode&&q.canPivotNode(n))},{id:"collapse",label:u.collapse,valid:(v.collapseNode&&q.canCollapseNode(n))}];
if(r){o.reverse()
}o=o.filter(function(w){return w.valid
});
if(v.expandNode||v.collapseNode||v.pivotNode){for(var m=0,s=o.length;
m<s;
++m){l=o[m];
p+='<a class="cv-node-option cv-node-option'+((r)?(s-t-1):t)+" cv-node-"+l.id+'"><i class="'+l.id+'"></i><span>'+l.label+"</span></a>";
++t
}}p='<div class="cv-node-options num-options-'+t+'">'+p+"</div>";
k.html(p)
};
b._activateNode=function(n,m){var k=this;
if(this._pathLocked&&n===this._pathLocked.data){k._unlockNode(n,m)();
var l=(f.mouse(m)[0]>=k._options.nodeWidth/2)?1:-1;
if(!n.isPivot||l===k._lastSide){return
}}this._setPathLocked({data:n,elem:m});
f.select(k._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null);
f.selectAll(".cv-node-active").classed("cv-node-active",false);
f.selectAll(".cv-link-active").classed("cv-link-active",false);
f.select(m).classed("cv-node-active",true);
this._renderNodePaths(n,m);
this._showNodeOptions(n,m);
this._showInformation(n,m);
this._scrollToElem(m);
setTimeout(function(){f.select(k._options.parent).select(".pathing-cv-container").on("click.node",k._unlockNode(n,m))
},10)
};
b._showNodePaths=function(l,k){if(this._pathLocked){return
}this._renderNodePaths(l,k)
};
b._renderNodePaths=function(p,n,m){var s=f.select(this._options.parent).select(".pathing-cv-container");
clearTimeout(this._hidePathOverlaysTimer);
s.on("mousemove.node",null);
if(this._pathedObj&&this._pathedObj.data===p&&!m){return
}this._setPathedObj({data:p,elem:n});
var q=0,t=this,l,u,r=this._dataAdapter.nodePaths(p);
function o(){u=t._activePaths=r.filter(function(w){var v=w.nodes.indexOf(p._pid);
return(q>0&&v+1<w.nodes.length)||(q<0&&v>0)
});
l=t._dataAdapter.nodePathData(u,p,q);
t._createPathOverlays(l)
}function k(){var v=0;
try{v=f.mouse(n)[0]
}catch(z){}var w=(v>=t._options.nodeWidth/2)?1:-1;
if(w!==q){t._lastSide=q=w;
o()
}}if(p.isPivot){if(m){q=t._lastSide;
o()
}else{k();
if(!t._pathLocked){s.on("mousemove.node",function(w,v){k()
})
}}}else{t._lastSide=0;
t._activePaths=r;
l=this._dataAdapter.nodePathData(r,p,q);
t._createPathOverlays(l)
}setTimeout(function(){s.classed("path-overlays",true)
},1)
};
b._showNodeOptions=function(q,o){var w=this,p=this._numColumns,u=f.select(this._options.parent).select(".pathing-cv-container"),s=u.node(),z=this._options,r=50,l=f.select(o).select(".node-bg").node(),v=s.getBoundingClientRect(),n=l.getBoundingClientRect(),t=n.top-v.top,m=n.left-v.left+(z.nodeWidth/2),k=u.select(".cv-path-node-options");
if(k.empty()){k=u.append("div").classed("cv-path-node-options",true).attr("node",q._pid)
}else{if(k.attr("node")==q._pid&&k.classed("is-open")){}else{this._removeNodeOptions();
r=300;
k=u.append("div").classed("cv-path-node-options",true).attr("node",q._pid)
}}k.classed("is-last-column",(p>1&&p-1===q.column)).style("top",t+"px").style("left",m+"px");
this._setOptionContainerContent(k,q);
setTimeout(function(){k.classed("is-open",true)
},r)
};
b._formatMetricValue=function(k){return this._formatNumber("decimal",k.value)+" "+this._options.metricName
};
b._formatPathInformation=function(n){var m=this._options,l=this,k=m.colors;
return function(u,p){var o=l._dataAdapter.getPathEnd(u),s=o?(o.value)?o.value:n:n,r="",t=u.values[0],q=t/s;
p=p%k.length;
r+='<span class="pathing-path-marker" style="background-color: '+k[p]+'"></span>';
r+='<span class="pathing-path-value"><span class="pathing-path-num">'+l._formatNumber("decimal",t)+'</span> <span class="pathing-path-perc">'+l._formatNumber("percent",q)+"</span></span>";
return r
}
};
b._highlightPath=function(n,o,m){var u=this._options,q=u.parent,p=f.event,r=!p||(p&&"click"===p.type),l=f.select(q).selectAll(".path-overlay-container"),k=f.select(q).selectAll(".pathing-cv-info-pane"),t=l.selectAll(".link.path"+o),s=l.selectAll(".link:not(.path"+o+")");
if(r){if(this._lineLocked===n){this._setLineLock(null);
return this._removeHightlightPath()
}this._setLineLock(n);
k.selectAll(".locked").classed("locked",false);
f.select(m).classed("locked",true)
}else{if(this._lineLocked){return
}}l.selectAll(".link.inactive").classed("inactive",false);
s.classed("inactive",true);
t.classed("active",true)
};
b._setLineLock=function(l){var k=this._options;
if(this._lineLocked===l){return
}this._lineLocked=l;
this._callPathSelected(l)
};
b._setPathedObj=function(k){this._pathedObj=k
};
b._setPathLocked=function(l){var k=this._options;
if(this._pathLocked===l){return
}this._pathLocked=l;
this._callPathSelected()
};
b._callPathSelected=function(m){var n={},k=this._options,l=this._pathLocked&&this._pathLocked.data||{};
if(m){n.path=m.nodes+""
}if("undefined"!==typeof l._pid){n.node=l._pid;
n.side=this._lastSide
}if("undefined"!==typeof l.source||"undefined"!==typeof l.target){n.source=(l.source)?l.source._pid:null;
n.target=(l.target)?l.target._pid:null
}if("function"==typeof k.pathSelected){k.pathSelected(n,this._pathLocked,m)
}};
b._removeHightlightPath=function(){if(this._lineLocked){return
}var l=this._options,m=l.parent,n=f.select(m).selectAll(".pathing-cv-info-pane"),k=f.select(m).selectAll(".path-overlay-container").selectAll(".link");
k.classed("inactive",false).classed("active",false);
n.selectAll(".locked").classed("locked",false)
};
b._showInformation=function(E,C){var q=this,k=this._options,A="",z=this._isDataObjNode(E),l=this._dataAdapter.l10n.labels.pathing,u=f.select(this._options.parent).select(".pathing-cv-info-pane"),m=u.selectAll(".pathing-cv-info-title"),F=u.selectAll(".pathing-cv-info-value"),D=u.selectAll(".pathing-cv-info-paths");
this._setLineLock(null);
this._removeHightlightPath();
var o,w=this._formatMetricValue(E),p=false;
if(z){o=E.label;
w=this._formatMetricValue(E);
p=(E.column==this._numColumns-1)
}else{var B=l.percOfNode;
if(!E.source){o=l.nodeEntries.replace(/\{label\}/i,E.target.label);
w=this._formatMetricValue(E)+'<span class="perc">'+B.replace(/\{perc\}/i,this._formatNumber("percent",E.value/E.target.value)).replace(/\{label\}/i,E.target.label)+"</span>"
}else{if(!E.target){o=l.nodeExits.replace(/\{label\}/i,E.source.label);
w=this._formatMetricValue(E)+'<span class="perc">'+B.replace(/\{perc\}/i,this._formatNumber("percent",E.value/E.source.value)).replace(/\{label\}/i,E.source.label)+"</span>"
}else{var s=this._dataAdapter,t=s.getPathDirection(s.data().paths[E.paths[0]]),v=(t<0)?E.target:E.source;
o=l.nodeToNode.replace(/\{source\}/i,E.source.label).replace(/\{target\}/i,E.target.label);
w=this._formatMetricValue(E)+'<span class="perc">'+B.replace(/\{perc\}/i,this._formatNumber("percent",E.value/v.value)).replace(/\{label\}/i,v.label)+"</span>"
}}}u.classed("is-last-column",p);
m.html(o);
F.html(w);
var n=D.selectAll(".pathing-cv-path-title").data([0]);
n.enter().append("span").classed("pathing-cv-path-title",true);
n.html(this._dataAdapter.activePathsTitle(this._activePaths));
var r=D.selectAll(".pathing-cv-path-info").data(this._activePaths);
r.enter().append("span").classed("pathing-cv-path-info",true);
r.on("click.line",function(H,G){q._highlightPath(H,G,this)
}).on("mouseover.line",function(H,G){q._highlightPath(H,G,this)
}).on("mouseout.line",function(H,G){q._removeHightlightPath()
}).html(this._formatPathInformation(E.value));
r.exit().on("click.line",null).on("mouseover.line",null).on("mouseout.line",null).remove()
};
b._defaultInformation=function(){this._setLineLock(null);
this._removeHightlightPath();
var p=f.select(this._options.parent).select(".pathing-cv-info-pane"),o=p.selectAll(".pathing-cv-info-title"),k=p.selectAll(".pathing-cv-info-value"),n=p.selectAll(".pathing-cv-info-paths"),m=this._dataAdapter.l10n.labels.pathing;
var l="<p>"+m.help1+"</p>";
l+="<p>"+m.help2+"</p>";
l+="<p>"+m.help3+"</p>";
l+='<p><span class="cv-node-option"><i class="pivot"></i></span><span class="cv-option-title">'+m.focus+"</span></p>";
l+="<p>"+m.focusHelp+"</p>";
l+='<p><span class="cv-node-option"><i class="expand"></i></span><span class="cv-option-title">'+m.expand+"</span></p>";
l+="<p>"+m.expandHelp+"</p>";
l+='<p><span class="cv-node-option"><i class="collapse"></i></span><span class="cv-option-title">'+m.collapse+"</span></p>";
l+="<p>"+m.collapseHelp+"</p>";
o.html(m.title);
k.html('<div class="help">'+l+"</div>");
n.html("")
};
b._scrollToElem=function(C){var n=this._options,q=f.select(this._options.parent).select(".pathing-cv-container"),r=q.node(),p=f.select(n.parent).select(".pathing-cv-wrapper"),v=f.select(C),D=(!v.selectAll(".node-bg").empty())?v.select(".node-bg").node():v.node(),B=r.getBoundingClientRect(),l=D.getBoundingClientRect(),t=l.top-B.top,o=l.left-B.left+(n.nodeWidth/2);
if(!p.classed("is-wider")&&!p.classed("is-taller")){return
}function k(E,F){return function(){var G=(E!==null)?f.interpolateNumber(p.node().scrollLeft,E):null,H=(F!==null)?f.interpolateNumber(p.node().scrollTop,F):null;
return function(I){if(G!==null){p.node().scrollLeft=G(I)
}if(H!==null){p.node().scrollTop=H(I)
}}
}
}var w=null,u=null;
if(p.classed("is-wider")){var A=parseInt(p.style("width"),10),z=parseInt(q.style("width"),10);
w=Math.min(z-A,Math.max(0,o-(A/2)))
}if(p.classed("is-taller")){var m=parseInt(p.style("height"),10),s=parseInt(q.style("height"),10);
u=Math.min(s-m,Math.max(0,t+40-(m/2)))
}f.transition().duration(300).tween("scroll",k(w,u))
};
b._unlockNode=function(m,l){var k=this;
return function(o,n){k._setPathLocked(null);
f.select(k._options.parent).select(".pathing-cv-container").on("click.node",null);
k._deactivateNode(f.event,m,l)
}
},b._deactivateNode=function(o,p,l){var n=f.select(o.target),k=this._options,m=p||{};
f.select(l).classed("cv-node-active",false);
this._removeNodeOptions(false);
this._defaultInformation();
this._hideNodePaths();
if("click"===o.type){if(!n.classed("cv-node-option")){n=f.select(n.node().parentNode)
}if(n.classed("cv-node-expand")&&("function"===typeof k.expandNode)){k.expandNode(m)
}if(n.classed("cv-node-collapse")&&("function"===typeof k.collapseNode)){k.collapseNode(m)
}if(n.classed("cv-node-pivot")&&("function"===typeof k.pivotNode)){k.pivotNode(m)
}}};
b._removeNodeOptions=function(l){var k=f.selectAll(".cv-path-node-options");
k.classed("is-open",false);
setTimeout(function(){k.remove()
},(l)?0:300)
};
b._hideNodePaths=function(){var k=f.select(this._options.parent).select(".pathing-cv-container");
k.on("mousemove.node",null);
if(this._pathLocked){return
}this._removePathOverlays(k)
};
b._activateLink=function(m,l){var k=this;
if(this._pathLocked&&m===this._pathLocked.data){k._unlockLink(m,l);
return
}this._setPathLocked({data:m,elem:l});
f.select(k._options.parent).select(".pathing-cv-container").on("click.node",null).on("click.link",null);
f.selectAll(".cv-node-active").classed("cv-node-active",false);
f.selectAll(".cv-link-active").classed("cv-link-active",false);
f.select(l).classed("cv-link-active",true);
this._removeNodeOptions();
this._renderLinkPaths(m,l);
this._showInformation(m,l);
this._scrollToElem(l);
setTimeout(function(){f.select(k._options.parent).select(".pathing-cv-container").on("click.link",k._unlockLink(m,l))
},10)
};
b._showLinkPaths=function(l,k){if(this._pathLocked){return
}this._renderLinkPaths(l,k)
};
b._renderLinkPaths=function(o,n,l){clearTimeout(this._hidePathOverlaysTimer);
if(this._pathedObj&&this._pathedObj.data===o&&!l){return
}this._setPathedObj({data:o,elem:n});
var k=this._dataAdapter;
this._activePaths=k.linkSortActivePaths(o);
this._createPathOverlays(k.linkPathData(this._activePaths));
var m=f.select(this._options.parent).select(".pathing-cv-container");
setTimeout(function(){m.classed("path-overlays",true)
},1)
};
b._unlockLink=function(m,l){var k=this;
return function(o,n){k._setPathLocked(null);
f.select(k._options.parent).select(".pathing-cv-container").on("click.link",null);
k._deactivateLink(f.event,m,l)
}
},b._deactivateLink=function(m,n,l){var k=f.select(this._options.parent).select(".pathing-cv-container");
f.select(l).classed("cv-link-active",false);
this._defaultInformation();
this._hideLinkPaths()
};
b._hideLinkPaths=function(){var k=f.select(this._options.parent).select(".pathing-cv-container");
if(this._pathLocked){return
}this._removePathOverlays(k)
};
b._createPathOverlays=function(l){var m=this._options,o=this._path,k=f.select(m.parent).select(".path-overlay-container"),n=k.selectAll("path").data(l);
n.enter().append("path");
n.exit().remove();
n.attr("class",function(q){var p=(q.pivotStart)?" pivot-entry":(q.pivotEnd)?" pivot-exit":"";
return"link path"+q.path+p
}).attr("d",o.link()).attr("style",function(s,q){var r=s.path%m.colors.length;
return"fill: "+m.colors[r]+";"
}).sort(function(q,p){if(!q&&!p){return 0
}if(!q){return 1
}if(!p){return -1
}return p.dy-q.dy
})
};
b._removePathOverlays=function(k){clearTimeout(this._hidePathOverlaysTimer);
this._setPathedObj(null);
this._hidePathOverlaysTimer=setTimeout(function(){k.classed("path-overlays",false)
},20)
};
b._isDataObjNode=function(k){return("undefined"!==typeof k._pid)
};
b.setActivePath=function(l){var s=this._options,q=this,m=this._dataAdapter.data();
l=l||{};
var p=("undefined"!==typeof l.node),o,k;
if(p){o=m.nodesById[l.node]
}else{o=m.links.filter(function(t){return((!t.source&&!l.source)||(t.source&&l.source&&t.source._pid+""===l.source))&&((!t.target&&!l.target)||(t.target&&l.target&&t.target._pid+""===l.target))
});
o=o.length&&o[0]||null
}k=(p)?".node":".link";
if(!o){return
}var n=false,r;
n=m.paths.some(function(t){r=t.nodes;
return t.nodes.toString()===l.path
});
f.select(s.parent).selectAll(k).each(function(u,t){if(u===o){if(p){q._activateNode(u,this)
}else{q._activateLink(u,this)
}if(!n){return
}f.select(s.parent).selectAll(".pathing-cv-path-info").filter(function(w,v){if(w.nodes.toString()===r.toString()){q._highlightPath(w,v,this)
}})
}})
};
g.cloudViz.pathing=j.util.createConstructor(b)
}(this));
(function(a){d3.pathing=function(){var d={},k=24,m=8,q=[1,1],s=[],j=[],o=NaN,n=0;
d.nodeWidth=function(w){if(!arguments.length){return k
}k=+w;
return d
};
d.nodePadding=function(w){if(!arguments.length){return m
}m=+w;
return d
};
d.nodes=function(w){if(!arguments.length){return s
}s=w;
return d
};
d.links=function(w){if(!arguments.length){return j
}j=w;
return d
};
d.size=function(w){if(!arguments.length){return q
}q=w;
return d
};
d.numColumns=function(){return o
};
d.minNodeHeight=function(w){if(!arguments.length){return n
}n=w;
return d
};
d.layout=function(w){h();
p();
f();
l(w);
g();
return d
};
d.relayout=function(){g();
return d
};
d.link=function(){var z=0.5;
function w(G){var E,D,I,C,B,P,O,M,K,J,H,L,F,A=5,N=15;
L=F=Math.min(G.dy+A,N);
if(G.source===null){E=G.target.x-L;
D=G.target.x;
M=G.target.y-A;
K=G.target.y+G.dy;
return"M"+E+","+M+"h"+L+"v"+(K-M)+"c-"+L+",0,-"+L+",-"+(F/2)+",-"+L+",-"+F+"z"
}if(G.target===null){E=G.source.x+G.source.dx;
D=G.source.x+G.source.dx+L;
M=G.source.y+G.source.dy-G.dy;
K=G.source.y+G.source.dy+A;
return"M"+D+","+K+"h-"+L+"v-"+(K-M)+"c"+L+",0,"+L+","+(F/2)+","+L+","+F+"V"+K+"z"
}E=G.source.x+G.source.dx,D=G.target.x,I=d3.interpolateNumber(E,D),C=I(z),B=I(1-z),P=B+((G.dy<15)?((G.source.y<G.target.y)?-1*G.dy:G.dy):0),O=C+((G.dy<15)?((G.source.y<G.target.y)?-1*G.dy:G.dy):0),M=G.source.y+G.sy,K=G.target.y+G.ty,J=K+G.dy,H=M+G.dy;
return"M"+E+","+M+"C"+C+","+M+" "+B+","+K+" "+D+","+K+"v"+G.dy+"C"+P+","+J+" "+O+","+H+" "+E+","+H+"Z"
}w.curvature=function(A){if(!arguments.length){return z
}z=+A;
return w
};
return w
};
function h(){s.forEach(function(w){w.sourceLinks=[];
w.targetLinks=[];
w.entryLinks=[];
w.exitLinks=[]
});
j.forEach(function(w){var z=w.source,A=w.target;
if(z!==null&&typeof z==="number"){z=w.source=s[w.source]
}if(A!==null&&typeof A==="number"){A=w.target=s[w.target]
}if(z!==null&&A!==null){z.sourceLinks.push(w);
A.targetLinks.push(w)
}else{if(z===null){A.entryLinks.push(w)
}else{z.exitLinks.push(w)
}}})
}function p(){s.forEach(function(z){if(z.hasOwnProperty("total")){z.value=z.total
}else{z.value=Math.max(d3.sum(z.sourceLinks,t)+d3.sum(z.exitLinks,t),d3.sum(z.targetLinks,t)+d3.sum(z.entryLinks,t))
}});
function w(z){return(z.sourceLinks&&z.sourceLinks.length)||(z.targetLinks&&z.targetLinks.length)||(z.exitLinks&&z.exitLinks.length)||(z.entryLinks&&z.entryLinks.length)
}s.sort(function(A,z){var B=w(A),C=w(z);
if(B&&!C){return -1
}if(C&&!B){return 1
}return z.value-A.value
})
}function f(){var z=0,A=[],w=q[0]-k;
s.forEach(function(B){B.x=B.column;
B.dx=k;
if(A.indexOf(B.column)<0){A.push(B.column);
B.columnIndex=A.length-1
}else{B.columnIndex=A.indexOf(B.column)
}});
o=A.length;
r(o>1?w/(o-1):w)
}function b(){s.forEach(function(w){if(!w.targetLinks.length){w.x=d3.min(w.sourceLinks,function(z){return z.target.x
})-1
}})
}function u(w){s.forEach(function(z){if(!z.sourceLinks.length){z.x=w-1
}})
}function r(w){s.forEach(function(z){z.x*=w
})
}function l(D){var w=d3.nest().key(function(G){return G.x
}).sortKeys(d3.ascending).entries(s).map(function(G){return G.values
});
function B(){var G=d3.min(w,function(H){var I=d3.sum(H,t)||1;
return(q[1]-(H.length-1)*m)/I
});
w.forEach(function(H){H.forEach(function(J,I){J.y=I;
J.dy=Math.max(n,J.value*G)
})
});
j.forEach(function(H){H.dy=H.value*G
})
}function A(H){w.forEach(function(I,J){I.forEach(function(K){if(K.targetLinks.length){var L=d3.sum(K.targetLinks,G)/d3.sum(K.targetLinks,t);
K.y+=(L-v(K))*H
}})
});
function G(I){return v(I.source)*I.value
}}function z(H){w.slice().reverse().forEach(function(I){I.forEach(function(J){if(J.sourceLinks.length){var K=d3.sum(J.sourceLinks,G)/d3.sum(J.sourceLinks,t);
J.y+=(K-v(J))*H
}})
});
function G(I){return v(I.target)*I.value
}}function F(){w.forEach(function(H){var K,G,J=0,L=H.length,I;
H.sort(C);
for(I=0;
I<L;
++I){K=H[I];
G=J-K.y;
if(G>0){K.y+=G
}J=K.y+K.dy+m
}G=J-m-q[1];
if(G>0){J=K.y-=G;
for(I=L-2;
I>=0;
--I){K=H[I];
G=K.y+K.dy+m-J;
if(G>0){K.y-=G
}J=K.y
}}})
}function C(H,G){return H.y-G.y
}B();
F();
for(var E=1;
D>0;
--D){z(E*=0.99);
F();
A(E);
F()
}}function g(){s.forEach(function(A){A.sourceLinks.sort(w);
A.targetLinks.sort(z)
});
s.forEach(function(B){var C=0,A=0;
B.entryLinks.forEach(function(D){D.ty=A;
A+=D.dy
});
B.sourceLinks.forEach(function(D){D.sy=C;
C+=D.dy
});
B.targetLinks.forEach(function(D){D.ty=A;
A+=D.dy
});
B.exitLinks.forEach(function(D){D.sy=C;
C+=D.dy
})
});
function z(B,A){return B.source.y-A.source.y
}function w(B,A){return B.target.y-A.target.y
}}function v(w){return w.y+w.dy/2
}function t(w){return w.value
}return d
}
}(this));
(function(h){var j=h.cloudViz||{},a=j.core||{},f=h.dv||{},g=h.d3||{},b=Object.create(a);
b.init=function(k){this._type="anomaly";
k=k||{};
this._initDefaultOptions();
this.setOptions(k);
this._initializeAnomaly();
return this
};
b._initDefaultOptions=function(k){var l={mappings:{x:"date",y:"deviation",category:"metric"},bins:12,xTicks:7,xTickInterval:undefined,xUpperLimit:undefined,xLowerLimit:undefined,normalizePositive:false,onMouseOverAnomaly:null,onMouseOutAnomaly:null,onSelectAnomalies:null};
return Object.getPrototypeOf(b)._initDefaultOptions.call(this,l)
};
b._render=function(){this._configureAnomaly();
this._anom.layout()
};
b._initializeAnomaly=function(){var l=this._options,m=l.mappings,k=this;
this._anom=g.anomaly().on("mouseover",function(o,p,n){k._anom.nodes(function(s,q){var r=g.select(this).transition().duration(750).style("opacity",s[m.category]===p[m.category]?0.8:0.2)
});
if(l.onMouseOverAnomaly){l.onMouseOverAnomaly.call(o,p,n)
}}).on("mouseout",function(o,p,n){k._anom.nodes(function(s,q){var r=g.select(this).transition().duration(750).style("opacity",1)
});
if(l.onMouseOutAnomaly){l.onMouseOutAnomaly.call(o,p,n)
}}).on("select",function(n){k._anom.nodes(function(p,o){g.select(this).classed("selected",false)
});
n.classed("selected",true);
if(l.onSelectAnomalies){l.onSelectAnomalies.call(n)
}})
};
b._configureAnomaly=function(){var l=this._options;
var m=f.util.getPercentValue(l.width,l.parent.offsetWidth);
var k=f.util.getPercentValue(l.height,l.parent.offsetHeight);
this._anom.data(d(l.data)).parent(l.parent).mappings(l.mappings).bins(l.bins).size([m,k]).xUpperLimit(l.xUpperLimit).xLowerLimit(l.xLowerLimit).normalizePositive(l.normalizePositive).xTicks(l.xTicks,l.xTickInterval)
};
b._onAutoResize=function(){this.render()
};
function d(q){var s=[],o=true;
for(var k in q){var t=q[k],r=-1,m=t.length;
while(++r<m){var p,l=t[r];
if(o){p={};
s.push(p)
}else{p=s[r]
}p[k]=l
}o=false
}return s
}b.chart=function(){return this._anom
};
h.cloudViz.anomaly=j.util.createConstructor(b)
}(this));
(function(a){d3.choropleth=function(){var m=["#fae6be","#eb782d","#dc283c","#640046"],d=["#c7b797","#b85e23","#a81e2e","#300022"],E=["#faf0c8","#d2dc73","#5faf69","#00505A"],g=["#c7bf9f","#a0a858","#437d4a","#002226"],q={},H,s=[],v,F,D,B,t,z,h,G,u,k,C,w,o=[0,1],b=(C-w)*o[0],f=(C-w)*o[1],A={},j=false,r={top:0,left:0,right:0,bottom:40};
q.layout=function(){var p=this;
if(!q.data()){throw new l()
}if(!q.parent()){throw new n()
}s=q.determineSize(h);
q.calcRange();
B=q.createSVGContainer();
if(typeof h.geoJson==="string"){d3.json(h.geoJson,function(I){p._layoutWithData.call(p,I)
})
}else{this._layoutWithData(h.geoJson)
}};
q._layoutWithData=function(p){q.drawGeos(p);
if(h.interactive){q.drawTooltip()
}q.drawLegend(h.theme,p)
};
q.determineSize=function(I){var K=I.parent,J=I.width?I.width:K.offsetWidth,p=I.height?I.height:K.offsetHeight;
J=J?J:700;
p=p?p:450;
return[J,p]
};
q.calcRange=function(){for(var p in h.data.values){if(typeof C=="undefined"){C=h.data.values[p];
w=h.data.values[p]
}if(h.data.values[p]>C){C=h.data.values[p]
}if(h.data.values[p]<w){w=h.data.values[p]
}}};
q.drawLegend=function(ac,L){var V=this,W=9,N=12,K=35,U=Math.min(s[0]-r.left,630)-25,Z=(s[0]-r.left-U)/2,T=U-(K*2)-(N*2),Q=[],ag=[];
if(typeof ac!="undefined"&&ac=="salmonRun"){Q=m;
ag=d
}else{Q=E;
ag=g
}var I=t.selectAll(".legend").data([H]);
I.enter().append("g").classed("legend",true);
I.attr("transform","translate("+Z+","+(s[1]-24)+")");
var p=I.selectAll("defs").data([ac]);
p.enter().append("defs");
p.exit().remove();
var aa=p.selectAll("#defaultGradient-"+ac).data([ac]);
aa.enter().append("linearGradient").attr("id","defaultGradient-"+ac);
aa.exit().remove();
var Y=p.selectAll("#darkGradient-"+ac).data([ac]);
Y.enter().append("linearGradient").attr("id","darkGradient-"+ac);
Y.exit().remove();
var P=["0%","33%","67%","100%"];
var R=function(ak,ai,ah){var aj=ak.selectAll("stop").data(ai);
aj.enter().append("stop").attr("class",function(am,al){return"stop"+al
});
aj.attr("offset",function(al){return al
}).attr("stop-color",function(am,al){return ah[al]
})
};
R(aa,P,Q);
R(Y,P,ag);
var af=I.selectAll(".grad-bg").data([H]);
af.enter().append("rect").classed("grad-bg",true);
af.attr("x",K+N).attr("y",0).attr("rx",W/2).attr("ry",W/2).attr("width",T).attr("height",W);
var ae=I.selectAll(".grad-rect").data([H]);
ae.enter().append("rect").classed("grad-rect",true);
ae.classed("grad-rect",true).attr("x",K+N).attr("y",0).style("stroke","url(#darkGradient-"+ac+")").style("fill","url(#defaultGradient-"+ac+")").attr("width",T).attr("height",W);
var M=D.selectAll(".legend-label").data([w,C]);
M.enter().append("div").attr("class",function(ai,ah){return"legend-label "+(ah?"max":"min")
});
M.style("left",function(ai,ah){return(ah?null:Z+"px")
}).style("right",function(ai,ah){return(ah?Z+"px":null)
}).text(function(ai,ah){return h.formatFunction(ah?C:w)
});
if(h.interactive){var J=d3.svg.brush().x(d3.scale.linear().range([0,T])).extent(o).on("brushstart",function(){j=true
}).on("brushend",function(){j=false
}).on("brush",function(){o=J.extent();
t.selectAll(".grad-rect").attr("width",(o[1]-o[0])*T).attr("x",(T*o[0])+K+N);
q.drawGeos(L)
});
var O=9;
var X=26;
var S=I.selectAll(".brush").data([H]);
S.enter().append("g").classed("brush",true);
S.attr("transform","translate("+(K+N)+",0)").call(J);
var ad=S.selectAll(".resize");
var ab=ad.selectAll(".handle").data(function(ah){return ah
});
ab.enter().append("rect").classed("handle",true);
ab.attr("transform","translate("+-(O/2)+","+-O+")").attr("rx",O/3).attr("ry",O/3).attr("width",O).attr("height",X)
}};
q.drawTooltip=function(M){var J=this,K=M==null||M.value==null;
k=D.selectAll(".tooltip").data(K?[]:[M]);
k.enter().append("div").classed("tooltip",true);
k.exit().classed("visible",false);
setTimeout(function(){k.classed("visible",true)
},10);
var I=k.selectAll(".tooltip-back").data([M]);
I.enter().append("div").classed("tooltip-back",true);
var N=I.selectAll(".tt-name").data(function(O){return[O.name]
});
N.enter().append("p").classed("tt-name",true);
N.text(function(O){return O
});
var L=I.selectAll(".tt-value").data(function(O){return[O.value]
});
L.enter().append("p").classed("tt-value",true);
L.text(function(O){return h.formatFunction(O)
});
var p=I.selectAll(".tt-metric").data(typeof h.metric!=="undefined"?[h.metric]:[]);
p.enter().append("p").classed("tt-metric",true);
p.text(function(O){return O
});
p.exit().remove()
};
q.hideTooltip=function(){q.drawTooltip({})
};
q.showTooltip=function(p){if("value" in p&&p.value){q.drawTooltip(p)
}else{q.hideTooltip()
}};
q.drawGeos=function(L){var X=null,K,M,P,Y=1,T=Math.min(s[0],s[1]),W=s[0]-r.left-r.right,U=s[1]-r.top-r.bottom,ab=1,N=[0,0];
if(h.projection){G=d3.geo[h.projection]()
}else{G=d3.geo.equirectangular()
}G.scale(ab).translate(N);
var V=d3.geo.path().projection(G);
var O=V.bounds(L);
ab=0.95/Math.max((O[1][0]-O[0][0])/W,(O[1][1]-O[0][1])/U);
N=[(W-ab*(O[1][0]+O[0][0]))/2,(U-ab*(O[1][1]+O[0][1]))/2];
var aa=(ab*((O[1][1]-O[0][1])/U))*U,I=(ab*((O[1][0]-O[0][0])/W))*W;
G.scale(ab).translate(N);
V=V.projection(G);
if(h.interactive){var p=d3.behavior.zoom(),S=4;
z.call(p.scaleExtent([1,S]).translate([W/2,U/2]).scale(1).on("zoom",function(){if(d3.event){var ak=d3.event.translate,an=d3.event.scale,ah=W/2*an,af=U/2*an,ad=ak[0]-ah,al=ak[1]-af,ag=I/6,am=aa/6,aj=-ah-ag,ae=W-ah+ag,ai=-af-am,ac=U-af+am;
ad=Math.min(ad,ae);
ad=Math.max(ad,aj);
al=Math.min(al,ac);
al=Math.max(al,ai);
ak[0]=ad+ah;
ak[1]=al+af;
p.translate(ak);
B.attr("transform","translate("+ad+","+al+") scale("+an+")")
}}))
}b=((C-w)*o[0])+w;
f=((C-w)*o[1])+w;
K=[b,((f-b)/3)+b,(((f-b)/3)*2)+b,f];
F.selectAll(".legend-label.min").text(function(ad,ac){return h.formatFunction(b)
});
F.selectAll(".legend-label.max").text(function(ad,ac){return h.formatFunction(f)
});
if(h.theme=="salmonRun"){X=d3.scale.linear().domain(K).range(m)
}else{X=d3.scale.linear().domain(K).range(E)
}var J=function(ac){if(typeof(H.values[ac.properties.GEO_ID])=="undefined"||H.values[ac.properties.GEO_ID]<b||H.values[ac.properties.GEO_ID]>f){return"#ddd"
}else{return X(H.values[ac.properties.GEO_ID])
}};
var Q=function(af,ad){if(j){return
}var ag=af.properties.GEO_ID,ac=t.selectAll("#"+ag),ae=ac.node();
ae.parentNode.appendChild(ae);
ac.classed("selected",true);
q.showTooltip({name:af.properties.name,id:af.properties.GEO_ID,value:H.values[af.properties.GEO_ID]})
};
var Z=function(ag,ae){if(j){return
}var ah=ag.properties.GEO_ID,ad=t.selectAll("#"+ah),af=ad.node(),ac=af.parentNode;
ad.classed("selected",false);
q.hideTooltip()
};
var R=B.selectAll(".geo").data(L.features,function(ac){return ac.properties.GEO_ID
});
R.enter().append("path").classed("geo",true).attr("id",function(ad,ac){return ad.properties.GEO_ID
}).attr("vector-effect","non-scaling-stroke").on("mouseover.choro",h.interactive?Q:null).on("mouseout.choro",h.interactive?Z:null);
R.exit().on("mouseover.choro",null).on("mouseout.choro",null);
R.attr("d",V).style("fill",J)
};
q.createSVGContainer=function(){F=d3.select(v);
D=F.selectAll(".cv-choropleth").data([H]);
D.enter().append("div").classed("cv-choropleth",true);
D.style("width",s[0]+"px").style("height",s[1]+"px");
t=D.selectAll("svg").data([H]);
t.enter().append("svg").attr("width","100%").attr("height","100%");
t.exit().remove();
var J=t.selectAll("#plotClip").data([0]);
J.enter().append("clipPath").attr("id","plotClip").append("rect");
J.select("rect").attr("x",r.left).attr("y",r.top).attr("width",s[0]-r.left-r.right).attr("height",s[1]-r.top-r.bottom);
var K=t.selectAll(".container-bg").data([H]);
K.enter().append("rect").classed("container-bg",true).attr("width","100%").attr("height","100%");
z=t.selectAll(".zoom-container").data([H]);
z.enter().append("g").classed("zoom-container",true).attr("clip-path","url(#plotClip)");
var I=z.selectAll(".zoom-container-plot-bg").data([H]);
I.enter().append("rect").classed("zoom-container-plot-bg",true);
I.attr("x",r.left).attr("y",r.top).attr("width",s[0]-r.left-r.right).attr("height",s[1]-r.top-r.bottom);
var p=z.selectAll(".choro-container").data([H]);
p.enter().append("g").classed("choro-container",true);
return p
};
q.data=function(p){if(!arguments.length){return H
}H=p;
return q
};
q.parent=function(p){if(!arguments.length){return v
}v=p;
return q
};
q.options=function(p){if(!arguments.length){return h
}h=p;
return q
};
function l(){this.type="EmptyDataException";
this.message="The data is empty or null";
this.toString=function(){return this.type+" - "+this.message
}
}function n(){this.type="ParentNotSpecifiedException";
this.message="A parent was not specified for this visualization";
this.toString=function(){return this.type+" - "+this.message
}
}return q
};
d3.choropleth.gradIdCounter=0
}(this));
(function(g){var h=g.cloudViz||{},b=h.core||{},d=g.dv||{},f=g.d3||{},a=Object.create(b);
a.init=function(j){this._type="choropleth";
j=j||{};
this._initDefaultOptions();
this.setOptions(j);
this._initChoropleth();
return this
};
a._initDefaultOptions=function(j){var k={geoJson:null,theme:"sunnyDay",metric:"",projection:"equirectangular",format:"decimal",interactive:true};
return Object.getPrototypeOf(a)._initDefaultOptions.call(this,k)
};
a._render=function(){this._configure();
this._choro.layout()
};
a._initChoropleth=function(){this._choro=f.choropleth()
};
a._configure=function(){var k=this,l=this._options,j=this._dataAdapter;
l.formatFunction=function(m){return k._formatNumber(l.format,m)
};
l.metric=j.metric();
l.format=j.format();
l.data=j.data();
this._choro.data(this._options.data).parent(this._options.parent).options(this._options)
};
g.cloudViz.choropleth=h.util.createConstructor(a)
}(this));
(function(a){a.venn=function(k,d,o){o=o||{};
o.distance=o.distance||0;
o.maxIterations=o.maxIterations||500;
var n=o.lossFunction||a.lossFunction;
var g=o.layoutFunction||a.greedyLayout;
k=g(k,d,o.distance);
var l=new Array(2*k.length);
for(var j=0;
j<k.length;
++j){l[2*j]=k[j].x;
l[2*j+1]=k[j].y
}var f=0;
var m=a.fmin(function(p){f+=1;
var r=new Array(k.length);
for(var q=0;
q<k.length;
++q){r[q]={x:p[2*q],y:p[2*q+1],radius:k[q].radius,size:k[q].size}
}return n(r,d)
},l,o);
var h=m.solution;
for(j=0;
j<k.length;
++j){k[j].x=h[2*j];
k[j].y=h[2*j+1]
}return k
};
a.distanceFromIntersectArea=function(g,f,d){if(Math.min(g,f)*Math.min(g,f)*Math.PI<d){return Math.abs(g-f)
}return a.bisect(function(h){return window.circleIntersection.circleOverlap(g,f,h)-d
},0,g+f)
};
a.getDistanceMatrix=function(o,g,p){var q=[],m;
for(m=0;
m<o.length;
++m){q.push([]);
for(var l=0;
l<o.length;
++l){q[m].push(0)
}}for(m=0;
m<g.length;
++m){var n=g[m];
if(n.sets.length!==2){continue
}var k=n.sets[0],r=n.sets[1],h=Math.sqrt(o[k].size/Math.PI),f=Math.sqrt(o[r].size/Math.PI),d=a.distanceFromIntersectArea(h,f,n.size)+p;
q[k][r]=q[r][k]=d
}return q
};
a.greedyLayout=function(f,L,q){var n={},w,J,H;
for(J=0;
J<f.length;
++J){n[J]=[];
f[J].radius=Math.sqrt(f[J].size/Math.PI);
f[J].x=f[J].y=0
}for(J=0;
J<L.length;
++J){var A=L[J];
if(A.sets.length!==2){continue
}var r=A.sets[0],K=A.sets[1];
if(!n[r]||!n[K]){continue
}n[r].push({set:K,size:A.size});
n[K].push({set:r,size:A.size})
}var u=[];
for(w in n){if(n.hasOwnProperty(w)){var z=0;
for(J=0;
J<n[w].length;
++J){z+=n[w][J].size
}u.push({set:w,size:z})
}}if(!u.length){return f
}function B(k,j){return j.size-k.size
}u.sort(B);
var g={};
function v(j){return j.set in g
}function F(j,k){f[k].x=j.x;
f[k].y=j.y;
g[k]=true
}F({x:0,y:0},u[0].set);
var s=a.getDistanceMatrix(f,L,q);
for(J=1;
J<u.length;
++J){var G=u[J].set,d=n[G].filter(v);
w=f[G];
d.sort(B);
if(d.length===0){throw"Need overlap information for set "+w
}var I=[];
for(H=0;
H<d.length;
++H){var o=f[d[H].set],N=s[G][d[H].set];
I.push({x:o.x+N,y:o.y});
I.push({x:o.x-N,y:o.y});
I.push({y:o.y+N,x:o.x});
I.push({y:o.y-N,x:o.x});
for(var E=H+1;
E<d.length;
++E){var m=f[d[E].set],M=s[G][d[E].set];
var D=window.circleIntersection.circleCircleIntersection({x:o.x,y:o.y,radius:N},{x:m.x,y:m.y,radius:M});
for(var C=0;
C<D.length;
++C){I.push(D[C])
}}}var h=1e+50,t=I[0];
for(H=0;
H<I.length;
++H){f[G].x=I[H].x;
f[G].y=I[H].y;
var p=a.lossFunction(f,L);
if(p<h){h=p;
t=I[H]
}}F(t,G)
}return f
};
a.classicMDSLayout=function(h,j){var f=a.getDistanceMatrix(h,j,0);
var d=window.mds.classic(f);
for(var g=0;
g<h.length;
++g){h[g].x=d[g][0];
h[g].y=d[g][1];
h[g].radius=Math.sqrt(h[g].size/Math.PI)
}return h
};
a.lossFunction=function(m,f){var g=0;
function h(p){return p.map(function(q){return m[q]
})
}for(var k=0;
k<f.length;
++k){var d=f[k],n;
if(d.sets.length==2){var j=m[d.sets[0]],o=m[d.sets[1]];
if(j==null||o==null){n=0
}else{n=window.circleIntersection.circleOverlap(j.radius,o.radius,window.circleIntersection.distance(j,o))
}}else{n=window.circleIntersection.intersectionArea(h(d.sets))
}var l=(d.weight==null)?1:d.weight;
g+=l*(n-d.size)*(n-d.size)
}return g
};
a.scaleSolution=function(p,h,s,q){var l=function(v){var t=Math.max.apply(null,p.map(function(w){return w[v]+w.radius
})),u=Math.min.apply(null,p.map(function(w){return w[v]-w.radius
}));
return{max:t,min:u}
};
h-=2*q;
s-=2*q;
var f=l("x"),k=l("y"),j=(f.max-f.min),o=(k.max-k.min),n=j?h/j:0,d=o?s/o:0,g=Math.min(d,n);
for(var m=0;
m<p.length;
++m){var r=p[m];
r.radius=g*r.radius;
r.x=q+(r.x-f.min)*g;
r.y=q+(r.y-k.min)*g
}p.scaling=g;
return p
};
function b(f,d){var h=new Array(f[1].length||0);
for(var g=0;
g<h.length;
++g){h[g]=f[0]*f[1][g]+d[0]*d[1][g]
}return h
}a.bisect=function(h,o,n,r){r=r||{};
var l=r.maxIterations||100,m=r.tolerance||1e-10,k=h(o),j=h(n),q=n-o;
if(k*j>0){throw"initial bisect points must have opposite signs"
}if(k===0){return o
}if(j===0){return n
}for(var g=0;
g<l;
++g){q/=2;
var p=o+q,d=h(p);
if(d*k>=0){o=p
}if((Math.abs(q)<m)||(d===0)){return p
}}return o+q
};
a.fmin=function(D,E,m){m=m||{};
var v=m.maxIterations||E.length*200,n=m.nonZeroDelta||1.1,g=m.zeroDelta||0.001,I=m.minErrorDelta||0.00001,h=m.rho||1,H=m.chi||2,F=m.psi||-0.5,s=m.sigma||0.5,k=m.callback;
var p=E.length,q=new Array(p+1);
q[0]=E;
q[0].fx=D(E);
for(var C=0;
C<p;
++C){var z=E.slice();
z[C]=z[C]?z[C]*n:g;
q[C+1]=z;
q[C+1].fx=D(z)
}var t=function(j,f){return j.fx-f.fx
};
for(var d=0;
d<v;
++d){q.sort(t);
if(k){k(q)
}if(Math.abs(q[0].fx-q[p].fx)<I){break
}var r=new Array(p);
for(C=0;
C<p;
++C){r[C]=0;
for(var B=0;
B<p;
++B){r[C]+=q[B][C]
}r[C]/=p
}var w=q[p];
var G=b([1+h,r],[-h,w]);
G.fx=D(G);
var u=G;
if(G.fx<=q[0].fx){var A=b([1+H,r],[-H,w]);
A.fx=D(A);
if(A.fx<G.fx){u=A
}}else{if(G.fx>=q[p-1].fx){var l=false;
var o;
if(G.fx<=w.fx){o=b([1+F,r],[-F,w]);
o.fx=D(o);
if(o.fx<w.fx){u=o
}else{l=true
}}else{o=b([1-F*h,r],[F*h,w]);
o.fx=D(o);
if(o.fx<=G.fx){u=o
}else{l=true
}}if(l){for(C=1;
C<q.length;
++C){q[C]=b([1-s,q[0]],[s-1,q[C]]);
q[C].fx=D(q[C])
}}}}q[p]=u
}q.sort(t);
return{f:q[0].fx,solution:q[0]}
};
a.drawD3Diagram=function(l,k,g,v,u){u=u||{};
var j=d3.scale.category10(),n=u.circleFillColours||j,p=u.circleStrokeColours||n,s=u.circleStrokeWidth||function(w){return 0
},h=u.textFillColours||j,q=u.textStrokeColours||h,d=u.opacity||0.3,r=u.padding||6;
k=a.scaleSolution(k,g,v,r);
var m=l.append("svg").attr("width",g).attr("height",v);
var f=m.selectAll("circle").data(k).enter().append("g");
var o=f.append("circle").attr("r",function(w){return w.radius
}).style("fill-opacity",d).attr("cx",function(w){return w.x
}).attr("cy",function(w){return w.y
}).style("stroke",function(z,w){return p(w)
}).style("stroke-width",function(z,w){return s(w)
}).style("fill",function(z,w){return n(w)
});
var t=f.append("text").attr("x",function(w){return w.x
}).attr("y",function(w){return w.y
}).attr("text-anchor","middle").style("stroke",function(z,w){return q(w)
}).style("fill",function(z,w){return h(w)
}).text(function(w){return w.label
});
return{svg:m,nodes:f,circles:o,text:t}
};
a.updateD3Diagram=function(g,j){var f=g.select("svg"),h=parseInt(f.attr("width"),10),d=parseInt(f.attr("height"),10);
j=a.scaleSolution(j,h,d,6);
g.selectAll("circle").data(j).transition().duration(400).attr("cx",function(k){return k.x
}).attr("cy",function(k){return k.y
}).attr("r",function(k){return k.radius
});
g.selectAll("text").data(j).transition().duration(400).attr("x",function(k){return k.x
}).attr("y",function(k){return k.y
})
}
}(window.venn=window.venn||{}));
(function(a){var b=1e-10;
a.intersectionArea=function(s,E){var q=d(s);
var A=q.filter(function(j){return a.containedInCircles(j,s)
});
var B=0,r=0,z=[],w;
if(A.length>1){var C=a.getCenter(A);
for(w=0;
w<A.length;
++w){var n=A[w];
n.angle=Math.atan2(n.x-C.x,n.y-C.y)
}A.sort(function(p,j){return j.angle-p.angle
});
var g=A[A.length-1];
for(w=0;
w<A.length;
++w){var h=A[w];
r+=(g.x+h.x)*(h.y-g.y);
var l={x:(h.x+g.x)/2,y:(h.y+g.y)/2},m=null;
for(var t=0;
t<h.parentIndex.length;
++t){if(g.parentIndex.indexOf(h.parentIndex[t])>-1){var k=s[h.parentIndex[t]],G=Math.atan2(h.x-k.x,h.y-k.y),F=Math.atan2(g.x-k.x,g.y-k.y);
var v=(F-G);
if(v<0){v+=2*Math.PI
}var D=F-v/2,o=a.distance(l,{x:k.x+k.radius*Math.sin(D),y:k.y+k.radius*Math.cos(D)});
if((m===null)||(m.width>o)){m={circle:k,width:o,p1:h,p2:g}
}}}z.push(m);
B+=a.circleArea(m.circle.radius,m.width);
g=h
}}else{var f=s[0];
for(w=1;
w<s.length;
++w){if(s[w].radius<f.radius){f=s[w]
}}var u=false;
for(w=0;
w<s.length;
++w){if(a.distance(s[w],f)>Math.abs(f.radius-s[w].radius)){u=true;
break
}}if(u){B=r=0
}else{B=f.radius*f.radius*Math.PI;
z.push({circle:f,p1:{x:f.x,y:f.y+f.radius},p2:{x:f.x-b,y:f.y+f.radius},width:f.radius*2})
}}r/=2;
if(E){E.area=B+r;
E.arcArea=B;
E.polygonArea=r;
E.arcs=z;
E.innerPoints=A;
E.intersectionPoints=q
}return B+r
};
a.containedInCircles=function(f,h){for(var g=0;
g<h.length;
++g){if(a.distance(f,h[g])>h[g].radius+b){return false
}}return true
};
function d(o){var l=[];
for(var m=0;
m<o.length;
++m){for(var h=m+1;
h<o.length;
++h){var f=a.circleCircleIntersection(o[m],o[h]);
for(var g=0;
g<f.length;
++g){var n=f[g];
n.parentIndex=[m,h];
l.push(n)
}}}return l
}a.circleIntegral=function(g,f){var h=Math.sqrt(g*g-f*f);
return f*h+g*g*Math.atan2(f,h)
};
a.circleArea=function(g,f){return a.circleIntegral(g,f-g)-a.circleIntegral(g,-g)
};
a.distance=function(g,f){return Math.sqrt((g.x-f.x)*(g.x-f.x)+(g.y-f.y)*(g.y-f.y))
};
a.circleOverlap=function(j,h,k){if(k>=j+h){return 0
}if(k<=Math.abs(j-h)){return Math.PI*Math.min(j,h)*Math.min(j,h)
}var g=j-(k*k-h*h+j*j)/(2*k),f=h-(k*k-j*j+h*h)/(2*k);
return a.circleArea(j,g)+a.circleArea(h,f)
};
a.circleCircleIntersection=function(r,q){var n=a.distance(r,q),l=r.radius,k=q.radius;
if((n>=(l+k))||(n<=Math.abs(l-k))){return[]
}var o=(l*l-k*k+n*n)/(2*n),m=Math.sqrt(l*l-o*o),j=r.x+o*(q.x-r.x)/n,p=r.y+o*(q.y-r.y)/n,g=-(q.y-r.y)*(m/n),f=-(q.x-r.x)*(m/n);
return[{x:j+g,y:p-f},{x:j-g,y:p+f}]
};
a.getCenter=function(h){var f={x:0,y:0};
for(var g=0;
g<h.length;
++g){f.x+=h[g].x;
f.y+=h[g].y
}f.x/=h.length;
f.y/=h.length;
return f
}
}(window.circleIntersection=window.circleIntersection||{}));
(function(g){var h=g.cloudViz||{},b=h.core||{},d=g.dv||{},f=g.d3||{},a=Object.create(b);
a.init=function(k){var j=this;
this._type="venn";
k=k||{};
this._initDefaultOptions();
this.setOptions(k);
this._cvWrapper=null;
this._seriesState=h.seriesState();
this._seriesState.on("enableChange.venn",function(l,m){j._onEnableState(m)
});
this._dvColorScale=d.scale.ordinal();
return this
};
a._initDefaultOptions=function(j){var k={colors:["#8cc350","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841","#5a6eaa"],legendVerticalWidth:110,duration:500,distance:0};
this._margins={top:0,left:0,right:0,bottom:0};
return Object.getPrototypeOf(a)._initDefaultOptions.call(this,k)
};
a._render=function(){this._id=Math.floor(Math.random()*10000);
this._determineSize();
this._initScales();
this._draw()
};
a._draw=function(){var l=this._options.data;
l.distance=this._options.distance;
this._initSVG();
this._createStates();
this._parsedSetNotation=this._parseSetNotation(l.notation);
this._overlapMap=this._createOverlapMap(l.sets,l.overlaps);
var k=this._drawLegend();
this._positionContainer(k);
var j=this._configureSets(l);
var m=this._generateOverlayCombinations(j,this._parsedSetNotation);
this._drawCircles(j,m)
};
a._onAutoResize=function(){this.render()
};
a._determineSize=function(k){var o=this._options,p=this._dataAdapter.data(),n=o.parent.offsetWidth,l=o.parent.offsetHeight,m=d.util.getPercentValue(o.width,n)||n,j=d.util.getPercentValue(o.height,l)||l;
this._size=[m,j]
};
a._initScales=function(){this._dvColorScale.range(this._options.colors)
};
a._parseSetNotation=function(l){var s=[];
if(!l){return s
}var q=l.split("|"),u=/\d+/g;
var o,k=q.length,n;
for(o=0;
o<k;
o++){n=q[o];
var r=n.match(u);
var m,t=[],v=r.length,p;
for(m=0;
m<v;
m++){t.push(+r[m])
}s.push(t)
}return s
};
a._initSVG=function(){var m=this._options,k=f.select(m.parent);
this._cvWrapper=k.selectAll(".cv-wrapper.cv-venn").data([0]);
this._cvWrapper.enter().append("div").classed("cv-wrapper cv-venn",true);
this._cvWrapper.style("width",this._size[0]+"px").style("height",this._size[1]+"px");
var j=this._cvWrapper.selectAll(".svg-wrapper").data([0]);
j.enter().append("div").classed("svg-wrapper",true);
var l=j.selectAll("svg").data([0]);
l.enter().append("svg");
this._d3Container=l.selectAll("g").data([0]);
this._d3Container.enter().append("g")
};
a._positionContainer=function(j){this._size[0]-=j.left+j.right;
this._size[1]-=j.top+j.bottom;
this._cvWrapper.select(".svg-wrapper").style({"margin-left":j.left+"px","margin-top":j.top+"px","margin-right":j.right+"px","margin-bottom":j.bottom+"px",height:this._size[1]+"px"});
this._cvWrapper.selectAll(".cv-legend").style("height",j.left||j.right?this._size[1]-1+"px":null)
};
a._configureSets=function(m){var l=this._options;
m=this._sanitizeOverlaps(m);
var o=g.venn.scaleSolution(g.venn.venn(m.sets,m.overlaps,{distance:m.distance}),this._size[0],this._size[1],7);
var j,k=o.length,n;
for(j=0;
j<k;
j++){n=o[j];
n.index=j
}return o
};
a._combine=function(o,k,j){if(arguments.length<3){j=o.length-1
}else{j--
}if(arguments.length<2){k=1
}var n=function(t,s,p,r){if(t===0){if(p.length>0){r[r.length]=p
}return
}for(var q=0;
q<s.length;
q++){n(t-1,s.slice(q+1),p.concat([s[q]]),r)
}return
};
var m=[];
for(var l=k;
l<=j+1;
l++){n(l,o,[],m)
}return m
};
a._intersect=function(l,k){var o=[];
for(var n=0;
n<l.length;
n++){for(var m=0;
m<k.length;
m++){if(l[n]==k[m]){o.push(l[n]);
break
}}}return o
};
a._union=function(m,l){var r={};
for(var q=m.length-1;
q>=0;
--q){r[m[q]]=m[q]
}for(var o=l.length-1;
o>=0;
--o){r[l[o]]=l[o]
}var p=[];
for(var n in r){if(r.hasOwnProperty(n)){p.push(r[n])
}}p.sort(function(k,j){return k-j
});
return p
};
a._generateOverlayCombinations=function(n,s){var v=this,m={},u=[],q=[];
s.sort(function(z,w){return w.length-z.length
});
s.forEach(function(z,w){var A=z.join("-");
u=u.concat(v._combine(z,1));
u.forEach(function(F,B){var C=F.join("-"),D=m[C]||{},E;
if(!D.fill){E=v._intersect(z,F);
D.fill=E.join("-")===A
}m[C]=D
})
});
for(var r in m){var p=r.split("-"),j=[],l,t=p.length;
for(l=0;
l<t;
l++){var o=n[p[l]];
if(o){j.push(n[p[l]])
}}var k={};
if(j.length>1){g.circleIntersection.intersectionArea(j,k)
}if(!j.length){k.area=0
}else{k.area=Math.PI*Math.pow(j[0].radius,2)
}q.push({key:r,fill:m[r].fill,area:k.area})
}q.sort(function(z,w){var A=w.area-z.area;
if(A){return A
}return z.key.length-w.key.length
});
return q
};
a._sanitizeOverlaps=function(q){var s=q.sets,l=q.overlaps,p=[],j,o,n,v,m,t,z,u=s.length,r=l.length,k={},w=function(B,A){return +B-+A
};
for(n=0;
n<r;
n++){t=l[n];
t.sets.sort(w);
k[t.sets.join("-")]=t
}for(j=0;
j<u;
j++){v=s[j];
for(o=j+1;
o<u;
o++){m=s[o];
z=false;
if(!k.hasOwnProperty(j+"-"+o)||k[j+"-"+o].size==="0"){p.push({sets:[j,o],size:0})
}}}q.overlaps=l.concat(p);
return q
};
a._createOverlapMap=function(q,l){var k={},n=function(u,j){return u-j
};
var o,t=q.length,s;
for(o=0;
o<t;
o++){s=q[o];
k[o]=s.size
}var m,p=l.length,r;
for(o=0;
o<p;
o++){r=l[o];
r.sets.sort(n);
k[r.sets.join("-")]=r.size
}return k
};
a._drawCircles=function(j,k){this._drawSetHitAreas(j);
this._createClipPaths(j,k);
this._drawFilledRegions(k);
this._drawPadding(j);
this._drawSetFills(j);
this._drawBorders(j);
this._makePlotFit(j)
};
a._drawSetHitAreas=function(l){var k=this,m=this._options;
var j=this._d3Container.selectAll(".set-hit-areas-container").data([l]);
j.enter().append("g").classed("set-hit-areas-container",true);
j.exit().remove();
var n=j.selectAll("circle").data(function(o){return o
});
n.enter().append("circle").attr("r",0).attr("cx",function(o){return o.x
}).attr("cy",function(o){return o.y
}).attr("tooltip",function(o){return o.tooltip
});
n.exit().remove();
n.sort(function(p,o){return o.radius-p.radius
}).on("mouseover",function(p,o){k._seriesState.enableStateByTypeAndId("standard",p.index,true)
}).on("mouseout",function(p,o){k._seriesState.enableStateByTypeAndId("standard",p.index,false)
}).transition().duration(m.duration).attr("r",function(o){return Math.max(o.radius-1,0)
}).attr("cx",function(o){return o.x
}).attr("cy",function(o){return o.y
})
};
a._createClipPaths=function(n,o){var l=this;
var j=this._cvWrapper.select("svg").selectAll("defs").data(o.length?[0]:[]);
j.enter().insert("defs",":first-child");
j.exit().remove();
var k=j.selectAll("clipPath").data(o);
k.enter().append("clipPath");
k.exit().remove();
k.attr("id",function(p){return"clip-"+l._id+"-"+p.key
});
var m=k.selectAll("circle").data(function(r){if(!r.key||!r.key.length){return[]
}var p=r.key.split("-"),q={circleIndex:p.shift()};
if(p.length){q.maskId=p.join("-")
}if(!n||!n[q.circleIndex]){return[]
}return[q]
});
m.enter().append("circle");
m.exit().remove();
m.attr("clip-path",function(p){return p.hasOwnProperty("maskId")?"url(#clip-"+l._id+"-"+p.maskId+")":null
}).attr("r",function(p){return n[p.circleIndex].radius
}).attr("cx",function(p){return n[p.circleIndex].x
}).attr("cy",function(p){return n[p.circleIndex].y
}).style("fill","#FFF")
};
a._drawFilledRegions=function(n){var j=this,l=this._options;
var k=this._d3Container.selectAll(".filled-regions").data(n?[n]:[]);
k.enter().append("g").classed("filled-regions",true);
k.exit().remove();
var m=k.selectAll(".fill-region").data(function(o){return o
});
m.enter().append("rect").classed("fill-region",true);
m.exit().remove();
m.attr("clip-path",function(o){return"url(#clip-"+j._id+"-"+o.key+")"
}).style("opacity",0.000001).attr("width",j._size[0]).attr("height",j._size[1]).classed("overlay",function(o){return o.fill
}).on("mouseover",function(p,o){j._seriesState.enableStateByTypeAndId("highlight","audience",true)
}).on("mouseout",function(p,o){j._seriesState.enableStateByTypeAndId("highlight","audience",false)
}).transition().delay(l.duration).duration(l.duration).style("opacity",1)
};
a._drawPadding=function(k){var l=this._options;
var j=this._d3Container.selectAll(".padding-container").data([k]);
j.enter().append("g").classed("padding-container",true);
j.exit().remove();
var m=j.selectAll("circle").data(function(n){return n
});
m.enter().append("circle").attr("r",0).attr("cx",function(n){return n.x
}).attr("cy",function(n){return n.y
});
m.exit().remove();
m.transition().duration(l.duration).attr("r",function(n){return n.radius
}).attr("cx",function(n){return n.x
}).attr("cy",function(n){return n.y
})
};
a._drawSetFills=function(l){var k=this,m=this._options;
var j=this._d3Container.selectAll(".set-fills-container").data([l]);
j.enter().append("g").classed("set-fills-container",true);
j.exit().remove();
var n=j.selectAll("circle").data(function(o){return o
});
n.enter().append("circle").attr("r",0).attr("cx",function(o){return o.x
}).attr("cy",function(o){return o.y
});
n.exit().remove();
n.style("fill",function(p,o){return k._dvColorScale.mapValue(o)
}).transition().duration(m.duration).attr("r",function(o){return Math.max(o.radius-3,0)
}).attr("cx",function(o){return o.x
}).attr("cy",function(o){return o.y
})
};
a._drawBorders=function(l){var k=this,m=this._options;
var j=this._d3Container.selectAll(".border-container").data([l]);
j.enter().append("g").classed("border-container",true);
j.exit().remove();
var n=j.selectAll("circle").data(function(o){return o
});
n.enter().append("circle").attr("r",0).attr("cx",function(o){return o.x
}).attr("cy",function(o){return o.y
});
n.exit().remove();
n.style("stroke",function(p,o){return k._dvColorScale.mapValue(o)
}).classed("predicted",function(o){return o.predicted
}).transition().duration(m.duration).attr("r",function(o){return o.radius
}).attr("cx",function(o){return o.x
}).attr("cy",function(o){return o.y
})
};
a._createStates=function(){var m=this._options,k=m.data.sets;
if("data" in this._changedOptions&&this._changedOptions.data){this._seriesState.removeStatesByType("standard");
this._seriesState.removeStatesByType("highlight");
this._seriesState.appendState(this._dataAdapter.l10n.labels.venn.definedAudience,"audience","highlight",false);
var j,l=k.length,n=[],o;
for(j=0;
j<l;
j++){o=k[j];
n.push(j);
this._seriesState.appendState(o.label||j,j,"standard",false)
}this._dvColorScale.domain(n)
}};
a._drawLegend=function(){var n=this._options,l=this;
if(!this._legend){this._legend=h.interactiveLegend()
}this._legend.parent(this._cvWrapper.node()).orientation("bottom").chartWidth(this._size[0]).chartHeight(this._size[1]).chartPadding({left:0,top:0,right:0,bottom:0}).validOrientations(["bottom","left"]).legendVerticalWidth(n.legendVerticalWidth).type("line").seriesState(this._seriesState).interactive(false).values(this._calculateValues(this._options.data.sets,this._overlapMap,this._parsedSetNotation))._render(null,{fill:[this._dvColorScale]});
var o=this._legend._getUsedWidth(),k=this._legend._getUsedHeight(),m=k!==0;
var j=this._cvWrapper.selectAll(".cv-legend-entry").on("mouseover",function(p){l._seriesState.enableStateByTypeAndId(p.type,p.id,true)
}).on("mouseout",function(p){l._seriesState.enableStateByTypeAndId(p.type,p.id,false)
});
if(m){j.style("width",function(q,p){return(l._size[0]/(l._options.data.sets.length+1))+"px"
})
}return{left:o,bottom:k,right:0,top:0}
};
a._onEnableState=function(j){this._cvWrapper.selectAll(".set-fills-container circle").style("display",function(l,k){return j.type==="standard"&&j.id===k&&j.enabled?"block":"none"
});
this._cvWrapper.selectAll(".border-container circle").classed("muted",function(l,k){return j.id!==k&&j.enabled
});
this._cvWrapper.selectAll(".filled-regions rect").classed("muted",function(l,k){return j.type==="standard"&&j.enabled
});
this._cvWrapper.selectAll(".padding-container circle").style("display",function(l,k){return j.type==="highlight"&&j.enabled?"none":"block"
});
this._cvWrapper.selectAll(".cv-legend-entry").classed("inactive",function(k){return j.enabled&&(k.id!==j.id||k.type!==j.type)
})
};
a._calculateValues=function(m,p,j){var k=[this._formatNumber("decimal",this._calculateHighlightedValue(m,p,j))],l,n=m.length,o;
for(l=0;
l<n;
l++){o=m[l];
k.push(o.sizeText?o.sizeText:this._formatNumber("decimal",o.size))
}return k
};
a._calculateHighlightedValue=function(k,n,j){var l=function(B,A,z,r){var v=this._combine(A,r,r);
var s,D=v.length,p,o=r%2?1:-1;
for(s=0;
s<D;
s++){p=v[s];
var q,w=p.length,t,u,C=[];
for(q=0;
q<w;
q++){t=p[q];
C=this._union(B[t],C)
}u=C.join("-");
z+=(n.hasOwnProperty(u)?n[u]:0)*o
}r++;
if(r<=B.length){z=l.call(this,B,A,z,r)
}return z
},m=function(q){var o=[],p;
for(p=0;
p<q;
p++){o.push(p)
}return o
};
return l.call(this,j,m(j.length),0,1)
};
a._makePlotFit=function(j){var k=this._options,m={x:0,y:0},o=0,n=0,l=4;
j.forEach(function(p){o=Math.max(o,p.x+p.radius);
n=Math.max(n,p.y+p.radius)
});
if(this._size[0]-o>this._size[1]-n){m.x=(this._size[0]-o)/2-l
}else{m.y=(this._size[1]-n)/2-l
}this._cvWrapper.select("g").attr("transform","translate("+m.x+","+m.y+")")
};
g.cloudViz.venn=h.util.createConstructor(a)
}(this));
(function(f){var g=f.cloudViz||{},a=g.core||{},b=f.dv||{},d=f.d3||{},h=Object.create(a);
h.init=function(j){this._type="sunburst";
this._hiddenNodes=[];
this._outRangeNodes=[];
this._invalidNodes=[];
this._initDefaultOptions();
this.setOptions(j);
return this
};
h._initDefaultOptions=function(){var k="Visits",j={otherColor:"#ccc",otherGrayColor:"#999",outRangeColor:"#5a5a5a",metricColor:"#fff",seqColors:["#faf0c8","#d2dc73","#5faf69","#00505A"],seqColorsHeat:["#5a6eaa","#3287d2","#3cb5a0","#5faf69","#8cc350","#c3d250","#f5c841","#f0a01e","#eb782d","#fa5a50"],colors:["#3287d2","#9b8ce6","#d755a5","#fa5a50","#f0a01e","#c3d250","#5faf69","#1ebed7","#5a6eaa","#78b4f5","#aa5fa5","#f0557d","#e8782d","#f5c841","#8cc350","#3cb5a0","#286eaf","#826ee1","#b93282","#f04641","#e18c00","#a0b400","#50965a","#00a0be","#465a87","#4196e6","#964196","#dc3c69","#dc5f00","#e6b43c","#7daf4b","#32a08c"],padding:{top:10,bottom:60,left:10,right:10}};
return Object.getPrototypeOf(h)._initDefaultOptions.call(this,j)
};
h._onAutoResize=function(){this.resize()
};
h.resize=function(){if(!d.select(this._options.parent).selectAll(".sunburst-cv").node()){return
}this._sizeChart();
this._render(true)
};
h.reset=function(){Object.getPrototypeOf(h).reset.apply(this,arguments)
};
h._preRender=function(){if(this._paths){var D=this._oldKeys=this._dataAdapter.getDataByPathKey(),R,V;
for(R in D){V=D[R];
D[R]={xo:V.x,dxo:V.dx,yo:V.y,dyo:V.dy}
}}Object.getPrototypeOf(h)._preRender.apply(this);
var z=this._options,o=this,K=this._dataAdapter,Q=K.l10n.labels.sunburst,p=d.select(z.parent);
if(K.getSecondaryMetricIndex()){o._hideNode(K.data(),o._invalidNodes,function(k){return o._isInvalidNode(k)
})
}var O=this._hiddenNodes,M=K.getDataByPathKey();
this._hiddenNodes=[];
O.forEach(function(aa,Z){var k=K.getPathKey(aa);
if(M[k]){o._hideNode(M[k],o._hiddenNodes)
}});
var B=this._zoomedPath;
this._zoomedPath=null;
if(B){B=M[K.getPathKey(B)];
this._zoomedPath=this._oldZoomed=B
}var H=this._lockedNode;
this._lockedNode=null;
if(H){if("path"===H.type){H.data=M[K.getPathKey(H.data)];
if(H.data){this._oldLockedNode=H
}}if("category"===H.type){var l=K.categories().some(function(k){if(H.data&&H.data.name===k.name){H.data=k;
return true
}return false
});
if(l){this._oldLockedNode=H
}}}var n=p.selectAll(".sunburst-cv").data([0]);
n.enter().insert("div",":first-child").classed("sunburst-cv",true);
var u=n.selectAll(".sunburst-cv-wrapper").data([0]);
u.enter().insert("div",":first-child").classed("sunburst-cv-wrapper",true);
var I=u.selectAll(".sunburst-cv-container").data([0]);
I.enter().insert("div",":first-child").classed("sunburst-cv-container",true);
var j=I.selectAll(".sunburst-svg").data([0]);
j.enter().append("svg").classed("sunburst-svg",true);
var F=j.selectAll(".sunburst-svg-container").data([0]);
F.enter().append("g").classed("sunburst-svg-container",true);
var m=u.selectAll(".sunburst-cv-label").data([0]);
m.enter().append("div").classed("sunburst-cv-label",true);
var J=m.selectAll(".sunburst-cv-label-wrap").data([0]);
J.enter().append("div").classed("sunburst-cv-label-wrap",true);
var s=J.selectAll(".sunburst-cv-label-metric").data([0]);
s.enter().append("div").classed("sunburst-cv-label-metric",true);
var t=J.selectAll(".sunburst-audiences").data([0]);
t.enter().append("div").classed("sunburst-audiences",true);
t.exit().remove();
var N=n.selectAll(".sunburst-cv-actions-pane").data([0]);
N.enter().append("div").classed("sunburst-cv-actions-pane",true);
N.exit().remove();
var L=N.selectAll(".actions-pane-zoomout").data([0]);
L.enter().append("div").classed("actions-pane-zoomout",true).classed("actions-pane-action",true);
L.html('<i class="icon zoomout"></i><span>'+Q.zoomout+"</span>");
L.on("click",function(){o._zoomPath(K.data())
});
L.exit().remove();
var q=N.selectAll(".actions-pane-hidden").data([0]);
q.enter().append("div").classed("actions-pane-hidden",true).classed("actions-pane-action",true);
q.html('<i class="icon hide"></i><span>'+o._hideLabelText()+"</span>");
q.on("click",function(){o._unhidePaths()
});
q.exit().remove();
var E=u.selectAll(".sunburst-cv-sec-viz").data([0]);
var r=E.enter().append("div").classed("sunburst-cv-sec-viz",true);
r.append("span").classed("title",true);
var w=r.append("span").classed("bar",true);
w.append("span").classed("button",true).classed("color",true).append("span");
w.append("span").classed("button",true).classed("height",true).append("span");
w.append("span").classed("button",true).classed("both",true).append("span");
E.selectAll(".button.color").on("click",function(){K.setSecondaryMetricType("color");
o._secondaryMetricChanged()
}).selectAll("span").html(Q.color);
E.selectAll(".button.height").on("click",function(){K.setSecondaryMetricType("height");
o._secondaryMetricChanged()
}).selectAll("span").html(Q.height);
E.selectAll(".button.both").on("click",function(){K.setSecondaryMetricType("both");
o._secondaryMetricChanged()
}).selectAll("span").html(Q.both);
E.exit().remove();
var G=u.selectAll(".sunburst-cv-secondary").data([0]);
G.enter().append("div").classed("sunburst-cv-secondary",true);
G.exit().remove();
var U=G.selectAll(".sunburst-cv-color").data([0]);
U.enter().append("div").classed("sunburst-cv-color",true);
U.exit().remove();
var P=n.selectAll(".sunburst-cv-info-pane").data([0]);
P.enter().append("div").classed("sunburst-cv-info-pane",true);
P.exit().remove();
var Y=P.selectAll(".info-pane-content").data([0]);
Y.enter().append("div").classed("info-pane-content",true);
Y.exit().remove();
var S=Y.selectAll(".info-pane-categories").data([0]);
S.enter().append("div").classed("info-pane-categories",true).append("div").classed("pane-title",true).append("span");
S.exit().remove();
var W=Y.selectAll(".sunburst-audiences").data([0]);
W.enter().append("div").classed("sunburst-audiences",true).append("div").classed("pane-title",true).append("span").text(Q.audience);
W.exit().remove();
var A=Y.selectAll(".info-pane-actions").data([0]);
A.enter().append("div").classed("info-pane-actions",true);
A.exit().remove();
var C=Y.selectAll(".info-pane-metrics").data([0]);
var X=C.enter().append("div").classed("info-pane-metrics",true);
X.append("div").classed("pane-title",true).classed("pri-metric",true).append("span");
X.append("div").classed("info-pane-metrics-labels",true).classed("pri-metric-labels",true);
X.append("div").classed("pane-title",true).classed("sec-metric",true).append("span");
X.append("div").classed("info-pane-metrics-labels",true).classed("sec-metrics-labels",true).append("span").classed("sec-metrics-help",true);
X.append("div").classed("pane-title",true).classed("rank-chart",true).append("span");
X.append("div").classed("info-pane-metrics-chart",true);
C.exit().remove();
var v=Y.selectAll(".info-pane-extra").data([0]);
v.enter().append("div").classed("info-pane-extra",true);
v.exit().remove();
var T=n.selectAll(".sunburst-cv-mobile-scroll").data([0]);
T.enter().append("div").classed("sunburst-cv-mobile-scroll",true);
T.html(Q.mobilescroll);
T.exit().remove();
this._sizeChart();
n.classed("hiddenpaths",!!this._hiddenNodes.length)
};
h._render=function(E){Object.getPrototypeOf(h)._render.apply(this);
var v=this,m=this._options,A=this._dataAdapter,G=A.data(),o=d.select(m.parent).selectAll(".sunburst-cv"),t=o.selectAll(".sunburst-cv-container"),z=t.selectAll(".sunburst-svg-container"),B=parseInt(t.style("width"),10),w=parseInt(t.style("height"),10),n=this._radius=Math.min(B,w)/2;
var r=this._isMobileSize(),q=(G.categories.length+1),u=this._ringDivisor=1/q,F=r?20:140,j=this._centerRadius=Math.ceil((F/2)/(Math.cos(Math.PI/4)));
z.attr("transform","translate("+(B/2)+","+(w/2)+")");
if(!E&&this._yScale){this._oldYScale=this._yScale
}if(!E&&this._xScale){this._oldXScale=this._xScale
}var I=this._xScale=d.scale.linear().domain(this._oldXScale?this._oldXScale.domain():[0,1]).range([0,2*Math.PI]),l=this._yScale=d.scale.linear().domain([0,u,1]).range([0,j,n]),p=this._arc=d.svg.arc().startAngle(function(J){return Math.max(0,Math.min(2*Math.PI,I(J.x)))
}).endAngle(function(J){return Math.max(0,Math.min(2*Math.PI,I(J.x+J.dx)))
}).innerRadius(function(J){return Math.max(0,l(J.y))
}).outerRadius(function(J){return Math.max(0,l(J.y+J.dy))
});
this._layoutPaths(E);
var s=d.select(m.parent).select(".sunburst-cv-label"),D=Math.ceil((j*Math.cos(Math.PI/4))*2),k=D,C=m.padding.top+Math.floor(w/2-k/2),H=m.padding.left+Math.floor(B/2-D/2);
if(!r){s.style("top",C+"px").style("left",H+"px").style("width",D+"px").style("height",k+"px")
}else{s.style("top","").style("left","").style("width","").style("height","")
}this._updateDetails(this._lockedNode);
if(A.isDataEmpty()){this._setErrorMessage(A.l10n.labels.core.nodata)
}else{if(A.isSizeEmpty()){this._setErrorMessage(A.l10n.labels.sunburst.emptyFirstMetric)
}else{this._clearErrorMessage()
}}};
h._getHiddenNodes=function(){return this._hiddenNodes.concat(this._outRangeNodes,this._invalidNodes)
};
h._adjustDataSize=function(l,m,o){var A=this._options,w=this,t=this._dataAdapter,k=l.depth-1,z=this._zoomedPath,v=0.15,q=t.getStackedMetricIndex();
if(k>=0&&l.metrics&&l.metrics[q]){l.y-=m;
var u=l.metrics[q].value,s=o[k],r=s.max,p=Math.min(0,s.min),n=d.scale.linear().domain([p,r]).range([v,1]),j=n(u)*l.dy;
if(r===p||(z&&z.depth>l.depth)){j=l.dy
}m+=(l.dy-j);
l.dy=j
}if(!l.children||!l.children.length){return
}l.children.forEach(function(B){w._adjustDataSize(B,m,o)
})
};
h._getLevelUniqueNodes=function(l,j,m){var q=this._dataAdapter,n=this._getHiddenNodes(),k=[],o=[],r=this,s=this._zoomedPath;
function p(t){if(s&&s.depth===t.depth&&s!==t){return
}if(t.depth===j){if(!m&&n.indexOf(t)>=0){return
}if(o.indexOf(t.name)>=0){return
}k.push(t);
o.push(t.name);
return
}if(!t.children||!t.children.length){return
}t.children.forEach(function(u){p(u)
})
}p(l);
return k||[]
};
h._layoutPaths=function(I){var n=this._options,r=this._arc,z=this,B=this._dataAdapter,J=B.data(),G=this._getHiddenNodes(),u=d.select(n.parent).selectAll(".sunburst-svg-container"),o=d.layout.partition().value(function(k){return(G.indexOf(k)<0)?k.size:0
}).sort(function(s,k){if(B.isOther(s)){return 1
}if(B.isOther(k)){return -1
}return k.size-s.size
});
if(I&&z._paths){z._paths.each(function(k){k.xo=k.x;
k.dxo=k.dx;
k.yo=k.y;
k.dyo=k.dy
})
}var D=o.nodes(J);
var E=this._paths=u.selectAll("path").data(D,B.getPathKey);
E.enter().insert("path",":first-child");
E.attr("data-sid",function(s,k){return s._sid
}).on("click",function(s,k){z._lockNode({data:s,type:"path"})
}).on("dblclick",function(s,k){z._zoomPath(s)
}).on("mouseenter",function(s,k){if(z._lockedNode||z._isTouch()){return
}z._highlightNode({data:s,type:"path"})
});
var H=E.exit().classed("removing",true);
setTimeout(function(){H.remove()
},501);
z.setColorScale();
this._updatePathColors();
z._buildColorSlider();
var C;
if(C=B.getStackedMetric()){var p=B.getStackedMetricIndex(),w=this._zoomedPath,l=false,A;
if(l){var m=z.getMetricCategoryMinMax(p);
A=Array.apply(null,new Array(J.categories.length)).map(function(){return m
})
}else{A=J.categories.map(function(s,k){return z.getMetricCategoryMinMax(p,k)
})
}z._adjustDataSize(J,0,A)
}if(this._oldKeys){var K,F,q=this._oldYScale,t=q.domain(),v=this._yScale,j=v.domain();
z._paths.each(function(k){K=B.getPathKey(k);
if(F=z._oldKeys[K]){k.xo=F.xo;
k.dxo=F.dxo;
k.yo=v.invert(q(F.yo));
if(B.isRoot(k)){k.dyo=v.invert(q(F.dyo))
}else{k.dyo=v.invert(q(t[1]+F.dyo))-j[1]
}}});
this._oldKeys=null
}E.each(function(s){var k=B.getPathKey(s);
if("undefined"===typeof s.xo){s.xo=s.x;
s.dxo=s.dx;
s.yo=0;
s.dyo=0
}});
E.transition().duration(500).attrTween("d",this._changeTween(true));
u.on("mouseleave",function(s,k){if(z._lockedNode||z._isTouch()){return
}z._unhighlightNode()
});
if(!I){if(this._oldLockedNode){this._lockNode(this._oldLockedNode)
}else{this._unlockNode()
}this._oldLockedNode=null;
this._updateZoomPathStyles(this._oldZoomed);
this._oldZoomed=null
}};
h._isMobileSize=function(){var k=this._options,l=k.parent.offsetWidth,j=b.util.getPercentValue(k.width,l);
return j<640
};
h._isTouch=function(){return"ontouchstart" in document.documentElement
};
h._postRender=function(){Object.getPrototypeOf(h)._postRender.apply(this)
};
h._sizeChart=function(w){var m=this._options,E=this._dataAdapter.data(),p=d.select(m.parent),C=this,v=p.selectAll(".sunburst-cv"),n=v.selectAll(".sunburst-cv-wrapper"),t=n.selectAll(".sunburst-cv-container"),l=v.selectAll(".sunburst-cv-info-pane"),j=v.selectAll(".sunburst-cv-mobile-scroll"),s=m.parent.offsetWidth,k=m.parent.offsetHeight,D=b.util.getPercentValue(m.width,s),z=b.util.getPercentValue(m.height,k),r=this._isMobileSize(),u=D+(r?0:-250),o=r?Math.min(u,z):z,A=m.padding;
var q=u-2-(A.left+A.right),B=o-2-(A.top+A.bottom);
v.style("width",D+"px").style("height",z+"px").classed("is-desktop",!r).classed("not-touch",!this._isTouch());
n.style("width",u+"px").style("height",o+"px");
t.style("width",q+"px").style("height",B+"px");
t.style("padding-top",A.top+"px").style("padding-left",A.left+"px");
j.style("top",(z-30)+"px").classed("visible",!v.node().scrollTop).classed("show",z<=o+130);
v.on("scroll",function(){j.classed("visible",!v.node().scrollTop)
})
};
h._buildColorSlider=function(){var m=this._options,E=this,G=this._dataAdapter,H=d.select(m.parent).selectAll(".sunburst-cv-color");
if(!G.getColorMetric()){return H.text("")
}var P=G.data(),I=G.getColorMetric(),w=this._colorExtent,K=E._colorExtentMin,L=E._colorExtentMax,z=d.select(m.parent).selectAll(".sunburst-cv-container"),v=parseInt(z.style("width"),10),O=v/2,t=G.seqColors(),q=Math.round(100/(t.length-1)),r=[],F=12,A=10,p=9,l=40,n=(F+(A*2)+2),C=O,B=C-(l*2)-(p*2);
t.forEach(function(R,Q){r.push((Q*q)+"%")
});
H.style("width",C+"px");
var N=H.selectAll(".legend-title").data([0]);
N.enter().insert("div",":first-child").classed("legend-title",true);
N.text(I.name);
var k=H.selectAll(".color-slider-legend").data([0]);
k.enter().append("div").classed("color-slider-legend",true);
k.style("width",C+"px").style("height",n+"px");
var D=k.selectAll(".color-slider").data([0]);
D.enter().append("svg").classed("color-slider",true).style("height",n+"px").style("width","100%");
var s=D.selectAll("style").data([0]);
s.enter().append("style");
s.text(function(R){var Q=".sunburst-cv .sunburst-cv-color .grad-rect { fill: url(#backGradient); \n";
return Q
});
var j=D.selectAll("defs").data([0]);
j.enter().append("defs");
var J=j.selectAll("#backGradient").data([0]);
J.enter().append("linearGradient").attr("id","backGradient");
var u=function(T,R,Q){var S=T.selectAll("stop").data(R);
S.enter().append("stop").attr("class",function(V,U){return"stop"+U
});
S.attr("offset",function(U){return U
}).attr("stop-color",function(V,U){return Q[U]
})
};
u(J,r,t);
var M=D.selectAll(".grad-rect").data([0]);
M.enter().append("rect").classed("grad-rect",true);
M.attr("x",l+p).attr("y",A).attr("rx",F/2).attr("ry",F/2).attr("width",B).attr("height",F);
var o=k.selectAll(".legend-label").data(["min","max"]);
o.enter().append("div").attr("class",function(Q){return"legend-label "+Q
});
o.style("left",function(Q){return(Q==="min"?0:l+(p*2)+B)+"px"
}).style("width",l+"px").text(function(R){var Q=R==="min"?K:L;
Q=(null===Q)?(R==="min")?"-":"+":E._formatNumber(I.format,Q);
return Q
})
};
h._isNodeOutsideRange=function(o){var k=this._dataAdapter,l=this,m=o.children||[],j=m.some(function(n){return !l._isNodeOutsideRange(n)
});
return !j&&this.isOutsideRange(o)
};
h._isInvalidNode=function(j){return this._dataAdapter.isOther(j)
};
h._hideLabelText=function(){var k=this._hiddenNodes.length,l=this._dataAdapter.l10n.labels.sunburst,j=(k===1)?l.hidden:l["hidden2+"];
return j.replace(/\{value\}/i,k)
};
h._hideNode=function(m,l,k){var j=this;
if(l.indexOf(m)>-1){return
}if(k&&k(m)||!k){l.push(m)
}if(!m.children||!m.children.length){return
}m.children.forEach(function(n){j._hideNode(n,l,k)
})
};
h._hidePath=function(q,o,m){var l=this._options,j=this._dataAdapter,p=this._paths;
this._hideNode(q,o,m);
this._layoutPaths(true);
if(this._lockedNode&&o.indexOf(this._lockedNode.data)>-1){this._unlockNode()
}if(this._zoomedPath&&o.indexOf(this._zoomedPath)>-1){this._zoomPath(j.data())
}var k=this._hiddenNodes.length,n=d.select(l.parent);
n.selectAll(".actions-pane-hidden").selectAll("span").html(this._hideLabelText());
n.selectAll(".sunburst-cv").classed("hiddenpaths",!!k)
};
h._unhidePaths=function(){this._hiddenNodes=[];
this._layoutPaths(true);
d.select(this._options.parent).selectAll(".sunburst-cv").classed("hiddenpaths",false)
};
h._zoomPath=function(j){if(!this._canZoomIn(j)){return
}this._zoomedPath=j;
this._layoutPaths(true);
this._updateZoomPathStyles(j);
this._updateDetails(this._lockedNode)
};
h._updateZoomPathStyles=function(l){var k=this,j=d.select(this._options.parent).selectAll(".sunburst-cv");
j.classed("zoomed",l&&l.depth>0);
j.selectAll(".sunburst-cv-container").selectAll("path").each(function(m){d.select(this).classed("beyondzoom",m&&l&&m!==l&&m.depth>0&&(m.depth<=l.depth||!k._hasAncestorNode(m,l)));
d.select(this).classed("zoomed",m===l)
})
};
h._changeTween=function(l){var p=this._xScale,o=this._yScale,u=this._zoomedPath||this._dataAdapter.data(),j=this._arc,n=this._radius,k=this._ringDivisor,s=this._centerRadius,r=this._dataAdapter.categories(),q=d.interpolate(p.domain(),[u.x,u.x+u.dx]),m=d.interpolate(o.domain(),(u.y)?[0,k,u.y,1]:[0,k,1]),t=d.interpolate(o.range(),(u.y)?[0,s,s,n]:[0,s,n]);
return function(z,v){var w=d.interpolate({x:z.xo,dx:z.dxo,y:z.yo,dy:z.dyo},z);
return v?function(A){return l?j(w(A)):j(z)
}:function(A){p.domain(q(A));
o.domain(m(A)).range(t(A));
return l?j(w(A)):j(z)
}
}
};
h._updatePathColors=function(){var l=this,k=this._dataAdapter,n=this._getHiddenNodes(),j=d.select(this._options.parent).selectAll(".sunburst-cv"),m=j.classed("node-highlighted");
this._paths.style("fill",function(q){var p=d.select(this),o=m&&(!p.classed("highlighted"));
return l.getNodeColor(q,o)
}).classed("hidden",function(o){return n.indexOf(o)>=0
})
};
h._lockNode=function(m){var k=this,l=k._options,j=k._lockedNode;
if(j&&j.data===m.data&&j.type===m.type){return k._unlockNode(m)
}k._lockedNode=m;
k._highlightNode(m);
k._updateLockedState(m);
setTimeout(function(){d.select(k._options.parent).select(".sunburst-cv-wrapper").on("click.cvpath",function(){if(d.event&&d.event.target&&d.event.target.nodeName==="path"){return
}k._unlockNode()
})
},10)
};
h._unlockNode=function(l){var j=this,k=j._options;
j._lockedNode=null;
j._updateLockedState();
if(l&&!j._isTouch()){j._highlightNode(l)
}else{j._unhighlightNode()
}d.select(j._options.parent).select(".sunburst-cv-container").on("click.cvpath",null)
};
h._highlightNode=function(p){var m=this,n=p&&p.type||"path",o=p&&p.data||null,l=this._getAncestorNodes(o),k={};
k.category=function(q){return q.depth===o.index+1
};
k.item=function(q){return q&&o&&q.name===o.name
};
k.path=function(q){return l.indexOf(q)>=0||(m._lockedNode&&q.parent===o)
};
var j=d.select(this._options.parent).selectAll(".sunburst-cv");
j.classed("node-highlighted",true);
j.selectAll(".sunburst-cv-container").selectAll("path").each(function(q){d.select(this).classed("highlighted",k[n](q))
});
if(!m._lockedNode){j.selectAll(".info-pane-category").each(function(q){d.select(this).classed("disabled","category"===n&&q!==o)
})
}this._updateDetails(p);
this._updatePathColors()
};
h._unhighlightNode=function(){this._removeHighlights();
this._updateDetails()
};
h._removeHighlights=function(){var j=d.select(this._options.parent);
j.selectAll(".sunburst-cv").classed("node-highlighted",false).selectAll("path").classed("highlighted",false);
j.selectAll(".info-pane-category").classed("disabled",false);
this._updatePathColors()
};
h._secondaryMetricChanged=function(){var r=this,p=this._dataAdapter,s=p.l10n.labels.sunburst,l=p.getSecondaryMetricIndex();
r._outRangeNodes=[];
if(l){r._hidePath(p.data(),r._invalidNodes,function(m){return r._isInvalidNode(m)
})
}else{r._invalidNodes=[];
r._layoutPaths(true)
}var k=d.select(this._options.parent);
k.selectAll(".sunburst-cv").classed("secondary-metric",!!l);
var q=k.selectAll(".sunburst-cv-sec-viz");
q.selectAll(".button").classed("active",false);
var o=p.getSecondaryMetricType();
if(o){q.selectAll(".button."+o).classed("active",true)
}var n=p.getSecondaryMetric(),j=n&&n.name||null;
q.selectAll(".title").html(j?s.mapmetric.replace(/\{metric\}/i,j):"");
this._updateDetails(this._lockedNode);
this._updateMetricState()
};
h._updateDetails=function(j){if(j&&j.type==="item"){return
}this._setChartMetrics(j);
this._setDetailsMetrics(j);
this._setDetailsAudiences(j);
this._setDetailsCategories(j);
this._setDetailsActions(j)
};
h._setDetailsCategories=function(r){var v=this,t=this._dataAdapter,w=t.l10n.labels.sunburst,n=t.data(),p=t.categories(),k=d.select(this._options.parent).select(".info-pane-categories"),s=Math.max(0,v._zoomedPath?v._zoomedPath.depth-1:0),q=r&&r.type==="path"&&v._lockedNode?[]:p.slice(s),o=q.length,l=r||{},j=k.selectAll(".info-pane-category").data(q),u=j.enter().append("div").classed("info-pane-category",true).classed("inactive",true);
k.select(".pane-title").select("span").text((1===o.length)?w.category:w["category2+"]);
j.each(function(B,A){var z=d.select(this);
z.text("");
v._createRingMarker(z,o,A);
z.append("span").classed("name",true).html(B&&B.name||"");
z.append("span").classed("top",true).html("("+w.topresults.replace(/\{value\}/i,B.top)+")");
if(l.type==="path"){z.classed("disabled",!v._lockedNode&&l.data&&l.data.depth-1!==A-s)
}else{if(v._lockedNode&&v._lockedNode.type==="category"){z.classed("disabled",B!==v._lockedNode.data)
}}});
setTimeout(function(){u.classed("inactive",false)
},1);
var m=j.exit().classed("inactive",true).on("mouseenter",null).on("mouseleave",null).on("click",null);
setTimeout(function(){m.remove()
},400);
j.on("mouseenter",function(A,z){if(v._lockedNode||v._isTouch()){return
}v._highlightNode({data:A,type:"category"})
});
j.on("mouseleave",function(A,z){if(v._lockedNode||v._isTouch()){return
}v._unhighlightNode()
});
j.on("click",function(A,z){v._lockNode({data:A,type:"category"})
});
k.classed("empty",!q.length)
};
h._setDetailsAudiences=function(s){var w=this,u=this._dataAdapter,t=s&&s.type||"",m=s&&s.data||null,r=t==="category",n=u.data(),k=r?this._getLevelUniqueNodes(n,m.index+1,false):this._getAncestorNodes(m),p=r?function(A,z){return z
}:function(A,z){return A&&A.depth||0
},o=u.categories(),j=d.select(this._options.parent).selectAll(".sunburst-audiences"),q=k&&k[0]||n,l=n===q,v=(!k||l)?[]:k.slice();
j.each(function(D){var F=d.select(this),B=v.slice();
var E=d.select(F.node().parentNode).classed("sunburst-cv-label-wrap");
if(!r&&!E){if(!w._lockedNode){B=[]
}B.reverse()
}else{if(r&&E){B=[]
}}var A=F.selectAll(".sunburst-audience").data(B,p),z=A.enter().append("span").classed("sunburst-audience",true).classed("inactive",true);
z.append("span").classed("marker",true).style("background-color","#dcdcdc");
z.append("span").classed("category",true);
z.append("span").classed("name",true);
A.each(function(J,H){var G=d.select(this),I=o[J.depth-1];
G.select(".marker").style("background-color",w.getNodeColor(J));
G.select(".category").classed("hidden",r||E).text(!r&&I&&I.name||"");
G.select(".name").text(J.name);
G.classed("to-remove",false).attr("my-name",J.name).attr("my-depth",J.depth);
G.on("mouseenter",function(M,L){if(w._isTouch()){return
}w._highlightNode({data:M,type:"item"})
});
G.on("mouseleave",function(M,L){if(w._isTouch()){return
}if(w._lockedNode){w._highlightNode(w._lockedNode)
}else{w._unhighlightNode()
}});
if(E){return
}var K=d.select(G.node().cloneNode(true)).style("height","").classed("test",true).classed("inactive",false);
F.node().appendChild(K.node());
G.attr("my-height",parseInt(K.style("height"),10));
K.remove()
});
A.order();
setTimeout(function(){A.each(function(I,H){var G=d.select(this);
G.classed("inactive",false);
if(E){return
}G.style("height",G.attr("my-height")+"px")
})
},1);
var C=A.exit().classed("inactive",true).style("height","").classed("to-remove",true).on("mouseenter",null).on("mouseleave",null).on("click",null);
setTimeout(function(){C.each(function(I,H){var G=d.select(this);
if(G.classed("to-remove")){G.remove()
}})
},400);
F.classed("empty",!B.length)
})
};
h._setDetailsActions=function(B){var s=this,t=this._dataAdapter,C=t.data(),v=d.select(this._options.parent).select(".info-pane-actions");
var E=v.selectAll(".info-pane-actions-chart").data([0]);
E.enter().append("div").classed("info-pane-actions-chart",true).classed("info-pane-actions-pane",true);
var j=v.selectAll(".info-pane-actions-extra").data([0]);
j.enter().append("div").classed("info-pane-actions-extra",true).classed("info-pane-actions-pane",true);
function A(){s._zoomPath(s._lockedNode.data)
}function l(){s._zoomPath(C)
}function p(){s._hidePath(s._lockedNode.data,s._hiddenNodes)
}function q(){var F=s._lockedNode.data,G=s._hiddenNodes;
if(!F){return
}s._hidePath(C,G,function(H){return H.name===F.name||G.indexOf(H.parent)>=0
})
}var o=[],k=t.l10n.labels.sunburst;
if(B&&B.type==="path"&&s._lockedNode){var z=B.data,n=s._canZoomIn(z),r=z===C;
if(!s._lockedNode){if(!r){o.push({click:false,icon:"more",label:k.moreAction})
}if(n){o.push({click:false,icon:"zoomin",label:k.zoomAction})
}}else{if(!r){if(n){o.push({click:A,className:"zoomin",icon:"zoomin",label:k.zoomin})
}else{if(s._canZoomOut(z)){o.push({click:l,className:"zoomout",icon:"zoomout",label:k.zoomout})
}}o.push({click:p,className:"hide",icon:"hide",label:k.hide});
o.push({click:q,className:"hideallname",icon:"hide",label:k.hideall})
}}}var m=s._getExtraActions(B),u=!!o.length,D=!!m.length;
v.classed("full-width",(!u&&D)||(!D&&u));
v.classed("empty",(!u&&!D));
s._buildActionsPane(E,o);
s._buildActionsPane(j,m);
var w=v.selectAll(".hideallname");
w.on("mouseenter",function(){if(s._isTouch()){return
}s._highlightNode({data:s._lockedNode.data,type:"item"})
});
w.on("mouseleave",function(G,F){if(s._isTouch()){return
}if(s._lockedNode){s._highlightNode(s._lockedNode)
}else{s._unhighlightNode()
}})
};
h._buildActionsPane=function(k,m){var l=k.selectAll(".info-pane-action").data(m);
var n=l.enter().append("a").classed("info-pane-action",true).classed("inactive",true);
n.append("i").classed("icon",true);
n.append("span");
l.each(function(q,p){var o=d.select(this);
o.select(".icon").attr("class","icon").classed(q.icon,true);
o.select("span").text(q.label);
o.attr("class","info-pane-action"+(o.classed("inactive")?" inactive":"")+(q.click||q.href?" action":" help"));
if(q.click){o.on("click",q.click)
}else{o.on("click",null)
}if(q.href){o.attr("href",q.href)
}else{o.attr("href",null)
}if(q.className){o.classed(q.className,true)
}var r=d.select(o.node().cloneNode(true)).style("height","").classed("test",true).classed("inactive",false);
k.node().appendChild(r.node());
o.attr("my-height",parseInt(r.style("height"),10));
r.remove()
});
setTimeout(function(){l.each(function(q,p){var o=d.select(this);
o.style("height",o.attr("my-height")+"px").classed("inactive",false)
})
},1);
var j=l.exit().classed("inactive",true).style("height","").classed("to-remove",true).on("click",null);
setTimeout(function(){j.each(function(q,o){var p=d.select(this);
if(p.classed("to-remove")){p.remove()
}})
},400);
return !!m.length
};
h._setDetailsMetrics=function(s){var w=this,l=d.select(this._options.parent).select(".info-pane-metrics"),m=l.select(".pri-metric-labels"),k=l.select(".sec-metrics-labels"),t=l.select(".info-pane-metrics-chart"),u=this._dataAdapter,o=u.data(),j=o.metrics.slice(0,1),v=o.metrics.slice(1),q=u.categories(),z=u.l10n.labels.sunburst,r=s&&s.type==="path"?s.data:null,n=r||o,p=r&&r.children&&r.children.length&&this._lockedNode;
l.classed("total",!p);
l.selectAll(".pane-title").each(function(D,B){var C=d.select(this),A=C.select("span");
if(C.classed("pri-metric")){return A.text(z.primarymetric)
}if(C.classed("sec-metric")){C.classed("hidden",!v.length);
return A.text(!v.length?"":(v.length===1)?z.secondarymetric:z["secondarymetric2+"])
}if(C.classed("rank-chart")){A.text((p)?q[r.depth]&&q[r.depth].name:"")
}});
l.selectAll(".sec-metrics-help").each(function(B,A){d.select(this).text(v.length===1?z.secondarymetrichelp:z["secondarymetrichelp2+"]).classed("hidden",!v.length)
});
this._setNodeMetricLabels(m,n,j,!!r);
this._setNodeMetricLabels(k,n,v,!!r);
this._setNodeMetricChart(t,this._lockedNode?r:null)
};
h._setChartMetrics=function(n){var j=d.select(this._options.parent).select(".sunburst-cv-label-wrap"),m=this._dataAdapter.data(),k=m.metrics.slice(),l=n&&n.type==="path"?n.data:m;
if(k.length>1){k.length=1
}this._setNodeMetricLabels(j,l,k,false)
};
h._setNodeMetricLabels=function(j,l,q,n){var s=this,r=this._dataAdapter,m=r.data(),t=r.l10n.labels.sunburst,k=j.classed("pri-metric-labels")||j.classed("sunburst-cv-label-wrap"),o=j.selectAll(".sunburst-cv-label-metric").data(q),p=o.enter().append("div").classed("sunburst-cv-label-metric",true);
n=(l&&l.children&&l.children.length&&this._lockedNode)?n:false;
o.each(function(B,C){var J=d.select(this),L=s.getNodeValue(l,k?C:C+1),I=s.getNodeValue(m,k?C:C+1),v="percent"===B.format,w=(r.isOther(l)&&!k)||(0===I),G=v?L:L/s.getNodeValue(m,k?C:C+1),z=k||(C+1)===r.getSecondaryMetricIndex(),F=n&&z,K=null!==L&&!v&&!w&&l!==m;
J.classed("active",z);
var H=J.selectAll(".sunburst-cv-label-icon").data([B]);
H.enter().append("i");
H.each(function(M){d.select(this).attr("class","sunburst-cv-label-icon icon").classed(B.icon||(k?"donut":"stack"),true)
});
var A=J.selectAll(".sunburst-cv-label-number").data([B]);
A.enter().append("span").classed("sunburst-cv-label-number",true);
A.html(w?"":s._formatValue(B,L)).classed("hidden",w);
var u=J.selectAll(".sunburst-cv-label-name").data([B]);
u.enter().append("span").classed("sunburst-cv-label-name",true).append("span");
u.select("span").html(K?t.percmetric.replace(/\{percent\}/i,s._formatNumber("percent",G)).replace(/\{metric\}/i,B.name):B.name);
var E=s.getMetricMaskNum(k?C:C+1);
var D=u.selectAll(".sunburst-cv-label-marker").data([B]);
D.enter().insert("svg",":first-child").classed("sunburst-cv-label-marker",true).append("rect").attr("width",12).attr("height",12);
D.classed("hidden",!F).select("rect").attr("style",(null===E)?"":"mask: url(#diagmask"+E+");");
J.on("click",k?null:function(){r.setSecondaryMetricIndex(C+1);
s._secondaryMetricChanged()
})
});
o.exit().remove()
};
h._formatValue=function(m,o,l){if("time"!==m.format){return this._formatNumber(m.format,o)
}var k=o,j=this._dataAdapter,n=l?j.l10n.time.abbreviation:(1===k)?j.l10n.time.singular:j.l10n.time.plural,p=j.getTimeGranularity(k,true);
return this._formatNumber(m.format,k/p.divisor)+" "+n[p.gran]
};
h._setNodeMetricChart=function(v,H){var A=this,C=this._dataAdapter,S=C.data(),O=A._getHiddenNodes(),o=H&&H.children||[],m=o.filter(function(U){return O.indexOf(U)<0
}),u=[],t=[],L=[],D=[],E=[],P=[],j={x:u,y:t,fill:L,metric:D,format:P,node:E};
function p(U,V){return 0===V||V===C.getSecondaryMetricIndex()
}var I=S.metrics.slice(),B=I.filter(p),G=B.map(function(U){return U.name
});
m.reverse().forEach(function(V){var U;
I.forEach(function(W,X){if(!p(W,X)){return
}if(null!==(U=A.getNodeValue(V,X))){t.push(U);
u.push(V.name);
L.push(W.name);
D.push(W.name);
P.push(W.format);
E.push(V)
}})
});
var R=!!t.length;
var n=v.selectAll(".info-pane-chart-svg").data([0]);
n.enter().append("div").classed("info-pane-chart-svg",true);
n.exit().remove();
v.classed("hidden",!R);
if(R){var K=15,N=25,F=0.05,l=B.length,J=m.length,z=(l*K)+N,T=N/z,q=Math.ceil((l*J*K)/(1-T));
n.style("height",q+"px");
var w=b.chart().layers([b.geom.bar().map("group","fill").set("fill",function(V,U){return A.getNodeColor(V.data.node)
}).each("start",function(W,V){var U=A.getMetricMaskNum(G.indexOf(W.data.metric));
d.select(this).attr("mask",(null===U)?"":"url(#diagmask"+U+")")
}).on("click",function(U){A._selectChildFromRanked(U)
}).dodgePadding(F),b.geom.text().map("label","y").map("group","fill").set("fill","#4b4b4b").textFormat(function(V,U){return V?A._formatValue({format:this.__data__.data.format},V,true):""
}).textAnchor("start").set("fill","#4b4b4b").dx(4).dy(5).on("click",function(U){A._selectChildFromRanked(U)
})]).coord(b.coord.cartesian().flip(true)).data(j).position("dodge").guide("x",b.guide.axis().tickDx(function(V,U){return d.select(this).select("span").node().offsetWidth
}).tickDy(function(V,U){return((-l*K)/2)-(d.select(this).select("span").node().offsetHeight/2)
}).tickSize(0).tickAnchor("end")).guide("y",b.guide.axis().ticks(0).tickSize(0).tickFormat(function(V,U){return""
})).map("x","x",b.scale.ordinal().padding(T)).width("100%").height(q).duration(400).padding({top:2,right:65}).parent(n.node());
G.forEach(function(V,U){var W=b.scale.linear().lowerLimit(0);
W.includeInDomain(function(Y,X){return Y.data.metric===G[U]
});
w.map("y","y",W,U)
});
w.render();
var s=n.select("svg").selectAll("defs").data([0]);
s.enter().append("defs");
var k=[45];
var Q=s.selectAll("pattern").data(k);
var r=Q.enter().append("pattern").attr("id",function(V,U){return"diag"+U
}).attr("patternUnits","userSpaceOnUse").attr("width","3").attr("height","3").attr("patternTransform",function(V,U){return"rotate("+V+" 2 2)"
});
r.append("rect").attr("x","0").attr("y","0").attr("width","3").attr("height","3").attr("style","fill:#fff;");
r.append("path").attr("d","M -1,0 l 10,0").attr("style","stroke:#222; fill:none; stroke-width: 3px;");
var M=s.selectAll("mask").data(k);
M.enter().append("mask").attr("id",function(V,U){return"diagmask"+U
}).attr("x","0").attr("y","0").append("rect").attr("x","0").attr("y","0").attr("width","100%").attr("height","1").attr("style",function(V,U){return"stroke:none; fill:url(#diag"+U+")"
});
s.selectAll("mask").selectAll("rect").attr("height",q)
}else{n.style("height","0px")
}};
h._selectChildFromRanked=function(o){var j=this._lockedNode.data,k=o.data.x;
if(!j||!j.children||!j.children.length){return
}var l,n=j.children.length,p,m=null;
for(l=0;
l<n;
++l){if((p=j.children[l]).name===k){m=p;
break
}}if(m){this._lockNode({data:m,type:"path"})
}};
h._createRingMarker=function(k,o,m){var p=k.append("svg").classed("category-ring",true),q=p.append("g").attr("transform","translate(12,12)"),l=parseInt(p.style("width"),10),s=l/2,r=2,t=1,j=s-(r*o)-(t*(o-1)),v,u,n;
for(n=0;
n<o;
++n){v=j+((r+t)*n);
u=v+r;
q.append("path").classed("active",n===m).attr("d",d.svg.arc().innerRadius(v).outerRadius(u).startAngle(0).endAngle(2*Math.PI))
}};
h._canZoomIn=function(l){var k=this._dataAdapter.data(),j=this._zoomedPath;
return(l!==k&&l!==j)||(l===k&&k!==j&&!!j)
};
h._canZoomOut=function(j){return j===this._zoomedPath
};
h._getAncestorNodes=function(l){var k=[],j=l;
if(!l){return k
}while(j.parent){k.push(j);
j=j.parent
}if(!k.length){k=[l]
}return k
};
h._hasAncestorNode=function(l,j){if(!l||!j||l.depth<j.depth||l===j){return false
}var k=l;
while(k.parent){if(k.parent===j){return true
}k=k.parent
}return false
};
h._getInfoPaneHeight=function(l){var j=0,k;
d.selectAll(l.node().childNodes).each(function(o,m){k=d.select(this);
j+=parseInt(k.style("height"),10)+parseInt(k.style("padding-bottom"),10)+parseInt(k.style("padding-top"),10)
});
return j
};
h._updateLockedState=function(k){var j=this;
if(j._eventMap["sunburst.locked"]){j._eventMap["sunburst.locked"].call(this,k,j._dataAdapter.data())
}};
h._updateMetricState=function(){var k=this,j=k._dataAdapter;
if(k._eventMap["sunburst.metric"]){k._eventMap["sunburst.metric"].call(this,j.getSecondaryMetricIndex(),j.getSecondaryMetricType(),j.data())
}};
h._getExtraActions=function(k){var j=this;
if(j._eventMap["sunburst.actions"]){return j._eventMap["sunburst.actions"].call(this,k,!!this._lockedNode,j._dataAdapter.data())
}return[]
};
h.getNodeValue=function(k,j){if(!k){return 0
}if(k.metrics&&k.metrics.length&&k.metrics[j]&&"undefined"!==typeof k.metrics[j].value){return k.metrics[j].value
}if(j>0){return null
}if("undefined"!==typeof k.size){return k.size
}return k.value
};
h.getMetricCategoryMinMax=function(n,m){var j,r=this,p=this._dataAdapter,k=p.data(),l=this._getHiddenNodes(),s=this._zoomedPath;
function q(t){if(s&&s.depth===t.depth&&s!==t){return
}if("undefined"===typeof m||t.depth===m+1){if(p.isOther(t)){return
}if(l.indexOf(t)>=0){return
}var o=r.getNodeValue(t,n);
if("undefined"===typeof j){j={min:o,max:o}
}else{j.min=Math.min(j.min,o);
j.max=Math.max(j.max,o)
}if(m){return
}}if(!t.children||!t.children.length){return
}t.children.forEach(function(u){q(u)
})
}q(k);
return j||null
};
h.getNodeColor=function(n,j){var k=this._dataAdapter,m=this.getColorScale(n),l;
if(!n.depth){return k.metricColor()
}if(k.isOther(n)){l=k.otherColor()
}else{if(k.getColorMetric()){l=this.isOutsideRange(n)?k.outRangeColor():m(n.metrics[k.getColorMetricIndex()].value)
}else{l=m(n.name)
}}if(j){l=this._grayColor(l,n)
}return l
};
h._grayColor=function(p,o){var j=this._dataAdapter;
if(j.isOther(o)){return j.otherGrayColor()
}var m=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i,l=p&&p.match(m);
if(!l){return p
}var k=[parseInt(l[1],16),parseInt(l[2],16),parseInt(l[3],16)],n=Math.round((0.21*k[0])+(0.71*k[1])+(0.07*k[2]));
return"#"+((1<<24)+(n<<16)+(n<<8)+n).toString(16).slice(1)
};
h.getMetricMaskNum=function(j){return(j===0)?null:0
};
h.isOutsideRange=function(n){var k=this._dataAdapter,l=k.getColorMetric(),j=k.getColorMetricIndex();
if(!l||!n||!n.metrics||"percent"!==l.format){return false
}var m=n.metrics[j].value;
return m>this._colorExtentMax||m<this._colorExtentMin
};
h.getColorScale=function(l){var j=this._dataAdapter,k;
if(!(k=j.getColorMetric())){return this._colorScale
}if("percent"===k.format){return this._colorScale
}return this._categoryColorScales[l.depth-1]
};
h._createColorScale=function(t,p,l,o){var r=this._dataAdapter,j=r.seqColors(),n=((p-l)*t[0])+l,u=((p-l)*t[1])+l,q=u-n,k=j.length-1;
if(o){this._colorExtent=t;
this._colorExtentMin=n;
this._colorExtentMax=u
}var s=[n];
for(var m=1;
m<k;
++m){s.push(((q/k)*m)+n)
}s.push(u);
return d.scale.linear().domain(s).range(j).clamp(true)
};
h.setColorScale=function(o){o=o||[0,1];
var l=this,j=this._dataAdapter,p=j.data(),n;
if(!(n=j.getColorMetric())){this._colorScale=d.scale.ordinal().domain(j.uniques()).range(j.colors());
return
}var m=j.getColorMetricIndex(),k;
if("percent"===n.format){k=l.getMetricCategoryMinMax(m);
this._colorScale=this._createColorScale(o,k.max,k.min,true);
return
}k=p.categories.map(function(r,q){return l.getMetricCategoryMinMax(m,q)
});
this._categoryColorScales=k.map(function(r,q){return l._createColorScale(o,r.max,r.min,!q)
});
this._colorExtentMin=null;
this._colorExtentMax=null
};
f.cloudViz.sunburst=g.util.createConstructor(h)
}(this));
(function(g){var h=g.cloudViz||{},a=h.core||{},d=g.dv||{},f=g.d3||{},b=Object.create(a);
b.init=function(j){this._type="flower";
this._initDefaultOptions();
this.setOptions(j);
this.colorScale=d.scale.color()._d3Scale;
return this
};
b._initDefaultOptions=function(){var j={animationDuration:500,labelFormatter:null,clickHandler:null,onlyUseThreePetalLengths:true,isEmotionChart:true,mouseoverCallback:[null,null],horizontalPadding:70,verticalPadding:30,text_offset:5};
return Object.getPrototypeOf(b)._initDefaultOptions.call(this,j)
};
b._onAutoResize=function(){this._render()
};
b.resize=function(){this._render()
};
b.reset=function(){Object.getPrototypeOf(b).reset.apply(this,arguments)
};
b._preRender=function(){Object.getPrototypeOf(b)._preRender.apply(this)
};
b._setUpLayer=function(j,k){this["layer"+k]=j.selectAll(".flower-cv-svg-group-layer"+k).data([0]);
this["layer"+k].enter().append("g").classed("flower-cv-svg-group-layer"+k,true)
};
b.sprintf=function(j,k){return j.replace(/\{([\w]+)\}/ig,function(m,l){return k[l]
})
};
b._render=function(){Object.getPrototypeOf(b)._render.apply(this);
var p=this;
this._parent=f.select(this._options.parent);
var G=this._parent.selectAll(".cv-wrapper.cv-flower").data([0]);
G.enter().append("div").classed("cv-wrapper cv-flower",true);
var z=G.selectAll(".flower-cv-svg").data([0]);
z.enter().append("svg").classed("flower-cv-svg",true);
this._svg_group=z.selectAll(".flower-cv-svg-group").data([0]);
this._svg_group.enter().append("g").classed("flower-cv-svg-group",true);
this._setUpLayer(this._svg_group,1);
this._setUpLayer(this._svg_group,2);
this._setUpLayer(this._svg_group,3);
this._setUpLayer(this._svg_group,4);
this._setUpLayer(this._svg_group,5);
this._setUpLayer(this._svg_group,6);
var A=this._options.width||parseInt(this._parent.style("width"),10);
var w=this._options.height||parseInt(this._parent.style("height"),10);
G.style("width",A+"px").style("height",w+"px");
var m=A/2;
var v=w/2;
this._svg_group.attr("transform",this.sprintf("translate({width},{height})",{width:m,height:v}));
var H=p._dataAdapter.data();
var q=m-this._options.horizontalPadding;
var t=v-this._options.verticalPadding;
var l=this._options.labelFormatter||function(I){I.append("tspan").attr("class","flower-cv-petal-label").text(function(J){return J.label+" "
});
I.append("tspan").attr("class","flower-cv-petal-label-value").text(function(J){return p._formatNumber("percent",J.value/p._total,0)
})
};
var B=this._options.mouseoverCallback[0]||function(){f.select(this).attr("opacity",1)
};
var u=this._options.mouseoverCallback[1]||function(I){f.select(this).attr("opacity",I.petal_opacity).attr("fill",I.petal_color)
};
this._is_single_mode=this._options.onlyUseThreePetalLengths;
this._petal_size=Math.min(q,t);
this._circle_size=this._petal_size*0.676/2;
this._arc_thickness=this._petal_size*0.027;
this._arc_half_angle=360/H.length/2+0.5;
this._petal_count=H.length;
var C=f.scale.linear().domain([55,185]).range([9,12]).clamp(true);
this._font_size=C(this._petal_size);
var F=[{offset_y:1,fixed_offset_y:0,offset_x:0,location:"middle"},{offset_y:1,fixed_offset_y:0,offset_x:-1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:-0.8,location:"start"},{offset_y:-1,fixed_offset_y:-9,offset_x:-1.5,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:0,location:"middle"},{offset_y:-1,fixed_offset_y:-9,offset_x:1.5,location:"middle"},{offset_y:0,fixed_offset_y:-2.5,offset_x:0.8,location:"end"},{offset_y:1,fixed_offset_y:0,offset_x:1.5,location:"middle"}];
this._total=f.sum(H,function(I){return I.value
});
var D=f.scale.linear().domain([0,H.length]).range([0,360]);
this._getTextOffsetIndex=f.scale.linear().domain([0,360]).rangeRound([0,8]).clamp(true);
this._getSizeZeroToThree=f.scale.linear().domain([0,f.max(H,function(I){return I.value
})]).rangeRound([0,3]);
this._getPetalSize=f.scale.linear().domain([f.min(H,function(I){return I.value
}),f.max(H,function(I){return I.value
})]).rangeRound([this._circle_size+this._arc_thickness+10,this._petal_size]);
d.util.each(H,function(J,I){J.angle=D(I);
p._addPetalSizes(J)
});
this._getTextOffsetScale=function(J){var I=this._getTextOffsetIndex(J);
if(I==8){I=0
}return F[I]
};
var E=this.layer1.selectAll(".flower-cv-gray-petals").data(H);
E.enter().append("path").attr("class","flower-cv-gray-petals").attr("transform",function(I){return"rotate("+I.angle+")"
}).attr("d",p._makePetal(0,0,0,0)).attr("opacity",0);
E.transition().duration(p._options.animationDuration).attr("transform",function(I){return"rotate("+I.angle+")"
}).attr("d",function(I){return p._makePetal(0,0,0,I.full_petal)
}).attr("opacity",function(I){return I.petal_size_number==3?0:1
});
E.exit().transition().duration(p._options.animationDuration).attr("d",p._makePetal(0,0,0,0)).attr("opacity",0).remove();
var s=this.layer2.selectAll(".flower-cv-color-petals").data(H);
s.enter().append("path").attr("class","flower-cv-color-petals").attr("transform",function(I){return"rotate("+I.angle+")"
}).attr("opacity",function(I){return I.petal_opacity
}).attr("d",p._makePetal(0,0,0,0)).attr("fill",function(I){return I.petal_color
}).on("mouseover",B).on("mouseout",u).on("click",function(I){if(p._options.clickHandler){p._options.clickHandler(I)
}});
s.transition().duration(p._options.animationDuration).attr("d",function(I){return p._makePetal(0,0,0,I.petal_size)
}).attr("transform",function(I){return"rotate("+I.angle+")"
}).attr("fill",function(I){return I.petal_color
}).attr("opacity",function(I){return I.petal_opacity
});
s.exit().transition().duration(p._options.animationDuration).attr("d",p._makePetal(0,0,0,0)).attr("opacity",0).remove();
var o=this.layer3.selectAll(".flower-cv-white-arcs").data(H);
var n=f.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness+1).startAngle(-p._arc_half_angle*(Math.PI/180)).endAngle(p._arc_half_angle*(Math.PI/180));
o.enter().append("path").attr("class","flower-cv-white-arcs").attr("transform",function(I){return"rotate("+I.angle+")"
}).attr("fill","white");
o.transition().duration(p._options.animationDuration).attr("d",n).attr("transform",function(I){return"rotate("+I.angle+")"
});
o.exit().remove();
n=f.svg.arc().innerRadius(0).outerRadius(this._circle_size+this._arc_thickness).startAngle(-(p._arc_half_angle-1)*(Math.PI/180)).endAngle((p._arc_half_angle-1)*(Math.PI/180));
var j=this.layer4.selectAll(".flower-cv-color-arcs").data(H);
j.enter().append("path").attr("class","flower-cv-color-arcs").attr("d",n).attr("transform",function(I){return"rotate("+I.angle+")"
}).attr("fill",function(I){return I.arc_color
});
j.transition().duration(p._options.animationDuration).attr("d",n).attr("fill",function(I){return I.arc_color
}).attr("transform",function(I){return"rotate("+I.angle+")"
});
j.exit().remove();
var r=this.layer5.selectAll(".flower-cv-petal-labels").data(H);
r.enter().append("text").attr("class","flower-cv-petal-labels").attr("x",0).attr("y",0).attr("text-anchor",function(I){return p._getTextOffsetScale(I.angle).location
}).attr("dx",function(I){return p._getTextOffsetScale(I.angle).offset_x*-p._options.text_offset
}).attr("dy",function(I){return p._getTextOffsetScale(I.angle).offset_y*-p._options.text_offset-p._getTextOffsetScale(I.angle).fixed_offset_y
}).style("font-size",p._font_size).attr("transform",function(I){return"rotate("+I.angle+") rotate("+-I.angle+", 0, "+0+")"
}).attr("opacity",0);
r.style("font-size",p._font_size+"px").attr("text-anchor",function(I){return p._getTextOffsetScale(I.angle).location
}).attr("dx",function(I){return p._getTextOffsetScale(I.angle).offset_x*-p._options.text_offset
}).attr("dy",function(I){return p._getTextOffsetScale(I.angle).offset_y*-p._options.text_offset-p._getTextOffsetScale(I.angle).fixed_offset_y
}).selectAll("*").remove();
l(r);
r.transition().duration(p._options.animationDuration).attr("y",function(I){return I.petal_size
}).attr("transform",function(I){return"rotate("+I.angle+") rotate("+-I.angle+", 0, "+I.petal_size+")"
}).attr("opacity",function(I){return I.petal_number_size===0?0:1
});
r.exit().remove();
var k=this.layer6.selectAll(".flower-cv-main-circle").data([1]);
k.enter().append("circle").attr("class","flower-cv-main-circle").attr("cx",0).attr("cy",0);
k.transition().duration(p._options.animationDuration).attr("r",p._circle_size)
};
b._makePetal=function(r,o,k,p){var m=this._circle_size+this._arc_thickness+1,q=(m*2*Math.PI)/this._petal_count/2,l=q/(m*2*Math.PI)*360,n=Math.cos(l*Math.PI/180)*m,j=Math.sin(l*Math.PI/180)*m;
o=-n;
var t=r-j,z=r+j,v=(p-o)*-1*0.6,u=(p-o)*-1,s=u*0.2,w=["M",t,o,"C",t-s,o-v,r,p,k,p,"C",k,p,z+s,o-v,z,o];
return w.join(" ")
};
b._addPetalSizes=function(p){if(!p.color){p.color=this.colorScale(p.label)
}var m=this._getSizeZeroToThree(p.value);
if(!this._is_single_mode){if(m===0){m=1
}}if(p.value===0){m=0
}var l=0.9;
var j=p.color;
var k=j;
var n=this._petal_size;
var q=n*-1;
switch(m){case 0:l=0;
k="#e6e6e6";
n=0;
j=j;
break;
case 3:l=0.9;
break;
case 2:l=0.75;
n=n*0.795;
break;
case 1:l=0.5;
n=n*0.6;
break
}if(!this._is_single_mode){n=this._getPetalSize(p.value)
}if(p.value===0){n=0
}n*=-1;
p.petal_opacity=l;
p.petal_size=n;
p.petal_color=j;
p.full_petal=q;
p.petal_number_size=m;
p.arc_color=k
};
g.cloudViz.flower=h.util.createConstructor(b)
}(this));
(function(g){var h=g.cloudViz||{},f=h.dvcore||{},b=g.dv||{},d=g.d3||{},a=Object.create(f);
a.init=function(j){Object.getPrototypeOf(a).init.apply(this,arguments);
this._type="funnel";
this._chart=b.chart();
this._avgColor="#b1b1b1";
return this
};
a._initDefaultOptions=function(){var j={averageSeries:null,averageSeriesLabel:null,disableAverage:false,normalized:true,formats:{x:"decimal",y:"decimal"},tooltipContent:null};
return Object.getPrototypeOf(a)._initDefaultOptions.call(this,j)
};
a.reset=function(){Object.getPrototypeOf(a).reset.apply(this,arguments)
};
a._setChartTypeOptions=function(){var v=this._chart,k=this._options,w=this,A=this._dataAdapter,I=this._getPropMapping("series"),H=0,G=100,j=28,s=this._isNormalized()&&!A.isSingleSeries()?j:30,E=this._getChartWidth()-(s*2),C=0.05,q=A.getNumBarsPerStep(),m=A.getNumSteps(),o=(m*(q+1))-1,u=Math.min(Math.max(H,E/o),G),z=A.isSingleSeries()?u/3:u,r=u>=36?12:u>=28?10:0,p=(q*u)+z,F=z/p,B=u===G?(E-((p*m)-z))/2/p:0;
this._stepWidth=q*u;
this._stepPadding=z;
var n=[b.geom.bar().data(A.currentStepData()).dodgePadding(C).each("start",function(J,l){d.select(this).attr("legend-group",J.fill)
}),b.geom.bar().data(A.previousStepData()).dodgePadding(C).set("alpha",0.15).each("start",function(J,l){d.select(this).attr("legend-group",J.fill)
}),b.geom.text().data(A.textStepData()).each("start",function(J,l){d.select(this).attr("legend-group",J.group).classed("cv-funnel-text")
}).map("label","cv_label").map("group",I).set("fill","#666").textAnchor("middle").dy(-5).textFormat(function(l){return w._formatNumber("percent",l)
}).set("size",r)];
if(A.isSingleSeries()){n.splice(1,1)
}if(!k.interactive&&A.averageStepData()&&(!A.isAvgCalculated()||!A.isSingleSeries())){var t={x:[0],y:[0],cvfake:["cvfakeline"]};
n.push(b.geom.line().data(t).map("stroke","cvfake",b.scale.color().values([this._avgColor])));
var D=this._legend;
v.guide("stroke",this._buildStandardLegend([A.averageDataLabel()]));
this._legend=D
}v.layers(n).data({}).map("fill",I,b.scale.color().values(k.colors)).map("x",this._getPropMapping("x"),b.scale.ordinal().padding(F).outerPadding(B).reverse(k.flip)).guide("fill",this._legend).position("dodge").padding(this._isNormalized()&&!A.isSingleSeries()?{left:s-j,right:s}:{left:s,right:s});
v._layers[0].on("click",this._eventMap.click?this._eventMap.click:null);
this._addBehaviors(v.layers()[A.isSingleSeries()?0:1],k);
this._mapPositionScales(v,k)
};
a._mapPositionScales=function(m,l){var k=this,q=[0,25],o=this._applyForceZero(this._constructScale("y")).rangePadding(q),j=this._getPropMapping("series"),p=this._getPropMapping("y");
if(l.normalized){var n=k._dataAdapter.uniqueFillValues();
n.forEach(function(t,r){var s=(0===r)?o:o.copy();
s.includeInDomain(function(v,u){return v.data[j]===k._dataAdapter.uniqueFillValues()[r]
});
if(r>0){m.map("y",p,s,r)
}})
}m.map("y",p,o,0)
};
a._addBehaviors=function(o,m){var j=d.select(m.parent),p,k=this._dataAdapter,l=this,n=k.l10n.labels.funnel;
if(!this._isSmallChart()&&m.interactive){o.behaviors([b.behavior.rollover().orientation(m.flip?"top":"right").content(function(B,u,t){if(m.tooltipContent){return m.tooltipContent.call(this,B,u,t)
}var C=this.__geom.getExplicitScale("group"),D=B.panel.yScale(B),v=l._yLabelFormat(D.scaleIndex()),E=B.data.cv_tt_val,G=B.data.cv_tt_pval,s=k.getStepName(B.x),w=k.isSingleSeries()&&k.isAvgCalculated()?null:k.averageStepData(),r,A,q,F;
if(w){F=k.averageDataLabel();
r=w[l._getPropMapping("x")].indexOf(B.x);
A=w[l._getPropMapping("y")][r];
q=w[l._getPropMapping("y")][r>0?r-1:0]
}var z='<span class="cv-tooltip-content"><span class="cv-funnel-title">'+n.step+'</span><span class="cv-funnel-series-name">'+s+'</span><span class="cv-funnel-title">'+n.segment+'</span><span class="cv-funnel-metric-name">'+B.data[l._getPropMapping("seriesLabel")]+'</span><span class="cv-funnel-title">'+n.conversion+'</span><span class="cv-funnel-percent-value">'+l._formatYValue(G?E/G:0,"percent")+'</span><span class="cv-funnel-metric-value">'+v(E)+"</span>";
if(w){z+='<span class="cv-funnel-sub-title">'+F+'</span><span class="cv-funnel-percent-value">'+l._formatYValue(q?A/q:0,"percent")+'</span><span class="cv-funnel-metric-value">'+v(A)+"</span>"
}z+='<span class="cv-funnel-title">'+n.fallout+'</span><span class="cv-funnel-percent-value">'+l._formatYValue(G?1-(E/G):0,"percent")+'</span><span class="cv-funnel-metric-value">'+v(G-E)+"</span>";
if(w){z+='<span class="cv-funnel-sub-title">'+F+'</span><span class="cv-funnel-percent-value">'+l._formatYValue(q?1-(A/q):0,"percent")+'</span><span class="cv-funnel-metric-value">'+v(q-A)+"</span>"
}return z+"</span>"
}).showTooltip(function(v,r,q,u,t){var s=d.select(this);
if(!s.classed("path-inactive")){t._showTip.call(this,v,r,q,t);
clearTimeout(p);
j.selectAll(".bar-geom").classed("cv-medium-duration",false).classed("cv-unselected",function(w){return v.x!==w.x||v.fill!==w.fill
});
j.selectAll(".text-geom").classed("cv-medium-duration",false).classed("cv-unselected",function(w){return v.x!==w.x||v.fill!==w.group
});
j.selectAll(".cv-legend-marker").classed("cv-unselected",function(w){return w.id!==v.fill
}).classed("cv-medium-duration",false);
j.selectAll(".avg-geom").classed("cv-unselected",true).classed("cv-medium-duration",false);
if(l._eventMap.mouseover){l._eventMap.mouseover.call(this,v,r,q,u)
}}}).hideTooltip(function(v,r,q,u,t){var s=d.select(this);
if(!s.classed("path-inactive")){t._removeTip.call(this,v,r,q,t);
p=setTimeout(function(){j.selectAll(".bar-geom, .text-geom, .cv-legend-marker, .avg-geom").classed("cv-unselected",false).classed("cv-medium-duration",true);
if(l._eventMap.mouseout){l._eventMap.mouseout.call(this,v,r,q,u)
}},400)
}})])
}};
a._getStepLabel=function(o,l){var j=this._dataAdapter,m=j.getSingleSeriesStepValue(o,l),n=j.getStepName(o),k='<div class="cv-funnel-step-label" style="width: '+Math.floor(this._stepWidth)+'px">';
if(typeof m!=="undefined"){k+='<span class="cv-funnel-step-label-value">'+this._yLabelFormat(0)(m)+"</span>"
}k+='<span class="cv-funnel-step-label-name">'+n+"</span>";
return k+"</div>"
};
a._drawSmall=function(){this._drawLarge()
};
a._drawLarge=function(){var m=this._chart,l=this._options,k=this,j=this._dataAdapter,n=b.guide.axis();
n.htmlLabels(true).tickSize(0).tickAnchor("middle").tickFormat(function(q,p){return k._getStepLabel(q,p)
}).title(this._dataAdapter.xAxisTitle());
m.guide("x",n).guide("y","none");
if(!j.isSingleSeries()){var o=m.padding();
this._checkNormalized();
m.padding(o)
}};
a._renderChart=function(){Object.getPrototypeOf(a)._renderChart.call(this);
this._drawAllLine()
};
a._drawAllLine=function(){var v=this._chart,w=this,m=this._options,z=this._dataAdapter,A=this._isNormalized(),E=v.getTrainedScale("x"),G=v.getTrainedScale("y"),k=z.averageStepData(),l=z.mappings(),t=this._getPropMapping("series"),F=this._getPropMapping("seriesLabel"),s=this._getPropMapping("x"),B=this._getPropMapping("y"),r=Math.min(this._stepPadding/2,5),I=[];
if(k){var J=d.extent(k[B])[1],q=d.scale.linear().domain([0,J]).range([0,z.getUniqueFillExtent(0)[1]]);
k[s].forEach(function(K,M){var L=k[B][M],N=G.mapValue(A?q(L):L);
I.push({x:E.mapValue(K)-r,y:N});
I.push({x:E.mapValue(K)+E.rangeBand()+r,y:N})
})
}var p=d.select(v.parent()).selectAll("svg").selectAll(".cv-funnel-avg-group").data([0]);
p.enter().insert("g",".group").classed("cv-funnel-avg-group",true);
var D=p.selectAll(".avg-group-line").data([0]);
D.enter().append("g").classed("avg-group-line series",true);
var H=p.selectAll(".avg-group-point").data([0]);
H.enter().append("g").classed("avg-group-point series",true);
var u=d.svg.line().x(function(K){return K.x
}).y(function(K){return K.y
}),j=v.duration(),C=v.ease();
var o=D.selectAll(".avg-line").data([I]);
o.enter().append("path").classed("avg-line avg-geom",true);
o.attr("legend-group",z.averageSeries()).transition().duration(j).ease(C).attr("d",u).style("stroke",this._avgColor);
o.exit().remove();
var n=H.selectAll(".avg-dot").data(I);
n.enter().append("circle").classed("avg-dot avg-geom",true);
n.attr("legend-group",z.averageSeries()).style("stroke",this._avgColor).transition().duration(j).ease(C).attr("cx",u.x()).attr("cy",u.y()).attr("r",3);
n.exit().remove()
};
a._createSeriesStates=function(){Object.getPrototypeOf(a)._createSeriesStates.call(this);
if("data" in this._changedOptions&&this._changedOptions.data){var j=this._dataAdapter;
this._seriesState.removeStatesByType("funnel-average");
if(j.averageStepData()){this._seriesState.insertState(j.averageDataLabel(),j.averageSeries(),"funnel-average")
}}};
a._updatePathStates=function(){Object.getPrototypeOf(a)._updatePathStates.call(this);
var k=this,l=this._options,j=this._dataAdapter,m=j.averageSeries();
d.select(l.parent).selectAll(".cv-funnel-avg-group .series [legend-group]").classed("path-inactive",function(){if(!l.interactive){return false
}var n=d.select(this),o=n.attr("legend-group");
if(o===m&&k._seriesState.doesSeriesStateExist(o,"funnel-average")){return !k._seriesState.isSeriesEnabled(o,"funnel-average")
}return n.classed("path-inactive")
})
};
a._isNormalized=function(){return this._options.normalized
};
g.cloudViz.funnel=h.util.createConstructor(a)
}(this));
(function(o){var u=o.cloudViz||{},t=u.core||{},j=o.dv||{},z=o.d3||{},m=Object.create(t);
var n=0.15,B=0.05,w=0.09,r=1+B,l=0.05,A=0.025,s=2,h=14,d=0.1,C=0.75,v=null,q=null;
m.init=function(D){this._type="gauge";
D=D||{};
this._initDefaultOptions();
this.setOptions(D);
return this
};
m._initDefaultOptions=function(D){var E={duration:750,percentOpen:d,showNeedle:true,showAxis:true,ticks:5,tickSubdivisions:0,format:"decimal",fillColor:"#3284d4",minValue:0,maxValue:10,colors:[{color:"#ff3400",alpha:1,from:"0%",to:"33%"},{color:"#faca00",alpha:1,from:"33%",to:"66%"},{color:"#68b672",alpha:1,from:"66%",to:"100%"}],metric:"",value:0};
this._margins={top:0,left:0,right:0,bottom:0};
return Object.getPrototypeOf(m)._initDefaultOptions.call(this,E)
};
m.render=function(){Object.getPrototypeOf(m).render.call(this,arguments);
this._determineSize();
this._initScales();
this._draw();
return this
};
m._onAutoResize=function(){this.render()
};
m._determineSize=function(F){var I=this._options,H=I.parent,G=I.width?I.width:H.offsetWidth,D=I.height?I.height:H.offsetHeight,E=Math.max(d,Math.min(C,I.percentOpen));
if(I.showNeedle){this._margins.bottom=D*0.05
}this._maxAngle=(1-E)*180;
this._minAngle=(1-E)*-180;
G-=this._margins.left+this._margins.right;
this._size=[G,D];
this._radius=Math.min(G-this._margins.left-this._margins.right,D-this._margins.top-this._margins.bottom)/2
};
m._initScales=function(){var D=this._options;
if(D.minValue>D.maxValue){throw new Error("The minimum value is greater than the maximum value.")
}this._scale=z.scale.linear().domain([D.minValue,D.maxValue]).range([0,1])
};
m._draw=function(){this._initSVG();
this._drawTrack();
this._drawAxis();
this._drawSelectedIndicator();
this._drawLabels()
};
m._initSVG=function(){var G=this._options,E=z.select(G.parent);
v=E.selectAll(".cv-wrapper.cv-gauge").data([0]);
v.enter().append("div").classed("cv-wrapper cv-gauge",true);
v.style("width",this._size[0]+"px").style("height",this._size[1]+"px");
var D=v.selectAll(".chart-wrapper").data([0]);
D.enter().append("div").classed("chart-wrapper",true);
var F=D.selectAll("svg").data([0]);
F.enter().append("svg");
q=F.selectAll("g").data([0]);
q.enter().append("g");
q.attr("transform","translate("+(this._size[0]-this._margins.left-this._margins.right)/2+","+(this._size[1]-this._margins.top-this._margins.bottom)/2+")")
};
m._drawTrack=function(){var D=this,H=this._options;
var F=z.svg.arc().innerRadius(this._radius*(1-B-n)).outerRadius(this._radius*(1-B)).startAngle(function(L,J){var I=j.util.isPercentString(L.from)?parseInt(L.from,10)/100:D._scale(L.from),K=(D._maxAngle-D._minAngle)*I+D._minAngle;
return g(K)
}).endAngle(function(L,J){var I=j.util.isPercentString(L.to)?parseInt(L.to,10)/100:D._scale(L.to),K=(D._maxAngle-D._minAngle)*I+D._minAngle;
return g(K)
});
var E=q.selectAll(".arc").data([0]);
E.enter().append("g").classed("arc",true);
var G=E.selectAll("path").data(H.colors);
G.enter().append("path");
G.exit().remove();
G.attr("fill",function(J,I){return J.color
}).attr("opacity",function(J,I){return J.hasOwnProperty("alpha")?J.alpha:1
}).attr("d",F)
};
m._drawAxis=function(){var L=this,D=this._options,K=this._scale.ticks(D.ticks),E=function(O,N,P,M){return function(Q){Q.attr("x1",0).attr("y1",s).attr("x2",0).attr("y2",L._radius*M+s).attr("transform",function(S){var R=f(O,S,N,P);
return"rotate("+f(O,S,N,P)+") translate(0,"+(L._radius*(n+B)-L._radius)+")"
})
}
};
var F=q.selectAll(".axis").data(D.showAxis?[0]:[]);
F.enter().append("g").classed("axis",true);
F.exit().remove();
var J=F.selectAll(".tick").data(K);
J.enter().append("line").classed("tick",true);
J.exit().remove();
J.call(E(this._scale,this._minAngle,this._maxAngle,l));
var G=b(this._scale,K,D.tickSubdivisions);
var H=F.selectAll(".minor-tick").data(G);
H.enter().append("line").classed("minor-tick",true);
H.exit().remove();
H.call(E(this._scale,L._minAngle,L._maxAngle,A));
var I=F.selectAll(".tick-label").data(K);
I.enter().append("text").classed("tick-label",true);
I.exit().remove();
I.attr("transform",function(Q){var P=f(L._scale,Q,L._minAngle,L._maxAngle),N=p(L._scale,Q,L._minAngle,L._maxAngle),O=(L._radius-h)*(1-n-B-l),M=Math.cos(N)*O,R=Math.sin(N)*O;
if(P<-10&&P>-170){M-=3
}if(P>10&&P<170){M+=3
}return"translate("+M+","+R+")"
}).attr("text-anchor",function(N){var M=f(L._scale,N,L._minAngle,L._maxAngle);
if(M>-10&&M<10){return"middle"
}if(M<0){return null
}return"end"
}).attr("dy",".35em").style("font-size",k(L._radius*0.05,8,14)+"px").text(function(M){return L._formatNumber(D.format,M)
})
};
m._drawSelectedIndicator=function(){var D=this._options;
this._drawNeedle(D.showNeedle?[D.value]:[]);
this._drawProgressFill(D.showNeedle?[]:[D.value])
};
m._drawNeedle=function(E){var D=this,G=this._options,F=this._radius*w/2,I=this._radius*r;
var H=q.selectAll(".needle").data(E);
H.enter().append("path").classed("needle",true).attr("transform","rotate("+D._minAngle+")");
H.exit().remove();
H.attr("d","M"+(F/2)+"-"+F+"L0-"+I+"L-"+(F/2)+"-"+F+"C-"+(F*0.8257)+"-"+(F*0.8212)+"-"+(F*1.035)+"-"+(F/2*0.9448)+"-"+(F*1.035)+"-1C-"+(F*1.035)+","+(F/2*0.9078)+"-"+(F*0.5796)+","+(F*0.9314)+",0,"+(F*0.9314)+"S"+(F*1.035)+","+(F/2*0.9078)+","+(F*1.035)+"-1C"+(F*1.035)+"-"+(F/2*0.9448)+","+(F*0.8257)+"-"+(F*0.8212)+","+(F/2)+"-"+F+"z").transition().duration(G.duration).ease("cubic-in-out").attrTween("transform",function(O){var L=this,N=Math.min(G.maxValue,Math.max(G.minValue,O)),M=f(D._scale,N,D._minAngle,D._maxAngle),K=this.__previousD__===undefined?D._minAngle:this.__previousD__,J=z.interpolate(K,M);
return function(P){L.__previousD__=J(P);
return"rotate("+L.__previousD__+")"
}
})
};
m._drawProgressFill=function(E){var D=this,H=this._options,G=z.svg.arc().innerRadius(this._radius*(1-B-n)).outerRadius(this._radius*(1-B)).startAngle(g(D._minAngle)).endAngle(function(I){return g(f(D._scale,I,D._minAngle,D._maxAngle))
});
var F=q.selectAll(".progress").data(E);
F.enter().append("path").classed("progress",true);
F.exit().remove();
F.attr("fill",H.fillColor).transition().duration(H.duration).attrTween("d",function(M){var K=this,L=Math.min(H.maxValue,Math.max(H.minValue,M)),I=this.__previousD__===undefined?H.minValue:this.__previousD__,J=z.interpolate(I,L);
return function(N){K.__previousD__=J(N);
return G(K.__previousD__)
}
})
};
m._drawLabels=function(){var T=this,D=this._options,E=D.value===undefined?[]:[D.value],Q=D.metric===undefined?[]:[D.metric],O=p(this._scale,D.minValue,this._minAngle,this._maxAngle),J=p(this._scale,D.maxValue,this._minAngle,this._maxAngle),F=(this._radius)*(1-n-B),K=(this._radius-h)*(1-n-B-l),R=Math.cos(O)*K+this._radius,N=Math.cos(J)*K+this._radius,M=Math.sin(O)*F+this._radius;
var P=v.selectAll(".label-container").data([0]);
P.enter().append("div").classed("label-container",true);
P.style("left",this._size[0]/2-this._radius+"px");
var L=P.selectAll(".label-title").data(Q);
L.enter().append("span").classed("label-title",true);
L.exit().remove();
L.style("font-size",k(this._radius*0.1,11,18)+"px").classed("multiline-ellipsis",!D.showNeedle).text(String);
var S=P.selectAll(".label-number").data(E),G=Math.max(M,this._radius*1.1);
S.enter().append("span").classed("label-number",true).style("line-height",this._radius*n+"px");
S.exit().remove();
S.style("left",R+"px").style("width",N-R+"px").style("font-size",this._radius*n+"px").text(function(U){return T._formatNumber(D.format,U)
});
if(D.showNeedle){L.style("top",G+this._radius*0.2+"px").style("left",0).style("width",this._radius*2+"px");
S.style("top",G+"px")
}else{var I=k(this._radius*0.1,11,20)*2.3,H=this._radius*(1-B);
L.style("top",H+"px").style("left",this._radius*(n+B+l+0.3)+"px").style("width",this._radius*(1-n-B-l-0.3)*2+"px").style("height",I+"px");
S.style("top",Math.max(H+I,G)+"px")
}};
function p(F,E,D,G){return g(f(F,E,D,G))-g(D)-g(G)-Math.PI/2
}function f(F,E,D,G){return D+(F(E)*(G-D))
}function g(D){return D*Math.PI/180
}function k(F,E,D){return Math.max(E,Math.min(D,F))
}function b(F,J,E){var K=[];
if(E&&J.length>1){var M=a(F.domain()),H=-1,D=J.length,I=(J[1]-J[0])/++E,G,L;
while(++H<D){for(G=E;
--G>0;
){if((L=+J[H]-G*I)>=M[0]){K.push(L)
}}}for(--H,G=0;
++G<E&&(L=+J[H]+G*I)<M[1];
){K.push(L)
}}return K
}function a(E){var F=E[0],D=E[E.length-1];
return F<D?[F,D]:[D,F]
}o.cloudViz.gauge=u.util.createConstructor(m)
}(this));
(function(o){var B=o.cloudViz||{},z=B.core||{},h=o.dv||{},C=o.d3||{},v=Object.create(z);
var n=0,k=0,j=0,u=25,s=0,w=0,d=0,r=/rgba\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]+(?:\.[0-9]+)?|\.[0-9]+)\s*\)/,a=/rgb\(\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*,\s*([0-9]{1,3})\s*\)/,g=C.scale.linear(),f=C.scale.linear(),q=C.scale.ordinal(),p,t,m=true,A;
v.init=function(E){this._type="treemap";
E=E||{};
this._initDefaultOptions();
this.setOptions(E);
return this
};
v._initDefaultOptions=function(E){var F={colors:["#8cc350","#5a6eaa","#d755a5","#1ebed7","#f0a01e","#9b8ce6","#3cb5a0","#3287d2","#f0557d","#c3d250","#eb782d","#78b4f5","#5faf69","#aa5fa5","#fa5a50","#f5c841"],layout:"squarify",duration:750,tooltipContent:b};
return Object.getPrototypeOf(v)._initDefaultOptions.call(this,F)
};
v.reset=function(){};
v._preRender=function(){this._determineSize(this._options.data);
this._configureScales(this._options.data);
this._configureLayout()
};
v._render=function(){this._initContainer();
this._draw(this._options.data);
m=false;
return this
};
v._postRender=function(){};
v._determineSize=function(G){var F=this._options,E=F.parent;
n=h.util.getPercentValue(F.width,E.offsetWidth);
k=h.util.getPercentValue(F.height,E.offsetHeight)
};
v._configureScales=function(H){var G=this._options;
q.domain(H.map(function(I){return I.name
})).range(G.colors);
var E=H.hasOwnProperty("dx")?[H.x,H.x+H.dx]:[0,n],F=H.hasOwnProperty("dy")?[H.y,H.y+H.dy]:[0,k];
g.domain(E).range([1,n-2]);
f.domain(F).range([1,k-2])
};
v._configureLayout=function(){A=C.layout.treemap().sticky(true).value(function(E){return E.value||0
}).sort(function(F,E){return F.value-E.value
}).mode(this._options.layout).round(false)
};
v._initContainer=function(){var F=this._options;
var E=C.select(F.parent).selectAll(".cv-wrapper.cv-treemap").data([0]);
E.enter().append("div").classed("cv-wrapper cv-treemap",true);
p=E.selectAll(".chart-wrapper").data([0]);
p.enter().append("div").classed("chart-wrapper",true).style("position","relative");
p.style("width",n+"px").style("height",k+"px");
t=p.selectAll(".node-container").data([0]);
t.enter().append("div").classed("node-container",true).style("overflow","hidden");
t.style("width",n+"px").style("height",(k)+"px")
};
v._draw=function(K){var N=this,E=this._options,L={children:this._options.data},F=A.size([n,k+u]).padding([u,s,d,w]).nodes(L),G=F.filter(function(O){return !O.children
}),M=F.filter(function(O){return O.parent&&O.children
}),J;
var H=t.selectAll(".cv-node").data(F);
var I=H.enter().append("div").classed("cv-node",true).on("click",function(T,Q){if(T.depth>0){var P=C.select(this),V=[];
if(T.children){V=t.selectAll(".second-level").filter(function(X){return(T.children.indexOf(X)>=0)
});
V[0].push(this);
var R=t.selectAll(".cv-node.selected");
var O=[];
if(R[0].indexOf(this)>=0){O=R[0].filter(function(X){var Y=(V[0].indexOf(X)>=0);
return !Y
})
}else{O=V[0].concat(R[0])
}V[0]=O;
N._selectNodes(V)
}else{V=t.selectAll(".cv-node.selected");
var S=V[0].indexOf(this),W;
if(S>=0){V[0].splice(S,1);
W=N._getParentNode(this);
var U=V[0].indexOf(W);
if(U>=0){J=0;
W.__data__.children.forEach(function(X){V.each(function(Y){if(Y==X){J++
}})
});
if(W.__data__.children.length-1===J){V[0].splice(U,1)
}}}else{V[0].push(this);
W=N._getParentNode(this);
J=0;
W.__data__.children.forEach(function(X){V.each(function(Y){if(Y==X){J++
}})
});
if(W.__data__.children.length===J){V[0].push(W)
}}N._selectNodes(V)
}if(N._eventMap.click){N._eventMap.click.call(this,T,Q,C.event)
}}}).on("mouseover",function(T,P){if(!T.children){var Q=C.select(this),S={x:T.x+T.dx/4,y:T.y+T.dy/2-u,width:T.dx/2,height:T.dy/2},O={x:0,y:0,width:p.node().getBoundingClientRect().width,height:p.node().getBoundingClientRect().height},R=null;
Q.classed("hovered",true);
R=E.tooltipContent.call(this,T,P);
h.showTooltip(S,O,R,"top",5,p);
if(N._eventMap.mouseover){N._eventMap.mouseover.call(this,T,P,C.event)
}}}).on("mouseout",function(Q,O){if(!Q.children){var P=C.select(this);
P.classed("hovered",false);
h.removeTooltip(p);
if(N._eventMap.mouseout){N._eventMap.mouseout.call(this,Q,O,C.event)
}}});
I.append("div");
I.call(D).call(l);
H.exit().remove();
H.classed("root-level",function(O){return O.depth===L.depth
}).classed("first-level",function(O){return O.depth===L.depth+1
}).classed("second-level",function(O){return O.depth===L.depth+2
}).call(l).call(D);
H.select("div").text(function(Q){var P=Q.hasOwnProperty("name")&&Q.parent===L?Q.name:null;
var O=Q.hasOwnProperty("label")&&Q.parent===L?Q.label:null;
return O||P
}).style("opacity",function(O){return(O.dx<50||O.dy<25)?0:1
})
};
v._selectNodes=function(E){var F=t.selectAll(".cv-node.selected");
F.classed("selected",false);
E.classed("selected",true)
};
v._getParentNode=function(F){var E;
var G=C.select(this._options.parent).selectAll(".first-level");
G[0].forEach(function(H){if(H.__data__.children.indexOf(F.__data__)>=0){E=H
}});
return E
};
v.setSelected=function(G){var E=this;
var F=C.select(this._options.parent).selectAll(".second-level").filter(G);
F[0].forEach(function(J){var I=E._getParentNode(J),H=0;
if(I){I.__data__.children.forEach(function(K){F.each(function(L){if(L==K){H++
}})
});
if(I.__data__.children.length===H){F[0].push(I)
}}});
E._selectNodes(F);
return E
};
v.getSelected=function(){var F=[];
var E=t.selectAll(".second-level.cv-node.selected");
if(E){E[0].forEach(function(G){F.push(G.__data__)
})
}return F
};
function b(E){return"<span class='series-name'>"+E.parent.name+"</span><span class='metric-value'>"+E.value+"</span><span class='metric-name'>"+E.name+"</span>"
}function D(E){var F=function(G){if(G.depth===1){return 3
}if(G.depth===2){return 1
}return 0
};
E.style("left",function(G){return(g(G.x)+1)+"px"
}).style("top",function(G){if(G.children&&!G.parent){return 0
}return(f(G.y)+1)-u+"px"
}).style("width",function(G){return(g(G.x+G.dx)-g(G.x)-2)+"px"
}).style("height",function(G){if(G.children){return null
}return(f(G.y+G.dy)-f(G.y)-2)+"px"
})
}function l(E){E.style("background-color",function(F){if(F.children||!F.parent){return null
}return q(F.parent.name)
})
}o.cloudViz.treemap=B.util.createConstructor(v)
}(this));
(function(f){var g=f.cloudViz,b=f.dv,d=g.util.namespace("cloudViz.dataAdapter.standard");
var a={};
a._isDataValid=null;
a.process=function(j,h){this._options=j;
this.l10n=g.util.deepExtend({},g.localeDefinition(j.locale),j.l10n||{});
if(!("data" in h)&&!("mappings" in h)){return
}if(!this._validateData(j.data,j.mappings)){return
}this._processOptions(j,h)
};
a._processOptions=function(j,h){};
a._determineOvertime=function(h){var k=this.mappings(),j=h[k.x];
if(!j||!j.length){return false
}return b.util.isDate(j[0])||/^(\d{4}|[+\-]\d{6})(?:-(\d{2})(?:-(\d{2}))?)?(?:T(\d{2}):(\d{2})(?::(\d{2})(?:\.(\d{3}))?)?(?:(Z)|([+\-])(\d{2})(?::(\d{2}))?)?)?$/.test(j[0])
};
a._calculateDateGranularity=function(m){var o=this.mappings(),n=m[o.x];
if(!n||!n.length){return"*"
}n=n.map(function(p){return new Date(p)
});
var k=Math.min.apply(Math,n),h=Math.max.apply(Math,n),j=(h-k)/1000,l=j/n.length;
return this.getTimeGranularity(l).gran
};
a.getTimeGranularity=function(k,j){var h="second",l=1;
if(!k){return{gran:h,divisor:l}
}if(j){if(k>=(l=60*60*24*365)){h="year"
}else{if(k>=(l=60*60*24*31)){h="month"
}else{if(k>=(l=60*60*24*7)){h="week"
}else{if(k>=(l=60*60*24)){h="day"
}else{if(k>=(l=60*60)){h="hour"
}else{if(k>=(l=60)){h="minute"
}else{h="second";
l=1
}}}}}}}else{if(k<=(l=1)){h="second"
}else{if(k<=(l=60)){h="minute"
}else{if(k<=(l=60*60)){h="hour"
}else{if(k<=(l=60*60*24)){h="day"
}else{if(k<=(l=60*60*24*7)){h="week"
}else{if(k<=(l=60*60*24*31)){h="month"
}else{h="year";
l=60*60*24*365
}}}}}}}return{gran:h,divisor:l}
};
a._getYTitleFromLabels=function(j){var h=b.util.uniq(j);
if(h&&h.length===1){return h[0]
}return null
};
a.data=function(){return this._options.data
};
a.mappings=function(){return this._options.mappings
};
a.formats=function(){return this._options.formats
};
a.xAxisTitle=function(){return this._options.xAxisTitle||null
};
a.yAxisTitle=function(){return this._options.yAxisTitle||null
};
a.dateGranularity=function(){return this._processedOptions.dateGranularity
};
a.isDataValid=function(){return this._validateData(this._options.data,this._options.mappings)
};
a._validateData=function(j,k){if(!j){return false
}for(var h in j){if(j[h].length){return true
}}return false
};
d.baseObj=a;
d.base=g.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(b.baseObj);
a._processOptions=function(j,h){var g=this._processedOptions=Object.create(j);
var k=this.data(),l=this.mappings();
if(g.isOvertime==null){g.isOvertime=this._determineOvertime(k);
if(g.isOvertime){g.dateGranularity=g.dateGranularity||this._calculateDateGranularity(k)
}}this._uniqueFillValues=this._processUniqueFillValues(k,l);
this._uniqueFillExtents=this._processUniqueFillExtents(k,l,this._uniqueFillValues);
this._uniqueXValues=this._processUniqueXValues(k,l,g.isOvertime);
Object.getPrototypeOf(a)._processOptions.call(this,g,h)
};
a.isOvertime=function(){return this._processedOptions.isOvertime
};
a.uniqueFillValues=function(){return this._uniqueFillValues||[]
};
a.uniqueFillExtents=function(){return this._uniqueFillExtents
};
a.uniqueXValues=function(){return this._uniqueXValues||[]
};
a.getUniqueFillExtent=function(g){var h=this._uniqueFillValues[g];
if(h){return this._uniqueFillExtents[h]
}return null
};
a.getUniqueFillExtentByFill=function(g){return this._uniqueFillExtents[g]
};
a._processUniqueFillValues=function(h,j){var g=h[j.series];
return g?dv.util.uniq(g):[]
};
a._processUniqueFillExtents=function(j,m,g){var l=j[m.series],k=j[m.y],h={};
k.map(function(p,o){var n=l[o];
if(!isFinite(p)||p===null){return
}if(!h[n]){h[n]=[p,p]
}h[n][0]=Math.min(p,h[n][0]);
h[n][1]=Math.max(p,h[n][1])
});
return h
};
a._processUniqueXValues=function(j,k,h){if(h){return[]
}else{var g=j[k.x];
return g?dv.util.uniq(g):[]
}};
b.barObj=a;
b.bar=f.util.createConstructor(a)
}(this));
(function(f){var g=f.cloudViz,d=g.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(d.baseObj),b=f.d3||{};
a._processOptions=function(j,h){Object.getPrototypeOf(a)._processOptions.apply(this,arguments)
};
a._validateData=function(h,j){if(!h){return false
}return true
};
a.data=function(){return this._options.data
};
a.metric=function(){return this._options.metric
};
a.format=function(){return this._options.format
};
d.choroplethObj=a;
d.choropleth=g.util.createConstructor(a)
}(this));
(function(f){var g=f.cloudViz,d=g.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(d.barObj),b=3;
a._processOptions=function(j,h){this._processCategories(j);
Object.getPrototypeOf(a)._processOptions.call(this,this._processedOptions,h)
};
a._processCategories=function(n){var p=Object.create(n),E=Object.create(n.data),l=n.mappings,A=l.y,r=l.x,m=l.series,o=l.seriesLabel||m,t=[],C,q=E[A].length,z,D=[],w=[],h={},v;
for(C=0;
C<q;
++C){t[C]={};
for(z in E){v=E[z][C];
if(z===m){if(D.length){if(v!==D[D.length-1]){if(D.length===this.maxFacets){q--;
C--;
t.pop();
break
}D[D.length]=v;
w[w.length]=E[o][C];
h[v]=D.length
}}else{D=[v];
w=[E[o][C]];
h[v]=D.length
}}t[C][z]=v
}}this.numFacets=D.length;
t.sort(function(F,k){if(F[m]===k[m]){return k[A]-F[A]
}return h[F[m]]-h[k[m]]
});
for(z in E){E[z]=[]
}E.cvdonutorder=[];
var u=0,s,j,B=this._options.maxSlices;
this.otherIncluded=false;
for(C=0,q=t.length;
C<q;
++C){j=t[C][m];
if(j!==s){u=0;
s=j
}if(u==B-1&&C+1<q&&t[C+1][m]===j){for(z in E){if(!E[z]){E[z]=[]
}E[z][C]=t[C][z]
}this.otherIncluded=true;
E[r][C]=this.l10n.labels.core.other;
++u;
E.cvdonutorder[C]=C;
continue
}if(u>=B){E[A][C-1]+=t[C][A];
t.splice(C,1);
q=t.length;
--C;
++u;
continue
}++u;
for(z in E){E[z][C]=t[C][z]
}E.cvdonutorder[C]=C
}p.yAxisTitle=n.yAxisTitle||w;
p.data=E;
this._processedOptions=p
};
a.processLabelData=function(k){var z=this.data(),n=this.mappings(),B=this._labelData=Object.create(z),q={},u={},s=this,A=B[n.series],l=B[n.y],m=B[n.x];
A.forEach(function(C,D){if(q[C]===undefined){q[C]=0
}if(u[C]===undefined){u[C]=0
}q[C]+=l[D];
if(!k.isSeriesEnabled||k.isSeriesEnabled(m[D])){u[C]+=l[D]
}});
var p=(B.cvtextvalue=[]),r=(B.cvtextperclabel=[]),t=(B.cvtextvallabel=[]),w={},j,h,v,o;
l.forEach(function(C,D){j=A[D];
h=(parseFloat(C)/q[j])*100;
t[D]=C;
r[D]=((h%1!==0)?h.toFixed(1):h)+"%";
o=!k.isSeriesEnabled||k.isSeriesEnabled(m[D]);
v=(parseFloat(C)/u[j])*100;
if(w[j]===undefined){w[j]=0
}p[D]=(o)?w[j]+(v/2):0;
w[j]+=(o)?v:0
})
};
a.data=function(){return this._processedOptions.data
};
a.labelData=function(){return this._labelData
};
a.yAxisTitle=function(h){var j=this._processedOptions.yAxisTitle;
if(j instanceof Array&&j.length>h){j=j[h]
}return j
};
a.showOtherCategory=function(){return this.otherIncluded
};
a.numberOfFacets=function(){return this.numFacets
};
d.donutObj=a;
d.donut=g.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(b.baseObj);
a._processOptions=function(j,h){var g=this._processedOptions=Object.create(j);
var k=this.data(),l=this.mappings();
this._forceZero=j._forceZero;
this._uniqueStrokeValues=this._processUniqueStrokeValues(k,l);
this._uniqueStrokeExtents=this._processUniqueStrokeExtents(k,l);
if(g.isOvertime==null){g.isOvertime=this._determineOvertime(k);
if(g.isOvertime){g.dateGranularity=g.dateGranularity||this._calculateDateGranularity(k)
}}Object.getPrototypeOf(a)._processOptions.call(this,g,h)
};
a.isOvertime=function(){return this._processedOptions.isOvertime
};
a.uniqueStrokeValues=function(){return this._uniqueStrokeValues||[]
};
a.uniqueStrokeExtents=function(){return this._uniqueStrokeExtents
};
a.getUniqueStrokeExtent=function(h){var g=this._uniqueStrokeValues[h];
if(g){return this._uniqueStrokeExtents[g]
}return null
};
a.getUniqueStrokeExtentByStroke=function(g){return this._uniqueStrokeExtents[g]
};
a._processUniqueStrokeValues=function(h,j){var g=h[j.series];
return g?dv.util.uniq(g):[]
};
a._processUniqueStrokeExtents=function(j,l){var g=j[l.series],k=j[l.y],h={};
k.map(function(o,n){var m=g[n];
if(!isFinite(o)||o===null){return
}if(!h[m]){h[m]=[o,o]
}h[m][0]=Math.min(o,h[m][0]);
h[m][1]=Math.max(o,h[m][1])
});
return h
};
b.lineObj=a;
b.line=f.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(b.baseObj);
a.sizeMetricName=function(){return this._options&&this._options.sizeTitle||null
};
a.isBubble=function(){var g=this.mappings()["size"];
return g&&g.length
};
b.pointObj=a;
b.point=f.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(b.baseObj);
a._processOptions=function(q,l){var j=this._processedOptions=Object.create(q),m=JSON.parse(JSON.stringify(q.data));
m.nodesById=[];
m.nodes.map(function(s,r){s._pid=r;
m.nodesById[r]=s;
return s
});
m.links=[];
m.linksById=[];
var g,n,k,h,o,p=this;
m.paths=m.paths.filter(function(r){if(!(r.values instanceof Array)){r.values=Array.apply(null,new Array(r.nodes.length-1)).map(function(){return r.values
})
}if(r.values.some(function(s){return s<=0
})){return false
}r.nodes.map(function(s){return(s!==null)?m.nodes[s]._pid:null
});
return true
});
m.paths.forEach(function(s,r){s.nodes.forEach(function(u,t){if(!t){g=s.nodes[t];
if(g!==null){m.nodesById[g].isPathStart=true;
if(m.nodesById[g].isPathEnd){m.nodesById[g].isPivot=true
}}return
}g=s.nodes[t-1];
n=u;
if(t===s.nodes.length-1){if(n!==null){m.nodesById[n].isPathEnd=true;
if(m.nodesById[n].isPathStart){m.nodesById[n].isPivot=true
}}}k=s.values[t-1];
h=p._generateLinkId(g,n);
if(o=m.linksById[h]){o.value+=k;
o.paths.push(r)
}else{o={source:g,target:n,value:k,paths:[r]};
m.linksById[h]=o;
m.links.push(o)
}})
});
j.data=m;
Object.getPrototypeOf(a)._processOptions.apply(this,arguments)
};
a.data=function(){return this._processedOptions.data
};
a.nodeKey=function(){return function(h,g){return g
}
};
a.linkKey=function(){return function(h,g){return g
}
};
a.pathingTitle=function(){return""
};
a.getPathEnd=function(g){return null
};
a.getPathDirection=function(g){return 0
};
a.activePathsTitle=function(g){return(g&&g.length)?this.l10n.labels.pathing["path2+"]:""
};
a.isValidPathingData=function(){var g=this.data();
if(!g){return false
}if(!g.nodes||!g.paths){return false
}if(!g.nodes.length){return false
}return true
};
a._generateLinkId=function(h,g){return h+"-"+g
};
a._sortPaths=function(j,g){var k=this.data();
return function h(o,m){function l(s,r,v){var A=s+v,t=r+v;
var z=(A<o.nodes.length&&A>=0)?o.nodes[A]:-1,w=(t<m.nodes.length&&t>=0)?m.nodes[t]:-1;
if(z!==-1&&z!==null){z=k.nodes.indexOf(k.nodesById[z])
}if(w!==-1&&w!==null){w=k.nodes.indexOf(k.nodesById[w])
}if(null===z&&null===w){return 0
}if(null===z){return(v>0)?1:-1
}if(null===w){return(v>0)?-1:1
}if(-1===z&&-1===w){return 0
}if(-1===z){return 1
}if(-1===w){return -1
}var u=z-w;
if(u!==0){return u
}return l(A,t,v)
}var p=o.nodes.indexOf(j._pid),n=m.nodes.indexOf(j._pid),q=l(p,n,g);
if(0===q){q=l(p,n,-g)
}if(0!==q){return q
}return m.nodes.length-o.nodes.length
}
};
a._generatePathLinks=function(u,m,p){var k=this.data(),q=this,g,o,l,n,h,t,j,s,r=[];
if(!u||!u.nodes){return r
}u.nodes.forEach(function(z,w,v){if(!w){return
}g=u.nodes[w-1];
o=z;
l=k.nodesById[g]||null;
n=k.nodesById[o]||null;
h=u.values[w-1];
t=null;
if(w>1){t=k.linksById[q._generateLinkId(u.nodes[w-2],g)]
}j=k.linksById[q._generateLinkId(g,o)];
s=(h/j.value)*j.dy;
if(l){r.push({dy:s,sy:(t)?t.ty+t.offset-s:j.sy+j.offset,ty:(!n)?l.dy-s:j.sy+j.offset,source:{x:l.x,y:l.y,dx:0},target:{x:l.x+l.dx,y:l.y},value:h,path:m,pivotStart:l.isPivot})
}r.push({dy:s,sy:j.sy+j.offset,ty:j.ty+j.offset,source:l,target:n,value:h,path:m});
if(w+1===v.length&&n){r.push({dy:s,sy:j.ty+j.offset,ty:j.ty+j.offset,source:{x:n.x,y:n.y,dx:0},target:{x:n.x+n.dx,y:n.y},value:h,path:m,pivotEnd:n.isPivot})
}j.offset+=s
});
return r
};
a.nodePaths=function(g){var h=this.data(),j=h.paths.filter(function(k){return k.nodes.indexOf(g._pid)!==-1
});
return j
};
a.nodePathData=function(m,k){var l=this.data(),j=this,g=[],h=l.links;
h.forEach(function(n){n.offset=0
});
m.sort(j._sortPaths(k,-1));
m.forEach(function(o,n){g=g.concat(j._generatePathLinks(o,n,k))
});
return g
};
a.linkSortActivePaths=function(h){var j=this.data(),l=j.paths,k,g=(h.source)?h.source:h.target;
j.links.forEach(function(m){m.offset=0
});
k=h.paths.map(function(m){return l[m]
});
k.sort(this._sortPaths(g,-1));
return k
};
a.linkPathData=function(j){var g=[],h=this;
j.forEach(function(l,k){g=g.concat(h._generatePathLinks(l,k))
});
return g
};
a.canExpandNode=function(g){return true
};
a.canCollapseNode=function(g){return true
};
a.canPivotNode=function(g){return true
};
b.pathingObj=a;
b.pathing=f.util.createConstructor(a)
}(this));
(function(f){var g=f.cloudViz,d=g.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(d.baseObj),b=f.d3||{};
a._processOptions=function(u,l,p){var h=p||this._processedOptions||{},k=this._processedOptions=Object.create(u);
var o=JSON.parse(JSON.stringify(k.data)),t=o.metrics[0]||{name:"",format:"int"};
function j(v){if(v.metrics&&v.metrics.length&&v.metrics[0]&&"undefined"!==typeof v.metrics[0].value){return v.metrics[0].value
}if(!v.children||!v.children.length){return 0
}return v.children.reduce(function(z,w){return z+j(w)
},0)
}function r(w,v){return j(v)-j(w)
}var m=this.l10n.labels.core.other;
function s(z,B){z.size=("undefined"===typeof z.size)?j(z):z.size;
if(!z.children||!z.children.length){return
}if(B<o.categories.length){var A=o.categories[B],v=z.children.length;
A.top=("undefined"!==typeof A.top)?Math.max(A.top,v):v
}if("undefined"!==typeof z.size&&t.format!=="percent"){var w=z.children.reduce(function(D,C){return D+j(C)
},0);
if(z.size>w){z.children.push({id:"cv-sb-other",name:m,size:z.size-w})
}}z.children.sort(r);
z.children.forEach(function(C){s(C,B+1)
})
}s(o,0);
var q=[];
function n(z,D,C){var v=q[D]||(q[D]=[]),w,A=z.length,B;
for(w=0;
w<A;
++w){B=z[w];
B._sid=C+"s"+w;
if(m===B.name){continue
}if(B.name){v[v.length]=B.name
}if(B.children&&B.children.length){n(B.children,D+1,B._sid)
}}}n([o],0,"");
o.name=t.name;
q.push([t.name]);
o.categories.forEach(function(w,v){w.index=v
});
k.uniques=q.reduce(function(w,v){var z=v.reduce(function(A,B){return(A.indexOf(B)<0)?A.push(B)&&A:A
},[]);
return w.concat(z)
},[]);
k.data=o;
k.categories=o.categories;
k.colorMetricIndex=h.colorMetricIndex;
k.stackedMetricIndex=h.stackedMetricIndex;
k.secondaryMetricIndex=h.secondaryMetricIndex;
k.secondaryMetricType=h.secondaryMetricType;
k.seqColors=k.seqColors;
Object.getPrototypeOf(a)._processOptions.apply(this,arguments)
};
a.data=function(){return this._processedOptions.data
};
a.categories=function(){return this._processedOptions.categories
};
a.uniques=function(){return this._processedOptions.uniques
};
a.colors=function(){return this._processedOptions.colors
};
a.seqColors=function(){return this._processedOptions.seqColors
};
a.metricColor=function(h){return this._processedOptions.metricColor
};
a.otherColor=function(h){return this._processedOptions.otherColor
};
a.otherGrayColor=function(h){return this._processedOptions.otherGrayColor
};
a.outRangeColor=function(h){return this._processedOptions.outRangeColor
};
a.isOther=function(h){return h.name===this.l10n.labels.core.other
};
a.isRoot=function(h){return !h.parent
};
a.isDataEmpty=function(){var h=this.data();
return !(h&&h.children&&h.children.length)
};
a.isSizeEmpty=function(){return !this.data().size
};
a._validateData=function(h){if(!h||!h.children||!h.children.length){return false
}return true
};
a.getPathKey=function(j,h){return j&&j._sid||h
};
a.getDataByPathKey=function(){var m=this.data(),h=this,l={},k;
function j(n){if(!n){return
}k=h.getPathKey(n,null);
if(k){l[k]=n
}if(n.children){n.children.forEach(j)
}}j(m);
return l
};
a.getColorMetric=function(){var h=this._processedOptions.colorMetricIndex;
return(h)?this.data().metrics[h]:null
};
a.getColorMetricIndex=function(){return this._processedOptions.colorMetricIndex
};
a.setColorMetricIndex=function(h){if(this._processedOptions.colorMetricIndex===h){h=null
}this._processedOptions.secondaryMetricIndex=h;
this.setSecondaryMetricType("color")
};
a.getStackedMetric=function(){var h=this._processedOptions.stackedMetricIndex;
return(h)?this.data().metrics[h]:null
};
a.getStackedMetricIndex=function(){return this._processedOptions.stackedMetricIndex
};
a.setStackedMetricIndex=function(h){if(this._processedOptions.stackedMetricIndex===h){h=null
}this._processedOptions.secondaryMetricIndex=h;
this.setSecondaryMetricType("height")
};
a.getSecondaryMetricType=function(){return this._processedOptions.secondaryMetricType
};
a.setSecondaryMetricType=function(l){var h=this.getSecondaryMetricIndex()||1,k=this._processedOptions,j=this;
k.secondaryMetricIndex=h;
k.secondaryMetricType=l;
switch(l){case"color":k.colorMetricIndex=h;
k.stackedMetricIndex=null;
break;
case"height":k.colorMetricIndex=null;
k.stackedMetricIndex=h;
break;
case"both":k.colorMetricIndex=h;
k.stackedMetricIndex=h;
break;
default:k.colorMetricIndex=null;
k.stackedMetricIndex=null;
k.secondaryMetricIndex=null;
k.secondaryMetricType=null
}};
a.getSecondaryMetric=function(){var h=this._processedOptions.secondaryMetricIndex;
return(h)?this.data().metrics[h]:null
};
a.getSecondaryMetricIndex=function(){return this._processedOptions.secondaryMetricIndex
};
a.setSecondaryMetricIndex=function(h){if(this._processedOptions.secondaryMetricIndex===h){h=null
}this._processedOptions.secondaryMetricIndex=h;
this.setSecondaryMetricType(h?this.getSecondaryMetricType()||"height":null)
};
d.sunburstObj=a;
d.sunburst=g.util.createConstructor(a)
}(this));
(function(f){var g=f.cloudViz,d=g.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(d.baseObj),b=f.d3||{};
a._processOptions=function(k,j){var h=this._processedOptions=Object.create(k);
var l=k.data;
if(k.isEmotionChart){l=this._getEmotionData(k.data)
}h.data=l;
Object.getPrototypeOf(a)._processOptions.call(this,h,j)
};
a._getEmotionData=function(k){var j=this.l10n.labels.flower;
var h=[{index:"joy",label:j.joy,color:"#e6b43c"},{index:"admiration",label:j.admiration,color:"#7daf4b"},{index:"fear",label:j.fear,color:"#50965a"},{index:"surprise",label:j.surprise,color:"#00a0be"},{index:"sadness",label:j.sadness,color:"#286eaf"},{index:"disgust",label:j.disgust,color:"#964196"},{index:"anger",label:j.anger,color:"#f04641"},{index:"anticipation",label:j.anticipation,color:"#dc5f00"}];
var l={};
dv.util.each(k,function(m){l[m.index]=m
});
dv.util.each(h,function(m){if(!l[m.index]){m.value=0
}else{m.value=l[m.index].value||0
}});
return h
};
a._validateData=function(h,j){if(!h){return false
}return true
};
a.data=function(){return this._processedOptions.data
};
d.flowerObj=a;
d.flower=g.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.standard"),a=Object.create(b.barObj);
a._processOptions=function(j,h){var g=this._processedOptions=Object.create(j);
this._processStepData(g);
Object.getPrototypeOf(a)._processOptions.call(this,g,h)
};
a.data=function(){return this._processedOptions.data
};
a.mappings=function(){return this._processedOptions.mappings
};
a.seriesLabelKey=function(){return"cv:fnl:seriesLabel"
};
a.averageStepData=function(){return this._processedOptions.avgStepData
};
a.averageDataLabel=function(){return this._processedOptions.avgStepLabel
};
a.averageSeries=function(){return this._processedOptions.averageSeries
};
a.previousStepData=function(){return this._processedOptions.prevStepData
};
a.currentStepData=function(){return this._processedOptions.curStepData
};
a.textStepData=function(){return this._processedOptions.txtStepData
};
a.getNumSteps=function(){return this._processedOptions.numSteps
};
a.getNumBarsPerStep=function(){return this._processedOptions.numBarsPerStep
};
a._stepDelimiter=":::";
a.getStepName=function(g){return g&&g.slice(0,g.indexOf(this._stepDelimiter))||""
};
a.isSingleSeries=function(){return this.getNumBarsPerStep()===1
};
a.isAvgCalculated=function(){return this._processedOptions.avgStepDataCalc
};
a.getSingleSeriesStepValue=function(h,g){if(!this.isSingleSeries()){return
}return this.currentStepData()[this.mappings()["y"]][g]
};
a._processStepData=function(n){var h=this.mappings(),t=this,C=n.data,p=h.series,A=h.seriesLabel,D=this.seriesLabelKey(),o=h.x,z=h.y,B=n.averageSeries,q=B&&C[p].indexOf(B)>=0,l=n.avgStepDataCalc=!q,v=n.avgStepData=!n.disableAverage&&(q||l)?{cv_tt_val:[],cv_tt_pval:[]}:null,u=n.prevStepData={cv_tt_val:[],cv_tt_pval:[]},k=n.data=n.curStepData={cv_tt_val:[],cv_tt_pval:[]},r=n.txtStepData={cv_label:[]},g={},j={};
if(v){v[z]=[];
v[o]=[];
v[p]=[];
v[D]=[]
}u[z]=[];
u[o]=[];
u[p]=[];
u[D]=[];
k[z]=[];
k[o]=[];
k[p]=[];
k[D]=[];
r[z]=[];
r[o]=[];
r[p]=[];
r[D]=[];
n.numBarsPerStep=C[p].reduce(function(E,F,m){if(E.indexOf(F)<0&&(n.disableAverage||F!==B)){E.push(F)
}return E
},[]).length;
C[z].forEach(function(E,F){var m=C[p][F],I,H=g[m];
if(typeof H==="undefined"){g[m]=H=[];
I=E
}else{I=H[H.length-1]
}var J=C[o][F]+t._stepDelimiter+H.length;
j[J]=j[J]?j[J]+E:E;
if(q&&v&&m===B){v[z].push(E);
v[o].push(J);
v[p].push(C[p][F]);
v[D].push(n.avgStepLabel=n.averageSeriesLabel?n.averageSeriesLabel:C[A][F]);
v.cv_tt_val.push(E);
v.cv_tt_pval.push(I);
H.push(E);
return
}var G=k[z].length;
u[z].push(I);
k[z].push(E);
r[z].push(E);
r.cv_label.push(I?E/I:0);
k.cv_tt_val[G]=u.cv_tt_val[G]=E;
k.cv_tt_pval[G]=u.cv_tt_pval[G]=I;
u[o][G]=k[o][G]=r[o][G]=J;
u[p][G]=k[p][G]=r[p][G]=C[p][F];
u[D][G]=k[D][G]=r[D][G]=C[A][F];
H.push(E)
});
var s=null;
if(v&&l){n.averageSeries="cv:fnl:avg"
}n.numSteps=k[o].reduce(function(F,G,E){if(F.indexOf(G)<0){F.push(G);
if(v&&l){var m=j[G]/n.numBarsPerStep;
if(s===null){s=m
}v[z].push(m);
v[o].push(G);
v[p].push(n.averageSeries);
v[D].push(n.avgStepLabel=n.averageSeriesLabel?n.averageSeriesLabel:t.l10n.labels.funnel.average);
v.cv_tt_val.push(m);
v.cv_tt_pval.push(s);
s=m
}}return F
},[]).length;
var w=Object.create(n.mappings);
w.seriesLabel=D;
n.mappings=w
};
b.funnelObj=a;
b.funnel=f.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(f.dataAdapter.standard.baseObj);
a._getYFormats=function(j,l,p){var n=[];
if(!j||!j.metric||!l||!l.series||!p){return n
}var m=j.metric.length;
for(var k=0;
k<m;
k++){var h=j.metric[k],o=j[l.series],g=p.indexOf(o[k]);
n[g]=h.type
}return n
};
a.mappings=function(){return this._processedOptions.mappings
};
a.formats=function(){return this._processedOptions.formats
};
b.baseObj=a;
b.base=f.util.createConstructor(a)
}(this));
(function(d){var g=d.cloudViz,b=g.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(g.dataAdapter.standard.barObj);
a._processOptions=function(k,j){var h=this._processedOptions=Object.create(k);
h.isOvertime=this._determineOvertime(h.data);
h.yAxisTitle=k.yAxisTitle||this._getYAxisTitle(h.data);
h.dateGranularity=this._getTimeGranularity(h.data);
this._processData(h);
this._updateMappings(h);
Object.getPrototypeOf(a)._processOptions.call(this,h,j);
h.formats={x:k.formats.x,y:this._getYFormats(h.data,h.mappings,this.uniqueFillValues())}
};
a.isOvertime=function(){return this._processedOptions.isOvertime
};
a.xAxisTitle=function(){return null
};
a.yAxisTitle=function(){return this._processedOptions.yAxisTitle
};
a.dateGranularity=function(){return this._processedOptions.dateGranularity
};
a.data=function(){return this._processedOptions.data
};
a.mappings=function(){return this._processedOptions.mappings
};
a.formats=function(){return this._processedOptions.formats
};
a._determineOvertime=function(j){var h=j.date,k=j.metric&&j.metric.some(function(l){return l&&l.date_ref&&l.date_ref.length>1
});
return h&&h.length&&k
};
a._getYAxisTitle=function(h){return this._getYTitleFromLabels(h.label)
};
a._processData=function(j){if(j.isOvertime){return
}var n=Object.create(j.data),k,l=n.cell.length,h=null,m=null;
n.group=[];
for(k=0;
k<l;
++k){m=h;
h=n.cell[k];
n.group[k]=n.series[k];
if(m&&"incomplete"===h.status&&"incomplete"!==m.status){n.group[k]+="::incomplete::"
}}j.data=n
};
a._updateMappings=function(h){var j=Object.create(h.mappings);
if(h.isOvertime){j.x="date";
j.y="value";
j.group="group";
j.series="series";
j.seriesLabel="series_name"
}else{j.x="category";
j.y="value";
j.series="metric_series";
j.seriesLabel="metric_series_name"
}h.mappings=j
};
a._getTimeGranularity=function(h){return h.metric[0]["date_range"].gran
};
var f=b.baseObj;
a._getYFormats=f._getYFormats;
b.bar=g.util.createConstructor(a)
}(this));
(function(f){var g=f.cloudViz,b=g.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(g.dataAdapter.standard.choroplethObj),d=f.d3||{};
a._processOptions=function(k,j){var h=this._processedOptions=Object.create(k);
this._processData(h,k);
Object.getPrototypeOf(a)._processOptions.call(this,h,j)
};
a._processData=function(n,h){var B=h.data,C=B.data,u=B.metrics,o=B.filters,k=B.dates,l,j,s,q,p={values:{}};
for(var t=0,v=u.length;
t<v;
++t){s=u[t];
l=s.filter_ref;
j=s.date_ref;
for(var w=0,r=l.length;
w<r;
++w){q=o[l[w]];
for(var z=0,A=j.length;
z<A;
++z){p.values[(q.info||{}).geo_id]=C[l[w]][j[z]][t].val
}}}n.data=p;
n.metric=s.name;
n.format=s.type
};
a.data=function(){return this._processedOptions.data
};
a.metric=function(){return this._processedOptions.metric
};
a.format=function(){return this._processedOptions.format
};
a._validateData=function(h,j){if(!h){return false
}return true
};
a.data=function(){return this._processedOptions.data
};
b.choropleth=g.util.createConstructor(a)
}(this));
(function(d){var g=d.cloudViz,b=g.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(g.dataAdapter.standard.donutObj);
a._processOptions=function(k,j){var h=this._processedOptions=Object.create(k);
this._updateMappings(h);
Object.getPrototypeOf(a)._processOptions.call(this,h,j);
h.formats={x:k.formats.x,y:this._getYFormats(h.data,h.mappings,this.uniqueFillValues())}
};
a.mappings=function(){return this._processedOptions.mappings
};
a.formats=function(){return this._processedOptions.formats
};
a._updateMappings=function(h){var j=Object.create(h.mappings);
j.x="category";
j.y="value";
j.series="metric_series";
j.seriesLabel="metric_series_name";
h.mappings=j
};
var f=b.baseObj;
a._getYFormats=f._getYFormats;
b.donut=g.util.createConstructor(a)
}(this));
(function(d){var g=d.cloudViz,b=g.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(g.dataAdapter.standard.lineObj);
a._processOptions=function(k,j){var h=this._processedOptions=Object.create(k);
h.isOvertime=this._determineOvertime(h.data);
h.yAxisTitle=k.yAxisTitle||this._getYAxisTitle(h.data);
h.dateGranularity=this._getTimeGranularity(h.data);
this._updateMappings(h);
this._processMultiMetric(h);
this._processIncompleteData(h);
Object.getPrototypeOf(a)._processOptions.call(this,h,j);
h.formats={x:k.formats.x,y:h.isOvertime?this._getYFormats(h.data,h.mappings,this.uniqueStrokeValues()):k.formats.y}
};
a.data=function(){return this._processedOptions.data
};
a.mappings=function(){return this._processedOptions.mappings
};
a.formats=function(){return this._processedOptions.formats
};
a.xAxisTitle=function(){return this._processedOptions.xAxisTitle
};
a.yAxisTitle=function(){return this._processedOptions.yAxisTitle
};
a.isOvertime=function(){return this._processedOptions.isOvertime
};
a.dateGranularity=function(){return this._processedOptions.dateGranularity
};
a._determineOvertime=function(h){return +h.date[0]!==+h.date[h.date.length-1]
};
a._getYAxisTitle=function(h){return this._getYTitleFromLabels(h.label)
};
a._getTimeGranularity=function(h){return this.isOvertime()?h.metric[0].date_range.gran:"*"
};
a._processMultiMetric=function(j){if(j.isOvertime){return
}var n=j.data,h={series:[]},s=[],t=[],o,v,l;
for(o=0,v=n.label.length;
o<v;
++o){l=n.label[o];
if(!h[l]){s.push(l);
if(n.metric&&n.metric.length){t.push(n.metric[o].type)
}else{t.push(null)
}h[l]=[]
}h[l].push(n.value[o]);
h.series[h[l].length-1]=n.category[o]
}var k={x:s[0],y:s[1]};
var q={x:t[0],y:{0:t[1]}};
if(n.groups&&n.groups.length&&n.groups[0].length){var p,r=n.groups.length,w,u=[];
for(p=0;
p<r;
++p){w=n.groups[p];
u[p]=w.join("-")
}h.facet_group=u;
k.series="facet_group"
}if(s.length>2){k.size=s[2];
q.size=t[2];
j.sizeMetricName=j.sizeTitle||s[2]
}j.data=h;
j.mappings=k;
j.formats=q;
j.xAxisTitle=j.xAxisTitle||s[0];
j.yAxisTitle=j.yAxisTitle||s[1]
};
a._updateMappings=function(h){var j=Object.create(h.mappings);
j.x="date";
j.y="value";
j.group="series";
j.series="series";
j.seriesLabel="series_name";
h.mappings=j
};
a._processIncompleteData=function(h){if(!h.isOvertime||!h.data.cell){return
}if(h.position==="stack"||h.position==="fill"){return
}var n=h.data,p=h.mappings,o,r=n.cell.length,q=null,j=null,l,m=false;
n.cv_rs_group=n.cv_rs_group||[];
for(o=0;
o<r;
++o){j=q;
q=n.cell[o];
n.cv_rs_group[o]=n.cv_rs_group[o]||n.series[o];
if(n.cv_rs_group[o].indexOf("::incomplete::")>=0){continue
}if(j&&"incomplete"===q.status&&"incomplete"!==j.status){for(l in n){n[l].splice(o,0,n[l][o-1])
}n.cv_rs_group[o]+="::incomplete::";
++r;
++o
}n.cv_rs_group[o]+="incomplete"===q.status?"::incomplete::":""
}p.group="cv_rs_group"
};
var f=b.baseObj;
a._getYFormats=f._getYFormats;
b.line=g.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(f.dataAdapter.standard.pointObj);
a._processOptions=function(A,l){var j=this._processedOptions=Object.create(A);
var o=A.data,h={series:[]},t=[],u=[],p,w,n;
for(p=0,w=o.label.length;
p<w;
++p){n=o.label[p];
if(!h[n]){t.push(n);
if(o.metric&&o.metric.length){u.push(o.metric[p].type)
}else{u.push(null)
}h[n]=[]
}h[n].push(o.value[p]);
h.series[h[n].length-1]=o.category[p]
}var k={x:t[0],y:t[1]};
var r={x:u[0],y:u[1]};
if(o.groups&&o.groups.length&&o.groups[0].length){var q,s=o.groups.length,z,v=[];
for(q=0;
q<s;
++q){z=o.groups[q];
v[q]=z.join("-")
}h.group=v;
k.series="group"
}else{k.series="series"
}if(t.length>2){k.size=t[2];
r.size=u[2];
j.sizeMetricName=A.sizeTitle||t[2]
}j.data=h;
j.mappings=k;
j.formats=r;
j.xAxisTitle=A.xAxisTitle||t[0];
j.yAxisTitle=A.yAxisTitle||t[1];
Object.getPrototypeOf(a)._processOptions.apply(this,arguments)
};
a.data=function(){return this._processedOptions.data
};
a.mappings=function(){return this._processedOptions.mappings
};
a.formats=function(){return this._processedOptions.formats
};
a.xAxisTitle=function(){return this._processedOptions.xAxisTitle
};
a.yAxisTitle=function(){return this._processedOptions.yAxisTitle
};
a.sizeMetricName=function(){return this._processedOptions.sizeMetricName
};
b.point=f.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(f.dataAdapter.standard.pathingObj),g=4;
a._processOptions=function(G,k){var F=Object.create(G),u=F.data,z={},w=(z.nodes=[]),p=(z.paths=[]),P={},W=this.l10n.labels.pathing;
function C(j){return"E"===j
}function A(j){return"X"===j
}var O,ac,L,S,B,I,h,K,Y,E,o,ae=0;
for(ac in u.filters){O=u.filters[ac];
L=this._getFilterId(O);
if(L){S=O.info&&O.info.name||"";
B=this._getFilterChild(O);
I=B&&B.op||null;
if(I&&I!=="previous"&&I!=="next"){B=I=null
}h=(B&&B.val)?[].concat(B.val):[];
E=0;
if("previous"===I){if(h.some(C)){var q="E_0";
if(!P[q]){K={label:W.entry,id:q,column:E,index:w.length,filters:[]};
w[w.length]=K;
P[q]=K
}}E=h.length
}if("next"===I){if(h.some(A)){var l="X_0";
if(!P[l]){K={label:W.exit,id:l,column:E,index:w.length,filters:[]};
w[w.length]=K;
P[l]=K
}}E=0-h.length
}Y=L+"_"+E;
if(P[Y]){P[Y].filters.push(O);
continue
}o=("0"===String(L)&&(W.exit===String(S)||W.entry===String(S)));
if(o){continue
}else{if("0"===String(L)){continue
}}K={label:S,id:Y,column:E,index:w.length,filters:[O]};
w[w.length]=K;
ae=Math.min(ae,E);
P[Y]=K
}}if(0!==ae){for(var V in w){K=w[V];
K.column-=ae
}}var R,D,H,ag,X,s,ad,N,af,v,ab,J,Q;
for(X=0,s=u.metrics.length;
X<s;
++X){R=u.metrics[X];
D=R.filter_ref;
H=R.date_ref;
for(ad=0,N=D.length;
ad<N;
++ad){ac=D[ad];
O=u.filters[ac];
for(af=0,v=H.length;
af<v;
++af){ag=H[af];
ab=u.dates[ag];
J=u.data[ac][ag][X];
if("invalid"===J.status){continue
}if(K=this._getSingleNode(O,P)){K.total=+J.val;
continue
}Q=this._createPath(O,P);
if(!Q||!Q.length){continue
}p[p.length]={nodes:Q,values:+J.val||0}
}}}p.sort(function(m,j){return j.nodes.length-m.nodes.length
});
var aa,M,Z,t,U,r;
for(aa=0,M=p.length;
aa<M;
++aa){U=p[aa];
for(Z=0,t=p.length;
Z<t;
++Z){if(aa===Z){continue
}r=p[Z];
if(r.nodes.length===U.nodes.length){continue
}if(-1!==this._getPathString(U.nodes).indexOf(this._getPathString(r.nodes))){r.values-=U.values
}}}z.paths=p=p.filter(function(j){return j.values
});
F.data=z;
var T=G.data.metrics;
F.pathingTitle=T&&T.length&&T[0].name;
Object.getPrototypeOf(a)._processOptions.call(this,F,k)
};
a.nodeKey=function(){return function(j,h){return j.id
}
};
a.linkKey=function(){return function(j,h){return((j.source)?j.source.id:"null")+"-"+((j.target)?j.target.id:"null")
}
};
a.pathingTitle=function(){return this._processedOptions.pathingTitle
};
a.getPathEnd=function(n){if(!n||!n.nodes||!n.nodes.length){return null
}if(n.nodes.length===1){return n.nodes[0]
}var j=n.nodes,m=this._processedOptions.data,k=m.nodesById,o=k[j[0]],h=k[j[j.length-1]];
function l(p){return p&&(p.isPivot||p.id==="E_0"||p.id==="X_0")
}if(l(o)){return o
}if(l(h)){return h
}return null
};
a.getPathDirection=function(j){var h=this.getPathEnd(j);
if(!h){return 0
}return h._pid===j.nodes[0]?1:-1
};
a.activePathsTitle=function(l){if(!l||!l.length){return""
}var h=this.getPathEnd(l[0]),j=this.l10n.labels.pathing;
if(!h){return j["path2+"]
}var k=this.getPathDirection(l[0])===1?j.pathFromNode:j.pathToNode;
return k.replace(/\{path\}/i,((l.length>1)?j["path2+"]:j.path)).replace(/\{label\}/i,h.label)
};
a._getSingleNode=function(j,h){var o=this._getFilterId(j),k=j.filter_def&&j.filter_def.length&&j.filter_def[0]||null,n=k&&k.op||null,m=this._getFilterChild(j),l=m&&m.op||null;
if(("select"!==n&&"equals"!==n&&"id"!==n)||"previous"===l||"next"===l){return false
}return h[o+"_0"]
};
a._getPathString=function(h){return h.map(function(j){return(null===j)?"null":j
}).toString()
};
a._createPath=function(n,r){var j=this._getFilterId(n),k=this._getFilterChild(n),m=k&&k.op||null;
if(m&&m!=="previous"&&m!=="next"){return[]
}var p=(k&&k.val)?[].concat(k.val):[];
if(!p.length){return p
}var l=("previous"===k.op),q=("0"===j),o=(l)?0:(q)?0-p.length+1:0-p.length,h=[];
if(l){p.push(j)
}else{p.unshift(j)
}return this._mapNodeIds(o,p,r)
};
a._mapNodeIds=function(o,l,k){if(!isFinite(o)||!k){return[]
}o=+o;
var j=false,m=false,n,h=l&&l.map&&l.map(function(p){if("0"===p){return null
}n=p+"_"+o;
if(!k[n]){m=true;
return null
}++o;
j=true;
return +k[n].index
});
return(j&&!m)?h:[]
};
a._getFilterId=function(h){return(h.info&&(h.info.id||h.info.id===0))?h.info.id+"":null
};
a._getFilterChild=function(h){var j=h.filter_def&&h.filter_def.length&&h.filter_def[0]||null;
return j&&j.child&&j.child.length&&j.child[0]||null
};
a.canExpandNode=function(j){var l=j.entryLinks.length+j.targetLinks.length,k=j.exitLinks.length+j.sourceLinks.length,h=Math.abs(parseInt(j.id.split("_")[1],10));
if(h>=g){return false
}if(k&&j.id==="E_0"){return false
}if(l&&j.id==="X_0"){return false
}if(!l||!k){return true
}return false
};
a.canCollapseNode=function(j){var l=j.entryLinks.length+j.targetLinks.length,k=j.exitLinks.length+j.sourceLinks.length,h=parseInt(j.id.split("_")[1],10);
if(j.id==="E_0"||j.id==="X_0"){return false
}return(0===h&&(k||l))||(h>0&&k)||(h<0&&l)
};
a.canPivotNode=function(l){var o=l.entryLinks.length+l.targetLinks.length,n=l.exitLinks.length+l.sourceLinks.length,k=Math.abs(parseInt(l.id.split("_")[1],10));
if(k!==0){return true
}var m=this.data(),j=m.nodes.map(function(p){return parseInt(p.id.split("_")[1],10)
}),h=0;
if(j.some(function(p){if(p===0){h++
}return(h>1)?true:false
})){return true
}return false
};
b.pathingObj=a;
b.pathing=f.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(f.dataAdapter.standard.sunburstObj);
a._processOptions=function(m,G){var J=this._processedOptions,t=this._processedOptions=Object.create(m);
function q(O){var P=(O&&O.op==="id")?[O.val]:[];
if(O&&O.child&&O.child[0]){return q(O.child[0]).concat(P)
}return P
}function D(O){if(O&&O.child&&O.child[0]){return D(O.child[0])+1
}return 0
}function o(O){var P=O&&O.filter_def&&O.filter_def[0]||null;
return D(P)
}function M(P,O){var R=o(P.filter),Q=o(O.filter);
if(R===Q){return O.cell[0].val-P.cell[0].val
}return R-Q
}var L=m.data,E,k,j,w,F,B,H,K,n,r,I,h,C,u,A,N={children:[],categories:[],metrics:L.metrics.map(function(O,P){return{id:O.id,icon:O.icon,name:O.name||O.id,format:O.type,categories:[]}
})};
if(E=L.metrics[0]){r=[];
k=E.filter_ref;
j=E.date_ref;
for(F=0,B=k.length;
F<B;
++F){A=k[F];
u=L.filters[A];
for(H=0,K=j.length;
H<K;
++H){w=j[H];
I=L.dates[w];
h=L.data[A][w];
if(!h[0]||"invalid"===h[0].status){continue
}if(u.info&&u.info.id===0){continue
}r.push({filter:u,cell:h})
}}r.sort(M);
var v={},l,p,z,s,g;
r.forEach(function(O){u=O.filter;
h=O.cell;
z=u&&u.filter_def&&u.filter_def[0]||null;
s=q(z),g=s.length,l=s.join("-");
if(!l.length&&!u.info){h.forEach(function(Q,P){N.metrics[P].value=+Q.val
});
return
}O={id:u.info.id,pid:l?l+"-"+u.info.id:u.info.id,name:u.info.name,metrics:h.map(function(P){return{value:+P.val}
}),category:u.info.category||(z&&z["var"])||undefined,filtervar:z&&z["var"]||undefined,children:[]};
if(u.info.orig_name){O.orig_name=u.info.orig_name
}h.forEach(function(S,Q){var P=N.metrics[Q];
P.min=("undefined"!==typeof P.min)?Math.min(P.min,+S.val):+S.val;
P.max=("undefined"!==typeof P.max)?Math.max(P.max,+S.val):+S.val;
var R;
if(!(R=P.categories[g])){P.categories[g]={min:+S.val,max:+S.val}
}else{R.min=Math.min(R.min,+S.val);
R.max=Math.max(R.max,+S.val)
}});
if(l&&(p=v[l])){p.children.push(O)
}else{if(!s.length){N.children.push(O)
}else{return
}}v[O.pid]=O;
N.categories[g]={name:u.info.category||(z&&z["var"])||N.categories[g]}
})
}t.data=N;
Object.getPrototypeOf(a)._processOptions.call(this,t,G,J)
};
a._validateData=function(h){if(!h){return false
}for(var g in h){if(h[g].length){return true
}}return false
};
a.getPathKey=function(h,g){if(!h||!h._sid){return 0
}if(!h.pid){return h._sid
}return h.pid
};
b.sunburst=f.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(f.dataAdapter.standard.flowerObj);
a._processOptions=function(j,h){var g=this._processedOptions=Object.create(j);
g.data=this._parseData(j.data);
Object.getPrototypeOf(a)._processOptions.call(this,g,h)
};
a._parseData=function(j){if(!j.metric.length){return[]
}var h=[],g=j.metric[0].id;
dv.util.each(j.metric,function(p,l){if(p.id!=g){return
}var n=j.filter[l].info.name;
var m=j.value[l];
h.push({index:n.toLowerCase(),label:n,value:m})
});
return h
};
a.formats=function(){return this._processedOptions.formats
};
b.flower=f.util.createConstructor(a)
}(this));
(function(d){var f=d.cloudViz,b=f.util.namespace("cloudViz.dataAdapter.rs"),a=Object.create(f.dataAdapter.standard.funnelObj);
a._processOptions=function(j,h){var g=this._processedOptions=Object.create(j);
this._processData(g);
this._updateMappings(g);
Object.getPrototypeOf(a)._processOptions.call(this,g,h)
};
a.data=function(){return this._processedOptions.data
};
a.mappings=function(){return this._processedOptions.mappings
};
a.formats=function(){return this._processedOptions.formats
};
a._processData=function(g){g.data=Object.create(g.data)
};
a._updateMappings=function(g){var h=Object.create(g.mappings);
h.x="category";
h.y="value";
h.series="metric_series";
h.seriesLabel="metric_series_name";
g.mappings=h
};
b.funnel=f.util.createConstructor(a)
}(this));
(function(a){a.cloudViz.localeDefinition("de-DE",{monthAbbreviations:["Jan","Feb","März","Apr","Mai","Juni","Juli","Aug","Sep","Okt","Nov","Dez"],months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],weekdayAbbreviations:["So","Mo","Di","Mi","Do","Fr","Sa"],weekdays:["Sonntag","Montag","Dienstag","Mittwoch","Donnerstag","Freitag","Samstag"],ampm:["AM","PM"]},"calendar");
a.cloudViz.localeDefinition("de-DE",{core:{nodata:"Das Diagramm enthält keine Daten.",erroronrender:"Hoppla! Ein Fehler ist aufgetreten und das Diagramm konnte nicht gerendert werden.",other:"Sonstige",normalized:"Normalisiert"},dvcore:{target:"Zielgruppe",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Größe"},pathing:{entry:"Einstieg",exit:"Ausstieg","entry2+":"Einstiege","exit2+":"Ausstiege",path:"Pfad","path2+":"Pfade",expand:"Erweitern",focus:"Fokus",collapse:"Reduzieren",title:"Pfaderstellungs-diagramm",nodeEntries:"Einstiege für {label}",nodeExits:"Ausstiege für {label}",nodeToNode:"{source} → {target}",percOfNode:"{perc} von {label}",pathToNode:"{path} zu {label}",pathFromNode:"{path} aus {label}",help1:"Dieses Diagramm stellt Pfade dar, die von einem Status in einen anderen übernommen wurden.",help2:"Jeder Knoten in Form eines Feldes repräsentiert einen Status im Pfad.",help3:"Durch Tippen oder Klicken auf einen Knoten werden zusätzliche Optionen zum Ändern des Diagramms angezeigt:",focusHelp:"Zeigt Pfade an, die am Knoten ein- oder ausgehen.",expandHelp:"Zeigt zusätzliche Pfade an, die am Knoten ein- oder ausgehen.",collapseHelp:"Entfernt Pfade, die am Knoten ein- oder ausgehen."},sunburst:{audience:"Zielgruppe","audience2+":"Zielgruppen",category:"Kategorie","category2+":"Kategorien",metric:"Metrik","metric2+":"Metriken",primarymetric:"Primäre Metrik",secondarymetric:"Sekundäre Metrik","secondarymetric2+":"Sekundäre Metriken",secondarymetrichelp:"Klicken Sie auf die Metrik, um die Höhe zu ändern.","secondarymetrichelp2+":"Klicken Sie auf die Metriken, um die Höhe zu ändern.",emptyFirstMetric:"Die erste Metrik enthält keine Werte. Wählen Sie eine andere Metrik.",total:"Gesamt",zoomAction:"Doppelklicken, um zu vergrößern.",moreAction:"Klicken Sie hier für weitere Optionen.",zoomin:"Nahansicht",zoomout:"Weitansicht",hide:"Ausblenden",hideall:"Alles ausblenden",hideother:"Sonstige ausblenden",hidden:"{value} verborgenes Element","hidden2+":"{value} verborgene Elemente",topresults:"Top {value}",color:"Farbe",height:"Höhe",both:"Beide",none:"Keine",mapmetric:"{metric} anzeigen als:",percmetric:"{percent} der {metric}",mobilescroll:"&#x25BC – scrollen Sie, um Details anzuzeigen."},flower:{joy:"Freude",admiration:"Bewunderung",fear:"Angst",surprise:"Überraschung",sadness:"Traurigkeit",disgust:"Empörung",anger:"Wut",anticipation:"Vorausschätzung"},venn:{definedAudience:"Definierte Zielgruppe"},funnel:{step:"Schritt",segment:"Segment",conversion:"Konversion",fallout:"Trichteranalyse",average:"Durchschnitt"}},"labels");
a.cloudViz.localeDefinition("de-DE",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H Uhr %a %e"},fullFormat:{hour:"%H Uhr %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y"}},"dateFormat");
a.cloudViz.localeDefinition("de-DE",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"€",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat");
a.cloudViz.localeDefinition("de-DE",{singular:{second:"Sekunde",minute:"Minute",hour:"Stunde",day:"Tag",week:"Woche",month:"Monat",year:"Jahr"},plural:{second:"Sekunden",minute:"Minuten",hour:"Stunden",day:"Tagen",week:"Wochen",month:"Monate",year:"Jahre"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("en-US",{monthAbbreviations:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],months:["January","February","March","April","May","June","July","August","September","October","November","December"],weekdayAbbreviations:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],weekdays:["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ampm:["AM","PM"]},"calendar");
a.cloudViz.localeDefinition("en-US",{core:{nodata:"The chart has no data",erroronrender:"Oops! There was an error and the chart could not be rendered.",other:"Other",normalized:"Normalized"},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (in {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"Entry",exit:"Exit","entry2+":"Entries","exit2+":"Exits",path:"Path","path2+":"Paths",expand:"Expand",focus:"Focus",collapse:"Collapse",title:"Pathing Chart",nodeEntries:"{label} Entries",nodeExits:"{label} Exits",nodeToNode:"{source} \u2192 {target}",percOfNode:"{perc} of {label}",pathToNode:"{path} to {label}",pathFromNode:"{path} from {label}",help1:"This chart represents paths taken from one state to another.",help2:"Each node, shaped as a box, represents a state in the path.",help3:"Tapping or clicking a node will provide additional options to modify the chart:",focusHelp:"Shows paths coming into and going out of node",expandHelp:"Shows additional paths coming or going from the node",collapseHelp:"Removes paths coming or going from the node"},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Category","category2+":"Categories",metric:"Metric","metric2+":"Metrics",primarymetric:"Primary Metric",secondarymetric:"Secondary Metric","secondarymetric2+":"Secondary Metrics",secondarymetrichelp:"Click metric to toggle height","secondarymetrichelp2+":"Click metrics to toggle height",emptyFirstMetric:"The first metric has no values. Please pick a different metric.",total:"Total",zoomAction:"Double-click to Zoom in.",moreAction:"Click for more options.",zoomin:"Zoom In",zoomout:"Zoom Out",hide:"Hide",hideall:"Hide All",hideother:"Hide Other",hidden:"{value} Hidden Item","hidden2+":"{value} Hidden Items",topresults:"top {value}",color:"Color",height:"Height",both:"Both",none:"None",mapmetric:"Show {metric} as:",percmetric:"{percent} of {metric}",mobilescroll:"&#x25BC scroll for details"},flower:{joy:"Joy",admiration:"Admiration",fear:"Fear",surprise:"Surprise",sadness:"Sadness",disgust:"Disgust",anger:"Anger",anticipation:"Anticipation"},venn:{definedAudience:"Defined Audience"},funnel:{step:"Step",segment:"Segment",conversion:"Conversion",fallout:"Fallout",average:"Average"}},"labels");
a.cloudViz.localeDefinition("en-US",{shortFormat:{hour:"%I %p",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%I %p",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%I %p %a %e"},fullFormat:{hour:"%I %p %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%b %e, %Y",condensed:"%m/%d/%Y"}},"dateFormat");
a.cloudViz.localeDefinition("en-US",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat");
a.cloudViz.localeDefinition("en-US",{singular:{second:"second",minute:"minute",hour:"hour",day:"day",week:"week",month:"month",year:"year"},plural:{second:"seconds",minute:"minutes",hour:"hours",day:"days",week:"weeks",month:"months",year:"years"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("es-ES",{monthAbbreviations:["en.","febr.","mzo.","abr.","my.","jun.","jul.","ag.","sept.","oct.","nov.","dic."],months:["enero","febrero","marzo","abril","mayo","junio","julio","agosto","septiembre","octubre","noviembre","diciembre"],weekdayAbbreviations:["dom.","lun.","mart.","miérc.","juev.","vier.","sáb."],weekdays:["domingo","lunes","martes","miércoles","jueves","viernes","sábado"],ampm:["a. m.","p. m."]},"calendar");
a.cloudViz.localeDefinition("es-ES",{core:{nodata:"El gráfico no contiene datos",erroronrender:"Se ha producido un error y no se ha podido procesar el gráfico.",other:"Otro",normalized:"Normalizado"},dvcore:{target:"Destino",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamaño"},pathing:{entry:"Entrada",exit:"Salida","entry2+":"Entradas","exit2+":"Salidas",path:"Ruta","path2+":"Rutas",expand:"Expandir",focus:"Enfoque",collapse:"Contraer",title:"Gráfico de ruta",nodeEntries:"Entradas de {label}",nodeExits:"Salidas de {label}",nodeToNode:"{source} → {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} a {label}",pathFromNode:"{path} de {label}",help1:"Este gráfico representa las rutas que se pueden tomar para ir de un estado a otro.",help2:"Los nodos, con forma de caja, representan un estado en la ruta.",help3:"Al hacer clic o tocar un nodo, se mostrarán opciones adicionales para modificar el gráfico:",focusHelp:"Muestra las rutas de ida al nodo o de vuelta",expandHelp:"Muestra rutas adicionales de ida al nodo o de vuelta",collapseHelp:"Suprime las rutas de ida al nodo o de vuelta"},sunburst:{audience:"Audiencia","audience2+":"Audiencias",category:"Categoría","category2+":"Categorías",metric:"Métrica","metric2+":"Métrica",primarymetric:"Métrica principal",secondarymetric:"Métrica secundaria","secondarymetric2+":"Métricas secundarias",secondarymetrichelp:"Haga clic en la métrica para alternar la altura","secondarymetrichelp2+":"Haga clic en las métricas para alternar la altura",emptyFirstMetric:"La primera métrica no contiene ningún valor. Elija otra métrica.",total:"Total",zoomAction:"Doble clic para aumentar.",moreAction:"Haga clic para ver más opciones.",zoomin:"Acercar",zoomout:"Alejar",hide:"Ocultar",hideall:"Ocultar todo",hideother:"Ocultar otro",hidden:"{value} elemento oculto","hidden2+":"{value} elementos ocultos",topresults:"{value} principales",color:"Color",height:"Altura",both:"Ambos",none:"Ninguno",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC desplácese para más detalles"},flower:{joy:"Alegría",admiration:"Admiración",fear:"Miedo",surprise:"Sorpresa",sadness:"Tristeza",disgust:"Desagrado",anger:"Enfado",anticipation:"Expectación"},venn:{definedAudience:"Audiencia definida"},funnel:{step:"Paso",segment:"Segmento",conversion:"Conversión",fallout:"Visita en el orden previsto",average:"Promedio"}},"labels");
a.cloudViz.localeDefinition("es-ES",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %I %p",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%d/%m/%Y"}},"dateFormat");
a.cloudViz.localeDefinition("es-ES",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"€",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat");
a.cloudViz.localeDefinition("es-ES",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"día",week:"semana",month:"mes",year:"año"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"días",week:"semanas",month:"meses",year:"años"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("fr-FR",{monthAbbreviations:["Janv.","Févr.","Mars","Avr.","Mai","Juin","Juill.","Août","Sept.","Oct.","Nov.","Déc."],months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],weekdayAbbreviations:["Dim.","Lun.","Mar.","Mer.","Jeu.","Ven.","Sam."],weekdays:["Dimanche","Lundi","Mardi","Mercredi","Jeudi","Vendredi","Samedi"],ampm:["AM","PM"]},"calendar");
a.cloudViz.localeDefinition("fr-FR",{core:{nodata:"Le graphique ne contient aucune donnée",erroronrender:"Une erreur s’est produite, impossible de restituer le graphique.",other:"Autre",normalized:"Normalisé"},dvcore:{target:"Cible",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (en {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Taille"},pathing:{entry:"Entrée",exit:"Sortie","entry2+":"Entrées de","exit2+":"Sorties de",path:"Chemin d’accès","path2+":"Chemins d’accès",expand:"Développer",focus:"Mise au point",collapse:"Réduire",title:"Graphique du cheminement",nodeEntries:"Entrées {label}",nodeExits:"Sorties {label}",nodeToNode:"{source} → {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} à {label}",pathFromNode:"{path} de {label}",help1:"Ce graphique représente les chemins d’accès récupérés d’un état à un autre.",help2:"Chaque nœud, en forme de cadre, représente un état dans le chemin d’accès.",help3:"Le fait d’appuyer ou de cliquer sur un nœud fournit d’autres options pour modifier le graphique :",focusHelp:"Présente les chemins d’accès issus du nœud ou y parvenant",expandHelp:"Présente des chemins d’accès supplémentaires issus du nœud ou y parvenant.",collapseHelp:"Supprime les chemins d’accès supplémentaires issus du nœud ou y parvenant."},sunburst:{audience:"Audience","audience2+":"Audiences",category:"Catégorie","category2+":"Catégories",metric:"Mesure","metric2+":"Mesures",primarymetric:"Mesure principale",secondarymetric:"Mesure secondaire","secondarymetric2+":"Mesures secondaires",secondarymetrichelp:"Cliquer sur une mesure pour activer/désactiver la hauteur","secondarymetrichelp2+":"Cliquer sur des mesures pour activer/désactiver la hauteur",emptyFirstMetric:"La première mesure n’a aucune valeur. Sélectionnez une autre mesure.",total:"Total",zoomAction:"Double-cliquez pour effectuer un zoom avant.",moreAction:"Cliquez pour plus d’options.",zoomin:"Zoom avant",zoomout:"Zoom arrière",hide:"Masquer",hideall:"Tout masquer",hideother:"Masquer autres",hidden:"{value} élément masqué","hidden2+":"{value} éléments masqués",topresults:"{value} premiers",color:"Couleur",height:"Hauteur",both:"Les deux",none:"Néant",mapmetric:"Afficher {metric} comme :",percmetric:"{percent} des {metric}",mobilescroll:"Défilement &#x25BC pour plus de détails"},flower:{joy:"Joie",admiration:"Admiration",fear:"Peur",surprise:"Surprise",sadness:"Tristesse",disgust:"Dégoût",anger:"Colère",anticipation:"Anticipation"},venn:{definedAudience:"Audience définie"},funnel:{step:"Etape",segment:"Segment",conversion:"Conversion",fallout:"Abandons",average:"Moyenne"}},"labels");
a.cloudViz.localeDefinition("fr-FR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%H h %a %e"},fullFormat:{hour:"%H h %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b %Y",condensed:"%d/%m/%Y"}},"dateFormat");
a.cloudViz.localeDefinition("fr-FR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"€",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat");
a.cloudViz.localeDefinition("fr-FR",{singular:{second:"seconde",minute:"minute",hour:"heure",day:"jour",week:"semaine",month:"mois",year:"année"},plural:{second:"secondes",minute:"minutes",hour:"heures",day:"jours",week:"semaines",month:"mois",year:"années"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("ja-JP",{monthAbbreviations:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],weekdayAbbreviations:["日","月","火","水","木","金","土"],weekdays:["日曜日","月曜日","火曜日","水曜日","木曜日","金曜日","土曜日"],ampm:["午前","午後"]},"calendar");
a.cloudViz.localeDefinition("ja-JP",{core:{nodata:"データがありません",erroronrender:"エラーのためチャートを作成できません",other:"その他",normalized:"正規化済み"},dvcore:{target:"Target",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} ({time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Size"},pathing:{entry:"入口",exit:"出口","entry2+":"入口","exit2+":"出口",path:"パス内訳","path2+":"パス内訳",expand:"展開する",focus:"再スタート",collapse:"減らす",title:"遷移チャート",nodeEntries:"{label} 入口",nodeExits:"{label} 出口",nodeToNode:"{source} → {target}",percOfNode:"{label}の{perc}",pathToNode:"{label}への{path}",pathFromNode:"{label}からの{path}",help1:"流れ（パス）を現すチャートです。",help2:"四角形のノードがデータ項目です。",help3:"ノードをクリック（タップ）すると、以下のようなチャート設定用アイコンが表示されます：",focusHelp:"画面をクリアし、該当ノードの前後のパスのみを表示",expandHelp:"該当ノードの前後のパスをさらに表示",collapseHelp:"展開したパスを元に戻す"},sunburst:{audience:"オーディエンス","audience2+":"オーディエンス",category:"カテゴリ","category2+":"カテゴリ",metric:"指標","metric2+":"指標",primarymetric:"一次指標",secondarymetric:"二次指標","secondarymetric2+":"二次指標",secondarymetrichelp:"指標をクリックすると高さが変わる","secondarymetrichelp2+":"指標をクリックすると高さが変わる",emptyFirstMetric:"最も内側の円となる最初の指標のデータが存在しないため、チャートを描画できません。",total:"合計",zoomAction:"ダブルクリックでズームイン",moreAction:"クリックで選択肢を表示",zoomin:"ズームイン",zoomout:"ズームアウト",hide:"選択項目のみ除外",hideall:"全体から同じ項目を除外",hideother:"この項目以外を除外",hidden:"{value} 個の項目を除外中","hidden2+":"{value} 個の項目を除外中",topresults:"上位{value}件",color:"色",height:"高さ",both:"両方",none:"なし",mapmetric:"{metric}の表示方法:",percmetric:"{metric}の{percent}",mobilescroll:"&#x25BC スクロールして詳細を表示"},flower:{joy:"喜び",admiration:"賞賛",fear:"恐怖",surprise:"驚き",sadness:"悲しみ",disgust:"不快",anger:"怒り",anticipation:"予測"},venn:{definedAudience:"定義されたオーディエンス"},funnel:{step:" 手順",segment:"セグメント",conversion:"コンバージョン",fallout:"フォールアウト",average:"平均"}},"labels");
a.cloudViz.localeDefinition("ja-JP",{shortFormat:{hour:"%p %I 時",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I 時",day:"%e 日 (%a)",week:"%e 日 (%a)",month:"%b",quarter:"%b",year:"%Y",fallback:"%e 日 (%a)"},longFormat:{hour:"%e 日 (%a) %p %I 時",day:"%e 日 (%a)",week:"%e 日 (%a)",month:"%B",quarter:"%B",year:"%Y",fallback:"%e 日 (%a) %p %I 時"},fullFormat:{hour:"%e 日 (%a) %p %I 時",day:"%e 日 (%a)",week:"%e 日 (%a)",month:"%Y 年 %B",quarter:"%Y 年 %B",year:"%Y",fallback:"%Y 年 %b %e 日",condensed:"%Y/%m/%d"}},"dateFormat");
a.cloudViz.localeDefinition("ja-JP",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"¥",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat");
a.cloudViz.localeDefinition("ja-JP",{singular:{second:"秒",minute:"分",hour:"時間",day:"日",week:"週間",month:"か月",year:"年"},plural:{second:"秒",minute:"分",hour:"時間",day:"日",week:"週間",month:"か月",year:"年"},abbreviation:{second:"秒",minute:"分",hour:"時間",day:"日",week:"週間",month:"か月",year:"年"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("ko-KR",{monthAbbreviations:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],weekdayAbbreviations:["일","월","화","수","목","금","토"],weekdays:["일요일","월요일","화요일","수요일","목요일","금요일","토요일"],ampm:["오전","오후"]},"calendar");
a.cloudViz.localeDefinition("ko-KR",{core:{nodata:"차트에 데이터가 없습니다.",erroronrender:"오류가 발생하여 차트를 렌더링할 수 없습니다.",other:"기타",normalized:"정규화됨"},dvcore:{target:"목표",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}({time})",legendTime:"{value}{time}"},point:{xScale:"X",yScale:"Y",sizeScale:"크기"},pathing:{entry:"시작",exit:"종료","entry2+":"시작","exit2+":"종료",path:"경로","path2+":"경로",expand:"확장",focus:"포커스",collapse:"축소",title:"경로 지정 차트",nodeEntries:"{label} 시작",nodeExits:"{label} 종료",nodeToNode:"{source} → {target}",percOfNode:"{label}의 {perc}",pathToNode:"{label} 나가는 {path}",pathFromNode:"{label} 들어오는 {path}",help1:"이 차트는 하나의 주에서 다른 주로 가져온 경로를 나타냅니다.",help2:"상자 모양의 노드는 각각 경로 내의 주를 나타냅니다.",help3:"노드를 누르거나 클릭하면 차트를 수정할 추가 옵션을 설정할 수 있습니다.",focusHelp:"노드에 들어오거나 나가는 경로 표시",expandHelp:"노드에 들어오거나 나가는 추가 경로 표시",collapseHelp:"노드에 들어오거나 나가는 경로 제거"},sunburst:{audience:"대상","audience2+":"대상",category:"카테고리","category2+":"카테고리",metric:"지표","metric2+":"지표",primarymetric:"기본 지표",secondarymetric:"보조 지표","secondarymetric2+":"보조 지표",secondarymetrichelp:"지표를 클릭하여 높이 전환","secondarymetrichelp2+":"지표를 클릭하여 높이 전환",emptyFirstMetric:"첫 번째 지표에 값이 없습니다. 다른 지표를 선택하십시오.",total:"합계",zoomAction:"확대하려면 두 번 클릭하십시오.",moreAction:"추가 옵션을 보려면 클릭하십시오.",zoomin:"확대",zoomout:"축소",hide:"숨김",hideall:"모두 숨기기",hideother:"나머지 숨기기",hidden:"{value}개의 숨긴 항목","hidden2+":"{value}개의 숨긴 항목",topresults:"상위 {value}개",color:"색상",height:"높이",both:"둘 다",none:"없음",mapmetric:"{metric} 다음으로 표시:",percmetric:"{metric} 수의 {percent} ",mobilescroll:"&#x25BC 자세한 내용을 보려면 스크롤하십시오."},flower:{joy:"기쁨",admiration:"감탄",fear:"두려움",surprise:"놀람",sadness:"슬픔",disgust:"혐오",anger:"분노",anticipation:"기대"},venn:{definedAudience:"정의된 대상"},funnel:{step:"단계",segment:"세그먼트",conversion:"전환",fallout:"폴아웃",average:"평균"}},"labels");
a.cloudViz.localeDefinition("ko-KR",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e일 %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e일 %a %p %I"},fullFormat:{hour:"%e일 %a %p %I",day:"%A %e",week:"%A %e",month:"%Y 년 %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e일",condensed:"%Y/%m/%d"}},"dateFormat");
a.cloudViz.localeDefinition("ko-KR",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"₩",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat");
a.cloudViz.localeDefinition("ko-KR",{singular:{second:"초",minute:"분",hour:"시간",day:"일",week:"주",month:"월",year:"년"},plural:{second:"초",minute:"분",hour:"시간",day:"일",week:"주",month:"월",year:"년"},abbreviation:{second:"초",minute:"분",hour:"시간",day:"일",week:"주",month:"월",year:"년"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("pt-BR",{monthAbbreviations:["Jan","Fev","Mar","Abr","Mai","Jun","Jul","Ago","Set","Out","Nov","Dez"],months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],weekdayAbbreviations:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"],weekdays:["Domingo","Segunda-feira","Terça-feira","Quarta-feira","Quinta-feira","Sexta-feira","Sábado"],ampm:["AM","PM"]},"calendar");
a.cloudViz.localeDefinition("pt-BR",{core:{nodata:"O gráfico não possui dados",erroronrender:"Ops! Houve um erro e o gráfico não pôde ser processado.",other:"Outro",normalized:"Normalizado"},dvcore:{target:"Meta",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (em {time})",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"Tamanho"},pathing:{entry:"Entrada",exit:"Sair","entry2+":"Entradas","exit2+":"Saídas",path:"Caminho","path2+":"Caminhos",expand:"Expandir",focus:"Foco",collapse:"Recolher",title:"Gráfico de criação de caminho",nodeEntries:"{label} Entradas",nodeExits:"{label} Saídas",nodeToNode:"{source} → {target}",percOfNode:"{perc} de {label}",pathToNode:"{path} para {label}",pathFromNode:"{path} de {label}",help1:"Esse gráfico representa os caminhos tomados de um estado para outro.",help2:"Cada nó, formado como uma caixa representa um estado no caminho.",help3:"Tocar ou clicar em um nó fornecerá opções adicionais para modificar o gráfico:",focusHelp:"Mostra os caminhos entrando ou saindo do nó",expandHelp:"Mostra caminhos adicionais entrando ou saindo do nó",collapseHelp:"Remove os caminhos saindo ou entrando no nó"},sunburst:{audience:"Público-alvo","audience2+":"Públicos-alvos",category:"Categoria","category2+":"Categorias",metric:"Métrica","metric2+":"Métricas",primarymetric:"Métrica principal",secondarymetric:"Métrica secundária","secondarymetric2+":"Métricas secundárias",secondarymetrichelp:"Clique na métrica para alternar a altura","secondarymetrichelp2+":"Clique nas métricas para alternar a altura",emptyFirstMetric:"A primeira métrica não tem valores. Esolha uma métrica diferente.",total:"Total",zoomAction:"Clique duas vezes para aumentar o zoom.",moreAction:"Clique para ver mais opções.",zoomin:"Ampliar",zoomout:"Reduzir",hide:"Ocultar",hideall:"Ocultar tudo",hideother:"Ocultar outro",hidden:"{value} Item oculto","hidden2+":"{value} itens ocultos",topresults:"principais {value}",color:"Cor",height:"Altura",both:"Ambos",none:"Nenhum",mapmetric:"Mostrar {metric} como:",percmetric:"{percent} de {metric}",mobilescroll:"&#x25BC role para ver os detalhes"},flower:{joy:"Alegria",admiration:"Admiração",fear:"Medo",surprise:"Problemas",sadness:"Tristeza",disgust:"Repulsa",anger:"Raiva",anticipation:"Antecipação"},venn:{definedAudience:"Público-alvo definido"},funnel:{step:"Etapa",segment:"Segmento",conversion:"Conversão",fallout:"Fallout",average:"Média"}},"labels");
a.cloudViz.localeDefinition("pt-BR",{shortFormat:{hour:"%H",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%H",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%Hh %a %e"},fullFormat:{hour:"%Hh %a %e",day:"%A %e",week:"%A %e",month:"%B %Y",quarter:"%B %Y",year:"%Y",fallback:"%e %b, %Y",condensed:"%Y/%m/%d"}},"dateFormat");
a.cloudViz.localeDefinition("pt-BR",{decimalSeparator:",",groupSeparator:" ",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"},currency:{symbol:"R$",positivePattern:"{number} {symbol}",negativePattern:"-{number} {symbol}"}},"numberFormat");
a.cloudViz.localeDefinition("pt-BR",{singular:{second:"segundo",minute:"minuto",hour:"hora",day:"día",week:"semana",month:"mês",year:"ano"},plural:{second:"segundos",minute:"minutos",hour:"horas",day:"dias",week:"semanas",month:"meses",year:"anos"},abbreviation:{second:"s",minute:"min",hour:"h",day:"d",week:"w",month:"mon",year:"y"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("zh-CN",{monthAbbreviations:["1 月","2 月","3 月","4 月","5 月","6 月","7 月","8 月","9 月","10 月","11 月","12 月"],months:["1 月","2 月","3 月","4 月","5 月","6 月","7 月","8 月","9 月","10 月","11 月","12 月"],weekdayAbbreviations:["周日","周一","周二","周三","周四","周五","周六"],weekdays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ampm:["上午","下午"]},"calendar");
a.cloudViz.localeDefinition("zh-CN",{core:{nodata:"图表无数据",erroronrender:"抱歉！出现错误，无法呈现图表。",other:"其他",normalized:"已标准化"},dvcore:{target:"目标",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title}（{time}）",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"大小"},pathing:{entry:"登入",exit:"退出","entry2+":"登入","exit2+":"退出",path:"路径","path2+":"路径",expand:"展开",focus:"聚焦",collapse:"折叠",title:"路径图表",nodeEntries:"{label} 登入",nodeExits:"{label} 退出",nodeToNode:"{source} → {target}",percOfNode:"{perc} 的 {label}",pathToNode:"前往 {label} 的 {path}",pathFromNode:"来自 {label} 的 {path}",help1:"此图表代表从一种状态转变为另一种状态的路径。",help2:"每个长方形节点代表路径中的一种状态。",help3:"轻按或单击节点可以提供修改图表的其他选项：",focusHelp:"显示来往于节点的路径",expandHelp:"显示来往于节点的其他路径",collapseHelp:"删除来往于节点的路径"},sunburst:{audience:"受众","audience2+":"受众",category:"类别","category2+":"类别",metric:"量度","metric2+":"量度",primarymetric:"主要量度",secondarymetric:"次要量度","secondarymetric2+":"次要量度",secondarymetrichelp:"单击量度可切换高度","secondarymetrichelp2+":"单击量度可切换高度",emptyFirstMetric:"第一个量度没有值。请选择其他量度。",total:"合计",zoomAction:"双击可放大。",moreAction:"单击可获取更多选项。",zoomin:"放大",zoomout:"缩小",hide:"隐藏",hideall:"全部隐藏",hideother:"隐藏其他",hidden:"{value} 个隐藏的条目","hidden2+":"{value} 个隐藏的条目",topresults:"排名前 {value}",color:"彩色",height:"高度",both:"两者",none:"无",mapmetric:"{metric} 显示方式:",percmetric:"{percent} 的 {metric}",mobilescroll:"&#x25BC 展开详细信息"},flower:{joy:"欢快",admiration:"羡慕",fear:"害怕",surprise:"惊讶",sadness:"伤心",disgust:"厌恶",anger:"生气",anticipation:"期待"},venn:{definedAudience:"定义的受众"},funnel:{step:"步骤",segment:"区段",conversion:"转化",fallout:"流失",average:"平均"}},"labels");
a.cloudViz.localeDefinition("zh-CN",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e 日 %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e 日 %a %p %I"},fullFormat:{hour:"%e 日 %a %p %I",day:"%A %e",week:"%A %e",month:"%Y 年%B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e 日",condensed:"%Y/%m/%d"}},"dateFormat");
a.cloudViz.localeDefinition("zh-CN",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"¥",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat");
a.cloudViz.localeDefinition("zh-CN",{singular:{second:"秒",minute:"分钟",hour:"小时",day:"天",week:"周",month:"月",year:"年"},plural:{second:"秒",minute:"分钟",hour:"小时",day:"天",week:"周",month:"月",year:"年"},abbreviation:{second:"秒",minute:"分钟",hour:"小时",day:"天",week:"周",month:"月",year:"年"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("zh-TW",{monthAbbreviations:["1 月","2 月","3 月","4 月","5 月","6 月","7 月","8 月","9 月","10 月","11 月","12 月"],months:["1 月","2 月","3 月","4 月","5 月","6 月","7 月","8 月","9 月","10 月","11 月","12 月"],weekdayAbbreviations:["週日","週一","週二","週三","週四","週五","週六"],weekdays:["星期日","星期一","星期二","星期三","星期四","星期五","星期六"],ampm:["上午","下午"]},"calendar");
a.cloudViz.localeDefinition("zh-TW",{core:{nodata:"此圖表沒有任何資料",erroronrender:"糟糕！發生錯誤，無法產生圖表。",other:"其他",normalized:"已標準化"},dvcore:{target:"目標",yAxisTimeNoTitle:"{time}",yAxisTimeWithTitle:"{title} (以{time}數計)",legendTime:"{value} {time}"},point:{xScale:"X",yScale:"Y",sizeScale:"大小"},pathing:{entry:"登入點",exit:"退出點","entry2+":"登入點","exit2+":"退出點",path:"路徑","path2+":"路徑",expand:"展開",focus:"焦點",collapse:"摺疊",title:"路徑圖表",nodeEntries:"{label} 登入點",nodeExits:"{label} 退出點",nodeToNode:"{source} → {target}",percOfNode:"{perc} 的 {label}",pathToNode:"連至 {label} 的 {path}",pathFromNode:"來自 {label} 的 {path}",help1:"此圖表代表從一狀態變為另一狀態的路徑。",help2:"每個設計成方塊的節點都代表路徑中的一種狀態。",help3:"點選或按一下節點即可取得用於修改圖表的其他選項:",focusHelp:"顯示進出節點的路徑",expandHelp:"顯示前往或遠離節點的其他路徑",collapseHelp:"移除前往或遠離節點的路徑"},sunburst:{audience:"讀者","audience2+":"讀者",category:"類別","category2+":"類別",metric:"量度","metric2+":"量度",primarymetric:"主要量度",secondarymetric:"次要量度","secondarymetric2+":"次要量度",secondarymetrichelp:"按一下量度以切換高度","secondarymetrichelp2+":"按一下量度以切換高度",emptyFirstMetric:"第一個量度沒有值。請選擇其他量度。",total:"總計",zoomAction:"連按兩下來放大顯示。",moreAction:"按一下存取更多選項。",zoomin:"放大",zoomout:"縮小",hide:"隱藏",hideall:"全部隱藏",hideother:"隱藏其他",hidden:"{value} 個隱藏項目","hidden2+":"{value} 個隱藏項目",topresults:"前 {value} 個項目",color:"色彩",height:"高度",both:"兩者",none:"無",mapmetric:"將 {metric} 顯示為:",percmetric:"{percent} 的 {metric}",mobilescroll:"&#x25BC 捲動以瞭解詳細資料"},flower:{joy:"歡樂",admiration:"欽佩",fear:"恐懼",surprise:"驚喜",sadness:"傷心",disgust:"噁心",anger:"憤怒",anticipation:"期望"},venn:{definedAudience:"特定讀者"},funnel:{step:"步驟",segment:"區段",conversion:"轉換",fallout:"流失",average:"平均"}},"labels");
a.cloudViz.localeDefinition("zh-TW",{shortFormat:{hour:"%p %I",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"%Y",fallback:"%e"},mediumFormat:{hour:"%p %I",day:"%a %e",week:"%a %e",month:"%b",quarter:"%b",year:"%Y",fallback:"%a %e"},longFormat:{hour:"%e 日 %a %p %I",day:"%A %e",week:"%A %e",month:"%B",quarter:"%B",year:"%Y",fallback:"%e 日 %a %p %I"},fullFormat:{hour:"%e 日 %a %p %I",day:"%A %e",week:"%A %e",month:"%Y 年 %B",quarter:"%Y %B",year:"%Y",fallback:"%Y %b %e 日",condensed:"%Y/%m/%d"}},"dateFormat");
a.cloudViz.localeDefinition("zh-TW",{decimalSeparator:".",groupSeparator:",",negativePattern:"-{number}",percent:{symbol:"%",positivePattern:"{number}{symbol}",negativePattern:"-{number}{symbol}"},currency:{symbol:"NT$",positivePattern:"{symbol}{number}",negativePattern:"-{symbol}{number}"}},"numberFormat");
a.cloudViz.localeDefinition("zh-TW",{singular:{second:"秒",minute:"分鐘",hour:"小時",day:"天",week:"週",month:"月",year:"年"},plural:{second:"秒",minute:"分鐘",hour:"小時",day:"天",week:"週",month:"月",year:"年"},abbreviation:{second:"秒",minute:"分鐘",hour:"小時",day:"天",week:"週",month:"月",year:"年"}},"time")
}(this));
(function(a){a.cloudViz.localeDefinition("zz-ZZ",{monthAbbreviations:["[g] 승_Jan_文","[q] 승_Feb_文","[r] 승_Mar_文","[n] 승_Apr_文","[p] 승_May_文","[k] 승_Jun_文","[l] 승_Jul_文","[i] 승_Aug_文","[j] 승_Sep_文","[h] 승_Oct_文","[o] 승_Nov_文","[m] 승_Dec_文"],months:["[1] 승_January_文","[2] 승_February_文","[3] 승_March_文","[x] 승_April_文","[y] 승_May_文","[z] 승_June_文","[0] 승_July_文","[s] 승_August_文","[t] 승_September_文","[u] 승_October_文","[v] 승_November_文","[w] 승_December_文"],weekdayAbbreviations:["[+] 승_Sun_文","[4] 승_Mon_文","[5] 승_Tue_文","[6] 승_Wed_文","[7] 승_Thu_文","[8] 승_Fri_文","[9] 승_Sat_文"],weekdays:["[BB] 승_Sunday_文","[BA] 승_Monday_文","[/] 승_Tuesday_文","[BC] 승_Wednesday_文","[BD] 승_Thursday_文","[BE] 승_Friday_文","[BF] 승_Saturday_文"],ampm:["[e] 승_AM_文","[f] 승_PM_文"]},"calendar");
a.cloudViz.localeDefinition("zz-ZZ",{core:{nodata:"[BH] 승_The chart has no data_文",erroronrender:"[BG] 승_Oops! There was an error and the chart could not be rendered._文",other:"[BJ] 승_Other_文",normalized:"[BI] 승_Normalized_文"},dvcore:{target:"[BL] 승_Target_文",yAxisTimeNoTitle:"[BK] 승_{time}_文",yAxisTimeWithTitle:"[BN] 승_{title} (in {time})_文",legendTime:"[BM] 승_{value} {time}_文"},point:{xScale:"[Bp] 승_X_文",yScale:"[Br] 승_Y_文",sizeScale:"[Bq] 승_Size_文"},pathing:{entry:"[Be] 승_Entry_文",exit:"[Bg] 승_Exit_文","entry2+":"[Bn] 승_Entries_文","exit2+":"[Bb] 승_Exits_文",path:"[BZ] 승_Path_文","path2+":"[Bf] 승_Paths_文",expand:"[BX] 승_Expand_文",focus:"[BW] 승_Focus_文",collapse:"[Bj] 승_Collapse_文",title:"[Bc] 승_Pathing Chart_文",nodeEntries:"[Cz] 승_{label} Entries_文",nodeExits:"[C0] 승_{label} Exits_文",nodeToNode:"[Cy] 승_{source} → {target}_文",percOfNode:"[Ba] 승_{perc} of {label}_文",pathToNode:"[Bo] 승_{path} to {label}_文",pathFromNode:"[Bd] 승_{path} from {label}_文",help1:"[BY] 승_This chart represents paths taken from one state to another._文",help2:"[Bh] 승_Each node, shaped as a box, represents a state in the path._文",help3:"[Bk] 승_Tapping or clicking a node will provide additional options to modify the chart:_文",focusHelp:"[Bm] 승_Shows paths coming into and going out of node_文",expandHelp:"[Bi] 승_Shows additional paths coming or going from the node_文",collapseHelp:"[Bl] 승_Removes paths coming or going from the node_文"},sunburst:{audience:"[Ci] 승_Audience_文","audience2+":"[Ce] 승_Audiences_文",category:"[Ch] 승_Category_文","category2+":"[Cf] 승_Categories_文",metric:"[Cd] 승_Metric_文","metric2+":"[Cg] 승_Metrics_文",primarymetric:"[Cj] 승_Primary Metric_文",secondarymetric:"[Cl] 승_Secondary Metric_文","secondarymetric2+":"[Ck] 승_Secondary Metrics_文",secondarymetrichelp:"[Cm] 승_Click metric to toggle height_文","secondarymetrichelp2+":"[Cn] 승_Click metrics to toggle height_文",emptyFirstMetric:"[B2] 승_The first metric has no values. Please pick a different metric._文",total:"[B7] 승_Total_文",zoomAction:"[By] 승_Double-click to Zoom in._文",moreAction:"[B5] 승_Click for more options._文",zoomin:"[Bz] 승_Zoom In_文",zoomout:"[Bs] 승_Zoom Out_文",hide:"[Bt] 승_Hide_文",hideall:"[Bw] 승_Hide All_文",hideother:"[Bu] 승_Hide Other_文",hidden:"[B4] 승_{value} Hidden Item_文","hidden2+":"[B0] 승_{value} Hidden Items_文",topresults:"[B8] 승_top {value}_文",color:"[Bx] 승_Color_文",height:"[Bv] 승_Height_文",both:"[B6] 승_Both_文",none:"[B3] 승_None_文",mapmetric:"[B9] 승_Show {metric} as:_文",percmetric:"[B1] 승_{percent} of {metric}_文",mobilescroll:"[Co] 승_&#x25BC scroll for details_文"},flower:{joy:"[BU] 승_Joy_文",admiration:"[BT] 승_Admiration_文",fear:"[BQ] 승_Fear_文",surprise:"[BR] 승_Surprise_文",sadness:"[BO] 승_Sadness_文",disgust:"[BP] 승_Disgust_文",anger:"[BV] 승_Anger_文",anticipation:"[BS] 승_Anticipation_文"},venn:{definedAudience:"[B+] 승_Defined Audience_文"},funnel:{step:"[C3] 승_Step_文",segment:"[C4] 승_Segment_文",conversion:"[C1] 승_Conversion_文",fallout:"[C5] 승_Fallout_文",average:"[C2] 승_Average_文"}},"labels");
a.cloudViz.localeDefinition("zz-ZZ",{shortFormat:{hour:"[Z] 승_%I %p_文",day:"%e",week:"%e",month:"%b",quarter:"%b",year:"[d] 승_%Y_文",fallback:"%e"},mediumFormat:{hour:"[S] 승_%I %p_文",day:"[Q] 승_%a %e_文",week:"[T] 승_%a %e_文",month:"%b",quarter:"%b",year:"[U] 승_%Y_文",fallback:"[V] 승_%a %e_文"},longFormat:{hour:"[P] 승_%I %p %a %e_文",day:"[M] 승_%A %e_文",week:"[O] 승_%A %e_文",month:"[L] 승_%B_文",quarter:"[K] 승_%B_文",year:"[J] 승_%Y_文",fallback:"[N] 승_%I %p %a %e_文"},fullFormat:{hour:"[D] 승_%I %p %a %e_文",day:"[C] 승_%A %e_文",week:"[B] 승_%A %e_文",month:"[G] 승_%B %Y_文",quarter:"[E] 승_%B %Y_文",year:"[I] 승_%Y_文",fallback:"[F] 승_%b %e, %Y_文",condensed:"[H] 승_%m/%d/%Y_文"}},"dateFormat");
a.cloudViz.localeDefinition("zz-ZZ",{decimalSeparator:"[CC] 승_._文",groupSeparator:"[CD] 승_,_文",negativePattern:"[CE] 승_-{number}_文",percent:{symbol:"[CF] 승_%_文",positivePattern:"[CG] 승_{number}{symbol}_文",negativePattern:"[CH] 승_-{number}{symbol}_文"},currency:{symbol:"[B/] 승_$_文",positivePattern:"[CA] 승_{symbol}{number}_文",negativePattern:"[CB] 승_-{symbol}{number}_文"}},"numberFormat");
a.cloudViz.localeDefinition("zz-ZZ",{singular:{second:"[CX] 승_second_文",minute:"[CY] 승_minute_文",hour:"[CZ] 승_hour_文",day:"[CV] 승_day_文",week:"[Ca] 승_week_文",month:"[Cb] 승_month_文",year:"[CW] 승_year_文"},plural:{second:"[CS] 승_seconds_文",minute:"[CP] 승_minutes_文",hour:"[Cc] 승_hours_文",day:"[CR] 승_days_文",week:"[CQ] 승_weeks_文",month:"[CT] 승_months_文",year:"[CU] 승_years_文"},abbreviation:{second:"[CJ] 승_s_文",minute:"[CO] 승_min_文",hour:"[CK] 승_h_文",day:"[CI] 승_d_文",week:"[CL] 승_w_文",month:"[CM] 승_mon_文",year:"[CN] 승_y_文"}},"time")
}(this));
dvCoral=window.dvCoral||{format:{monthLabelFormat:d3.time.format("%A, %B %e"),dayLabelFormat:d3.time.format("%A %e"),hourLabelFormat:d3.time.format("%I:%M %p"),miniFullDate:d3.time.format("%m/%d/%y")},color16:["#82C850","#465A9B","#DC2D5F","#3287D2","#419687","#A03282","#8287E6","#F08C1E","#5AD2D2","#CDD250","#C81E8C","#EB642D","#5FAF69","#EB3C37","#5AAFD7","#F5C841"],_resizeHandlers:[],addResizeHandler:function(a){dv.addWindowResizeHandler(a);
dvCoral._resizeHandlers.push(a)
},removeResizeHandlers:function(){for(var a=0;
a<dvCoral._resizeHandlers.length;
a++){dv.removeWindowResizeHandler(dvCoral_resizeHandlers[a])
}}};
dvCoral.predictiveTrend=function(){var d={},g,m,k=dv.chart(),j,l,f,a=true,b=320,h=[],n;
d.render=function(){d._draw(true);
return d
};
d._draw=function(o){n=null;
k.data(j).map("x","x",dv.scale.time()).map("y","y",dv.scale.linear().lowerLimit(0)).padding({left:10,top:1,right:0,bottom:30});
if(m.clientWidth<b){d._drawMini(o)
}else{d._drawLarge(o)
}if(!o){k.duration(0)
}else{k.duration(1000)
}k.render()
};
d._drawMini=function(o){k.layers([dv.geom.ribbon().interpolate("cardinal").data(l).set("fill","#CCC").set("alpha",0.3).map("yMax","upper").map("yMin","lower"),dv.geom.line().set("linetype","").map("stroke","series",dv.scale.ordinal().values(["#FD7F00"])),dv.geom.line().data(l).map("stroke","series",dv.scale.ordinal().values(["#CCC"])).set("linetype","dashed"),dv.geom.vline().data(l).map("x","predictiveStart").set("stroke","#CCC").set("linetype","dashed").set("alpha",0.6),dv.geom.text().data(f).set("label",function(q,p){return dvCoral.format.miniFullDate(q.x)
}).set("fill","#b9b9b9").set("stroke","none").set("size","8pt").textAnchor("middle").dy(20)]).guide("x","none").guide("y",dv.guide.axis().ticks(3).tickSize(0).tickPadding(-30).tickFormat(d._yTickFormat)).guide("stroke",dv.guide.legend().orientation("top").labels(h).padding({bottom:40}).hGap(30)).width(240).height(undefined)
};
d._drawLarge=function(o){var q=Math.max(m.clientWidth/300,2),p=Math.max(0,Math.min(5,m.clientHeight/75));
k.layers([dv.geom.ribbon().interpolate("cardinal").tension(0.6).data(l).set("fill","#CCC").set("alpha",0.3).map("yMax","upper").map("yMin","lower"),dv.geom.line().map("stroke","series",dv.scale.ordinal().values(j.color)),dv.geom.line().interpolate("cardinal").tension(0.6).data(l).map("stroke","series",dv.scale.ordinal().values(["#CCC"])).set("linetype","dashed"),dv.geom.vline().data(l).map("x","predictiveStart").set("stroke","#CCC").set("linetype","dashed").set("alpha",0.6)]).guide("y","none").guide("x",dv.guide.axis().ticks(q).tickFormat(d._xTickFormat).tickPadding(12).orientation("top")).width(540).height(355)
};
d._xTickFormat=function(q,o){var p;
if(o===0||n.getMonth()!=q.getMonth()){p=dvCoral.format.monthLabelFormat(q)
}else{if(n.getDate()!=q.getDate()){p=dvCoral.format.dayLabelFormat(q)
}else{if(n.getHours()!=q.getHours()){p=dvCoral.format.hourLabelFormat(q)
}}}n=q;
return p
};
d._yTickFormat=function(p,o){if(!p){return""
}return"$"+d3.format("s")(p,o)
};
d._computeXExtent=function(q){var o=-1,s=q.x.length,p={x:[undefined,undefined],y:[0,0]};
while(++o<s){var r=q.x[o];
if(p.x[0]===undefined||r<p.x[0]){p.x[0]=r
}if(p.x[1]===undefined||r>p.x[1]){p.x[1]=r
}}return p
};
d._resizeHandler=function(){d._draw(false)
};
d.legendLabels=function(o){if(!arguments.length){return h
}h=o;
return d
};
d.parent=function(o){if(!arguments.length){return m
}k.parent(o);
m=k.parent();
g=d3.select(m);
return d
};
d.actualData=function(o){if(!arguments.length){return j
}j=o;
f=d._computeXExtent(j);
return d
};
d.predictiveData=function(o){if(!arguments.length){return l
}l=o;
return this
};
d.chart=function(){return k
};
dvCoral.addResizeHandler(d._resizeHandler);
return d
};
dvCoral.anomalyTrend=function(){var d={},f,k,j=dv.chart(),g,b,a=320,h=[],l;
d.render=function(){d._draw(true);
return d
};
d._draw=function(m){l=null;
j.data(g).width(undefined).height(undefined).map("x","x",dv.scale.time()).map("y","y",dv.scale.linear().lowerLimit(0).upperLimit(6)).map("yMin","yMin").map("yMax","yMax").map("stroke","series").padding({left:50,top:30,right:50,bottom:50}).guide("stroke",dv.guide.legend().orientation("top").labels(h).padding({bottom:40}).vGap(5));
if(k.clientWidth<a){d._drawMini(m)
}else{d._drawLarge(m)
}if(!m){j.duration(0)
}else{j.duration(1000)
}j.render()
};
d._drawMini=function(m){j.layers([dv.geom.line().map("stroke","series"),dv.geom.ribbon().set("alpha",0.15).interpolate("monotone").set("fill","#ff0000"),dv.geom.point().set("stroke",function(o,n){return(o.data.y>o.data.yMax||o.data.y<o.data.yMin)?dvCoral.color16[0]:"none"
}).set("fill",function(o,n){return(o.data.y>o.data.yMax||o.data.y<o.data.yMin)?"#FFFFFF":"none"
}),dv.geom.text().map("fill","series").set("stroke","none").set("label",function(o,n){return(o.data.y>o.data.yMax||o.data.y<o.data.yMin)?o.data.y+"%":""
}).textAnchor("left").dx(8).dy(5),dv.geom.text().data(b).set("label",function(o,n){return dvCoral.format.miniFullDate(o.x)
}).set("fill","#b9b9b9").set("stroke","none").set("size","8pt").textAnchor("middle").dy(20)]).guide("y",dv.guide.axis().ticks(2).tickPadding(12).orientation("right").tickFormat(d._yTickFormat)).guide("x","none")
};
d._drawLarge=function(m){var o=Math.max(k.clientWidth/170,2),n=Math.max(0,Math.min(5,k.clientHeight/75));
j.layers([dv.geom.line().map("stroke","series"),dv.geom.ribbon().set("alpha",0.15).interpolate("monotone"),dv.geom.point().set("stroke",function(q,p){return(q.data.y>q.data.yMax||q.data.y<q.data.yMin)?dvCoral.color16[0]:"none"
}).set("fill",function(q,p){return(q.data.y>q.data.yMax||q.data.y<q.data.yMin)?"#FFFFFF":"none"
}),dv.geom.text().map("fill","series").set("stroke","none").set("label",function(q,p){return(q.data.y>q.data.yMax||q.data.y<q.data.yMin)?q.data.y+"%":""
}).textAnchor("left").dx(10).dy(4)]).guide("x",dv.guide.axis().ticks(o).tickFormat(d._xTickFormat).tickPadding(12).orientation("top")).guide("y",dv.guide.axis().ticks(n).tickPadding(12).orientation("right").tickFormat(d._yTickFormat))
};
d.legendLabels=function(m){if(!arguments.length){return h
}h=m;
return d
};
d.data=function(m){if(!arguments.length){return g
}g=m;
b=d._computeXExtent(g);
return d
};
d.parent=function(m){if(!arguments.length){return k
}j.parent(m);
k=j.parent();
f=d3.select(k);
return d
};
d._xTickFormat=function(o,m){var n;
if(m===0||l.getMonth()!=o.getMonth()){n=dvCoral.format.monthLabelFormat(o)
}else{if(l.getDate()!=o.getDate()){n=dvCoral.format.dayLabelFormat(o)
}else{if(l.getHours()!=o.getHours()){n=dvCoral.format.hourLabelFormat(o)
}}}l=o;
return n
};
d._yTickFormat=function(n,m){return n+"%"
};
d._computeXExtent=function(p){var m=-1,r=p.x.length,o={x:[undefined,undefined],y:[0,0]};
while(++m<r){var q=p.x[m];
if(o.x[0]===undefined||q<o.x[0]){o.x[0]=q
}if(o.x[1]===undefined||q>o.x[1]){o.x[1]=q
}}return o
};
d._resizeHandler=function(){d._draw(false)
};
dvCoral.addResizeHandler(d._resizeHandler);
return d
};
dvCoral.scatterplot=function(){var d={},f,l,j=dv.chart(),g,a=true,b=320,h=[],k=[];
d.render=function(){d._draw(true);
return d
};
d.destroy=function(){dv.removeWindowResizeHandler(d._resizeHandler)
};
d._draw=function(m){j.data(g).width(undefined).height(undefined).map("x","x").map("y","y").padding({left:55,top:30,right:50,bottom:50});
if(l.clientWidth<b){d._drawMini(m)
}else{d._drawLarge(m)
}if(!m){j.duration(0)
}else{j.duration(1000)
}j.render()
};
d._drawMini=function(m){j.layers([dv.geom.point().each("start",function(n){if(d._isAnomalous(n)){d3.select(this).classed("anomaly",true)
}})]).set("alpha",function(n){return d._isAnomalous(n)?1:0.4
}).set("fill",function(n){return d._isAnomalous(n)?"#81C64E":"#45589A"
}).set("size",function(n){return d._isAnomalous(n)?9:7
}).set("stroke",function(n){return d._isAnomalous(n)?"#81C64E":"none"
}).guide("x",dv.guide.axis().ticks(3).tickFormat(d._xTickFormat).tickSize(0).tickPadding(-15).orientation("bottom").title("Revenue").titleOrientation("bottom")).guide("y",dv.guide.axis().ticks(3).tickFormat(d._yTickFormat).tickSize(0).tickPadding(-33).orientation("left").title("ROAS").titleOrientation("left"))
};
d._drawLarge=function(m){var o=Math.max(l.clientWidth/170,2),n=Math.max(0,Math.min(5,l.clientHeight/75));
j.layers([dv.geom.point().each("start",function(p){if(d._isAnomalous(p)){d3.select(this).classed("anomaly",true)
}})]).set("alpha",function(p){return d._isAnomalous(p)?1:0.4
}).set("fill",function(p){return d._isAnomalous(p)?"#81C64E":"#45589A"
}).set("size",function(p){return d._isAnomalous(p)?9:7
}).set("stroke",function(p){return d._isAnomalous(p)?"#81C64E":"none"
}).guide("x",dv.guide.axis().ticks(o).tickFormat(d._xTickFormat).tickPadding(12).orientation("top").title("Revenue").titleOrientation("bottom")).guide("y",dv.guide.axis().ticks(n).tickPadding(12).orientation("right").tickFormat(d._yTickFormat).title("ROAS").titleOrientation("left"))
};
d._xTickFormat=function(n,m){return"$"+d3.format("s")(n)
};
d._yTickFormat=function(n,m){return !n?"":d3.format(",%")(n)
};
d._isAnomalous=function(n,m){return(n.data.x<d._anomalyXBounds[0]||n.data.x>d._anomalyXBounds[1]||n.data.y<d._anomalyYBounds[0]||n.data.y>d._anomalyYBounds[1])
};
d._resizeHandler=function(){d._draw(false)
};
d.legendLabels=function(m){if(!arguments.length){return h
}h=m;
return d
};
d.legendValues=function(m){if(!arguments.length){return k
}k=m;
return d
};
d.anomalyXBounds=function(m){if(!arguments.length){return this._anomalyXBounds
}this._anomalyXBounds=m;
return this
};
d.anomalyYBounds=function(m){if(!arguments.length){return this._anomalyYBounds
}this._anomalyYBounds=m;
return this
};
d.parent=function(m){if(!arguments.length){return l
}j.parent(m);
l=j.parent();
f=d3.select(l);
return d
};
d.data=function(m){if(!arguments.length){return g
}g=m;
return d
};
d.chart=function(){return j
};
dvCoral.addResizeHandler(d._resizeHandler);
return d
};
tartan=window.tartan||{};
tartan.dv=tartan.dv||{};
tartan.dv.types=tartan.dv.types||{};
tartan.dv.types.NUM_SERIES=5;
tartan.dv.types.normalize=function(a){if(!a){return{dataAdapter:"rs"}
}if(!a.dataAdapter){a.dataAdapter="rs"
}if(a.stack){delete a.stack;
a.position="stack"
}if(a.dodge){delete a.dodge;
a.position="dodge"
}if(a.fill){delete a.fill;
a.filled=true
}return a
};
(function(b,a,f){function d(k){if(k===f){return{}
}var n=k.split("/").slice(1);
var m=n[0];
var j=n[1];
var h={category:m,type:j};
if(n[2]){var l=n[2].split(",");
for(var g=0;
g<l.length;
g++){h[l[g]]=true
}}return h
}tartan.dv.render=function(g){function k(t,w){var r=t.dataURL;
var v=function(B){t.dataJSON=B.responseText;
var z;
try{z=JSON.parse(t.dataJSON)
}catch(A){if(a.console&&a.console.error){console.error("Error parsing report data",A)
}z={errno:"Error while parsing report data."};
t.dataJSON=""
}w.call(this,z);
if(t.onSuccess){t.onSuccess.call(this,t)
}};
var s=function(z){if(a.console&&console.error){console.error("error while loading report data.")
}t.data={errno:"Error while loading report data."};
w.call(this,l);
if(t.onError){t.onError.call(this,t)
}};
var u=new XMLHttpRequest();
if(r.charAt(0)!="/"){r="/content/mac/default/tools/shareframe.tokenProxy.html?proxyUri="+encodeURIComponent(r)
}u.open("GET",r,true);
u.onerror=function(){s(u)
};
u.ontimeout=function(){s(u)
};
u.onload=function(){v(u)
};
if(u.setRequestHeader){u.setRequestHeader("content-type","application/json;charset=UTF-8")
}u.send()
}function o(A){var s=b(g.parent);
var r=s.find(".mac-dv-error");
if(r.length>0){r.remove()
}var E=s.find(".cv-wrapper");
if(E.length>0){E.remove()
}try{if(typeof A==="string"){A=JSON.parse(A)
}}catch(w){if(a.console&&console.error){console.error("Cannot parse JSON data",A,w)
}}if(A&&A.errno){if(a.console){console.log("error:",A)
}if(g.onError){g.onError.call(this,g)
}else{s.append('<div class="mac-dv-error"><h1>'+Granite.I18n.get("Error loading chart data.")+"</h1></div>");
return
}}try{var t;
var C=(q.indexOf("_card")>-1);
if(g.chartType!="abntest"){if(!A||!A.data||A.data.length===0){if(a.console){console.log("empty results for",q)
}s.append('<div class="mac-dv-error"><h1>'+Granite.I18n.get("No chart data.")+"</h1></div>");
return
}}if(A.data&&A.data.x){t=A.data;
for(var u=0;
u<t.x.length;
u++){var D=t.x[u];
if(typeof D==="string"&&D.match(/\d\d\d\d-\d\d-\d\dT\d\d:\d\d:\d\d.*/)){t.x[u]=new Date(D)
}}}else{var B=g.chartOpts||{};
if(C){B.displayCount=tartan.dv.types.NUM_SERIES
}t=p.convert?p.convert(A,B):rs2dv(A,B)
}s.addClass("mac-dv-"+q);
var z=p.create(t,s,g);
if(z.render){z.setOption("animate",!C);
z.render()
}if(z.dvChart){z=z.dvChart()
}s.trigger("render",z);
if(g.resizeWatch){var F;
b(a).resize(function(){clearTimeout(F);
F=setTimeout(function(){var v=p.create(t,s,g);
if(v.render){v.setOption("animate",false);
v.render()
}if(v.dvChart){v=v.dvChart()
}s.trigger("render",v)
},300)
})
}}catch(w){if(a.console&&console.error){console.error("error while rendering chart of type "+q,s,w)
}}}function h(r){if(g.dataCachePath){a.setTimeout(function(){b.post(g.dataCachePath,{data:JSON.stringify(r)})
},Math.random()*10000)
}}var m=d(g.chartType);
var q="";
if(m.category=="trend"){if(m.type=="line"){q="trend"
}else{if(m.type=="bar"){q="bar"
}}}else{if(m.category=="rank"){if(m.type=="bar"){if(m.polar){q="pie"
}else{q="bar"
}}else{if(m.type=="point"){q="bubble"
}}}}if(!q){q=g.chartType
}if(g.card&&tartan.dv.types[q+"_card"]){q+="_card"
}var p=tartan.dv.types[q];
if(p===f){throw new Error("unsupported chart type: "+g.chartType)
}if(g.chartOpts&&g.chartOpts.position===f&&g.chartOpts.flip===f){b.extend(g.chartOpts,m)
}if(a.console){console.log("before render",q,g.chartOpts)
}if(g.data){o(g.data)
}else{if(g.dataURL.indexOf("data:")===0){var j=g.dataURL;
var l=j.substring(j.indexOf(",")+1);
try{l=JSON.parse(l)
}catch(n){if(a.console&&a.console.error){console.error("Error parsing report data",n)
}l={errno:"Error while parsing report data."};
g.dataJSON=""
}o(l)
}else{k(g,function(r){o(r);
h(r)
})
}}};
tartan.dv.refresh=function(k){var h=k.cardPath;
var g=k.dataURL;
if(g.match("^data:.*")){if(a.console&&console.warn){console.warn("Cannot refresh data with inline data URLs")
}k.onError.call(this);
return
}var m=function(q){try{var o=JSON.parse(q.responseText);
k.data=o
}catch(p){if(a.console&&a.console.error){console.error("Error parsing report data",p)
}k.data={errno:"Error while parsing report data."}
}if(k.onSuccess){k.onSuccess.call(this,q)
}if(k.parent.is("img")){var n=k.parent.attr("src");
n=n.replace(/(.*\.)(.*?)(\.png)/,"$1"+new Date().getTime()+"$3");
k.parent.attr("src",n)
}else{tartan.dv.render(k)
}};
var j=function(n){if(a.console&&console.error){console.error("error while loading report data.")
}if(k.onError){k.onError.call(this,n)
}};
var l=new XMLHttpRequest();
if(g.charAt(0)!="/"){g=h+".tokenProxy.html?refresh=true&proxyUri="+encodeURIComponent(g)
}l.open("GET",g,true);
l.onerror=function(){j(l)
};
l.ontimeout=function(){j(l)
};
l.onload=function(){m(l)
};
if(l.setRequestHeader){l.setRequestHeader("content-type","application/json;charset=UTF-8")
}l.send()
}
})(jQuery,window);
tartan.dv.types.bar={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,autoResize:false,position:"stack"},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.bar(a)
}};
tartan.dv.types.bar_card={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,autoResize:true,position:"stack",height:300},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.bar(a)
}};
tartan.dv.types.bubble={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,autoResize:false},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.point(a)
}};
tartan.dv.types.bubble_card={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,height:300},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.point(a)
}};
tartan.dv.types.pie={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,autoResize:false,},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.donut(a)
}};
tartan.dv.types.pie_card={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,height:300},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.donut(a)
}};
tartan.dv.types.trend={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,autoResize:false},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.line(a)
}};
tartan.dv.types.trend_card={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,height:300},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.line(a)
}};
dvCoral.bullet=function(){var b={},f,l,j=dv.chart(),h,a=true,k=0,d=320,g=[];
b.render=function(){b._draw(false);
b._addStripes();
return b
};
b._draw=function(m){j.data(h).width(undefined).height(undefined).map("y","y",dv.scale.linear().lowerLimit(0)).set("fill",function(o,n){return(o.data.hasOwnProperty("type")&&o.data.type==="solid")?dvCoral.color16[o.data.seriesIndex]:"#FFF"
}).guide("x",dv.guide.axis().tickSize(0).orientation("top").tickValues(g)).padding({left:60,top:20,right:50,bottom:10}).coord(dv.coord.cartesian().flip(true));
if(k>0){j.width(l.clientWidth).height(l.clientWidth*k)
}if(l.clientWidth<d){b._drawMini(m)
}else{b._drawLarge(m)
}if(!m){j.duration(0)
}else{j.duration(1000)
}j.render()
};
b._drawMini=function(m){j.layers([dv.geom.bar().each("start",function(o,n){d3.select(this).classed(o.data.type,true)
})]).map("x","x",dv.scale.ordinal().reverse(true)).guide("y","none")
};
b._drawLarge=function(n){var o=Math.max(l.clientWidth/120,2),m=Math.min(0.6,Math.max(0.05,l.clientHeight/2000));
j.layers([dv.geom.bar().each("start",function(q,p){d3.select(this).classed(q.data.type,true)
})]).map("x","x",dv.scale.ordinal().reverse(true).outerPadding(m).padding(m)).guide("y",dv.guide.axis().ticks(o).tickSize(0).tickPadding(-12).orientation("right").tickFormat(b._yTickFormat))
};
b._addStripes=function(){var o=d3.select($("svg",$(l))[0]);
var m=o.select("defs");
if(m.empty()){m=o.append("defs");
m.append("pattern").attr("id","stripe1").classed("stripe",true).attr("patternUnits","userSpaceOnUse").attr("width",4).attr("height",4).append("line").attr("x1",0).attr("y1",4).attr("x2",4).attr("y2",0);
m.append("pattern").attr("id","stripe2").classed("stripe",true).attr("patternUnits","userSpaceOnUse").attr("x",-2).attr("y",-2).attr("width",4).attr("height",4).append("line").attr("x1",0).attr("y1",4).attr("x2",4).attr("y2",0);
var n=m.append("mask").attr("id","stripeMask");
n.selectAll("rect").data(["stripe1","stripe2"]).enter().append("rect").attr("height",2000).attr("width",2000).style("fill",function(p){return"url(#"+p+")"
})
}};
b._yTickFormat=function(n,m){if(!n){return""
}return d3.format(",%")(n,m)
};
b._resizeHandler=function(){b._draw(false)
};
b.legendLabels=function(m){if(!arguments.length){return g
}g=m;
return b
};
b.parent=function(m){if(!arguments.length){return l
}j.parent(m);
l=j.parent();
f=d3.select(l);
return b
};
b.data=function(m){if(!arguments.length){return h
}h=m;
return b
};
b.chart=function(){return j
};
b.ratio=function(m){if(!arguments.length){return k
}k=m;
return b
};
return b
};
tartan.dv.types.bullet={convert:function(f){if(f.data||f.data=="random"){return this.generateData()
}var d;
if(f.x){d=f
}else{d={x:[],y:[]};
var b=f.data,h=f.filters,g=f.metrics[0].filter_ref;
for(var a=0;
a<Math.min(5,g.length);
a++){d.x[a]=h[a].info?h[a].info.name:""+a;
d.y[a]=Math.floor(b[a][0][0].val)
}}if(!d.legend){d.legend={labels:["Desktop sites","Google ads","Facebook","Mobile sites","Bing ads","Twitter","Yahoo ads"],values:["183,415","131,357","101,159","183,415","131,357","101,159","183,415"]}
}return d
},create:function(b,d,a){var f=dvCoral.bullet().legendLabels(b.legend.labels).data(b).parent(d[0]);
return f
},generateData:function(){return{x:["1","1","1","2","2","2","3","3","3"],y:[1,1,0.5,0.8,0.8,0.72,0.7,0.7,0.59],seriesIndex:[0,0,0,1,1,1,2,2,2],type:["solid","striped","solid","solid","striped","solid","solid","striped","solid"],legend:{labels:["Search","Display","Social"]}}
}};
tartan.dv.types.bullet_card={convert:tartan.dv.types.bullet.convert,generateData:tartan.dv.types.bullet.generateData,create:function(b,d,a){var f=dvCoral.bullet().legendLabels(b.legend.labels).data(b).ratio(0.8).parent(d[0]);
return f
}};
dvCoral.predictiveSeries=function(){var n={},f,m,k=dv.chart(),h,l,d,a=true,b=320,g=[],j=0,o;
n.render=function(p){n._draw(p);
return n
};
n._draw=function(p){o=null;
k.data(h).map("x","x",dv.scale.time()).map("y","y",dv.scale.linear().lowerLimit(0)).padding({left:10,top:5,right:0,bottom:30}).width(undefined).height(undefined);
if(j>0){k.width(m.clientWidth).height(m.clientWidth*j)
}if(m.clientWidth<b){k.layers([dv.geom.line().map("stroke","series",dv.scale.ordinal().values(h.color)),dv.geom.vline().data(l).map("x","predictiveStart").set("stroke","#afafaf").set("linetype","dashed").set("alpha",0.6)]);
n._drawMini(p)
}else{k.layers([dv.geom.ribbon().interpolate("cardinal").tension(0.6).data(l).set("fill","#cecece").set("alpha",0.3).map("yMax","upper").map("yMin","lower"),dv.geom.line().map("stroke","series",dv.scale.ordinal().values(h.color)),dv.geom.line().interpolate("cardinal").tension(0.6).data(l).map("stroke","series",dv.scale.ordinal().values(["#808080"])).set("linetype","dashed"),dv.geom.vline().data(l).map("x","predictiveStart").set("stroke","#afafaf").set("linetype","dashed").set("alpha",0.6)]);
n._drawLarge(p)
}if(!p){k.duration(0)
}else{k.duration(1000)
}k.render()
};
n._drawMini=function(p){k.padding({left:10,top:5,right:10,bottom:10}).map("fill","series").guide("fill",dv.guide.legend().orientation("top").labels(g).padding({top:10,bottom:10}).hGap(10).vGap(0)).guide(["x","y"],"none")
};
n._drawLarge=function(p){var r=Math.max(m.clientWidth/200,2),q=Math.max(0,Math.min(5,m.clientHeight/75));
k.height(m.clientHeight-45).guide("y","none").guide("x",dv.guide.axis().ticks(r).tickFormat(n._xTickFormat).tickPadding(12).orientation("top"))
};
n._xTickFormat=function(r,p){var q;
if(p===0||o.getMonth()!=r.getMonth()){q=dvCoral.format.monthLabelFormat(r)
}else{if(o.getDate()!=r.getDate()){q=dvCoral.format.dayLabelFormat(r)
}else{if(o.getHours()!=r.getHours()){q=dvCoral.format.hourLabelFormat(r)
}}}o=r;
return q
};
n._yTickFormat=function(q,p){if(!q){return""
}return"$"+d3.format("s")(q,p)
};
n._computeXExtent=function(r){var p=-1,t=r.x.length,q={x:[undefined,undefined],y:[0,0]};
while(++p<t){var s=r.x[p];
if(q.x[0]===undefined||s<q.x[0]){q.x[0]=s
}if(q.x[1]===undefined||s>q.x[1]){q.x[1]=s
}}return q
};
n._resizeHandler=function(){n._draw(false)
};
n.legendLabels=function(p){if(!arguments.length){return g
}g=p;
return n
};
n.parent=function(p){if(!arguments.length){return m
}k.parent(p);
m=k.parent();
f=d3.select(m);
return n
};
n.actualData=function(p){if(!arguments.length){return h
}h=p;
d=n._computeXExtent(h);
return n
};
n.predictiveData=function(p){if(!arguments.length){return l
}l=p;
return this
};
n.chart=function(){return k
};
n.ratio=function(p){if(!arguments.length){return j
}j=p;
return n
};
return n
};
$(document).fipo("tap","click",".mac-dv-predictiveSeries .legend",function(a){var b=$(a.currentTarget);
var h=b.closest(".mac-dv-predictiveSeries");
var g=h.data("mac-dv-chart");
var j=g.wrapper;
var f=g.self;
var d=b.data("metric");
if(!b.hasClass("off")&&$(".legend.off",h).length>0){$(".legend",h).removeClass("off");
j.actualData(f.generateActualData("all")).predictiveData(f.generatePredictiveData(false))
}else{$(".legend",h).addClass("off");
b.removeClass("off");
j.actualData(f.generateActualData(d)).predictiveData(f.generatePredictiveData(true,d))
}j.render(true)
});
tartan.dv.types.predictiveSeries={convert:function(f){if(f.data||f.data=="random"){return{data:[],legend:{labels:["Revenue","Social Mentions","Site Traffic",""]}}
}var d;
if(f.x){d=f
}else{d={x:[],y:[]};
var b=f.data,h=f.filters,g=f.metrics[0].filter_ref;
for(var a=0;
a<Math.min(5,g.length);
a++){d.x[a]=h[a].info?h[a].info.name:""+a;
d.y[a]=Math.floor(b[a][0][0].val)
}}if(!d.legend){d.legend={labels:["Desktop sites","Google ads","Facebook","Mobile sites","Bing ads","Twitter","Yahoo ads"],values:["183,415","131,357","101,159","183,415","131,357","101,159","183,415"]}
}return d
},create:function(b,d,a){var f=dvCoral.predictiveSeries().actualData(this.generateActualData("all")).predictiveData(this.generatePredictiveData(false)).parent(d[0]);
d.data("mac-dv-chart",{self:this,wrapper:f});
return f
},generateActualData:function(a){var b=this.getDateTuple(29);
if(a==="all"){b=b.concat(b,b);
return{x:b,y:[18900,17700,20300,18000,20300,21500,25500,17850,17700,20400,22300,21600,25500,25800,29800,34500,38000,39000,42000,43500,45000,48000,53500,48000,47500,51250,54500,54500,53000,17750,18000,18400,18900,20300,17700,17850,18300,21500,20400,21600,25500,22300,21400,32800,35000,34500,33500,36750,38000,39000,42500,43000,40500,42500,44000,41000,38000,37500,17750,18000,18400,18900,20300,17700,17850,18300,21500,20400,21600,25500,22300,18900,35300,37500,37000,37500,32000,33000,36750,37900,38500,40000,41500,43250,44000,42250,40000],series:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3,3],color:["#82BE50","#465A9B","#DC2D5F","#808080"]}
}else{if(a==="Revenue"){return{x:b,y:[18900,17700,20300,18000,20300,21500,25500,17850,17700,20400,22300,21600,25500,25800,29800,34500,38000,39000,42000,43500,45000,48000,53500,48000,47500,51250,54500,54500,53000],series:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],color:["#82BE50"]}
}else{if(a==="Social"){return{x:b,y:[17750,18000,18400,18900,20300,17700,17850,18300,21500,20400,21600,25500,22300,21400,32800,35000,34500,33500,36750,38000,39000,42500,43000,40500,42500,44000,41000,38000,37500],series:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],color:["#465A9B"]}
}else{if(a==="Traffic"){return{x:b,y:[17750,18000,18400,18900,20300,17700,17850,18300,21500,20400,21600,25500,22300,18900,35300,37500,37000,37500,32000,33000,36750,37900,38500,40000,41500,43250,44000,42250,40000],series:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1],color:["#DC2D5F"]}
}}}}},generatePredictiveData:function(f,a){if(f){var g={x:this.getDateTuple(16),y:[],upper:[],lower:[],predictiveStart:[new Date().setDate(new Date().getDate()-16)],series:[4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4,4]};
if(a==="Revenue"){g.y=[25800,24500,23000,19000,20800,21100,20900,20900,20800,20900,20900,20800,21200,21100,20850,21400]
}else{if(a==="Social"){g.y=[21400,21350,21300,21350,21900,20200,20900,20900,20800,20900,20900,21100,20850,20800,21200,21400]
}else{if(a==="Traffic"){g.y=[18900,21350,23050,25000,24500,24000,21200,21400,20900,20900,20800,21100,20850,20800,21200,21400]
}}}for(var b=0;
b<g.y.length;
b++){g.upper[b]=g.y[b]+(b*350);
g.lower[b]=g.y[b]-(b*350)
}return g
}else{return this.generateNullCase(new Date().setDate(new Date().getDate()-16),21400)
}},generateNullCase:function(a,f){var d={x:[],y:[],upper:[],lower:[],predictiveStart:[a],series:[]};
for(var b=0;
b<16;
b++){d.x.push(a);
d.y.push(f);
d.upper.push(f);
d.lower.push(f);
d.series.push(4)
}return d
},getDateTuple:function(b){var f=-1,a=[],g=new Date();
while(++f<b){var d=new Date(g.getTime());
d.setDate(g.getDate()-(b-f));
a.push(d)
}return a
}};
tartan.dv.types.predictiveSeries_card={convert:tartan.dv.types.predictiveSeries.convert,getDateTuple:tartan.dv.types.predictiveSeries.getDateTuple,generateNullCase:tartan.dv.types.predictiveSeries.generateNullCase,generatePredictiveData:tartan.dv.types.predictiveSeries.generatePredictiveData,generateActualData:tartan.dv.types.predictiveSeries.generateActualData,create:function(b,d,a){var f=dvCoral.predictiveSeries().legendLabels(b.legend.labels).actualData(this.generateActualData("all")).predictiveData(this.generatePredictiveData(false)).ratio(1.3).parent(d[0]);
return f
}};
dvCoral.timeSeries=function(){var r={},f,o,k=dv.chart(),h,l=0,b,j,a=320,g=[],n=[],q,d=true,p=true,m={left:50,top:30,right:50,bottom:50};
r.render=function(s){r._draw(s);
return r
};
r._draw=function(s){q=null;
k.data(h).width(undefined).height(undefined).map("x","x",dv.scale.time()).map("y","y",dv.scale.linear().lowerLimit(0)).padding(m);
if(h.color){k.map("stroke","series",dv.scale.ordinal().values(h.color))
}else{k.map("stroke","series")
}if(l>0){k.width(o.clientWidth).height(o.clientWidth*l)
}if(o.clientWidth<a){r._drawMini(s)
}else{r._drawLarge(s)
}if(!s){k.duration(0)
}else{k.duration(1000)
}k.render()
};
r._drawMini=function(s){k.layers([dv.geom.line().behaviors([]),dv.geom.point().data(j).map("fill","series").set("stroke","none").set("size",5),dv.geom.text().data(j).map("fill","series").set("stroke","none").set("label",function(u,t){return(Math.round(u.y*100))+"%"
}).textAnchor("middle").dy(function(u,t){return u.y===j.y[1]?-10:15
}),dv.geom.text().data(b).set("label",function(u,t){return dvCoral.format.miniFullDate(u.x)
}).set("fill","#b9b9b9").set("stroke","none").set("size","8pt").textAnchor("middle").dy(30)]).guide("x","none").guide("y",dv.guide.axis().ticks(3).tickFormat(function(){return""
}));
if(d){k.guide("stroke",dv.guide.legend().orientation("top").labels(g).padding({left:0,bottom:40}).vGap(5))
}};
r._drawLarge=function(s){var u=Math.max(o.clientWidth/170,2),t=Math.max(0,Math.min(5,o.clientHeight/75));
k.layers([dv.geom.line()]);
if(p){k.guide("x",dv.guide.axis().ticks(u).tickFormat(r._xTickFormat).tickPadding(12).orientation("top"))
}else{k.guide("x",dv.guide.axis().ticks(u).tickFormat(function(){return""
}).tickPadding(12).orientation("top"))
}if(d){k.guide("stroke",dv.guide.legend().orientation("top").labels(g).values(n).padding({bottom:20}).hGap(30)).guide("y",dv.guide.axis().ticks(t).tickPadding(12).orientation("right").tickFormat(r._yTickFormat))
}else{k.guide("y",dv.guide.axis().ticks(t).tickPadding(12).orientation("right").tickFormat(function(w,v){return w*100+"%"
}))
}};
r._xTickFormat=function(u,s){var t;
if(s===0||q.getMonth()!=u.getMonth()){t=dvCoral.format.monthLabelFormat(u)
}else{if(q.getDate()!=u.getDate()){t=dvCoral.format.dayLabelFormat(u)
}else{if(q.getHours()!=u.getHours()){t=dvCoral.format.hourLabelFormat(u)
}}}q=u;
return t
};
r._yTickFormat=function(t,s){if(!t){return""
}return d3.format("s")(t,s)
};
r._computeYExtent=function(v){var s=-1,w=v.y.length,u={x:[undefined,undefined],y:[undefined,undefined],series:[undefined,undefined]};
while(++s<w){var t=v.y[s];
if(u.y[0]===undefined||t<u.y[0]){u.y[0]=t;
u.x[0]=v.x[s];
u.series[0]=v.series[s]
}if(u.y[1]===undefined||t>u.y[1]){u.y[1]=t;
u.x[1]=v.x[s];
u.series[1]=v.series[s]
}}return u
};
r._computeXExtent=function(u){var s=-1,w=u.x.length,t={x:[undefined,undefined],y:[0,0]};
while(++s<w){var v=u.x[s];
if(t.x[0]===undefined||v<t.x[0]){t.x[0]=v
}if(t.x[1]===undefined||v>t.x[1]){t.x[1]=v
}}return t
};
r._resizeHandler=function(){r._draw(false)
};
r.showLegends=function(s){if(!arguments.length){return d
}d=s;
return r
};
r.showXAxis=function(s){if(!arguments.length){return p
}p=s;
return r
};
r.legendLabels=function(s){if(!arguments.length){return g
}g=s;
return r
};
r.legendValues=function(s){if(!arguments.length){return n
}n=s;
return r
};
r.padding=function(s){if(!arguments.length){return m
}m=s;
return r
};
r.parent=function(s){if(!arguments.length){return o
}k.parent(s);
o=k.parent();
f=d3.select(o);
return r
};
r.data=function(s){if(!arguments.length){return h
}if(h!=s){h=s;
b=r._computeXExtent(s);
j=r._computeYExtent(s)
}return r
};
r.chart=function(){return k
};
r.ratio=function(s){if(!arguments.length){return l
}l=s;
return r
};
return r
};
tartan.dv.types.timeSeries={convert:function(f){if(f.data||f.data=="random"){return this.generateData(f.product)
}var d;
if(f.x){d=f
}else{d={x:[],y:[]};
var b=f.data,h=f.filters,g=f.metrics[0].filter_ref;
for(var a=0;
a<Math.min(5,g.length);
a++){d.x[a]=h[a].info?h[a].info.name:""+a;
d.y[a]=Math.floor(b[a][0][0].val)
}}if(!d.legend){d.legend={labels:["Desktop sites","Google ads","Facebook","Mobile sites","Bing ads","Twitter","Yahoo ads"],values:["183,415","131,357","101,159","183,415","131,357","101,159","183,415"]}
}return d
},create:function(b,d,a){var f=dvCoral.timeSeries().showLegends(false).showXAxis(b.options.showXAxis).data(b).parent(d[0]).padding(b.options.padding);
d.data("mac-dv-chart",{self:this,wrapper:f,data:b});
return f
},filterData:function(d,b){var f=(b)*17,a=(b+1)*17;
return{x:d.x.slice(f,a),y:d.y.slice(f,a),series:d.series.slice(f,a),color:[(b===0)?"#82BE50":"#465A9B"]}
},generateData:function(b){var f={x:[new Date(2012,10,1),new Date(2012,10,2),new Date(2012,10,3),new Date(2012,10,4),new Date(2012,10,5),new Date(2012,10,6),new Date(2012,10,7),new Date(2012,10,8),new Date(2012,10,9),new Date(2012,10,10),new Date(2012,10,11),new Date(2012,10,12),new Date(2012,10,13),new Date(2012,10,14),new Date(2012,10,15),new Date(2012,10,16),new Date(2012,10,17),new Date(2012,10,1),new Date(2012,10,2),new Date(2012,10,3),new Date(2012,10,4),new Date(2012,10,5),new Date(2012,10,6),new Date(2012,10,7),new Date(2012,10,8),new Date(2012,10,9),new Date(2012,10,10),new Date(2012,10,11),new Date(2012,10,12),new Date(2012,10,13),new Date(2012,10,14),new Date(2012,10,15),new Date(2012,10,16),new Date(2012,10,17)],y:[0.17,0.17,0.09,0,0.17,0.78,0,0.26,0.17,0.17,0.09,0.52,0.26,0.17,0.52,0.09,0.35,0.35,0.67,0.35,0.13,0.46,0.78,0.02,0.24,0.67,0.35,1,0.24,0.35,0.5,0.32,0.14,0.09,0.68,0.68,0.59,0.36,0.5,0.41,0.14,0.64,0.45,0.55,0.77,0.68,0.36,0.45,0.59,0.64,0,1,0.59,0.68,0.18,0.45,0.64,0.68,0.23,0.5],series:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],options:{showXAxis:false,padding:{top:20,left:40,right:10,bottom:15}}};
var d={x:[new Date(2012,10,1),new Date(2012,10,2),new Date(2012,10,3),new Date(2012,10,4),new Date(2012,10,5),new Date(2012,10,6),new Date(2012,10,7),new Date(2012,10,8),new Date(2012,10,9),new Date(2012,10,10),new Date(2012,10,11),new Date(2012,10,12),new Date(2012,10,13),new Date(2012,10,14),new Date(2012,10,15),new Date(2012,10,16),new Date(2012,10,17),new Date(2012,10,1),new Date(2012,10,2),new Date(2012,10,3),new Date(2012,10,4),new Date(2012,10,5),new Date(2012,10,6),new Date(2012,10,7),new Date(2012,10,8),new Date(2012,10,9),new Date(2012,10,10),new Date(2012,10,11),new Date(2012,10,12),new Date(2012,10,13),new Date(2012,10,14),new Date(2012,10,15),new Date(2012,10,16),new Date(2012,10,17)],y:[0.67,0.92,0.17,0.42,0.5,0.42,1,0.42,0.5,0,0.08,0.58,0.33,0.58,0.33,0.17,0.25,0.08,0.17,0.33,0.5,0.83,0.08,0.08,0,0.83,0.58,0.5,0.33,0.5,0.7,0.7,0.03,0.63,0.9,0.57,0.9,0.37,0.67,0.33,0.4,0.73,0.63,0.4,0.57,0.47,0.17,0,0.33,1,0.8,0.67,0.37,0.2,0.2,0.77,0.73,0.8,0.77,0.57],series:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],options:{showXAxis:false,padding:{top:20,left:40,right:10,bottom:15}}};
var a={x:[new Date(2012,10,1),new Date(2012,10,2),new Date(2012,10,3),new Date(2012,10,4),new Date(2012,10,5),new Date(2012,10,6),new Date(2012,10,7),new Date(2012,10,8),new Date(2012,10,9),new Date(2012,10,10),new Date(2012,10,11),new Date(2012,10,12),new Date(2012,10,13),new Date(2012,10,14),new Date(2012,10,15),new Date(2012,10,16),new Date(2012,10,17),new Date(2012,10,1),new Date(2012,10,2),new Date(2012,10,3),new Date(2012,10,4),new Date(2012,10,5),new Date(2012,10,6),new Date(2012,10,7),new Date(2012,10,8),new Date(2012,10,9),new Date(2012,10,10),new Date(2012,10,11),new Date(2012,10,12),new Date(2012,10,13),new Date(2012,10,14),new Date(2012,10,15),new Date(2012,10,16),new Date(2012,10,17)],y:[1,0.5,0,0.13,0.5,0.38,0.25,0,0.5,0.13,0.5,1,0.13,0.38,0.25,0.38,0,1,0.59,0.28,0.25,0.53,0.75,0.72,0.28,0.66,0.13,0.22,0.81,0.5,0.25,0.72,0.63,0.38],series:[1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2],options:{showXAxis:true,padding:{top:20,left:40,right:10,bottom:25}}};
return[f,d,a][b]
}};
tartan.dv.types.timeSeries_card={convert:tartan.dv.types.timeSeries.convert,generateData:tartan.dv.types.timeSeries.generateData,create:function(b,d,a){var f=dvCoral.timeSeries().showLegends(false).showXAxis(true).data(b).ratio(0.5).parent(d[0]).padding({top:30,left:32,right:30,bottom:30});
d.data("mac-dv-chart",{self:this,wrapper:f,data:b});
return f
}};
tartan.dv.types.anomaly={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,width:550,height:350,bins:12,xTicks:d3.time.days,xTickInterval:1,normalizePositive:false},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.anomaly(a)
}};
tartan.dv.types.anomaly_card={create:function(d,f,b){var a=$.extend(true,{parent:f[0],data:d,width:550,height:300,bins:12,xTicks:d3.time.days,xTickInterval:1,normalizePositive:false},tartan.dv.types.normalize(b.chartOpts));
return new cloudViz.anomaly(a)
}};
tartan.dv.types.abntest={convert:function(a){if(a.data=="random"){return this.generateData()
}return a.data||a
},create:function(b,d,a){return new TestChart({transitionTime:700,size:"large",el:d[0],data:b})
},generateData:function(){return{campaignName:"Test - Homepage - A,B..N Campaign",campaignType:"testNOffers",campaignParentURI:"",startDate:"1969-12-31T16:00:00.000-08:00",endDate:"2100-01-01T02:00:00.000-08:00",status:"approved",deepLink:"",winner:{winningExperience:"Recipe B",metricName:"Conversion Rate",metricValue:0,lift:null,confidence:0.65},reportFilter:{campaignId:7,thirdPartyId:"testId",countingMethod:"visitor",successMetric:"Default",step:"Conversion",segmentFilter:"fromFirefox",weekPartFilter:"anyday",extremeOrders:"include",dateRange:"Last two months",controlRecipe:"Recipe A",environment:"Production"},campaignTotals:{metricCount:3,conversionRate:0.25,aov:"$0.00",rpm:"$0.00",sales:"$0.00"},experiences:[{name:"Recipe A",isControl:true,metricCount:1,metricRate:0.3333333333333333,conversionRate:0,conversions:0,engagement:0,lift:0.55,confidence:null,aov:"$0.00",rpm:"$0.00",sales:"$0.00"},{name:"Recipe B",isControl:false,metricCount:2,metricRate:0.6666666666666666,conversionRate:0,conversions:0,engagement:0,lift:0.25,confidence:null,aov:"$0.00",rpm:"$0.00",sales:"$0.00"},{name:"Experience C",isControl:false,metricCount:0,metricRate:0,conversionRate:0,conversions:0,engagement:0,lift:-0.11,confidence:null,aov:"$0.00",rpm:"$0.00",sales:"$0.00"}]}
}};
tartan.dv.types.abntest_card={convert:tartan.dv.types.abntest.convert,generateData:tartan.dv.types.abntest.generateData,create:function(b,d,a){return new TestChart({transitionTime:0,size:"small",el:d[0],data:b})
}};
$(function(){$("#orgs").on("click",".unlinkLink",function(p){m($(this).closest("article").find("div.opsDiv"));
$(this).closest("article").find("div.mainDiv").animate({marginLeft:"-=240px"},1000)
});
$("#orgs").on("click",".addAccessLink",function(p){$(p.target).closest("article.card-board").children(".reqStatus").addClass("hidden");
m($(this).closest("article").find("div.opsDiv"));
$(this).closest("article").find("div.mainDiv").animate({marginLeft:"-=240px"},1000)
});
$("#orgs").on("click","a.requestLink",function(p){$(this).closest("article").find("div.opsDiv").animate({marginLeft:"-=240px"},1000)
});
$("#orgs").on("click","#addOrg",function(r){$("#orgSelect > .dropdown-container").find("span").text(CQ.I18n.get("Adobe Marketing Cloud Suite Products",null,null));
var p=$("#orgSelect").closest(".addOrgs").children(".orgForm").children("form");
p.children(".formField").val("").addClass("hidden");
$("#addOrgModal").children(".footerDiv").addClass("hidden");
p.addClass("hidden");
m("#addOrgModal");
var q=new CUI.Modal({element:"#addOrgModal"})
});
$("#orgSelectControl").on("change",function(u){var q=$(u.target).closest(".addOrgs").children(".orgForm").children(".orgFormLink");
var v=$(u.target).find(":selected").attr("data-company-required");
var p=$(u.target).find(":selected").attr("data-is-scene7");
var t=$(u.target).find(":selected").attr("data-is-default");
var s=$(u.target).find(":selected").attr("data-product");
var r=$(u.target).find(":selected").attr("data-product-name");
q.removeClass("hidden");
q.children(".usernameField").removeClass("hidden");
q.children(".passwordField").removeClass("hidden");
q.find(".formField input").val("");
$("button.orgCancelButton").removeAttr("disabled");
$("button.orgLinkButton").removeAttr("disabled");
$("#addOrgModal").children(".footerDiv").removeClass("hidden");
m($("#addOrgModal"));
$(".addOrgs > .orgWell").attr("data-product",s);
$(".addOrgs > .orgWell").attr("data-product-name",r);
if(v=="true"){q.children(".companyField").val("").removeClass("hidden");
q.children(".companyField").children("input").removeAttr("disabled")
}else{q.children(".companyField").addClass("hidden");
q.children(".companyField").children("input").attr("disabled","disabled")
}if(p=="true"){q.children(".regionField").removeClass("hidden");
q.children(".regionField").children("select").removeAttr("disabled")
}else{q.children(".regionField").addClass("hidden");
q.children(".regionField").children("select").attr("disabled","disabled")
}});
$("#orgs").on("click","button.cancelButton",function(p){if(!$(p.target).closest(".footerDiv").children("button.requestButton").length){$(this).closest("article").find("div.mainDiv").animate({marginLeft:"+=240px"},1000)
}else{$(this).closest("article").find("div.opsDiv").animate({marginLeft:"+=240px"},1000)
}});
$("#orgs").on("click","button.requestButton",function(t){$(this).closest("article").find("div.opsDiv").animate({marginLeft:"+=240px"},0);
$(this).closest("article").find("div.mainDiv").animate({marginLeft:"+=240px"},0);
var p=$("#orgs").children("nav").children("a.active").attr("data-tenant-id");
var r="mac-"+p+"-administrators";
var w=$(t.target).closest(".requestDiv").attr("data-product-name");
var s=$(t.target).attr("data-user-id");
var v=$(t.target).attr("data-user-name");
var u=$(t.target).closest(".requestDiv").attr("data-service-code");
var z=$(t.target).closest(".requestDiv").attr("data-company-name");
var q={notif_type:"request_access",userId:s,userName:v,serviceCode:u,productName:w,companyName:z,to:{imsTenantId:p,imsUserId:"mac-"+p+"-administrators"}};
$.ajax({type:"post",url:"/content/mac/default/services/ims/notification",dataType:"json",contentType:"application/json",data:JSON.stringify(q),success:tartan.core.createAjaxSuccess(function(A){$(t.target).closest("article.card-board").children(".reqStatus").removeClass("hidden")
}),error:tartan.core.createAjaxSuccess(function(A){b("alert","error",CQ.I18n.get("Error Sending Request.",null,null))
})})
});
$("#orgs").on("click","button.unLinkButton",function(q){$(q.target).closest("article").find("div.waitContainer").removeClass("hidden");
$(q.target).closest(".opsDiv").find("button.cancelButton").attr("disabled","disabled");
$(q.target).closest(".opsDiv").find("button.unLinkButton").attr("disabled","disabled");
$.ajax({type:"post",url:$(".frmUnlink").attr("action")+"/jcr:content."+$(q.target).closest("article").attr("data-product-name")+".unlink.json",dataType:"json",data:{orgId:$(q.target).closest("article").attr("data-org-id"),companyName:$(q.target).closest("article").attr("data-company")},success:tartan.core.createAjaxSuccess(function(t){var s=$(q.target).closest("article").attr("data-product");
var r=$(q.target).closest("article").attr("data-company");
if(t.success){p(null,s,r)
}else{p(t.error,s,r)
}}),error:tartan.core.createAjaxError(p)});
function p(s,t,r){$(q.target).closest("article").find("div.waitContainer").addClass("hidden");
$(q.target).closest(".opsDiv").find("button.cancelButton").removeAttr("disabled");
$(q.target).closest(".opsDiv").find("button.unLinkButton").removeAttr("disabled");
$(q.target).closest(".opsDiv").find("button.cancelButton").click();
if(s){b("alert","error",s)
}else{b("alert","success",CQ.I18n.get("Your {0} account for {1} was successfully unlinked.",["<b>"+t+"</b>","<b>"+r+"</b>"],null))
}k($("#orgs nav > a.active"))
}});
$("#orgs").on("click","button.linkButton",function(r){var q=$(r.target).closest("article").find(".opsDiv");
$(r.target).closest("article.card-board").children(".reqStatus").addClass("hidden");
$(r.target).closest("article").find("div.waitAddContainer").removeClass("hidden");
$(r.target).closest(".opsDiv").find("button.cancelButton").attr("disabled","disabled");
$(r.target).closest(".opsDiv").find("button.linkButton").attr("disabled","disabled");
m($(r.target).closest(".opsDiv"));
var p=new tartan.core.AccountLinking($(r.target).closest(".opsDiv").children(".formDiv").children("form"),$(r.target).closest("article").find(".waitAddContainer"));
p.link(function(s){if(s.success==true){b("alert","success",CQ.I18n.get("You have successfully linked an {0} account associated with the organization {1}.",["<b>"+p.productName+"</b>","<b>"+p.companies+"</b>"],null));
$("#user_popover").data("stale",true);
$(r.target).closest(".opsDiv").find("button.cancelButton").removeAttr("disabled");
$(r.target).closest(".opsDiv").find("button.linkButton").removeAttr("disabled");
if($("#orgs").attr("data-forward-on-link")){setTimeout(function(){document.location=$("#orgs").attr("data-forward-on-link")
},4000)
}k($("#orgs nav > a.active"))
}else{n(q,"ERROR","cardStatusError",s.error)
}})
});
$("#orgs").on("click","input.checkDefaultOrg",function(q){var p=$(q.target).attr("data-tenant-id");
if($(q.target).is(":checked")!=true){p=""
}$.ajax({type:"post",url:"/content/mac/default/tools/profilehelper.json",dataType:"json",data:{action:"setDefaultTenant",defaultTenant:p},success:tartan.core.createAjaxSuccess(function(r){if(r.SUCCESS&&r.SUCCESS=="true"){if(p.length==0){b("alert","success",CQ.I18n.get("Default organization unset successfully."))
}else{b("alert","success",CQ.I18n.get("Default organization set successfully."))
}}else{b("alert","error",CQ.I18n.get("Default organization could not be set!"))
}}),error:tartan.core.createAjaxError(function(r){b("alert","error",CQ.I18n.get("Error setting Default organization."))
})})
});
$("#orgs").on("click","#landingPageDDL li",function(q){var r=$(q.target).closest("#landingPageDDL").find(":selected").attr("value");
var p=$("#orgs nav > a.active").attr("data-org-id");
$.ajax({type:"post",url:"/content/mac/default/tools/profilehelper.json",dataType:"json",data:{action:"setDefaultLandingPage",defaultLandingPage:r,orgId:p},success:tartan.core.createAjaxSuccess(function(s){if(s.SUCCESS&&s.SUCCESS=="true"){b("alert","success",CQ.I18n.get("Default Landing Page set successfully."))
}else{b("alert","error",CQ.I18n.get("Default Landing Page could not be set!"))
}}),error:tartan.core.createAjaxError(function(s){b("alert","error",CQ.I18n.get("Error setting Default Landing Page."))
})})
});
$(document).on("click",".notificationAccountButton",function(p){window.location=$(p.target).attr("data-profile-path")
});
var h=0;
var d=-1;
var o=0;
$(document).ready(function(){k($("#orgs nav > a"));
if($("#orgs nav").length){var p=Math.ceil($("#orgs").outerWidth()/200)-2;
p=p<1?1:p;
$("#orgs nav > a").each(function(q){p--;
if(p<0){$(this).addClass("hidden")
}else{d++
}o++
});
if(p>=0){$("div#navleft").addClass("hidden");
$("div#navright").addClass("hidden")
}if("true"==($("#orgs").attr("data-show-neworg"))){$("#addOrg").click()
}}});
$("#orgs").on("click","div#navright",function(p){h++;
d++;
if(d>=o){h--;
d--;
return false
}f()
});
$("#orgs").on("click","div#navleft",function(p){h--;
d--;
if(h<0){h++;
d++;
return false
}f()
});
function f(){var p=-1;
$("#orgs nav > a").each(function(q){p++;
if(p<h||p>d){$(this).addClass("hidden")
}else{$(this).removeClass("hidden")
}})
}$("#orgs").on("click","nav >a",function(p){g();
k($(p.target))
});
$("#orgs > div#statusMsg > button.close").click(function(p){g();
p.preventDefault()
});
$("button.orgCancelButton").on("click",function(p){$("#addOrgModal").children(".modal-header").children("button.close").click()
});
$("button.orgLinkButton").on("click",function(r){var q=$("#addOrgModal");
m(q);
isCompanyRequired=($("#orgSelectControl").children("option:selected").attr("data-company-required"));
isScene7=($("#orgSelectControl").children("option:selected").attr("data-is-scene7"));
if(isCompanyRequired!="true"){$(".addOrgs").find(".companyField").children("input").attr("disabled","disabled")
}if(isScene7!="true"){$(".addOrgs").find(".regionField").find("select[name='region']").attr("disabled","disabled")
}$(r.target).closest(".footerDiv").children("div.waitOrgContainer").removeClass("hidden");
$("button.orgCancelButton").attr("disabled","disabled");
$("button.orgLinkButton").attr("disabled","disabled");
var p=new tartan.core.AccountLinking($(".addOrgs").children(".orgForm").children("form"),$("#addOrgModal").children(".footerDiv").children(".waitAddContainer"));
p.link(function(u){if(u.success==true){b("alert","success",CQ.I18n.get("You have successfully linked an {0} account associated with the organization {1}.",["<b>"+p.productName+"</b>","<b>"+p.companies+"</b>"],null));
$("#user_popover").data("stale",true);
k($("#orgs nav > a.active"));
$("#addOrgModal").children(".modal-header").children("button.close").click();
var w=u.accounts;
if(w){for(i in w){var z=w[i];
var t=false;
$("#orgs nav > a").each(function(A){if($(this).attr("data-org-id")==z.orgId){t=true
}});
if(t){continue
}var v=$("#orgs").children("nav").children("a").first();
var s=v.clone(true);
$("#user_popover").data("stale",true);
s.attr("data-org-id",z.orgId);
s.removeClass("active");
s.text(z.company);
s.insertBefore("#orgs > nav > div#navright")
}}}else{n(q,"ERROR","cardStatusError",u.error)
}})
});
$(document).on("click","#notifications_popover button.denyButton",function(p){j(p,true)
});
$(document).on("click","#notifications_popover ul li span.table-column .icon.icon-close",function(q){var p=$("#notifications_popover");
var r=[];
r.push($(this).closest(".table-row").data("notification-id"));
$.ajax({type:"POST",url:"/content/mac/default/tools/notifications/items.mark.json",data:{notificationId:r},success:tartan.core.createAjaxSuccess(function(s){p.data("stale",true);
$("a.notifications-link").trigger("click")
}),error:tartan.core.createAjaxError(function(s){$(this).closest("li").html('<div class="alert error"><strong></strong>'+CQ.I18n.get("Some error has occurred. Please try again after some time or contact Administrator.")+"</div>")
})})
});
$(document).on("click","#notifications_popover button.approveButton",function(w){var p=$(w.target).attr("data-tenant-id");
var s=$(w.target).attr("data-product-name");
var u=$(w.target).attr("data-user-name");
var r=$(w.target).attr("data-user-id");
var v=$(w.target).attr("data-service-code");
var t=$(w.target).attr("data-company-name");
var q={type:"approve",imsTenantId:p,userId:r,serviceCode:v,productName:s,companyName:t};
$.ajax({type:"post",url:"/content/mac/default/services/requestaccess.json",data:JSON.stringify(q),contentType:"application/json",success:tartan.core.createAjaxSuccess(function(z){j(w,false)
}),error:tartan.core.createAjaxError(function(z){$(w.target).closest("li").html('<div class="alert error"><strong></strong>'+CQ.I18n.get("Some error has occurred while processing approval. Please try again after some time or contact Administrator.")+"</div>")
})})
});
function j(w,q){var p=$(w.target).attr("data-tenant-id");
var t=$(w.target).attr("data-product-name");
var u=$(w.target).attr("data-user-name");
var s=$(w.target).attr("data-user-id");
var v=$(w.target).attr("data-service-code");
var r={notif_type:"request_access",request_access_type:"markRead",imsTenantId:p,title:"Request Access for "+t+"("+v+") for "+u+"("+s+")",userId:s,serviceCode:v,approved:!q};
$.ajax({type:"post",url:"/content/mac/default/services/ims/notification",dataType:"json",contentType:"application/json",data:JSON.stringify(r),success:tartan.core.createAjaxSuccess(function(z){if(q){$(w.target).closest("li").html('<div class="alert error"><strong></strong>'+CQ.I18n.get("Request for user {0} for product {1} is denied!",["<b>"+u+"</b>","<b>"+t+"</b>"],null)+"</div>")
}else{$(w.target).closest("li").html('<div class="alert success"><strong></strong>'+CQ.I18n.get("{0} has been added to the default group for {1}.",["<b>"+u+"</b>","<b>"+t+"</b>"],null)+"</div>")
}}),error:(function(z){$(w.target).closest("li").html('<div class="alert error"><strong></strong>'+CQ.I18n.get("Some error has occurred while processing approval. Please try again after some time or contact Administrator.")+"</div>")
})})
}function k(p){if(p.length){$("div.waitOrgContainer").removeClass("hidden");
$("section.true").html("");
$.ajax({type:"get",url:p.attr("data-path")+".cards.html?orgId="+p.attr("data-org-id")+"&isInvite="+p.attr("data-is-invite")+"&ck="+(new Date()).getTime(),success:tartan.core.createAjaxSuccess(function(q){$('section[id="'+p.attr("aria-controls")+'"].true').html(q);
$("div.waitOrgContainer").addClass("hidden");
if(String(q).indexOf("article")<0){b("alert","notice",CQ.I18n.get("No products found for org {0}.",p.text(),null))
}}),error:tartan.core.createAjaxError(function(q){b("alert","error",CQ.I18n.get("Error listing products for this Organization.",null,null));
$("div.waitOrgContainer").addClass("hidden")
})})
}}function l(p){$(p.target).closest(".opsDiv").children(".requestDiv").toggleClass("hidden");
$(p.target).closest(".opsDiv").children(".formDiv").toggleClass("hidden");
$(p.target).closest(".opsDiv").find("button.linkButton").toggleClass("hidden");
$(p.target).closest(".opsDiv").find("button.requestButton").toggleClass("hidden")
}function g(){$("#orgs > div#statusMsg").removeClass();
$("#orgs > div#statusMsg").children("div").text("");
$("#orgs > div#statusMsg").addClass("hidden")
}function b(q,p,r){$("#orgs > div#statusMsg").removeClass("hidden").addClass(q).addClass(p).children("div").html(r)
}function n(q,u,p,v){var t=$(q).children(".headerDiv");
var r=$(q).children(".cardStatus");
var s=$(q).children(".footerDiv");
t.addClass("hidden");
r.removeClass("hidden").addClass(p).children("div.cardStatusMsg").html("<b>"+u+"</b> "+v);
s.children("button").removeAttr("disabled")
}function m(p){var r=$(p).children(".headerDiv");
var q=$(p).children(".cardStatus");
r.removeClass("hidden");
q.addClass("hidden")
}function a(u){var r={token:$.cookie("token"),ims:"1",resource:location.pathname};
var A={};
var p=u.indexOf("?");
if(p!=-1){var s=u.substr(p+1).split("&");
for(var w=0;
w<s.length;
w++){var t=s[w].split("=");
A[t[0]]=decodeURIComponent(t[1].replace("+","%20"))
}u=u.substr(0,p)
}var v=$.extend({},r,A);
var q=$("<form>",{action:u.replace(/\/content\/mac.*/,"/libs/granite/core/content/login.html"),method:"post"});
for(var z in v){q.append($("<input>",{type:"hidden",name:z,value:v[z]}))
}q.appendTo("body");
q.submit()
}$(".login-form").filter(":visible").find("input").filter(function(){return $(this).val()==""
}).first().focus()
});
tartan=tartan||{};
tartan.core=tartan.core||{};
tartan.core.AccountLinking=function(b,a){this.$form=$(b);
this.$well=this.$form.closest(".orgWell");
this.$wait=$(a);
this.product=this.$well.attr("data-product");
this.productName=this.$well.attr("data-product-name");
this.data=this.$form.serializeArray()
};
tartan.core.AccountLinking.prototype.link=function(a){this.resultHandler=a;
var b=this;
this.login()
};
tartan.core.AccountLinking.prototype.start=function(){var a=this;
this.login()
};
tartan.core.AccountLinking.prototype.login=function(){var a=this;
$.ajax({url:a.$form.attr("action")+"/jcr:content."+a.product+".login.json",type:"post",data:a.data,dataType:"json",beforeSend:function(){tartan.core.removeMessages();
a.$well.find(":input").attr("disabled",true);
a.$wait.css("display","inline")
},success:(function(b){a.data.push({name:"loginResult",value:b.loginResult});
if(b.success){a.doLink()
}else{if(b.messages){a.error(null,null,b.messages["0"].content)
}else{a.error(null,null,b.error)
}}}),error:tartan.core.createAjaxError(_.bind(a.error,a))})
};
tartan.core.AccountLinking.prototype.doLink=function(){var a=this;
$.ajax({url:a.$form.attr("action")+"/jcr:content."+a.product+".link.json",type:"post",data:a.data,dataType:"json",success:(function(b){if(!_.isEmpty(b.accounts)){a.companies=b.accounts.map(function(d){return d.company
}).join(", ")
}a.result=b;
if(b.success){a.success()
}else{if(b.messages){a.error(null,null,b.messages["0"].content)
}else{a.error(null,null,b.error)
}}}),error:tartan.core.createAjaxError(_.bind(a.error,a))})
};
tartan.core.AccountLinking.prototype.relogin=function(){var a=this;
$.ajax({url:"/libs/granite/core/content/login.html?p="+new Date().getTime()+"&ims=1",type:"get",headers:{Authorization:"Bearer "+$.cookie("token")},success:function(b){if(b.redirect){tenantRedirect(b.redirect)
}else{a.success()
}},error:function(){tartan.core.addErrorMessage(Granite.I18n.get("Error while re-log in to Marketing Cloud."));
a.error(undefined,undefined,"Error while re-log in to Marketing Cloud.")
}})
};
tartan.core.AccountLinking.prototype.success=function(){var a=this;
this.resultHandler(a.result);
this.reset()
};
tartan.core.AccountLinking.prototype.error=function(g,a,b){var d=this;
var f={solution:d.productName};
if(b){f.error=b
}this.result={error:b};
this.resultHandler(d.result);
this.reset()
};
tartan.core.AccountLinking.prototype.reset=function(){this.$well.find(":input").removeAttr("disabled");
this.$wait.hide()
};
tartan.core.AccountLinking.prototype.getResult=function(){return this.result
};
$(function(){$("#linkAccountModal .close").on("click",function(d){$(d.target).closest(".modal").find(".questionLink").addClass("hidden");
$(d.target).closest(".modal").find(".modal-header").addClass("hidden");
$(d.target).closest(".modal").hide()
});
$("#linkAccountModal .noButton").on("click",function(h){var f=$(h.target).closest(".modal").attr("data-ims-org-id");
var g=$(h.target).closest(".modal").attr("data-product-id");
var d=$(h.target).closest(".modal").attr("data-launch-url");
$.ajax({url:"/content/mac/default/tools/accountslinking/jcr:content."+g+".setLinkInfoAction.json?orgId="+f+"&actionName=DoNotShowMessage&actionValue=true",type:"post",dataType:"json",success:(function(j){window.location=d
}),error:(function(j){window.location=d
})})
});
$("#linkAccountModal .cancelButton").on("click",function(f){var d=$(f.target).closest(".modal").attr("data-launch-url");
if(d){window.location=d
}});
$("#linkAccountModal .yesButton").on("click",function(f){var d=$(f.target).closest(".modal").attr("data-solution");
window.location="/content/mac/default/linkhelper."+d+".html"
});
$(".launchSolution").on("click",function(k){var f=$(k.target).attr("data-ims-org-id");
var g=$(k.target).attr("data-product-id");
var n=$(k.target).attr("data-product-name");
var o=$(k.target).attr("data-company-name");
var j=$(k.target).attr("data-solution-location");
var l=$(k.target).attr("data-solution");
var d=$(k.target).attr("data-always-show");
var h=$("#linkAccountModal");
if(d&&d=="true"){m()
}else{if(f&&f.length>0&&g&&g.length>0){$.ajax({url:"/content/mac/default/tools/accountslinking/jcr:content."+g+".getLink.json?orgId="+f+"&companyName="+o+"&fromPorfile=true",type:"post",dataType:"json",timeout:2000,success:(function(p){if(p.username&&!(p.username=="EmptyServiceCode")){h.hide();
window.location=j
}else{m()
}}),error:(function(p){window.location=j
})})
}else{window.location=j
}}function m(){h.find(".waitAddContainer").addClass("hidden");
h.attr("data-launch-url",j);
h.attr("data-solution",l);
h.attr("data-product-name",n);
h.attr("data-ims-org-id",f);
h.attr("data-product-id",g);
h.find(".modal-header").removeClass("hidden");
h.find(".modal-footer.questionLink").removeClass("hidden");
h.find(".modal-body.questionLink").removeClass("hidden");
h.find(".modal-body.questionLink").text(CQ.I18n.get("Do you have an account for {0} that you want to link?",[n]));
h.find(".prodDesc").text(CQ.I18n.get("Enter your credentials for {0} to link your account.",[n]));
h.show()
}});
function a(g,f,d,h){g.removeClass("hidden").addClass(f).addClass(d).children("span").html(h)
}function b(d){d.addClass("hidden").removeClass("alert").removeClass("success").removeClass("error")
}});