(function(e,b){var g="jwv7ouu";
if(e.CUI&&e.CUI.options&&e.CUI.options.typeKitId){g=e.CUI.options.typeKitId
}var a={kitId:g,scriptTimeout:3000};
if(!e.Typekit){var c=document.getElementsByTagName("html")[0];
c.className+=" wf-loading";
var i=setTimeout(function(){c.className=c.className.replace(/(\s|^)wf-loading(\s|$)/g," ");
c.className+=" wf-inactive"
},a.scriptTimeout);
var k=document.createElement("script"),f=false;
k.src="//use.typekit.net/"+a.kitId+".js";
k.type="text/javascript";
k.async="true";
k.onload=k.onreadystatechange=function(){var h=this.readyState;
if(f||h&&h!="complete"&&h!="loaded"){return
}f=true;
clearTimeout(i);
try{Typekit.load(a)
}catch(d){}};
var j=document.getElementsByTagName("script")[0];
j.parentNode.insertBefore(k,j)
}}(this));
(function(d,e,g){var a=e.event,c;
a.special.smartresize={setup:function(){e(this).bind("resize",a.special.smartresize.handler)
},teardown:function(){e(this).unbind("resize",a.special.smartresize.handler)
},handler:function(k,h){var j=this,i=arguments;
k.type="smartresize";
if(c){clearTimeout(c)
}c=setTimeout(function(){e(this).trigger(k,[i])
},h==="execAsap"?0:10)
}};
e.fn.smartresize=function(h){return h?this.bind("smartresize",h):this.trigger("smartresize",["execAsap"])
};
e.CUIGridLayout=function(h,i,j){this.element=e(i);
this._create(h);
this._init(j)
};
var f=e(d);
e.CUIGridLayout.settings={colWidth:240,gutterX:15,gutterY:15,marginLeft:0,marginRight:0,selector:"article"};
e.CUIGridLayout.prototype={option:function(h){this.options=e.extend({},e.CUIGridLayout.settings,h)
},_create:function(i){this.options=e.extend({},e.CUIGridLayout.settings,i);
this.items=[];
this.itemsByPath={};
this.numCols=-1;
this.pendingImages=0;
this.update();
var h=this;
f.bind("smartresize.cui.gridlayout",function(){h.updateDimensions();
h.layout()
})
},_init:function(h){this.updateDimensions();
this.layout(h);
setTimeout(function(){this.numCols=-1;
this.updateDimensions();
this.layout(h);
this.element.trigger(e.Event("cui-gridlayout-initialized",{widget:this}))
}.bind(this),1)
},update:function(){var h=[],i={};
this.element.find(this.options.selector).each(function(k){var m=e(this);
var j=e("img",m);
if(j.length===0){j=null
}var l={path:m.data().path,i:k,$el:m,$img:j};
h.push(l);
i[l.path]=l
});
this.items=h.sort(function(m,l){var k=m.$el.data("gridlayout-sortkey")||0,j=l.$el.data("gridlayout-sortkey")||0;
return j-k||m.i-l.i
});
this.itemsByPath=i
},_imageLoaded:function(){if(--this.pendingImages==0){this.numCols=-1;
this.layout()
}},updateDimensions:function(){var h=this;
this.items.every(function(k){var j=k.$el;
k.w=j.width();
k.h=j.height();
if(k.$img){if(k.$img.width()>k.w){k.h=(k.h-k.$img.height())+(k.$img.height()/k.$img.width()*k.w)
}if(k.$img.height()==0){k.h+=k.w;
h.pendingImages++;
k.$img.on("load.cui.gridlayout",function(){k.$img=null;
k.w=j.width();
k.h=j.height();
h._imageLoaded()
})
}else{k.$img=null
}}return true
})
},layout:function(){var w=this;
var s=this.element;
var m=this.options.colWidth;
var i=this.options.marginLeft;
var o=this.options.marginRight;
var v=this.options.gutterX;
if(s.width()===0){return
}var h=Math.floor((s.width()-i-o+v)/(m+v));
if(h<1){h=1
}if(h==this.numCols){return
}this.numCols=h;
var l=((s.width()-i-o+v)/h)-v;
var t=[];
var q=[];
while(t.length<h){t.push([]);
q.push(0)
}this.items.every(function(x){var j=(x.h/x.w)*l;
var n=q[0];
var z=0;
for(var A=0;
A<q.length;
A++){var y=q[A];
if(y<n){n=y;
z=A
}}t[z].push(x);
q[z]+=j+w.options.gutterY;
return true
});
s.detach(this.options.selector);
var p=s.contents();
for(var r=0;
r<t.length;
r++){var u=e('<div class="grid-'+h+'"></div>').appendTo(s);
for(var k=0;
k<t[r].length;
k++){u.append(t[r][k].$el)
}}p.remove()
},destroy:function(){f.unbind("smartresize.cui.gridlayout");
this.element.removeData("cuigridlayout")
}};
var b=function(h){if(d.console){d.console.error(h)
}};
e.fn.cuigridlayout=function(i,j){if(typeof i==="string"){var h=Array.prototype.slice.call(arguments,1);
this.each(function(){var k=e.data(this,"cuigridlayout");
if(!k){b("cannot call methods on cuigridlayout prior to initialization; attempted to call method '"+i+"'");
return
}if(!e.isFunction(k[i])||i.charAt(0)==="_"){b("no such method '"+i+"' for cuigridlayout instance");
return
}k[i].apply(k,h)
})
}else{this.each(function(){var k=e.data(this,"cuigridlayout");
if(k){k.option(i);
k._init(j)
}else{e.data(this,"cuigridlayout",new e.CUIGridLayout(i,this,j))
}})
}return this
}
})(window,jQuery);
/*!
 * jQuery :scrollable selector filter
 * https://github.com/litera/jquery-scrollintoview/blob/master/jquery.scrollintoview.js#L172
 *
 * Version 1.8 (14 Jul 2011)
 * Requires jQuery 1.4 or newer
 *
 * Copyright (c) 2011 Robert Koritnik
 * Licensed under the terms of the MIT license
 * http://www.opensource.org/licenses/mit-license.php
 */
(function(a,e){var c={vertical:{x:false,y:true},horizontal:{x:true,y:false},both:{x:true,y:true},x:{x:true,y:false},y:{x:false,y:true}};
var d=/^(?:html)$/i;
var b={auto:true,scroll:true,visible:false,hidden:false};
e.extend(e.expr[":"],{scrollable:function(i,g,l,f){var k=c[typeof(l[3])==="string"&&l[3].toLowerCase()]||c.both;
var j=(a.defaultView&&a.defaultView.getComputedStyle?a.defaultView.getComputedStyle(i,null):i.currentStyle);
var m={x:b[j.overflowX.toLowerCase()]||false,y:b[j.overflowY.toLowerCase()]||false,isRoot:d.test(i.nodeName)};
if(!m.x&&!m.y&&!m.isRoot){return false
}var h={height:{scroll:i.scrollHeight,client:i.clientHeight},width:{scroll:i.scrollWidth,client:i.clientWidth},scrollableX:function(){return(m.x||m.isRoot)&&this.width.scroll>this.width.client
},scrollableY:function(){return(m.y||m.isRoot)&&this.height.scroll>this.height.client
}};
return k.y&&h.scrollableY()||k.x&&h.scrollableX()
}})
})(document,jQuery);
/*!
 * jQuery Cookie Plugin v1.3
 * https://github.com/carhartl/jquery-cookie
 *
 * Copyright 2011, Klaus Hartl
 * Dual licensed under the MIT or GPL Version 2 licenses.
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.opensource.org/licenses/GPL-2.0
 */
(function(f,b,g){var a=/\+/g;
function e(h){return h
}function c(h){return decodeURIComponent(h.replace(a," "))
}var d=f.cookie=function(p,o,u){if(o!==g){u=f.extend({},d.defaults,u);
if(o===null){u.expires=-1
}if(typeof u.expires==="number"){var q=u.expires,s=u.expires=new Date();
s.setDate(s.getDate()+q)
}o=d.json?JSON.stringify(o):String(o);
return(b.cookie=[encodeURIComponent(p),"=",d.raw?o:encodeURIComponent(o),u.expires?"; expires="+u.expires.toUTCString():"",u.path?"; path="+u.path:"",u.domain?"; domain="+u.domain:"",u.secure?"; secure":""].join(""))
}var h=d.raw?e:c;
var r=b.cookie.split("; ");
for(var n=0,k=r.length;
n<k;
n++){var m=r[n].split("=");
if(h(m.shift())===p){var j=h(m.join("="));
return d.json?JSON.parse(j):j
}}return null
};
d.defaults={};
f.removeCookie=function(i,h){if(f.cookie(i)!==null){f.cookie(i,null,h);
return true
}return false
}
})(jQuery,document);
(function(d,c,f){var e={threshold:200,applyClassToElement:f};
var b={rem:function(){if(b._rem===f){b._rem=parseInt(d("body").css("font-size"))
}return b._rem
},em:function(g){return parseFloat(g.css("font-size"))
}};
d.fn.reflow=function a(h,g){return this.each(function i(){var n=d(this),o=false,j=false,k;
if(h){k=d.extend({},e,g);
k.applyClassToElement=k.applyClassToElement||n;
function m(){if(n.is(":visible")){if(!j){l();
j=setTimeout(function p(){j=false;
if(!o&&n.is(":visible")){l()
}},k.threshold)
}else{o=false
}}}function l(){o=true;
for(var p in h){k.applyClassToElement.toggleClass(p,h[p](n,b))
}}n.on("reflow",m);
d(c).on("resize.reflow",m)
}n.trigger("reflow")
})
}
}(jQuery,this));
(function(d,b){function c(e){return function(h,g,i){if(e.message.hasOwnProperty(g)){var f=e.message[g];
(i||[]).forEach(function(k,j){f=f.replace(new RegExp("\\{"+j+"\\}","g"),k)
});
return f
}return undefined
}
}var a=(function(){var e=[];
return{register:function(f){e.push(f)
},message:function(h,g,l){for(var f=e.length-1;
f>=0;
f--){var k=e[f];
if(!h.is(k.selector)){continue
}var j=(d.isFunction(k.message)?k.message:c(k)).call(h,h,g,l);
if(j){return j
}}if(b){b.warn("Message not found:",g,h[0])
}return undefined
}}
})();
d.fn.message=function(e,f){return a.message(this.first(),e,f)
};
d.message=(function(){return{register:function(e){d.each(arguments,function(){a.register(this)
})
}}
})()
})(jQuery,window.console);
(function(g,e){var b=(function(){var j="input, textarea, select, button, keygen, object, [role=checkbox], [role=radio], [role=combobox], [role=listbox], [role=radiogroup], [role=tree], [role=slider], [role=spinbutton], [role=textbox]";
var l="input:not([readonly],[disabled],[type=hidden],[type=reset],[type=button]), select, textarea:not([readonly]), button[type=submit], [role=checkbox]:not([aria-disabled=true]), [role=radio]:not([aria-disabled=true]), [role=combobox]:not([aria-disabled=true]), [role=listbox]:not([aria-disabled=true]), [role=radiogroup]:not([aria-disabled=true]), [role=tree]:not([aria-disabled=true]), [role=slider]:not([aria-disabled=true]), [role=spinbutton]:not([aria-disabled=true]), [role=textbox]:not([aria-disabled=true],[aria-readonly=true])";
var k=[];
return{isSummittable:function(m){return m.is(j)
},submittables:function(m){return m.find(j)
},isCandidate:function(m){return m.is(l)
},api:function(m){if(!this.isSummittable(m)){return
}return m.data("validator")||(function(p,n){var o=i(p,n);
p.data("validator",o);
return o
})(m,this)
},register:function(m){k.push(m)
},validators:function(m){return k.filter(function(n){return m.is(n.selector)
})
}}
})();
function i(k,j){return new f(k,j)
}function f(k,j){this.el=k;
this.registry=j;
this.message=null;
this.customMessage=null;
this.state=(function(l){return{getCustomError:function(){return !!l.customMessage
},isValid:function(){return !l.customMessage&&!l.message
}}
})(this)
}function h(m,l,j){for(var k=m.length-1;
k>=0;
k--){if(!l.call(j,m[k],k,m)){return false
}}return true
}function c(){return e.Event("invalid",{isJqueryValidator:true})
}f.prototype={willValidate:function(){return this.registry.isCandidate(this.el)
},setCustomValidity:function(j){this.customMessage=j
},getValidity:function(){return this.state
},checkValidity:function(j){j=j||{};
if(!this.willValidate()){return true
}if(this.customMessage){if(!j.suppressEvent){this.el.trigger(c())
}return false
}this.message=null;
h(this.registry.validators(this.el),function(l){if(!l.validate){return true
}var k=l.validate(this.el);
if(k){this.message=k;
return false
}else{return true
}},this);
if(this.message){if(!j.suppressEvent){this.el.trigger(c())
}return false
}return true
},getValidationMessage:function(){if(!this.willValidate()){return""
}return this.customMessage||this.message||""
},updateUI:function(){var j;
if(this.getValidity().isValid()){j=function(k){return !k.clear||k.clear(this.el)===e.validator.CONTINUE
}
}else{j=function(k){return !k.show||k.show(this.el,this.getValidationMessage())===e.validator.CONTINUE
}
}h(this.registry.validators(this.el),j,this)
}};
e.extend(e.expr[":"],{submittable:function(j){return b.isSummittable(e(j))
}});
e.fn.willValidate=function(){var j=b.api(this.first());
if(j){return j.willValidate()
}else{return false
}};
e.fn.validationMessage=function(){var j=b.api(this.first());
if(j){return j.getValidationMessage()
}else{return""
}};
e.fn.checkValidity=function(){var j=b.api(this.first());
if(j){return j.checkValidity()
}else{return true
}};
e.fn.setCustomValidity=function(j){return this.each(function(){var k=b.api(e(this));
if(k){k.setCustomValidity(j)
}})
};
e.fn.updateErrorUI=function(){return this.each(function(){var j=b.api(e(this));
if(j){j.updateUI()
}})
};
e.validator=(function(){return{CONTINUE:1,STOP:2,register:function(){e.each(arguments,function(){b.register(this)
})
},isValid:function(j){var k=true;
j.find(":submittable").each(function(){var l=e(this);
if(l.willValidate()&&!l.checkValidity()){k=false;
return false
}});
return k
}}
})();
function d(k,j){return j.submittables(k).map(function(){var l=j.api(e(this));
if(!l||!l.willValidate()||l.checkValidity({suppressEvent:true})){return
}return this
}).map(function(){var l=c();
e(this).trigger(l);
if(!l.isDefaultPrevented()){return this
}})
}function a(l,j){var k=d(l,j);
if(k.length>0){k.each(function(){var m=j.api(e(this));
if(m){m.updateUI()
}});
return false
}return true
}g.addEventListener("submit",function(k){var j=e(k.target);
if(!j.is("form")||j.prop("noValidate")===true||(j.prop("noValidate")===undefined&&j.attr("novalidate")!==undefined)){return
}if(!a(j,b)){k.stopPropagation();
k.preventDefault()
}},true)
})(document,jQuery);
/*!
 * jQuery UI Position @VERSION
 * http://jqueryui.com
 *
 * Copyright 2013 jQuery Foundation and other contributors
 * Released under the MIT license.
 * http://jquery.org/license
 *
 * http://api.jqueryui.com/position/
 */
(function(e,c){e.ui=e.ui||{};
var j,k=Math.max,o=Math.abs,m=Math.round,d=/left|center|right/,h=/top|center|bottom/,a=/[\+\-]\d+(\.[\d]+)?%?/,l=/^\w+/,b=/%$/,g=e.fn.position;
function n(r,q,p){return[parseFloat(r[0])*(b.test(r[0])?q/100:1),parseFloat(r[1])*(b.test(r[1])?p/100:1)]
}function i(p,q){return parseInt(e.css(p,q),10)||0
}function f(q){var p=q[0];
if(p.nodeType===9){return{width:q.width(),height:q.height(),offset:{top:0,left:0}}
}if(e.isWindow(p)){return{width:q.width(),height:q.height(),offset:{top:q.scrollTop(),left:q.scrollLeft()}}
}if(p.preventDefault){return{width:0,height:0,offset:{top:p.pageY,left:p.pageX}}
}return{width:q.outerWidth(),height:q.outerHeight(),offset:q.offset()}
}e.position={scrollbarWidth:function(){if(j!==c){return j
}var q,p,s=e("<div style='display:block;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),r=s.children()[0];
e("body").append(s);
q=r.offsetWidth;
s.css("overflow","scroll");
p=r.offsetWidth;
if(q===p){p=s[0].clientWidth
}s.remove();
return(j=q-p)
},getScrollInfo:function(t){var s=t.isWindow?"":t.element.css("overflow-x"),r=t.isWindow?"":t.element.css("overflow-y"),q=s==="scroll"||(s==="auto"&&t.width<t.element[0].scrollWidth),p=r==="scroll"||(r==="auto"&&t.height<t.element[0].scrollHeight);
return{width:p?e.position.scrollbarWidth():0,height:q?e.position.scrollbarWidth():0}
},getWithinInfo:function(q){var r=e(q||window),p=e.isWindow(r[0]);
return{element:r,isWindow:p,offset:r.offset()||{left:0,top:0},scrollLeft:r.scrollLeft(),scrollTop:r.scrollTop(),width:p?r.width():r.outerWidth(),height:p?r.height():r.outerHeight()}
}};
e.fn.position=function(z){if(!z||!z.of){return g.apply(this,arguments)
}z=e.extend({},z);
var A,w,u,y,t,p,v=e(z.of),s=e.position.getWithinInfo(z.within),q=e.position.getScrollInfo(s),x=(z.collision||"flip").split(" "),r={};
p=f(v);
if(v[0].preventDefault){z.at="left top"
}w=p.width;
u=p.height;
y=p.offset;
t=e.extend({},y);
e.each(["my","at"],function(){var D=(z[this]||"").split(" "),C,B;
if(D.length===1){D=d.test(D[0])?D.concat(["center"]):h.test(D[0])?["center"].concat(D):["center","center"]
}D[0]=d.test(D[0])?D[0]:"center";
D[1]=h.test(D[1])?D[1]:"center";
C=a.exec(D[0]);
B=a.exec(D[1]);
r[this]=[C?C[0]:0,B?B[0]:0];
z[this]=[l.exec(D[0])[0],l.exec(D[1])[0]]
});
if(x.length===1){x[1]=x[0]
}if(z.at[0]==="right"){t.left+=w
}else{if(z.at[0]==="center"){t.left+=w/2
}}if(z.at[1]==="bottom"){t.top+=u
}else{if(z.at[1]==="center"){t.top+=u/2
}}A=n(r.at,w,u);
t.left+=A[0];
t.top+=A[1];
return this.each(function(){var C,L,E=e(this),G=E.outerWidth(),D=E.outerHeight(),F=i(this,"marginLeft"),B=i(this,"marginTop"),K=G+F+i(this,"marginRight")+q.width,J=D+B+i(this,"marginBottom")+q.height,H=e.extend({},t),I=n(r.my,E.outerWidth(),E.outerHeight());
if(z.my[0]==="right"){H.left-=G
}else{if(z.my[0]==="center"){H.left-=G/2
}}if(z.my[1]==="bottom"){H.top-=D
}else{if(z.my[1]==="center"){H.top-=D/2
}}H.left+=I[0];
H.top+=I[1];
if(!e.support.offsetFractions){H.left=m(H.left);
H.top=m(H.top)
}C={marginLeft:F,marginTop:B};
e.each(["left","top"],function(N,M){if(e.ui.position[x[N]]){e.ui.position[x[N]][M](H,{targetWidth:w,targetHeight:u,elemWidth:G,elemHeight:D,collisionPosition:C,collisionWidth:K,collisionHeight:J,offset:[A[0]+I[0],A[1]+I[1]],my:z.my,at:z.at,within:s,elem:E})
}});
if(z.using){L=function(P){var R=y.left-H.left,O=R+w-G,Q=y.top-H.top,N=Q+u-D,M={target:{element:v,left:y.left,top:y.top,width:w,height:u},element:{element:E,left:H.left,top:H.top,width:G,height:D},horizontal:O<0?"left":R>0?"right":"center",vertical:N<0?"top":Q>0?"bottom":"middle"};
if(w<G&&o(R+O)<w){M.horizontal="center"
}if(u<D&&o(Q+N)<u){M.vertical="middle"
}if(k(o(R),o(O))>k(o(Q),o(N))){M.important="horizontal"
}else{M.important="vertical"
}z.using.call(this,P,M)
}
}E.offset(e.extend(H,{using:L}))
})
};
e.ui.position={fit:{left:function(t,s){var r=s.within,v=r.isWindow?r.scrollLeft:r.offset.left,x=r.width,u=t.left-s.collisionPosition.marginLeft,w=v-u,q=u+s.collisionWidth-x-v,p;
if(s.collisionWidth>x){if(w>0&&q<=0){p=t.left+w+s.collisionWidth-x-v;
t.left+=w-p
}else{if(q>0&&w<=0){t.left=v
}else{if(w>q){t.left=v+x-s.collisionWidth
}else{t.left=v
}}}}else{if(w>0){t.left+=w
}else{if(q>0){t.left-=q
}else{t.left=k(t.left-u,t.left)
}}}},top:function(s,r){var q=r.within,w=q.isWindow?q.scrollTop:q.offset.top,x=r.within.height,u=s.top-r.collisionPosition.marginTop,v=w-u,t=u+r.collisionHeight-x-w,p;
if(r.collisionHeight>x){if(v>0&&t<=0){p=s.top+v+r.collisionHeight-x-w;
s.top+=v-p
}else{if(t>0&&v<=0){s.top=w
}else{if(v>t){s.top=w+x-r.collisionHeight
}else{s.top=w
}}}}else{if(v>0){s.top+=v
}else{if(t>0){s.top-=t
}else{s.top=k(s.top-u,s.top)
}}}}},flip:{left:function(v,u){var t=u.within,z=t.offset.left+t.scrollLeft,C=t.width,r=t.isWindow?t.scrollLeft:t.offset.left,w=v.left-u.collisionPosition.marginLeft,A=w-r,q=w+u.collisionWidth-C-r,y=u.my[0]==="left"?-u.elemWidth:u.my[0]==="right"?u.elemWidth:0,B=u.at[0]==="left"?u.targetWidth:u.at[0]==="right"?-u.targetWidth:0,s=-2*u.offset[0],p,x;
if(A<0){p=v.left+y+B+s+u.collisionWidth-C-z;
if(p<0||p<o(A)){v.left+=y+B+s
}}else{if(q>0){x=v.left-u.collisionPosition.marginLeft+y+B+s-r;
if(x>0||o(x)<q){v.left+=y+B+s
}}}},top:function(u,t){var s=t.within,B=s.offset.top+s.scrollTop,C=s.height,p=s.isWindow?s.scrollTop:s.offset.top,w=u.top-t.collisionPosition.marginTop,y=w-p,v=w+t.collisionHeight-C-p,z=t.my[1]==="top",x=z?-t.elemHeight:t.my[1]==="bottom"?t.elemHeight:0,D=t.at[1]==="top"?t.targetHeight:t.at[1]==="bottom"?-t.targetHeight:0,r=-2*t.offset[1],A,q;
if(y<0){q=u.top+x+D+r+t.collisionHeight-C-B;
if((u.top+x+D+r)>y&&(q<0||q<o(y))){u.top+=x+D+r
}}else{if(v>0){A=u.top-t.collisionPosition.marginTop+x+D+r-p;
if((u.top+x+D+r)>v&&(A>0||o(A)<v)){u.top+=x+D+r
}}}}},flipfit:{left:function(){e.ui.position.flip.left.apply(this,arguments);
e.ui.position.fit.left.apply(this,arguments)
},top:function(){e.ui.position.flip.top.apply(this,arguments);
e.ui.position.fit.top.apply(this,arguments)
}}};
(function(){var t,v,q,s,r,p=document.getElementsByTagName("body")[0],u=document.createElement("div");
t=document.createElement(p?"div":"body");
q={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"};
if(p){e.extend(q,{position:"absolute",left:"-1000px",top:"-1000px"})
}for(r in q){t.style[r]=q[r]
}t.appendChild(u);
v=p||document.documentElement;
v.insertBefore(t,v.firstChild);
u.style.cssText="position: absolute; left: 10.7432222px;";
s=e(u).offset().left;
e.support.offsetFractions=s>10&&s<11;
t.innerHTML="";
v.removeChild(t)
})()
}(jQuery));
/*!
* toe.js
* version 3.0.2
* author: Damien Antipa
* https://github.com/dantipa/toe.js
*/
(function(e,h,b){var a,g={},d={active:false,on:function(){e(document).on("touchstart",f).on("touchmove",c).on("touchend touchcancel",i);
d.active=true
},off:function(){e(document).off("touchstart",f).off("touchmove",c).off("touchend touchcancel",i);
d.active=false
},track:function(l,k){g[l]=k
},addEventParam:function(l,k){var o=e(l.target),n=o.offset(),m={pageX:l.point[0].x,pageY:l.point[0].y,offsetX:n.left-l.point[0].x,offsetY:n.top-l.point[0].y};
return e.extend(m,k)
},Event:function(m){var l={type:m.type,timestamp:new Date().getTime(),target:m.target,point:[]},k=m.changedTouches||m.originalEvent.changedTouches||m.touches||m.originalEvent.touches;
e.each(k,function(n,o){l.point.push({x:o.pageX,y:o.pageY})
});
return l
},State:function(l){var k=l.point[0];
return{start:l,move:[],end:null}
},calc:{getDuration:function(l,k){return k.timestamp-l.timestamp
},getDistance:function(l,k){return Math.sqrt(Math.pow(k.x-l.x,2)+Math.pow(k.y-l.y,2))
},getAngle:function(l,k){return Math.atan2(k.y-l.y,k.x-l.x)*180/Math.PI
},getDirection:function(k){return k<-45&&k>-135?"top":k>=-45&&k<=45?"right":k>=45&&k<135?"down":k>=135||k<=-135?"left":"unknown"
},getScale:function(n,k){var m=n.point,l=k.point;
if(m.length===2&&l.length===2){return(Math.sqrt(Math.pow(l[0].x-l[1].x,2)+Math.pow(l[0].y-l[1].y,2))/Math.sqrt(Math.pow(m[0].x-m[1].x,2)+Math.pow(m[0].y-m[1].y,2))).toFixed(2)
}return 0
},getRotation:function(n,k){var m=n.point,l=k.point;
if(m.length===2&&l.length===2){return((Math.atan2(l[0].y-l[1].y,l[0].x-l[1].x)*180/Math.PI)-(Math.atan2(m[0].y-m[1].y,m[0].x-m[1].x)*180/Math.PI)).toFixed(2)
}return 0
}}};
function j(l,m,n,k){e.each(g,function(o,p){p[l].call(this,m,n,k)
})
}function f(k){var l=d.Event(k);
a=d.State(l);
j("touchstart",k,a,l)
}function c(l){var k=d.Event(l);
a.move.push(k);
j("touchmove",l,a,k)
}function i(l){var k=d.Event(l);
a.end=k;
j("touchend",l,a,k)
}d.on();
e.toe=d
}(jQuery,this));
(function(d,f,c,e){var b="swipe",a={distance:40,duration:1200,direction:"all"};
f.track(b,{touchstart:function(g,h,i){h[b]={finger:i.point.length}
},touchmove:function(h,i,g){i[b].finger=g.point.length>i[b].finger?g.point.length:i[b].finger
},touchend:function(i,j,g){var h=d.extend(a,i.data),k,l;
k=f.calc.getDuration(j.start,g);
l=f.calc.getDistance(j.start.point[0],g.point[0]);
if(k<h.duration&&l>h.distance){j[b].angle=f.calc.getAngle(j.start.point[0],g.point[0]);
j[b].direction=f.calc.getDirection(j[b].angle);
if(h.direction==="all"||j[b].direction===h.direction){d(i.target).trigger(d.Event(b,f.addEventParam(j.start,j[b])))
}}}})
}(jQuery,jQuery.toe,this));
(function(d,f,c,e){var b="tap",a={distance:10,duration:300,finger:1};
f.track(b,{touchstart:function(g,h,i){h[b]={finger:i.point.length}
},touchmove:function(h,i,g){i[b].finger=g.point.length>i[b].finger?g.point.length:i[b].finger
},touchend:function(i,j,g){var h=d.extend(a,i.data),k,l;
k=f.calc.getDuration(j.start,g);
l=f.calc.getDistance(j.start.point[0],g.point[0]);
if(k<h.duration&&l<h.distance){if(j[b].finger===h.finger){d(i.target).trigger(d.Event(b,f.addEventParam(j.start,j[b])))
}}}})
}(jQuery,jQuery.toe,this));
(function(d,h,c,e){var g,f,b="taphold",a={distance:20,duration:500,finger:1};
h.track(b,{touchstart:function(j,k,l){var i=d.extend(a,j.data);
f=false;
k[b]={finger:l.point.length};
clearTimeout(g);
g=setTimeout(function(){if(!f&&h.active){if(k[b].finger===i.finger){d(j.target).trigger(d.Event(b,h.addEventParam(l,k[b])))
}}},i.duration)
},touchmove:function(k,l,i){var j=d.extend(a,k.data),m;
l[b].finger=i.point.length>l[b].finger?i.point.length:l[b].finger;
m=h.calc.getDistance(l.start.point[0],i.point[0]);
if(m>j.distance){f=true
}},touchend:function(j,k,i){f=true;
clearTimeout(g)
}})
}(jQuery,jQuery.toe,this));
(function(e,g,d,f){var c="transform",b={scale:0.1,rotation:15},a;
g.track(c,{touchstart:function(h,i,j){a=false;
i[c]={start:j,move:[]}
},touchmove:function(j,k,h){var i=e.extend(b,j.data);
if(h.point.length!==2){return
}k[c].move.push(h);
if(k[c].start.point.length!==2&&h.point.length===2){k[c].start=e.extend({},h)
}k[c].rotation=g.calc.getRotation(k[c].start,h);
k[c].scale=g.calc.getScale(k[c].start,h);
if(Math.abs(1-k[c].scale)>i.scale||Math.abs(k[c].rotation)>i.rotation){if(!a){e(j.target).trigger(e.Event("transformstart",k[c]));
a=true
}e(j.target).trigger(e.Event("transform",k[c]))
}},touchend:function(i,j,h){if(a){a=false;
if(h.point.length!==2){j.end=e.extend({},j[c].move[j[c].move.length-1])
}j[c].rotation=g.calc.getRotation(j[c].start,j.end);
j[c].scale=g.calc.getScale(j[c].start,j.end);
e(i.target).trigger(e.Event("transformend",j[c]))
}}})
}(jQuery,jQuery.toe,this));
var Class;
var Exception;
(function(){var c=function(e){var d=e.bind(this);
d._methodName=e._methodName;
this[d._methodName]=d;
return d
};
var b=function(d){d.extend=this;
return new Class(d)
};
Class=function(d){d=d||{};
if(d.hasOwnProperty("extend")&&!d.extend){throw new Class.NonTruthyExtendError(typeof d.toString==="function"?d.toString():d.toString)
}var g=d.extend||Object;
var k=d.construct;
var e=d.destruct;
delete d.bind;
delete d.extend;
delete d.destruct;
delete d.construct;
if(d.hasOwnProperty("toString")&&typeof d.toString!=="function"){var i=d.toString;
d.toString=function(){return i.toString()
}
}else{if(!d.hasOwnProperty("toString")&&g.prototype.hasOwnProperty("toString")){d.toString=g.prototype.toString
}}var l=d;
var h=Object.create(g&&g.prototype);
h.superClass=g.prototype;
if(l){for(var j in l){if(l.hasOwnProperty(j)){h[j]=l[j];
if(typeof l[j]==="function"){h[j]._methodName=j;
h[j]._parentProto=h
}}}}h.inherited=function(p){var o=p.callee;
var m=o._methodName;
if(!m){throw new Class.MissingCalleeError(this.toString())
}var r=o._parentProto;
var n=null;
while(r.superClass){r=r.superClass;
n=r[m];
if(typeof n==="function"){break
}}if(typeof n==="function"){var q=this.inherited;
this.inherited=r.inherited;
var s=n.apply(this,p);
this.inherited=q;
return s
}else{throw new Class.InheritedMethodNotFoundError(this.toString(),m)
}};
h.bind=c;
h.destruct=function(){if(typeof e==="function"){e.apply(this)
}if(g&&g.prototype&&typeof g.prototype.destruct==="function"){g.prototype.destruct.apply(this)
}};
h.construct=function(){var m=arguments;
if(m[0]===undefined){m.length=1;
m[0]={}
}if(g&&g.prototype&&typeof g.prototype.construct==="function"){g.prototype.construct.apply(this,arguments)
}if(typeof k==="function"){k.apply(this,arguments)
}};
var f=function(){var m=Object.create(h);
h.construct.apply(m,arguments);
return m
};
f.toString=h.toString;
f.prototype=h;
f.extend=b;
h.constructor=f;
return f
};
if(!Object.create){Object.create=function(e){if(arguments.length>1){throw new Error("Object.create implementation only accepts the first parameter.")
}function d(){}d.prototype=e;
return new d()
}
}if(!Function.prototype.bind){Function.prototype.bind=function(e){if(typeof this!=="function"){throw new TypeError("Function.prototype.bind - what is trying to be bound is not callable")
}var h=Array.prototype.slice.call(arguments,1);
var g=this;
var d=function(){};
var f=function(){return g.apply(this instanceof d?this:e,h.concat(Array.prototype.slice.call(arguments)))
};
d.prototype=this.prototype;
f.prototype=new d();
return f
}
}Exception=new Class({extend:Error,construct:function(){this.name="Error";
this.message="General exception"
},toString:function(){return this.name+": "+this.message
}});
var a=Exception.extend({name:"Class Exception"});
Class.NonTruthyExtendError=a.extend({construct:function(d){this.message=d+" attempted to extend a non-truthy object"
}});
Class.InheritedMethodNotFoundError=a.extend({construct:function(e,d){this.message=e+" can't call method '"+d+"', no method defined in parent classes"
}});
Class.MissingCalleeError=a.extend({construct:function(d){this.message=d+" can't call inherited method: calling method did not have _methodName"
}})
}());
(function(b,a,c){a.CUI=a.CUI||{};
CUI.options=b.extend({debug:false,dataAPI:true},CUI.options);
b(function(){b(document).trigger("cui-contentloaded")
})
}(jQuery,this));
(function(c,b,d){var a=1;
CUI.util={isTouch:"ontouchstart" in b,getNextId:function(){return"coral-"+a++
},getDataTarget:function(f){var g=f.attr("href");
var e=c(f.attr("data-target")||(g&&g.replace(/.*(?=#[^\s]+$)/,"")));
return e
},decapitalize:function(e){return e.slice(0,1).toLowerCase()+e.slice(1)
},capitalize:function(e){return e.slice(0,1).toUpperCase()+e.slice(1)
},plugClass:function(f,e,g){e=e||CUI.util.decapitalize(f.toString());
c.fn[e]=function(h){var i=arguments;
return this.each(function(){var k=c(this);
var l=c.extend({},k.data(),typeof h==="object"&&h,{element:this});
var j=k.data(e)||new f(l);
if(typeof h==="string"){j[h].apply(j,Array.prototype.slice.call(i,1))
}else{if(c.isPlainObject(h)){j.set(h)
}}if(typeof g==="function"){g.call(this,j)
}})
};
c.fn[e].Constructor=f
},buildFunction:function(g,i){i=i||[];
if(typeof i==="string"){i=[i]
}if(g){try{var f=Function;
return new f(i,"return "+g+"("+i.join(", ")+");")
}catch(h){return null
}}},selectText:function(i,j,e){var h=i.val();
if(h.length>0){j=j||0;
e=e||h.length;
var g=c(i)[0];
if(g.setSelectionRange){g.blur();
g.setSelectionRange(j,e);
g.focus()
}else{if(g.createTextRange){var f=g.createTextRange();
f.collapse(true);
f.moveEnd("character",e-h.length);
f.moveStart("character",j);
f.select()
}}}},getNested:function(f,h){if(!h){return f
}var g=typeof h==="string"?h.split("."):h;
var e=f;
while(e&&g.length>0){e=e[g.shift()]
}return e
},isTrue:function(e){return e==="true"
}};
c("html").toggleClass("touch",CUI.util.isTouch)
}(jQuery,this));
(function(b,a,e){b.fn.loadWithSpinner=function(h,g,j){var f=b(this);
if(h&&(g||f.data("loaded-remote")!==h)){var i=setTimeout(function(){f.html('<div class="spinner large"></div>')
},50);
f.load(h,function(l,k,m){clearTimeout(i);
if(k==="error"){f.html('<div class="alert error"><strong>ERROR</strong> Failed to load content: '+m.statusText+" ("+m.status+")</div>");
f.data("loaded-remote","")
}if(typeof j==="function"){j.call(this,l,k,m)
}});
f.data("loaded-remote",h)
}};
b.fn.finger=function(){if(CUI.util.isTouch){this.on.apply(this,arguments)
}return this
};
b.fn.pointer=function(){if(!CUI.util.isTouch){this.on.apply(this,arguments)
}return this
};
b.fn.fipo=function(){var f=Array.prototype.slice.call(arguments,1,arguments.length);
this.pointer.apply(this,f);
f[0]=arguments[0];
this.finger.apply(this,f);
return this
};
function d(h,f){var j,i,g,k=h.nodeName.toLowerCase();
if("area"===k){j=h.parentNode;
i=j.name;
if(!h.href||!i||j.nodeName.toLowerCase()!=="map"){return false
}g=b("img[usemap=#"+i+"]")[0];
return !!g&&c(g)
}return(/input|select|textarea|button|object/.test(k)?!h.disabled:"a"===k?h.href||f:f)&&c(h)
}function c(f){return b.expr.filters.visible(f)&&!b(f).parents().addBack().filter(function(){return b.css(this,"visibility")==="hidden"
}).length
}b.extend(b.expr[":"],{data:b.expr.createPseudo(function(f){return function(g){return !!b.data(g,f)
}
}),focusable:function(f){return d(f,!isNaN(b.attr(f,"tabindex")))
},tabbable:function(h){var f=b.attr(h,"tabindex"),g=isNaN(f);
return(g||f>=0)&&d(h,!g)
}})
}(jQuery,this));
(function(e,d,g){var f="cui-state",b="cui-state-restore",a={},c=false,h=e(document);
CUI.util.state={config:{serverpersistence:true},save:function(i,n,m,k){var l=e(i),j=function(p,o){a.global[i]=a.global[i]||{};
a.global[i][o]=a.global[i][o]||{};
a.global[i][o].val=l.attr(o);
a.global[i][o].autorestore=m||false;
a.global[i][o].customEvent=k||null
};
if(n){if(e.isArray(n)){e.each(n,j)
}else{j(0,n)
}}else{}localStorage.setItem(f,JSON.stringify(a));
if(CUI.util.state.config.serverpersistence){e.cookie(f,JSON.stringify(a),{expires:7,path:"/"})
}},restore:function(i,l){var j=l||function(){return true
},n,m,o=function(q,p){n=q;
m=e(n);
if(a.global[n]){e.each(a.global[n],k)
}},k=function(p,q){if(j(n,p,q)){m.attr(p,q.val);
if(q.customEvent){h.trigger(q.customEvent,[m,q])
}h.trigger(b,[m,q])
}};
if(!c){c=CUI.util.state.load()
}if(i){o(i)
}else{e.each(a.global,o)
}},load:function(){var i=localStorage.getItem(f);
a=i?JSON.parse(i):{global:{}};
return true
},setSessionItem:function(i,l,k){var j=i;
if(k){j=i+":"+k
}sessionStorage.setItem(j,JSON.stringify(l))
},getSessionItem:function(i,k){var j=i;
if(k){j=i+":"+k
}var l=sessionStorage.getItem(j);
if(l){l=JSON.parse(l)
}return l
},removeSessionItem:function(i,k){var j=i;
if(k){j=i+":"+k
}sessionStorage.removeItem(j)
},clearSessionItems:function(n){if(n){n=":"+n;
var p=sessionStorage.length;
var m=[];
for(var j=0;
j<p;
j++){var q=sessionStorage.key(j);
var i=q.length;
if(i>n.length){if(q.substring(i-n.length)===n){m.push(q)
}}}var l=m.length;
for(var o=0;
o<l;
o++){sessionStorage.removeItem(m[o])
}}}};
h.ready(function(){CUI.util.state.restore(null,function(j,i,k){if(k.autorestore){return true
}return false
})
})
}(jQuery,this));
(function(b,a,c){CUI.util.color={hex:function(d){return("0"+parseInt(d,10).toString(16)).slice(-2)
},HexToRGB:function(d){d=parseInt(((d.indexOf("#")>-1)?d.substring(1):d),16);
return{r:d>>16,g:(d&65280)>>8,b:(d&255)}
},RGBAToHex:function(e){var d=e.substring(e.indexOf("(")+1,e.lastIndexOf(")")).split(/,\s*/);
return"#"+this.hex(d[0])+this.hex(d[1])+this.hex(d[2])
},RGBToHex:function(d){return"#"+this.hex(d.r)+this.hex(d.g)+this.hex(d.b)
},CMYKtoRGB:function(g){var e={r:0,g:0,b:0};
var i=parseInt(g.c,10)/100;
var d=parseInt(g.m,10)/100;
var h=parseInt(g.y,10)/100;
var f=parseInt(g.k,10)/100;
e.r=1-Math.min(1,i*(1-f)+f);
e.g=1-Math.min(1,d*(1-f)+f);
e.b=1-Math.min(1,h*(1-f)+f);
e.r=Math.round(e.r*255);
e.g=Math.round(e.g*255);
e.b=Math.round(e.b*255);
return e
},RGBtoCMYK:function(f){var e={c:0,m:0,y:0,k:0};
if(parseInt(f.r,10)===0&&parseInt(f.g,10)===0&&parseInt(f.b,10)===0){e.k=100;
return e
}var i=parseInt(f.r,10)/255;
var h=parseInt(f.g,10)/255;
var d=parseInt(f.b,10)/255;
e.k=Math.min(1-i,1-h,1-d);
e.c=(1-i-e.k)/(1-e.k);
e.m=(1-h-e.k)/(1-e.k);
e.y=(1-d-e.k)/(1-e.k);
e.c=Math.round(e.c*100);
e.m=Math.round(e.m*100);
e.y=Math.round(e.y*100);
e.k=Math.round(e.k*100);
return e
},fixHex:function(e){if(e.length===3){e=e.charAt(0)+e.charAt(0)+e.charAt(1)+e.charAt(1)+e.charAt(2)+e.charAt(2)
}if(e.indexOf("#")===-1){e="#"+e
}var d=/(^#[0-9A-F]{6})|(^#[0-9A-F]{3})$/i.test(e);
if(!d){this.$element.find("[name=':hex']").val("");
return""
}return e
},isSameColor:function(e,d){return e&&d&&(e===d)
},isValid:function(d,e){if(e.indexOf(d)!=-1){return this.fixHex(this.RGBAToHex(e))!==""
}return false
}}
}(jQuery,this));
CUI.util.HTTP={isOkStatus:function(a){try{return(String(a).indexOf("2")===0)
}catch(b){return false
}},html5UploadSupported:function(){var a=new XMLHttpRequest();
return !!(a&&("upload" in a)&&("onprogress" in a.upload))
}};
this["CUI"]=this["CUI"]||{};
this["CUI"]["Templates"]=this["CUI"]["Templates"]||{};
this["CUI"]["Templates"]["alert"]=Handlebars.template(function(g,h,d,b,e){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,g.helpers);
e=e||{};
var a="",c,f="function";
a+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details  \n\n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                    \n                                                                          \n-->\n<button class="close" data-dismiss="alert">&times;</button>\n<strong>';
if(c=d.heading){c=c.call(h,{hash:{},data:e})
}else{c=h.heading;
c=typeof c===f?c.apply(h):c
}if(c||c===0){a+=c
}a+="</strong><div>";
if(c=d.content){c=c.call(h,{hash:{},data:e})
}else{c=h.content;
c=typeof c===f?c.apply(h):c
}if(c||c===0){a+=c
}a+="</div>";
return a
});
this["CUI"]["Templates"]["badge"]=Handlebars.template(function(d,j,c,i,h){this.compilerInfo=[4,">= 1.0.0"];
c=this.merge(c,d.helpers);
h=h||{};
var f="",a,k=this,e="function",g=this.escapeExpression;
function b(m,l){return" empty"
}f+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n\n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<div class="badge';
a=c.unless.call(j,j.value,{hash:{},inverse:k.noop,fn:k.program(1,b,h),data:h});
if(a||a===0){f+=a
}f+='">';
if(a=c.value){a=a.call(j,{hash:{},data:h})
}else{a=j.value;
a=typeof a===e?a.apply(j):a
}f+=g(a)+"</div>";
return f
});
this["CUI"]["Templates"]["header"]=Handlebars.template(function(e,j,d,i,h){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,e.helpers);
i=this.merge(i,e.partials);
h=h||{};
var g="",b,f="function",l=this;
function c(p,o){var m="",n;
m+='<div class="logo">';
if(n=d.logo){n=n.call(p,{hash:{},data:o})
}else{n=p.logo;
n=typeof n===f?n.apply(p):n
}if(n||n===0){m+=n
}m+="</div>";
return m
}function a(o,n){var m;
m=l.invokePartial(i.header_navItem,"header_navItem",o,d,i,n);
if(m||m===0){return m
}else{return""
}}function k(p,o){var m="",n;
m+='<div class="drawer">';
n=l.invokePartial(i.header_drawer,"header_drawer",p.drawer,d,i,o);
if(n||n===0){m+=n
}m+="</div>";
return m
}g+="<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n";
b=d["if"].call(j,j.logo,{hash:{},inverse:l.noop,fn:l.program(1,c,h),data:h});
if(b||b===0){g+=b
}g+='\n<nav role="tablist">';
b=d.each.call(j,j.navItems,{hash:{},inverse:l.noop,fn:l.program(3,a,h),data:h});
if(b||b===0){g+=b
}g+="</nav>\n";
b=d["if"].call(j,j.drawer,{hash:{},inverse:l.noop,fn:l.program(5,k,h),data:h});
if(b||b===0){g+=b
}return g
});
this["CUI"]["Templates"]["header_drawer"]=Handlebars.template(function(d,h,c,g,f){this.compilerInfo=[4,">= 1.0.0"];
c=this.merge(c,d.helpers);
g=this.merge(g,d.partials);
f=f||{};
var e="",a,i=this;
function b(l,k){var j;
j=i.invokePartial(g.badge,"badge",l.badge,c,g,k);
if(j||j===0){return j
}else{return""
}}e+="<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n";
a=c["if"].call(h,h.badge,{hash:{},inverse:i.noop,fn:i.program(1,b,f),data:f});
if(a||a===0){e+=a
}return e
});
this["CUI"]["Templates"]["header_navItem"]=Handlebars.template(function(e,k,d,j,i){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,e.helpers);
i=i||{};
var g="",b,f="function",h=this.escapeExpression,n=this;
function c(r,q){var o="",p;
o+=' id="';
if(p=d.id){p=p.call(r,{hash:{},data:q})
}else{p=r.id;
p=typeof p===f?p.apply(r):p
}o+=h(p)+'"';
return o
}function a(r,q){var o="",p;
o+=' aria-owns="';
if(p=d.owns){p=p.call(r,{hash:{},data:q})
}else{p=r.owns;
p=typeof p===f?p.apply(r):p
}o+=h(p)+'"';
return o
}function m(p,o){return'aria-selected="true" class="selected"'
}function l(p,o){return'aria-selected="false"'
}g+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<a href="';
if(b=d.url){b=b.call(k,{hash:{},data:i})
}else{b=k.url;
b=typeof b===f?b.apply(k):b
}g+=h(b)+'" role="tab"';
b=d["if"].call(k,k.id,{hash:{},inverse:n.noop,fn:n.program(1,c,i),data:i});
if(b||b===0){g+=b
}b=d["if"].call(k,k.owns,{hash:{},inverse:n.noop,fn:n.program(3,a,i),data:i});
if(b||b===0){g+=b
}g+=" ";
b=d["if"].call(k,k.selected,{hash:{},inverse:n.program(7,l,i),fn:n.program(5,m,i),data:i});
if(b||b===0){g+=b
}g+='">';
if(b=d.label){b=b.call(k,{hash:{},data:i})
}else{b=k.label;
b=typeof b===f?b.apply(k):b
}g+=h(b)+"</a>";
return g
});
this["CUI"]["Templates"]["modal"]=Handlebars.template(function(g,h,d,b,e){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,g.helpers);
e=e||{};
var a="",c,f="function";
a+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<div class="modal-header">\n  <h2>';
if(c=d.heading){c=c.call(h,{hash:{},data:e})
}else{c=h.heading;
c=typeof c===f?c.apply(h):c
}if(c||c===0){a+=c
}a+='</h2>\n  <button type="button" class="close" data-dismiss="modal">&times;</button>\n</div>\n<div class="modal-body">';
if(c=d.content){c=c.call(h,{hash:{},data:e})
}else{c=h.content;
c=typeof c===f?c.apply(h):c
}if(c||c===0){a+=c
}a+='</div>\n<div class="modal-footer">';
if(c=d.buttons){c=c.call(h,{hash:{},data:e})
}else{c=h.buttons;
c=typeof c===f?c.apply(h):c
}if(c||c===0){a+=c
}a+="</div>";
return a
});
this["CUI"]["Templates"]["tabs"]=Handlebars.template(function(e,i,d,h,g){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,e.helpers);
h=this.merge(h,e.partials);
g=g||{};
var f="",b,j=this;
function c(n,m){var k="",l;
k+="\n    ";
l=j.invokePartial(h.tabs_tab,"tabs_tab",n,d,h,m);
if(l||l===0){k+=l
}k+="\n  ";
return k
}function a(n,m){var k="",l;
k+="\n";
l=j.invokePartial(h.tabs_panel,"tabs_panel",n,d,h,m);
if(l||l===0){k+=l
}k+="\n";
return k
}f+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<nav role="tablist">\n  ';
b=d.each.call(i,i.tabs,{hash:{},inverse:j.noop,fn:j.program(1,c,g),data:g});
if(b||b===0){f+=b
}f+="\n</nav>\n";
b=d.each.call(i,i.tabs,{hash:{},inverse:j.noop,fn:j.program(3,a,g),data:g});
if(b||b===0){f+=b
}return f
});
this["CUI"]["Templates"]["tabs_panel"]=Handlebars.template(function(e,k,d,j,i){this.compilerInfo=[4,">= 1.0.0"];
d=this.merge(d,e.helpers);
i=i||{};
var g="",b,f="function",h=this.escapeExpression,m=this;
function c(q,p){var n="",o;
n+='id="';
if(o=d.id){o=o.call(q,{hash:{},data:p})
}else{o=q.id;
o=typeof o===f?o.apply(q):o
}n+=h(o)+'" aria-labelledby="';
if(o=d.id){o=o.call(q,{hash:{},data:p})
}else{o=q.id;
o=typeof o===f?o.apply(q):o
}n+=h(o)+'"';
return n
}function a(o,n){return'class="active"'
}function l(o,n){return'aria-disabled="true"'
}g+="<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<section ";
b=d["if"].call(k,k.id,{hash:{},inverse:m.noop,fn:m.program(1,c,i),data:i});
if(b||b===0){g+=b
}g+=' role="tabpanel" ';
b=d["if"].call(k,k.active,{hash:{},inverse:m.noop,fn:m.program(3,a,i),data:i});
if(b||b===0){g+=b
}g+=" ";
b=d["if"].call(k,k.disabled,{hash:{},inverse:m.noop,fn:m.program(5,l,i),data:i});
if(b||b===0){g+=b
}g+=">";
if(b=d.content){b=b.call(k,{hash:{},data:i})
}else{b=k.content;
b=typeof b===f?b.apply(k):b
}g+=h(b)+"</section>";
return g
});
this["CUI"]["Templates"]["tabs_tab"]=Handlebars.template(function(d,o,m,h,r){this.compilerInfo=[4,">= 1.0.0"];
m=this.merge(m,d.helpers);
r=r||{};
var n="",e,b="function",a=this.escapeExpression,l=this;
function k(u,t){var s;
if(s=m.remote){s=s.call(u,{hash:{},data:t})
}else{s=u.remote;
s=typeof s===b?s.apply(u):s
}return a(s)
}function j(v,u){var s="",t;
s+="#";
t=m["if"].call(v,v.id,{hash:{},inverse:l.noop,fn:l.program(4,i,u),data:u});
if(t||t===0){s+=t
}return s
}function i(u,t){var s;
if(s=m.id){s=s.call(u,{hash:{},data:t})
}else{s=u.id;
s=typeof s===b?s.apply(u):s
}return a(s)
}function g(u,t){var s;
s=m["if"].call(u,u.remote,{hash:{},inverse:l.noop,fn:l.program(7,f,t),data:t});
if(s||s===0){return s
}else{return""
}}function f(v,u){var s="",t;
s+='data-target="#';
if(t=m.id){t=t.call(v,{hash:{},data:u})
}else{t=v.id;
t=typeof t===b?t.apply(v):t
}s+=a(t)+'"';
return s
}function c(t,s){return'class="active" aria-selected="true"'
}function q(t,s){return'aria-selected="false"'
}function p(t,s){return'class="disabled" aria-disabled="true"'
}n+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<a href="';
e=m["if"].call(o,o.remote,{hash:{},inverse:l.program(3,j,r),fn:l.program(1,k,r),data:r});
if(e||e===0){n+=e
}n+='" ';
e=m["if"].call(o,o.id,{hash:{},inverse:l.noop,fn:l.program(6,g,r),data:r});
if(e||e===0){n+=e
}n+=' data-toggle="tab" role="tab" ';
e=m["if"].call(o,o.active,{hash:{},inverse:l.program(11,q,r),fn:l.program(9,c,r),data:r});
if(e||e===0){n+=e
}n+=" ";
e=m["if"].call(o,o.disabled,{hash:{},inverse:l.noop,fn:l.program(13,p,r),data:r});
if(e||e===0){n+=e
}n+=">";
if(e=m.label){e=e.call(o,{hash:{},data:r})
}else{e=o.label;
e=typeof e===b?e.apply(o):e
}n+=a(e)+"</a>";
return n
});
this["CUI"]["Templates"]["toolbar"]=Handlebars.template(function(c,i,b,h,g){this.compilerInfo=[4,">= 1.0.0"];
b=this.merge(b,c.helpers);
g=g||{};
var e="",a,d="function",f=this.escapeExpression;
e+='<!-- \n  *** DEPRECATION WARNING ***\n\n  Use of Handlebars.js is deprecated.  Coral UI will no longer natively \n  support Handlebars.js templates in an upcoming version.  Please fix this \n  implementation and remove this warning.\n\n  See https://issues.adobe.com/browse/CUI-1025 for details\n  \n  TODO: remove use of handlebars templates\n  see https://issues.adobe.com/browse/CUI-1098                       \n                                                                          \n-->\n<nav class="toolbar">\n  <div class="left">\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(i,{hash:{},data:g})
}else{a=i.actionName;
a=typeof a===d?a.apply(i):a
}e+=f(a)+">";
if(a=b.actionTitle){a=a.call(i,{hash:{},data:g})
}else{a=i.actionTitle;
a=typeof a===d?a.apply(i):a
}e+=f(a)+'</a>\n    <span class="divider"></span>\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(i,{hash:{},data:g})
}else{a=i.actionName;
a=typeof a===d?a.apply(i):a
}e+=f(a)+">";
if(a=b.actionTitle){a=a.call(i,{hash:{},data:g})
}else{a=i.actionTitle;
a=typeof a===d?a.apply(i):a
}e+=f(a)+'</a>\n  </div>\n  <div class="center">\n    <h1>';
if(a=b.heading){a=a.call(i,{hash:{},data:g})
}else{a=i.heading;
a=typeof a===d?a.apply(i):a
}e+=f(a)+'</h1>\n  </div>\n  <div class="right">\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(i,{hash:{},data:g})
}else{a=i.actionName;
a=typeof a===d?a.apply(i):a
}e+=f(a)+">";
if(a=b.actionTitle){a=a.call(i,{hash:{},data:g})
}else{a=i.actionTitle;
a=typeof a===d?a.apply(i):a
}e+=f(a)+'</a>\n    <a href="#" class="icon-';
if(a=b.actionName){a=a.call(i,{hash:{},data:g})
}else{a=i.actionName;
a=typeof a===d?a.apply(i):a
}e+=f(a)+">";
if(a=b.actionTitle){a=a.call(i,{hash:{},data:g})
}else{a=i.actionTitle;
a=typeof a===d?a.apply(i):a
}e+=f(a)+"</a>\n  </div>\n</nav>";
return e
});
(function(b,a,c){CUI.Widget=new Class({toString:"Widget",construct:function(d){this.options=b.extend({},typeof this.defaults==="object"&&this.defaults,d);
this.$element=b(d.element);
this.$element.data(CUI.util.decapitalize(this.toString()),this);
this.bind(this.hide);
this.bind(this.show);
this.bind(this.toggleVisibility);
this.on("change:visible",function(e){this[e.value?"_show":"_hide"]()
}.bind(this))
},set:function(d,f){if(b.isPlainObject(d)){for(var e in d){this._set(e,d[e])
}}else{this._set(d,f)
}return this
},_set:function(d,f){var g=b.Event("beforeChange:"+d,{widget:this,option:d,currentValue:this.options[d],value:f});
this.$element.trigger(g);
if(g.isDefaultPrevented()){return this
}this.options[d]=f;
g=b.Event("change:"+d,{widget:this,option:d,value:f});
this.$element.trigger(g)
},get:function(d){return this.options[d]
},on:function(e,d){this.$element.on.apply(this.$element,arguments);
return this
},off:function(e,d){this.$element.off.apply(this.$element,arguments);
return this
},show:function(d){d=d||{};
if(this.options.visible){return this
}if(!d.silent){var f=b.Event("show");
this.$element.trigger(f);
if(f.isDefaultPrevented()){return this
}}this.options.visible=true;
this._show(d);
return this
},_show:function(d){this.$element.show()
},hide:function(d){d=d||{};
if(!this.options.visible){return this
}if(!d.silent){var f=b.Event("hide");
this.$element.trigger(f);
if(f.isDefaultPrevented()){return this
}}this.options.visible=false;
this._hide(d);
return this
},_hide:function(d){this.$element.hide()
},toggleVisibility:function(){return this[!this.options.visible?"show":"hide"]()
},setName:function(d){this.toString=function(){return d
};
return this
}});
CUI.Widget.fromElement=function(e,d){return d.data(CUI.util.decapitalize(e.toString()))
};
CUI.Widget.registry={register:function(d,e){CUI.util.plugClass(e);
this._widgets[d]=e;
e.init=function(f){this._init(e,f)
}.bind(this)
},resolve:function(d){return this._widgets[d]
},init:function(d,e){this._init(this.resolve(d),e)
},getSelectors:function(){var e=[];
for(var d in this._widgets){e.push(d)
}return e
},_widgets:{},_init:function(e,d){if(e!==c){if(CUI.Widget.fromElement(e,d)===c){d[CUI.util.decapitalize(e.toString())]()
}}}}
}(jQuery,this));
(function(b,a,c){CUI.Modal=new Class({toString:"Modal",extend:CUI.Widget,construct:function(d){if(this.$element.children().length===0){this.$element.html(CUI.Templates.modal(b.extend({},this.options,{buttons:""})))
}this.$element.addClass("modal");
this.header=this.$element.find(".modal-header");
this.body=this.$element.find(".modal-body");
this.footer=this.$element.find(".modal-footer");
this._previousFocus=b();
this.backdrop=b("<div/>",{"class":"modal-backdrop",style:"display: none;"}).fipo("tap","click",function(e){if(this.options.backdrop!=="static"){this.hide()
}}.bind(this));
this.body.loadWithSpinner(this.options.remote);
this.applyOptions();
this.$element.on("change:heading",this._setHeading.bind(this)).on("change:header",this._setHeader.bind(this)).on("change:content",this._setContent.bind(this)).on("change:buttons",this._setFooter.bind(this)).on("change:type",this._setType.bind(this)).on("change:fullscreen",this._setFullscreen.bind(this)).fipo("tap","click",'[data-dismiss="modal"]',this.hide.bind(this));
this._makeAccessible()
},defaults:{backdrop:"static",visible:true,type:"default",fullscreen:false,attachToBody:true},_types:["default","error","notice","success","help","info"],applyOptions:function(){this._setHeader();
this._setHeading();
this._setContent();
this._setFooter();
this._setType();
this._setFullscreen();
if(this.options.visible){this.options.visible=false;
this.show()
}},_makeAccessible:function(){var d=this,e="modal-header"+new Date().getTime()+"-";
this.$element.attr({role:"dialog","aria-hidden":!this.options.visible,"aria-labelledby":e+"label","aria-describedby":e+"message",tabindex:-1});
this.header.find("h2").attr({id:e+"label",tabindex:0});
this.body.attr({id:e+"message",role:"document",tabindex:0});
this.$element.on("keydown",":focusable",function(h){var g=b(h.currentTarget),f=d.$element.find(":tabbable"),i;
switch(h.which){case 9:if(h.shiftKey&&h.currentTarget===f[0]){i=f.last()
}else{if(!h.shiftKey&&h.currentTarget===f[f.length-1]){i=f.first()
}}break
}if(i){h.preventDefault();
i.trigger("focus")
}})
},_setType:function(){if(!this.options.type){return
}this.$element.removeClass(this._types.join(" "));
if(this.options.type!=="default"){this.$element.addClass(this.options.type)
}},_setHeader:function(){if(!this.options.header){return
}this.header.find("h2").html(this.options.header)
},_setHeading:function(){if(!this.options.heading){return
}this.options.header=this.options.heading;
this._setHeader.apply(this,arguments)
},_setContent:function(){if(!this.options.content){return
}this.body.html(this.options.content)
},_setFooter:function(){if(!b.isArray(this.options.buttons)){return
}var d=this;
this.footer.empty();
b.each(this.options.buttons,function(e,g){var f=g.href?b("<a/>",{"class":"button"}):b("<button/>",{type:"button"});
f.html(g.label);
if(g.click==="hide"){f.attr("data-dismiss","modal")
}else{if(b.isFunction(g.click)){f.fipo("tap","click",g.click.bind(d,{dialog:d}))
}}if(g.href){f.attr("href",g.href)
}if(g.className){f.addClass(g.className)
}d.footer.append(f)
})
},_setFullscreen:function(){if(this.options.fullscreen){this.$element.addClass("fullscreen")
}else{this.$element.removeClass("fullscreen")
}},_show:function(){var d=b("body"),f,e=this;
this._previousFocus=b(":focus");
this._previousFocus.trigger("blur");
d.addClass("modal-open");
this.center();
this.$element.trigger("beforeshow");
this._toggleBackdrop(true);
if(this.options.attachToBody){if(this.$element.parent("body").length===0){this.$element.appendTo(d)
}this.$element.siblings("[aria-hidden]").each(function(g,h){b(h).data("aria-hidden",b(h).attr("aria-hidden"))
});
this.$element.siblings().not("script, link, style").attr("aria-hidden",this.options.visible)
}this.$element.attr("aria-hidden",!this.options.visible);
this.$element.fadeIn();
this.$element.find(":tabbable:not(.modal-header .close):first").focus();
f=b('<div class="cui-modal-tabcapture" tabindex="0"/>');
f.on("focus.modal-tabcapture",function(j){var i=e.$element.find(":tabbable"),h=b("body > .cui-modal-tabcapture"),g=h.last(),k;
if(j.currentTarget===g[0]){k=i.filter(":not(.modal-header .close):last")
}else{k=i.filter(":not(.modal-header .close):first")
}if(k.length===0){k=e.$element
}k.trigger("focus")
}).prependTo(d).clone(true).appendTo(d);
b(document).on("keydown.modal-escape",this._escapeKeyHandler.bind(this));
return this
},_hide:function(){b("body").removeClass("modal-open").find(".cui-modal-tabcapture").off("focus.modal-tabcapture").remove();
b(document).off("keydown.modal-escape");
this.$element.trigger("beforehide");
this._toggleBackdrop(false);
this.$element.attr("aria-hidden",!this.options.visible);
this.$element.siblings().removeAttr("aria-hidden").filter(':data("aria-hidden")').each(function(d,e){b(e).attr("aria-hidden",b(e).data("aria-hidden")).removeData("aria-hidden")
});
this.$element.fadeOut().trigger("blur");
this._previousFocus.trigger("focus");
return this
},center:function(){var e=this.$element.outerWidth(),d=this.$element.outerHeight();
this.$element.css({"margin-left":-(e/2),"margin-top":-(d/2)})
},_toggleBackdrop:function(e){if(!this.options.backdrop){return
}var d=b("body");
if((e||this.backdrop.is(":hidden"))&&e!==false){this.backdrop.appendTo(d).fadeIn()
}else{this.backdrop.fadeOut(function(){b(this).detach()
})
}},_escapeKeyHandler:function(d){if(d.which===27){this.hide()
}}});
CUI.Widget.registry.register("modal",CUI.Modal);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(d){CUI.Modal.init(b("[data-init~=modal]",d.target))
});
b(document).fipo("tap.modal.data-api","click.modal.data-api",'[data-toggle="modal"]',function(k){var g=b(this);
var f=CUI.util.getDataTarget(g);
var i=g.attr("href");
var j=b.extend({remote:!/#/.test(i)&&i},f.data(),g.data());
if(typeof j.buttons==="string"){j.buttons=JSON.parse(j.buttons)
}var d=f.data("modal");
var h=true;
if(d&&d.get("visible")){h=false
}f.modal(j);
if(d){f.data("modal").set({visible:h})
}k.preventDefault()
}).finger("click.modal.data-api",'[data-toggle="modal"]',false)
}}(jQuery,this));
(function(b,a,c){CUI.Tabs=new Class({toString:"Tabs",extend:CUI.Widget,construct:function(d){this.tablist=this.$element.find("> nav");
this._applyOptions();
this.$element.on("change:type",this._setType.bind(this));
this.$element.on("change:active",this._setActive.bind(this))
},defaults:{},DEFAULT_VARIANT_KEY:"default",WHITE_VARIANT_CLASS:"white",STACKED_VARIANT_CLASS:"stacked",NAV_VARIANT_CLASS:"nav",VARIANT_TYPES:["default","white","stacked","nav"],setDisabled:function(e,f){var d=f||false;
e.toggleClass("disabled",d).prop("aria-disabled",d);
return this
},setEnabled:function(d){return this.setDisabled(d,true)
},addItem:function(e){var f=this._getTabs();
e=b.extend({tabContent:"",panelContent:"",panelID:c,panelURL:c,index:f.length,enabled:true,active:true},e);
var h=b("<section/>").append(e.panelContent);
if(e.panelID!==c){h.attr("id",e.panelID)
}var g=b('<a data-toggle="tab"/>').append(e.tabContent);
if(e.panelURL!==c){g.attr("href",e.panelURL)
}var d=Math.min(Math.max(e.index,0),f.length);
if(d===0){this.tablist.prepend(g);
this.tablist.after(h)
}else{f.eq(d-1).after(g);
this._getPanels().eq(d-1).after(h)
}if(!e.enabled){g.addClass("disabled")
}this._makeTabsAccessible(g);
if(e.active&&e.enabled){this._activateTab(g,true)
}return h.attr("id")
},removeItem:function(j){var d=this._getTabs(),g=this._getPanels(),h,i;
if(typeof j==="number"){h=d.eq(j);
i=g.eq(j)
}else{if(typeof j==="string"){h=d.filter('[aria-controls="'+j+'"]');
i=g.filter("#"+j)
}}if(!h||!i){return
}if(h.hasClass("active")){var f='a[data-toggle="tab"]:not(.disabled)';
var e=h.nextAll(f).first();
if(e.length===0){e=h.prevAll(f).first()
}if(e.length===1){this._activateTab(e,true)
}}i.remove();
h.remove()
},_applyOptions:function(){var d=this._getTabs().filter(".active");
if(this.options.type){this._setType(this.options.type)
}this._initTabswitch();
this._makeAccessible();
if(d.length===0){this._setActive(this.options.active||0)
}else{this._activateTab(d,true)
}},_getTabs:function(){return this.tablist.find('> a[data-toggle="tab"]')
},_getPanels:function(){return this.$element.find("> section")
},_setActive:function(e){e=b.isNumeric(e)?e:this.options.active;
var d=this._getTabs().eq(e);
this._activateTab(d,true)
},_setType:function(d){var e=b.type(d)==="string"?d:this.options.type;
if(this.VARIANT_TYPES.indexOf(e)>-1||e===this.DEFAULT_VARIANT_KEY){this.$element.removeClass(this.VARIANT_TYPES.join(" "));
if(e!==this.DEFAULT_VARIANT_KEY){this.$element.addClass(e)
}}},_activateTab:function(i,j){var e=i.attr("href"),h="active",g=this._getTabs(),f=this._getPanels(),d;
if(i.hasClass("disabled")){i.blur();
return false
}d=f.filter("#"+i.attr("aria-controls"));
if(e&&e.charAt(0)!=="#"){d.loadWithSpinner(e)
}g.removeClass(h).attr({"aria-selected":false,tabindex:-1});
f.removeClass(h).attr({"aria-hidden":true});
i.addClass(h).attr({"aria-selected":true,tabindex:0});
d.addClass(h).attr({"aria-hidden":false});
if(!j){i.trigger("focus")
}},_initTabswitch:function(){var d=this,e='> nav > a[data-toggle="tab"]';
this.$element.fipo("tap","click",e,function(g){var f=b(g.currentTarget);
g.preventDefault();
d._activateTab(f)
}).finger("click",e,false)
},_makeAccessible:function(){this._makeTabsAccessible();
this._makeTablistAccessible()
},_makeTabsAccessible:function(d){var e=this._getPanels();
d=d||this._getTabs();
d.each(function(g,j){var h=b(j),k=e.eq(h.index()),l=k.attr("id")||CUI.util.getNextId();
var f={role:"tab",tabindex:-1,"aria-selected":false,"aria-controls":l,"aria-disabled":h.hasClass("disabled")};
if(!h.attr("href")){f.href="#"
}h.attr(f);
k.attr({id:l,role:"tabpanel","aria-hidden":true})
})
},_makeTablistAccessible:function(){var d=this,e='> [role="tab"]';
this.tablist.attr("role","tablist");
this.tablist.on("keydown",e,function(i){var h=b(i.currentTarget),g=b(i.delegateTarget).find(e).not('[aria-disabled="true"]'),k=h,j=true,f=g.index(h);
switch(i.which){case 33:case 37:case 38:k=f-1>-1?g[f-1]:g[g.length-1];
break;
case 34:case 39:case 40:k=f+1<g.length?g[f+1]:g[0];
break;
case 36:k=g[0];
break;
case 35:k=g[g.length-1];
break;
default:j=false;
break
}if(j){i.preventDefault();
d._activateTab(b(k))
}})
}});
CUI.Widget.registry.register("tabs",CUI.Tabs);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(d){CUI.Tabs.init(b("[data-init~=tabs]",d.target))
})
}}(jQuery,this));
(function(a){CUI.Alert=new Class({toString:"Alert",extend:CUI.Widget,construct:function(b){this.$element.delegate('[data-dismiss="alert"]',"click.dismiss.alert",this.hide);
this.$element.addClass("alert");
this.$element.on("change:heading",this._setHeading.bind(this));
this.$element.on("change:content",this._setContent.bind(this));
this.$element.on("change:type",this._setType.bind(this));
this.$element.on("change:closable",this._setClosable.bind(this));
this.$element.on("change:size",this._setSize.bind(this));
a.each(this._types,function(c,d){if(this.$element.hasClass(d)){this.options.type=d;
return false
}}.bind(this));
a.each(this._sizes,function(c,d){if(this.$element.hasClass(d)){this.options.size=d;
return false
}}.bind(this));
if(this.$element.children().length===0){this.options.type=this._fixType(this.options.type);
this.options.heading=this._fixHeading(this.options.heading);
this.$element.html(CUI.Templates.alert(this.options));
this._setClosable();
this._setType();
this._setSize()
}this._setHeading();
this._setContent()
},defaults:{type:"error",size:"small",heading:undefined,visible:true,closable:true},_types:["error","notice","success","help","info"],_sizes:["small","large"],_setContent:function(){if(typeof this.options.content==="string"){this.$element.find("div").html(this.options.content)
}},_setHeading:function(){if(typeof this.options.content==="string"){this.$element.find("strong").html(this.options.heading)
}},_setType:function(){if(this._isValidType(this.options.type)){this.$element.removeClass(this._types.join(" "));
this.$element.addClass(this.options.type)
}},_setSize:function(){if(this._isValidSize(this.options.size)){if(this.options.size==="small"){this.$element.removeClass("large")
}else{this.$element.addClass("large")
}}},_setClosable:function(){var b=this.$element.find(".close");
if(!b.length){this.$element.prepend('<button class="close" data-dismiss="alert">&times;</button>')
}else{b[this.options.closable?"show":"hide"]()
}},_isValidType:function(b){return typeof b=="string"&&this._types.indexOf(b)>-1
},_isValidSize:function(b){return typeof b=="string"&&this._sizes.indexOf(b)>-1
},_fixType:function(b){return this._isValidType(b)?b:this.defaults.type
},_fixHeading:function(b){return b===undefined?this._fixType(this.options.type).toUpperCase():b
}});
CUI.util.plugClass(CUI.Alert);
if(CUI.options.dataAPI){a(function(){a("body").fipo("tap.alert.data-api","click.alert.data-api",'[data-dismiss="alert"]',function(b){a(b.target).parent().hide();
b.preventDefault()
})
})
}}(window.jQuery));
(function(b,a,c){CUI.Rail=new Class({toString:"Rail",extend:CUI.Widget,construct:function(d){if(!this.$element.hasClass("theme-dark")){this.$element.addClass("theme-dark")
}this.applyOptions()
},applyOptions:function(){this._initFoldable();
if(this.$element.find(".rail-switch").length>0){this._initRailSwitcher()
}this._makeAccessible()
},_show:function(){this.$element.removeClass("closed")
},_hide:function(){this.$element.addClass("closed")
},_initFoldable:function(){var e="open",d="rail-section-foldable-";
this.$element.find("section.foldable").each(function(j,m){var l=b(m),h=l.find(".heading"),f=l.find(".fold"),k=d+(h.attr("href")||(" "+new Date().getTime()+"-"+j)).substring(1),g=l.hasClass(e);
l.attr("role","presentation");
h.attr({role:"button",id:h.attr("id")||k,"aria-controls":f.attr("id")||k+"-fold",tabindex:0,"aria-expanded":g});
f.attr({id:f.attr("id")||k+"-fold","aria-labelledby":h.attr("id"),"aria-hidden":!g,"aria-expanded":g})
});
this.$element.fipo("tap","click","section.foldable .heading",function(i){var h=b(i.currentTarget),j=h.parents(".foldable:first"),f=j.find(".fold"),g=j.toggleClass(e).hasClass(e);
h.attr({"aria-expanded":g});
f.attr({"aria-hidden":!g,"aria-expanded":g});
if(g&&i.type==="tap"){f.attr("tabindex","-1").trigger("focus");
h.trigger("focus");
f.removeAttr("tabindex")
}}).on("keydown","section.foldable .heading:not(button):not(a[href])",function(g){var f=b(g.currentTarget);
switch(g.which){case 13:case 32:f.trigger("click");
break
}})
},_initRailSwitcher:function(){var g="active",e="focus",h="rail-switcher-view-",f=this.$element.find(".rail-switch a"),d=this.$element.find(".rail-view");
f.filter('[href="#"]').each(function(k,m){var l=b(this),n=l.data("view"),j=d.filter('[data-view="'+n+'"]');
l.attr("href","#"+h+n);
j.attr("id",h+n)
});
this.$element.find(".rail-switch nav").attr({role:"tablist"});
f.attr({role:"tab","aria-selected":function(){return b(this).hasClass(g)
},tabindex:function(){return b(this).hasClass(g)?0:-1
},"aria-controls":function(){return b(this).attr("href").substring(1)
}});
d.attr({role:"tabpanel","aria-hidden":function(){return !b(this).hasClass(g)
},"aria-expanded":function(){return b(this).hasClass(g)
},"aria-labelledby":function(){return b(this).attr("id")
}});
this.$element.fipo("tap","click",".rail-switch a",function(k){var i=b(k.currentTarget),l=i.attr("href").substring(1),j=d.filter("#"+l);
k.preventDefault();
d.removeClass(g).attr({"aria-hidden":true,"aria-expanded":false});
f.removeClass(g).attr({"aria-selected":false,tabindex:-1});
i.addClass(g).attr({"aria-selected":true,tabindex:0});
j.addClass(g).attr({"aria-hidden":false,"aria-expanded":true})
});
this.$element.pointer("blur",".rail-switch a",function(i){b(i.currentTarget).removeClass(e)
})
},_makeAccessible:function(){var e="focus";
this.$element.attr("role","complementary");
var d=this.$element.find('[role="tablist"]'),f='[role="tab"]';
d.on("keydown",f,function(j){var i=b(j.currentTarget),h=b(j.delegateTarget).find(f),l=i,k=true,g=h.index(i);
switch(j.which){case 33:case 37:case 38:l=g-1>-1?h[g-1]:h[0];
break;
case 34:case 39:case 40:l=g+1<h.length?h[g+1]:h[h.length-1];
break;
case 36:l=h[0];
break;
case 35:l=h[h.length-1];
break;
default:k=false;
break
}if(k){j.preventDefault();
b(l).addClass(e).trigger("focus").trigger("click")
}})
}});
CUI.Widget.registry.register("rail",CUI.Rail);
if(CUI.options.dataAPI){b(function(){CUI.Rail.init(b("[data-init~=rail]"))
})
}}(jQuery,this));
(function(b){var a=0;
CUI.Popover=new Class({toString:"Popover",extend:CUI.Widget,construct:function(c){this.$element.addClass("popover");
this.$element.on("change:content",this._setContent.bind(this));
this.$element.on("change:pointAt",this._position.bind(this));
this.$element.on("change:pointFrom",this._position.bind(this));
this.$element.on("change:alignFrom",this._position.bind(this));
if(this.$element.html()===""){this._setContent()
}this._createTail();
this.uuid=(a+=1)
},defaults:{pointFrom:"bottom",preventAutoHide:false,alignFrom:"left",visible:false},_directions:["top","bottom","right","left"],_createTail:function(){this._$tail=b('<div class="popover-arrow arrow-left"/>').appendTo(this.$element);
this._cachedTailDimensions={};
this._cachedTailDimensions.leftRight={width:this._$tail.outerWidth(),height:this._$tail.outerHeight()};
this._cachedTailDimensions.topBottom={width:this._cachedTailDimensions.leftRight.height,height:this._cachedTailDimensions.leftRight.width};
this._$tail.removeClass("arrow-left")
},_position:function(){if(!this.options.visible||!this.options.pointAt){return
}var f=this.$element,h=this.options.pointAt,d=this.options.pointFrom,e=this._cachedTailDimensions,c;
if(b.isArray(h)){if(h.length!==2){return
}h=this._convertCoordsToEvent(h)
}var g=function(j,k){var l=f.offsetParent().offset(),i;
if((d=="top"||d=="bottom")&&l.top+j.top<0){i="bottom"
}else{if((d=="left"||d=="right")&&l.left+j.left<0){i="right"
}}if(i){c=this._instructionFactory[i]({target:h,tailDimensions:e,allowFlip:false,callback:this._applyFinalPosition.bind(this)});
f.position(c)
}else{this._applyFinalPosition(j,k)
}}.bind(this);
c=this._instructionFactory[d]({target:h,tailDimensions:e,allowFlip:true,callback:g});
f.position(c)
},_convertCoordsToEvent:function(c){var d=b.Event();
d.pageX=c[0];
d.pageY=c[1];
return d
},_applyFinalPosition:function(c,d){var e={top:c.top};
if(this.options.alignFrom==="right"){var g=this.$element.offsetParent();
var f;
if(g.prop("tagName").toLowerCase()=="html"){g=b("body");
f=g.outerWidth(true)
}else{f=g.innerWidth()
}e.left="auto";
e.right=f-c.left-this.$element.outerWidth(true)
}else{e.left=c.left;
e.right="auto"
}this.$element.css(e);
this._positionTail(d)
},_instructionFactory:{top:function(c){return{my:"center bottom-"+c.tailDimensions.topBottom.height,at:"center top",of:c.target,collision:"fit "+(c.allowFlip?"flip":"none"),using:c.callback}
},right:function(c){return{my:"left+"+c.tailDimensions.leftRight.width+" center",at:"right center",of:c.target,collision:(c.allowFlip?"flip":"none")+" fit",using:c.callback}
},bottom:function(c){return{my:"center top+"+c.tailDimensions.topBottom.height,at:"center bottom",of:c.target,collision:"fit "+(c.allowFlip?"flip":"none"),using:c.callback}
},left:function(c){return{my:"right-"+c.tailDimensions.leftRight.width+" center",at:"left center",of:c.target,collision:(c.allowFlip?"flip":"none")+" fit",using:c.callback}
}},_positionTail:function(j){var e,g=this.$element.offset();
if(b.isArray(this.options.pointAt)){e={top:this.options.pointAt[1],left:this.options.pointAt[0],width:0,height:0}
}else{var f=b(j.target.element).offset();
e={top:f.top,left:f.left,width:j.target.width,height:j.target.height}
}e.top-=(g.top+parseFloat(this.$element.css("borderTopWidth")));
e.left-=(g.left+parseFloat(this.$element.css("borderLeftWidth")));
var i,h,c,d;
switch(this.options.pointFrom){case"top":case"bottom":d=this._cachedTailDimensions.topBottom.width;
h=e.left+e.width/2-d/2;
if(j.vertical=="bottom"){i="arrow-down";
c=e.top-this._cachedTailDimensions.topBottom.height
}else{i="arrow-up";
c=e.top+e.height
}break;
case"left":case"right":d=this._cachedTailDimensions.leftRight.width;
c=e.top+e.height/2-this._cachedTailDimensions.leftRight.height/2;
if(j.horizontal=="left"){i="arrow-left";
h=e.left+e.width
}else{i="arrow-right";
h=e.left-d
}break
}this._$tail.css({top:c,left:h}).removeClass("arrow-up arrow-down arrow-left arrow-right").addClass(i)
},_show:function(){this.$element.show().prop("aria-hidden",false);
this._position();
if(!this.options.preventAutoHide){b("body").fipo("tap.popover-hide-"+this.uuid,"click.popover-hide-"+this.uuid,function(d){var c=this.$element.get(0);
if(d.target!==c&&!b.contains(c,d.target)){this.hide();
b("body").off(".popover-hide-"+this.uuid)
}}.bind(this))
}},_hide:function(){this.$element.hide().prop("aria-hidden",true);
b("body").off(".popover-hide-"+this.uuid)
},_setContent:function(){if(typeof this.options.content!=="string"){return
}this.$element.html(this.options.content);
if(this._$tail){this.$element.append(this._$tail)
}this._position()
},setPosition:function(c){this.set("pointAt",c)
}});
CUI.Widget.registry.register("popover",CUI.Popover);
b(function(){b("body").fipo("tap.popover.data-api","click.popover.data-api",'[data-toggle="popover"]',function(g){var d=b(this),c=CUI.util.getDataTarget(d);
c=c&&c.length>0?c:d.next(".popover");
var f=c.popover(b.extend({pointAt:d},c.data(),d.data())).data("popover");
f.toggleVisibility()
}).on("click.popover.data-api",'[data-toggle="popover"]',false)
})
}(window.jQuery));
(function(a){CUI.DropdownList=new Class({toString:"DropdownList",extend:CUI.Widget,construct:function(c){var b=a('<div class="dropdown-container">');
var d=(this.options.positioningElement)?this.options.positioningElement:this.$element;
d.after(b);
d.detach();
b.append(d);
this.containerElement=b;
this.$element.on("change:options change:optionRenderer",function(e){if(e.widget!==this){return
}this.update()
}.bind(this));
this.$element.on("keydown","",this._keyPressed.bind(this));
this.$element.on("blur","",function(){if(this.preventHiding){this.preventHiding=false;
return
}this.hide()
}.bind(this))
},defaults:{positioningElement:null,position:"below",autoPosition:true,optionRenderer:null,options:["Apples","Pears","Bananas","Strawberries"],cssClass:null,visible:false,scrollBuffer:10,loadingIndicator:"<div class='wait'></div>",noWidth:false},listElement:null,containerElement:null,currentIndex:-1,preventHiding:false,show:function(){this._unrender();
this.currentIndex=-1;
this.$element.focus();
this._render()
},hide:function(b){if(b>0){return setTimeout(this._unrender.bind(this),b)
}else{this._unrender()
}return null
},isVisible:function(){return this.options.visible
},toggle:function(){return this.isVisible()?this.hide():this.show()
},update:function(){if(this.listElement){this._unrender();
this._render()
}},addItems:function(b){var d=this.listElement.find("li").not(".loading-indicator").length;
if(this.listElement){var c=this.listElement.find("ul");
a.each(b,function(g,i){var h=(this.options.optionRenderer)?this.options.optionRenderer(g,i):a("<span>"+i.toString()+"</span>");
var e=a('<li data-id="'+(d+g)+'">');
if(g===this.currentIndex){e.addClass("selected")
}var f=this.options.getOptionClassAttribute(g);
if(f){e.addClass(f)
}e.append(h);
c.append(e);
this.options.options.push(i)
}.bind(this))
}},getNumberOfItems:function(){var b=this.listElement.find("li").not(".loading-indicator").length;
return b
},addLoadingIndicator:function(){if(this.listElement){this.listElement.find("ul").append(a("<li>"+this.options.loadingIndicator+"</li>").addClass("loading-indicator"))
}},removeLoadingIndicator:function(){if(this.listElement){this.listElement.find(".loading-indicator").remove()
}},_keyPressed:function(e){var c=e.keyCode;
if(!this.listElement){return
}var b=this.currentIndex;
if(c===38){e.preventDefault();
if(b>0){b--
}else{b=this.listElement.find("li").length-1
}}if(c===40){e.preventDefault();
if(b<(this.listElement.find("li").length-1)){b++
}else{b=0
}}if(c===27){e.preventDefault();
this.hide();
return
}if(c===13||c===20){e.preventDefault();
if(b>=0){this._triggerSelect(b,e);
return
}}this.currentIndex=b;
var f=this.listElement.find("li");
f.removeClass("selected");
if(b>=0){var d=a(f[b]);
d.addClass("selected");
this._updateScrollPosition(b)
}},_updateScrollPosition:function(b){var c=this.listElement.find(".autocomplete-results").children(":nth-child("+(b+1)+")");
if(this.listElement.length&&c.length){var f=c.position().top,e=this.listElement.scrollTop(),d=0;
if(f+c.height()>this.listElement.height()){d=e;
d+=f+c.outerHeight();
d-=this.listElement.height();
this.listElement.scrollTop(d)
}else{if(f<0){d=e;
d+=f;
this.listElement.scrollTop(d)
}}}},_unrender:function(){if(this.listElement){this.listElement.remove();
this.listElement=null
}this.containerElement.removeClass("dropdown-visible");
this.options.visible=false
},_render:function(){var c=this.options.options,f;
if(c.length===0){return
}var e=a("<ul></ul>");
if(this.options.cssClass){e.addClass(this.options.cssClass)
}a.each(c,function(i,k){var j=(this.options.optionRenderer)?this.options.optionRenderer(i,k):a("<span>"+k.toString()+"</span>");
var g=a('<li data-id="'+i+'">');
if(i===this.currentIndex){g.addClass("selected")
}var h=this.options.getOptionClassAttribute?this.options.getOptionClassAttribute(i):undefined;
if(h){g.addClass(h)
}g.append(j);
e.append(g)
}.bind(this));
e.on("click","li:not(.loading-indicator)",function(g){g.preventDefault();
this._triggerSelect(a(g.target).closest("li").attr("data-id"),g)
}.bind(this));
var d=(this.options.positioningElement)?this.options.positioningElement:this.$element;
var b=a('<div class="dropdown-list">');
b.append(e);
this.listElement=e=b;
e.css({top:0,left:0,visibility:"hidden",display:"block"}).appendTo(document.body);
if(!this.options.noWidth){e.css("width",d.outerWidth(false)+"px")
}f=this._calcPosition();
e.css({top:f.top+"px",left:f.left+"px",visibility:"visible"});
this.containerElement.addClass("dropdown-visible");
e.on("scroll","",function(g){this._listScrolled()
}.bind(this));
e.on("mousedown","",function(g){g.preventDefault();
g.stopPropagation()
}.bind(this));
e.on("focusin","",function(g){this.preventHiding=true
}.bind(this));
e.on("focusout","",function(g){this.preventHiding=false;
this.$element.trigger("blur")
}.bind(this));
this.options.visible=true
},_calcPosition:function(){var f=(this.options.positioningElement)?this.options.positioningElement:this.$element,c=f.offset().top+f.outerHeight(),e=f.offset().top-this.listElement.outerHeight(),i={left:f.offset().left,top:c},b=c+this.listElement.outerHeight()-a(window).scrollTop()<a(window).height(),d=e>a(window).scrollTop(),g=c+this.listElement.outerHeight()<a(document).height(),h=e>0;
i.top=(this.options.position==="above")?e:c;
if(this.options.autoPosition){if(this.options.position==="above"&&!d){i.top=(b||(!h&&g))?c:e
}else{if(this.options.position==="below"&&!b){i.top=(d||(!g&&h))?e:c
}}}return i
},_listScrolled:function(){if(this._reachedListBottom()){this._triggerScrolledBottom()
}},_reachedListBottom:function(){var b=this.listElement;
var c=this.listElement.find("ul");
return(c.height()-b.height()<=b.scrollTop()+this.options.scrollBuffer)
},_triggerSelect:function(b,c){this.$element.focus();
var d=a.Event("dropdown-list:select",{selectedIndex:b,selectedValue:this.options.options[b],source:this,originalEvent:c});
this.$element.trigger(d)
},_triggerScrolledBottom:function(b){var c=a.Event("dropdown-list:scrolled-bottom");
this.$element.trigger(c)
}});
CUI.util.plugClass(CUI.DropdownList)
}(window.jQuery));
(function(a){CUI.Dropdown=new Class({toString:"Dropdown",extend:CUI.Widget,construct:function(b){if(this.options.autocompleteCallback){this.options.editable=true
}this._render();
if(this._isMobile()&&!this.options.editable){this._initForMobile()
}else{this._initForDesktop()
}var c=this.$element.find(">div>button");
if(c.length>0&&c.attr("type")===undefined){c[0].setAttribute("type","button")
}},defaults:{options:[],multiple:false,placeholder:"Select",disabled:false,editable:false,hasError:false,noWidth:false,expandwidth:false,position:"below",autoPosition:true},dropdownList:null,autocompleteList:null,syncSelectElement:null,buttonElement:null,positioningElement:null,inputElement:null,hasFocus:false,_initForMobile:function(){this.$element.addClass("mobile");
this.buttonElement.on("click",function(){this._openSelectInput()
}.bind(this));
this.$element.find("select").on("change",function(){this._update(true)
}.bind(this));
this._placeSelect()
},_initForDesktop:function(){var b;
this.dropdownList=new CUI.DropdownList({element:this.buttonElement,positioningElement:this.positioningElement,position:this.options.position,autoPosition:this.options.autoPosition,options:this.options.options,optionRenderer:this._optionRenderer.bind(this),getOptionClassAttribute:this._getOptionClassAttribute.bind(this),noWidth:this.options.noWidth});
if(this.options.editable){this.autocompleteList=new CUI.DropdownList({element:this.inputElement,positioningElement:this.positioningElement,position:this.options.position,autoPosition:this.options.autoPosition,options:this.options.options,optionRenderer:this._optionRendererAutocomplete.bind(this),getOptionClassAttribute:this._getOptionClassAttribute.bind(this),noWidth:this.options.noWidth,cssClass:"autocomplete-results"})
}else{if(this.options.expandwidth){if(this.options.options.length!==0){b=this._getTextWidthFromOptions(this.options.options)
}this.buttonElement.width(b)
}}this.buttonElement.on("dropdown-list:select",this._processSelect.bind(this));
this.buttonElement.on("mousedown","",function(c){c.preventDefault();
if(this.autocompleteList!==null){this._adjustAutocompleter()
}else{this.dropdownList.toggle()
}}.bind(this));
this.buttonElement.on("mouseup","",function(c){c.preventDefault()
}.bind(this));
this.inputElement.on("click","",function(){if(this.autocompleteList!==null){this._adjustAutocompleter()
}}.bind(this));
this.inputElement.on("input","",function(){if(this.autocompleteList!==null){this._adjustAutocompleter({toggleList:false})
}}.bind(this));
this.inputElement.on("dropdown-list:select","",function(c){this._processSelect(c)
}.bind(this));
this.$element.children().on("focus","",function(){this.hasFocus=true;
this._update()
}.bind(this));
this.$element.children().on("blur","",function(){this.hasFocus=false;
this._update()
}.bind(this));
this.$element.find("select").on("change",function(){this._update(true)
}.bind(this))
},_placeSelect:function(){var b=this.$element.find("select").first();
b.css({position:"absolute",left:0,top:0,right:0,bottom:0,width:"auto",height:"auto"})
},_openSelectInput:function(){var b=this.$element.find("select")[0];
if(document.createEvent){var c=document.createEvent("MouseEvents");
c.initMouseEvent("mousedown",true,true,window,0,0,0,0,0,false,false,false,false,0,null);
b.dispatchEvent(c)
}else{if(b.fireEvent){b.fireEvent("onmousedown")
}}},_getTextWidthFromOptions:function(d){var f={position:"absolute",visibility:"hidden",width:"auto",height:"auto"},c=a(this.buttonText).clone().css(f).empty().appendTo(a(this.buttonElement)),g=0,e;
function b(h,i){h.text(i);
return h.width()
}if(d.length!==0){a.each(d,function(){e=b(c,this);
g=(e>g)?e:g
})
}c.remove();
g+=parseInt(this.buttonText.css("padding-left"),10)+parseInt(this.buttonText.css("padding-right"),10);
g+=parseInt(this.buttonText.css("margin-left"),10)+parseInt(this.buttonText.css("margin-right"),10);
g+=parseInt(this.buttonText.css("borderLeftWidth"),10)+parseInt(this.buttonText.css("borderRightWidth"),10);
return g
},_adjustAutocompleter:function(e){var c=this.inputElement.val();
var g={toggleList:true};
var d=a.extend(g,e);
var f=function(i,h){this.autocompleteList.set({options:i});
if(d.toggleList){this.autocompleteList.toggle()
}else{this.autocompleteList.show()
}}.bind(this);
if(this.options.autocompleteCallback){this.options.autocompleteCallback(f,c)
}else{var b=[];
a.each(this.options.options,function(h,i){if(i.toLowerCase().indexOf(c.toLowerCase(),0)>=0){b.push(i)
}});
f(b,c)
}},_optionRenderer:function(b,d){var c=a("<span>"+d+"</span>");
if(this.options.multiple){var e=a('<div class="checkbox">');
if(this.syncSelectElement&&a(this.syncSelectElement.find("option").get(b)).attr("selected")){e.addClass("checked")
}c.prepend(e)
}return c
},_optionRendererAutocomplete:function(c,e){var b=this.inputElement.val();
var d=e.toLowerCase().indexOf(b.toLowerCase());
if(d>=0){e=e.substr(0,d)+"<em>"+e.substr(d,b.length)+"</em>"+e.substr(d+b.length)
}return a("<span>"+e+"</span>")
},_getOptionClassAttribute:function(b){return(this.syncSelectElement)?a(this.syncSelectElement.find("option").get(b)).data("itemclass"):""
},_processSelect:function(c){if(this.syncSelectElement){var d=c.selectedValue;
var e=null;
if(c.source===this.autocompleteList){this.syncSelectElement.find("option").each(function(){if(a(this).attr("value")===d){e=a(this)
}});
if(e===null){e=a("<option>");
e.attr("value",d).text(d);
this.syncSelectElement.append(e)
}this.autocompleteList.hide()
}else{e=a(this.syncSelectElement.find("option").get(c.selectedIndex));
d=e.attr("value")
}if(this.options.multiple){var b=this.syncSelectElement.val();
if(b===null){b=[]
}if(b.indexOf(d)>=0){b.splice(b.indexOf(d),1)
}else{b.push(d)
}this.syncSelectElement.val(b);
this.dropdownList.update()
}else{this.syncSelectElement.val(d);
this.dropdownList.hide()
}this.syncSelectElement.change()
}this._update(true)
},_render:function(){this._readDataFromMarkup();
if(this.$element.get(0).tagName!=="DIV"){var b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.append(this.$element);
this.$element=b
}this._createMissingElements();
this.buttonElement=this.$element.find("button");
this.syncSelectElement=this.$element.find("select");
this.inputElement=this.$element.find("input");
this.positioningElement=(this.options.editable)?this.$element:this.buttonElement;
if(!this.options.editable){this.buttonText=a(this.buttonElement).wrapInner("<span />").find("span")
}if(!this.inputElement.attr("name")){this.inputElement.attr("name",this.syncSelectElement.attr("name")+".edit")
}if(this.syncSelectElement.attr("multiple")){this.options.multiple=true
}this.$element.addClass("dropdown");
if(this.options.editable){this.$element.addClass("dropdown-editable")
}if(this.$element.find("select option").length>0&&this.options.options.length===0){this.options.options=[];
this.$element.find("select option").each(function(c,d){this.options.options.push(a(d).html())
}.bind(this))
}if(this.options.multiple){this.syncSelectElement.attr("multiple","multiple")
}else{this.syncSelectElement.removeAttr("multiple","multiple")
}if(this.options.placeholder){if(!this.options.editable){this.buttonText.text(this.options.placeholder)
}else{this.buttonElement.text(this.options.placeholder)
}this.inputElement.attr("placeholder",this.options.placeholder)
}this._update(true)
},_readDataFromMarkup:function(){if(this.$element.attr("disabled")){this.options.disabled=true
}if(this.$element.attr("data-disabled")){this.options.disabled=true
}if(this.$element.attr("multiple")){this.options.multiple=true
}if(this.$element.attr("data-multiple")){this.options.multiple=true
}if(this.$element.attr("placeholder")){this.options.placeholder=this.$element.attr("placeholder")
}if(this.$element.attr("data-placeholder")){this.options.placeholder=this.$element.attr("data-placeholder")
}if(this.$element.attr("data-editable")){this.options.editable=true
}if(this.$element.attr("data-error")){this.options.hasError=true
}if(this.$element.hasClass("error")){this.options.hasError=true
}if(this.$element.attr("data-nowidth")){this.options.noWidth=true
}if(this.$element.attr("data-expandwidth")){this.options.expandwidth=true
}},_createMissingElements:function(){if(this.$element.find("button").length===0){var d=a("<button/>",{text:this.options.placeholder,type:"button"});
d.addClass("dropdown");
this.$element.append(d)
}if(this.options.editable&&this.$element.find("input").length===0){var c=a('<input type="text">');
this.$element.prepend(c)
}if(this.$element.find("select").length===0){var b=a("<select>");
this.$element.append(b)
}},_update:function(e){if(e){if(this.syncSelectElement&&!this.options.multiple){var d=this.syncSelectElement.find("option:selected");
if(d){var b=d.index();
var f=d.text();
var c=d.html();
if(this.inputElement.length>0){this.inputElement.val(f).trigger("change")
}else{this.buttonText.html(c)
}}}}if(this.options.disabled){this.buttonElement.attr("disabled","disabled");
this.inputElement.attr("disabled","disabled")
}else{this.buttonElement.removeAttr("disabled");
this.inputElement.removeAttr("disabled")
}if(this.hasFocus){this.$element.addClass("focus")
}else{this.$element.removeClass("focus")
}if(this.options.hasError){this.$element.addClass("error")
}else{this.$element.removeClass("error")
}},_isMobile:function(){return typeof window.ontouchstart==="object"
}});
CUI.util.plugClass(CUI.Dropdown);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~=dropdown]",b.target).dropdown()
})
}}(window.jQuery));
(function(a){CUI.Filters=new Class({toString:"Filters",extend:CUI.Widget,construct:function(b){this.selectedIndices=[];
this.createdIndices=[];
if(!this.options.autocompleteCallback){this.options.autocompleteCallback=this._defaultAutocompleteCallback.bind(this)
}else{this.usingExternalData=true
}if(!this.options.optionRenderer){this.options.optionRenderer=CUI.Filters.defaultOptionRenderer
}this._readDataFromMarkup();
if(this.options.stacking){this.options.multiple=true
}this._render();
if(this.options.optionDisplayStrings.length>this.options.options.length){this.options.optionDisplayStrings=this.options.optionDisplayStrings.slice(0,this.options.options.length)
}while(this.options.optionDisplayStrings.length<this.options.options.length){this.options.optionDisplayStrings.push(this.options.options[this.options.optionDisplayStrings.length])
}this.dropdownList=new CUI.DropdownList({element:this.inputElement,positioningElement:(this.options.stacking)?this.$element:this.inputElement,position:this.options.position,autoPosition:this.options.autoPosition,cssClass:"autocomplete-results"});
this._addEventListeners()
},defaults:{autocompleteCallback:null,optionRenderer:null,options:[],optionDisplayStrings:[],multiple:false,delay:200,highlight:true,stacking:false,placeholder:null,allowCreate:false,icons:null,iconSize:"small",infiniteLoad:false,maxLoadingItems:20,hasError:false,position:"below",autoPosition:true},dropdownList:null,syncSelectElement:null,inputElement:null,typeTimeout:null,selectedIndex:-1,selectedIndices:null,createdIndices:null,triggeredBackspace:false,usingExternalData:false,selectedValue:null,isLoadingExternal:false,loadedEverything:false,setSelectedIndex:function(b){if(b<-1||b>=this.options.options.length){return
}this.inputElement.attr("value","");
this.selectedIndex=b;
if(this.options.multiple&&b>=0&&this.selectedIndices.indexOf(b*1)<0){this.selectedIndices.push(b*1)
}if(!this.options.multiple){this.selectedIndices=(b>=0)?[b]:[]
}this._update()
},removeSelectedIndex:function(b){var c=this.selectedIndices.indexOf(b*1);
if(c<0){return
}this.selectedIndices.splice(c,1);
this._update()
},getSelectedIndex:function(){return this.selectedIndex
},setSelectedIndices:function(b){this.selectedIndices=b.slice(0);
this._update()
},getSelectedIndices:function(){return this.selectedIndices.slice(0)
},_addEventListeners:function(){this.$element.on("change:disabled",this._update.bind(this));
this.$element.on("change:placeholder",this._update.bind(this));
this.$element.on("change:options",this._changeOptions.bind(this));
this.$element.on("input","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=setTimeout(this._inputChanged.bind(this),this.options.delay)
}.bind(this));
this.$element.on("click touchend","input",function(){if(this.options.disabled){return
}this.inputElement.focus();
this._inputChanged()
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=null;
if(!this.options.multiple&&this.selectedIndex>=0){if(this.inputElement.attr("value")===""){this.setSelectedIndex(-1)
}else{this._update()
}}var b=this.options.hasError||(!this.options.multiple&&this.inputElement.val().length>0&&this.selectedIndex<0);
this.$element.toggleClass("error",b)
}.bind(this));
this.$element.on("keydown","input",this._keyPressed.bind(this));
this.$element.on("keyup","input",this._keyUp.bind(this));
this.dropdownList.on("dropdown-list:select","",function(b){if(this.options.infiniteLoad){this.loadedEverything=false
}this.dropdownList.hide(200);
if(this.usingExternalData){this._createNewOption(b.selectedValue.toString(),b.selectedValue.toString(),true);
this._update()
}var c=a.inArray(b.selectedValue.toString(),this.options.options);
this.setSelectedIndex(c*1)
}.bind(this));
if(this.options.infiniteLoad){this.dropdownList.on("dropdown-list:scrolled-bottom","",function(c){if(!this.isLoadingExternal&&!this.loadedEverything){this.isLoadingExternal=true;
this.dropdownList.addLoadingIndicator();
var d=this.dropdownList.getNumberOfItems();
var b=this.inputElement.attr("value");
this.options.autocompleteCallback(a.proxy(this._appendLoadedData,this),b,d,this.options.maxLoadingItems)
}}.bind(this))
}this.$element.on("click","[data-dismiss=filter]",function(b){if(this.options.disabled){return
}var c=a(b.target).closest("[data-id]");
this.removeSelectedIndex(c.attr("data-id"));
return false
}.bind(this));
this.$element.on("input","input",function(){if(this.options.disabled){return
}this._correctInputFieldWidth()
}.bind(this));
this.$element.on("focus","input",function(b){if(this.options.disabled){return
}this.$element.addClass("focus");
b.preventDefault()
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}this.$element.removeClass("focus")
}.bind(this))
},_changeOptions:function(b){if(b.widget!==this){return
}this.selectedIndex=-1;
this.selectedIndices=[];
this.createdIndices=[];
this._update()
},_render:function(){var b;
if(this.$element.get(0).tagName==="SELECT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.append(this.$element);
this.$element=b
}if(this.$element.get(0).tagName==="INPUT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.prepend(this.$element);
this.$element=b
}if(this.$element.find("select option").length>0&&this.options.options.length===0){this.options.options=[];
this.options.optionDisplayStrings=[];
this.$element.find("select option").each(function(c,d){this.options.options.push(a(d).val());
this.options.optionDisplayStrings.push(a.trim(a(d).text()));
if(a(d).attr("selected")){this.selectedIndices.push(c);
this.selectedIndex=c
}}.bind(this))
}this._createMissingElements();
this.syncSelectElement=this.$element.find("select");
this.inputElement=this.$element.find("input");
this.$element.addClass("filters");
this.$element.removeClass("focus");
if(!this.options.placeholder){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.options.name){this.syncSelectElement.attr("name",this.options.name)
}if(this.options.stacking){this.$element.addClass("stacking")
}else{this.$element.removeClass("stacking")
}this._update()
},_createMissingElements:function(){if(this.$element.find("select").length===0){this.$element.append(a("<select "+(this.options.multiple?"multiple":"")+"></select>"))
}if(this.$element.find("input").length===0){this.$element.prepend(a('<input type="text">'))
}if(this.$element.find("select option").length<this.options.options.length){for(var d=this.$element.find("select option").length;
d<this.options.options.length;
d++){var e=this.options.options[d];
var b=this.options.optionDisplayStrings[d]||this.options.options[d];
var c=a("<option></option>");
c.text(b);
c.attr("value",e);
this.$element.find("select").append(c)
}}},_readDataFromMarkup:function(){if(this.$element.attr("multiple")){this.options.multiple=true
}if(this.$element.attr("data-multiple")){this.options.multiple=true
}if(this.$element.attr("data-stacking")){this.options.stacking=true
}if(this.$element.attr("placeholder")){this.options.placeholder=this.$element.attr("placeholder")
}if(this.$element.attr("data-placeholder")){this.options.placeholder=this.$element.attr("data-placeholder")
}if(this.$element.attr("disabled")){this.options.disabled=true
}if(this.$element.hasClass("error")){this.options.hasError=true
}if(this.$element.find("input").hasClass("error")){this.options.hasError=true
}if(this.$element.attr("data-disabled")){this.options.disabled=true
}if(this.$element.attr("data-allow")==="create"){this.options.allowCreate=true
}if(this.$element.attr("data-option-renderer")){this.options.optionRenderer=CUI.Filters[this.$element.attr("data-option-renderer")+"OptionRenderer"];
if(!this.options.optionRenderer){this.options.optionRenderer=CUI.Filters.defaultOptionRenderer
}}},_update:function(){if(this.options.placeholder){this.inputElement.attr("placeholder",this.options.placeholder)
}if(this.options.disabled){this.$element.addClass("disabled");
this.inputElement.attr("disabled","disabled")
}else{this.$element.removeClass("disabled");
this.inputElement.removeAttr("disabled")
}if(!this.options.multiple){if(this.syncSelectElement){this.syncSelectElement.find("option:selected").removeAttr("selected")
}if(this.selectedIndex>=0){if(this.syncSelectElement){a(this.syncSelectElement.find("option").get(this.selectedIndex)).attr("selected","selected")
}var e=this.options.options[this.selectedIndex];
if(this.options.optionDisplayStrings[this.selectedIndex]){e=this.options.optionDisplayStrings[this.selectedIndex]
}this.inputElement.attr("value",e)
}else{this.inputElement.attr("value","")
}this.$element.find("select").change();
return
}if(this.syncSelectElement){this.syncSelectElement.find("option:selected").removeAttr("selected");
for(var d=0;
d<this.selectedIndices.length;
d++){var b=this.selectedIndices[d];
a(this.syncSelectElement.find("option").get(b)).attr("selected","selected")
}}var c=a('<ul class="tags"></ul>');
a.each(this.selectedIndices,function(j,g){var i=this.options.options[g];
var h=(this.options.optionRenderer.bind(this))(g,i,false,false);
var f=a('<li data-id="'+g+'"><button data-dismiss="filter">&times;</button></li>');
c.append(f);
f.append(h)
}.bind(this));
this.$element.find("ul").remove();
if(c.children().length>0){if(this.options.stacking){this.$element.prepend(c)
}else{this.$element.append(c)
}}this._correctInputFieldWidth();
this.$element.find("select").change()
},_keyUp:function(c){var b=c.keyCode;
if(b===8){this.triggeredBackspace=false
}},_keyPressed:function(c){var b=c.keyCode;
if(b===8){if(this.triggeredBackspace===false&&this.inputElement.attr("value").length===0){if(this.options.multiple&&this.selectedIndices.length>0){c.preventDefault();
this.removeSelectedIndex(this.selectedIndices[this.selectedIndices.length-1]);
this._inputChanged()
}}this.triggeredBackspace=true
}if(!this.dropdownList.isVisible()){if(b===40){this._inputChanged();
c.preventDefault()
}if(b===13){var d=this.inputElement.val();
if(d.length>0){this._createNewOption(d,d,false);
c.preventDefault()
}}}else{if(b===13&&this.dropdownList.currentIndex<0){this.dropdownList.hide();
c.preventDefault()
}}},_createNewOption:function(e,c,f){var b=-1;
a.each(this.options.options,function(h,i){if(this.options.optionDisplayStrings[h]===e){b=h
}if(i===e){b=h
}}.bind(this));
if(b>=0){this.setSelectedIndex(b);
return
}if(!this.options.allowCreate&&!f){return
}var d=this.options.options.length;
this.options.options.push(e);
this.options.optionDisplayStrings.push(c);
if(this.syncSelectElement){var g=a("<option></option>");
g.text(c);
g.attr("value",e);
if(!f){g.attr("data-new","true")
}this.syncSelectElement.append(g)
}if(!f){this.createdIndices.push(d)
}this.setSelectedIndex(d)
},_correctInputFieldWidth:function(){if(!this.options.stacking){return
}var d=this.inputElement;
var g=d.attr("value")||"";
if(g.length===0){g=d.attr("placeholder")
}var e=["font-family","font-weight","font-style","font-size","letter-spacing","line-height","text-transform"];
var h=a('<div style="position: absolute; display: none;"></div>');
a.each(e,function(i,j){h.css(j,d.css(j))
});
h.text(g);
a("body").append(h);
var b=h.width()+25;
h.remove();
var c=parseFloat(d.css("margin-left"))+parseFloat(d.css("margin-right"));
var f=(this.selectedIndices.length===0);
if(f||b>(this.$element.width()-c)){b=(this.$element.width()-c)
}d.width(b)
},_inputChanged:function(){if(this.options.infiniteLoad){this.loadedEverything=false
}var b=this.inputElement.attr("value");
this.options.autocompleteCallback(a.proxy(this._showAutocompleter,this),b,0,(this.options.infiniteLoad)?this.options.maxLoadingItems:500)
},_appendLoadedData:function(b){this.dropdownList.removeLoadingIndicator();
if(b.length===0){this.loadedEverything=true;
this.isLoadingExternal=false;
return
}this.dropdownList.addItems(b);
this.isLoadingExternal=false
},_showAutocompleter:function(d){this.dropdownList.hide();
if(this.options.multiple){var c=[];
a.each(d,function(f,e){var g=a.inArray(e,this.options.options);
if(this.selectedIndices.indexOf(g)>=0){return
}c.push(e)
}.bind(this));
d=c
}if(d.length===0){return
}var b=function(e,f){return(this.options.optionRenderer.bind(this))(e,f,this.options.highlight,!a.isEmptyObject(this.options.icons))
};
this.dropdownList.set("optionRenderer",b.bind(this));
this.dropdownList.set("options",d);
this.dropdownList.show()
},_defaultAutocompleteCallback:function(d,c){var b=[];
a.each(this.options.options,function(f,g){var e=g;
if(this.options.optionDisplayStrings[f]){e=this.options.optionDisplayStrings[f]
}if(e.toLowerCase().indexOf(c.toLowerCase(),0)>=0){b.push(g)
}}.bind(this));
d(b,c)
},_buildIcon:function(d,b,c){if(d==="url"){return'<i class="'+c+' icon-inline-bg-image" style="background-image: url('+b+')">icon</i>'
}else{if(d==="cuiIcon"){return'<i class="'+b+" "+c+'">'+b.split("icon-")[1]+"</i>"
}}}});
CUI.util.plugClass(CUI.Filters);
a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~=filters]",b.target).filters()
});
CUI.Filters.defaultOptionRenderer=function(e,l,c,j){var h=a.inArray(l,this.options.options);
var k=l;
if(this.options.optionDisplayStrings[h]){k=this.options.optionDisplayStrings[h]
}var b=this.inputElement.val();
if(c){var d=k.toLowerCase().indexOf(b.toLowerCase());
if(d>=0){k=k.substr(0,d)+"<em>"+k.substr(d,b.length)+"</em>"+k.substr(d+b.length)
}}if(this.createdIndices.indexOf(h)>=0){k=k+"&nbsp;*"
}if(j){var f;
if(typeof(f=this.options.icons[l])!=="undefined"){var g=(/^icon-/i.test(f))?"cuiIcon":"url";
k=this._buildIcon(g,f,this.options.iconSize)+k
}}return a("<span>"+k+"</span>")
};
CUI.Filters.cqTagOptionRenderer=function(j,p,f){var k=a.inArray(p,this.options.options);
var o=p;
if(this.options.optionDisplayStrings[k]){o=this.options.optionDisplayStrings[k]
}var b=this.inputElement.val();
var n=o.split(":");
if(n.length<2){n[1]=""
}var g=n[0];
var m=n[1];
var r=m.split("/");
function l(e){return a("<div>").text(e).html()
}g=l(g);
o=g+": ";
for(var c=0;
c<r.length;
c++){var d=r[c];
if(f){var h=d.toLowerCase().indexOf(b.toLowerCase());
if(h>=0){d=l(d.substr(0,h))+"<em>"+l(d.substr(h,b.length))+"</em>"+l(d.substr(h+b.length))
}else{d=l(d)
}}else{d=l(d)
}if(c>0){o+=" / "
}if(c===r.length-1){d="<b>"+d+"</b>"
}o=o+d
}if(this.createdIndices.indexOf(k)>=0){o=o+"&nbsp;*"
}return a("<span>"+o+"</span>")
}
}(window.jQuery));
(function(b,a,c){CUI.Slider=new Class({toString:"Slider",extend:CUI.Widget,construct:function(){var h=this,f=this.$element.attr("id"),d=this.$element.children("fieldset"),g=d.children("legend"),e=[];
this._readOptions();
if(!f){f=CUI.util.getNextId();
this.$element.attr("id",f)
}this._renderMissingElements();
if(d.length>0){this.$element.append(d.contents(":not(legend)"));
this._group=b("<div/>",{role:"group","class":"sliderfieldset"});
h.$element.wrap(this._group);
if(g.length>0){this._grouplegend=b("<label/>").append(g.contents());
b.each(g.prop("attributes"),function(){h._grouplegend.attr(this.name,this.value)
});
if(!this._grouplegend.attr("id")){this._grouplegend.attr("id",f+"-legend")
}this._group.attr("aria-labelledby",this._grouplegend.attr("id"));
d.replaceWith(this._grouplegend);
g=this._grouplegend.insertBefore(this.$element)
}}this.$inputs=this.$element.find("input");
this.$inputs.each(function(k){var l=b(this),j=l.attr("id");
if(!j){l.attr("id",f+"-input"+k);
j=l.attr("id")
}if(!l.attr("aria-labelledby")){l.attr("aria-labelledby","")
}var i=h.$element.find('label[for="'+j+'"]');
if(g){if(l.attr("aria-labelledby").indexOf(g.attr("id"))===-1){l.attr("aria-labelledby",g.attr("id")+(l.attr("aria-labelledby").length?" ":"")+l.attr("aria-labelledby"))
}}if(i.length>0){i.not(l.parent()).insertBefore(h.$element);
i.each(function(m){if(!b(this).attr("id")){b(this).attr("id",j+"-label"+m)
}if(l.attr("aria-labelledby").indexOf(j+"-label"+m)===-1){l.attr("aria-labelledby",(l.attr("aria-labelledby").length?" ":"")+j+"-label"+m)
}if(!CUI.util.isTouch){b(this).fipo("touchstart","mousedown",function(n){h.$handles.eq(m).focus()
}.bind(this))
}})
}if(l.parent().is("label")){i=l.parent();
if(!i.attr("id")){i.attr("id",j+"-label")
}if(!i.attr("for")){i.attr("for",j)
}l.insertAfter(i);
if(g){i.addClass("hidden-accessible")
}i.insertBefore(h.$element)
}if(i.length&&l.attr("aria-labelledby").indexOf(i.attr("id"))===-1){l.attr("aria-labelledby",l.attr("aria-labelledby")+(l.attr("aria-labelledby").length?" ":"")+i.attr("id"))
}if(i.length===0&&l.attr("aria-labelledby").length>0){i=b("#"+l.attr("aria-labelledby").split(" ")[0])
}if(l.attr("aria-labelledby").length===0){l.removeAttr("aria-labelledby")
}if(!l.is("[step]")){l.attr("step",h.options.step)
}if(!l.is("[min]")){l.attr("min",h.options.min)
}if(!l.is("[max]")){l.attr("max",h.options.max)
}if(!l.is("[value]")){l.attr({value:h.options.value,"aria-valuetext":h.options.valuetextFormatter(h.options.value)});
e.push(h.options.value)
}else{e.push(l.attr("value"))
}if(k===0){if(l.is(":disabled")){h.options.disabled=true;
h.$element.addClass("disabled")
}else{if(h.options.disabled){l.attr("disabled","disabled");
h.$element.addClass("disabled")
}}}if(CUI.util.isTouch){l.on("change",function(m){if(h.options.disabled){return
}if(l.val()===h.values[k]){return
}h.setValue(l.val(),k)
}.bind(this));
l.on("focus",function(m){h._focus(m)
}.bind(this));
l.on("blur",function(m){h._blur(m)
}.bind(this))
}else{l.attr({"aria-hidden":true,tabindex:-1,hidden:"hidden"});
if(k===0){if(i){i.on("click",function(m){if(h.options.disabled){return
}h._clickLabel(m)
}.bind(this))
}if(g){g.on("click",function(m){if(h.options.disabled){return
}h._clickLabel(m)
}.bind(this))
}}}});
h.values=e;
if(this.options.orientation==="vertical"){this.isVertical=true
}this.$element.fipo("touchstart","mousedown",function(i){this._mouseDown(i)
}.bind(this));
this.$element.on("change:value",this._processValueChanged.bind(this));
this.$element.on("change:disabled",this._processDisabledChanged.bind(this));
this.$element.on("change:min",this._processMinMaxStepChanged.bind(this));
this.$element.on("change:max",this._processMinMaxStepChanged.bind(this));
this.$element.on("change:step",this._processMinMaxStepChanged.bind(this));
this._render()
},defaults:{step:"1",min:"1",max:"100",value:"1",orientation:"horizontal",slide:false,disabled:false,tooltips:false,tooltipFormatter:function(d){return d.toString()
},valuetextFormatter:function(d){return d.toString()
},ticks:false,filled:false,bound:false},values:[],$inputs:null,$ticks:null,$fill:null,$handles:null,$tooltips:null,isVertical:false,draggingPosition:-1,_readOptions:function(){if(this.$element.hasClass("vertical")){this.options.orientation="vertical";
this.isVertical=true
}if(this.$element.hasClass("tooltips")){this.options.tooltips=true
}if(this.$element.hasClass("ticked")){this.options.ticks=true
}if(this.$element.hasClass("filled")){this.options.filled=true
}if(this.$element.data("slide")){this.options.slide=true
}if(this.$element.hasClass("bound")){this.options.bound=true
}},setValue:function(d,e){e=e||0;
this._updateValue(e,d,true);
this._moveHandles();
if(this.options.filled){this._updateFill()
}},_renderMissingElements:function(){if(!this.$element.find("input").length){var g=this,f,d=(b.isArray(this.options.value))?this.options.value:[this.options.value];
b.each(d,function(h,i){f=b("<input>");
f.attr({type:"range",min:g.options.min,max:g.options.max,step:g.options.step,value:i}).val(i);
g.$element.append(f)
})
}if(!this.$element.find("div.clickarea").length){var e=b('<div class="clickarea">');
this.$element.prepend(e)
}this.$element.toggleClass("slider",true);
this.$element.toggleClass("vertical",this.options.orientation==="vertical");
this.$element.toggleClass("tooltips",this.options.tooltips);
this.$element.toggleClass("ticked",this.options.ticks);
this.$element.toggleClass("filled",this.options.filled)
},_processValueChanged:function(){var e=this,d=(b.isArray(this.options.value))?this.options.value:[this.options.value];
b.each(d,function(f,g){e._updateValue(f,g,true)
});
this._moveHandles();
if(this.options.filled){this._updateFill()
}},_processMinMaxStepChanged:function(){var d=this;
this.$element.find("input").attr("min",this.options.min);
this.$element.find("input").attr("max",this.options.max);
this.$element.find("input").attr("step",this.options.step);
b.each(this.values,function(e,f){d._updateValue(e,f,true)
});
if(this.options.ticks){this.$element.find(".ticks").remove();
this._buildTicks()
}if(this.options.filled){this.$element.find(".fill").remove();
this._buildFill()
}this._moveHandles();
if(this.options.filled){this._updateFill()
}},_processDisabledChanged:function(){if(this.options.disabled){this.$inputs.attr("disabled","disabled");
this.$handles.each(function(){b(this).removeClass("focus");
b(this).parent().removeClass("focus")
});
if(CUI.util.isTouch){this.$handles.attr("aria-disabled",true).removeAttr("tabindex")
}}else{this.$inputs.removeAttr("disabled");
if(CUI.util.isTouch){this.$handles.removeAttr("aria-disabled").attr("tabindex",0)
}}this.$element.toggleClass("disabled",this.options.disabled)
},_render:function(){var e=this;
var g=e.$inputs.map(function(){return b(this).attr("max")
});
e.options.max=Math.max.apply(null,g.toArray());
var f=e.$inputs.map(function(){return b(this).attr("min")
});
e.options.min=Math.min.apply(null,f.toArray());
var d=e.$inputs.map(function(){return b(this).attr("step")
});
e.options.step=Math.min.apply(null,d.toArray());
if(e.options.ticks){e._buildTicks()
}if(e.options.filled){e._buildFill()
}e._buildHandles()
},_buildTicks:function(){var l=this;
var f=b("<div></div>").addClass("ticks");
this.$element.prepend(f);
var j=Math.round((l.options.max-l.options.min)/l.options.step)-1;
var e=l.isVertical?l.$element.height():l.$element.width();
for(var h=0;
h<j;
h++){var d=(h+1)*(e/(j+1));
var k=(d/e)*100;
var g=b("<div></div>").addClass("tick").css((l.isVertical?"bottom":"left"),k+"%");
f.append(g)
}l.$ticks=f.find(".tick");
if(l.options.filled){l._coverTicks()
}},_buildFill:function(){var e=this;
this.$fill=b("<div></div>").addClass("fill");
if(e.values.length!==0){var d,f;
if(e.values.length<2){d=(e.values[0]-e.options.min)/(e.options.max-e.options.min)*100;
this.$fill.css((e.isVertical?"height":"width"),d+"%")
}else{d=(this._getLowestValue()-e.options.min)/(e.options.max-e.options.min)*100;
f=(this._getHighestValue()-this._getLowestValue())/(e.options.max-e.options.min)*100;
this.$fill.css((e.isVertical?"height":"width"),f+"%").css((e.isVertical?"bottom":"left"),d+"%")
}}this.$element.prepend(this.$fill);
e.options.filled=true
},_buildHandles:function(){var d=this;
d.$inputs.each(function(f){var j=b(this).wrap("<div></div>").parent().addClass("value");
var k=(d.values[f]-d.options.min)/(d.options.max-d.options.min)*100;
var m=b("<div></div>").addClass("handle").css((d.isVertical?"bottom":"left"),k+"%").attr({role:"slider",id:b(this).attr("id")+"-handle","aria-valuemin":d.options.min,"aria-valuemax":d.options.max,"aria-valuenow":d.values[f],"aria-valuetext":d.options.valuetextFormatter(d.values[f])});
b(this).css((d.isVertical?"bottom":"left"),k+"%");
b(j).append(m);
if(d.options.tooltips){var l=b("<output>"+b(this).attr("value")+"</output>").addClass("tooltip").addClass(d.isVertical?"arrow-left":"arrow-bottom").attr({id:b(this).attr("id")+"-tooltip","for":b(this).attr("id")});
m.append(l)
}if(b(this).attr("aria-labelledby")){m.attr("aria-labelledby",b(this).attr("aria-labelledby"))
}if(d.$inputs.length>1&&b(this).attr("aria-labelledby")){var h=b(this).attr("aria-labelledby").split(" "),e;
for(var g=0;
g<h.length;
g++){e=b("#"+h[g]);
if(g>0){e.removeAttr("for");
m.prepend(e)
}}}if(CUI.util.isTouch){m.attr("aria-hidden",true);
b(this).attr("tabindex",0).removeAttr("aria-hidden").removeAttr("hidden")
}else{m.on("focus",function(i){d._focus(i)
}.bind(this));
m.on("blur",function(i){d._blur(i)
}.bind(this));
m.on("keydown",function(i){d._keyDown(i)
}.bind(this));
m.attr("tabindex",0);
b(this).attr({"aria-hidden":true,tabindex:-1,hidden:"hidden"})
}if(d.options.disabled){m.attr("aria-disabled",true).removeAttr("tabindex")
}});
d.$handles=d.$element.find(".handle");
d.$tooltips=d.$element.find(".tooltip")
},_handleClick:function(g){if(this.options.disabled){return false
}var f=this;
var e=g.pageX;
var d=g.pageY;
if(g.type==="touchstart"){var h=(g.originalEvent.touches.length>0)?g.originalEvent.touches:g.originalEvent.changedTouches;
e=h[0].pageX;
d=h[0].pageY
}if(e===c||d===c){return
}var j=f._findNearestHandle(e,d);
var i=f._getValueFromCoord(e,d,true);
if(!isNaN(i)){f._updateValue(j,i);
f._moveHandles();
if(f.options.filled){f._updateFill()
}}if(!CUI.util.isTouch){if(g.type==="mousedown"){f.$handles.eq(j).data("mousedown",true)
}f.$handles.eq(j).focus()
}},_findNearestHandle:function(e,d){var f=this;
var g=999999;
var h=0;
f.$handles.each(function(j){var m=b(this).offset().left;
var l=b(this).offset().top;
var i=b(this).width();
var k=b(this).height();
var n=Math.abs(e-(m+(i/2)));
if(f.options.orientation==="vertical"){n=Math.abs(d-(l+(k/2)))
}if(n<g){g=n;
h=j
}});
return h
},_focus:function(f){if(this.options.disabled){return false
}var e=this,g=b(f.target),d=g.closest(".value"),h=d.find(".handle");
if(!h.data("mousedown")){e.$element.addClass("focus");
d.addClass("focus");
h.addClass("focus")
}},_blur:function(f){if(this.options.disabled){return false
}var e=this,g=b(f.target),d=g.closest(".value"),h=d.find(".handle");
e.$element.removeClass("focus");
d.removeClass("focus");
h.removeClass("focus").removeData("mousedown")
},_keyDown:function(d){if(this.options.disabled){return
}var h=this,l=b(d.target),m=l.closest(".value").find("input"),i=h.$inputs.index(m),e=Number(m.val()),f=Number(h.options.step),k=Number(h.options.min),g=Number(h.options.max),j=Math.max(f,Math.round((g-k)/10));
l.removeData("mousedown");
h._focus(d);
switch(d.keyCode){case 40:case 37:e-=f;
d.preventDefault();
break;
case 38:case 39:e+=f;
d.preventDefault();
break;
case 33:e+=(j-(e%j));
d.preventDefault();
break;
case 34:e-=(j-(e%j===0?0:j-e%j));
d.preventDefault();
break;
case 35:e=g;
d.preventDefault();
break;
case 36:e=k;
d.preventDefault();
break
}if(e!==Number(m.val())){h.setValue(e,i);
m.change()
}},_mouseDown:function(e){if(this.options.disabled){return false
}e.preventDefault();
var d=this,f;
this.draggingPosition=-1;
this.$handles.each(function(g,h){if(h===e.target){d.draggingPosition=g
}}.bind(this));
this.$tooltips.each(function(g,h){if(h===e.target){d.draggingPosition=g
}}.bind(this));
if(this.draggingPosition<0){this._handleClick(e);
return
}f=this.$handles.eq(this.draggingPosition);
f.addClass("dragging");
this.$element.closest("body").addClass("slider-dragging-cursorhack");
b(a).fipo("touchmove.slider","mousemove.slider",this._handleDragging.bind(this));
b(a).fipo("touchend.slider","mouseup.slider",this._mouseUp.bind(this));
if(f!==document.activeElement&&!CUI.util.isTouch){if(e.type==="mousedown"){f.data("mousedown",true)
}f.focus()
}},_handleDragging:function(f){var e=f.pageX;
var d=f.pageY;
if(f.originalEvent.targetTouches){var g=f.originalEvent.targetTouches.item(0);
e=g.pageX;
d=g.pageY
}this._updateValue(this.draggingPosition,this._getValueFromCoord(e,d));
this._moveHandles();
if(this.options.filled){this._updateFill()
}f.preventDefault()
},_mouseUp:function(){this.$handles.eq(this.draggingPosition).removeClass("dragging");
this.$element.closest("body").removeClass("slider-dragging-cursorhack");
this.draggingPosition=-1;
b(a).unbind("mousemove.slider touchmove.slider");
b(a).unbind("mouseup.slider touchend.slider")
},_clickLabel:function(d){this.$handles.eq(0)[0].focus()
},_updateValue:function(g,f,d){var e=this;
if(e.$inputs.eq(g).attr("value")!==f.toString()||(e.values[g]!==f.toString())){if(f>this.options.max){f=this.options.max
}if(f<this.options.min){f=this.options.min
}if(g===0||g===1){if(e.$inputs.length===2&&this.options.bound){if(g===0){f=Math.min(f,Number(e.$inputs.eq(1).val()));
e.$inputs.eq(1).attr({min:f});
e.$inputs.eq(g).attr({max:e.$inputs.eq(1).val()});
e.$handles.eq(1).attr({"aria-valuemin":f});
e.$handles.eq(g).attr({"aria-valuemax":e.$inputs.eq(1).val()})
}else{f=Math.max(f,Number(e.$inputs.eq(0).val()));
e.$inputs.eq(0).attr({max:f});
e.$inputs.eq(g).attr({min:e.$inputs.eq(0).val()});
e.$handles.eq(0).attr({"aria-valuemax":f});
e.$handles.eq(g).attr({"aria-valuemin":e.$inputs.eq(0).val()})
}}e.values[g]=f.toString();
e.$inputs.eq(g).val(f).attr({value:f,"aria-valuetext":e.options.valuetextFormatter(f)});
e.$handles.eq(g).attr({"aria-valuenow":f,"aria-valuetext":e.options.valuetextFormatter(f)});
if(!d){setTimeout(function(){e.$inputs.eq(g).change()
},1)
}}}},_moveHandles:function(){var d=this;
this.$handles.each(function(e){var f=(d.values[e]-d.options.min)/(d.options.max-d.options.min)*100;
var g=d.$inputs.eq(e);
if(d.options.orientation==="vertical"){if(d.options.slide){b(this).stop().animate({bottom:f+"%"});
g.stop().animate({bottom:f+"%"})
}else{b(this).css("bottom",f+"%");
g.css("bottom",f+"%")
}}else{if(d.options.slide){b(this).stop().animate({left:f+"%"});
g.stop().animate({left:f+"%"})
}else{b(this).css("left",f+"%");
g.css("left",f+"%")
}}if(d.options.tooltips){d.$tooltips.eq(e).html(d.options.tooltipFormatter(d.values[e]))
}})
},_updateFill:function(){var f=this;
var e;
if(f.values.length!==0){if(f.values.length===2){e=((f._getLowestValue()-f.options.min)/(f.options.max-f.options.min))*100;
var d=((f._getHighestValue()-f.options.min)/(f.options.max-f.options.min))*100;
var g=d-e;
if(f.options.orientation==="vertical"){if(f.options.slide){f.$fill.stop().animate({bottom:e+"%",height:g+"%"})
}else{f.$fill.css("bottom",e+"%").css("height",g+"%")
}}else{if(f.options.slide){f.$fill.stop().animate({left:e+"%",width:g+"%"})
}else{f.$fill.css("left",e+"%").css("width",g+"%")
}}}else{e=((f.values[0]-f.options.min)/(f.options.max-f.options.min))*100;
if(f.options.orientation==="vertical"){if(f.options.slide){f.$fill.stop().animate({height:e+"%"})
}else{f.$fill.css("height",e+"%")
}}else{if(f.options.slide){f.$fill.stop().animate({width:e+"%"})
}else{f.$fill.css("width",e+"%")
}}}}if(f.options.ticks){f._coverTicks()
}},_coverTicks:function(){var d=this;
d.$ticks.each(function(e){var f=d._getValueFromCoord(b(this).offset().left,b(this).offset().top);
if(d.values.length===2){if((f>d._getLowestValue())&&(f<d._getHighestValue())){if(!b(this).hasClass("covered")){b(this).addClass("covered")
}}else{b(this).removeClass("covered")
}}else{if(f<d._getHighestValue()){if(!b(this).hasClass("covered")){b(this).addClass("covered")
}}else{b(this).removeClass("covered")
}}})
},_getValueFromCoord:function(e,d,m){var i=this;
var k,g,n;
var f=i.$element.offset();
if(i.options.orientation==="vertical"){var j=i.$element.height();
k=((f.top+j)-d)/j
}else{var l=i.$element.width();
k=((e-f.left)/l)
}if(m&&(k<0||k>1)){return NaN
}var h=i.options.min*1+((i.options.max-i.options.min)*k);
if(h>=i.options.max){return i.options.max
}if(h<=i.options.min){return i.options.min
}n=((h-i.options.min)%i.options.step);
if(Math.abs(n)*2>=i.options.step){g=(h-n)+(i.options.step*1)
}else{g=h-n
}return g
},_getHighestValue:function(){return Math.max.apply(null,this.values)
},_getLowestValue:function(){return Math.min.apply(null,this.values)
}});
CUI.Widget.registry.register("slider",CUI.Slider);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(d){CUI.Slider.init(b(".slider[data-init~='slider']",d.target))
})
}}(jQuery,this));
(function(g){var f=0;
CUI.Datepicker=new Class({toString:"Datepicker",extend:CUI.Widget,defaults:{monthNames:null,dayNames:null,format:null,type:"date",selectedDateTime:null,startDay:0,disabled:false,displayedFormat:null,storedFormat:null,headFormat:"MMMM YYYY",forceHTMLMode:false,required:false,hasError:false,minDate:null,maxDate:null},displayDateTime:null,pickerShown:false,construct:function(){this.guid=(f+=1);
this._readOptionsFromMarkup();
this._parseOptions();
this._setupMomentJS();
this._adjustMarkup();
this._findElements();
this._constructPopover();
this._initialize()
},_readOptionsFromMarkup:function(){var B=this.options;
var C=this.$element;
if(C.hasClass("error")){B.hasError=true
}var D=g(C.find("input").filter("[type^=date],[type=time]"));
if(D.length!==0){B.type=D.attr("type")
}[["disabled","disabled",a],["required","required",a],["displayed-format","displayedFormat",r],["stored-format","storedFormat",r],["force-html-mode","forceHTMLMode",r],["day-names","dayNames",x],["month-names","monthNames",x],["head-format","headFormat",x],["start-day","startDay",o],["min-date","minDate",r],["max-date","maxDate",r]].map(function(E){var F=E[0],H=E[1],G=E[2];
G(C.data(F),H,B)
})
},_parseOptions:function(){var B=this.options;
B.monthNames=B.monthNames||CUI.Datepicker.monthNames;
B.dayNames=B.dayNames||CUI.Datepicker.dayNames;
B.isDateEnabled=(B.type==="date")||(B.type==="datetime")||(B.type==="datetime-local");
B.isTimeEnabled=(B.type==="time")||(B.type==="datetime")||(B.type==="datetime-local");
var C=document.createElement("input");
C.setAttribute("type",B.type);
B.supportsInputType=C.type!=="text";
if(B.minDate!==null){if(B.minDate==="today"){B.minDate=moment().startOf("day")
}else{if(moment(B.minDate,z).isValid()){B.minDate=moment(B.minDate,z)
}else{B.minDate=null
}}}if(B.maxDate!==null){if(B.maxDate==="today"){B.maxDate=moment().startOf("day")
}else{if(moment(B.maxDate,z).isValid()){B.maxDate=moment(B.maxDate,z)
}else{B.maxDate=null
}}}B.storedFormat=B.storedFormat||(B.type==="time"?e:y);
B.displayedFormat=B.displayedFormat||(B.type==="time"?e:b);
B.useNativeControls=B.forceHTMLMode;
if((!B.forceHTMLMode)&&d&&B.supportsInputType){B.useNativeControls=true
}if(B.useNativeControls){if(B.type==="date"){B.displayedFormat=z
}else{if(B.type==="time"){B.displayedFormat=e
}else{B.displayedFormat=y
}}}},_setupMomentJS:function(){this.options.language=t+new Date().getTime();
moment.lang(this.options.language,{months:this.options.monthNames,weekdaysMin:this.options.dayNames})
},_adjustMarkup:function(){var B=this.$element;
B.addClass("datepicker");
if(!this.options.useNativeControls){if(B.find("input").not("[type=hidden]").length===0){B.append(p)
}if(B.find("button").length===0){B.append(l)
}var G="popguid"+this.guid;
var C="#"+G+".popover";
this.$popover=g("body").find(C);
if(this.$popover.length===0){g("body").append(u.replace("%ID%",G));
this.$popover=g("body").find(C);
if(this.options.isDateEnabled){this.$popover.find(".inner").append(i)
}}}else{this.$popover=[]
}if(B.find("input[type=hidden]").length===0){B.append('<input type="hidden">')
}if(!B.find("input[type=hidden]").attr("name")){var D=B.find("input").not("[type=hidden]").attr("name");
B.find("input[type=hidden]").attr("name",D);
B.find("input").not("[type=hidden]").removeAttr("name")
}var E=B.find(">button");
if(E.length&&E.attr("type")===undefined){try{E.attr("type","button")
}catch(F){}}},_findElements:function(){this.$input=this.$element.find("input").not("[type=hidden]");
this.$hiddenInput=this.$element.find("input[type=hidden]");
this.$openButton=this.$element.find("button")
},_constructPopover:function(){if(this.$popover.length){this.popover=new A({$element:this.$popover,$trigger:this.$openButton,options:this.options,setDateTimeCallback:this._popoverSetDateTimeCallback.bind(this),hideCallback:this._popoverHideCallback.bind(this)})
}},_initialize:function(){if(this.options.useNativeControls){this.displayDateTime=this.options.selectedDateTime=moment(this.$input.val(),this.options.displayedFormat)
}else{this._switchInputTypeToText(this.$input)
}if(!this.options.disabled){this.$openButton.on("click",this._clickHandler.bind(this));
this.$input.on("change"+(d?" blur":""),this._inputChangedHandler.bind(this))
}if(!this.options.selectedDateTime){this._readInputVal([this.options.storedFormat,this.options.displayedFormat])
}this._setDateTime(this.options.selectedDateTime,true)
},_readInputVal:function(D){var C=this.$input.eq(0).val();
if(C!==""){var B=moment(C,D||this.options.displayedFormat);
if(!B||!B.isValid()){B=moment(C)
}this.displayDateTime=this.options.selectedDateTime=B;
if(B!==null&&B.isValid()){this.displayDateTime=this.options.selectedDateTime=B
}}else{this.displayDateTime=null
}},_updateState:function(){if(this.options.disabled){this.$element.find("input,button").attr("disabled","disabled");
this._hidePicker()
}else{this.$element.find("input,button").removeAttr("disabled")
}if(this.options.hasError||(!this.options.selectedDateTime&&this.options.required)||(this.options.selectedDateTime&&!this.options.selectedDateTime.isValid())){this.$element.addClass("error")
}else{this.$element.removeClass("error")
}},_popoverSetDateTimeCallback:function(){this._setDateTime.apply(this,arguments);
if(this.options.isTimeEnabled===false){this._hidePicker()
}},_popoverHideCallback:function(){this.pickerShown=false
},_switchInputTypeToText:function(C){var B=C.detach().attr("type","text");
this.$element.prepend(B)
},_openNativeInput:function(){this.$input.trigger("tap")
},_clickHandler:function(C){if(this.pickerShown){this._hidePicker()
}else{var B=this;
setTimeout(function(){B._openPicker()
},100)
}},_inputChangedHandler:function(){if(this.options.disabled){return
}var B;
if(this.$input.val()!==""){B=moment(this.$input.val(),this.options.displayedFormat);
this.options.hasError=B!==null&&!w(B,this.options.minDate,this.options.maxDate)
}else{this.options.hasError=false
}this._setDateTime(B,true)
},_keyPress:function(){if(this.pickerShown){}},_openPicker:function(){if(this.options.useNativeControls){this._openNativeInput()
}else{this._readInputVal();
this._showPicker()
}},_showPicker:function(){if(!this.pickerShown){this.$element.addClass("focus");
this.popover.show(this.displayDateTime);
this.pickerShown=true
}},_hidePicker:function(){if(this.pickerShown){this.$element.removeClass("focus");
this.popover.hide();
this.pickerShown=false
}},_setDateTime:function(C,B){this.options.selectedDateTime=this.displayDateTime=C;
if(!C){this.$input.val("")
}else{if(C.isValid()){this.$input.val(C.lang(this.options.language).format(this.options.displayedFormat))
}}var D=(C&&C.isValid())?C.lang("en").format(this.options.storedFormat):"";
this.$hiddenInput.val(D);
this._updateState();
if(!B){this.$input.trigger("change")
}this.$hiddenInput.trigger("change")
}});
CUI.Datepicker.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"];
CUI.Datepicker.dayNames=["Su","Mo","Tu","We","Th","Fr","Sa"];
CUI.Widget.registry.register("datepicker",CUI.Datepicker);
if(CUI.options.dataAPI){g(document).on("cui-contentloaded.data-api",function(B){CUI.Datepicker.init(g("[data-init~=datepicker]",B.target))
})
}var A=new Class({toString:"Popover",extend:Object,construct:function(B){this.$element=B.$element;
this.options=B.options;
this.setDateTimeCallback=B.setDateTimeCallback;
this.hideCallback=B.hideCallback;
this.$element.popover();
this.popover=this.$element.data("popover");
this.popover.set({pointAt:B.$trigger,pointFrom:"bottom"});
this._setupListeners()
},show:function(B){this.displayDateTime=B;
this._renderCalendar();
if(this.options.isTimeEnabled){this._renderTime()
}this.popover.show()
},hide:function(){this.popover.hide()
},_setupListeners:function(){this.popover.on("hide",this._popupHideHandler.bind(this));
this.$element.find(".calendar").on("swipe",this._swipeHandler.bind(this));
this.$element.on("mousedown",".next-month",this._mouseDownNextHandler.bind(this));
this.$element.on("mousedown",".prev-month",this._mouseDownPrevHandler.bind(this));
if(this.options.isTimeEnabled){this.$element.on("selected",".hour,.minute",this._dropdownChangedHandler.bind(this));
this.$element.on("change",".hour,.minute",this._dropdownChangedHandler.bind(this))
}},_popupHideHandler:function(B){this.hideCallback()
},_swipeHandler:function(C){var E=C.direction,B=this.displayDateTime.year(),D=this.displayDateTime.month();
if(E==="left"){this.displayDateTime=h(moment([B,D+1,1]));
this._renderCalendar("left")
}else{if(E==="right"){this.displayDateTime=h(moment([B,D-1,1]));
this._renderCalendar("right")
}}},_mouseDownNextHandler:function(B){B.preventDefault();
if(this.displayDateTime){this.displayDateTime=h(moment([this.displayDateTime.year(),this.displayDateTime.month()+1,1]));
this._renderCalendar("left")
}},_mouseDownPrevHandler:function(B){B.preventDefault();
if(this.displayDateTime){this.displayDateTime=h(moment([this.displayDateTime.year(),this.displayDateTime.month()-1,1]));
this._renderCalendar("right")
}},_dropdownChangedHandler:function(){var B=this._getHoursFromDropdown();
var D=this._getMinutesFromDropdown();
if(!this.options.selectedDateTime){this.options.selectedDateTime=moment()
}var C=this.options.selectedDateTime.hours(B).minutes(D);
this.setDateTimeCallback(C)
},_tableMouseDownHandler:function(E){E.preventDefault();
var C=moment(g(E.target).data("date"),y);
if(this.options.isTimeEnabled){var D=this._getHoursFromDropdown();
var B=this._getMinutesFromDropdown();
C.hours(D).minutes(B)
}this.setDateTimeCallback(C);
this._renderCalendar()
},_renderCalendar:function(B){var D=this.displayDateTime;
if(!D||!D.isValid()){this.displayDateTime=D=moment()
}var C=D.year();
var E=D.month()+1;
var G=this._renderOneCalendar(E,C);
var F=this.$element.find(".calendar");
G.on("mousedown","a",this._tableMouseDownHandler.bind(this));
if(F.find("table").length>0&&B){this._slideCalendar(G,(B==="left"))
}else{F.find("table").remove();
F.find(".sliding-container").remove();
F.find(".calendar-body").append(G)
}},_renderOneCalendar:function(R,I){var D=moment([I,R-1,1]).lang(this.options.language).format(this.options.headFormat);
var T=g('<div class="calendar-header"><h2>'+D+"</h2></div>").append(g('<button class="next-month"></button>')).append(g('<button class="prev-month"></button>'));
var O=this.$element.find(".calendar");
var K=O.find(".calendar-header");
if(K.length>0){K.replaceWith(T)
}else{O.prepend(T)
}var N=g("<table>");
N.data("date",I+"/"+R);
var H="<tr>";
var J=null;
for(var L=0;
L<7;
L++){J=(L+this.options.startDay)%7;
var M=this.options.dayNames[J];
H+="<th><span>"+M+"</span></th>"
}H+="</tr>";
N.append("<thead>"+H+"</thead>");
var S=moment([I,R-1,1]);
var C=(S.day()-this.options.startDay)%7;
if(C<0){C+=7
}H="";
var P=moment();
for(var G=0;
G<6;
G++){H+="<tr>";
for(var Q=0;
Q<7;
Q++){J=(G*7+Q)-C+1;
var B=moment([I,R-1,J]);
var E=(B.month()+1)===parseFloat(R);
var F="";
if(j(B,P)){F+=" today"
}if(j(B,this.options.selectedDateTime)){F+=" selected"
}if(E&&w(B,this.options.minDate,this.options.maxDate)){H+='<td class="'+F+'"><a href="#" data-date="'+B.lang(this.options.language).format(y)+'">'+B.date()+"</a></td>"
}else{H+='<td class="'+F+'"><span>'+B.date()+"</span></td>"
}}H+="</tr>"
}N.append("<tbody>"+H+"</tbody>");
return N
},_slideCalendar:function(D,G){this.$element.find(".sliding-container table").stop(true,true);
this.$element.find(".sliding-container").remove();
var F=this.$element.find("table");
var E=F.width();
var B=F.height();
var C=g('<div class="sliding-container">');
C.css({display:"block",position:"relative",width:E+"px",height:B+"px",overflow:"hidden"});
this.$element.find(".calendar-body").append(C);
C.append(F).append(D);
F.css({position:"absolute",left:0,top:0});
F.after(D);
D.css({position:"absolute",left:(G)?E:-E,top:0});
F.animate({left:(G)?-E:E},s,function(){F.remove()
});
D.animate({left:0},s,function(){if(C.parents().length===0){return
}D.css({position:"relative",left:0,top:0});
D.detach();
this.$element.find(".calendar-body").append(D);
C.remove()
}.bind(this))
},_renderTime:function(){var H=this.options.selectedDateTime;
var F=g(n);
var I=g("<select></select>");
for(var E=0;
E<24;
E++){var D=g("<option>"+k(E)+"</option>");
if(H&&E===H.hours()){D.attr("selected","selected")
}I.append(D)
}var B=g(q).append(I);
var J=g("<select></select>");
for(var C=0;
C<60;
C++){var G=g("<option>"+k(C)+"</option>");
if(H&&C===H.minutes()){G.attr("selected","selected")
}J.append(G)
}var K=g(v).append(J);
g(B).css(m);
g(B).find("select").css(c);
g(K).css(m);
g(K).find("select").css(c);
F.append(B,g("<span>:</span>"),K);
if(this.$element.find(".time").length===0){this.$element.find(".inner").append(F)
}else{this.$element.find(".time").empty().append(F.children())
}g(B).select();
g(K).select()
},_getHoursFromDropdown:function(){return parseInt(this.$element.find(".time .hour select").val(),10)
},_getMinutesFromDropdown:function(){return parseInt(this.$element.find(".time .minute select").val(),10)
}});
function k(B){if(B<10){return"0"+B
}return B
}function r(C,D,B){if(C!==undefined){B[D]=C
}}function a(C,D,B){B[D]=C?true:false
}function x(C,D,B){B[D]=C||B[D]
}function o(C,D,B){if(C!==undefined){B[D]=C*1
}}function h(B){if(!B){return null
}return moment([B.year(),B.month(),B.date()])
}function w(C,B,D){if(B===null&&D===null){return true
}if(B===null){return C<=D
}else{if(D===null){return C>=B
}else{return(B<=C&&C<=D)
}}}function j(C,B){if(C&&B){return C.year()===B.year()&&C.month()===B.month()&&C.date()===B.date()
}}var d=navigator.userAgent.match(/Android/i)||navigator.userAgent.match(/iPhone|iPad|iPod/i),z="YYYY-MM-DD",e="HH:mm",y="YYYY-MM-DD[T]HH:mmZ",b="YYYY-MM-DD HH:mm",t="coralui_",p='<input type="text">',l='<button class="icon-calendar small"><span>Datepicker</span></button>',i=['<div class="calendar">','<div class="calendar-header"></div>','<div class="calendar-body"></div>',"</div>"].join(""),u=['<div class="datepicker popover" style="display:none" id="%ID%">','<div class="inner"></div>',"</div>"].join(""),n="<div class='time'><i class='icon-clock small'></i></div>",q='<div class="select hour"><button></button></div>',v='<div class="select minute"><button>Single Select</button></div>',m={position:"relative"},c={position:"absolute",left:"1.5rem",top:"1rem"},s=400
}(window.jQuery));
(function(a){CUI.Pulldown=new Class({toString:"Pulldown",extend:CUI.Widget,defaults:{pulldownSize:0},timeout:null,popoverShown:false,construct:function(c){this._readDataFromMarkup();
var b=this.$element.find("a").first();
var d=this.$element.find(".popover").first();
b.on("click",function(e){e.preventDefault();
this.togglePopover();
this._keepFocus()
}.bind(this));
d.on("click",function(){this._keepFocus()
}.bind(this));
b.on("blur",function(){this.timeout=setTimeout(function(){this.timeout=null;
this.hidePopover()
}.bind(this),200)
}.bind(this));
d.fipo("tap","click","ul > li > a",function(){var e=this;
setTimeout(function(){e.hidePopover()
},500)
}.bind(this))
},_readDataFromMarkup:function(){if(this.$element.data("pulldownSize")){this.options.pulldownSize=this.$element.data("pulldownSize")*1
}},_keepFocus:function(){var b=this.$element.find("a").first();
if(!b.is(".disabled, [disabled]")){clearTimeout(this.timeout);
this.timeout=null;
b.focus()
}},togglePopover:function(){if(this.popoverShown){this.hidePopover()
}else{if(!this.$element.find("a").first().is(".disabled, [disabled]")){this.showPopover()
}}},showPopover:function(){this._placePopover();
this.$element.find(".popover").show();
this.popoverShown=true
},hidePopover:function(){this.$element.find(".popover").hide();
this.popoverShown=false
},setDisabled:function(b){if(b===true){this.$element.find("a").first().addClass("disabled");
this.hidePopover()
}else{this.$element.find("a").first().removeClass("disabled")
}},_placePopover:function(){var h=this.$element.find("a").first(),d=this.$element.find(".popover"),f=h.position(),i,b,c;
var j=Math.max(h.width()+22,d.width());
var k={width:j,height:h.height()};
if(d.hasClass("alignleft")){i=f.top+k.height;
b=-30;
c=30-j
}else{i=f.top+k.height+15;
b=f.left+h.width()-k.width+5;
c=k.width-30
}d.css({top:i,left:b,width:k.width});
var e=d.find("ul").first();
if(this.options.pulldownSize>0){var g=0;
e.find("li:lt("+this.options.pulldownSize+")").each(function(){g+=a(this).outerHeight()+a(this).find("a").first().outerHeight()
});
e.css("max-height",g)
}}});
CUI.Widget.registry.register("pulldown",CUI.Pulldown);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Pulldown.init(a("[data-init~=pulldown]",b.target))
})
}}(window.jQuery));
(function(a){CUI.Wizard=new Class({toString:"Wizard",extend:CUI.Widget,construct:function(b){this.$nav=this.$element.find("nav").first();
this.$back=this.$nav.find("button").first();
this.$next=this.$nav.find("button").last();
this.$pageOverview=this.$nav.find("ol").last();
if(this.$element.data("hide-steps")===true){this.$pageOverview.addClass("hidden")
}if(this.$back.attr("type")===undefined){this.$back[0].setAttribute("type","button")
}if(this.$next.attr("type")===undefined){this.$next[0].setAttribute("type","button")
}this.$nav.addClass("toolbar");
this.$back.addClass("left");
this.$next.addClass("right");
this.$pageOverview.addClass("center");
this.$nav.find("li").first().append('<div class="lead-fill"></div>');
this.$next.click(this._onNextClick.bind(this));
this.$back.click(this._onBackClick.bind(this));
this._updateDefault();
setTimeout(function(){this.changePage(1)
}.bind(this),1)
},defaults:{nextDisabled:false,backDisabled:false,nextLabel:"next",backLabel:"back",onPageChanged:null,onFinish:null,onLeaving:null,onNextButtonClick:null,onBackButtonClick:null},changePage:function(b){if(b<1||b>this.$nav.find("li").length){return
}this.pageNumber=b;
var d=this.pageNumber-1;
var c=this.getCurrentPage();
this.$nav.find("li").removeClass("stepped");
this.$nav.find("li:lt("+d+")").addClass("stepped");
this.$nav.find("li.active").removeClass("active");
this.$nav.find("li:eq("+d+")").addClass("active");
this.$element.find(">section.active").removeClass("active");
this.$element.find(">section:eq("+d+")").addClass("active");
this._updateButtons();
this._fireCallback("onPageChanged");
if(typeof this.options.onPageChanged==="object"&&this._dataExists(c,"wizardPageCallback")&&typeof this.options.onPageChanged[c.data("wizardPageCallback")]==="function"){this.options.onPageChanged[c.data("wizardPageCallback")](c)
}},getCurrentPageNumber:function(){return this.pageNumber
},getCurrentPage:function(){return this.getPage(this.pageNumber)
},getPage:function(b){return this.$element.find(">section:eq("+(parseFloat(b)-1)+")")
},getPageNav:function(b){return this.$element.find(">nav li:eq("+(parseFloat(b)-1)+")")
},setNextButtonLabel:function(b){this.$next.text(b)
},setBackButtonLabel:function(b){this.$back.text(b)
},setNextButtonDisabled:function(b){this.$next.attr("disabled",b)
},setBackButtonDisabled:function(b){this.$back.attr("disabled",b)
},activatePage:function(b){this.getPage(b).removeClass("wizard-hidden-step");
this.getPageNav(b).removeClass("wizard-hidden-step")
},deactivatePage:function(b){this.getPage(b).addClass("wizard-hidden-step");
this.getPageNav(b).addClass("wizard-hidden-step")
},_onNextClick:function(d){var c=this._fireCallback("onNextButtonClick");
if(c===false){return
}var b=this._getNextPageNumber();
if(b!=null){this.changePage(b)
}else{this._fireCallback("onFinish")
}},_onBackClick:function(d){var c=this._fireCallback("onBackButtonClick");
if(c===false){return
}var b=this._getPreviousPageNumber();
if(b!=null){this.changePage(b)
}else{this._fireCallback("onLeaving")
}},_getNextPageNumber:function(){var b=this.getCurrentPageNumber();
return this._getRelativeNextPageNumber(b)
},_getRelativeNextPageNumber:function(b){if(b<this.$nav.find("li").length){var d=b+1;
var c=this.getPage(d);
if(a(c).hasClass("wizard-hidden-step")){return this._getRelativeNextPageNumber(d)
}else{return d
}}else{return null
}},_getPreviousPageNumber:function(){var b=this.getCurrentPageNumber();
return this._getRelativePreviousPageNumber(b)
},_getRelativePreviousPageNumber:function(b){if(b>1){var d=b-1;
var c=this.getPage(d);
if(a(c).hasClass("wizard-hidden-step")){return this._getRelativePreviousPageNumber(d)
}else{return d
}return b-1
}else{return null
}},_updateButtons:function(){var b=this.getCurrentPage();
this.setNextButtonLabel((this._dataExists(b,"nextLabel"))?b.data("nextLabel"):this.options.nextLabel);
this.setBackButtonLabel((this._dataExists(b,"backLabel"))?b.data("backLabel"):this.options.backLabel);
this.setNextButtonDisabled((this._dataExists(b,"nextDisabled"))?b.data("nextDisabled"):this.options.nextDisabled);
this.setBackButtonDisabled((this._dataExists(b,"backDisabled"))?b.data("backDisabled"):this.options.backDisabled)
},_fireCallback:function(b){if(typeof this.options[b]==="function"){return this.options[b]()
}return undefined
},_dataExists:function(b,c){return b.data(c)!==undefined
},_updateDefault:function(){this.options.nextDisabled=this.$next.is("[disabled]");
this.options.backDisabled=this.$back.is("[disabled]");
this.options.nextLabel=this.$next.text();
this.options.backLabel=this.$back.text()
}});
CUI.util.plugClass(CUI.Wizard);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~=wizard]",b.target).wizard()
})
}}(window.jQuery));
(function(c){function b(k){return k.filter("[data-action=prev], [data-action=cancel]").first().addClass("hidden").clone(true).addClass("left").each(a)
}function g(k){return k.filter("[data-action=next]").first().addClass("hidden").clone(true).addClass("primary right").each(a)
}function d(k){return k.filter("[data-action=cancel]").first().clone(true).addClass("quiet right").each(a)
}function a(k,l){c(l).removeClass("hidden").not("button").toggleClass("button",true)
}function i(l){var n=l.children(".step");
var m=l.children(".toolbar");
if(m.length===0){l.prepend(function(){m=c('<nav class="toolbar"><ol class="center"></ol></nav>');
var o=m.children("ol");
n.map(function(){return c("<li />").text(c(this).data("stepTitle")||this.title).get(0)
}).appendTo(o);
return m
})
}m.toggleClass("theme-dark",true);
m.find("> ol > li").first().addClass("active");
var k=n.first().find(".flexwizard-control");
m.prepend(function(){return b(k)
}).append(function(){return g(k).add(d(k).toggleClass("hidden",true))
})
}function e(o,n,l){var k=c("<li />").text(n.data("stepTitle")||n.attr("title"));
var m=o.children(".step").index(l);
o.find("> .toolbar > ol > li").eq(m).after(k);
l.after(n)
}function f(k){if(k.length===0){return
}k.addClass("active").removeClass("stepped");
k.prevAll("li").addClass("stepped").removeClass("active");
k.nextAll("li").removeClass("active stepped")
}function j(k,m,l){if(m.length===0){return
}if(l){l.removeClass("active")
}m.toggleClass("active",true);
k.trigger("flexwizard-stepchange",[m,l])
}function h(o,n){var p=o.children("nav");
var r=o.children(".step.active");
var k=p.children("ol").children("li.active");
var q,l;
switch(n){case"prev":q=r.prev(".step");
l=k.prev("li");
break;
case"next":q=r.next(".step");
l=k.next("li");
break;
case"cancel":return
}if(q.length===0){return
}var m=q.find(".flexwizard-control");
b(m).replaceAll(p.children(".left"));
g(m).replaceAll(p.children(".right:not([data-action=cancel])"));
p.children(".right[data-action=cancel]").toggleClass("hidden",q.prev(".step").length===0);
f(l);
j(o,q,r)
}CUI.FlexWizard=new Class({toString:"FlexWizard",extend:CUI.Widget,construct:function(k){var l=this.$element;
i(l);
l.on("click",".flexwizard-control",function(m){h(l,c(this).data("action"))
});
j(l,l.children(".step").first())
},prevStep:function(){h(this.$element,"prev")
},nextStep:function(){h(this.$element,"next")
},add:function(l,k){var m=this.$element;
if(k===undefined){this.addAfter(l,m.children(".step").last());
return
}if(!l.jquery){l=c(l)
}l.toggleClass("step",true);
e(m,l,m.children(".step").eq(k))
},addAfter:function(l,k){var m=this.$element;
if(!l.jquery){l=c(l)
}if(!k.jquery){k=c(k)
}l.toggleClass("step",true);
e(m,l,k)
},remove:function(l){var m=this.$element;
if(!l.jquery){l=c(l)
}var k=m.children(".step").index(l);
m.find("> .toolbar > ol > li").eq(k).remove();
l.remove()
}});
CUI.Widget.registry.register("flexwizard",CUI.FlexWizard);
CUI.util.plugClass(CUI.FlexWizard);
if(CUI.options.dataAPI){c(document).on("cui-contentloaded.data-api",function(k){CUI.FlexWizard.init(c("[data-init~=flexwizard]",k.target))
})
}}(window.jQuery));
(function(a){CUI.Sticky=new Class({toString:"Sticky",extend:CUI.Widget,construct:function(b){this.$element.addClass("sticky");
this.wrapper=a("<div>").addClass("sticky-wrapper");
this.$element.wrapAll(this.wrapper);
this.wrapper=this.$element.parent();
this.wrapper.height(this.$element.outerHeight(true));
this.scrollingElement=this.$element.parents(".sticky-container");
if(this.scrollingElement.length===0){this.scrollingElement=a(document);
this.pageScroll=true
}this.scrollingElement.on("scroll",this._fixElementPosition.bind(this));
a(window).on("resize",this._fixElementPosition.bind(this))
},_fixElementPosition:function(){var g=this.wrapper.offset().top;
var c=(this.pageScroll)?this.scrollingElement.scrollTop():this.scrollingElement.offset().top;
var e=this._getStickPosition();
var f=this.wrapper.position().left;
var d=this.wrapper.width();
if((g-e)<c){if(!this.pageScroll){var b=this.scrollingElement.position();
e+=b.top;
f+=b.left;
this.$element.detach();
this.scrollingElement.after(this.$element)
}this.$element.css({position:(this.pageScroll)?"fixed":"absolute",top:e+"px",left:f,width:d+"px"})
}else{if(!this.pageScroll){this.$element.detach();
this.wrapper.append(this.$element)
}this.$element.css({position:"",top:"",left:"",width:d+"px"})
}},_getStickPosition:function(){var c=this.wrapper.offset().top;
var b=0;
this.scrollingElement.find(".sticky-wrapper").each(function(d,e){if(a(e).offset().top<c){b+=a(e).outerHeight(true)
}}.bind(this));
return b
},scrollingElement:null,pageScroll:false,wrapper:null});
CUI.Widget.registry.register("sticky",CUI.Sticky);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Sticky.init(a(".sticky,[data-init=sticky]",b.target))
})
}}(window.jQuery));
(function(g){var f="grid";
var q="list";
var k="single";
var j="multiple";
var b={itemSelector:"article",headerSelector:"header",dataContainer:"grid-0",enableImageMultiply:true,view:{selectedItem:{list:{cls:"selected"},grid:{cls:"selected"}},selectedItems:{list:{selector:"article.selected"},grid:{selector:"article.selected"}}},controller:{selectElement:{list:"article > i.select",grid:"article"},moveHandleElement:{list:"article > i.move"},targetToItem:{list:function(r){return r.closest("article")
},grid:function(r){return r.closest("article")
},header:function(r){return r.closest("header")
}},gridSelect:{cls:"selection-mode"},selectAll:{selector:"header > i.select",cls:"selected"},sort:{columnSelector:".label > *"}}};
var h=function(r){if(r.jquery){return r.data("cardView-item")
}return r
};
var l={equals:function(r,s){return(r.length===s.length)&&(r.length===r.filter(s).length)
},getWidget:function(r){var s;
if(r.length>0){s=g(r[0]).data("cardView")
}return s
},mixObjects:function(u,t){if(u===undefined){return t
}var r={};
for(var s in t){if(u[s]===undefined){r[s]=t[s];
continue
}var v=u[s];
if(typeof(u[s])=="object"&&(!(u[s] instanceof String))){v=this.mixObjects(u[s],t[s])
}r[s]=v
}return r
},resolve:function(s,t){var r=[];
s.each(function(){r.push.apply(r,t(g(this)).toArray())
});
return g(r)
},multiplyImages:function(t,s){t=t.filter(function(){var x=g(this);
return !x.is(".multiplied")&&!x.prev().is(".multiplied")&&x.is(":visible")
});
var w=t.length;
var u=0;
function r(){if(u<w){v(t[u]);
u++;
setTimeout(r,0)
}}function v(C){var y=C.naturalWidth,F=C.naturalHeight;
if((y===0)&&(F===0)){window.setTimeout(function(){v(C)
},200);
return
}var A=g("<canvas width='"+y+"' height='"+F+"'></canvas>")[0];
var z=A.getContext("2d");
z.drawImage(C,0,0,y,F);
var x=z.getImageData(0,0,y,F);
var D=x.data;
for(var E=0,B=D.length;
E<B;
E+=4){D[E]*=s[0];
D[E+1]*=s[1];
D[E+2]*=s[2]
}z.putImageData(x,0,0);
g("<img class='"+C.className+" multiplied' width='"+y+"' height='"+F+"' src='"+A.toDataURL("image/png")+"'/>").insertBefore(C)
}r()
}};
var d=new Class({$el:null,$containerEl:null,stepSize:0,iid:undefined,autoMoveOffset:0,maxScrollTop:0,construct:function(t,s,u){this.$el=t;
this.stepSize=s;
this.$containerEl=this._getScrollingContainer(t);
var r=this.$containerEl[0];
this.maxScrollTop=Math.max(r.scrollHeight-r.clientHeight,0);
this.autoMoveFn=u
},_getScrollingContainer:function(r){while((r.length>0)&&!r.is("body")){var s=r.css("overflowY");
var t=r.css("position");
if(((s==="auto")||(s==="visible"))&&(t==="absolute")){return r
}r=r.parent()
}return g(window)
},_execute:function(){var s=this.$containerEl[0];
var u=s.clientHeight;
var w=s.scrollTop;
var v=this.$el.offset().top-this.$containerEl.offset().top;
var t=v+this.$el.height();
var r=false;
if(v<=0){if(w>0){w-=this.stepSize;
this.autoMoveOffset=-this.stepSize;
if(w<0){w=0
}s.scrollTop=w;
r=true
}}else{if(t>=u){if(w<this.maxScrollTop){w+=this.stepSize;
this.autoMoveOffset=this.stepSize;
if(w>this.maxScrollTop){w=this.maxScrollTop
}s.scrollTop=w;
r=true
}}}return r
},_autoMove:function(){if(this.autoMoveOffset&&this.autoMoveFn){var r=this.$el.offset();
var s=r.top+this.autoMoveOffset;
this.autoMoveFn(r.left,s)
}},check:function(){var s=this;
this.stop();
var r=this._execute();
if(r){this.iid=window.setTimeout(function(){s.iid=undefined;
s._autoMove()
},50)
}},stop:function(){if(this.iid!==undefined){window.clearTimeout(this.iid);
this.autoMoveOffset=0;
this.iid=undefined
}}});
var m=new Class({$listEl:null,$itemEl:null,$items:null,$doc:null,$oldBefore:null,dragCls:null,fixHorizontalPosition:false,autoScroller:null,construct:function(s){var r=this;
this.$listEl=s.$listEl;
this.$itemEl=s.$itemEl;
this.$items=s.$items;
this.dragCls=s.dragCls;
this.fixHorizontalPosition=(s.fixHorizontalPosition!==false);
this.autoScroller=(s.autoScrolling?new d(this.$itemEl,8,function(t,u){r._autoMove(t,u)
}):undefined)
},_getEventCoords:function(r){if(!r.originalEvent.touches){return{x:r.pageX,y:r.pageY}
}return(r.originalEvent.touches.length>0?{x:r.originalEvent.touches[0].pageX,y:r.originalEvent.touches[0].pageY}:r.originalEvent.changedTouches.length>0?{x:r.originalEvent.changedTouches[0].pageX,y:r.originalEvent.changedTouches[0].pageY}:{x:r.pageX,y:r.pageY})
},_limit:function(v,u){if(u<this.listOffset.left){u=this.listOffset.left
}if(v<this.listOffset.top){v=this.listOffset.top
}var t=u+this.size.width;
var r=v+this.size.height;
var s=this.listOffset.left+this.listSize.width;
var w=this.listOffset-v+this.listSize.height;
if(t>s){u=s-this.size.width
}if(r>w){v=w-this.size.height
}if(this.fixHorizontalPosition){u=this.listOffset.left
}return{top:v,left:u}
},_getEventPos:function(s){var r=this._getEventCoords(s);
return{x:r.x-this.delta.left,y:r.y-this.delta.top}
},_adjustPosition:function(r,s){this.$itemEl.offset(this._limit(s,r));
if(this.autoScroller){this.autoScroller.check()
}},_changeOrderIfRequired:function(){var C=this.$itemEl.offset();
var z=C.left+(this.size.width/2);
var y=C.top+(this.size.height/2);
var v=null;
var w=false;
for(var t=0;
t<this.$items.length;
t++){var A=g(this.$items[t]);
if(!l.equals(A,this.$itemEl)){var x=A.offset();
var s=A.width();
var B=A.height();
var r=x.top+B;
if((z>=x.left)&&(z<x.left+s)&&(y>=x.top)&&(y<r)){w=((y-x.top)>(r-y));
v=A;
break
}}}if(v){var u=this.$itemEl.offset();
if(w){v.before(this.$itemEl)
}else{v.after(this.$itemEl)
}this.$itemEl.offset(u)
}},_autoMove:function(r,s){this._adjustPosition(r,s);
this._changeOrderIfRequired()
},start:function(t){this.$oldPrev=this.$itemEl.prev();
this.$oldNext=this.$itemEl.next();
var s=this._getEventCoords(t);
if(this.dragCls){this.$itemEl.addClass(this.dragCls)
}var r=this;
this.$doc=g(document);
this.$doc.fipo("touchmove.listview.drag","mousemove.listview.drag",function(u){r.move(u)
});
this.$doc.fipo("touchend.listview.drag","mouseup.listview.drag",function(u){r.end(u)
});
this.offset=this.$itemEl.offset();
this.delta={left:s.x-this.offset.left,top:s.y-this.offset.top};
this.size={width:this.$itemEl.width(),height:this.$itemEl.height()};
this.listOffset=this.$listEl.offset();
this.listSize={width:this.$listEl.width(),height:this.$listEl.height()};
t.stopPropagation();
t.preventDefault()
},move:function(r){var s=this._getEventPos(r);
this._adjustPosition(s.x,s.y);
this._changeOrderIfRequired();
r.stopPropagation();
r.preventDefault()
},end:function(t){var u=this._getEventPos(t);
this._adjustPosition(u.x,u.y);
if(this.dragCls){this.$itemEl.removeClass(this.dragCls)
}if(this.autoScroller){this.autoScroller.stop()
}this.$itemEl.css("position","");
this.$itemEl.css("top","");
this.$itemEl.css("left","");
this.$doc.off("touchmove.listview.drag");
this.$doc.off("mousemove.listview.drag");
this.$doc.off("touchend.listview.drag");
this.$doc.off("mouseup.listview.drag");
var s=this.$itemEl.prev();
var r=this.$itemEl.next();
this.$itemEl.trigger(g.Event("item-moved",{newPrev:s,newNext:r,oldPrev:this.$oldPrev,oldNext:this.$oldNext,hasMoved:!l.equals(s,this.$oldPrev)}));
t.stopPropagation();
t.preventDefault()
}});
var e=new Class({$itemEl:null,construct:function(r){this.$itemEl=r;
this.reference()
},getItemEl:function(){return this.$itemEl
},reference:function(){this.$itemEl.data("cardView-item",this)
}});
var o=new Class({$headerEl:null,itemRef:null,construct:function(s,r){this.$headerEl=s;
this.itemRef=r
},getHeaderEl:function(){return this.$headerEl
},getItemRef:function(){return this.itemRef
},setItemRef:function(r){this.itemRef=r
}});
var c=new Class({construct:function(s){this.model=s.model;
this.comparators=s.comparators;
this.selectors=s.selectors;
this.columnElement=s.columnElement;
this.headerElement=s.columnElement.closest(this.selectors.headerSelector);
var t=this.model.getHeaderForEl(this.headerElement);
this.items=this.model.getItemsForHeader(t);
this.isReverse=this.columnElement.hasClass("sort-asc");
this.toNatural=this.columnElement.hasClass("sort-desc");
this.fromNatural=!this.headerElement.hasClass("sort-mode");
this.comparator=null;
if(this.comparators){for(var r in this.comparators){if(!this.columnElement.is(r)){continue
}this.comparator=this.comparators[r]
}}if(!this.comparator){this.comparator=this._readComparatorFromMarkup()
}},_readComparatorFromMarkup:function(){var r=this.columnElement.data("sort-selector");
var t=this.columnElement.data("sort-attribute");
var u=this.columnElement.data("sort-type");
var s=this.columnElement.data("ignorecase");
if(!r&&!t){return null
}return new CUI.CardView.DefaultComparator(r,t,u,s)
},_adjustMarkup:function(){if(this.fromNatural){this.headerElement.addClass("sort-mode")
}if(this.toNatural){this.headerElement.removeClass("sort-mode")
}this.headerElement.find(this.selectors.controller.sort.columnSelector).removeClass("sort-asc sort-desc");
this.columnElement.removeClass("sort-desc sort-asc");
if(!this.toNatural){this.columnElement.addClass(this.isReverse?"sort-desc":"sort-asc")
}var r=this.toNatural;
g.each(this.items,function(){this.getItemEl().find(".move").toggle(r)
})
},sort:function(){if(!this.comparator&&!this.toNatural){return
}this._adjustMarkup();
var s=this.items.slice();
if(this.comparator){this.comparator.setReverse(this.isReverse);
var u=this.comparator.getCompareFn();
if(!this.toNatural){s.sort(u)
}}var r=this.headerElement;
g.each(this.items,function(){this.getItemEl().detach()
});
for(var t=0;
t<s.length;
t++){var v=s[t].getItemEl();
r.after(v);
r=v
}}});
var i=new Class({$el:null,items:null,headers:null,selectors:null,construct:function(B,A){this.$el=B;
this.items=[];
this.selectors=A;
var x=this.$el.find(A.itemSelector);
var v=x.length;
for(var t=0;
t<v;
t++){this.items.push(new e(g(x[t])))
}this.headers=[];
var y=this.$el.find(A.headerSelector);
var z=y.length;
for(var w=0;
w<z;
w++){var r=g(y[w]);
var s=r.nextAll(A.itemSelector);
var u=(s.length>0?this.getItemForEl(g(s[0])):undefined);
this.headers.push(new o(r,u))
}},initialize:function(){var r=this;
this.$el.on("item-moved",this.selectors.itemSelector,function(s){if(s.hasMoved){r._reorder(s)
}})
},_reorder:function(v){var y=this.getItemForEl(g(v.target));
var z=this.getItemForEl(v.newPrev);
var x=false;
var t;
if(!z){t=this.getHeaderForEl(v.newPrev);
if(t){x=true;
var r=this.getItemIndex(t.getItemRef());
if(r>0){z=this.getItemAt(r-1)
}}}var s=this.getItemIndex(y);
this.items.splice(s,1);
var w=this._getHeaderByItemRef(y);
if(w){w.setItemRef(this.getItemAt(s))
}var u=(z?this.getItemIndex(z)+1:0);
this.items.splice(u,0,y);
if(x){t.setItemRef(y)
}},getItemCount:function(){return this.items.length
},getItemAt:function(r){return this.items[r]
},getItemIndex:function(s){for(var r=0;
r<this.items.length;
r++){if(s===this.items[r]){return r
}}return -1
},getItemForEl:function(s){var u=this.items.length;
for(var r=0;
r<u;
r++){var t=this.items[r];
if(l.equals(t.getItemEl(),s)){return t
}}return undefined
},insertItemAt:function(w,x,r){if(!g.isArray(w)){w=w.toArray()
}for(var s=w.length-1;
s>=0;
s--){var z=w[s];
if(!z.jquery){z=g(z)
}var v;
var B=new e(z);
if((x===undefined)||(x===null)){this.items.push(B);
x=this.items.length-1
}else{v=this.items[x];
this.items.splice(x,0,B)
}var A={item:v,mode:"item"};
var y=this.headers.length;
for(var u=0;
u<y;
u++){var t=this.headers[u];
if(t.getItemRef()===v){if(r){A={item:t,mode:"header"};
break
}else{t.setItemRef(B)
}}}this.$el.trigger(g.Event("change:insertitem",{insertPoint:A,followupItem:v,item:B,pos:x,widget:l.getWidget(this.$el),moreItems:(s>0)}))
}},getHeaderCount:function(){return this.headers.length
},getHeaderAt:function(r){return this.headers[r]
},getHeaders:function(){var r=[];
r.push.apply(r,this.headers);
return r
},getHeaderForEl:function(s){var r=this.headers.length;
for(var t=0;
t<r;
t++){var u=this.headers[t];
if(l.equals(u.getHeaderEl(),s)){return u
}}return undefined
},_getHeaderByItemRef:function(r){for(var s=0;
s<this.headers.length;
s++){if(this.headers[s].getItemRef()===r){return this.headers[s]
}}return undefined
},getItemsForHeader:function(v){var x=v.getItemRef();
var y=this.headers.length;
var w=this.items.length;
var r=[];
var s=false;
for(var t=0;
t<w;
t++){var z=this.items[t];
if(s){for(var u=0;
u<y;
u++){if(this.headers[u].getItemRef()===z){s=false;
break
}}if(s){r.push(z)
}else{break
}}else{if(z===x){s=true;
r.push(x)
}}}return r
},fromItemElements:function(s){var r=[];
s.each(function(){var t=g(this).data("cardView-item");
if(t){r.push(t)
}});
return r
},reference:function(){var s=this.items.length;
for(var r=0;
r<s;
r++){this.items[r].reference()
}},removeAllItemsSilently:function(){this.items.length=0;
for(var r=0;
r<this.headers.length;
r++){this.headers[r].setItemRef(undefined)
}}});
var p=new Class({$el:null,selectors:null,construct:function(s,r){this.$el=s;
this.selectors=r
},initialize:function(){var r=this;
this.$el.on("change:displayMode",function(u){var s=u.oldValue;
var t=u.value;
r.cleanupAfterDisplayMode(s);
r.prepareDisplayMode(t)
});
this.$el.on("change:insertitem",function(s){r._onItemInserted(s)
});
this.$el.reflow({small:function(t,s){return t.width()>40*s.rem()&&t.width()<50*s.rem()
},xsmall:function(t,s){return t.width()>30*s.rem()&&t.width()<40*s.rem()
},xxsmall:function(t,s){return t.width()<30*s.rem()
}})
},_onItemInserted:function(x){var v=this.$el;
if(this.selectors.dataContainer){v=v.find("."+this.selectors.dataContainer)
}var r=x.item.getItemEl();
var y=x.followupItem;
switch(this.getDisplayMode()){case q:if(!y){v.append(r)
}else{var u=x.insertPoint;
var s=u.item;
var w=(u.mode==="item"?s.getItemEl():s.getHeaderEl());
w.before(r)
}break;
case f:if(!x.moreItems){var t=l.getWidget(this.$el);
t._restore();
t.layout()
}break
}},getDisplayMode:function(){return l.getWidget(this.$el).getDisplayMode()
},setSelectionState:function(t,s){var v=this.getDisplayMode();
var r=this.selectors.view.selectedItem[v];
var u=t.getItemEl();
if(r.selector){u=u.find(r.selector)
}if(s==="selected"){u.addClass(r.cls);
if(v===f){this._drawSelectedGrid(t)
}}else{if(s==="unselected"){u.removeClass(r.cls)
}}},getSelectionState:function(t){var r=this.selectors.view.selectedItem[this.getDisplayMode()];
var u=t.getItemEl();
if(r.selector){u=u.find(r.selector)
}var s=r.cls.split(" ");
for(var v=0;
v<s.length;
v++){if(!u.hasClass(s[v])){return"unselected"
}}return"selected"
},getSelectedItems:function(){var r=this.selectors.view.selectedItems[this.getDisplayMode()];
var s=this.$el.find(r.selector);
if(r.resolver){s=r.resolver(s)
}return s
},restore:function(x,r){var A=g("<div class='"+this.selectors.dataContainer+"'>");
this.$el.empty();
this.$el.append(A);
var u=x.getItemCount();
for(var s=0;
s<u;
s++){A.append(x.getItemAt(s).getItemEl())
}if(r){var z=x.getHeaderCount();
for(var w=0;
w<z;
w++){var v=x.getHeaderAt(w);
var y=v.getHeaderEl();
var t=v.getItemRef();
if(t){t.getItemEl().before(y)
}else{A.append(y)
}}}},prepareDisplayMode:function(r){if(r===f){this._drawAllSelectedGrid()
}},cleanupAfterDisplayMode:function(r){},_drawImage:function(s){if(s.length===0){return
}if(this._colorFloat===undefined){var r=s.closest("a, .card").css("background-color");
if(!r){return
}this._colorFloat=g.map(r.match(/(\d+)/g),function(t){return t/255
})
}l.multiplyImages(s,this._colorFloat)
},_drawAllSelectedGrid:function(){if(!this.selectors.enableImageMultiply){return
}var s=this;
var r=this.selectors.view.selectedItems.grid.selector+" img";
var t=g(r);
this._drawImage(t);
t.load(function(){s._drawImage(g(this))
})
},_drawSelectedGrid:function(t){if(!this.selectors.enableImageMultiply){return
}var r=this;
var s=t.getItemEl().find("img");
this._drawImage(s);
s.load(function(){r._drawImage(g(this))
})
},removeAllItemsSilently:function(){this.$el.find(this.selectors.itemSelector).remove()
}});
var n=new Class({$el:null,selectors:null,comparators:null,selectionModeCount:null,_listSelect:false,construct:function(t,s,r){this.$el=t;
this.selectors=s;
this.comparators=r;
this.selectionModeCount=j
},initialize:function(){this.setDisplayMode(this.$el.hasClass("list")?q:f);
var r=this;
this.$el.fipo("tap.cardview.select","click.cardview.select",this.selectors.controller.selectElement.list,function(v){var u=l.getWidget(r.$el);
if(u.getDisplayMode()===q){var t=h(r.getItemElFromEvent(v));
if(u.toggleSelection(t)){v.stopPropagation();
v.preventDefault()
}if(v.type==="tap"){r._listSelect=true
}}});
this.$el.fipo("tap.cardview.select","click.cardview.select",this.selectors.controller.selectElement.grid,function(v){var u=l.getWidget(r.$el);
if((u.getDisplayMode()===f)&&u.isGridSelectionMode()){var t=h(r.getItemElFromEvent(v));
if(u.toggleSelection(t)){v.stopPropagation();
v.preventDefault()
}}});
this.$el.fipo("tap.cardview.selectall","click.cardview.selectall",this.selectors.controller.selectAll.selector,function(w){var v=l.getWidget(r.$el);
if(v.getDisplayMode()===q){var t=r.selectors.controller.selectAll.cls;
var u=r.selectors.controller.targetToItem.header(g(w.target));
var x=v.getModel().getHeaderForEl(u);
if(u.hasClass(t)){v.deselectAll(x)
}else{v.selectAll(x)
}}});
this.$el.fipo("tap.cardview.sort","click.cardview.sort",this.selectors.headerSelector+" "+this.selectors.controller.sort.columnSelector,function(w){var v=l.getWidget(r.$el);
var t=v.getModel();
var u=g.Event("sortstart");
g(w.target).trigger(u);
if(u.isDefaultPrevented()){return
}var x=new c({model:t,columnElement:g(w.target),comparators:r.comparators,selectors:r.selectors});
x.sort();
u=g.Event("sortend");
g(w.target).trigger(u)
});
this.$el.on("selectstart.cardview",this.selectors.headerSelector+" "+this.selectors.controller.sort.columnSelector,function(t){t.preventDefault()
});
this.$el.finger("click.cardview.select",this.selectors.controller.selectElement.grid,function(v){var u=l.getWidget(r.$el);
var t=u.getDisplayMode();
if((t===f)&&u.isGridSelectionMode()){v.stopPropagation();
v.preventDefault()
}});
var s=this.selectors.controller.selectElement.listNavElement||this.selectors.controller.selectElement.grid;
this.$el.finger("click.cardview.select",s,function(v){var u=l.getWidget(r.$el);
var t=u.getDisplayMode();
if((t===q)&&r._listSelect){v.stopPropagation();
v.preventDefault()
}r._listSelect=false
});
this.$el.fipo("touchstart.cardview.reorder","mousedown.cardview.reorder",this.selectors.controller.moveHandleElement.list,function(v){var u=r.getItemElFromEvent(v);
var t=new m({$listEl:r.$el,$itemEl:u,$items:g(r.selectors.itemSelector),dragCls:"dragging",autoScrolling:true});
t.start(v)
});
this.$el.on("change:selection",function(t){if(t.moreSelectionChanges){return
}r._adjustSelectAllState(t.widget)
});
this.$el.on("change:insertitem",function(t){if(t.moreItems){return
}r._adjustSelectAllState(t.widget)
})
},_adjustSelectAllState:function(w){var s=this.selectors.controller.selectAll.cls;
var u=w.getHeaderSelectionState();
var x=u.headers;
var r=x.length;
for(var v=0;
v<r;
v++){var y=x[v];
var t=y.header.getHeaderEl();
if(y.hasUnselected){t.removeClass(s)
}else{t.addClass(s)
}}},getItemElFromEvent:function(s){var r=g(s.target);
var t=this.selectors.controller.targetToItem[this.getDisplayMode()];
if(g.isFunction(t)){return t(r)
}return r.find(t)
},isGridSelect:function(){var r=this.selectors.controller.gridSelect;
var s=this.$el;
if(r.selector){s=s.find(r.selector)
}return s.hasClass(r.cls)
},setGridSelect:function(s){if(this.isGridSelect()!==s){var r=this.selectors.controller.gridSelect;
var t=this.$el;
if(r.selector){t=t.find(r.selector)
}if(s){t.addClass(r.cls)
}else{t.removeClass(r.cls);
l.getWidget(t).clearSelection()
}this.$el.trigger(g.Event("change:gridSelect",{widget:this.$el.data("cardView"),oldValue:!s,value:s}))
}},getDisplayMode:function(){if(this.$el.hasClass("list")){return q
}if(this.$el.hasClass("grid")){return f
}return null
},isColumnSorted:function(){return(this.getDisplayMode()=="list")&&this.$el.find(this.selectors.headerSelector).filter(".sort-mode").length>0
},setDisplayMode:function(u){var r=this.getDisplayMode();
if(r!==u){var t=l.getWidget(this.$el);
t._restore(u===q);
switch(u){case f:this.$el.removeClass("list");
this.$el.addClass("grid");
if(r!==null){var s=t.getSelection();
this.setGridSelect(s.length>0);
t.layout()
}break;
case q:this.$el.cuigridlayout("destroy");
this.$el.removeClass("grid");
this.$el.addClass("list");
break
}this.$el.trigger(g.Event("change:displayMode",{widget:this.$el.data("cardView"),oldValue:r,value:u}))
}},getSelectionModeCount:function(){return this.selectionModeCount
},setSelectionModeCount:function(r){this.selectionModeCount=r
}});
var a=new Class({$el:null,selectors:null,comparators:null,model:null,view:null,controller:null,construct:function(s,r){this.selectors=s;
this.comparators=r
},initialize:function(r){this.$el=r;
this.setModel(new i(r,this.selectors));
this.setView(new p(r,this.selectors));
this.setController(new n(r,this.selectors,this.comparators));
this.model.initialize();
this.view.initialize();
this.controller.initialize()
},setModel:function(r){this.model=r
},getModel:function(){return this.model
},setView:function(r){this.view=r
},getView:function(){return this.view
},setController:function(r){this.controller=r
},getController:function(){return this.controller
},isSelected:function(s){var r=this.view.getSelectionState(s);
return(r==="selected")
},setSelected:function(t,r){var s=(r?"selected":"unselected");
this.view.setSelectionState(t,s)
},getSelection:function(r){var s=this.view.getSelectedItems();
if(r===true){s=this.model.fromItemElements(s)
}return s
},getDisplayMode:function(){return this.controller.getDisplayMode()
},isColumnSorted:function(){return this.controller.isColumnSorted()
},setDisplayMode:function(r){this.controller.setDisplayMode(r)
},isGridSelectionMode:function(){return this.controller.isGridSelect()
},setGridSelectionMode:function(r){this.controller.setGridSelect(r)
},getSelectionModeCount:function(){return this.controller.getSelectionModeCount()
},setSelectionModeCount:function(r){this.controller.setSelectionModeCount(r)
},_restore:function(r){this.view.restore(this.model,r);
this.model.reference()
},removeAllItems:function(){var r=l.getWidget(this.$el);
r.clearSelection();
this.model.removeAllItemsSilently();
this.view.removeAllItemsSilently()
}});
CUI.CardView=new Class({toString:"CardView",extend:CUI.Widget,adapter:null,construct:function(r){var t=l.mixObjects(r.selectorConfig,b);
var s=r.comparators||null;
this.adapter=new a(t,s);
this.adapter.initialize(this.$element);
this.layout(r.gridSettings)
},getModel:function(){return this.adapter.getModel()
},setModel:function(r){this.adapter.setModel(r)
},isSelected:function(r){return this.adapter.isSelected(r)
},getDisplayMode:function(){return this.adapter.getDisplayMode()
},isColumnSorted:function(){return this.adapter.isColumnSorted()
},setColumnSortable:function(r){},isColumnSortable:function(){},setDisplayMode:function(r){this.adapter.setDisplayMode(r)
},isGridSelectionMode:function(){return this.adapter.isGridSelectionMode()
},setGridSelectionMode:function(r){this.adapter.setGridSelectionMode(r)
},toggleGridSelectionMode:function(){this.setGridSelectionMode(!this.isGridSelectionMode())
},getSelectionModeCount:function(){return this.adapter.getSelectionModeCount()
},setSelectionModeCount:function(r){this.adapter.setSelectionModeCount(r)
},select:function(t,s){t=h(t);
var r=this.adapter.isSelected(t);
if(!r){if(this.getSelectionModeCount()===k&&this.getSelection().length>0){this.clearSelection()
}this.adapter.setSelected(t,true);
this.$element.trigger(g.Event("change:selection",{widget:this,item:t,isSelected:true,moreSelectionChanges:(s===true)}))
}},deselect:function(t,s){t=h(t);
var r=this.adapter.isSelected(t);
if(r){this.adapter.setSelected(t,false);
this.$element.trigger(g.Event("change:selection",{widget:this,item:t,isSelected:false,moreSelectionChanges:s}))
}},toggleSelection:function(u,t){u=h(u);
var s=g.Event("beforeselect",{selectionCancelled:false,stopEvent:false,item:u,cancelSelection:function(v){this.selectionCancelled=true;
this.stopEvent=(v===true)
}});
this.$element.trigger(s);
if(s.selectionCancelled){return s.stopEvent
}var r=this.isSelected(u);
if(!r&&(this.getSelectionModeCount()===k)&&(this.getSelection().length>0)){this.clearSelection()
}this.adapter.setSelected(u,!r);
this.$element.trigger(g.Event("change:selection",{widget:this,item:u,isSelected:!r,moreSelectionChanges:t}));
return true
},getSelection:function(r){return this.adapter.getSelection(r===true)
},clearSelection:function(){var s=this.getSelection(true);
var u=s.length;
var t=(u-1);
for(var r=0;
r<u;
r++){this.deselect(s[r],(r<t))
}},_headerSel:function(s,z,r){var y=this.adapter.getModel();
if(s==null){s=y.getHeaders()
}if(!g.isArray(s)){s=[s]
}var A=s.length;
for(var x=0;
x<A;
x++){var w=s[x];
if(w.jquery){w=y.getHeaderForEl(w)
}var t=y.getItemsForHeader(w);
var v=t.length;
for(var u=0;
u<v;
u++){z.call(this,t[u],!r(u,t))
}}},selectAll:function(s){if(this.getSelectionModeCount()!==j){return
}var r=this;
this._headerSel(s,this.select,function(u,t){for(++u;
u<t.length;
u++){if(!r.isSelected(t[u])){return false
}}return true
})
},deselectAll:function(s){var r=this;
this._headerSel(s,this.deselect,function(u,t){for(++u;
u<t.length;
u++){if(r.isSelected(t[u])){return false
}}return true
})
},getHeaderSelectionState:function(){var x=this.getModel();
var s=null;
var r={selected:[],hasUnselected:false,headers:[]};
var y=x.getHeaderCount();
var v=x.getItemCount();
for(var t=0;
t<v;
t++){var z=x.getItemAt(t);
for(var w=0;
w<y;
w++){var u=x.getHeaderAt(w);
if(u.getItemRef()===z){s={header:u,selected:[],hasUnselected:false};
r.headers.push(s);
break
}}if(this.isSelected(z)){if(s!==null){s.selected.push(z)
}else{r.selected.push(z)
}}else{if(s!==null){s.hasUnselected=true
}else{r.hasUnselected=true
}}}return r
},layout:function(r){if(this.getDisplayMode()!==f){return
}if(this.$element.data("cuigridlayout")){this.$element.cuigridlayout("destroy")
}this.$element.cuigridlayout(r)
},relayout:function(){if(this.getDisplayMode()!==f){return
}this.$element.cuigridlayout("layout")
},_restore:function(r){this.adapter._restore(r)
},append:function(r){this.adapter.getModel().insertItemAt(r,null,false)
},prepend:function(r){this.adapter.getModel().insertItemAt(r,0,false)
},removeAllItems:function(){this.adapter.removeAllItems();
if(this.getDisplayMode()===f){this.relayout()
}this.$element.trigger(g.Event("change:removeAll",{widget:this}))
}});
CUI.CardView.DefaultComparator=new Class({construct:function(r,u,t,s){this.selector=r;
this.attribute=u;
this.ignoreCase=s;
this.isNumeric=(t=="numeric");
this.reverseMultiplier=1
},setReverse:function(r){this.reverseMultiplier=(r)?-1:1
},compare:function(s,r){var y=s.getItemEl();
var x=r.getItemEl();
var w=(this.selector)?y.find(this.selector):y;
var v=(this.selector)?x.find(this.selector):x;
var u="";
var t="";
if(!this.attribute){u=(this.ignoreCase)?w.text().toLowerCase():w.text();
t=(this.ignoreCase)?v.text().toLowerCase():v.text()
}else{if(this.attribute.substr(0,5)=="data-"){u=w.data(this.attribute.substr(5));
t=v.data(this.attribute.substr(5))
}else{u=w.attr(this.attribute);
t=v.attr(this.attribute)
}}if(this.isNumeric){u=u*1;
t=t*1;
if(isNaN(u)){u=0
}if(isNaN(t)){t=0
}}if(u>t){return 1*this.reverseMultiplier
}if(u<t){return -1*this.reverseMultiplier
}return 0
},getCompareFn:function(){return this.compare.bind(this)
}});
CUI.CardView.DISPLAY_GRID=f;
CUI.CardView.DISPLAY_LIST=q;
CUI.CardView.SELECTION_MODE_COUNT_SINGLE="single";
CUI.CardView.SELECTION_MODE_COUNT_MULTI="multiple";
CUI.CardView.get=function(r){var s=l.getWidget(r);
if(!s){s=l.getWidget(r.cardView())
}return s
};
CUI.Widget.registry.register("cardview",CUI.CardView);
if(CUI.options.dataAPI){g(function(){var s=g("body").find('[data-toggle="cardview"]');
for(var t=0;
t<s.length;
t++){var r=g(s[t]);
if(!r.data("cardview")){CUI.CardView.init(r)
}}})
}}(window.jQuery));
(function(a){CUI.PathBrowser=new Class({toString:"PathBrowser",extend:CUI.Widget,construct:function(b){if(!this.options.autocompleteCallback){this.options.autocompleteCallback=this._defaultAutocompleteCallback.bind(this)
}if(!this.options.optionRenderer){this.options.optionRenderer=CUI.PathBrowser.defaultOptionRenderer
}this._render();
while(this.options.optionDisplayStrings.length<this.options.options.length){this.options.optionDisplayStrings.push(this.options.options[this.options.optionDisplayStrings.length])
}this.dropdownList=new CUI.DropdownList({element:this.inputElement,positioningElement:this.inputElement,position:this.options.position,autoPosition:this.options.autoPosition,cssClass:"autocomplete-results"});
this.$element.on("change:disabled",this._update.bind(this));
this.$element.on("change:placeholder",this._update.bind(this));
this.$element.on("change:options",this._changeOptions.bind(this));
this.$element.on("input","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=setTimeout(this._inputChanged.bind(this),this.options.delay)
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}if(this.typeTimeout){clearTimeout(this.typeTimeout)
}this.typeTimeout=null;
if(this.selectedIndex>=0){if(this.inputElement.attr("value")===""){this.setSelectedIndex(-1)
}else{this._update()
}}}.bind(this));
this.$element.on("keydown","input",this._keyPressed.bind(this));
this.$element.on("keyup","input",this._keyUp.bind(this));
this.dropdownList.on("dropdown-list:select","",function(c){this.dropdownList.hide(200);
this.setSelectedIndex(c.selectedValue*1)
}.bind(this));
if(!CUI.util.isTouch){this.$element.on("focus","input",function(c){if(this.options.disabled){return
}this.$element.addClass("focus")
}.bind(this));
this.$element.on("blur","input",function(){if(this.options.disabled){return
}this.$element.removeClass("focus")
}.bind(this));
this.$element.on("click touchend","input",function(c){if(this.options.disabled){return
}this.inputElement.focus();
this._inputChanged()
}.bind(this))
}},defaults:{autocompleteCallback:null,options:[],optionDisplayStrings:[],optionLoader:null,optionLoaderRoot:null,optionValueReader:null,optionTitleReader:null,showTitles:true,rootPath:"/content",delay:200,placeholder:null,optionRenderer:null,position:"below",autoPosition:true},dropdownList:null,syncSelectElement:null,inputElement:null,typeTimeout:null,selectedIndex:-1,triggeredBackspace:false,setSelectedIndex:function(b){if(b<-1||b>=this.options.options.length){return
}this.selectedIndex=b;
this._update()
},getSelectedIndex:function(){return this.selectedIndex
},_changeOptions:function(b){if(b.widget!==this){return
}this.selectedIndex=-1;
this._update()
},_render:function(){this._readDataFromMarkup();
var b;
if(this.$element.get(0).tagName==="SELECT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.append(this.$element);
this.$element=b
}if(this.$element.get(0).tagName==="INPUT"){b=a("<div></div>");
this.$element.after(b);
this.$element.detach();
b.prepend(this.$element);
this.$element=b
}if(this.$element.find("select option").length>0&&this.options.options.length===0){this.options.options=[];
this.options.optionDisplayStrings=[];
this.$element.find("select option").each(function(c,d){this.options.options.push(a(d).val());
this.options.optionDisplayStrings.push(a.trim(a(d).text()));
if(a(d).attr("selected")){this.selectedIndex=c
}}.bind(this))
}this._createMissingElements();
this.syncSelectElement=this.$element.find("select");
this.inputElement=this.$element.find("input");
this.$element.addClass("pathbrowser");
this.$element.removeClass("focus");
if(!this.options.placeholder){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.options.name){this.syncSelectElement.attr("name",this.options.name)
}this._update()
},_createMissingElements:function(){if(this.$element.find("select").length===0){this.$element.append(a("<select></select>"))
}if(this.$element.find("input").length===0){this.$element.prepend(a("<input/>",{type:"text"}))
}},_readDataFromMarkup:function(){if(this.$element.attr("placeholder")){this.options.placeholder=this.$element.attr("placeholder")
}if(this.$element.attr("data-placeholder")){this.options.placeholder=this.$element.attr("data-placeholder")
}if(this.$element.attr("disabled")||this.$element.attr("data-disabled")){this.options.disabled=true
}if(this.$element.attr("data-option-renderer")){this.options.optionRenderer=CUI.PathBrowser[this.$element.attr("data-option-renderer")+"OptionRenderer"]
}if(this.$element.attr("data-root-path")){this.options.rootPath=this.$element.attr("data-root-path")
}var d=CUI.util.buildFunction(this.$element.attr("data-option-loader"),["path","callback"]);
if(d){this.options.optionLoader=d.bind(this)
}if(this.$element.attr("data-option-loader-root")){this.options.optionLoaderRoot=this.$element.attr("data-option-loader-root")
}var c=CUI.util.buildFunction(this.$element.attr("data-option-value-reader"),["object"]);
if(c){this.options.optionValueReader=c.bind(this)
}var b=CUI.util.buildFunction(this.$element.attr("data-option-title-reader"),["object"]);
if(b){this.options.optionTitleReader=b.bind(this)
}},_update:function(){if(this.options.placeholder){this.inputElement.attr("placeholder",this.options.placeholder)
}if(this.options.disabled){this.$element.addClass("disabled");
this.inputElement.attr("disabled","disabled")
}else{this.$element.removeClass("disabled");
this.inputElement.removeAttr("disabled")
}if(this.syncSelectElement){this.syncSelectElement.find("option:selected").removeAttr("selected")
}if(this.selectedIndex>=0){if(this.syncSelectElement){a(this.syncSelectElement.find("option").get(this.selectedIndex)).attr("selected","selected")
}var c=this.options.options[this.selectedIndex];
if(c&&c.indexOf("/")!==0){var b="";
var d=this.inputElement.attr("value").lastIndexOf("/");
if(d>=0){b=this.inputElement.attr("value").substring(0,d+1)
}c=b+c
}this._setInputValue(c,true)
}else{this._setInputValue("")
}},_setInputValue:function(b,c){if(b){this.inputElement.attr("value",b);
if(c&&this.inputElement.is(":focus")){CUI.util.selectText(this.inputElement,b.length)
}}},_keyUp:function(c){var b=c.keyCode;
if(b===8){this.triggeredBackspace=false
}},_keyPressed:function(c){var b=c.keyCode;
if(!this.dropdownList.isVisible()){if(b===40){this._inputChanged();
c.preventDefault()
}}},_inputChanged:function(){var c=this;
var b=this.inputElement.val();
if(b.length>0){this.options.autocompleteCallback(b).done(function(d){c._showAutocompleter(d)
}).fail(function(){})
}else{this.dropdownList.hide()
}},_showAutocompleter:function(c){this.dropdownList.hide();
if(c.length===0){return
}var b=function(d,e){return(this.options.optionRenderer.bind(this))(d,e)
};
this.dropdownList.set("optionRenderer",b.bind(this));
this.dropdownList.set("options",c);
this.dropdownList.show()
},_defaultAutocompleteCallback:function(h){var d=this;
var f=a.Deferred();
if(/^\//.test(h)&&/\/$/.test(h)&&d.options.optionLoader){var c=false;
if(h==="/"){if(d.options.rootPath){h=d.options.rootPath.replace(/\/$/,"");
if(h!==""){c=true
}else{h="/"
}}}else{h=h.replace(/\/$/,"")
}if(c){d._setInputValue(h+"/")
}var b={loadOptions:d.options.optionLoader};
var g=a.Deferred();
g.promise(b);
b.done(function(i){if(a.isFunction(i.promise)){i.done(function(j){d._rebuildOptions(f,h,j)
})
}else{d._rebuildOptions(f,h,i)
}});
var e=b.loadOptions(h,function(i){g.resolve(i)
});
if(e){g.resolve(e)
}}else{f.resolve(d._filterOptions(h))
}return f.promise()
},_rebuildOptions:function(g,h,e){var c=this;
var b=CUI.util.getNested(e,c.options.optionLoaderRoot);
if(b){var i=[];
var f=[];
a.each(b,function(k,j){var l;
if(c.options.optionValueReader){l=c.options.optionValueReader(j)
}else{l=typeof j==="object"?j.path:j
}i.push(l);
var m="";
if(c.options.optionTitleReader){m=c.options.optionTitleReader(j)
}else{if(typeof j==="object"){m=j.title
}}f.push(m)
}.bind(c));
c.options.options=i;
c.options.optionDisplayStrings=f;
var d=c._filterOptions(h);
g.resolve(d)
}else{g.reject()
}},_filterOptions:function(c){var b=[];
a.each(this.options.options,function(d,e){b.push(d)
}.bind(this));
return b
}});
CUI.util.plugClass(CUI.PathBrowser);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init~='pathbrowser']",b.target).pathBrowser()
})
}CUI.PathBrowser.defaultOptionRenderer=function(e,d){var f=this.options.options[d];
if(f.indexOf("/")===0){var g=f.lastIndexOf("/");
f=f.substring(g+1)
}var c="pathbrowser-autocomplete-item-value";
var b="";
if(this.options.showTitles&&this.options.optionDisplayStrings[d]&&this.options.optionDisplayStrings[d].length>0){c+=" pathbrowser-autocomplete-item-value-with-title";
b+='<div class="pathbrowser-autocomplete-item-title">'+this.options.optionDisplayStrings[d]+"</div>"
}return a('<div class="'+c+'">'+f+"</div>"+b)
}
}(window.jQuery));
(function(a){CUI.FileUpload=new Class({toString:"FileUpload",extend:CUI.Widget,construct:function(b){this._render();
this.inputElement.on("change",function(c){if(this.options.disabled){return
}this._onFileSelectionChange(c)
}.bind(this))
},defaults:{name:"file",placeholder:null,uploadUrl:null,uploadUrlBuilder:null,disabled:false,multiple:false,sizeLimit:null,mimeTypes:[],autoStart:false,fileNameParameter:null,useHTML5:true,dropZone:null,events:{}},inputElement:null,$spanElement:null,fileNameElement:null,uploadQueue:[],_render:function(){var b=this;
if(this.$element.get(0).tagName==="INPUT"){var d=this.$element.attr("class");
var e=a("<span/>",{"class":d});
this.$element.removeAttr("class");
this.$element.after(e);
this.$element.detach();
e.prepend(this.$element);
this.$element=e
}this.$spanElement=this.$element.is("span")?this.$element:this.$element.find("span");
this.inputElement=this.$element.find("input[type='file']");
this._readDataFromMarkup();
if(!CUI.util.HTTP.html5UploadSupported()){this.options.useHTML5=false
}this._createMissingElements();
this.$element.addClass("fileupload");
this.$element.removeClass("focus");
if(this.inputElement.attr("title")){this.$element.prepend(a("<label/>",{"for":b.options.name}).html(this.inputElement.attr("title")))
}if(this.options.events){if(typeof this.options.events==="object"){for(var c in this.options.events){this._registerEventHandler(c,this.options.events[c])
}}}if(this.options.useHTML5){this._registerDropZone()
}else{this.options.dropZone=null
}if(!this.options.placeholder){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.options.autoStart){this._registerEventHandler("fileselected",function(f){f.fileUpload.uploadFile(f.item)
})
}if(this.options.uploadUrlBuilder){this.options.uploadUrl=this.options.uploadUrlBuilder(this)
}if(!this.options.uploadUrl||/\$\{.+\}/.test(this.options.uploadUrl)){this.options.disabled=true
}this._update()
},setDropZone:function(b){if(this.options.dropZone){this.options.dropZone.off()
}this.options.dropZone=b;
this._registerDropZone()
},_registerDropZone:function(){var b=this;
if(!b.options.dropZone){b.options.dropZone=b.$element.parent()
}try{b.options.dropZone=a(b.options.dropZone)
}catch(c){delete b.options.dropZone
}if(b.options.dropZone){b.options.dropZone.on("dragenter",function(d){if(b._isActive()){if(d.stopPropagation){d.stopPropagation()
}if(d.preventDefault){d.preventDefault()
}b.$element.trigger({type:"dropzonedragenter",originalEvent:d,fileUpload:b})
}return false
}).on("dragover",function(d){if(b._isActive()){b.isDragOver=true;
if(d.stopPropagation){d.stopPropagation()
}if(d.preventDefault){d.preventDefault()
}b.$element.trigger({type:"dropzonedragover",originalEvent:d,fileUpload:b})
}return false
}).on("dragleave",function(d){if(b._isActive()){if(d.stopPropagation){d.stopPropagation()
}if(d.preventDefault){d.preventDefault()
}b.isDragOver=false;
window.setTimeout(function(){if(!b.isDragOver){b.$element.trigger({type:"dropzonedragleave",originalEvent:d,fileUpload:b})
}},1)
}return false
}).on("drop",function(f){if(b._isActive()){if(f.stopPropagation){f.stopPropagation()
}if(f.preventDefault){f.preventDefault()
}var d=f.originalEvent.dataTransfer.files;
b.$element.trigger({type:"dropzonedrop",originalEvent:f,files:d,fileUpload:b});
b._onFileSelectionChange(f,d)
}return false
})
}},_registerEventHandler:function(b,c){this.$element.on(b,c)
},_createMissingElements:function(){var c=this;
var b=c.options.useHTML5&&c.options.multiple;
if(c.inputElement.length===0){c.inputElement=a("<input/>",{type:"file",name:c.options.name,multiple:b});
c.$element.prepend(c.inputElement)
}else{c.inputElement.attr("multiple",b)
}c.$element.wrap(a("<div class='fileupload-container'/>"))
},_readDataFromMarkup:function(){var c=this;
if(this.inputElement.attr("name")){this.options.name=this.inputElement.attr("name")
}if(this.inputElement.attr("placeholder")){this.options.placeholder=this.inputElement.attr("placeholder")
}if(this.inputElement.data("placeholder")){this.options.placeholder=this.inputElement.data("placeholder")
}if(this.inputElement.attr("disabled")||this.inputElement.data("disabled")){this.options.disabled=true
}if(this.inputElement.attr("multiple")||this.inputElement.data("multiple")){this.options.multiple=true
}if(this.inputElement.data("uploadUrl")){this.options.uploadUrl=this.inputElement.data("uploadUrl")
}if(this.inputElement.data("uploadUrlBuilder")){this.options.uploadUrlBuilder=CUI.util.buildFunction(this.inputElement.data("uploadUrlBuilder"),["fileUpload"])
}if(this.inputElement.data("mimeTypes")){this.options.mimeTypes=this.inputElement.data("mimeTypes")
}if(this.inputElement.data("sizeLimit")){this.options.sizeLimit=this.inputElement.data("sizeLimit")
}if(this.inputElement.data("autoStart")){this.options.autoStart=true
}if(this.inputElement.data("usehtml5")){this.options.useHTML5=this.inputElement.data("usehtml5")===true
}if(this.inputElement.data("dropzone")){this.options.dropZone=this.inputElement.data("dropzone")
}if(this.inputElement.data("fileNameParameter")){this.options.fileNameParameter=this.inputElement.data("fileNameParameter")
}var b=this.inputElement.length?this.inputElement.get(0):undefined;
if(b){a.each(b.attributes,function(f,g){var d=/^data-event-(.*)$/.exec(g.name);
if(d&&d.length>1){var e=CUI.util.buildFunction(g.value,["event"]);
if(e){c.options.events[d[1]]=e.bind(c)
}}})
}},_update:function(){if(this.options.placeholder){this.inputElement.attr("placeholder",this.options.placeholder)
}if(this.options.disabled){this.$element.addClass("disabled");
this.inputElement.attr("disabled","disabled")
}else{this.$element.removeClass("disabled");
this.inputElement.removeAttr("disabled")
}},_onFileSelectionChange:function(e,d){var f=0,b=0;
if(this.options.useHTML5){d=d||e.target.files;
for(var c=0;
c<d.length;
c++){if(this._addFile(d[c])){f++
}else{b++
}}}else{if(this._addFile(e.target)){f++
}else{b++
}}this.$element.trigger({type:"filelistprocessed",addedCount:f,rejectedCount:b,fileUpload:this})
},_addFile:function(c){var b=this;
var f,e;
if(this.options.useHTML5){f=c.name;
e=c.type
}else{f=a(c).attr("value")||c.value;
e=CUI.FileUpload.MimeTypes.getMimeTypeFromFileName(f)
}if(f.lastIndexOf("\\")!==-1){f=f.substring(f.lastIndexOf("\\")+1)
}if(b.options.fileNameParameter&&!this.options.autoStart){if(!b.fileNameElement){b.fileNameElement=a('input[name="'+b.options.fileNameParameter+'"]');
if(b.fileNameElement.length===0){b.fileNameElement=a("<input/>",{type:"hidden",name:b.options.fileNameParameter});
b.fileNameElement.appendTo(b.$element)
}}b.fileNameElement.val(f)
}if(!b._getQueueItemByFileName(f)){var d={fileName:f};
if(this.options.useHTML5){d.file=c;
d.fileSize=c.size;
if(b.options.sizeLimit&&c.size>b.options.sizeLimit){b.$element.trigger({type:"filerejected",item:d,message:"File is too big",fileUpload:b});
return false
}}if(!b._checkMimeTypes(e)){b.$element.trigger({type:"filerejected",item:d,message:"File mime type is not allowed",fileUpload:b});
return false
}b.uploadQueue.push(d);
b.$element.trigger({type:"queuechanged",item:d,operation:"ADD",queueLength:b.uploadQueue.length,fileUpload:b});
b.$element.trigger({type:"fileselected",item:d,fileUpload:b});
return true
}return false
},_checkMimeTypes:function(e){function c(i,h){var g=/(.+)\/(.+)$/,k=/\.(.+)$/,j=/.*/,f=false;
if(h==="*"||h===".*"||h==="*/*"){f=true
}else{if(!i||!i.match(g)){f=false
}else{if(h.match(g)){f=(i===h)
}else{if(h.match(k)){f=(i===CUI.FileUpload.MimeTypes[h])
}else{if(h.match(j)){f=(i.split("/")[0]===h)
}}}}}return f
}var d=this.options.mimeTypes.length,b;
if(d===0){return true
}else{for(b=0;
b<d;
b+=1){if(c(e,this.options.mimeTypes[b])){return true
}}return false
}},_getQueueIndex:function(c){var b=-1;
a.each(this.uploadQueue,function(d,e){if(e.fileName===c){b=d;
return false
}});
return b
},_getQueueItem:function(b){return b>-1?this.uploadQueue[b]:null
},_getQueueItemByFileName:function(b){return this._getQueueItem(this._getQueueIndex(b))
},uploadFile:function(j){var k=this;
if(k.options.useHTML5){j.xhr=new XMLHttpRequest();
j.xhr.addEventListener("loadstart",function(f){k._onUploadStart(f,j)
},false);
j.xhr.addEventListener("load",function(f){k._onUploadLoad(f,j)
},false);
j.xhr.addEventListener("error",function(f){k._onUploadError(f,j)
},false);
j.xhr.addEventListener("abort",function(f){k._onUploadCanceled(f,j)
},false);
var m=j.xhr.upload;
m.addEventListener("progress",function(f){k._onUploadProgress(f,j)
},false);
var b=j.file;
var c=j.fileName;
if(window.FormData){var g=new FormData();
if(k.options.fileNameParameter){g.append(k.inputElement.attr("name"),b);
g.append(k.options.fileNameParameter||"fileName",c)
}else{g.append(c,b)
}g.append("_charset_","utf-8");
j.xhr.open("POST",k.options.uploadUrl+"?:ck="+new Date().getTime(),true);
j.xhr.send(g)
}else{j.xhr.open("PUT",k.options.uploadUrl+"/"+c,true);
j.xhr.send(b)
}}else{var d=a(document.body);
var e="upload-"+new Date().getTime();
var i=a("<iframe/>",{name:e});
i.addClass("fileupload").appendTo(d);
var l=a("<form/>",{method:"post",enctype:"multipart/form-data",action:k.options.uploadUrl,target:e});
l.addClass("fileupload").appendTo(d);
var h=a("<input/>",{type:"hidden",name:"_charset_",value:"utf-8"});
l.prepend(h);
if(this.options.fileNameParameter){this.fileNameElement=a("<input/>",{type:"hidden",name:this.options.fileNameParameter,value:j.fileName});
l.prepend(this.fileNameElement)
}i.one("load",function(){var f=this.contentWindow.document.body.innerHTML;
k.inputElement.prependTo(k.$spanElement);
l.remove();
i.remove();
k.$element.trigger({type:"fileuploadload",item:j,content:f,fileUpload:k})
});
k.inputElement.prependTo(l);
l.submit()
}},cancelUpload:function(b){b.xhr.abort()
},_onUploadStart:function(c,b){this.$element.trigger({type:"fileuploadstart",item:b,originalEvent:c,fileUpload:this})
},_onUploadProgress:function(c,b){this.$element.trigger({type:"fileuploadprogress",item:b,originalEvent:c,fileUpload:this})
},_onUploadLoad:function(d,c){var b=d.target;
if(b.readyState===4){this._internalOnUploadLoad(d,c,b.status,b.responseText)
}},_internalOnUploadLoad:function(d,b,f,c){if(CUI.util.HTTP.isOkStatus(f)){this.$element.trigger({type:"fileuploadsuccess",item:b,originalEvent:d,fileUpload:this})
}else{this.$element.trigger({type:"fileuploaderror",item:b,originalEvent:d,message:c,fileUpload:this})
}if(this.fileNameElement){this.fileNameElement.remove()
}this.uploadQueue.splice(this._getQueueIndex(b.fileName),1);
this.$element.trigger({type:"queuechanged",item:b,operation:"REMOVE",queueLength:this.uploadQueue.length,fileUpload:this})
},_onUploadError:function(c,b){this.$element.trigger({type:"fileuploaderror",item:b,originalEvent:c,fileUpload:this})
},_onUploadCanceled:function(c,b){this.$element.trigger({type:"fileuploadcanceled",item:b,originalEvent:c,fileUpload:this})
},_isActive:function(){return !this.inputElement.is(":disabled")
}});
CUI.Widget.registry.register("fileupload",CUI.FileUpload);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.FileUpload.init(a("[data-init~='fileupload']",b.target))
})
}}(window.jQuery));
(function(a){CUI.FileUpload.MimeTypes={".3dm":"x-world/x-3dmf",".3dmf":"x-world/x-3dmf",".a":"application/octet-stream",".aab":"application/x-authorware-bin",".aam":"application/x-authorware-map",".aas":"application/x-authorware-seg",".abc":"text/vnd.abc",".acgi":"text/html",".afl":"video/animaflex",".ai":"application/postscript",".aif":"audio/x-aiff",".aifc":"audio/x-aiff",".aiff":"audio/x-aiff",".aim":"application/x-aim",".aip":"text/x-audiosoft-intra",".ani":"application/x-navi-animation",".aos":"application/x-nokia-9000-communicator-add-on-software",".aps":"application/mime",".arc":"application/octet-stream",".arj":"application/octet-stream",".art":"image/x-jg",".asf":"video/x-ms-asf",".asm":"text/x-asm",".asp":"text/asp",".asx":"video/x-ms-asf-plugin",".au":"audio/x-au",".avi":"video/x-msvideo",".avs":"video/avs-video",".bcpio":"application/x-bcpio",".bin":"application/x-macbinary",".bm":"image/bmp",".bmp":"image/x-windows-bmp",".boo":"application/book",".book":"application/book",".boz":"application/x-bzip2",".bsh":"application/x-bsh",".bz":"application/x-bzip",".bz2":"application/x-bzip2",".c":"text/x-c",".c++":"text/plain",".cat":"application/vnd.ms-pki.seccat",".cc":"text/x-c",".ccad":"application/clariscad",".cco":"application/x-cocoa",".cdf":"application/x-netcdf",".cer":"application/x-x509-ca-cert",".cha":"application/x-chat",".chat":"application/x-chat",".class":"application/x-java-class",".com":"text/plain",".conf":"text/plain",".cpio":"application/x-cpio",".cpp":"text/x-c",".cpt":"application/x-cpt",".crl":"application/pkix-crl",".crt":"application/x-x509-user-cert",".csh":"text/x-script.csh",".css":"text/css",".cxx":"text/plain",".dcr":"application/x-director",".deepv":"application/x-deepv",".def":"text/plain",".der":"application/x-x509-ca-cert",".dif":"video/x-dv",".dir":"application/x-director",".dl":"video/x-dl",".doc":"application/msword",".dot":"application/msword",".dp":"application/commonground",".drw":"application/drafting",".dump":"application/octet-stream",".dv":"video/x-dv",".dvi":"application/x-dvi",".dwf":"model/vnd.dwf",".dwg":"image/x-dwg",".dxf":"image/x-dwg",".dxr":"application/x-director",".el":"text/x-script.elisp",".elc":"application/x-elc",".env":"application/x-envoy",".eps":"application/postscript",".es":"application/x-esrehber",".etx":"text/x-setext",".evy":"application/x-envoy",".exe":"application/octet-stream",".f":"text/x-fortran",".f77":"text/x-fortran",".f90":"text/x-fortran",".fdf":"application/vnd.fdf",".fif":"image/fif",".fli":"video/x-fli",".flo":"image/florian",".flx":"text/vnd.fmi.flexstor",".fmf":"video/x-atomic3d-feature",".for":"text/x-fortran",".fpx":"image/vnd.net-fpx",".frl":"application/freeloader",".funk":"audio/make",".g":"text/plain",".g3":"image/g3fax",".gif":"image/gif",".gl":"video/x-gl",".gsd":"audio/x-gsm",".gsm":"audio/x-gsm",".gsp":"application/x-gsp",".gss":"application/x-gss",".gtar":"application/x-gtar",".gz":"application/x-gzip",".gzip":"multipart/x-gzip",".h":"text/x-h",".hdf":"application/x-hdf",".help":"application/x-helpfile",".hgl":"application/vnd.hp-hpgl",".hh":"text/x-h",".hlb":"text/x-script",".hlp":"application/x-winhelp",".hpg":"application/vnd.hp-hpgl",".hpgl":"application/vnd.hp-hpgl",".hqx":"application/x-mac-binhex40",".hta":"application/hta",".htc":"text/x-component",".htm":"text/html",".html":"text/html",".htmls":"text/html",".htt":"text/webviewhtml",".htx":"text/html",".ice":"x-conference/x-cooltalk",".ico":"image/x-icon",".idc":"text/plain",".ief":"image/ief",".iefs":"image/ief",".iges":"model/iges",".igs":"model/iges",".ima":"application/x-ima",".imap":"application/x-httpd-imap",".inf":"application/inf",".ins":"application/x-internett-signup",".ip":"application/x-ip2",".isu":"video/x-isvideo",".it":"audio/it",".iv":"application/x-inventor",".ivr":"i-world/i-vrml",".ivy":"application/x-livescreen",".jam":"audio/x-jam",".jav":"text/x-java-source",".java":"text/x-java-source",".jcm":"application/x-java-commerce",".jfif":"image/pjpeg",".jfif-tbnl":"image/jpeg",".jpe":"image/pjpeg",".jpeg":"image/pjpeg",".jpg":"image/pjpeg",".jps":"image/x-jps",".js":"application/x-javascript",".jut":"image/jutvision",".kar":"music/x-karaoke",".ksh":"text/x-script.ksh",".la":"audio/x-nspaudio",".lam":"audio/x-liveaudio",".latex":"application/x-latex",".lha":"application/x-lha",".lhx":"application/octet-stream",".list":"text/plain",".lma":"audio/x-nspaudio",".log":"text/plain",".lsp":"text/x-script.lisp",".lst":"text/plain",".lsx":"text/x-la-asf",".ltx":"application/x-latex",".lzh":"application/x-lzh",".lzx":"application/x-lzx",".m":"text/x-m",".m1v":"video/mpeg",".m2a":"audio/mpeg",".m2v":"video/mpeg",".m3u":"audio/x-mpequrl",".man":"application/x-troff-man",".map":"application/x-navimap",".mar":"text/plain",".mbd":"application/mbedlet",".mc$":"application/x-magic-cap-package-1.0",".mcd":"application/x-mathcad",".mcf":"text/mcf",".mcp":"application/netmc",".me":"application/x-troff-me",".mht":"message/rfc822",".mhtml":"message/rfc822",".mid":"x-music/x-midi",".midi":"x-music/x-midi",".mif":"application/x-mif",".mime":"www/mime",".mjf":"audio/x-vnd.audioexplosion.mjuicemediafile",".mjpg":"video/x-motion-jpeg",".mm":"application/x-meme",".mme":"application/base64",".mod":"audio/x-mod",".moov":"video/quicktime",".mov":"video/quicktime",".movie":"video/x-sgi-movie",".mp2":"video/x-mpeq2a",".mp3":"video/x-mpeg",".mpa":"video/mpeg",".mpc":"application/x-project",".mpe":"video/mpeg",".mpeg":"video/mpeg",".mpg":"video/mpeg",".mpga":"audio/mpeg",".mpp":"application/vnd.ms-project",".mpt":"application/x-project",".mpv":"application/x-project",".mpx":"application/x-project",".mrc":"application/marc",".ms":"application/x-troff-ms",".mv":"video/x-sgi-movie",".my":"audio/make",".mzz":"application/x-vnd.audioexplosion.mzz",".nap":"image/naplps",".naplps":"image/naplps",".nc":"application/x-netcdf",".ncm":"application/vnd.nokia.configuration-message",".nif":"image/x-niff",".niff":"image/x-niff",".nix":"application/x-mix-transfer",".nsc":"application/x-conference",".nvd":"application/x-navidoc",".o":"application/octet-stream",".oda":"application/oda",".omc":"application/x-omc",".omcd":"application/x-omcdatamaker",".omcr":"application/x-omcregerator",".p":"text/x-pascal",".p10":"application/x-pkcs10",".p12":"application/x-pkcs12",".p7a":"application/x-pkcs7-signature",".p7c":"application/x-pkcs7-mime",".p7m":"application/x-pkcs7-mime",".p7r":"application/x-pkcs7-certreqresp",".p7s":"application/pkcs7-signature",".part":"application/pro_eng",".pas":"text/pascal",".pbm":"image/x-portable-bitmap",".pcl":"application/x-pcl",".pct":"image/x-pict",".pcx":"image/x-pcx",".pdb":"chemical/x-pdb",".pdf":"application/pdf",".pfunk":"audio/make.my.funk",".pgm":"image/x-portable-greymap",".pic":"image/pict",".pict":"image/pict",".pkg":"application/x-newton-compatible-pkg",".pko":"application/vnd.ms-pki.pko",".pl":"text/x-script.perl",".plx":"application/x-pixclscript",".pm":"text/x-script.perl-module",".pm4":"application/x-pagemaker",".pm5":"application/x-pagemaker",".png":"image/png",".pnm":"image/x-portable-anymap",".pot":"application/vnd.ms-powerpoint",".pov":"model/x-pov",".ppa":"application/vnd.ms-powerpoint",".ppm":"image/x-portable-pixmap",".pps":"application/vnd.ms-powerpoint",".ppt":"application/x-mspowerpoint",".ppz":"application/mspowerpoint",".pre":"application/x-freelance",".prt":"application/pro_eng",".ps":"application/postscript",".psd":"application/octet-stream",".pvu":"paleovu/x-pv",".pwz":"application/vnd.ms-powerpoint",".py":"text/x-script.phyton",".pyc":"applicaiton/x-bytecode.python",".qcp":"audio/vnd.qcelp",".qd3":"x-world/x-3dmf",".qd3d":"x-world/x-3dmf",".qif":"image/x-quicktime",".qt":"video/quicktime",".qtc":"video/x-qtc",".qti":"image/x-quicktime",".qtif":"image/x-quicktime",".ra":"audio/x-realaudio",".ram":"audio/x-pn-realaudio",".ras":"image/x-cmu-raster",".rast":"image/cmu-raster",".rexx":"text/x-script.rexx",".rf":"image/vnd.rn-realflash",".rgb":"image/x-rgb",".rm":"audio/x-pn-realaudio",".rmi":"audio/mid",".rmm":"audio/x-pn-realaudio",".rmp":"audio/x-pn-realaudio-plugin",".rng":"application/vnd.nokia.ringing-tone",".rnx":"application/vnd.rn-realplayer",".roff":"application/x-troff",".rp":"image/vnd.rn-realpix",".rpm":"audio/x-pn-realaudio-plugin",".rt":"text/vnd.rn-realtext",".rtf":"text/richtext",".rtx":"text/richtext",".rv":"video/vnd.rn-realvideo",".s":"text/x-asm",".s3m":"audio/s3m",".saveme":"application/octet-stream",".sbk":"application/x-tbook",".scm":"video/x-scm",".sdml":"text/plain",".sdp":"application/x-sdp",".sdr":"application/sounder",".sea":"application/x-sea",".set":"application/set",".sgm":"text/x-sgml",".sgml":"text/x-sgml",".sh":"text/x-script.sh",".shar":"application/x-shar",".shtml":"text/x-server-parsed-html",".sid":"audio/x-psid",".sit":"application/x-stuffit",".skd":"application/x-koan",".skm":"application/x-koan",".skp":"application/x-koan",".skt":"application/x-koan",".sl":"application/x-seelogo",".smi":"application/smil",".smil":"application/smil",".snd":"audio/x-adpcm",".sol":"application/solids",".spc":"text/x-speech",".spl":"application/futuresplash",".spr":"application/x-sprite",".sprite":"application/x-sprite",".src":"application/x-wais-source",".ssi":"text/x-server-parsed-html",".ssm":"application/streamingmedia",".sst":"application/vnd.ms-pki.certstore",".step":"application/step",".stl":"application/x-navistyle",".stp":"application/step",".sv4cpio":"application/x-sv4cpio",".sv4crc":"application/x-sv4crc",".svf":"image/x-dwg",".svr":"x-world/x-svr",".swf":"application/x-shockwave-flash",".t":"application/x-troff",".talk":"text/x-speech",".tar":"application/x-tar",".tbk":"application/x-tbook",".tcl":"text/x-script.tcl",".tcsh":"text/x-script.tcsh",".tex":"application/x-tex",".texi":"application/x-texinfo",".texinfo":"application/x-texinfo",".text":"text/plain",".tgz":"application/x-compressed",".tif":"image/x-tiff",".tiff":"image/x-tiff",".tr":"application/x-troff",".tsi":"audio/tsp-audio",".tsp":"audio/tsplayer",".tsv":"text/tab-separated-values",".turbot":"image/florian",".txt":"text/plain",".uil":"text/x-uil",".uni":"text/uri-list",".unis":"text/uri-list",".unv":"application/i-deas",".uri":"text/uri-list",".uris":"text/uri-list",".ustar":"multipart/x-ustar",".uu":"text/x-uuencode",".uue":"text/x-uuencode",".vcd":"application/x-cdlink",".vcs":"text/x-vcalendar",".vda":"application/vda",".vdo":"video/vdo",".vew":"application/groupwise",".viv":"video/vnd.vivo",".vivo":"video/vnd.vivo",".vmd":"application/vocaltec-media-desc",".vmf":"application/vocaltec-media-file",".voc":"audio/x-voc",".vos":"video/vosaic",".vox":"audio/voxware",".vqe":"audio/x-twinvq-plugin",".vqf":"audio/x-twinvq",".vql":"audio/x-twinvq-plugin",".vrml":"x-world/x-vrml",".vrt":"x-world/x-vrt",".vsd":"application/x-visio",".vst":"application/x-visio",".vsw":"application/x-visio",".w60":"application/wordperfect6.0",".w61":"application/wordperfect6.1",".w6w":"application/msword",".wav":"audio/x-wav",".wb1":"application/x-qpro",".wbmp":"image/vnd.wap.wbmp",".web":"application/vnd.xara",".wiz":"application/msword",".wk1":"application/x-123",".wmf":"windows/metafile",".wml":"text/vnd.wap.wml",".wmlc":"application/vnd.wap.wmlc",".wmls":"text/vnd.wap.wmlscript",".wmlsc":"application/vnd.wap.wmlscriptc",".word":"application/msword",".wp":"application/wordperfect",".wp5":"application/wordperfect6.0",".wp6":"application/wordperfect",".wpd":"application/x-wpwin",".wq1":"application/x-lotus",".wri":"application/x-wri",".wrl":"x-world/x-vrml",".wrz":"x-world/x-vrml",".wsc":"text/scriplet",".wsrc":"application/x-wais-source",".wtk":"application/x-wintalk",".xbm":"image/xbm",".xdr":"video/x-amt-demorun",".xgz":"xgl/drawing",".xif":"image/vnd.xiff",".xl":"application/excel",".xla":"application/x-msexcel",".xlb":"application/x-excel",".xlc":"application/x-excel",".xld":"application/x-excel",".xlk":"application/x-excel",".xll":"application/x-excel",".xlm":"application/x-excel",".xls":"application/x-msexcel",".xlt":"application/x-excel",".xlv":"application/x-excel",".xlw":"application/x-msexcel",".xm":"audio/xm",".xml":"text/xml",".xmz":"xgl/movie",".xpix":"application/x-vnd.ls-xpix",".xpm":"image/xpm",".x-png":"image/png",".xsr":"video/x-amt-showrun",".xwd":"image/x-xwindowdump",".xyz":"chemical/x-pdb",".z":"application/x-compressed",".zip":"multipart/x-zip",".zoo":"application/octet-stream",".zsh":"text/x-script.zsh"};
CUI.FileUpload.MimeTypes.getMimeTypeFromFileName=function(c){var b=c.match(/.+(\..+)/);
return(b?CUI.FileUpload.MimeTypes[b[1]]:undefined)
}
}(window.jQuery));
(function(a){CUI.Toolbar=new Class({toString:"Toolbar",extend:CUI.Widget,construct:function(e){var d=this.$element,c=d.closest(".content-header"),b=d.find(".left"),f=d.find(".center").length!==0,g=b.width();
d.reflow({"break-lines":function(h,i){return f&&h.width()-2*g<16*i.rem()
},"long-title":function(h,i){return f&&h.width()-2*g>40*i.rem()
}},{applyClassToElement:c})
}});
CUI.Widget.registry.register("toolbar",CUI.Toolbar);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Toolbar.init(a("[data-init~=toolbar]",b.target))
})
}}(window.jQuery));
(function(a){CUI.Tooltip=new Class({toString:"Tooltip",extend:CUI.Widget,construct:function(c){if(this.options.target){this.options.target=a(this.options.target)
}if(this.$element.length===0&&this.options.target){this.$element=a("<div>");
this.$element.insertAfter(this.options.target)
}this.$element.addClass("tooltip");
if(this.$element.data("interactive")){this.options.interactive=true;
if(!this.options.target){this.options.target=this.$element.parent()
}}if(this.$element.data("target")){this.options.target=a(this.$element.data("target"))
}if(!this.options.arrow){this.options.arrow="left";
if(this.$element.hasClass("arrow-left")){this.options.arrow="left"
}if(this.$element.hasClass("arrow-right")){this.options.arrow="right"
}if(this.$element.hasClass("arrow-top")){this.options.arrow="top"
}if(this.$element.hasClass("arrow-bottom")){this.options.arrow="bottom"
}}if(this.options.interactive){this.options.visible=false
}this.$element.toggleClass("hidden",!this.options.visible);
this.$element.on("change:content",this._setContent.bind(this));
this.$element.on("change:type",this._setType.bind(this));
this.$element.on("change:arrow",this._setArrow.bind(this));
this.applyOptions();
this.reposition();
if(this.options.target){this.options.target.data("tooltip",this)
}if(this.options.interactive&&this.options.target){var b=null;
a(this.options.target).finger("touchstart.cui-tooltip",function(e){if(b){clearTimeout(b)
}this.show();
b=setTimeout(function(){this.hide()
}.bind(this),3000)
}.bind(this));
var d=false;
a(this.options.target).pointer("mouseover.cui-tooltip",function(e){if(d){clearTimeout(d)
}d=setTimeout(function(){this.show()
}.bind(this),this.options.delay)
}.bind(this));
a(this.options.target).pointer("mouseout.cui-tooltip",function(e){if(d){clearTimeout(d)
}this.hide()
}.bind(this))
}},defaults:{target:null,visible:true,type:"default",interactive:false,arrow:null,delay:500,distance:5},_types:["info","error","notice","success","inspect"],_arrows:["arrow-left","arrow-right","arrow-top","arrow-bottom"],applyOptions:function(){this._setContent();
this._setType();
this._setArrow()
},_setType:function(){if(typeof this.options.type!=="string"||this._types.indexOf(this.options.type)===-1){return
}this.$element.removeClass(this._types.join(" "));
this.$element.addClass(this.options.type);
this.reposition()
},_setArrow:function(){if(typeof this.options.arrow!=="string"||this._arrows.indexOf("arrow-"+this.options.arrow)===-1){return
}this.$element.removeClass(this._arrows.join(" "));
this.$element.addClass("arrow-"+this.options.arrow);
this.reposition()
},_setContent:function(){if(typeof this.options.content!=="string"){return
}this.$element.html(this.options.content);
this.reposition()
},_show:function(){if(this.$element.hasClass("hidden")){this.$element.removeClass("hidden");
this.$element.css("display","none")
}this.$element.fadeIn()
},_hide:function(){this.$element.fadeOut(400,function(){if(this.options.autoDestroy){this.$element.remove();
a(this.options.target).off(".cui-tooltip");
a(this.options.target).data("tooltip",null)
}}.bind(this));
return this
},reposition:function(e){if(!this.options.target){return
}if(!e){setTimeout(function(){this.reposition(true)
}.bind(this),50)
}this.$element.detach().insertAfter(this.options.target);
this.$element.css("position","absolute");
var c=a(this.options.target);
var j=c.outerWidth(true);
var h=c.outerHeight(true);
var i=c.position().left;
var f=c.position().top+c.offsetParent().scrollTop();
var b=this.$element.outerWidth(true);
var k=this.$element.outerHeight(true);
var d=0;
var g=0;
if(this.options.arrow==="left"){d=i+j+this.options.distance;
g=f+(h-k)/2
}if(this.options.arrow==="right"){d=i-b-this.options.distance;
g=f+(h-k)/2
}if(this.options.arrow==="bottom"){d=i+(j-b)/2;
g=f-k-this.options.distance
}if(this.options.arrow==="top"){d=i+(j-b)/2;
g=f+h+this.options.distance
}this.$element.css("left",d);
this.$element.css("top",g);
return this
}});
CUI.Widget.registry.register("tooltip",CUI.Tooltip);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){CUI.Tooltip.init(a("[data-init~=tooltip]",b.target))
});
a(document).fipo("touchstart","mouseover","[data-init~=quicktip]",function(d){var b=a(this);
var c=b.data("tooltip");
if(!c){new CUI.Tooltip({target:b,content:b.data("quicktip-content")||b.html(),type:b.data("quicktip-type"),arrow:b.data("quicktip-arrow"),interactive:true,autoDestroy:true});
b.trigger(d)
}})
}}(window.jQuery));
(function(a){CUI.Accordion=new Class({toString:"Accordion",extend:CUI.Widget,construct:function(c){this.isAccordion=(!this.$element.hasClass("collapsible"))&&(this.$element.data("init")!=="collapsible");
if(this.isAccordion){this.$element.addClass("accordion")
}if(this.isAccordion){var b=this.$element.children(".active").index();
if(this.options.active!==false){b=this.options.active
}this.$element.children().each(function(d,e){this._initElement(e,d!=b)
}.bind(this))
}else{this._initElement(this.$element,!(this.options.active||this.$element.hasClass("active")))
}this._setListeners();
this._makeAccessible();
this._updateDOMForDisabled()
},defaults:{active:false,disabled:false},isAccordion:false,_setListeners:function(){var b=this.isAccordion?"> .collapsible > h3":"> h3";
this.$element.on("click",b,this._toggle.bind(this));
this.$element.on("change:active",this._changeActive.bind(this));
this.$element.on("selectstart","h3",function(c){c.preventDefault()
});
this.on("change:disabled",function(c){this._updateDOMForDisabled()
}.bind(this))
},_updateDOMForDisabled:function(){if(this.options.disabled){this.$element.addClass("disabled").attr("aria-disabled",true).find("[role=tab], > [role=button]").removeAttr("tabindex").attr("aria-disabled",true)
}else{this.$element.removeClass("disabled").attr("aria-disabled",false).find("[role=tab], > [role=button]").each(function(b,c){var d=a(c);
d.removeAttr("aria-disabled").attr("tabindex",d.is("[aria-selected=true][aria-controls], [aria-expanded][aria-controls]")?0:-1)
})
}},_toggle:function(c){if(this.options.disabled){return
}var b=a(c.target).closest(".collapsible"),e=b.hasClass("active"),d=(e)?false:((this.isAccordion)?b.index():true);
this.setActive(d)
},_changeActive:function(){if(this.isAccordion){this._collapse(this.$element.children(".active"));
if(this.options.active!==false){var b=this.$element.children().eq(this.options.active);
this._expand(b)
}}else{if(this.options.active){this._expand(this.$element)
}else{this._collapse(this.$element)
}}},setActive:function(b){this.options.active=b;
this._changeActive()
},_initElement:function(d,f){if(a(d).find("> h3").length===0){a(d).prepend("<h3>&nbsp;</h3>")
}if(a(d).find("> h3 > i").length===0){a(d).find("> h3").prepend("<i></i>")
}a(d).addClass("collapsible");
var c=a(d).find("> h3"),b=a("<div></div>").toggle(!f),e=c.find("> i");
a(d).wrapInner(b);
c.prependTo(d);
if(f){a(d).removeClass("active");
a(d).height(c.height());
e.removeClass("icon-chevronup").addClass("icon-chevrondown")
}else{a(d).addClass("active");
a(d).css("height","auto");
e.removeClass("icon-chevrondown").addClass("icon-chevronup")
}},_collapse:function(d){d.find("> h3 > i").removeClass("icon-chevronup").addClass("icon-chevrondown");
d.animate({height:d.find("> h3").height()},{duration:"fast",complete:function(){d.removeClass("active");
d.find("> div[aria-expanded]").hide();
d.trigger("deactivate")
},progress:function(g,e,f){d.trigger("collapse",{animation:g,progress:e,remainingMs:f})
}});
var c=d.find("> h3"),b=c.next("div[aria-expanded]");
if(this.isAccordion){c.attr({tabindex:c.is(document.activeElement)?0:-1,"aria-selected":false})
}else{c.attr({"aria-expanded":false})
}b.attr({"aria-hidden":true,"aria-expanded":false})
},_expand:function(e){e.addClass("active");
e.find("> h3 > i").removeClass("icon-chevrondown").addClass("icon-chevronup");
var d=this._calcHeight(e);
e.animate({height:d},{duration:"fast",complete:function(){e.css("height","auto");
e.trigger("activate")
},progress:function(h,f,g){e.trigger("expand",{animation:h,progress:f,remainingMs:g})
}});
var c=e.find("> h3"),b=c.next("div[aria-expanded]");
if(this.isAccordion){c.attr({tabindex:0,"aria-selected":true})
}else{c.attr({"aria-expanded":true})
}b.attr({"aria-hidden":false,"aria-expanded":true}).show()
},_calcHeight:function(d){var b=a(d).clone(),e=b.find("> div[aria-expanded]");
e.show();
b.css({display:"block",position:"absolute",top:"-10000px",width:d.width(),height:"auto"});
d.parent().append(b);
var c=b.height();
b.remove();
return c
},_makeAccessible:function(){var f="accordion-"+new Date().getTime()+"-",g,d,b,e,c;
if(this.isAccordion){this.$element.attr({role:"tablist"});
this.$element.children(".collapsible").each(function(l,o){var n=a(o),k=n.find("> h3:first"),m=n.hasClass("active"),j=f+"panel-"+l,h=k.next("div");
n.attr({role:"presentation"});
k.attr({role:"tab",id:k.attr("id")||f+"tab-"+l,"aria-controls":j,"aria-selected":m,tabindex:(m?0:-1)});
h.attr({role:"tabpanel",id:j,"aria-labelledby":k.attr("id"),"aria-expanded":m,"aria-hidden":!m})
})
}else{f="collapsible-"+new Date().getTime()+"-";
g=this.$element;
d=g.find("> h3:first");
e=g.hasClass("active");
c=f+"panel";
b=d.next("div");
d.attr({role:"button",id:d.attr("id")||f+"heading","aria-controls":c,"aria-expanded":e,tabindex:0});
b.attr({id:c,"aria-labelledby":d.attr("id"),"aria-expanded":e,"aria-hidden":!e})
}this.$element.on("keydown",":focusable",this._onKeyDown.bind(this));
this.$element.on("focusin.accordion",":focusable",this._onFocusIn.bind(this));
this.$element.on("focusout.accordion","h3:focusable",this._onFocusOut.bind(this));
this.$element.on("touchstart.accordion, mousedown.accordion","h3:focusable",this._onMouseDown.bind(this))
},_onKeyDown:function(e){var d=a(e.currentTarget).closest(".collapsible"),b=d.find("> h3:first"),c=a(e.currentTarget).is(b),f=true;
switch(e.which){case 13:case 32:if(c){b.trigger("click")
}else{f=false
}break;
case 33:case 37:case 38:if((c&&this.isAccordion)||(e.which===33&&(e.metaKey||e.ctrlKey))){if(d.prev().find("> h3:first").focus().length===0){this.$element.find("> .collapsible:last > h3:first").focus()
}}else{if(!c&&(e.metaKey||e.ctrlKey)){b.focus()
}else{f=false
}}break;
case 34:case 39:case 40:if(c&&this.isAccordion){if(d.next().find("> h3:first").focus().length===0){this.$element.find("> .collapsible:first > h3:first").focus()
}}else{if(!c&&e.which===34&&(e.metaKey||e.ctrlKey)){b.focus()
}else{f=false
}}break;
case 36:if(c&&this.isAccordion){this.$element.find("> .collapsible:first > h3:first").focus()
}else{f=false
}break;
case 35:if(c&&this.isAccordion){this.$element.find("> .collapsible:last > h3:first").focus()
}else{f=false
}break;
default:f=false;
break
}if(f===true){e.preventDefault()
}},_onFocusIn:function(e){var d=a(e.currentTarget).closest(".collapsible"),b=d.find("> h3:first"),c=a(e.currentTarget).is(b);
if(this.options.disabled){return
}if(c){if(this.isAccordion){this.$element.find("> .collapsible > h3[role=tab]").attr("tabindex",-1)
}if(!b.data("collapsible-mousedown")){d.addClass("focus")
}else{b.removeData("collapsible-mousedown")
}}b.attr("tabindex",0)
},_onFocusOut:function(e){var d=a(e.currentTarget).closest(".collapsible"),b=d.find("> h3:first"),c=a(e.currentTarget).is(b);
if(c){d.removeClass("focus").removeData("collapsible-mousedown")
}},_onMouseDown:function(e){var d=a(e.currentTarget).closest(".collapsible"),b=d.find("> h3:first"),c=a(e.currentTarget).is(b);
if(c){b.data("collapsible-mousedown",true)
}}});
CUI.Widget.registry.register("accordion",CUI.Accordion);
a(document).on("cui-contentloaded.data-api",function(b){CUI.Accordion.init(a("[data-init~=accordion],[data-init~=collapsible]",b.target))
})
}(window.jQuery));
(function(a){CUI.Tour=new Class({toString:"Tour",extend:CUI.Widget,construct:function(c){var b;
this.$slides=this.$element.find(".tour-slide");
this.$navigation=this.$element.find("nav");
this.$skip=this.$navigation.find("button.skip");
this.$done=this.$navigation.find("button.done");
this.$prev=this.$navigation.find("a.prev");
this.$next=this.$navigation.find("a.next");
this.$control=this.$navigation.find(".control");
this.$current=this.$element.find(".tour-slide.active");
this.$current=this.$current.length>0?this.$current:this.$element.find(".tour-slide:eq(0)").addClass("active");
this._setCircleNav(this.$current);
this._toggleButtons(this.$current);
this._bindControls();
if(this.$element.hasClass("show")){this.options.autoshow=true
}if(this.options.autoshow){this.show()
}},defaults:{autoshow:false,backdrop:"static"},_toggleButtons:function(b){this.$skip.removeClass("show");
this.$done.removeClass("show");
this.$prev.removeClass("hide");
this.$next.removeClass("hide");
if(b.hasClass("first")){this.$skip.addClass("show");
this.$prev.addClass("hide")
}else{if(b.hasClass("last")||b.hasClass("skipper")){this.$done.addClass("show");
this.$next.addClass("hide")
}}},_setCircleNav:function(c){var b=c.index();
if(c.hasClass("skipper")){this.$control.removeClass("show").addClass("hide")
}else{this.$control.removeClass("hide").addClass("show").find("a").removeClass("active").filter(":eq("+b+")").addClass("active")
}},_slideTo:function(b){var c=a(b);
if(c.length>0){this.$current.find(".fadable").addClass("faded");
this.$current.removeClass("active");
this.$current=c.addClass("active");
this._setCircleNav(c);
this._toggleButtons(c);
this._stopLastAnimation();
this._startNewAnimation()
}},slideToNext:function(){var b=this.$current.next(".tour-slide");
if(!this.$current.hasClass("last")){this._slideTo(b)
}return this
},slideToPrev:function(){var b=this.$current.hasClass("skipper")?this.$element.find(".first"):this.$current.prev(".tour-slide");
this._slideTo(b);
return this
},slideToSkipper:function(){var b=this.$element.find(".skipper");
this._slideTo(b);
return this
},slideToFirst:function(){var b=this.$element.find(".first");
this._slideTo(b);
return this
},slideTo:function(b){this._slideTo(this.$slides[b]);
return this
},_bindControls:function(){this.$navigation.on("click","a",function(b){b.preventDefault()
});
this.$skip.fipo("tap","click",this.slideToSkipper.bind(this));
this.$done.fipo("tap","click",this.hide.bind(this));
this.$prev.fipo("tap","click",this.slideToPrev.bind(this));
this.$next.fipo("tap","click",this.slideToNext.bind(this));
this.$control.fipo("tap","click","a",function(b){this.slideTo(a(b.currentTarget).index())
}.bind(this));
this.$element.finger("swipe",".tour-slide",function(b){if(b.finger===1){if(b.direction==="left"){this.slideToNext()
}else{if(b.direction==="right"){this.slideToPrev()
}}}}.bind(this))
},_startNewAnimation:function(){var b=this.$current.find(".fadable");
if(b){this._animationTimer=setInterval(function(){b.toggleClass("faded")
},5000)
}},_stopLastAnimation:function(){clearInterval(this._animationTimer)
},_show:function(){this.$element.addClass("show");
this.slideToFirst();
this._toggleBackdrop(true);
this._startNewAnimation()
},_hide:function(){this.$element.removeClass("show");
this._toggleBackdrop();
this._stopLastAnimation()
},_removeBackdrop:function(){if(this.$backdrop&&!this.get("visible")){this.$backdrop.remove();
this.$backdrop=null
}},_toggleBackdrop:function(b){if(b&&this.options.backdrop){if(this.$backdrop){this.$backdrop.fadeIn()
}else{this.$backdrop=a("<div/>",{"class":"tour-backdrop",css:{display:"none"}}).appendTo(document.body);
setTimeout(function(){this.$backdrop.fadeIn()
}.bind(this),50);
if(this.options.backdrop!=="static"){this.$backdrop.click(this.hide)
}}}else{if(!b&&this.$backdrop){this.$backdrop.fadeOut(function(){this._removeBackdrop()
}.bind(this))
}}}});
CUI.util.plugClass(CUI.Tour);
if(CUI.options.dataAPI){a(document).on("cui-contentloaded.data-api",function(b){a("[data-init=tour]",b.target).tour()
})
}}(window.jQuery));
(function(c){var g='<div class="button-group navigation-bar"></div>';
var f="<button id='classicButton'><i class=\"icon-viewgrid\"></i></button>";
var a="<button id='editButton'><i class=\"icon-edit\"></i></button>";
var b='<button><i class="icon-properties"></i></button>';
var d="editMode";
var e="classicMode";
CUI.Colorpicker=new Class({toString:"Colorpicker",extend:CUI.Widget,defaults:{config:{colors:{},displayModes:{}},disabled:false,name:null,title:""},palettePageSize:3,colorShadeNo:6,lowerLimit:0,upperLimit:0,colorNames:[],currentPage:0,pages:1,construct:function(h){this._readDataFromMarkup();
this._adjustMarkup();
if(this.options.config===null||this.options.config.colors.length===0){this.options.disabled=true
}if(!this.options.disabled&&(this.options.config.displayModes.classicPalette&&this.options.config.displayModes.freestylePalette)){this.options.disabled=true
}if(!this.options.disabled&&(this.options.config.displayModes.length===0||(!this.options.config.displayModes.classicPalette&&!this.options.config.displayModes.freestylePalette))){this.options.config.displayModes.classicPalette=true
}this.$openButton=this.$element.find("input.colorpicker-launcher");
this.$hiddenInput=this.$element.find("input[name='"+this.options.name+"']");
if(this.$element.attr("value")){var i=this.$element.attr("value");
if(CUI.util.color.isValid("rgba",i)||CUI.util.color.isValid("rgb",i)){this._setColor(i)
}else{this.$element.removeAttr("value")
}}if(this.options.disabled){this.$element.find(">input").attr("disabled","disabled")
}else{this.colorNames=[];
c.each(this.options.config.colors,function(j,k){this.colorNames.push(j)
}.bind(this));
c("body").off("tap."+this.options.name+" click."+this.options.name).fipo("tap."+this.options.name,"click."+this.options.name,function(j){if(!this.keepShown){if(this.$element.find(".popover").has(j.target).length===0){this._hidePicker()
}}}.bind(this));
this.$openButton.on("click",function(j){try{if(!this.pickerShown){this._openPicker()
}else{this._hidePicker()
}this.keepShown=true;
setTimeout(function(){this.keepShown=false
}.bind(this),200)
}catch(k){}}.bind(this))
}},_readDataFromMarkup:function(){if(this.$element.data("disabled")){this.options.disabled=true
}if(this.$element.data("name")){this.options.name=this.$element.data("name")
}if(this.$element.attr("title")){this.options.title=this.$element.attr("title")
}var h=this.$element;
if(h.data("config")!==undefined){this.options.config={};
this.options.config.colors={};
this.options.config.displayModes={};
if(h.data("config").colors){this.options.config.colors=h.data("config").colors
}else{this.options.disabled=true
}if(h.data("config").pickerModes){this.options.config.displayModes=h.data("config").pickerModes
}}},_adjustMarkup:function(){this.$element.addClass("colorpicker");
if(this.$element.find(".popover").length===0){this.$element.append('<div class="popover arrow-top" style="display:none"><div class="inner"></div></div>');
this.$element.find(".inner").append('<div class="colorpicker-holder"><div class="palette-header"></div><div class="colorpicker-body"></div><div class="colorpicker-footer"></div></div>')
}if(this.$element.find("input[type=hidden]").length===0){this.$element.append('<input type="hidden" name="'+this.options.name+'">')
}var h=this.$element.find("input.colorpicker-launcher");
if(h.attr("type")===undefined){h.attr("type","button")
}},_openPicker:function(){this._renderPicker(e);
var i=this.$openButton.position().left+this.$openButton.width()/2-(this.$element.find(".popover").width()/2+9);
if(i<0){i=0
}var h=this.$openButton.position().top+this.$openButton.outerHeight()+14;
this._renderPickerFooter();
this.$element.find(".popover").css({position:"absolute",left:i+"px",top:h+"px"}).show();
this.pickerShown=true
},_hidePicker:function(){this.lowerLimit=0;
this.upperLimit=0;
this.currentPage=0;
this.$element.removeClass("focus");
this.$element.find(".popover").hide();
this.pickerShown=false
},_renderPicker:function(o,n,h){if(o===e&&!this._calculatePaletteBoundaries(n,h)){return
}var q=null;
if(o===e){q=this._renderPalette()
}else{q=this._renderEditPalette()
}var k=this.$element.find(".colorpicker-holder");
var i=k.find(".palette-navigator");
var m=k.find(".colorpicker-body");
if(n&&k.find("table").length>0){this._slidePicker(q,(n==="left"))
}else{k.find("table").remove();
k.find(".sliding-container").remove();
if(o===d){m.append(q);
i.remove();
if(this.$hiddenInput.val()!==undefined&&this.$hiddenInput.val().length>0){q.find("div.color").css("background",this.$hiddenInput.val());
var l=CUI.util.color.RGBAToHex(this.$hiddenInput.val());
q.find("input[name=':hex']").val(l);
var p=CUI.util.color.HexToRGB(l);
this._fillRGBFields(p);
var j=CUI.util.color.RGBtoCMYK(p);
this._fillCMYKFields(j)
}}else{if(i.length>0){i.before(q)
}else{m.append(q);
this._renderPaletteNavigation()
}}}},_renderPickerFooter:function(){this.$element.find(".colorpicker-footer").html(g);
if(this.options.config.displayModes!==undefined){if(this.options.config.displayModes.classicPalette||this.options.config.displayModes.freestylePalette){var h=c(f);
h.addClass("selected");
this.$element.find(".navigation-bar").append(h)
}if(this.options.config.displayModes.edit){this.$element.find(".navigation-bar").append(a)
}else{this.$element.find(".colorpicker-footer").remove();
return
}}this.$element.find(".colorpicker-footer button").off("tap.button click.button").fipo("tap.button","click.button",function(j){j.stopPropagation();
j.preventDefault();
var i=c(j.target);
var k=null;
this.$element.find(".navigation-bar > .selected").removeClass("selected");
if(j.target.nodeName==="BUTTON"){i.addClass("selected");
k=c(j.target)
}else{i.parent().addClass("selected");
k=i.parent()
}if(k.attr("id")==="editButton"){this._renderPicker(d)
}else{this._renderPicker(e,false,this.currentPage)
}}.bind(this))
},_calculatePaletteBoundaries:function(h,j){var i=0;
if(this.options.config.displayModes.freestylePalette){i=this.palettePageSize*this.colorShadeNo
}else{i=this.palettePageSize
}if(!h){if(j!==undefined){this.lowerLimit=i*j;
this.upperLimit=this.lowerLimit+i-1;
this.currentPage=j
}else{this.upperLimit+=i-1;
this.lowerLimit=0;
this.currentPage=0
}}else{if(h==="left"){j=this.currentPage+1;
if(j+1>this.pages){return false
}this.lowerLimit=i*j;
this.upperLimit=this.lowerLimit+i-1;
this.currentPage=j
}else{j=this.currentPage-1;
if(j<0){return false
}this.lowerLimit=i*j;
this.upperLimit=this.lowerLimit+i-1;
this.currentPage=j
}}return true
},_renderPaletteNavigation:function(){this.$element.find(".palette-navigator").remove();
var h=c("<div>");
h.addClass("palette-navigator");
if(this.options.config.displayModes.classicPalette){this.pages=Math.ceil(this.colorNames.length/this.palettePageSize)
}else{this.pages=Math.ceil(this.colorNames.length/(this.palettePageSize*this.colorShadeNo))
}if(this.pages>1){for(var j=0;
j<this.pages;
j++){h.append("<i class='dot' page='"+j+"'></i>")
}}this.$element.find(".colorpicker-body").append(h);
this.$element.find("i[page='"+this.currentPage+"']").addClass("active");
this.$element.find(".colorpicker-body").on("swipe",function(i){this._renderPicker(e,i.direction==="left"?"left":"right")
}.bind(this));
this.$element.find(".dot").off("tap.dot click.dot").fipo("tap.dot","click.dot",function(i){i.stopPropagation();
if(this.currentPage===parseInt(c(i.target).attr("page"),10)){return
}this._renderPicker(e,false,parseInt(c(i.target).attr("page"),10))
}.bind(this))
},_slidePicker:function(j,n){this.$element.find(".sliding-container table").stop(true,true);
this.$element.find(".sliding-container").remove();
var m=this.$element.find("table");
var k=m.width();
var h=m.height();
var i=c('<div class="sliding-container">');
i.css({display:"block",position:"relative",width:k+"px",height:h+"px",overflow:"hidden"});
this.$element.find(".palette-navigator").before(i);
i.append(m).append(j);
m.css({position:"absolute",left:0,top:0});
m.after(j);
j.css({position:"absolute",left:(n)?k:-k,top:0});
var l=400;
m.animate({left:(n)?-k:k},l,function(){m.remove()
});
j.animate({left:0},l,function(){if(i.parents().length===0){return
}j.css({position:"relative",left:0,top:0});
j.detach();
this.$element.find(".palette-navigator").before(j);
i.remove()
}.bind(this))
},_renderPaletteHeader:function(){var i=c('<div class="palette-header"><div class="title"></div><div class="selection"></div></div>');
var h=this.$element.find(".colorpicker-holder");
if(h.find(".palette-header").length>0){h.find(".palette-header").replaceWith(i)
}else{h.prepend(i)
}h.find(".title").html("<span>"+this.options.title+"</span>")
},_renderPalette:function(){this._renderPaletteHeader();
var p=c("<table>");
var j="";
for(var h=0;
h<this.palettePageSize;
h++){j+="<tr>";
var l=0;
var n="";
var q="";
var o="";
for(var k=0;
k<this.colorShadeNo;
k++){if(this.options.config.displayModes.classicPalette){if(this.colorNames.length-1<h+this.lowerLimit){j+="<td><a></a></td>"
}else{n=CUI.util.color.HexToRGB(this.options.config.colors[this.colorNames[h+this.lowerLimit]]);
o="rgba("+n.r+","+n.g+","+n.b+","+(1-l).toFixed(2)+")";
l+=0.16;
if(CUI.util.color.isSameColor(o,this.$hiddenInput.val())){q="selected";
this._fillSelectedColor(this.colorNames[h+this.lowerLimit],CUI.util.color.RGBAToHex(o))
}else{q=""
}j+="<td class='filled'><a style='background-color:"+o+"' color='"+o+"' colorName='"+this.colorNames[h+this.lowerLimit]+"' class='"+q+"'></a></td>"
}}else{if(this.colorNames.length-1<h*this.colorShadeNo+k){j+="<td><a></a></td>"
}else{n=CUI.util.color.HexToRGB(this.options.config.colors[this.colorNames[h*this.colorShadeNo+k]]);
o="rgba("+n.r+","+n.g+","+n.b+","+1+")";
if(CUI.util.color.isSameColor(o,this.$hiddenInput.val())){q="selected"
}else{q=""
}j+="<td class='filled'><a style='background-color:"+o+"' color='"+o+"' colorName='"+this.colorNames[h*this.colorShadeNo+k]+"' class='"+q+"'></a></td>"
}}}j+="</tr>"
}p.append("<tbody>"+j+"</tbody>");
p.find("a").off("tap.a click.a").fipo("tap.a","click.a",function(r){r.stopPropagation();
r.preventDefault();
if(CUI.util.color.isSameColor(this.$hiddenInput.val(),c(r.target).attr("color"))){return
}this.$element.find("table").find(".selected").removeClass("selected");
c(r.target).addClass("selected");
var i=c(r.target).attr("colorName")!==undefined?c(r.target).attr("colorName"):"";
this._fillSelectedColor(i,CUI.util.color.RGBAToHex(c(r.target).attr("color")));
this._setColor(c(r.target).attr("color"))
}.bind(this));
var m=this.$element.find(".palette-navigator");
m.find(".active").removeClass("active");
m.find("i[page='"+this.currentPage+"']").addClass("active");
return p
},_fillSelectedColor:function(h,i){this.$element.find(".colorpicker-holder").find(".selection").html("<div><span>"+h+"</span><span>"+i+"</span></div>")
},_renderEditPalette:function(){var i=c("<table>");
var h="<tr><td colspan='2' rowspan='2'><div class='color'></div></td><td class='label'>HEX</td><td colspan='2'><input type='text' name=':hex'/></td><td colspan='2'>&nbsp;</td></tr><tr><td class='label'>RGB</td><td><input type='text' name=':rgb_r'/></td><td><input type='text' name=':rgb_g'/></td><td><input type='text' name=':rgb_b'/></td><td>&nbsp;</td></tr><tr><td colspan='2'>&nbsp;</td><td class='label'>CMYK</td><td><input type='text' name=':cmyk_c'/></td><td><input type='text' name=':cmyk_m'/></td><td><input type='text' name=':cmyk_y'/</td><td><input type='text' name=':cmyk_k'/></td></tr><tr><td colspan='3'>&nbsp;</td><td colspan='4'><button class='primary'>Save Color</button></td></tr>";
i.append("<tbody>"+h+"</tbody>");
this.$element.find(".palette-header").remove();
i.find("input[name^=':rgb_']").each(function(j,k){c(k).attr("maxlength","3");
c(k).on("blur",function(o){var p=/^([0]|[1-9]\d?|[1]\d{2}|2([0-4]\d|5[0-5]))$/;
if(!p.test(c(o.target).val().trim())||c("input:text[value=''][name^='rgb_']").length>0){c(o.target).val("");
this._clearCMYKFields();
this.$element.find("input[name=':hex']").val("");
this.$element.find("div.color").removeAttr("style");
return
}var l={r:this.$element.find("input[name=':rgb_r']").val(),g:this.$element.find("input[name=':rgb_g']").val(),b:this.$element.find("input[name=':rgb_b']").val()};
var n=CUI.util.color.RGBtoCMYK(l);
var m=CUI.util.color.RGBToHex(l);
this._fillCMYKFields(n);
this.$element.find("input[name=':hex']").val(m);
this.$element.find("div.color").css("background",m)
}.bind(this))
}.bind(this));
i.find("input[name^=':cmyk_']").each(function(j,k){c(k).attr("maxlength","3");
c(k).on("blur",function(o){var p=/^[1-9]?[0-9]{1}$|^100$/;
if(!p.test(c(o.target).val().trim())||c("input:text[value=''][name^='cmyk_']").length>0){c(o.target).val("");
this._clearRGBFields();
this.$element.find("input[name=':hex']").val("");
this.$element.find("div.color").removeAttr("style");
return
}var n={c:this.$element.find("input[name=':cmyk_c']").val(),m:this.$element.find("input[name=':cmyk_m']").val(),y:this.$element.find("input[name=':cmyk_y']").val(),k:this.$element.find("input[name=':cmyk_k']").val()};
var l=CUI.util.color.CMYKtoRGB(n);
var m=CUI.util.color.RGBToHex(l);
this.$element.find("input[name=':hex']").val(m);
this._fillRGBFields(l);
this.$element.find("div.color").css("background",m)
}.bind(this))
}.bind(this));
i.find("input[name=':hex']").each(function(j,k){c(k).attr("maxlength","7");
c(k).on("blur",function(o){var n=CUI.util.color.fixHex(c(o.target).val().trim());
if(n.length===0){this._clearRGBFields();
this._clearCMYKFields();
this.$element.find("div.color").removeAttr("style");
return
}var l=CUI.util.color.HexToRGB(n);
var m=CUI.util.color.RGBtoCMYK(l);
this._fillRGBFields(l);
this._fillCMYKFields(m);
i.find("div.color").css("background",n)
}.bind(this))
}.bind(this));
i.on("click tap","input, div",function(j){j.stopPropagation();
j.preventDefault()
});
i.on("click tap","button",function(j){j.stopPropagation();
j.preventDefault();
if(this.$element.find("input[name=':hex']").val()!==undefined&&this.$element.find("input[name=':hex']").val().length>0){this._setColor(this.$element.find("input[name=':hex']").val())
}}.bind(this));
return i
},_setColor:function(h){this.$hiddenInput.val(h);
this.$openButton.css("background-color",this.$hiddenInput.val())
},_fillRGBFields:function(h){this.$element.find("input[name=':rgb_r']").val(h.r);
this.$element.find("input[name=':rgb_g']").val(h.g);
this.$element.find("input[name=':rgb_b']").val(h.b)
},_clearRGBFields:function(){this.$element.find("input[name^=':rgb']").val("")
},_fillCMYKFields:function(h){this.$element.find("input[name=':cmyk_c']").val(h.c);
this.$element.find("input[name=':cmyk_m']").val(h.m);
this.$element.find("input[name=':cmyk_y']").val(h.y);
this.$element.find("input[name=':cmyk_k']").val(h.k)
},_clearCMYKFields:function(){this.$element.find("input[name^=':cmyk']").val("")
}});
CUI.Widget.registry.register("colorpicker",CUI.Colorpicker);
if(CUI.options.dataAPI){c(document).on("cui-contentloaded.data-api",function(h){CUI.Colorpicker.init(c("[data-init~=colorpicker]",h.target))
})
}}(window.jQuery));
(function(a){CUI.NumberInput=new Class({toString:"NumberInput",extend:CUI.Widget,construct:function(b){this._fixMarkup();
this._setListeners();
this._setAttributes()
},defaults:{max:null,min:null,step:1,hasError:false,disabled:false},increment:function(){if(this._isNumber()){var b=this.getValue();
b+=this.getStep();
b=b>this.getMax()?this.getMax():b;
this.setValue(b)
}},decrement:function(){var b=this.getValue();
b-=this.getStep();
b=b<this.getMin()?this.getMin():b;
this.setValue(b)
},setValue:function(b){this.$input.val(b);
this.$input.trigger("change")
},setMin:function(b){this.set("min",b)
},setMax:function(b){this.set("max",b)
},setStep:function(b){this.set("step",b)
},getValue:function(){var b=this.$input.val();
if(typeof b=="undefined"||b==null||b.length<1){b=""
}else{b=parseFloat(b)
}return b
},getMin:function(){return parseFloat(this.options.min)
},getMax:function(){return parseFloat(this.options.max)
},getStep:function(){return parseFloat(this.options.step)
},_fixMarkup:function(){this.$input=this.$element.find("input").not("[type=hidden]");
if(this.$input.attr("type")!="text"){this._switchInputTypeToText(this.$input)
}var b=this.$element.find("button");
if(b&&b.length==2){this.$decrementElement=a(b[0]);
this.$incrementElement=a(b[1])
}else{a.each(b,function(c){a(b[c]).detach()
});
this.$decrementElement=a('<button type="button">');
this.$incrementElement=a('<button type="button">');
this.$input.before(this.$decrementElement);
this.$input.after(this.$incrementElement)
}this.$decrementElement.addClass("decrement").html("decrement");
this.$incrementElement.addClass("increment").html("increment")
},_setListeners:function(){this.$input.on("change",function(){this._checkMinMaxViolation();
this._adjustValueLimitedToRange()
}.bind(this));
this.on("beforeChange:step",function(b){this._optionBeforeChangeHandler(b)
}.bind(this));
this.on("beforeChange:min",function(b){this._optionBeforeChangeHandler(b)
}.bind(this));
this.on("beforeChange:max",function(b){this._optionBeforeChangeHandler(b)
}.bind(this));
this.on("change:disabled",function(b){this._toggleDisabled()
}.bind(this));
this.on("change:hasError",function(b){this._toggleError()
}.bind(this));
this.$incrementElement.on("click",function(){this.increment()
}.bind(this));
this.$decrementElement.on("click",function(b){this.decrement()
}.bind(this))
},_setAttributes:function(){this.$element.addClass("numberinput");
if(this.$input.attr("max")){this.setMax(this.$input.attr("max"))
}if(this.$input.attr("min")){this.setMin(this.$input.attr("min"))
}if(this.$input.attr("step")){this.setStep(this.$input.attr("step"))
}if(this.$element.attr("error")){this.options.hasError=true
}this.setStep(this.options.step||CUI.Datepicker.step);
this.setValue(this.$input.val()||0);
if(this.$element.attr("disabled")||this.$element.attr("data-disabled")){this._toggleDisabled()
}if(this.$element.hasClass("error")||this.$element.attr("data-error")){this.set("hasError",true)
}},_adjustValueLimitedToRange:function(){var b=this.getValue();
if(!isNaN(b)){if(b>this.getMax()){b=this.getMax()
}else{if(b<this.getMin()){b=this.getMin()
}}}this.$input.val(b)
},_checkMinMaxViolation:function(){if(this._isNumber()){this.$incrementElement.removeAttr("disabled");
this.$decrementElement.removeAttr("disabled");
if(this.options.max&&this.getValue()>=this.getMax()){this.$incrementElement.attr("disabled","disabled")
}else{if(this.options.min&&this.getValue()<=this.getMin()){this.$decrementElement.attr("disabled","disabled")
}}}},_switchInputTypeToText:function(c){var b=c.detach().attr("type","text");
this.$element.prepend(b)
},_isNumber:function(){return !isNaN(this.$input.val())
},_optionBeforeChangeHandler:function(b){if(isNaN(parseFloat(b.value))){b.preventDefault()
}},_toggleDisabled:function(){if(this.options.disabled){this.$incrementElement.attr("disabled","disabled");
this.$decrementElement.attr("disabled","disabled");
this.$input.attr("disabled","disabled")
}else{this.$incrementElement.removeAttr("disabled");
this.$decrementElement.removeAttr("disabled");
this.$input.removeAttr("disabled")
}},_toggleError:function(){if(this.options.hasError){this.$element.addClass("error")
}else{this.$element.removeClass("error")
}}});
CUI.Widget.registry.register("numberinput",CUI.NumberInput);
a(document).on("cui-contentloaded.data-api",function(b){CUI.NumberInput.init(a("[data-init~=numberinput]",b.target))
})
}(window.jQuery));
(function(a){function b(d){var c=d.next();
if(c.length>0){return c
}return d.prevAll().last()
}CUI.CycleButtons=new Class({toString:"CycleButtons",extend:CUI.Widget,construct:function(){this.$element.on("click tap",function(f){if(f._cycleButtons){return
}f.stopPropagation();
f.preventDefault();
var c=a(this);
if(c.children().length===1){return
}var h=c.children(".cyclebuttons-active");
var g=b(h);
h.removeClass("cyclebuttons-active");
g.addClass("cyclebuttons-active");
var d=a.Event("click",{_cycleButtons:true});
g.trigger(d)
})
}});
CUI.Widget.registry.register("cyclebuttons",CUI.CycleButtons);
a(document).on("cui-contentloaded.data-api",function(c){CUI.CycleButtons.init(a("[data-init~='cyclebuttons']",c.target))
})
}(window.jQuery));
(function(b,a,c){CUI.Select=new Class({toString:"Select",extend:CUI.Widget,construct:function(){var d=this;
this._button=this.$element.children("button");
this._select=this.$element.children("select");
this._selectList=this.$element.children(".selectlist");
this._tagList=this.$element.children(".taglist");
this._valueInput=this.$element.children("input[type=hidden]");
this.applyOptions()
},defaults:{type:"static",nativewidget:false,nativewidgetonmobile:true,multiple:false,tagConfig:null,selectlistConfig:null},applyOptions:function(){var d=this.options.nativewidgetonmobile&&CUI.util.isTouch&&this.options.type==="static";
if(this._select.length>0){if(this._select.prop("multiple")){this.options.multiple=true
}}if(this.options.nativewidget||d){this._setNativeWidget(d)
}else{this._setSelectList()
}this._setTagList();
if(this.options.type==="static"){this._handleNativeSelect()
}},getValue:function(){if(this.options.multiple){return this._tagListWidget.getValues()
}else{if(this.options.type==="static"){return this._select[0][this._select[0].selectedIndex].value
}else{if(this.options.type==="dynamic"){return this._valueInput.val()
}}}return null
},_setNativeWidget:function(e){var d=this;
if(this.options.nativewidget||e){this.$element.addClass("native");
this._select.css({height:this._button.outerHeight()});
if(this.options.multiple){this._setTagList()
}this._select.on("change.select",this._handleNativeSelect.bind(this))
}else{this.$element.removeClass("native");
this._select.off("change.select")
}},_handleNativeSelect:function(f){var d=this,e,g;
if(d.options.multiple){b.each(d._select[0].options,function(j,h){if(h.selected){d._tagListWidget.addItem({value:h.value,display:h.text})
}else{d._tagListWidget.removeItem(h.value)
}});
e=d._tagListWidget.getValues()
}else{if(d._select[0]){g=d._select[0][d._select[0].selectedIndex];
d._button.text(g.text);
e=g.value
}}if(f){this.$element.trigger(b.Event("selected",{selected:e}))
}},_parseMarkup:function(){var e=this,f=this._select.children("optgroup");
function d(h,g){h.children("option").each(function(k,l){var j=b(l);
b("<li/>",{"data-value":j.val(),text:j.text()}).appendTo(g)
})
}if(f.length>0){f.each(function(g,k){var j=b(k),h=b("<li/>",{"class":"optgroup"}).append(b("<span/>",{text:j.attr("label")}));
d(j,b("<ul/>").appendTo(h));
e._selectList.append(h)
})
}else{d(this._select,this._selectList)
}},_setSelectList:function(){var d=this,e="static";
if(this._selectList.length===0){this._selectList=b("<ul/>",{id:CUI.util.getNextId(),"class":"selectlist"}).appendTo(this.$element)
}else{if(!this._selectList.attr("id")){this._selectList.attr("id",CUI.util.getNextId())
}}this._button.attr({"data-toggle":"selectlist","data-target":"#"+this._selectList.attr("id")});
if(this._select.length>0){this._parseMarkup()
}else{e="dynamic"
}this._selectList.selectList(b.extend({relatedElement:this._button,type:e},this.options.selectlistConfig||{}));
this._selectListWidget=this._selectList.data("selectList");
this._selectList.on("selected.select",this._handleSelected.bind(this)).on("show.select hide.select",function(f){d._button.toggleClass("active",f.type==="show")
})
},_setTagList:function(){if(this.options.multiple){if(this._tagList.length===0){this._tagList=b("<ol/>",{"class":"taglist"}).appendTo(this.$element)
}this._tagList.tagList(this.options.tagConfig||{});
this._tagListWidget=this._tagList.data("tagList")
}},_handleSelected:function(e){var d;
if(e){e.stopPropagation()
}this._selectListWidget.hide();
if(e.selectedValue===true){this._select.find("option[value=true]").prop("selected","selected")
}else{this._select.val(e.selectedValue)
}if(this.options.multiple){this._tagListWidget.addItem({value:e.selectedValue,display:e.displayedValue});
d=this._tagListWidget.getValues()
}else{this._button.text(e.displayedValue);
this._valueInput.val(e.selectedValue);
d=""+e.selectedValue
}this._button.trigger("focus");
this.$element.trigger(b.Event("selected",{selected:d}))
}});
CUI.Widget.registry.register("select",CUI.Select);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(d){CUI.Select.init(b("[data-init~=select]",d.target))
})
}}(jQuery,this));
(function(f,e,g){CUI.SelectList=new Class({toString:"SelectList",extend:CUI.Widget,construct:function(h){this.applyOptions();
this.$element.on("change:type",this._setType.bind(this)).on("click",this._SELECTABLE_SELECTOR,this._triggerSelected.bind(this)).on("mouseenter",this._SELECTABLE_SELECTOR,this._handleMouseEnter.bind(this));
this._makeAccessible()
},defaults:{type:"static",multiple:false,relatedElement:null,autofocus:true,autohide:true,dataurl:null,dataurlformat:"html",datapaging:true,datapagesize:10,dataadditional:null,loadData:f.noop,position:"center bottom-1"},_SELECTABLE_SELECTOR:'[role="option"]:visible:not([aria-disabled="true"])',applyOptions:function(){this._setType()
},_setType:function(){var i=this,j;
function h(){var l=i.$element.get(0),k=l.scrollHeight,m=l.scrollTop;
if((k-i.$element.height())<=(m+30)){i._handleLoadData()
}}if(this.options.type==="dynamic"){this.$element.on("scroll.selectlist-dynamic-load",function(k){if(j){clearTimeout(j)
}if(i._loadingComplete||this._loadingIsActive){return
}j=setTimeout(h,500)
})
}else{this.$element.off("scroll.selectlist-dynamic-load")
}},_makeAccessible:function(){var h=this;
this.$element.attr({role:"listbox","aria-controls":f(this.options.relatedElement).attr("id")||"","aria-hidden":true,"aria-multiselectable":this.options.multiple});
this._makeAccessibleListOption(this.$element.children())
},_handleKeyDown:function(k){var i=this.$element.find(this._SELECTABLE_SELECTOR),j=i.filter(".focus"),h=i.index(j),l;
if(!i.length){return
}switch(k.which){case 13:case 32:if(j.length){j.trigger("click");
k.preventDefault()
}break;
case 27:this.hide();
k.preventDefault();
break;
case 33:case 37:case 38:if(h>0){l=i[h-1]
}else{if(h==-1){l=i[i.length-1]
}}k.preventDefault();
break;
case 34:case 39:case 40:if(h+1<i.length){l=i[h+1]
}k.preventDefault();
break;
case 36:l=i[0];
k.preventDefault();
break;
case 35:l=i[i.length-1];
k.preventDefault();
break
}if(l!==g){this.setCaretToItem(f(l),true)
}},_makeAccessibleListOption:function(h){h.each(function(j,l){var k=f(l);
if(k.hasClass("optgroup")){k.attr({role:"presentation"}).children("ul").attr({role:"group"}).children("li").attr({role:"option"})
}else{k.attr({role:"option"})
}})
},setCaretToItem:function(h,i){this.$element.find('[role="option"]').removeClass("focus");
h.addClass("focus");
if(i){this.scrollToItem(h)
}},resetCaret:function(){this.$element.find('[role="option"]').removeClass("focus");
this.$element.scrollTop(0)
},scrollToItem:function(h){if(!h.length){return
}var i=h.position().top,l=h.outerHeight(false),j=this.$element[0];
var k=i+l-j.clientHeight;
if(k>0){j.scrollTop+=k
}else{if(i<0){j.scrollTop+=i
}}},show:function(){if(this.options.visible){return this
}else{b();
return this.inherited(arguments)
}},_show:function(){var h=this;
this.$element.addClass("visible").attr("aria-hidden",false);
this.$element.position({my:"top",at:this.options.position,of:this.options.relatedElement});
if(this.options.autofocus){this.setCaretToItem(this.$element.find(this._SELECTABLE_SELECTOR).first(),true)
}if(this.options.type==="dynamic"){this._handleLoadData().done(function(){if(h.options.autofocus){h.setCaretToItem(h.$element.find(h._SELECTABLE_SELECTOR).first(),true)
}})
}f(document).on("keydown.selectlist",this._handleKeyDown.bind(this))
},_hide:function(){this.$element.removeClass("visible").attr("aria-hidden",true);
this.reset();
f(document).off("keydown.selectlist")
},_triggerSelected:function(h){var k=f(h.currentTarget),j=k.data("value"),i=k.text();
k.trigger(f.Event("selected",{selectedValue:j,displayedValue:i}))
},_handleMouseEnter:function(h){this.setCaretToItem(f(h.currentTarget),false)
},clearItems:function(){this.$element.empty()
},_pagestart:0,_loadingComplete:false,_loadingIsActive:false,_handleLoadData:function(){var k,i=this,h=this._pagestart+this.options.datapagesize,j=f("<div/>",{"class":"selectlist-wait"}).append(f("<span/>",{"class":"wait"}));
if(this._loadingIsActive){return f.Deferred().resolve().promise()
}this._loadingIsActive=true;
this.$element.append(j);
if(this.options.dataurl){k=f.ajax({url:this.options.dataurl,context:this,dataType:this.options.dataurlformat,data:f.extend({start:this._pagestart,end:h},this.options.dataadditional||{})}).done(function(n){var l=0;
if(i.options.dataurlformat==="html"){var m=f(n);
l=m.filter("li").length;
i._makeAccessibleListOption(m);
i.$element.append(m)
}if(l<i.options.datapagesize){this._loadingComplete=true
}})
}else{k=this.options.loadData.call(this,this._pagestart,h)
}this._pagestart=h;
k.always(function(){j.remove();
i._loadingIsActive=false
});
return k
},reset:function(){if(this.options.type==="dynamic"){this.clearItems();
this._pagestart=0;
this._loadingComplete=false
}},triggerLoadData:function(h){if(h){this.reset()
}this._handleLoadData()
},filter:function(j){var i=this.$element.find('[role="option"]'),h=this.$element.find(".optgroup");
if(j){i.each(function(){var k=f(this);
var l=!j.call(this,k.data("value"),k.text());
k.toggleClass("hidden",l);
if(l){k.removeClass("focus")
}});
h.each(function(){var l=f(this);
var k=l.find('[role="option"]:not(.hidden)').length>0;
l.toggleClass("hidden",!k)
})
}else{i.removeClass("hidden");
h.removeClass("hidden")
}}});
CUI.Widget.registry.register("selectlist",CUI.SelectList);
if(CUI.options.dataAPI){f(document).on("cui-contentloaded.data-api",function(h){CUI.SelectList.init(f("[data-init~=selectlist]",h.target))
})
}var a=".selectlist",d="[data-toggle~=selectlist]";
var b=function(){f(".selectlist").each(function(){var h=f(this).data("selectList");
if(h&&h.get("autohide")){h.hide()
}})
};
var c=function(){var h=CUI.util.getDataTarget(f(this));
if(h.length){h.data("selectList").toggleVisibility()
}return false
};
f(document).on("click.selectlist",b).on("click.selectlist",a,function(h){h.stopPropagation()
}).on("click.selectlist",d,c)
}(jQuery,this));
(function(b,a,c){CUI.TagList=new Class({toString:"TagList",extend:CUI.Widget,construct:function(e){var d=this;
this.applyOptions();
this.$element.on("change:values",this._setValues.bind(this));
this.$element.fipo("tap","click","button",function(g){var f=b(g.currentTarget).next("input");
d.removeItem(f.val())
});
this._makeAccessible()
},defaults:{fieldname:"",values:null,tag:"li"},_existingValues:null,applyOptions:function(){var d=this;
this._existingValues=[];
this.options.values=this.options.values||[];
if(this.options.values.length>0){this._setValues()
}else{this.$element.find("input").each(function(f,h){var g=b(h);
d._existingValues.push(g.attr("value"))
})
}},_setValues:function(){var d=this.options.values;
this.$element.empty();
this.options.values=[];
this.addItem(d)
},_makeAccessible:function(){this.$element.attr({role:"list"});
this.$element.children(this.options.tag).attr({role:"listitem"})
},_show:function(){this.$element.show().attr("aria-hidden",false)
},_hide:function(){this.$element.hide().attr("aria-hidden",true)
},_removeItem:function(e){var d=this.$element.find('input[value="'+e+'"]');
if(d.length>0){d.parent().remove();
this.$element.trigger(b.Event("itemremoved",{value:e}))
}},_appendItem:function(e){var f,g,d;
if(b.type(e)==="string"){f=g=e
}else{f=e.display;
g=e.value
}g+="";
if((b.inArray(g,this._existingValues)>-1)||g.length===0){return
}this._existingValues.push(g);
d=b("<"+this.options.tag+"/>",{role:"listitem",text:f});
b("<button/>",{"class":"icon-close"}).prependTo(d);
b("<input/>",{type:"hidden",value:g,name:this.options.fieldname}).appendTo(d);
this.$element.append(d);
this.$element.trigger(b.Event("itemadded"),{value:g,display:f})
},removeItem:function(e){var d=this._existingValues.indexOf(""+e);
if(d>-1){this._removeItem(e);
this._existingValues.splice(d,1)
}},addItem:function(f){var e=this,d=b.isArray(f)?f:[f];
b.each(d,function(g,h){e._appendItem(h)
})
},getValues:function(){return this._existingValues.slice(0)
}});
CUI.Widget.registry.register("taglist",CUI.TagList);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(d){CUI.TagList.init(b("[data-init~=taglist]",d.target))
})
}}(jQuery,this));
(function(c){var b=".cui-dragaction";
function e(g){while(true){var h=g.parent();
if(h.length===0){return h
}if(h.is("body")){return h
}var f=h.css("overflow");
if(f==="hidden"||f==="auto"||f==="scroll"){return h
}g=h
}}function d(f){var h={};
if(f.originalEvent){var g=f.originalEvent;
if(g.changedTouches&&g.changedTouches.length>0){h=g.changedTouches[0]
}if(g.touches&&g.touches.length>0){h=g.touches[0]
}}return{x:h.pageX||f.pageX,y:h.pageY||f.pageY}
}function a(f,i,g){var h=g.offset();
return f>=h.left&&f<(h.left+g.outerWidth())&&i>=h.top&&i<h.top+g.outerHeight()
}CUI.DragAction=new Class({construct:function(i,j,g,f,h){this.sourceElement=j;
this.dragElement=g;
this.container=e(g);
this.containerHeight=this.container.get(0).scrollHeight;
this.dropZones=f;
this.axis=h;
this.scrollZone=20;
this.dragStart(i)
},currentDragOver:null,dragStart:function(g){g.preventDefault();
var h=this.dragElement.position();
var f=d(g);
this.dragElement.css({left:h.left,top:h.top,width:this.dragElement.width()+"px"}).addClass("dragging");
this.dragStart={x:f.x-h.left,y:f.y-h.top};
c(document).fipo("touchmove"+b,"mousemove"+b,this.drag.bind(this));
c(document).fipo("touchend"+b,"mouseup"+b,this.dragEnd.bind(this));
this.sourceElement.trigger(this._createEvent("dragstart",g));
this.drag(g)
},drag:function(l){l.preventDefault();
var n=d(l);
if(this.container.is("body")){if(n.y-this.container.scrollTop()<this.scrollZone){this.container.scrollTop(n.y-this.scrollZone)
}if(n.y-this.container.scrollTop()>this.container.height()-this.scrollZone){this.container.scrollTop(n.y-this.container.height()-this.scrollZone)
}}else{var f=this.container.scrollTop();
var i=this.container.offset().top+this.scrollZone;
if(n.y<i){this.container.scrollTop(this.container.scrollTop()-(i-n.y))
}var k=this.container.offset().top+this.container.height()-this.scrollZone;
if(n.y>k){var j=Math.min(this.container.scrollTop()+(n.y-k),Math.max(this.containerHeight-this.container.height(),0));
this.container.scrollTop(j)
}var g=this.container.scrollTop();
this.dragStart.y+=f-g
}var m={};
if(this.axis!=="horizontal"){m.top=n.y-this.dragStart.y
}if(this.axis!=="vertical"){m.left=n.x-this.dragStart.x
}this.dragElement.css(m);
this.triggerDrag(l)
},dragEnd:function(f){f.preventDefault();
this.dragElement.removeClass("dragging");
this.dragElement.css({top:"",left:"",width:""});
c(document).off(b);
this.triggerDrop(f);
if(this.currentDragOver){c(this.currentDragOver).trigger(this._createEvent("dragleave",f))
}this.sourceElement.trigger(this._createEvent("dragend",f))
},triggerDrag:function(g){var f=this._getCurrentDropZone(g);
if(f===this.currentDragOver){if(this.currentDragOver){c(this.currentDragOver).trigger(this._createEvent("dragover",g))
}return
}if(this.currentDragOver){c(this.currentDragOver).trigger(this._createEvent("dragleave",g))
}this.currentDragOver=f;
if(this.currentDragOver){c(this.currentDragOver).trigger(this._createEvent("dragenter",g))
}},triggerDrop:function(g){var f=this._getCurrentDropZone(g);
if(!f){return
}f.trigger(this._createEvent("drop",g))
},_getCurrentDropZone:function(g){var h=d(g);
var f=null;
c.each(this.dropZones,function(i,j){if(a(h.x,h.y,j)){f=j;
return false
}});
return f
},_createEvent:function(f,h){var i=d(h);
var g=jQuery.Event(f);
g.pageX=i.x;
g.pageY=i.y;
g.sourceElement=this.sourceElement;
g.item=this.dragElement;
return g
}})
})(jQuery);
(function(f,a){var c="<button type='button' class='multifield-add icon-add-circle medium'/>";
var d="<button type='button' class='multifield-remove icon-minus-circle medium'/>";
var b="<button type='button' class='multifield-move icon-navigation medium'/>";
var e="<li><div class='multifield-placeholder'></div>"+d+b+"</li>";
CUI.Multifield=new Class({toString:"Multifield",extend:CUI.Widget,construct:function(g){this.script=this.$element.find("script[type='text/html']");
this.ol=this.$element.children("ol");
if(this.ol.length===0){this.ol=f("<ol>").prependTo(this.$element)
}this._adjustMarkup();
this._addListeners()
},_adjustMarkup:function(){this.$element.toggleClass("multifield",true);
this.ol.children("li").append(d).append(b);
this.ol.after(c)
},_addListeners:function(){var g=this;
this.$element.on("click",".multifield-add",function(i){var h=f(e);
h.find(".multifield-placeholder").replaceWith(g.script.html().trim());
h.appendTo(g.ol);
f(g.ol).trigger("cui-contentloaded")
});
this.$element.on("click",".multifield-remove",function(h){f(this).closest("li").remove()
});
this.$element.fipo("taphold","mousedown",".multifield-move",function(i){i.preventDefault();
var h=f(this).closest("li");
h.prevAll().addClass("drag-before");
h.nextAll().addClass("drag-after");
g.ol.css({height:g.ol.height()+f(i.item).height()+"px"});
new CUI.DragAction(i,g.$element,h,[g.ol],"vertical")
}).on("dragenter",function(h){g.ol.addClass("drag-over");
g._reorderPreview(h)
}).on("dragover",function(h){g._reorderPreview(h)
}).on("dragleave",function(h){g.ol.removeClass("drag-over").children().removeClass("drag-before drag-after")
}).on("drop",function(h){g._reorder(f(h.item));
g.ol.children().removeClass("drag-before drag-after")
}).on("dragend",function(h){g.ol.css({height:""})
})
},_reorder:function(g){var h=this.ol.children(".drag-after").first();
var i=this.ol.children(".drag-before").last();
if(h.length>0){g.insertBefore(h)
}if(i.length>0){g.insertAfter(i)
}},_reorderPreview:function(g){var h=this._pagePosition(g);
this.ol.children(":not(.dragging)").each(function(){var j=f(this);
var i=h.y<(j.offset().top+j.outerHeight()/2);
j.toggleClass("drag-after",i);
j.toggleClass("drag-before",!i)
})
},_pagePosition:function(g){var i={};
if(g.originalEvent){var h=g.originalEvent;
if(h.changedTouches&&h.changedTouches.length>0){i=h.changedTouches[0]
}if(h.touches&&h.touches.length>0){i=h.touches[0]
}}return{x:i.pageX||g.pageX,y:i.pageY||g.pageY}
}});
CUI.Widget.registry.register("multifield",CUI.Multifield);
if(CUI.options.dataAPI){f(document).on("cui-contentloaded.data-api",function(g){CUI.Multifield.init(f("[data-init~=multifield]",g.target))
})
}})(jQuery,window.console);
(function(b,a,c){CUI.Autocomplete=new Class({toString:"Autocomplete",extend:CUI.Widget,construct:function(){this._input=this.options.predefine.input||this.$element.children("input");
this._selectlist=this.options.predefine.selectlist||this.$element.find(".selectlist");
this._tags=this.options.predefine.tags||this.$element.find(".taglist");
this._suggestionsBtn=this.options.predefine.suggestionsBtn||this.$element.find(".autocomplete-suggestion-toggle");
this.applyOptions();
this._makeAccessible();
this._initTypeahead();
this._setOptionListeners()
},defaults:{mode:"starts",ignorecase:true,delay:200,multiple:false,selectlistConfig:null,tagConfig:null,predefine:{}},applyOptions:function(){this._setInput();
this._setTags();
this._setSelectlist();
this._setSuggestions()
},_setOptionListeners:function(){this.on("change:multiple",function(){this._setInput();
this._setTags()
}.bind(this))
},_setInput:function(){if(this.options.multiple){this._input.on("keypress.autocomplete-preventsubmit",function(d){if(d.which===13){d.preventDefault();
return false
}})
}else{this._input.off("keypress.autocomplete-preventsubmit")
}this._input.attr("autocomplete","off")
},_setSelectlist:function(){if(this._selectlist.length===0){this._selectlist=b("<ul/>",{id:CUI.util.getNextId(),"class":"selectlist"}).appendTo(this.$element)
}else{if(!this._selectlist.attr("id")){this._selectlist.attr("id",CUI.util.getNextId())
}}this._selectlist.selectList(b.extend({relatedElement:this._input,autofocus:false,autohide:true},this.options.selectlistConfig||{}));
this._selectListWidget=this._selectlist.data("selectList");
this._selectlist.on("selected.autocomplete",this._handleSelected.bind(this))
},_setTags:function(){if(this.options.multiple&&!this._tagList){if(this._tags.length===0){this._tags=b("<ul/>",{"class":"taglist"}).appendTo(this.$element)
}this._tags.tagList(this.options.tagConfig||{});
this._tagList=this._tags.data("tagList");
this._input.on("keyup.autocomplete-addtag",this._addTag.bind(this))
}else{if(!this.options.multiple&&this._tagList){this._tags.remove();
this._tags=null;
this._tagList=null;
this._input.off("keyup.autocomplete-addtag")
}}},_initTypeahead:function(){var e=this,g;
var f=function(h){e.showSuggestions(e._input.val(),false,e._selectListWidget)
};
var d=function(){if(g){clearTimeout(g)
}g=setTimeout(f,e.options.delay)
};
this._input.on("input.autocomplete",d);
this._input.on("cut.autocomplete",d);
this._input.on("keyup.autocomplete",function(h){switch(h.which){case 8:case 46:d()
}})
},_setSuggestions:function(){var d=this;
if(this._suggestionsBtn.length){this._suggestionsBtn.attr("type","button");
this._suggestionsBtn.on("click.autocomplete",function(e){if(!d._selectListWidget.get("visible")){d.showSuggestions(d._input.val(),true,d._selectListWidget);
e.stopPropagation()
}});
this._input.addClass("autocomplete-has-suggestion-btn")
}},_makeAccessible:function(){this.$element.attr({role:"combobox","aria-multiselectable":this.options.multiple,"aria-autocomplete":this.options.typeahead?"list":"","aria-owns":this._selectlist.attr("id")||""});
this._input.add(this._suggestionsBtn).on("keydown",function(d){switch(d.which){case 40:if(!this._selectListWidget.get("visible")){this._selectListWidget.show().resetCaret();
d.preventDefault();
d.stopPropagation()
}break
}}.bind(this))
},_addTag:function(d){if(d.which!==13){return
}this._tagList.addItem(this._input.val());
this.clear();
this._selectListWidget.hide()
},_handleSelected:function(d){this._selectListWidget.hide();
if(this.options.multiple){this._tagList.addItem({display:d.displayedValue,value:d.selectedValue});
this.clear()
}else{this._input.val(d.displayedValue)
}this._input.trigger("focus")
},showSuggestions:function(f,e,d){this.$element.trigger(b.Event("query",{value:f}));
if(f.length||e){if(this._selectListWidget.options.type==="static"){this._handleStaticFilter(f)
}else{if(this._selectListWidget.options.type==="dynamic"){this._handleDynamicFilter(f)
}}this._selectListWidget.show().resetCaret()
}else{this._selectListWidget.hide()
}},_handleStaticFilter:function(e){var d=this;
if(e){this._selectListWidget.filter(function(f,g){if(d.options.ignorecase){g=g.toLowerCase();
e=e.toLowerCase()
}return d.options.mode==="starts"?g.lastIndexOf(e,0)===0:d.options.mode==="contains"?g.search(e)!==-1:false
})
}else{this._selectListWidget.filter()
}},_handleDynamicFilter:function(d){this._selectListWidget.set("dataadditional",{query:d});
this._selectListWidget.triggerLoadData(true)
},clear:function(){this._input.val("");
this._selectListWidget.filter()
},disable:function(){this.$element.addClass("disabled");
this.$element.attr("aria-disabled",true);
this._input.prop("disabled",true);
this._suggestionsBtn.prop("disabled",true)
},enable:function(){this.$element.removeClass("disabled");
this.$element.attr("aria-disabled",false);
this._input.prop("disabled",false);
this._suggestionsBtn.prop("disabled",false)
}});
CUI.Widget.registry.register("autocomplete",CUI.Autocomplete);
if(CUI.options.dataAPI){b(document).on("cui-contentloaded.data-api",function(d){CUI.Autocomplete.init(b("[data-init~=autocomplete]",d.target))
})
}}(jQuery,this));
(function(d,a){if(!d.message||!d.validator){if(a){a.warn("$.message and/or $.validator are not available, thus nothing is registered.")
}return
}d.message.register({selector:"*",message:{"validation.required":"Please fill out this field."}});
d.message.register({selector:":lang(de)",message:{}});
d(document).on("cui-contentloaded",function(f){d(":submittable",f.target).on("invalid",function(h){if(h.isJqueryValidator){return
}h.preventDefault();
var g=d(this);
g.checkValidity();
g.updateErrorUI()
})
});
function c(f,g){var e=f.next(".form-error");
f.attr("aria-invalid","true").toggleClass("error",true);
if(e.length===0){f.after(d("<span class='form-error' data-init='quicktip' data-quicktip-arrow='top' data-quicktip-type='error' />").html(g))
}else{e.html(g)
}}function b(e){e.removeAttr("aria-invalid").removeClass("error");
e.next(".form-error").remove()
}d.validator.register({selector:"form *",show:c,clear:b});
d.validator.register({selector:"form .fieldwrapper .field",show:function(f,g){f.attr("aria-invalid","true").toggleClass("error",true);
f.nextAll(".fieldinfo").addClass("hidden-accessible");
var e=f.nextAll(".fielderror");
if(e.length===0){var h=f.closest("form").hasClass("vertical")?"right":"top";
d("<span class='fielderror form-error small' data-init='quicktip' data-quicktip-type='error' />").attr("data-quicktip-arrow",h).html(g).insertAfter(f)
}else{e.html(g)
}},clear:function(e){e.removeAttr("aria-invalid").removeClass("error").nextAll(".fielderror").remove();
e.nextAll(".fieldinfo").removeClass("hidden-accessible")
}});
d.validator.register({selector:"form input, form textarea",validate:function(e){var f=e.prop("required")===true||(e.prop("required")===undefined&&e.attr("required")!==undefined)||e.attr("aria-required")==="true";
if(f&&e.val().length===0){return e.message("validation.required")||"required"
}}});
d(document).on("input","form input, form textarea",function(g){var f=d(this);
f.checkValidity();
f.updateErrorUI()
});
d.validator.register({selector:"[role=listbox]",validate:function(f){if(f.attr("aria-required")!=="true"){return
}var e=false;
f.find("[role=option]").each(function(){if(d(this).attr("aria-selected")==="true"){e=true;
return false
}});
if(!e){return f.message("validation.required")||"required"
}}})
})(jQuery,window.console);